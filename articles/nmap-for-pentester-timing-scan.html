<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/nmap/" rel="category tag">Nmap</a></span>            </div>
            <h1 class="post-title entry-title">Nmap for Pentester: Timing Scan</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/nmap-for-pentester-timing-scan/" rel="bookmark"><time class="entry-date published" datetime="2018-02-26T16:26:16+00:00">February 26, 2018</time><time class="updated" datetime="2025-05-28T11:42:08+00:00">May 28, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In this article, we will scan the target machine using a normal Nmap scan with the Timing template. And we can confirm the time between packets by analyzing Nmap traffic through Wireshark.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;">Nmap defines the timing template with –T, having -T0 as the slowest and –T5 as the fastest. By default, all nmap scans run on the –T3 timing template. Nmap uses the timing template to optimize and improve the quality and performance of the scan to get desired results.</span></p>
<p class="ai-optimize-8"><span style="color: #000000;"><strong>Let’s start!!</strong></span></p>
<h3 class="ai-optimize-9"><span style="color: #800000;">Nmap Insane (-T5) Scan</span></h3>
<p class="ai-optimize-10"><span style="color: #000000;">This template allows users to send packets insanely fast and waits only 0.3 seconds for the response. The time difference between the two packets sent reaches up to 5 milliseconds. This timing template accelerates the scan, but sometimes sacrifices accuracy. Nmap gives up on a host if it cannot complete the scan within 15 minutes. Other than that, users should apply -T5 only on a fast network and high-end systems, as sending packets this fast can affect the working of the network or system and may result in system failure.</span></p>
<p class="ai-optimize-11"><span style="color: #000000;">For using timing template use the <strong>attribute –T&lt;0-5&gt;</strong> after Nmap while scanning a target network</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -T5 -p21-25 192.168.1.104</pre>
<p class="ai-optimize-12"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-6U8jpLwGLNQ/WpQqccYFKuI/AAAAAAAAU38/6NUDXTz-5XodTaP_VpHJFIaJSyETQhM-wCEwYBhgL/s1600/1.png"/></span></p>
<p class="ai-optimize-13"><span style="color: #000000;">Here are the packets that the system sends to the target IP with a maximum difference of 5 milliseconds or 0.005 seconds.</span></p>
<p class="ai-optimize-14"><span style="color: #000000;">Packet 1 has Arrival Time of 04:41:04.557153433</span></p>
<p class="ai-optimize-15"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-EbC0nwWG7Q0/WpQqfjTFcII/AAAAAAAAU38/WL9RAtYsw-ICnd3_9lOXFAT0Dgx_Ya_KQCEwYBhgL/s1600/2.png"/></span></p>
<p class="ai-optimize-16"><span style="color: #000000;">Packet 2 has Arrival Time of 04:41:04.557225304</span></p>
<p class="ai-optimize-17"><span style="color: #000000;">The difference between the arrival time of Packet 1 and Packet 2 is about <strong>0.07 milliseconds</strong>.</span></p>
<p class="ai-optimize-18"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7x0MJ4NbAzI/WpQqiAxp81I/AAAAAAAAU3w/w75H4qouxNwy2g_CFQXsTt1jShjWCuN-gCEwYBhgL/s1600/3.png"/></span></p>
<h3 class="ai-optimize-19"><span style="color: #800000;">Nmap Aggressive (-T4) Scan</span></h3>
<p class="ai-optimize-20"><span style="color: #000000;">This template enables users to send packets very fast and waits only 1.25 seconds for the response. The sender allows a time difference of up to 10 milliseconds between the two packets sent. Nmap official documentation recommends that users utilize –T4 for “reasonably modern and reliable networks”.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -T4 –p21-25 192.168.1.104</pre>
<p class="ai-optimize-21"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-FXoGy10FX8w/WpQqk7LHABI/AAAAAAAAU30/RlGG2Hrs6ZMWzLno2kCfF6uxxK2olzdLwCEwYBhgL/s1600/4.png"/></span></p>
<p class="ai-optimize-22"><span style="color: #000000;">Here are the packets sent to the target IP are sent by a maximum difference of 5 milliseconds or 0.005 seconds</span></p>
<p class="ai-optimize-23"><span style="color: #000000;">Packet 1 has Arrival Time of 05:58:34.636899267</span></p>
<p class="ai-optimize-24"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-lX3aC8TuD3U/WpQqls27m0I/AAAAAAAAU30/KKgIc8lyAfYP9uKd4oZ8qepQFso5uYoZgCEwYBhgL/s1600/5.png"/></span></p>
<p class="ai-optimize-25"><span style="color: #000000;">Packet 2 has Arrival Time of 05:58:34.637122896</span></p>
<p class="ai-optimize-26"><span style="color: #000000;">The difference between the arrival time of Packet 1 and Packet 2 is about <strong>0.2 milliseconds</strong>.</span></p>
<p class="ai-optimize-27"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-cvykgZMAmm4/WpQql7l2yiI/AAAAAAAAU4A/N1ZI7AU6ZQcB3cJe27TLiwWnEhwhl-e3gCEwYBhgL/s1600/6.png"/></span></p>
<h3 class="ai-optimize-28"><span style="color: #800000;">Nmap Normal (-T3) Scan</span></h3>
<p class="ai-optimize-29"><span style="color: #000000;">This is the default nmap timing template which is used when -T argument is not specified.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -T3 -p21-25 192.168.1.104</pre>
<p class="ai-optimize-30"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ug3CaOT2hS8/WpQqmSMYSMI/AAAAAAAAU38/HRhwtkmqies113E0mAgBFLdeeKDSXZa5ACEwYBhgL/s1600/7.png"/></span></p>
<p class="ai-optimize-31"><span style="color: #000000;">Packet 1 has Arrival Time of 06:01:12.574866212</span></p>
<p class="ai-optimize-32"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-vaiCUWwpRHM/WpQqmVA8vUI/AAAAAAAAU34/WOMS_NZe3CUM_v5C8jFRs7Tr7PnT6QXxwCEwYBhgL/s1600/8.png"/></span></p>
<p class="ai-optimize-33"><span style="color: #000000;">Packet 1 has Arrival Time of 06:01:12.575059033</span></p>
<p class="ai-optimize-34"><span style="color: #000000;">The difference between the arrival time of Packet 1 and Packet 2 is about <strong>0.1 milliseconds</strong>.</span></p>
<p class="ai-optimize-35"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-C_KIG5bN9mE/WpQqnADvYhI/AAAAAAAAU38/MuCPvtFwJpwPjMncTdX_BAIWZyl8xrYBQCEwYBhgL/s1600/9.png"/></span></p>
<h3 class="ai-optimize-36"><span style="color: #800000;">Nmap Polite (-T2) Scan</span></h3>
<p class="ai-optimize-37"><span style="color: #000000;">This template is used for sending packets quickly then –T0 and –T1 but still slower than a normal scan. The time difference between the two packets sent is 0.4 seconds.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -T2 -p21-25 192.168.1.104</pre>
<p class="ai-optimize-38"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-jYK0LcaUTKE/WpQqcUyaqaI/AAAAAAAAU34/i26jfN0-dz0Rrtxvs2RP5C6h_J-l1YlsACEwYBhgL/s1600/10.png"/></span></p>
<p class="ai-optimize-39"><span style="color: #000000;">Packet 1 has Arrival Time of 06:07:38.139876513</span></p>
<p class="ai-optimize-40"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-GAX8eL-umvw/WpQqcWpct8I/AAAAAAAAU30/v0fm7vb4dNEqe_NDsnQdZq_93WatVY5ZwCEwYBhgL/s1600/11.png"/></span></p>
<p class="ai-optimize-41"><span style="color: #000000;">Packet 2 has Arrival Time of 06:01:38.540686453</span></p>
<p class="ai-optimize-42"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-xT6UgW-yF2E/WpQqdM0gwFI/AAAAAAAAU3w/4ogA0C_6JSss0khbH_Oi2M6WAnOuuhKKwCEwYBhgL/s1600/12.png"/></span></p>
<h3 class="ai-optimize-43"><span style="color: #800000;">Nmap Sneaky (-T1) Scan</span></h3>
<p class="ai-optimize-44"><span style="color: #000000;">This template is used for sending packets quickly but still slower than a normal scan. The time difference between the two packets sent is 15 seconds.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -T1 -p21-25 192.168.1.104</pre>
<p class="ai-optimize-45"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-qmYFPHSoPjA/WpQqdWEo79I/AAAAAAAAU3w/AJ6QcSERa80kwG-T3BDCVSMO1SHVVG5zwCEwYBhgL/s1600/13.png"/></span></p>
<p class="ai-optimize-46"><span style="color: #000000;">Packet 1 has Arrival Time of 06:17:02.354879724</span></p>
<p class="ai-optimize-47"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-70F-fEy1kTI/WpQqd5_vMDI/AAAAAAAAU38/xHuRuGGhsPwp0LbxgCn-xUfkOsFAhC_PgCEwYBhgL/s1600/14.png"/></span></p>
<p class="ai-optimize-48"><span style="color: #000000;">Packet 2 has Arrival Time of 06:17:17.371063606</span></p>
<p class="ai-optimize-49"><span style="color: #000000;">The difference between the arrival time of Packet 1 and Packet 2 is about <strong>15 seconds</strong>.</span></p>
<p class="ai-optimize-50"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-5-QkbLqktr0/WpQqd6vqkBI/AAAAAAAAU30/BPVIm_LOq50ZZ-9G1BE00lpfOJTOPjQ-QCEwYBhgL/s1600/15.png"/></span></p>
<h3 class="ai-optimize-51"><span style="color: #800000;">Nmap Paranoid (-T0) Scan</span></h3>
<p class="ai-optimize-52"><span style="color: #000000;">This template is used for sending packets very slowly as only one port is scanned at a time. The time difference between the two packets sent is 5 minutes.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -T0 -p21-25 192.168.1.104</pre>
<p class="ai-optimize-53"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nRPxwzgJQk0/WpQqeb6P0II/AAAAAAAAU4A/JZZV-sVa5uALMusRjTbZVp4duy_d3mCRwCEwYBhgL/s1600/16.png"/></span></p>
<p class="ai-optimize-54"><span style="color: #000000;">Packet 1 has Arrival Time of 06:32:25.043303267</span></p>
<p class="ai-optimize-55"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-c45msJXPhzw/WpQqelOiwOI/AAAAAAAAU4A/I0gitRSYNRwVUYSAGvg-buZkTKwkIh6-ACEwYBhgL/s1600/17.png"/></span></p>
<p class="ai-optimize-56"><span style="color: #000000;">Packet 2 has Arrival Time of 06:37:25.080804929</span></p>
<p class="ai-optimize-57"><span style="color: #000000;">The difference between the arrival time of Packet 1 and Packet 2 is about <strong>5 minutes</strong>.</span></p>
<p class="ai-optimize-58"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bfsUOI8rOOM/WpQqe2ovwwI/AAAAAAAAU4A/UszDzMl9tC0hYUh9qUqEizKfAqgvP2AVwCEwYBhgL/s1600/18.png"/></span></p>
<h3 class="ai-optimize-59"><span style="color: #800000;">Evading Time-Based Firewall rules using timing templates</span></h3>
<h3 class="ai-optimize-60"><span style="color: #800000;">Block Insane T5 scan</span></h3>
<p class="ai-optimize-61"><span style="color: #000000;">Even though we can speed up the scan by –T5 and –T4 templates. There are chances that the target system is using some kind of firewall rules to secure itself. Here are some examples of the firewall rules and methods to bypass them.</span></p>
<p class="ai-optimize-62"><span style="color: #000000;">This rule will block TCP packets from an IP address if the packet count goes more than 1. In other words, only the first packet will be responded from an IP address in 1 second.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo iptables -I INPUT -p tcp -m state --state NEW -m recent --set
sudo iptables -I INPUT -p tcp -m state --state NEW -m recent --update --seconds 1 --hitcount 1 -j DROP</pre>
<p class="ai-optimize-63"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-s5neCb8LNtc/WpQqfLy8BxI/AAAAAAAAU34/x3bA5sVePrgxJjQ2S1YM9YkDF1CRFHnjwCEwYBhgL/s1600/19.PNG"/></span></p>
<p class="ai-optimize-64"><span style="color: #000000;">If you’re scanning more than 1 port on a target system having above rule. The result will not be as desired. Like if we use -T5 or -T4 in nmap scan, the time difference between packets is very much less than 1 second. So if we scan five ports at a time it will show one as open/closed and others as filtered. But -T5 has also <strong>–max-retries set to 2 means</strong> it will retry to get the reply from ports 2 more times hence there will be <strong>3 out 5 ports</strong> with accurate open/close status and the rest 2 with the filtered status</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -T5 -p21-25 192.168.1.104</pre>
<p class="ai-optimize-65"><span style="color: #000000;">From given below image you can observe that it has shown <strong>3 ports </strong>are<strong> open</strong> and <strong>2 ports </strong>are <strong>filtered</strong>.</span></p>
<p class="ai-optimize-66"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-g0uRUb5Zc6s/WpQqftWitBI/AAAAAAAAU34/_V6bfd4Ea1o2o-xDzeOzkTfVVJEWBaduwCEwYBhgL/s1600/20.png"/></span></p>
<p class="ai-optimize-67"><span style="color: #000000;">The packet transfer between the target and the victim is captured through Wireshark, it clearly shows that the TCP SYN packets are sent multiple times on ports 22 and 23 and didn’t receive any reply packet for those request packet.</span></p>
<p class="ai-optimize-68"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-auVaKa4Wlf4/WpQqgMkeE1I/AAAAAAAAU30/hN4a8-qMOiYm_EgbAdTJYNK2hV14ZasiQCEwYBhgL/s1600/21.png"/></span></p>
<h3 class="ai-optimize-69"><span style="color: #800000;">Bypass Insane T5 Firewall filter</span></h3>
<h4 class="ai-optimize-70"><span style="color: #000000;">1<sup>st</sup> method</span></h4>
<p class="ai-optimize-71"><span style="color: #000000;">Use <strong>–max-retries</strong> argument to increase the –max-retries value so that each retry gives the accurate status of one port at a time. Execute given below command for increasing maximum retries with T5 scan here I had 4 you can modify it as per your requirement.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -T5 -p21-25 192.168.1.104 --max-retries 4</pre>
<p class="ai-optimize-72"><span style="color: #000000;">now if you notice from given below image you can observe that it has shown all <strong>5 ports </strong>are<strong> open</strong>.</span></p>
<p class="ai-optimize-73"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dZ0pTOuUSp0/WpQqgQ7nytI/AAAAAAAAU3w/N4GpQ0xNi6kXAQF45WFALmXr5QXHu__tgCEwYBhgL/s1600/22.png"/></span></p>
<p class="ai-optimize-74"><span style="color: #000000;">Here, the packet transfer shows that in each retry one different port sends the reply in order to confirm its status as shown in the given below image.</span></p>
<p class="ai-optimize-75"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-llfZ3nNNv20/WpQqgkdtwcI/AAAAAAAAU3w/-Hg1HRy63ukvDgVuavQQ5Hks7CCf3X6HQCEwYBhgL/s1600/23.png"/></span></p>
<h4 class="ai-optimize-76"><span style="color: #000000;">2<sup>nd</sup> Method</span></h4>
<p class="ai-optimize-77"><span style="color: #000000;">The second method is to use a timing template which has a greater time difference between the packets like here we can use the timing template below T5 i.e. from T4 to T0 to bypass above rule.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -T4 -p21-25 192.168.1.104
or
nmap -T3 -p21-25 192.168.1.104
or
nmap -T2 -p21-25 192.168.1.104
or
nmap -T1 -p21-25 192.168.1.104
or
nmap -T0 -p21-25 192.168.1.104</pre>
<p class="ai-optimize-78"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-_3ejgkxg-lw/WpQqg8EajkI/AAAAAAAAU30/tyNUcPI12EwgvSuqOSPn6NychadqnBRAACEwYBhgL/s1600/24.png"/></span></p>
<p class="ai-optimize-79"><span style="color: #000000;">Here, the packet transfer shows that each port has sent the reply but the first reply was instantly and other ports replied one by one after some time.</span></p>
<p class="ai-optimize-80"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Bvey2NaTlOg/WpQqhHw4UbI/AAAAAAAAU3w/qm6rtTp-OM4LI-Osr1BOae9PXBa1DmyswCEwYBhgL/s1600/25.png"/></span></p>
<h3 class="ai-optimize-81"><span style="color: #800000;">Block Aggressive T4, Normal T3 &amp; Polite T2 Scan </span></h3>
<p class="ai-optimize-82"><span style="color: #000000;">Now given below rules will block TCP packets from an IP address if the packet count <strong>goes more than 1</strong>. In other words, only the first packet will be responded from an IP address in 3 seconds.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo iptables -I INPUT -p tcp -m state --state NEW -m recent --set
sudo iptables -I INPUT -p tcp -m state --state NEW -m recent --update --seconds 3 --hitcount 1 -j DROP</pre>
<p class="ai-optimize-83"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-4czOdnvo4zc/WpQqhc_GY7I/AAAAAAAAU4A/7wqVBtspLhYP7d0ER9iNqnFSQKukWlA7ACEwYBhgL/s1600/28.PNG"/></span></p>
<p class="ai-optimize-84"><span style="color: #000000;">Here we are using -T4 for scanning 5 ports, the time difference between packets is very much less than 1 second so if we scan five ports at a time it will show one as open/closed and others as filtered. But -T4 has also –max-retries set to 6 means it will retry to get the reply from ports 6 more times but as the time limit exceeds the total time taken by all retries it will show all ports filtered</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -T4 -p21-25 192.168.1.104
or
nmap -T3 -p21-25 192.168.1.104
or
nmap -T2 -p21-25 192.168.1.104</pre>
<p class="ai-optimize-85"><span style="color: #000000;">The T4, T3, and T2 scan results can show either all ports filtered or any port displaying an open/closed state. From the image below, you can observe that all 5 ports are filtered.</span></p>
<p class="ai-optimize-86"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ITV41N_G3y0/WpQqh4I-glI/AAAAAAAAU38/BFV0_2xkqmQfZ26FvVr-EtXsxgLGvOScACEwYBhgL/s1600/29.png"/></span></p>
<p class="ai-optimize-87"><span style="color: #000000;">Here we can see that none of the packets got the reply</span></p>
<p class="ai-optimize-88"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Dy1jBe-3NOc/WpQqpsyjtSI/AAAAAAAAU4A/aYAdIAzh05Qi52V_N7a-gK6uCGBua1etgCEwYBhgL/s1600/30.png"/></span></p>
<h3 class="ai-optimize-89"><span style="color: #800000;">Bypass Aggressive T4, Normal T3 &amp; Polite T2 Firewall filter</span></h3>
<p class="ai-optimize-90"><span style="color: #000000;">To bypass this kind of rule we have to use a Timing Template which is slower than -T4</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -T1 -p21-25 192.168.1.104</pre>
<p class="ai-optimize-91"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Kfron0qqq-A/WpQqiYIQ-wI/AAAAAAAAU4A/stAtntBwXO44nq8beXysPDxk8CIhTg0RwCEwYBhgL/s1600/31.png"/></span></p>
<p class="ai-optimize-92"><span style="color: #000000;">Here we can see that all the packets got a reply because the time interval in T1 is almost 15 seconds.</span></p>
<p class="ai-optimize-93"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-3HYdROY1xKM/WpQqizs5RhI/AAAAAAAAU3w/VgW4jtndrxoOz2DsCUCQZot-5S1uL_3egCEwYBhgL/s1600/32.png"/></span></p>
<h3 class="ai-optimize-94"><span style="color: #800000;">Block Sneaky (-T1) Scan</span></h3>
<p class="ai-optimize-95"><span style="color: #000000;">Now, this rule is to block TCP packets from an IP address if the packet count goes more than 1. In other words, only the first packet will be responded from an IP address in 200 seconds.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo iptables -I INPUT -p tcp -m state --state NEW -m recent --set
sudo iptables -I INPUT -p tcp -m state --state NEW -m recent --update --seconds 200 --hitcount 1 -j DROP</pre>
<p class="ai-optimize-96"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-a4iyB5PDiyM/WpQqjYzYjAI/AAAAAAAAU30/osekKAYCYOQVag69dKyyf9Lebu_EuCzAQCEwYBhgL/s1600/33.PNG"/></span></p>
<p class="ai-optimize-97"><span style="color: #000000;">Now repeat the T1 scan again as given below and this time you will found that firewall is blocking our Nmap probes for identifying the open/closed state of any port.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -T1 -p21-25 192.168.1.104</pre>
<p class="ai-optimize-98"><span style="color: #000000;">The T1 scan results can indicate either that all ports are filtered or that any port can show an open/closed state. From the image below, you can observe that it shows all 4 ports are filtered.</span></p>
<p class="ai-optimize-99"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-kRdW-5KH2P0/WpQqjuLYDlI/AAAAAAAAU34/hDdZvd6HdWEcvi8EHwD_JwgRIrOvwYkcwCEwYBhgL/s1600/34.png"/></span></p>
<p class="ai-optimize-100"><span style="color: #000000;">Here we can see that only one of the packets got the reply rest are drop by the firewall.</span></p>
<p class="ai-optimize-101"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-XhBi0gLEjmQ/WpQqkKOJoPI/AAAAAAAAU38/b_2T40cR8rgYSN9KkyU8qYq9oO3y8CrUgCEwYBhgL/s1600/35.png"/></span></p>
<h3 class="ai-optimize-102"><span style="color: #800000;">Bypass Sneaky (-T1) Scan</span></h3>
<p class="ai-optimize-103"><span style="color: #000000;">To bypass this kind of rule we have to use a Timing Template which has time difference in packets for more than 200 seconds, therefore use paranoid time scan because the time difference between two packets is near about 5 mints as discussed above.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -T0 -p21-25 192.168.1.104</pre>
<p class="ai-optimize-104"><span style="color: #000000;">From given below image you can observe that it has taken <strong>1813.61 sec</strong> which is close to 30 mints for scanning 5 ports and found <strong>open state</strong> for all 5 ports.</span></p>
<p class="ai-optimize-105"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-xiiw8ydCOwc/WpQqkV9ks-I/AAAAAAAAU34/7ZdkmTvQHrMsUz2-mcplGLOJpZuO6m-JACEwYBhgL/s1600/37.png"/></span></p>
<p class="ai-optimize-106"><span style="color: #000000;">Here we can see that we have got the response of every packet even though the firewall had the security rules set.</span></p>
<p class="ai-optimize-107"><span style="color: #000000;">To evade any type of IPS or Firewall, you need to remember that it will take much longer time than usual to scan the target system using a slower timing template. So try to specify a small number of ports, where the slow scans don’t take time to scan the ports that you don’t intend to.</span></p>
<p class="ai-optimize-108"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-x7WyXUTbyOQ/WpQqk2lgeHI/AAAAAAAAU34/wKdIad0W4cg77uOIaOa2Lky0Q8RjGJyywCEwYBhgL/s1600/38.png"/></span></p>
<p class="ai-optimize-42"><span style="color: #000000;">To learn more on Nmap. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/nmap/">Link.</a></strong></p>
<p class="ai-optimize-109"><span style="color: #000000;"><strong>Author</strong>:  Deepanshu is a Certified Ethical Hacker and a budding Security researcher. Contact <strong><a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/deepanshu-k-a4248b138/">here</a>.</strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
