<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/pentest-lab-setup/" rel="category tag">Pentest Lab Setup</a></span>            </div>
            <h1 class="post-title entry-title">Penetration Testing Lab Setup: Microsocks</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/penetration-testing-lab-setup-microsocks/" rel="bookmark"><time class="entry-date published" datetime="2018-11-16T14:48:59+00:00">November 16, 2018</time><time class="updated" datetime="2025-05-13T09:00:15+00:00">May 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! In our previous article we have discussed “<a style="color: #000000;" href="//www.hackingarticles.in/web-proxy-penetration-lab-setup-testing-using-squid/">Web Proxy Penetration Lab Setup Testing using Squid</a>” and today’s article we are going to set up SOCKS Proxy to use it as a Proxy Server on Ubuntu/Debian machines and will try to penetrate it.</span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<ul>
<li><span style="color: #000000;">Introduction to proxy</span></li>
<li><span style="color: #000000;">What is socks proxy</span></li>
<li><span style="color: #000000;">Difference Between Socks proxy and HTTP Proxy</span></li>
<li><span style="color: #000000;">Socks proxy Installation</span></li>
<li><span style="color: #000000;">Connecting HTTP via Proxy</span></li>
<li><span style="color: #000000;">Connecting SSH via Proxy</span></li>
<li><span style="color: #000000;">Connecting FTP via Proxy</span></li>
</ul>
<h3><span style="color: #800000;"><span style="color: #800000;">Introduction</span><strong style="color: #800000;"> to Proxy</strong></span></h3>
<p><span style="color: #000000;">A proxy is a computer system or program that acts as a kind of middle-man or an intermediary to come between your web browser and another computer. Your ISP operates servers– computers designed to deliver information to other computers. It uses proxy servers to accelerate the transfer of information between the server and your computer.</span></p>
<p><span style="color: #000000;"><strong>For Example</strong>, Two users say A and B both have requested to access the same website of the server then Instead of retrieving the data from the original server, the proxy has “stored or cached” a copy of that site and sends it to User A without troubling the main server.</span></p>
<h3><span style="color: #800000;"><strong>What is SOCKS Proxy?</strong></span></h3>
<p><span style="color: #000000;">A SOCKS server is an all-purpose proxy server that creates a TCP connection to another server on the client’s behalf, then exchanges network packets between a client and server. The Tor onion proxy software serves a SOCKS interface to its clients. Even SSH tunnel makes all the connections as per the SOCKS protocol.</span></p>
<p><span style="color: #000000;">For high security, you can go with SOCKS5 protocol that provides various authentication options which you cannot get with the SOCKS4 protocol.</span></p>
<h4><span style="color: #000000;"><strong>Difference Between Socks proxy and HTTP Proxy </strong></span></h4>
<ul>
<li><span style="color: #000000;">SOCKS Proxy is low-level which is designed to be a general proxy that will be able to accommodate effectively any protocol, program, or type of traffic.</span></li>
<li><span style="color: #000000;">SOCKS proxies support both TCP and UDP transfer protocols</span></li>
<li><span style="color: #000000;">SOCKS performs at Layer 5 of the OSI model SOCKS server</span></li>
<li><span style="color: #000000;">Accepts an incoming client connection on TCP port 1080.</span></li>
<li><span style="color: #000000;">HTTP proxies proxy HTTP requests, while SOCKS proxies proxy socket connections</span></li>
<li><span style="color: #000000;">HTTP proxies are High-Level which are designed for a specific protocol.</span></li>
<li><span style="color: #000000;">HTTP proxies can only process requests from applications that use the HTTP protocol.</span></li>
<li><span style="color: #000000;">An HTTP proxy is for proxying HTTP or web traffic at layer 7</span></li>
<li><span style="color: #000000;">Accepts an incoming client connection on HTTP port 3128.</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Socks Proxy Installation</strong></span></h3>
<p><span style="color: #000000;">For socks proxy lab set-up we are going to download microsocks through GitHub. MicroSocks is multithreaded, small, efficient SOCKS5 server. It’s very lightweight, and very light on resources too. Even for every client, a thread with a stack size of 8KB is spawned.</span></p>
<p><span style="color: #000000;"><strong>Let’s start!!</strong></span></p>
<p><span style="color: #000000;">Open the terminal with sudo rights and enter the following command:</span></p>
<pre class="lang:default decode:true">git clone https://github.com/rofl0r/microsocks.git</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-6H9PY4i36WY/W-7W3lARywI/AAAAAAAAbKA/xwlyxVbQqEMaukkum7P3DQLDyhDrrKKBACEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Once downloading is completed run the following command for its installation:</span></p>
<pre class="lang:default decode:true ">cd microsocks
apt install gcc
make
make install</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-BN-_HxHS18c/W-7W5IOJWVI/AAAAAAAAbKY/bkZONW6ogg8jxkrseujiIisGsE8SkEHqwCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Now execute the following command to run socks proxy on port 1080 without authentication.</span></p>
<pre class="lang:default decode:true">microsocks -p 1080</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-5HO8HM_p1Zw/W-7W5YNnRtI/AAAAAAAAbKc/gdm-TuCbHxUsKH7ohj0JCJ7PY4LSFeNXQCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">As you can observe FTP, SSH, HTTP and Socks are running in our local machine and now let’s go for socks penetration testing on a various protocol to ensure whether it is an all-purpose program or not as said above.</span></p>
<h3><span style="color: #800000;">Connecting HTTP via Proxy</span></h3>
<p><span style="color: #000000;">Now Configuring Apache service for Web Proxy, therefore, open the “000-default.conf” file from the path: /etc/apache2/sites-available/ and add following line to implement the following rules on /html directory over localhost or Machine IP (192.168.1.103).</span></p>
<pre class="lang:default decode:true">&lt;Directory /var/www/html/&gt;
                Options Indexes FollowSymLinks MultiViews
                AllowOverride None
                Order deny,allow
                deny from all
        allow from 127.0.0.1 192.168.1.103
&lt;/Directory&gt;</pre>
<p><span style="color: #000000;">Now the save the file and restart the apache service with the help of the following command.</span></p>
<pre class="lang:default decode:true">service apache2 start</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-qVbqShaKlrc/W-7W52y3SfI/AAAAAAAAbKk/tGErCveM45gtUGRXg-oZ5goP33vnFr-wgCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Now when someone tries to access web services through our network i.e. 192.168.1.103, he/she will welcome by following web page</span></p>
<p><span style="color: #000000;">“Error 403 forbidden You don’t have permission to access &lt;requested page&gt;”.</span></p>
<p><span style="color: #000000;">When you face that such type of situation where port 80 is open but you are unable to access it, hence proved the network is running behind a proxy server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-v8ydsWab46g/W-7W59ZPszI/AAAAAAAAbKo/t9qlXr9uZ841I8BVJOVDF_h3QvTI9wEKwCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">For web Proxy penetration testing we had already set-up lab for web application server such as DVWA (Read Article from <a style="color: #000000;" href="//www.hackingarticles.in/configure-web-application-penetration-testing-lab/">here</a>).</span></p>
<p><span style="color: #000000;">Now to test whether our  proxy server is working or not by configuring , let’s open Firefox and go to <strong>Edit –&gt; Preferences –&gt; Advanced –&gt; Network –&gt; Settings</strong> and then select “Manual proxy configuration” and enter SOCKS proxy server IP address (192.168.1.103) and Port (1080) to be used for all protocol.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-nO5__5DlQHY/W-7W6IJ1X9I/AAAAAAAAbKs/_oGEZWL9A0siZwbO0Wn1RWQNGGv3WSxyQCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">BOOMMM!! Connected to the Proxy server successfully using HTTP Proxy in our Browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-rH9rL2xEUzc/W-7W6TzvmeI/AAAAAAAAbKw/9QCkYEjvVMEoVEHttlTsfUcIIwGubLuGACEwYBhgL/s1600/8.png"/></span></p>
<h3><span style="color: #800000;">Connecting SSH via Proxy</span></h3>
<p><span style="color: #000000;">Now configuring host.allow file for SSH Proxy, therefore, open /etc/hosts.allow file and following line to allow SSH connection on localhost IP and restrict for others.</span></p>
<pre class="lang:default decode:true ">sshd : localhost : allow
sshd : 192.168.1.103 : allow
sshd : ALL : deny</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-3UrqKFZmkv0/W-7W6QXmCWI/AAAAAAAAbK0/Fzd1oxERhOEKoB4ZL4wpcTsPRAT5CZf8QCEwYBhgL/s1600/9.1.png"/></span></p>
<p><span style="color: #000000;">Now open a proxychains configuration file from the given path <em>/etc/proxychains.conf</em> in your Kali Linux and then add the following line at the bottom.</span></p>
<pre class="lang:default decode:true">socks5 192.168.1.103 1080</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-RblONVPOI3M/W-7W6zaLaII/AAAAAAAAbK4/F6rKFzyAumYxq5mm-4gQv11CBTQ1-VzEwCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Now when we try to connect with target machine via port 22 for SSH connection we got an error message “Connection reset by peer” as shown in below image after executing the 1<sup>st</sup> command.</span></p>
<pre class="lang:default decode:true">ssh pentest@192.168.1.103</pre>
<p><span style="color: #000000;">When you face that such type of situation where port 22 is open but you are unable to access it, hence proved the network is running behind the proxy server.</span></p>
<p><span style="color: #000000;">But if you will use <strong>proxychains </strong>along with the command after saving the configuration as said above then you can easily connect with target network via port 22 for ssh connection as shown in below image after executing the 2<sup>nd</sup> command.</span></p>
<pre class="lang:default decode:true">proxychains ssh pentest@192.168.1.103</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-tLhNm9DolCs/W-7W3qeGuZI/AAAAAAAAbKE/T7qkArDcoVkXa2GhOlc9F-TIVpdkwS5bQCEwYBhgL/s1600/10.png"/></span></p>
<h3><span style="color: #800000;">Connecting FTP via Proxy</span></h3>
<p><span style="color: #000000;">For connecting FTP via proxy, we have used PRO FTP. SO, you can install it using the following command :</span></p>
<pre class="lang:default decode:true">apt-get install proftpd</pre>
<p><span style="color: #000000;">Now configuring vsftpd.conf file for FTP Proxy therefore open <strong>/etc/proftpd/proftpd.conf</strong> file and add the following line to allow FTP connection on localhost IP and restrict for other networks.</span></p>
<pre class="lang:default decode:true ">&lt;Limit LOGIN&gt;
Order Allow,Deny
Allow from 127.0.0.1 192.168.1.103
Deny from all
&lt;/Limit&gt;</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-4gRzU8G3GBQ/W-7W3hZQySI/AAAAAAAAbKI/9HeK5QMMov0ovgpKa1jl9HQurtBzBaS4gCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Using FileZilla when we try to connect 192.168.1.103 via port 21 for accessing FTP service, we got an Error “Connection closed by server”.</span></p>
<p><span style="color: #000000;">When you face that such type of situation where port 21 is open but you are unable to access it, hence proved the network is running behind a proxy server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-Bgl2fynsbeA/W-7W4ffOGQI/AAAAAAAAbKM/dahAvG9_T6syfz4g_guMynY-j1K0NmUdQCEwYBhgL/s1600/12.1.png"/></span></p>
<p><span style="color: #000000;">But FileZilla has multi features as it offers a generic proxy option that forced passive mode on FTP connection. Go to <strong>Settings &gt; Connection &gt; FTP</strong> and select “generic proxy” option and made the following configuration settings.</span></p>
<ul>
<li><span style="color: #000000;">Choose SOCKS 5 as generic Proxy</span></li>
<li><span style="color: #000000;">Proxy HOST IP: 192.168.1.103</span></li>
<li><span style="color: #000000;">Proxy Port: 1080</span></li>
</ul>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-uCt3AvzHzW4/W-7W4tpO-NI/AAAAAAAAbKQ/vggvyIw51n0VhjLemlIw_6RkXPCYRO8DwCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Now again when you will try to connect the target machine via port 21 for accessing FTP service then you will be easily able to access it as shown in the last image.</span></p>
<p><span style="color: #000000;">Hence Proved the SOCKS is actually an all-purpose proxy server and Hopefully, you have found this article very helpful and completely understood the working of Proxy server and another related topic cover in this article.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-ggfwR96rL0M/W-7W4wGZiII/AAAAAAAAbKU/lMXXlw78u0Mcmz0Zf67IkGR5aYPJ2E4PACEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sanjeet Kumar is an Information Security Analyst | Pentester | Researcher  Contact <a class="broken_link" style="color: #000000;" href="//www.linkedin.com/in/sanjeet-kumar-27828058/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
