<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/cyber-forensics-tricks/" rel="category tag">Cyber Forensics</a></span>            </div>
            <h1 class="post-title entry-title">Network Packet Forensic using Wireshark</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/network-packet-forensic-using-wireshark/" rel="bookmark"><time class="entry-date published" datetime="2018-01-06T17:39:44+00:00">January 6, 2018</time><time class="updated" datetime="2025-05-22T17:51:14+00:00">May 22, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to discuss “Network Packet Forensic”  by covering some important track such as how Data is transferring between two nodes, what is “OSI 7 layer model” and how Wireshark stores which layers information when capturing the traffic between two networks.</span></p>
<p><span style="color: #000000;">As we know, to transfer data from one system to another, we need a network connection, which can be wired or wireless. However, the actual transmission of data does not only depend on the network connection; it also involves several phases for transmitting data from one system to another, which the OSI model explains.</span></p>
<p><span style="color: #000000;"><strong>OSI</strong> stands for <strong>O</strong>pen <strong>S</strong>ystems <strong>I</strong>nterconnection model. This is a conceptual model that defines and standardizes the process of communication between the sender’s and receiver’s system. The data is transfer through 7 layers of architecture where each layer has a specific function in transmitting data over the next layer.  </span></p>
<p><span style="color: #000000;">Now have a look over given below image, where we had explained the functionality of each layer in the OSI model. So when the sender’s network transmits data, it goes in a downward direction and moves from the application layer to the physical layer. Whereas, when the receiver receives the transmitted data, it comes in an upward direction from the physical layer to the application layer.</span></p>
<p><span style="color: #000000;">Flow of Data from Sender’s network: <strong>Application </strong>&gt;<strong> Presentation </strong>&gt;<strong> Session</strong> &gt;<strong> Transport </strong>&gt; <strong>Network </strong>&gt;<strong> Data Link </strong>&gt; <strong>Physical </strong></span></p>
<p><span style="color: #000000;">Flow of Data from Receiver’s network: <strong>Physical </strong>&gt;<strong> Data Link </strong>&gt; <strong>Network </strong>&gt;<strong> Transport </strong>&gt;<strong> Session</strong> &gt; <strong>Presentation </strong>&gt; <strong>Application</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/--mtxlxkYpSo/WlEFtcX5yoI/AAAAAAAATKQ/0SQACcBJ_CkRcLi-bu2CPRhQpJGfCEnSQCLcBGAs/s1600/0.png"/></span></p>
<h3><span style="color: #800000;">Examine Layers captured by Wireshark </span></h3>
<p><span style="color: #000000;">Basically when a user opens an application for sending or receiving Data then he directly interacts with the application layer for both operations either sending or receiving of data. For example, we act as a client when use Http protocol for uploading or Downloading a Game. FTP for downloading a File. SSH for accessing the shell of the remote system.</span></p>
<p><span style="color: #000000;">While connecting with any application for sharing data between server and client. We make use of Wireshark for capturing the flow of network traffic stream to examine the OSI model theory through captured traffic.</span></p>
<p><span style="color: #000000;">From image given below, you can observe that Wireshark has captured the traffic of four layers in direction of the source (sender) to destination (receiver) network.</span></p>
<p><span style="color: #000000;">Here it has successfully captured <strong>Layer 2</strong> &gt; <strong>Layer 3</strong> &gt; <strong>Layer 4</strong> and then <strong>Layer 7</strong> information.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-FUs2cy-7YHw/WlEF1EdYF0I/AAAAAAAATKg/JVtRCAv8DVoT6CAomiHDzXQZR2znL15YgCLcBGAs/s1600/1.png"/></span></p>
<h3><span style="color: #800000;">Ethernet Header (Data Link) </span></h3>
<p><span style="color: #000000;"> The data link layer holds 6 bytes of the sender’s system and receiver’s system Mac address, and 2 bytes of Ether type indicate which protocol is encapsulated, i.e., IPv4/IPv6 or ARP.</span></p>
<p><span style="color: #000000;">In Wireshark Ethernet II layer represent the information transmitted over the data link layer. From given below image you can observe that highlighted lower part of Wireshark is showing information in Hexadecimal format where the first row holds information of Ethernet headers details.</span></p>
<p><span style="color: #000000;">So here you can get the source and destination Mac address which also available in Ethernet Header.</span></p>
<p><span style="color: #000000;">The row is divided into three columns as described below: </span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-_LJcOeN1iZM/WlHm_mXsAUI/AAAAAAAATLU/jABQSeptrZ0tJSBpu5rPht1zXe_C4bBagCLcBGAs/s1600/2.1.png"/></p>
<p><span style="color: #000000;">We represent the MAC address of the system in Hexadecimal format, but both types generally categorize in the ways given below :</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-yrQCQOoUh9w/WlHm_mRrwfI/AAAAAAAATLQ/h6rPb6s1qY8Tnyca5n-ikECTprIjUra8QCEwYBhgL/s1600/2.2.png"/></p>
<p><span style="color: #000000;">Once again if you notice the given below image then you can observe the highlighted text in Pink colour is showing hex value <strong>08 00</strong> which indicates that here<strong> IPv4</strong> is used.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-TAXnUTNLdYw/WlEFtjO2JsI/AAAAAAAATKU/IJcSJEk_MZwTbRClLGRzer2nlRhnKGflwCLcBGAs/s1600/2.png"/></span></p>
<h3><span style="color: #800000;">IP Header (Network Layer)</span></h3>
<p><span style="color: #000000;">Wireshark describes the IP header that holds the network layer information, known as the backbone of the OSI model. It contains complete details of Internet Protocol version 4. The network layer divides the data frame into packets and defines their routing path through hardware devices such as routers, bridges, and switches. The network identifies these packets through their logical address, i.e., the source or destination network IP address.</span></p>
<p><span style="color: #000000;">In the image of Wireshark, I highlighted six most important values that contain vital information of a data packet. This information always flows in the same way as it encapsulates in the same pattern for each IP header.</span></p>
<p><span style="color: #000000;">Now here,<strong> 45</strong> represent IP<strong> </strong>header length where “4” indicates<strong> IP version 4</strong> and “5” is header length of <strong>5 bits</strong>. While <strong>40</strong> is time to live (<strong>TTL</strong>) of packet and <strong>06 </strong>is hex value for <strong>TCP</strong> protocol. This means these values changes if anything changes i.e. TTL, Ipv4 and Protocol.</span></p>
<p><span style="color: #000000;">Therefore, you can take help of given below table for examining TTL value for the different operating system. </span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-4Tjr3zAuJvM/WlHvx1bOioI/AAAAAAAATMI/kJ6X-eMaClEQXryJMt2q5l1XaCfJwjgUgCLcBGAs/s1600/1.png"/></p>
<p><span style="color: #000000;">Similarly, you can take help of given below table for examining other Protocol value.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-sM7D6X3DQ-g/WlHnATe_mHI/AAAAAAAATLc/tKAL-arYEXcXl3tSaQyGAYS8g6ZhrCUEQCEwYBhgL/s1600/3.2.png"/></p>
<p><span style="color: #000000;">From given below image you can observe Hexadecimal information of the IP header field and using a given table you can study these value to obtain their original value.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-y4IVtxiM8js/Wl9U7jWSgRI/AAAAAAAATW0/iS9sqsJiC_so8mZHhINf35SXSyfpXVdOACLcBGAs/s1600/3.3.png"/></p>
<p><span style="color: #000000;">The IP header length always represents the bit, and here it shows 5 bytes, which is also the minimum IP header length. To make it 20 bytes, you multiply 4 by 5, resulting in 20 bytes.<br/>
</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oeJLPOKgMR8/WlEFuEWNgFI/AAAAAAAATKY/i73Rw3mS91IpogeyUSqbUXmRuQz7UDXGwCLcBGAs/s1600/3.png"/></span></p>
<h3><span style="color: #800000;">TCP Header (Transport Layer)</span></h3>
<p><span style="color: #000000;">Transmission Control Protocol (TCP) and User Datagram Protocol (UDP) and Internet Control Message Protocol (ICMP) are the major protocols. They gives host-to-host connectivity at the Transport Layer of the OSI model. We also know it as the Heart of the OSI model because it plays a major role in transmitting error-free data.</span></p>
<p><span style="color: #000000;">By examining Network Layer information through Wireshark, we found that TCP establishes a connection with the destination network.</span></p>
<p><span style="color: #000000;">We knew that a computer communicates with another device like a modem, printer, or network server; it needs to handshake with it to establish a connection.</span></p>
<p><span style="color: #000000;">TCP follows <strong>Three-Way-Handshakes</strong> as describe below:</span></p>
<ul>
<li><span style="color: #000000;">A client sends a TCP packet to the server with the <strong>SYN flag</strong></span></li>
<li><span style="color: #000000;">A server responds to the client request with the <strong>SYN</strong> and <strong>ACK</strong> flags set.</span></li>
<li><span style="color: #000000;">Client completes the connection by sending a packet with the <strong>ACK</strong> flag set</span></li>
</ul>
<h3><span style="color: #800000;">Structure of TCP segment</span></h3>
<p><span style="color: #000000;">Transmission Control Protocol accepts data from a data stream, splits it into chunks, and adds a TCP header creating a TCP segment. A TCP segment only carries the sequence number of the first byte in the segment.</span></p>
<p><span style="color: #000000;">A TCP segment consists of a segment header and a data section. The TCP header contains mandatory fields and an optional extension field.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh1duQE6nLhIwf_JYhf-0G8t5COBTyh5Rj8HmplLC_ycRVIE3D5Sv9sGHmxOR2nvxdWP2ER-Y0xC5HA4KBax8UPQaHYrfFYGvKYvBamaIMr7kehHKDYIUMNkOTm_8POXCXjrffFkPmsjZyxFHGJ6q1DjsTp34b1N6FNRKp_uDrhS-o85OlLQnrONsePSJIY/s16000/121.png"/></p>
<h3><span style="color: #800000;">Different Types of TCP flags</span></h3>
<p><span style="color: #000000;">TCP flags control bits specify particular connection states or information about how a packet should be set in TCP headers. TCP flag field in a TCP segment will help us to understand the function and purpose of any packet in the connection. </span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-w9p17Fl_MUo/WpQ6eb0EomI/AAAAAAAAU4M/wX9c6GNjjSMBSpIHh17KAomhpa46ltB8QCLcBGAs/s1600/Screenshot_1.png"/></p>
<p> </p>
<p><span style="color: #000000;">From image given below, you can observe Hexadecimal information of TCP header field. Using the given table you can study these value to obtain their original value.</span></p>
<p><span style="color: #000000;">Sequence and acknowledgment numbers play a major part in TCP. They serve as a way to guarantee that all data transmits consistently. Since, the receiver must acknowledge all data transferred through a TCP connection in a suitable way. When the receiver does not send an acknowledgment, the sender will again send all unacknowledged data.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-rHakEyvLqaU/WlHyD3CpEdI/AAAAAAAATMc/NnfnedmoO6YHhxkY9eUgUjeANBWSFe13ACLcBGAs/s1600/6.png"/></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-e32_orcDwtE/WlEFuZon4dI/AAAAAAAATKc/dSyI7sRc8F0BmcP0ctNegYvLQXfbyFPSQCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Using given below table you can read Hex value of other Port Number and their Protocol services. Although these services operate after getting acknowledgment from the destination network and explore at application layer OSI model.</span></p>
<p><span style="color: #000000;">In this way, you can examine every layer of Wireshark for Network Packet Forensic.</span></p>
<p><strong><img decoding="async" src="https://3.bp.blogspot.com/-FmnErBTfqzM/WlHvmxGUiWI/AAAAAAAATMA/wzCvVml0k5U2NPyK36SYwd00XYh4llFywCLcBGAs/s1600/3.png"/></strong></p>
<p><span style="color: #000000;">To learn more about Cyber Forensics. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/cyber-forensics-tricks/">Link</a></strong></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. Contact</span> <strong><a class="broken_link" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
