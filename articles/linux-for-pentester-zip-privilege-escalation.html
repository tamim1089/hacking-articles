<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux for Pentester : ZIP Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-for-pentester-zip-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2019-06-07T16:22:19+00:00">June 7, 2019</time><time class="updated" datetime="2025-05-10T20:33:08+00:00">May 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today We are going to tell you that how can we perform Privilege Escalation with Zip command. As we all know that Zip is an easy platform-based file packaging and compression utilities for Unix-like systems like Linux, Windows, etc. The Zip program is used for compressing and packaging documents.</span></p>
<p><strong><em>Note: “The main objective of publishing the series of “Linux for pentester” is to introduce the circumstances and any kind of hurdles that can be faced by any pentester while solving CTF challenges or OSCP labs which are based on Linux privilege escalations. Here we do not criticizing any kind of misconfiguration that a network or system administrator does for providing higher permissions on any programs/binaries/files &amp; etc.”  </em></strong></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Table of Content </span> </strong></span></h3>
<ul>
<li><span style="color: #000000;">Introduction to ZIP</span></li>
<li><span style="color: #000000;">Major functions of ZIP command</span></li>
<li><span style="color: #000000;">Sudo Rights Lab setups for Privilege Escalation</span></li>
<li><span style="color: #000000;">Exploiting Sudo rights</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Introduction to ZIP</strong></span></h3>
<p><span style="color: #000000;"><strong>Zip</strong> is helpful for packaging a number of distribution files, archiving files, and disk storage by compressing unused files or directories momentarily. You can pack a whole directory structure into a single command zip archive. For text files, 2:1 to 3:1 compression ratio is commonplace. But that’s not all. What else we can do with the Zip command. Let’s think out of the box. Now we are doing something creative which might have not tried before; that is, we are trying Privilege Escalation with Zip command. Let’s understand how. In order to perform this first, we will tell you what a Zip command does in Linux. So, let’s start.</span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Major Operations Performed Using ZIP command          </span> </strong></span></h3>
<p><span style="color: #000000;">First, we will run <strong>zip -h</strong> command which means help; it tells you about all the options available in zip command as shown in the picture below.</span></p>
<pre class="lang:default decode:true">zip -h</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UmwcEa3ggas/XPqNkF0iNbI/AAAAAAAAerI/CNgmWr23H8IjgVNQfWhlMsQEHTk9nrjHQCLcBGAs/s1600/0.png"/></span></p>
<p><span style="color: #000000;">So, our first step is to make a directory. We will first create a directory by the name Ignite and then I will create some text files into this by using touch command.</span></p>
<p><span style="color: #000000;">As you can see, we have created three text files by the name of <em>file1.txt, file2.txt, file3.txt</em> in this folder Ignite. Now we will zip <strong>file1</strong>.txt and <strong>file3.txt</strong> and give this file a name zip <strong>file.zip</strong> followed by the file names.</span></p>
<p><span style="color: #000000;">After this step, we will use <strong>ls -la</strong> command to check the list of the files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-z1fYvJZqAag/XPqNkD_GwwI/AAAAAAAAerE/IyeJzEm8r5AN8fJ1UiGqU2DZs_Or9Hx2QCLcBGAs/s1600/1.png"/></span></p>
<h3><span style="color: #800000;"><strong>Delete with -d option</strong></span></h3>
<p><span style="color: #000000;"><strong>-d option </strong>– It deletes the file from the zip file. You can delete a file from the archive with the <strong>-d</strong> option after generating a <strong>zip</strong> file as we did with <strong>file3.txt</strong>. We are using -d command to delete <strong>file3</strong>.txt from the zip file. So first we will specify the zip file name from where we want to delete the file.</span></p>
<pre class="lang:default decode:true">zip -d file.zip file3.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5FpLXE3Vdmk/XPqNjxEaEoI/AAAAAAAAerA/3SIGtGwI1TU7B7DBZyU2BO6oGn7KxgY6QCLcBGAs/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Update with -u option</strong></span></h3>
<p><span style="color: #000000;">so, you will notice that file3.txt is deleted from the file.zip. Now we want to update the zip file and add a text file directly into the zip file. So, we will use -u option</span></p>
<pre class="lang:default decode:true">zip -u file.zip file2.txt</pre>
<p><span style="color: #000000;">by using the above command, you will notice that file2.txt is directly added into the zip file. i.e. file.zip</span></p>
<h3><span style="color: #800000;"><strong>Move Multiple files with -m option</strong></span></h3>
<p><span style="color: #000000;">Now we will first create files of different extensions in our named <strong>Ignite</strong>. As you can see that we have created two files of <strong>txt</strong>, two files of <strong>pdf</strong> extension and two files of <strong>jpg</strong> extensions. So, we have files with different extensions. In order to move files of different extensions in a zip file then we need to use <strong>-m </strong>option. Here you can see that we are using -m option to move all text files in zip file. So, we will run the following command-</span></p>
<pre class="lang:default decode:true">zip -m 1.zip *.txt</pre>
<p><span style="color: #000000;">As we can check through <strong>ls -la </strong>that all are text files has been moved into a zip file and as well as all the text files are deleted from their original destination; which reflects that we have performed it successfully. So, we are now trying this on <strong>pdf</strong> and <strong>jpg</strong> files as well to move them in a <strong>1.zip zip file.</strong></span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-wZpVJSrpl04/XPqNk_vE8zI/AAAAAAAAerM/nDfWUpYlWP46DUZQbrTntOUa84OiI87QACLcBGAs/s1600/3.png"/></strong></span></p>
<h3><span style="color: #800000;"><strong>Execute system command using zip</strong></span></h3>
<p><span style="color: #000000;">You might have not thought of what else we can do with zip command. We can run any Linux command with the zip file as we are going to do. First, we will make one txt file with touch command as we have done above. The file named raj.txt is created. Now we are trying to execute any Linux command through zip command. Run the following command along with zip file and we will get the output.</span></p>
<pre class="lang:default decode:true">zip 1.zip raj.txt -T --unzip-command="sh -c ifconfig"</pre>
<p><span style="color: #000000;">As you can see that we have executed the system command through zip command.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-wg7CQ9NB0ro/XPqNlMGFxZI/AAAAAAAAerQ/8TErtXOHdEwPOsdRKRWFa0lfuMzBvT2qgCLcBGAs/s1600/4.png"/></strong></span></p>
<h3><span style="color: #800000;"><strong><u>Exploiting Zip</u></strong></span></h3>
<h3><span style="color: #800000;"><strong>Sudo Rights Lab setups for Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">The behaviour of zip gets changed when running with higher privilege. Let’s suppose the system admin had given sudo permission to the local user to run zip. This is can be led to privilege escalation once the system is compromised. So here we are going to put <strong>test</strong> user in the <strong>sudoers </strong>file so that <strong>test</strong> user has root the privileges to run zip command as sudo user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9RWX_9P5nVQ/XPqNlKlMChI/AAAAAAAAerU/HnbSgjtBYNQU9nkBPM0qjVgXYGQJTCUIwCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Now imagine can we have Privilege shell of victim’s pc by exploiting zip program. It’s very difficult to even think of but very easy to perform. So, let’s do that. First, go to <strong>kali’s</strong> terminal and connect ubuntu with <strong>ssh</strong> as we have done in below-</span></p>
<pre class="lang:default decode:true">ssh test@192.168.1.108</pre>
<p><span style="color: #000000;">Well-done. We have connected through <strong>ssh </strong>successfully.</span></p>
<p><span style="color: #000000;">Now we will run <strong>sudo -l</strong> command to check the list the entries of sudo files which are a member of the sudoers file. In the list, we can see that test is a member of the sudoers file and can run the zip program with root privilege.</span></p>
<p><span style="color: #000000;"><strong>Let’s exploit!!</strong></span></p>
<p><span style="color: #000000;">Now first we will create a file with <strong>touch</strong> command as we have created a file <strong>raj.txt</strong> and now we will compress the raj.txt and through zip file, we are taking a shell. So that we will run the following command-</span></p>
<pre class="lang:default decode:true">sudo zip 1.zip raj.txt -T --unzip-command="sh -c /bin/bash"</pre>
<p><span style="color: #000000;">Now we can see that we have successfully taken the shell of the victim’s machine through <strong>zip</strong> command.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5cbgZSouETM/XPqNloPlqnI/AAAAAAAAerY/4spYSoVf_HIcu37xXfMQX5-j_y1YBUuwgCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;"><b>Author</b>: Geet Madan is a Certified Ethical Hacker, Researcher and Technical Writer at Hacking Articles on Information Security<b>. </b>Contact <a style="color: #000000;" href="https://www.linkedin.com/in/geet-madan/"><b>here</b></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
