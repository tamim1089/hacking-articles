<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Manual Post Exploitation on Windows PC (Network Command)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/manual-post-exploitation-windows-pc-network-command/" rel="bookmark"><time class="entry-date published updated" datetime="2018-02-22T10:42:59+00:00">February 22, 2018</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today you will learn how to penetrate a network for enumerating any information of a system once it is compromised by an attacker.</span></p>
<p><span style="color: #000000;"><strong>Requirement</strong></span></p>
<p><span style="color: #000000;"><strong>Attacker:</strong> Kali Linux</span></p>
<p><span style="color: #000000;"><strong>Targets:</strong> Windows operating system</span></p>
<p><span style="color: #000000;">Open Kali Linux terminal and type msfconsole in order to load Metasploit framework.  Now you need to compromise victim’s machine once to achieve any type of session either meterpreter or shell and to do so you can read our previous article from <a style="color: #000000;" href="http://www.hackingarticles.in/msfvenom-tutorials-beginners/"><strong>here</strong></a><strong>. </strong>Now to make Post Exploitation, we will need an Administrator Privileged shell, which can be found <a style="color: #000000;" href="https://www.hackingarticles.in/multiple-ways-to-bypass-uac-using-metasploit/"><strong>here</strong></a>.</span></p>
<h3><span style="color: #800000;"><strong>Get Information about Network Cards</strong></span></h3>
<p><span style="color: #000000;">We can enumerate information about the Network Interface Cards using the systeminfo command.</span></p>
<p><span style="color: #000000;">Information can be extracted:</span></p>
<p><span style="color: #000000;">The number of NIC Cards, Manufacturer of NIC Cards, Model, Type (Wireless or LAN).</span></p>
<pre class="lang:default decode:true">systeminfo | findstr Network</pre>
<p><span style="color: #000000;">From given below image you can observe 2 Network Interface Cards is installed.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-JKP_Q9bSAt8/Wo6Y7AtGTzI/AAAAAAAAUwE/n6kuNksYr10wXvAOCPne5QYfgHJiYugewCEwYBhgL/s1600/1.png"/></span></p>
<h3><span style="color: #800000;"><strong>ARP</strong></span></h3>
<p><span style="color: #000000;">Arp or Address Resolution Protocol converts the maps the IP Address to the MAC Address of the Devices. Using the <strong>arp command</strong> we can enumerate the mac addresses of other systems in the same network as the victim’s system.</span></p>
<p><span style="color: #000000;">Here we are using [-a] to get the list of all the entries of arp cache.</span></p>
<pre class="lang:default decode:true">arp -a</pre>
<p><span style="color: #000000;">From given below image you can see the stored Mac address of arp table.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iD_7KURMhOI/Wo6Y822wzYI/AAAAAAAAUwg/p4gb7MAsoLk2JeTGTRhsjkjbEDEhqo5_ACEwYBhgL/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Get DNS Cache</strong></span></h3>
<p><span style="color: #000000;">We can enumerate DNS Resolver cache using the ipconfig command.</span></p>
<p><span style="color: #000000;">DNS Resolver is a temporary database, maintained by the operating system. It contains records of all the recent visits or the attempted visits to websites and other internet domains.</span></p>
<p><span style="color: #000000;">Here we are using [/displaydns] to display the complete DNS cache.</span></p>
<pre class="lang:default decode:true">ipconfig /displaydns</pre>
<p><span style="color: #000000;">From given below image you can observer following output is contains:</span></p>
<ul>
<li><span style="color: #000000;"><strong>Record Name:</strong> Name with which the DNS query was initiated</span></li>
<li><span style="color: #000000;"><strong>Record Type:</strong> It is a number to represent the IPv4 or IPv6 address (1 is for IPv4 and 28 is for IPv6)</span></li>
<li><span style="color: #000000;"><strong>Time To Live: </strong>Time in seconds after which cache entry will expire</span></li>
<li><span style="color: #000000;"><strong>Data Length:</strong> Length of the data in bytes, IPv4 has 4 bytes and IPv6 has 16 bytes</span></li>
<li><span style="color: #000000;"><strong>A/AAAA Record:</strong> A is the Address of IPv4 and AAAA is the address of IPv6 (Four A because the address is four times in size as compared to IPv4)</span></li>
</ul>
<p><span style="color: #000000;"><strong> </strong><img decoding="async" src="https://2.bp.blogspot.com/-Ry4Sb1yOwEA/Wo6Y9Rr-x2I/AAAAAAAAUwo/3cvII5umkmsLZahLtROwdWKaD1Ad3khwACEwYBhgL/s1600/3.png"/></span></p>
<h3><span style="color: #800000;"><strong>Display all the Connections and Listening Ports on a System</strong></span></h3>
<p><span style="color: #000000;">While penetration testing a Remote PC, knowledge of all the connections and listening ports along with the Process id is essential so that we can migrate session if needed</span></p>
<p><span style="color: #000000;">This can be done using <strong>the netstat</strong> command</span></p>
<p><span style="color: #000000;">Here we are using the following options with netstat command:</span></p>
<ul>
<li><span style="color: #000000;"><strong>[-a]</strong> to display all connections and listening ports </span></li>
<li><span style="color: #000000;"><strong>[-n]</strong> to display address and port number numerically</span></li>
<li><span style="color: #000000;"><strong>[-o]</strong> to display the Process ID</span></li>
</ul>
<pre class="lang:default decode:true">netstat -ano</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-n7py5UyE51U/Wo6Y9Pws-tI/AAAAAAAAUxM/DQj5xL0FVqMXeN5FCCFNc15fAytVMsmdACEwYBhgL/s1600/4.png"/></span></p>
<h3><span style="color: #800000;"><strong>Display All the TCP Connections</strong></span></h3>
<p><span style="color: #000000;">To enumerate all the TCP connections, we will use the netstat command. Here we are using the following options with netstat command:</span></p>
<p><span style="color: #000000;"><strong>[-a]</strong> to display all connections and listening ports </span></p>
<p><span style="color: #000000;"><strong>[-n]</strong> to display addresses and port numbers in numeric form</span></p>
<p><span style="color: #000000;">We are going to use the findstr command to filter out the Connections which mentions TCP.</span></p>
<pre class="lang:default decode:true">netstat -na | findstr TCP</pre>
<p><span style="color: #000000;">From giving below image you can observe that all state of TCP connection i.e. <strong>Listening, Established</strong> and <strong>Close Wait</strong> on their respective Port number.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-5hBtch4-6ec/Wo6Y9h9DQoI/AAAAAAAAUxI/d9Qw4zxgQV8iCFa-FOqPrA3j0YxtR8G2ACEwYBhgL/s1600/5.png"/></span></p>
<h3><span style="color: #800000;"><strong>Display All the UDP Connections</strong></span></h3>
<p><span style="color: #000000;">To enumerate all the UDP connections, we will use the netstat command. Here we are using the following options with netstat command:</span></p>
<p><span style="color: #000000;"><strong>[-a]</strong> to display all connections and listening ports </span></p>
<p><span style="color: #000000;"><strong>[-n]</strong> to display addresses and port numbers in numeric form</span></p>
<p><span style="color: #000000;">We are going to use the findstr command to filter out the Connections which mentions UDP.</span></p>
<pre class="lang:default decode:true">netstat -na | findstr UDP</pre>
<p><span style="color: #000000;">Similarly From give below image you can observe that all state of UDP connection on their respective Port numbers is left <strong>blank *:*</strong> which means no UDP connection established.</span></p>
<p><span style="color: #000000;"><strong> </strong><img decoding="async" src="https://3.bp.blogspot.com/-tSzMe3bI25M/Wo6Y94QtYBI/AAAAAAAAUxI/Uy0sf90BcE44CAGX5feT8mYf3EgrmeHlACEwYBhgL/s1600/6.png"/></span></p>
<h3><span style="color: #800000;"><strong>Display All the Established Connections</strong></span></h3>
<p><span style="color: #000000;">While penetration testing a Remote PC, knowledge of all Established connections and listening ports is also essential. This can be done using <strong>the netstat</strong> command.</span></p>
<p><span style="color: #000000;">Here we are using the following options with netstat command:</span></p>
<p><span style="color: #000000;"><strong>[-n]</strong> to display addresses and port numbers in numeric form</span></p>
<p><span style="color: #000000;"><strong>[-a]</strong> to display all connections and listening ports </span></p>
<p><span style="color: #000000;">We are going to use find command to filter out the Connections which mentions Established.</span></p>
<pre class="lang:default decode:true">netstat -ano | findstr ESTABLISHED</pre>
<p><span style="color: #000000;">From given below image you can observe that it shows established TCP connection through between source IP source Port and destination IP and Destination Port.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-yc-8ziuCCfM/Wo6Y91kIWKI/AAAAAAAAUxI/EAd7GTq8Ygcb3K3RSufHneSizod6xJvIQCEwYBhgL/s1600/7.png"/></span></p>
<h3><span style="color: #800000;"><strong>Display the Routing Tables</strong></span></h3>
<p><span style="color: #000000;">While penetration testing a Remote PC, knowledge of Routing Tables is essential because Routing tables are used to generate the information about the routes which were chosen by the routing algorithm as preferred routes for packet forwarding and it gives info about the netmask and gateways too.</span></p>
<p><span style="color: #000000;">It contains the <strong>Interface List, IPv4 Route Table, Persistent Routes, IPv6 Route Table</strong>.</span></p>
<p><span style="color: #000000;">This can be done using <strong>the netstat</strong> command</span></p>
<p><span style="color: #000000;">Here we are using the following options with netstat command:</span></p>
<p><span style="color: #000000;"><strong>[-n]</strong> to display addresses and port numbers in numeric form</span></p>
<p><span style="color: #000000;"><strong>[-r]</strong> to display the routing table </span></p>
<pre class="lang:default decode:true">netstat –nr</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-TD_S-TZA-F0/Wo6Y-X_roSI/AAAAAAAAUxM/Xsyqto0aTOAlV24pWm5FdmhpWXZ9bShkACEwYBhgL/s1600/8.png"/></span></p>
<h3><span style="color: #800000;"><strong>Get Executables Which Created Connections</strong></span></h3>
<p><span style="color: #000000;">While penetration testing a Remote PC, knowledge of all <strong>executable involved in creating each connection, all connections and listening ports, addresses and port numbers in numerical form, owning process ID</strong> is very essential because it gives the attacker information about the connections, port numbers as well as the Process ID.</span></p>
<p><span style="color: #000000;">This can be done using <strong>the netstat</strong> command</span></p>
<p><span style="color: #000000;">Here we are using the following options with netstat command:</span></p>
<p><span style="color: #000000;"><strong>[-b]</strong> to displays the executable involved in creating each connection or listening port</span></p>
<p><span style="color: #000000;"><strong>[-a]</strong> to display all connections and listening ports </span></p>
<p><span style="color: #000000;"><strong>[-n]</strong> to display addresses and port numbers in numeric form</span></p>
<p><span style="color: #000000;"><strong>[-o]</strong> to display the owning process ID associated with each connection</span></p>
<pre class="lang:default decode:true">netstat –bano</pre>
<p><span style="color: #000000;">From given below image you can observe that it is showing the name of running service on a particular port.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XeH32LLMPZg/Wo6Y-aVM5uI/AAAAAAAAUxQ/wKg1XZVP2voWViE7m2fG-LPLc5GZ7iQtwCEwYBhgL/s1600/9.png"/></span></p>
<h3><span style="color: #800000;"><strong>Get All the Adapters </strong></span></h3>
<p><span style="color: #000000;">We can enumerate all the adapters connected to the victim’s system by using the ipconfig command.</span></p>
<p><span style="color: #000000;">As the output of ipconfig command is very vast so we will use the findstr command to filter out the specific result about the adapters.</span></p>
<pre class="lang:default decode:true">ipconfig | findstr adapter</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-slQEuphxhZQ/Wo6Y64EQ6lI/AAAAAAAAUxQ/Fd4L2QBZpXUBfw79tIO7BRFL4Q6F0eetwCEwYBhgL/s1600/10.png"/></span></p>
<h3><span style="color: #800000;"><strong>Get All the Addresses </strong></span></h3>
<p><span style="color: #000000;">We can enumerate all the address including IPv4 and IPv6 by using ipconfig command.</span></p>
<p><span style="color: #000000;">As the output of the ipconfig command is very vast so we will use the findstr command to filter out the specific result about the address.</span></p>
<pre class="lang:default decode:true">ipconfig | findstr Address</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ePvixM4xT10/Wo6Y6_R0sKI/AAAAAAAAUxA/FivO3SN9JPQcf7LcH0-5KbJfVLF_6ZBLgCEwYBhgL/s1600/11.1.png"/></span></p>
<h3><span style="color: #800000;"><strong>Get the Basic IP Details</strong></span></h3>
<p><span style="color: #000000;">We can get the Basic Network Configuration on the Victim’s System and the Network in which the Victim is connected to through the ipconfig command.</span></p>
<p><span style="color: #000000;"><strong>[/all]</strong> is used to extract all the ipconfig information</span></p>
<pre class="lang:default decode:true">ipconfig /all</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ETXklwM47Og/Wo6Y7oRlbvI/AAAAAAAAUxE/qZEtBCiNpsUbVVpB_5sCh9qn-a2snpF4ACEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Victim System is connected to a Wi-Fi so its properties can be viewed below</span></p>
<p><span style="color: #000000;"><strong>Things to enumerate:</strong></span></p>
<p><span style="color: #000000;">Adapter Name, Model, Type, MAC Address, IPv4 Address, IPv6 Address, Subnet Mask, DHCP Server, Default Gateway and much more.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Erl8FCpNXjE/Wo6Y7ucuNgI/AAAAAAAAUxA/hMLOUPeVIMgxespsLADdTpuXuywyVmXxwCEwYBhgL/s1600/12.png"/></span></p>
<h3><span style="color: #800000;"><strong>Ping Sweep</strong></span></h3>
<p><span style="color: #000000;">Ping Sweep is a networking technique to get a range of active terminals on the network.</span></p>
<p><span style="color: #000000;">IP Addresses from which we get a reply are active, rest are not.</span></p>
<pre class="lang:default decode:true">for /L %i in (100,1,225) do ping 192.168.1.%i | findstr TTL</pre>
<p><span style="color: #000000;">From given below image you observe the result of multiple Ping response in a network using Ping command loop.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-5X0jv8WXDx8/Wo6Y7ySYSNI/AAAAAAAAUxE/WJ_g4XL03UcslXB8FQ9eZACUnNhr0VoFgCEwYBhgL/s1600/13.png"/></span></p>
<h3><span style="color: #800000;"><strong>UDP Statistics</strong></span></h3>
<p><span style="color: #000000;">In order to obtain statistics for established UDP connection, we can execute given command which describes information of UDP traffic sent or received.</span></p>
<pre class="lang:default decode:true">netstat -s -p udp</pre>
<p><span style="color: #000000;"><strong>[-s]</strong> denotes statics option</span></p>
<p><span style="color: #000000;"><strong>[-p]</strong> denotes protocols</span></p>
<p><span style="color: #000000;">From given below image you can observe that it showing details such as datagram received, received error and etc.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-beFbS9r2UtM/Wo6Y8A2-CCI/AAAAAAAAUxQ/IaFGr8DP1tI5JwG6_0gFb0UDphdc2y_zwCEwYBhgL/s1600/14.png"/></span></p>
<h3><span style="color: #800000;"><strong>TCP Statistics</strong></span></h3>
<p><span style="color: #000000;">In order to obtain statistics for the established TCP connection, we can execute given command which describes information of TCP traffic sent or received.</span></p>
<pre class="lang:default decode:true">netstat -s -p tcp</pre>
<p><span style="color: #000000;"><strong>[-s]</strong> denotes statics option</span></p>
<p><span style="color: #000000;"><strong>[-p]</strong> denotes protocols</span></p>
<p><span style="color: #000000;">From given below image you can observe that it showing details such as segment received, failed attempted, Reset connection and etc.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-rdUZaOnpyw0/Wo6Y8TFpVHI/AAAAAAAAUxE/-ErYlAb2ycUJNh04NgpYuWFy6THD3JShgCEwYBhgL/s1600/15.png"/></span></p>
<h3><span style="color: #800000;"><strong>Display Connections Sorted by Port</strong></span></h3>
<p><span style="color: #000000;">Options Used:</span></p>
<p><span style="color: #000000;"><strong>[-a]:</strong> To Display all active TCP connections and UDP ports on which</span></p>
<p><span style="color: #000000;"><strong>[-n]:</strong> Addresses and Port Numbers are displayed numerically</span></p>
<p><span style="color: #000000;"><strong>[-o]:</strong> Display Connections with process IDs</span></p>
<p><span style="color: #000000;">We are using findstr to sort result for 443 Ports</span></p>
<pre class="lang:default decode:true ">netstat -ano | findstr 443</pre>
<p><span style="color: #000000;">From given below image you can observe that it has shown TCP connection state only for port 443.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-8EJTqmSe7-w/Wo6Y8ogVyMI/AAAAAAAAUxE/87rY7BghVXUrX06-G0bifiHOpsO0YCWqACEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester Contact <a style="color: #000000;" href="https://www.linkedin.com/in/pavandeep-singh-6b1074132"><strong>here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
