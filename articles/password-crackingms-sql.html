<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/password-cracking/" rel="category tag">Password Cracking</a></span>            </div>
            <h1 class="post-title entry-title">Password Cracking:MS-SQL</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/password-crackingms-sql/" rel="bookmark"><time class="entry-date published" datetime="2018-03-16T06:32:13+00:00">March 16, 2018</time><time class="updated" datetime="2025-05-30T17:52:37+00:00">May 30, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-45 ai-optimize-introduction"><span style="color: #000000;">MSSQL brute-force attacks are a frequent initial access tactic during internal assessments and red team ops. Microsoft SQL Server—commonly exposed on TCP port 1433—often holds sensitive data and privileges, making it a high value target. When SQL authentication is enabled, attackers may exploit weak credentials using tools like Hydra, Metasploit, or Nmap NSE.</span></p>
<p class="ai-optimize-46"><span style="color: #000000;">This guide explores advanced techniques for exploiting MSSQL authentication mechanisms across diverse network environments.</span></p>
<h4 class="ai-optimize-47"><span style="color: #000000;">MITRE ATT&amp;CK Techniques:</span></h4>
<ul>
<li class="ai-optimize-48"><span style="color: #000000;"><strong>T1110.001 – </strong>Brute Force: Password Guessing</span></li>
<li class="ai-optimize-49"><span style="color: #000000;"><strong>T1046 – </strong>Network Service Scanning</span></li>
<li class="ai-optimize-50"><span style="color: #000000;"><strong>T1078 – </strong>Valid Accounts</span></li>
</ul>
<h3 class="ai-optimize-51"><span style="color: #800000;">Table of Contents</span></h3>
<p class="ai-optimize-52"><span style="color: #000000;"><strong>Introduction</strong></span></p>
<p class="ai-optimize-53"><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li class="ai-optimize-54"><span style="color: #000000;">Scan for Open MSSQL Port with Nmap</span></li>
</ul>
<p class="ai-optimize-55"><span style="color: #000000;"><strong>Brute-Force Techniques</strong></span></p>
<ul>
<li class="ai-optimize-56"><span style="color: #000000;">Hydra</span></li>
<li class="ai-optimize-57"><span style="color: #000000;">Metasploit</span></li>
<li class="ai-optimize-58"><span style="color: #000000;">Medusa</span></li>
<li class="ai-optimize-59"><span style="color: #000000;">NetExec (nxc)</span></li>
<li class="ai-optimize-60"><span style="color: #000000;">Ncrack</span></li>
<li class="ai-optimize-61"><span style="color: #000000;">Patator</span></li>
<li class="ai-optimize-62"><span style="color: #000000;">Nmap NSE Script (ms-sql-brute.nse)</span></li>
</ul>
<h2 class="ai-optimize-63"><span style="color: #800000;">Introduction</span></h2>
<p class="ai-optimize-64"><span style="color: #000000;">Microsoft SQL Server (MSSQL) is a relational database platform commonly deployed in enterprise networks to manage and store structured data. It communicates over TCP port 1433 and supports both SQL and Windows authentication mechanisms. While Windows authentication offers better security via Active Directory integration, SQL authentication remains widely used—often with weak or default credentials.</span></p>
<p class="ai-optimize-65"><span style="color: #000000;">MSSQL instances, especially in internal or hybrid environments, can become high value targets due to their access to sensitive data and administrative privileges. Improperly secured deployments may allow attackers to exploit exposed services through brute force attacks, making MSSQL a critical component in penetration testing and red teaming assessments.</span></p>
<h2 class="ai-optimize-66"><span style="color: #800000;">Enumeration</span></h2>
<h3 class="ai-optimize-67"><span style="color: #800000;">Nmap Scan</span></h3>
<p class="ai-optimize-68"><span style="color: #000000;">Firstly, to begin the enumeration process, we perform an Nmap scan against the target IP address to identify an open MSSQL service and gather information about the server version. This helps confirm the presence of a SQL Server instance and assess potential vulnerabilities based on version or configuration.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p 1433 -sV 192.168.1.80</pre>
<p class="ai-optimize-70"><span style="color: #000000;"><strong>Explanation:</strong></span></p>
<ul>
<li class="ai-optimize-71"><span style="color: #000000;"><strong>-p 1433</strong>: Scans for the default Microsoft SQL Server on port 1433.</span></li>
<li class="ai-optimize-72"><span style="color: #000000;"><strong>-sV</strong>: Enables version detection to identify the specific MSSQL version running on the target host.</span></li>
</ul>
<p class="ai-optimize-73"><span style="color: #000000;">Once Nmap confirms that port 1433 is open and an MSSQL service is active, this information can be used to plan targeted authentication attacks or service specific exploitation in the next phase.</span></p>
<p class="ai-optimize-255"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgaF8XrRkUKfV9CNs-54SVMCR1KOZObL5ruqBoxl2QAKO8OHE1iocQdIucsJlszYB8WKAQmIT-gJuw1v5p9oJ7amgNfjRy_P5Prmo68dtfWDvgiJnhsTC2XWcjOanPWsYW-o7ojIicS4dhsEHwz_40a3YAo09x_D302UzhhI2byIEe9OfAJoAXXuPHTeo6n/s16000/1.png"/></span></p>
<h4 class="ai-optimize-74"><span style="color: #000000;">Defensive Strategy:</span></h4>
<p class="ai-optimize-75"><span style="color: #000000;">Use IDS/IPS (e.g., Zeek, Suricata) to detect scan behavior. Limit SQL access to known IPs using firewall/NSG policies.</span></p>
<h2 class="ai-optimize-76"><span style="color: #800000;">Brute-Force Techniques</span></h2>
<h3 class="ai-optimize-77"><span style="color: #800000;">Tools Quick Reference</span></h3>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhQrRWUaRnRAZDnVOGOUeNPqcHYwoISWtJd78tZnE9jWmfQT4Gcw0_IkYIsCPzhoepTu2ERz3HhMFvpll282Qoazh2umFMOceA6Hjflbhm4BTe9UDCpO62f4KAUd92a6reL-QgG0kqY91KxDx-rdoWSHGqeNg8IREQZzUURp-Cb1Vo8Fh1U7sIJhGCn0C2m/s16000/tool.png"/></p>
<h3 class="ai-optimize-254"><span style="color: #800000;">Hydra</span></h3>
<p class="ai-optimize-102"><span style="color: #000000;">Hydra is particularly effective in environments where SQL authentication is enabled and weak or default credentials are in use. The success of such attacks largely depends on the quality of the wordlists used, such as user.txt for usernames and pass.txt for passwords. The success of such attacks largely depends on the quality of the wordlists used, such as user.txt for usernames and pass.txt for passwords.</span></p>
<h4 class="ai-optimize-103"><span style="color: #000000;">Step To Reproduce</span></h4>
<p class="ai-optimize-104"><span style="color: #000000;">To perform a brute force attack against an MSSQL service, use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hydra -L user.txt -P pass.txt 192.168.1.80 mssql</pre>
<p class="ai-optimize-106"><span style="color: #000000;"><strong>Explanation:</strong></span></p>
<ul>
<li class="ai-optimize-107"><span style="color: #000000;"><strong>-L user.txt</strong>: Specifies the path to the username list.</span></li>
<li class="ai-optimize-108"><span style="color: #000000;"><strong>-P pass.txt</strong>: Specifies the path to the password list.</span></li>
<li class="ai-optimize-109"><span style="color: #000000;"><strong>192.168.1.80</strong>: Target IP address.</span></li>
<li class="ai-optimize-110"><span style="color: #000000;"><strong>mssql</strong>: Protocol to attack.</span></li>
</ul>
<p class="ai-optimize-111"><span style="color: #000000;">Hydra will systematically test each username-password pair against the MSSQL service on the specified host. If valid credentials are found, Hydra will clearly report the success.</span></p>
<p class="ai-optimize-256"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgSmp8BCYD14xaBL_et8LLRdJnqIGxxG9QFuAfhCmjItw3fAsb3x_vgVHkulaBX-GG6J2rk2uxq1Nj74ZFFzea1LU0sQZpV9ObmAc1wTe8q2RwMe2bGSAcrUYXIUtuQXudefuO9x-bY0WJOo0FiLsU6FcUL0kjxD-k1nWbLmHqFk2GOGnIsSn59jKKxBe7v/s16000/2.png"/></span></p>
<h4 class="ai-optimize-112"><span style="color: #000000;">Detection Strategy:</span></h4>
<p class="ai-optimize-113"><span style="color: #000000;">Enable SQL Server Audit or Extended Events. Detect failed logins (Event ID 18456) and alert via SIEM. Apply IP-based throttling using Fail2Ban or firewall rules.</span></p>
<h3 class="ai-optimize-114"><span style="color: #800000;">Metasploit</span></h3>
<p class="ai-optimize-264"><span style="color: #000000;"><strong>Metasploit</strong> includes auxiliary module that enables automated brute force attempts with detailed logging, modular options, and integration into post exploitation workflows. It’s particularly effective during red team simulations where SQL Server access is needed for pivoting, lateral movement, or persistence. The framework’s output is structured, which makes it useful for integration with reporting tools or pipelines.</span></p>
<p class="ai-optimize-115"><span style="color: #000000;">This module simply queries the MSSQL instance for a specific user/pass (default is sa with blank).</span></p>
<h4 class="ai-optimize-116"><span style="color: #000000;">Step To Reproduce</span></h4>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf6 &gt; use auxiliary/scanner/mssql/mssql_login
set rhosts 192.168.1.80
set user_file user.txt
set pass_file pass.txt
set verbose false
run</pre>
<p class="ai-optimize-123"><span style="color: #000000;"><strong>Explanation</strong>:</span></p>
<ul>
<li class="ai-optimize-124"><span style="color: #000000;"><strong>use auxiliary/scanner/mssql/mssql_login:</strong> Loads the MSSQL login scanner module used for brute force authentication.</span></li>
<li class="ai-optimize-125"><span style="color: #000000;"><strong>set rhosts 192.168.1.80:</strong> Specifies the IP address of the target MSSQL server.</span></li>
<li class="ai-optimize-126"><span style="color: #000000;"><strong>set user_file user.txt:</strong> Defines the file containing potential usernames.</span></li>
<li class="ai-optimize-127"><span style="color: #000000;"><strong>set pass_file pass.txt:</strong> Defines the file containing passwords to pair with the usernames.</span></li>
<li class="ai-optimize-128"><span style="color: #000000;"><strong>set verbose false:</strong> Disables verbose output to reduce console noise during the brute force process.</span></li>
<li class="ai-optimize-129"><span style="color: #000000;"><strong>run:</strong> Executes the module and begins testing all username password combinations against the MSSQL service.</span></li>
</ul>
<p class="ai-optimize-257"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhyEQk8eLC0DzGA-6P8z6_y4eieaSKNeyN8q_GKrSTvvB67UY7fPAIcT_30UvN1ni_xfQzucl9LxNOQezjXItYnI4Cw2cIQ_OVq2Ib377x6k-LVjcovNoxSxDo6AYefAWX5KtByjqx-Vdie2bWCs5gWNXTTdCML98JC-4VIBVzlzjEbk3XEvbMxYZWYAJql/s16000/4.png"/></span></p>
<h4 class="ai-optimize-130"><span style="color: #000000;">Defensive Control:</span></h4>
<p class="ai-optimize-131"><span style="color: #000000;">Monitor audit logs for repeated failures. And additionally block sources using host firewall or NSG. Detect scan to login sequences.</span></p>
<h3 class="ai-optimize-132"><span style="color: #800000;">Medusa</span></h3>
<p class="ai-optimize-133"><span style="color: #000000;"><strong>Medusa</strong> is designed to support <strong>large scale</strong> <strong>login attempts</strong> by testing multiple username password combinations simultaneously across <strong>multiple hosts</strong> or <strong>services</strong>. It is particularly effective in internal environments where <strong>SQL authentication</strong> is <strong>enabled.</strong></span></p>
<p class="ai-optimize-134"><span style="color: #000000;">In this case, we can efficiently attempt login combinations against MSSQL targets using prepared dictionaries such as <strong>user.txt</strong> and <strong>pass.txt</strong>.</span></p>
<h4 class="ai-optimize-135"><span style="color: #000000;">Step To Reproduce</span></h4>
<p class="ai-optimize-136"><span style="color: #000000;">Below we have successfully grabbed credentials using following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">medusa -h 192.168.1.80 -U user.txt -P pass.txt -M mssql | grep "ACCOUNT FOUND"</pre>
<p class="ai-optimize-138"><span style="color: #000000;"><strong>Explanation</strong>:</span></p>
<ul>
<li class="ai-optimize-139"><span style="color: #000000;"><strong>medusa</strong>: Invokes the Medusa brute force tool.</span></li>
<li class="ai-optimize-140"><span style="color: #000000;"><strong>-h 192.169.1.80</strong>: Specifies the IP address of the target machine.</span></li>
<li class="ai-optimize-141"><span style="color: #000000;"><strong>-U</strong>: Points to a file containing a list of usernames to try.</span></li>
<li class="ai-optimize-142"><span style="color: #000000;"><strong>-P</strong>: Points to a file containing a list of passwords.</span></li>
<li class="ai-optimize-143"><span style="color: #000000;"><strong>-M mssql</strong>: Indicates that the MSSQL module should be used for this attack.</span></li>
<li class="ai-optimize-144"><span style="color: #000000;"><strong>| grep “ACCOUNT FOUND”</strong>: Filters the command output to display only successful login attempts, making it easier to identify valid credentials.</span></li>
</ul>
<p class="ai-optimize-258"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjLSJdZ7xa1M404igXDg3S4AfrWrIiAvDVdFfJtniqK2R6Ppzjve88CBh-XVzEHA9t8ZvjjqZj7nVUT00bli7jZSilveGLAt5qwtIZCWW-qBLb6jh5eSP-TP2A9_U5gQwUL4UsssCFEXBimTR50-ddVwrF2RutkvNr6206LpoUbNksY6oAn5XNNZgGtvHY6/s16000/3.png"/></span></p>
<h4 class="ai-optimize-145"><span style="color: #000000;">Defensive Strategy:</span></h4>
<p class="ai-optimize-146"><span style="color: #000000;">Detect bulk login failures with SIEM correlation. Enable lockout policies and rate limits per IP.</span></p>
<h3 class="ai-optimize-147"><span style="color: #800000;">Netexec (aka nxc)</span></h3>
<p class="ai-optimize-148"><span style="color: #000000;">Among its many capabilities, NetExec can, for example, perform brute force attacks on Microsoft SQL Server by using specified username and password lists. It is particularly useful for mass validation of credential pairs obtained during earlier recon or OSINT phases, especially in internal environments where SQL authentication is enabled and network segmentation is limited.</span></p>
<h4 class="ai-optimize-149"><span style="color: #000000;">Step To Reproduce</span></h4>
<p class="ai-optimize-150"><span style="color: #000000;">To initiate a brute force attack against an MSSQL service using <strong>NetExec</strong>, run the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc mssql 192.168.1.80 -u user.txt -p pass.txt --local-auth | grep [+]</pre>
<p class="ai-optimize-152"><span style="color: #000000;"><strong>Explanation:</strong></span></p>
<ul>
<li class="ai-optimize-153"><span style="color: #000000;"><strong>nxc</strong>: Invokes the NetExec burte force tool</span></li>
<li class="ai-optimize-154"><span style="color: #000000;"><strong>mssql</strong>: Specifies the protocol to target for MSSQL.</span></li>
<li class="ai-optimize-155"><span style="color: #000000;"><strong>192.168.1.80</strong>: The IP address of the target host.</span></li>
<li class="ai-optimize-156"><span style="color: #000000;"><strong>-u user.txt</strong>: Path to the file containing a list of usernames.</span></li>
<li class="ai-optimize-157"><span style="color: #000000;"><strong>-p pass.txt</strong>: Path to the file containing a list of passwords.</span></li>
<li class="ai-optimize-158"><span style="color: #000000;"><strong>| grep [+]</strong>: Filters the command output to display only successful login attempts, making it easier to identify valid credentials.</span></li>
</ul>
<p class="ai-optimize-259"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhv5L74RzJW1TvBo1hG5DxtY8jmqzSG7TQ_BLDK_7NaDypYeXjyRzlmDwqvaiWIz3O0SAsFCN5tu-itx55A3Fmd-dXOqLbznUJcZsr-z0qRFWbk8uEz_an0ODKvTgH-_-owvsruQwG4hIkazJKVD8MI2GC2vMC1PHfa-xTnKWSsF7pHZnCxCb1HuZncXmCm/s16000/5.png"/></span></p>
<h4 class="ai-optimize-159"><span style="color: #000000;">Defensive Statergy:</span></h4>
<p class="ai-optimize-160"><span style="color: #000000;">Monitor failed and successful logins. Limit SQL access by IP. Enforce Windows Authentication where possible.</span></p>
<h3 class="ai-optimize-161"><span style="color: #800000;">Ncrack</span></h3>
<p class="ai-optimize-265"><span style="color: #000000;"><strong>Ncrack</strong> supports modular configuration and multithreaded execution, allowing for efficient brute force attempts while maintaining connection stability and performance.</span></p>
<p class="ai-optimize-162"><span style="color: #000000;">In <strong>MSSQL</strong>-focused operations, <strong>Ncrack</strong> is ideal for quickly testing <strong>username</strong> and <strong>password</strong> pairs against exposed database services, particularly in misconfigured or externally accessible SQL environments.</span></p>
<h4 class="ai-optimize-163"><span style="color: #000000;">Step To Reproduce</span></h4>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ncrack -U user.txt -P pass.txt 192.168.1.80 -p 1433</pre>
<p class="ai-optimize-165"><span style="color: #000000;"><strong>Explanation:</strong></span></p>
<ul>
<li class="ai-optimize-166"><span style="color: #000000;"><strong>ncrack</strong>: Launches the Ncrack password-cracking tool.</span></li>
<li class="ai-optimize-167"><span style="color: #000000;"><strong>-U user.txt</strong>: Indicates the file containing a list of potential usernames.</span></li>
<li class="ai-optimize-168"><span style="color: #000000;"><strong>-P pass.txt</strong>: Indicates the file containing a list of potential passwords.</span></li>
<li class="ai-optimize-169"><span style="color: #000000;"><strong>-p 1433</strong>: Specifies the MSSQL default port for authentication attempts.</span></li>
</ul>
<p class="ai-optimize-260"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjW4rpHhaRFi408ms6IezFEnIdXEXQBuqugHw-88sfsiz535Jo_OJwnOux3-0QHLhCbgX47SH1d0iwIYEDYiAfXbVMC8VJr9-tnVCjrdXVI7_q5ISwhnJsRbVytXfZMpQ_Oizcff6-mcZbSLaK-m79q9m1xVtg-jpZjergqdu447TlRReWj2Q1pgYU3GRky/s16000/6.png"/></span></p>
<h4 class="ai-optimize-170"><span style="color: #000000;">Defensive Strategy:</span></h4>
<p class="ai-optimize-171"><span style="color: #000000;">Rate-limit MSSQL connections per IP. Additionally, use NIDS to alert on rapid authentication attempts. Finally, restrict internet-facing SQL endpoints to minimize exposure.</span></p>
<h3 class="ai-optimize-172"><span style="color: #800000;">Patator</span></h3>
<p class="ai-optimize-266"><span style="color: #000000;"><strong>Patator</strong> allows fine-grained control over brute force behavior—such as custom delays, retry logic, and error handling—making it especially useful in stealthy or evasion-focused engagements.</span></p>
<p class="ai-optimize-173"><span style="color: #000000;">It can be used to perform MSSQL brute force attacks by iterating through supplied username and password lists which in this case will be user.txt and pass.txt.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">patator mssql_login host=192.168.1.80 user=FILE0 0=user.txt password=FILE1 1=pass.txt</pre>
<p class="ai-optimize-175"><span style="color: #000000;"><strong>Explanation</strong>:</span></p>
<ul>
<li class="ai-optimize-176"><span style="color: #000000;"><strong>patator</strong>: Launches the Patator brute force tool.</span></li>
<li class="ai-optimize-176"><span style="color: #000000;"><strong>mssql_login</strong>: Specifies the module for Microsoft SQL Server login attempts.</span></li>
<li class="ai-optimize-176"><span style="color: #000000;"><strong>host=192.168.1.80</strong>: Indicates the target machine’s IP address.</span></li>
<li class="ai-optimize-176"><span style="color: #000000;"><strong>user=FILE0 0=user.txt</strong>: Assigns FILE0 as a placeholder for usernames, pulling values from user.txt.</span></li>
<li class="ai-optimize-176"><span style="color: #000000;"><strong>password=FILE1 1=pass.txt</strong>: Assigns FILE1 as a placeholder for passwords, pulling values from pass.txt.</span></li>
</ul>
<p class="ai-optimize-261"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhmA7dXTcaskMLW9m6L5KYYFW8_4pqDK2J7vJR1eCtrvVnRUvuHUjyVb1Ke7XuzpBgzyep6-yXRmY80DuM6en1shhcGefCg-hcYIZ0O7PBmY3Cu__Sx781YZPMqIV4KKjyJ-0f64ffBzHNVHtxyBHOPqha6aLyvRZdaZWym2II-a0WP4k_qQkhpQF4wZWtO/s16000/7.png"/></span></p>
<p class="ai-optimize-262"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjBKm5amqpHoJIbZA4QiyilPm8ISM9lvPtepJRy6rnfOF6yI6V3fNyArAG3bjJpJUP2xCIRlPCq3zHthMaM4qI2b04xvAvnU7g50q8SUSk-PmXPU7weVr9RkMYN3l-t2KpHzsBN9dXbd4Wm8TqsClaxDiNvG1uvQtD7vVZjnm8wIAhpqYZbZvZTvqqApt80/s16000/8.png"/></span></p>
<p class="ai-optimize-181"><span style="color: #000000;"><strong><em>Note</em></strong><em>: You can add | grep ‘200 OK’ or -x ignore:code=530 for success filtering or to skip known failed responses based on Patator’s output codes.</em></span></p>
<h4 class="ai-optimize-182"><span style="color: #000000;">Defensive Suggestion:</span></h4>
<p class="ai-optimize-183"><span style="color: #000000;">Detect retry patterns via audit logs. Apply per-IP throttling. Additionally, Use IPS to block based on behavioural heuristics.</span></p>
<h3 class="ai-optimize-184"><span style="color: #800000;">Nmap NSE Script</span></h3>
<p class="ai-optimize-267"><span style="color: #000000;">The ms-sql-brute.nse script allows testers to perform credential based login attempts against Microsoft SQL Server using customized username and password lists.</span></p>
<p class="ai-optimize-268"><span style="color: #000000;"><strong>Step To Reproduce</strong></span></p>
<p class="ai-optimize-185"><span style="color: #000000;">Firstly, to perform a brute force attack against an MSSQL service using Nmap, run the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p1433 --script ms-sql-brute.nse --script-args userdb=user.txt,passdb=pass.txt 192.168.1.80</pre>
<p class="ai-optimize-187"><span style="color: #000000;"><strong>Explanation:</strong></span></p>
<ul>
<li class="ai-optimize-188"><span style="color: #000000;">–<strong>p1433</strong>: Scans the default port used by MSSQL.</span></li>
<li class="ai-optimize-189"><span style="color: #000000;"><strong>–script ms-sql-brute.nse</strong>: Specifies the use of the MSSQL brute force NSE script.</span></li>
<li class="ai-optimize-190"><span style="color: #000000;"><strong>–script-args userdb</strong>=user.txt,passdb=pass.txt: Provides the script with your custom username and password lists.</span></li>
</ul>
<p class="ai-optimize-191"><span style="color: #000000;">This method is especially useful during early stage reconnaissance to identify weak or default MSSQL credentials on a target system.</span></p>
<p class="ai-optimize-263"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiO5SwF9rVQ2Saso8mx3c3DQ5elMvOmUzH-PBixXYbtuKytqnld_Eg6QSdkQ6pDXmGtbwAX3BtER_oG4R0AuWb86hMCV38Ksf_r5QNzU0eh9GtUtTmnrVwCJetHN8_RAIqEikJltZeZWv9iTjAbucc5r5CSaDs0vTZrsu6DYQimxeD9evg5ItEiM6u48JyD/s16000/9.png"/></span></p>
<h4 class="ai-optimize-192"><span style="color: #000000;">Defensive Strategy:</span></h4>
<p class="ai-optimize-193"><span style="color: #000000;">Detect sequential login failures tied to Nmap scans. Block offending IPs and alert via SIEM.</span></p>
<h3 class="ai-optimize-194"><span style="color: #800000;">MSSQL Brute-Force – Offense, Defence &amp; MITRE Mapping</span></h3>
<p class="ai-optimize-235"><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhrYzyCMBPjmwhnYxuUExnqw7jTmzedT_2yczjhCY1-F5VcoNfYxbgPnEDJN0GtAJdTQwDmxjRQANtS3XRrwre8_pfv94uLoYey9sSfBqMJEqeMe2WsPptFUtM42yZobUoShS9phLuXkUDKc5F58QjKUdMHqk8gMsP-XBpcjvEL1uqT2czGn4FA7utqdGay/s16000/Mitre.png"/></strong></span></p>
<h3 class="ai-optimize-236"><span style="color: #800000;">Defence-in-Depth Summary</span></h3>
<p class="ai-optimize-251"><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhF0bgJJ8HL888CWihjIGKWbBilE_ipwImN1hMg5Rx_-taVqXSWnbYZG34kUEmFIqS21rwxJOLrOLDOJRNYmkzjd2H1LppZ3UpvenBdPWhbAxC7jMAT7eACZnSqAyc_C99cVD0X6VqNHzc6kqmU3pIM3OUjP5P_E5CMFBWHKVgABYHsIA2fpK_O5fzToDs8/s16000/defence.png"/></strong></span></p>
<p class="ai-optimize-231"><span style="color: #000000;">To learn more about Password Cracking. Follow this</span> <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/category/password-cracking/"><strong>Link</strong>.</a></span></p>
<p class="ai-optimize-252"><span style="color: #000000;"><strong>Author: </strong></span><span style="color: #000000;"><strong>Kinjal Patel </strong>is seasoned penetration tester and technical content writer. Contact at <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/kinjalpatel-pt/">LinkedIn</a></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
