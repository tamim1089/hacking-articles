<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box: Netmon Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-netmon-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-07-09T04:04:28+00:00">July 9, 2019</time><time class="updated" datetime="2025-06-27T12:35:01+00:00">June 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Netmon is a recently retired CTF VM on Hack the Box with the objective – Capture the user and root flag. Hack the Box offers a wide range of VMs for practice from beginner to advanced level and it is great for penetration testers and researchers.</span></p>
<p><span style="color: #000000;">Level: Intermediate</span></p>
<p><span style="color: #000000;">Task: To find user.txt and root.txt file</span></p>
<p><span style="color: #000000;">Note: Since these labs are online available, therefore, they have a static IP. The IP of netmon is 10.10.10.152</span></p>
<h3><span style="color: #993300;"><strong>Penetration Methodology</strong></span></h3>
<p><span style="color: #000000;"><strong>Scanning</strong></span></p>
<ul>
<li><span style="color: #000000;">    Network Scanning (Nmap)</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumerating</strong></span></p>
<ul>
<li><span style="color: #000000;"><strong>    </strong>Browsing the webpage</span></li>
<li><span style="color: #000000;">    Enumerating FTP</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;"><strong>   </strong>Anonymous Login in FTP</span></li>
<li><span style="color: #000000;">   Reading user.txt</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">     Enumerate for the config file</span></li>
<li><span style="color: #000000;">     Logging in Administrator Panel</span></li>
<li><span style="color: #000000;">     Exploiting RCE</span></li>
<li><span style="color: #000000;">     Reading root.txt</span></li>
</ul>
<h3><span style="color: #993300;"><strong>Walkthrough</strong></span></h3>
<p><span style="color: #000000;">Let’s start off with scanning with the nmap to check open ports.</span></p>
<pre class="lang:default decode:true">nmap -A 10.10.10.152</pre>
<p><span style="color: #000000;">Here I found port 21 for FTP, 80 for HTTP, 135 for RPC, 139 for NetBIOS, 445 for SMB are opened, rest were filtered.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-k6iQySucAaI/XSQOrJrEOUI/AAAAAAAAfF8/RE5kPQBT0i88rmgXDKBNJR2yzHYO0KspQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">We immediately proceed towards port 80 when we see it open. We find the PRTG Network Monitor page. But to use this dashboard, we need the login credentials. But we don’t have the access to those credentials at this stage.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aZ5y72ig7Qw/XSQOrCqYJ7I/AAAAAAAAfGA/4Se8784nCccLHPrBNfvIR-xuSc4URZ9qwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">In the nmap scan earlier, we saw that the FTP port 21 is open as well allows Anonymous Login. So, we login the FTP using the Anonymous as Login as well as password. After successfully logging, we use the ls command to list all the files that are shared. We see that we Users Directory available so we traverse into it using the cd command. Here, we have 2 more directories, Administrator and Public. We don’t have permission to access the Administrator directory so we move into the Public Directory. Here we find the user.txt file. We use the get command to download this file onto our system. Hence, we got our first flag, that is; the user flag.</span></p>
<pre class="lang:default decode:true">ftp 10.10.10.152
ls -la
cd Users
ls
cd Public
ls
get user.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-H7fco4FV6wo/XSQOsBeKOwI/AAAAAAAAfGM/1yWMmPUOAqQatSq7eN6bgZMlGlL2Z_jUACLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Now we need to get the root flag. For this, we went to our most dependable friend, Google. After working our way through some of the PRTG Network Monitor manuals and help pages, we found this <a style="color: #000000;" href="https://kb.paessler.com/en/topic/463-how-and-where-does-prtg-store-its-data">post</a>. This gives us the location of the data that PRTG Network Monitor stores, that is “%programdata%\Paessler\PRTG Network Monitor”. As we still have the FTP connection, we went to ProgramData directory and then traversed all the way to the location mentioned. Here we located an old configuration file. We downloaded this file to our system so that we can analyse it closely.</span></p>
<pre class="lang:default decode:true">cd ProgramData
ls -la
cd Paessler
ls
cd "PRTG Network Monitor"
ls
get "PRTG Configuration.old.bak"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-D1kMh6wSNH0/XSQOsAuMM-I/AAAAAAAAfGI/RREpyEo4jH0wpZunsALUCN44_yRUxvy0QCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">After successfully downloading and searching through many lines of code, we stumbled upon the password, that was used previously. We took a guess here, as this was the previous configuration and it contains the year 2018 and whenever there is a current date in the password then they could be updated with the change in the date to the latest date.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YHTlC5RdlNw/XSQOsbq2T4I/AAAAAAAAfGQ/zfQd_y0UHvQMUcaIuNZzsBh4IPa_TgizACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">This means, that the previous password was PrTg@dmin2018 and since the current year is 2019, we replaced 2018 in the password by 2019. This was an educated guess we made. So, using the new login credentials, we successfully logged in the PRTG Network Monitor Dashboard.</span></p>
<pre class="lang:default decode:true">Login Name: prtgadmin
Password: PrTg@dmin2019</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GP_wsQk9lAo/XSQOs6s9ztI/AAAAAAAAfGU/uTcdwBvv6cIV8rag0S4pvxpIkCpR2o4QACLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">After looking around the dashboard for some time, we didn’t find anything that could help us in our quest to get the root flag. So, we went to another dependable friend, Exploit DB. We searched the exploit dB for PRTG Network Monitor and found <strong><a style="color: #000000;" href="https://www.exploit-db.com/exploits/46527">this exploit</a>.</strong> On further researching on the internet about this exploit, we found <strong>this script</strong> on GitHub. This script creates a PowerShell file and then it uses it to run commands on the target system to create a user. But in order to work, it needs the cookie that was used in the original login in the dashboard of the PRTG Network Monitor. We capture the request using the Burp Suite. Upon close inspection of the captured packet, we find the cookie that we require.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-B1wipZxtEgY/XSQOtBgzfEI/AAAAAAAAfGY/4W1icrtjDiEMrgQzvUbKpc3aJKb4AwDXwCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now, we clone the git directory that contains the script that we require to create a new user. After giving the necessary permissions to the file to run. We run the prtg-exploit.sh file, with the Target IP Address and the cookie, captured as parameters. This script can take some time to run depending on your connectivity speed. But after successfully running it creates a user with following credentials.</span></p>
<pre class="lang:default decode:true">Username: pentest
Password: P3nT3st!</pre>
<pre class="lang:default decode:true">./prtg-exploit.sh -u http://10.10.10.152 -c "_ga=GA1.4.780888731.156187260; _gid=GA1.4.641622581.1562574873; OCTOPUS1813713946=ezQ3N0RENjcwLUFCQzItNDQ1Ri04Q0IyLUZDMjlFOUU3QjQ0Qn0%3D"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-p8E91Qutc5Q/XSQOtQ8uVYI/AAAAAAAAfGc/D6uQlj5cdhYt25ujzirOeH5_sqo30xL0QCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Now that, we have the user created on the target machine with Administrative Rights, let’s nab that root flag and complete this challenge. We will use the psexec.py script form the impacket tool kit to connect to the Target machine. You can use any of the methods that are provided in <a style="color: #000000;" href="https://www.hackingarticles.in/multiple-ways-to-connect-remote-pc-using-smb-port/">this article</a>. Here, we chose to run it directly as a python file. We need the username, password and target IP address as parameters as shown in the image given below. As we can see that after running, psexec gives the shell with Administrator rights. Now, we used the cd command to traverse into the Desktop Directory to find the root flag.</span></p>
<pre class="lang:default decode:true">python psexec.py 'pentest:P3nT3st!@10.10.10.152'
cd ..
cd Users\Administrator\Desktop
type root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YPU77Ksp-iE/XSQOreSiyMI/AAAAAAAAfGE/31oc4cHj4HcVLtWF64Z940O189tlb3P6wCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester Contact <a style="color: #000000;" href="https://www.linkedin.com/in/pavandeep-singh-6b1074132"><strong>here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
