<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">W34kn3ss 1: Vulnhub Lab Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/w34kn3ss-1-vulnhub-lab-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-03-01T17:30:08+00:00">March 1, 2019</time><time class="updated" datetime="2025-06-10T20:11:51+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another CTF challenge “W34kn3ss 1”. Briefing about the lab, the matrix is controlling this machine, neo is trying to escape from it and take back the control on it, your goal is to help neo to gain access as a “root” to this machine, through this machine you will need to perform a hard enumeration on the target and understand what is the main idea of it, and exploit every possible “weakness” that you can found, also you will be facing some up normal </span>behaviors<span style="color: #000000;"> during exploiting this machine. You need to think out of the box and collect all the puzzle pieces in order to get the job done. This vulnerable can be downloaded from <a href="https://www.vulnhub.com/entry/w34kn3ss-1,270/#">here</a>.<br/>
</span></p>
<p><span style="color: #000000;"><strong>Difficulty: Intermediate </strong></span></p>
<h3><span style="color: #800000;">Penetrating Methodologies</span></h3>
<ul>
<li><span style="color: #000000;">Machine discovery and scanning (netdiscover, nmap)</span></li>
<li><span style="color: #000000;">Surfing HTTP service port (80)</span></li>
<li><span style="color: #000000;">Directory enumeration using dirbuster</span></li>
<li><span style="color: #000000;">Exploring directories on the browser.</span></li>
<li><span style="color: #000000;">Adding domain name to /etc/hosts file.</span></li>
<li><span style="color: #000000;">Exploring domain name on </span>the browser<span style="color: #000000;">.</span></li>
<li><span style="color: #000000;">Directory enumeration using dirbuster</span></li>
<li><span style="color: #000000;">Exploring directories on the browser.</span></li>
<li><span style="color: #000000;">Searching </span>exploits<span style="color: #000000;"> using searchsploit.</span></li>
<li><span style="color: #000000;">Cracking base-64 encoded public key.</span></li>
<li><span style="color: #000000;">Logging into SSH using </span>the public<span style="color: #000000;"> key.</span></li>
<li><span style="color: #000000;">Using online python-decompiler.</span></li>
<li><span style="color: #000000;">Getting root access.</span></li>
<li><span style="color: #000000;">Snagging the Root flag.</span></li>
</ul>
<p><span style="color: #000000;"><strong>Walkthrough</strong></span></p>
<p><span style="color: #000000;">Let’s start off with discovering the IP address of our Target Machine.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kCOpl133TqY/XHgXrmi5LBI/AAAAAAAAdKA/ZY_Cx9nHJXUGuizuWUfLPmT5FqAU9J1RQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Then we’ll continue with our <strong>nmap</strong> command to find out the open ports and services. The nmap scan result gave us quite a bit of useful information which could be useful later on.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.101</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-hXawkw6X27I/XHgXuevmDtI/AAAAAAAAdKg/GkrY6-XY6bMaUferVmXPGTbE5JOmUWJywCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Since <strong>port 80</strong> is open, we explored the Targets IP Address on the browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ASeF6O-2yf8/XHgXumklvzI/AAAAAAAAdKk/Fq2KCRX199gp39HlXkwKd-ncChrwg5YtgCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We didn’t found anything on the webpage, so we use dirb to enumerate the directories on the web server.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.101/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-WTFO_XRZYnE/XHgXuxYN0HI/AAAAAAAAdKo/eUq2O2Ozg186E4vsV3Huo3Sdo-M7MRslQCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">After spending a good time while enumerating through these directories, we finally found a useful directory that quite gave us hint to move forward. The picture is indicating </span><span style="color: #000000;">that we require lots of keys in this Machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-z7uROAapeOY/XHgXvpfnglI/AAAAAAAAdKs/3q21MykDTmgDV34-uf6tiIxGbjLlUfZXgCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">A thought </span>comes<span style="color: #000000;"> in our head of adding <strong>weakness.jth</strong> as a domain name in </span>the/<span style="color: #000000;">etc/hosts file. We found the name weakness.jth in our nmap result under port 443.</span></p>
<pre class="lang:default decode:true">nano /etc/hosts</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-h5czVa3p2TE/XHgXvnomKkI/AAAAAAAAdKw/dX61T-wtCxg2o1VdxDY_VvMDBRnaljAQQCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Let’s just browse <strong>weakness.jth</strong> on the browser and the result gave a useful credential <strong>n30</strong> that come in handy later on.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KQiEMFAl0Fo/XHgXv7FTx-I/AAAAAAAAdK0/XE3lLXp7FdISRXTl7xC2TFZM7DL9-Yf5gCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Let’s again use dirb to enumerate the directories on weakness.jth. You never know what clue it might give us.</span></p>
<pre class="lang:default decode:true">dirb http://weakness.jth</pre>
<p><span style="color: #000000;">As expected it gave us another useful directory as highlighted.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-pVgzPFQqiog/XHgXwq25TwI/AAAAAAAAdK4/mskkhyYCJCczlmLDkZvG-GO0Co-7_DhEwCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">While browsing this directory on the browser it showed two files <strong>mykey.pub</strong> which is a public key and <strong>notes.txt. </strong>Let’s download them on our system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-wDQWItUXkis/XHgXwy3CGDI/AAAAAAAAdK8/QUp6TqDUL4kEgW5b-fKykwdZDqd17gclwCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">When we opened <strong>notes.txt</strong> on the browser it gave us a clue about <strong>OpenSSL 0.98c-1 </strong>and that the public key we found was generated by it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ZlW257RylGU/XHgXrxw5WKI/AAAAAAAAdKE/mkzDgseWuukxux6vE6ihGe7yzcL8xTVsQCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Then we look for it using searchsploit. The exploit we have used is highlighted, after that, we have copied the exploit <strong>5622</strong> in the <strong>/root </strong>directory and read the contents in it.</span></p>
<pre class="lang:default decode:true">searchsploit -m 5622
cat 5622.txt</pre>
<p><span style="color: #000000;">After reading all the contents of the file, it got cleared on how to use this tool. Since there is </span>a GitHub<span style="color: #000000;"> link from where we have to download this tool and follow further instruction given. </span>Basically<span style="color: #000000;">, this tool will help us in cracking the public key.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-PRV6K_mJn-Q/XHgXrqkSPoI/AAAAAAAAdJ8/M__vBJRcE6g6LQu5oswXAgFFnWoK2dr7wCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">When we read the contents of the public key found earlier, it came out to be base-64 encoded SSH public key.</span></p>
<pre class="lang:default decode:true">cat mykey.pub</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-gQpn2mLx-p8/XHgXsY2NSkI/AAAAAAAAdKI/ThQpC1hdBhY6fZ8G8P0IT53HmH-aGthrgCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">After downloading the tool from the </span>GitHub<span style="color: #000000;"> link. We have used that tool to decode the base-64 encoded public key and we got success in doing it. The decoded key is highlighted.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-_ty6Bp0fKkk/XHgXskMuYQI/AAAAAAAAdKM/ej04KIsSkmArF5n_ZSVe0Lms6AC1SGPAwCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">It’s time to log into SSH using the public key and the username as n30.</span></p>
<pre class="lang:default decode:true">ssh -i 4161de56829de2fe64b9055711f531c1-2537 n30@192.168.1.101</pre>
<p><span style="color: #000000;">On enumerating the directories, we found two files <strong>code</strong> and <strong>user.txt</strong>. Let’s read the contents of user.txt.</span></p>
<pre class="lang:default decode:true">cat user.txt</pre>
<p><span style="color: #000000;">When we checked the file type of code, it came out to be a python compiled file. Let’s copy it to <strong>/var/www/html</strong> by this we can download this file on our system.</span></p>
<pre class="lang:default decode:true">file code
cp code /var/www/html</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-A0PI1fs7e-k/XHgXtBK7R7I/AAAAAAAAdKQ/I455hawjbD8zgyVHVe288B6qiTmDyy_GQCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">We have </span>downloaded<span style="color: #000000;"> the file on our system and moved it into code.</span>pyc<span style="color: #000000;"> because it’s a python compiled file and online python-decompiler only takes input in .pyc format. That way we can easily decompile this file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-1NF-4D_JEvY/XHgXtmIzKoI/AAAAAAAAdKY/E1_IrTVdUUk3yPNC4DAXbPDdb1d9vEMPgCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">On </span>decompiling<span style="color: #000000;">, the file using online python-decompiler gave us very useful credential i.e</span></p>
<pre class="lang:default decode:true">Username- n30
Password- dMASDNB!!#B!#!#33</pre>
<p><span style="color: #000000;">It a little to figure out it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-1HpenJ7m40U/XHgXtkGtMjI/AAAAAAAAdKU/oJmIJjMmjnkkElGTY0weY6jBYCNqEie6ACLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Let’s check if n30 has security privileges. So when we did check it asked for </span>a password<span style="color: #000000;">, here we have given the password found earlier from decompiling.</span></p>
<pre class="lang:default decode:true">sudo -l</pre>
<p>Booyah<span style="color: #000000;">!! We have got the root access. Time to read the contents of our final flag.</span></p>
<pre class="lang:default decode:true">sudo -i
ls
cat root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-OS0DiGaC19g/XHgXt6agbhI/AAAAAAAAdKc/eqswc3B3I_UnDhCX6E0B4ecDsypPxThjQCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;"><strong>Author:</strong> Ashray Gupta is a Security Researcher and Technical Writer at Hacking Articles. Contributing his 2 years in the field of security as a Penetration Tester and Forensic Computer Analyst. Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/ashray-gupta-b77221b6/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
