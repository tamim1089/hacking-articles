<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Quaoar VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-quaoar-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-04-01T18:02:27+00:00">April 1, 2017</time><time class="updated" datetime="2025-06-10T20:30:17+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Once again we are with the Vulnhub labs tutorial; this article is related to CTF lab where you will face three challenges to complete the task. This lab is pretty good for </span>a beginner<span style="color: #000000;"> as they have to seize only three flag: 1. Get a shell 2. Get root access 3. There is a </span>post-exploitation<span style="color: #000000;"> flag on the box. You can download this VM from <a style="color: #000000;" href="https://www.vulnhub.com/entry/hackfest2016-quaoar,180/"><span style="color: #0000ff;">here</span>.</a></span></p>
<p><span style="color: #000000;"><strong>Let’s start.</strong></span></p>
<p><span style="color: #000000;">Firstly, scan the target IP with </span>an aggressive<span style="color: #000000;"> scan using Nmap tool as given in the image.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.24</pre>
<p><span style="color: #000000;">With the nmap </span>result<span style="color: #000000;">, you can see that port 22, 53, 80, 110, 139, 143, 445, 993 and 995 are open with the services like SSH, HTTP, </span>and<span style="color: #000000;"> many others.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-jKaVJbpV51k/XG6O3tS7pmI/AAAAAAAAc2A/32nrQLmE43Qfq_kPt2uNCM02sv8EdhTIgCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Since port 80 is working, open the victim IP <strong>192.168.1.24</strong> in the browser. You can see its home page in the image below :</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-N65TAV6554c/XG6O4hzPxMI/AAAAAAAAc2I/9hCd04U3ebU54jlrTVZ6HeOpG62x4xh1wCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Nmap scan also shows that <strong>robots.txt.</strong> Once accessed robots.txt it will show you that the website is in WordPress, which is exploitable to in this scenario.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-23lRPDGLGQk/XG6O4wjJCbI/AAAAAAAAc2M/YZtVTMcf0iAU3ziXeXXOJ25bVELnHMotACLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Let’s check out </span>the WordPress<span style="color: #000000;"> directory in the browser once.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-i3CgNJ7ILFM/XG6O5Hs6ckI/AAAAAAAAc2Q/rfCVhDqzgcw3v-jcmMhrVPV-wC1SGjLxwCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Further, when I explored the following path: 192.168.1.24/wordpress/wp-login.php in the browser, I found a WordPress administrator console.</span></p>
<p><span style="color: #000000;">To breach administrator console of the WordPress we can use WPScan tool; now type the following command to start wpscan enumeration.</span></p>
<pre class="lang:default decode:true">wpscan --url http://192.168.1.24/wordpress/ --enumerate u</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-cLW-8PZ4WNM/XG6O5Th-SAI/AAAAAAAAc2U/ttO7JYUSFSsMWEbpcCU9vOM_1xiGA2n5wCLcBGAs/s1600/6.png"/></strong></span></p>
<p><span style="color: #000000;">WPScan’s result will show two users as you can see in the image below. We will move forward with </span>the admin<span style="color: #000000;"> user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-KuKiEhDVqTQ/XG6O5-g-T7I/AAAAAAAAc2Y/FvRhOfhfvfkJqNgbKKKqoJCoQ3a-h67uACLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">I used default </span>login<span style="color: #000000;"> credentials i.e. admin</span>: admin<span style="color: #000000;"> and therefore I was logged in as Admin. Now, under the console we can upload any theme, taking advantage of the rights we have obtained, we will try to upload the malicious script to achieve reverse connection from </span>the victim’s<span style="color: #000000;"> system. The script we will use can be downloaded </span>from <span style="color: #000000;">http://pentestmonkey.net/tools/web-shells/php-reverse-shell </span></p>
<p><span style="color: #000000;">Now copy the PHP text from *&lt;?php to die();  and paste it as new theme under selected 404.php template.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-otnzulfvwos/XG6O2NHrO2I/AAAAAAAAc1w/EKJ1gZ9Vc-8p-SSC42gwhTUe7i8ct1wdACLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now type the following commands to have session through netcat :</span></p>
<pre class="lang:default decode:true">nc –lpv 1234</pre>
<p><span style="color: #000000;">Once you have the session, use the following commands to navigate around :</span></p>
<pre class="lang:default decode:true">cd /home
ls</pre>
<p><span style="color: #000000;">In /home I found the wp-admin folder which is obviously important so let’s check it for a flag using the following commands :</span></p>
<pre class="lang:default decode:true">cd wpadmin
ls
cat flag.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-i7FtDckAttE/XG6O2QBcUzI/AAAAAAAAc14/ii8actRfPlUdLpVOUe2kYpjekdeCSpFpQCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">This way, in the above image you see that we have found our first flag.</span></p>
<p><span style="color: #000000;">Another important file in </span>WordPress<span style="color: #000000;"> is Wp-config.php. Therefore, </span>after exploring<span style="color: #000000;"> this file I found MYSQL Setting. This contained credentials for root. If you notice the image below you’ll observe that the username and password i.e. root: </span>root password</p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-H_W9HkWqINc/XG6O2e_x3fI/AAAAAAAAc10/AeLUmIuhcW8SCnPMRl5epInuAm6aNWFkgCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Let’s switch the user to root and then in the root folder you will find the second flag too. So, use the  following commands for the said task :</span></p>
<pre class="lang:default decode:true">su
rootpassword!
cd /root
ls
cat flag.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-BWQkylQSyOk/XG6O3Im4Y5I/AAAAAAAAc18/G7mXTdoKBykL3aJg-7HQSUDJCU2MOPEZQCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Now, we all know that cron.d is an important </span>Linux<span style="color: #000000;"> directory and I just checked it for the sake of it and there I found our last and third flag. Use the following commands to achieve that :</span></p>
<pre class="lang:default decode:true">cd /etc
cd cron.d
ls
cat php5</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://2.bp.blogspot.com/-lY6lXOSt6JM/XG6O38ICEYI/AAAAAAAAc2E/pXkUgXSAQzQOcTJHBBp0Vzu96ssgEUWfgCLcBGAs/s1600/15.png"/></strong></span></p>
<p><span style="color: #000000;"><strong>Ohh-Yah!  </strong>We have successfully captured all 3 flags. Hence, we have successfully completed the CTF.</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Arpit Pandey is a Certified Ethical Hacker, Cyber Security Expert, Penetration Tester. Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/arpit-pandey-3a77ab173">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
