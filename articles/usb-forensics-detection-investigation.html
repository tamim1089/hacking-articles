<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/cyber-forensics-tricks/" rel="category tag">Cyber Forensics</a></span>            </div>
            <h1 class="post-title entry-title">USB Forensics: Detection &amp; Investigation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/usb-forensics-detection-investigation/" rel="bookmark"><time class="entry-date published" datetime="2020-09-09T10:05:58+00:00">September 9, 2020</time><time class="updated" datetime="2025-05-17T21:21:48+00:00">May 17, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Digital Forensics Investigators commonly find Universal Serial Bus flash drives, known as <strong>USB flash drives</strong>, as the most common storage devices used as evidence. Investigators must follow a defined procedure for the investigation and conduct it in such a manner that they do not destroy the evidence. So, let us get started with the Forensics Investigation of USB.</span></p>
<h3><span style="color: #800000;">Table of Contents</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Detecting last attached USB flash drives in the Windows system</strong></span></li>
<li><span style="color: #000000;"><strong>Using Registry Editor</strong></span></li>
<li><span style="color: #000000;"><strong>Using PowerShell</strong></span></li>
<li><span style="color: #000000;"><strong>Using USBDeview</strong></span></li>
<li><span style="color: #000000;"><strong>Detecting last attached USB flash drives using Metasploit</strong></span></li>
<li><span style="color: #000000;"><strong>Investigating USB flash drives for deleted files</strong></span></li>
<li><span style="color: #000000;"><strong>Creating Disk Image</strong></span></li>
<li><span style="color: #000000;"><strong>Analysing Disk Image</strong></span></li>
</ul>
<h3><span style="color: #800000;">Detecting last attached USB flash drives in the Windows system</span></h3>
<p><span style="color: #000000;">The usage of USB drives in place of work may let nasty employees remove sensitive or confidential information from a system without any authorization. To resolve this issue, forensic examination of systems comes into the picture. So, let’s start investigating;</span></p>
<p><span style="color: #000000;">To detect the artifacts of the USB in the windows machine, we can use the manual as well as automated methods.</span></p>
<h3><span style="color: #800000;">Using Registry Editor</span></h3>
<p><span style="color: #000000;">It is a manual method to easily list the information of the last plugged in USB storage devices. Press ‘<strong>Windows+R</strong>’ and type <strong>Registry Editor.</strong></span></p>
<p><span style="color: #000000;">This information can be found in the Windows registry at:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USBSTOR</pre>
<p><span style="color: #000000;">You can see the details like last plugged in USB devices, the vendor of the USB, name of the product, serial number, and version name.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7q3M6CIsmKk/X1ij3OLcofI/AAAAAAAAoSo/FCk5E4nhltUtoi-KoJ4bygqwurbwpMm5gCLcBGAsYHQ/s1600/0.0.png"/></span></p>
<h3><strong><span style="color: #800000;">Using PowerShell</span></strong></h3>
<p><span style="color: #000000;">This manual method helps find artifacts. You can use the same path in PowerShell to get information on the last plugged-in USB with the following command;</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Get-ItemProperty -Path HKLM:\SYStem\CurrentControlSet\Enum\USBSTOR\*\* | Select FriendlyName</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-H_x3KLRcpmc/X1ij67PnQYI/AAAAAAAAoSs/U3wzivRZmWQkkWgLhOSQVnKSX2q_BlYQgCLcBGAsYHQ/s1600/0.1.png"/></span></p>
<h3><span style="color: #800000;">Using USBDeview</span></h3>
<p><span style="color: #000000;">To use an automatic method to find artifacts, you can download <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.nirsoft.net/utils/usb_devices_view.html">USBDeview</a></strong></span>. This tool provides you with an automated and graphical representation of what USB devices connected to the system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_PYA4fyuNV8/X1ikAT-EGyI/AAAAAAAAoSw/B5cF9qaDR5wj0iVg2KyW1L81WOwt0u0HwCLcBGAsYHQ/s1600/0.2.png"/></span></p>
<h3><span style="color: #800000;">Detecting last attached USB flash drives using Metasploit</span></h3>
<p><span style="color: #000000;">When we need to investigate the USB flash drives history remotely, we can use modules in Metasploit in Kali Linux. This module will enumerate USB Drive history on a target host. To use this module, switch on your Linux machine, start <strong>msfconsole, </strong>and type command;</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use post/windows/gather/usb_history</pre>
<p><span style="color: #000000;">Set the session number and exploit. Here you will be able to see a history of various USB connected previously.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CJURAMDPG3Y/X1ikEuK4LkI/AAAAAAAAoS0/RpHqwMI51XIE9Ya1znvAjjhWkqYTFmDsgCLcBGAsYHQ/s1600/0.3.png"/></span></p>
<p><span style="color: #000000;">Now you have also obtained the meterpreter session, so you can use the following command to remotely use PowerShell to get the history of connected USB flash drives;</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">load powershell</pre>
<p><span style="color: #000000;">Once the PowerShell is loaded, you can type,</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Get-ItemProperty -Path HKLM:\SYStem\CurrentControlSet\Enum\USBSTOR\*\* | Select FriendlyName</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nteRSzZljAA/X1ikJXT4KdI/AAAAAAAAoS4/dt2f2AI5SSQoCov77B4VikLB8qPfU5PVACLcBGAsYHQ/s1600/0.4.png"/></span></p>
<p><span style="color: #000000;">You can hence see the list of USB Flash drives connected to the system remotely.</span></p>
<h3><span style="color: #800000;">Investigating USB flash drives for deleted files.</span></h3>
<p><span style="color: #000000;">After we have detected all the USB connection to the system and if the USB Flash drive is available at the scene of the crime. It can be carefully collected in <strong>Faraday Bag </strong>and now the forensic investigator can investigate the evidence.</span></p>
<p><span style="color: #000000;">At first, it is important to create an image of the USB flash drive that investigators retrieved from the crime scene. To create an image and to analyze, we can use FTK® Imager, which we can download from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.exterro.com/digital-forensics-software/ftk-imager">here</a></strong></span>.</span></p>
<h3><span style="color: #800000;">Creating Disk Image</span></h3>
<p><span style="color: #000000;">Step 1: </span></p>
<p><span style="color: #000000;">Install and run AccessData FTK imager</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4pEIf59E3xo/X1ikNMII0PI/AAAAAAAAoTA/RwKJ3cGp6eQP5ukOBgieXJIfSuI3g6sxQCLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Step 2. </span></p>
<p><span style="color: #000000;">Create a disk image of the USB Drive</span></p>
<p><span style="color: #000000;">A <strong>disk image</strong> is a bit-by-bit or a sector-by-sector copy of a physical storage device like USB Flash drive, which includes all files, folders and unallocated, free and slack space etc.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9cBHSRyYDFM/X1ikQw_3NsI/AAAAAAAAoTI/QROnP6ampHIrfci9hxMoAV2cLQOEU4UMACLcBGAsYHQ/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Step 3: </span></p>
<p><span style="color: #000000;">As it as USB Flash drive, select Physical Drive and its source to create an image and click on finish.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MF1rFUDg4rs/X1ikWXS-OFI/AAAAAAAAoTM/0FreeI3aJBA3sYhPtCI0qzOrYKXsKBqsQCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oa4BrHejQGs/X1ikcQdM6gI/AAAAAAAAoTU/nKjccWvOILUojoT5xpSDpF0Vu84HiCqiACLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Step 4: </span></p>
<p><span style="color: #000000;">Add the destination of the image file, and check the box that says verify images that are created.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-udZfJBdMDUI/X1ikgaqsdSI/AAAAAAAAoTc/eysE-xTPSww0T2UW0UaCZtO7AgCxpBdJwCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Step 5: </span></p>
<p><span style="color: #000000;">After you add the destination for the image file you want to create, type the name you want to give the image file and click on finish.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-w7GTnDTjwAE/X1ikkK3GSzI/AAAAAAAAoTk/x1HvzSfvI2I-vrT1i-Ue4lbGkvxxMvOywCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Step 6:  </span></p>
<p><span style="color: #000000;">You can see that the image destination is ready, then click on Start to begin imaging.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rXvTgKWoueE/X1iknUcDosI/AAAAAAAAoTs/b40bU6_CGjAaFIzKyiSBeYeAPlztPtRIwCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Step 7: </span></p>
<p><span style="color: #000000;">You see that the image of your USB flash Drive is being created.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7yy1PYeyFow/X1ikqhoG-gI/AAAAAAAAoTw/t_fnaJEaIdMu6j-0CepXAq-Rmyx4SXWtgCLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Step 8: </span></p>
<p><span style="color: #000000;">After completing the imaging, the system will prompt you with MD% image verification details where it generates a compared and verified hash.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-R_h_NKtJgSw/X1iku8SMk2I/AAAAAAAAoT4/gL9zivXPsi8xkHV0iEmRN4dDk9QSRU1zwCLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Here the imaging part is over, so we can now move to the analysis of the USB Flash Drive.</span></p>
<h3><span style="color: #800000;">Analysing Disk Image</span></h3>
<p><span style="color: #000000;"><strong>Note: Only the Disk image of the original evidence will undergo investigation.</strong></span></p>
<p><span style="color: #000000;">Step 9: </span></p>
<p><span style="color: #000000;">Click on add evidence item and add the source of the created image file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5O8dNIZmNhc/X1ikz_Vw2NI/AAAAAAAAoUA/hhmqk-MmAjEnqQmL3V-V14mcsTyj8dXvQCLcBGAsYHQ/s1600/13.png"/></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JVg1UObiAd8/X1ik2l0vogI/AAAAAAAAoUE/aMrVTtecrLEgLAzPM7MehK1mbzozUcjBwCLcBGAsYHQ/s1600/14.png"/></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-R9lTGB8I8hE/X1ik6LLYHII/AAAAAAAAoUM/dco8ar9Q030pbolNs9MBbwi-oN-dETjFwCLcBGAsYHQ/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Step 10: </span></p>
<p><span style="color: #000000;">Here you see that someone creates an evidence tree and deletes folders in the root folder. Here we will try to retrieve them by clicking on ‘Export files’</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MHEf5MFsdYQ/X1ik9WUUivI/AAAAAAAAoUU/pC8H-6n3nug4uD6nWpRDQyPgsy0yYQohwCLcBGAsYHQ/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Step 11: </span></p>
<p><span style="color: #000000;">You see that someone has retrieved the deleted folder and the contents of the deleted folder.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-whVxaJl0uCA/X1ilAuXjKeI/AAAAAAAAoUc/vi1qypsYNC42f72cbowzhOHmaIo3ZS79QCLcBGAsYHQ/s1600/17.png"/></span></p>
<p><span style="color: #000000;">To learn more about Cyber Forensics. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/cyber-forensics-tricks/">Link</a></strong></p>
<p><span style="color: #000000;"><strong>Author: </strong>Jeenali Kothari is a Digital Forensics enthusiast and enjoys technical content writing. You can reach her on<strong><a style="color: #000000;" href="https://www.linkedin.com/in/jeenali-kothari"> <span style="color: #0000ff;">Here</span></a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
