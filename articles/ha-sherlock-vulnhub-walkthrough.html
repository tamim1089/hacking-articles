<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">HA: Sherlock Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/ha-sherlock-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-11-13T16:17:43+00:00">November 13, 2020</time><time class="updated" datetime="2025-07-10T13:48:46+00:00">July 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Here is the walkthrough of our very own Capture-the-flag, <strong>HA: Sherlock </strong>which is designed by our team at Hacking Articles.</span></p>
<p><span style="color: #000000;"><strong>“HA: Sherlock” </strong>is a vulnerable machine based on the famous investigator Sherlock Holmes’s journey on solving the Curious Case of Harshit’s murder! This is a Forensic based Capture-the-Flag and is not a Boot-to-Root. So, there are a total of 100 points scattered over the lab and the objective is to find all 100 points.</span></p>
<p><span style="color: #000000;">The ultimate aim is to apply the concepts of forensics to capture-the-flags and have fun. You can download the VM from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/ha-sherlock,580/">here</a></strong></span>.</span></p>
<p><span style="color: #000000;">So, let’s being with the walkthrough of this lab. Switch on your Kali Linux and virtual machines.</span></p>
<p><span style="color: #000000;"><strong>Level</strong>– Intermediate</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Hunting for 100 Points</strong></span>
<ul>
<li><span style="color: #000000;">Morse Code Conversion</span></li>
<li><span style="color: #000000;">Bruteforce pop3</span></li>
<li><span style="color: #000000;">Epoch converter</span></li>
<li><span style="color: #000000;">Ram analysis using Volatility framework</span></li>
<li><span style="color: #000000;">Image analysis using Autopsy</span></li>
<li><span style="color: #000000;">Convert Password- Hexadecimal to Decimal</span></li>
<li><span style="color: #000000;">.wav analysis using Audacity</span></li>
<li><span style="color: #000000;">Convert .wav file to hash using deepsound2joh.py</span></li>
<li><span style="color: #000000;">Decode password using base64</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Final Flag</strong></span></li>
</ul>
<h3><span style="color: #000000;"><span style="color: #800000;">Network Scanning</span> </span></h3>
<p><span style="color: #000000;">So, let’s start with finding the IP address of the vulnerable machine by performing a network scan by using <strong>Netdiscover</strong> command. Here we need to understand how the scanned IP addresses relate to their MAC addresses. Here we choose the IP address <strong>192.168.0.170</strong> whose Hostname is a VMware machine.  To do this, you can type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uZI-hCypIoE/X66XPDCgR4I/AAAAAAAAqjw/qhBw6-7XWfIXc6H8DMuIezBDbcoHNzL_wCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Such that we have now obtained the IP address, our next step will be to scan the network using <strong>Nmap. </strong>By using nmap we will be able to <strong>discover all the open ports and services</strong> present in the machine so that we can further exploit them. So, we can use the command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV 192.168.0.170</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sRJMZ4lHmqs/X66XWrkb4MI/AAAAAAAAqj0/whH8A7cLde8ysMjajDxp4_VT_9ctXp46ACLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Here we are using a service version scan which will display the versions of all the open services. Here you see that multiple open services like ftp, ssh, SMTP, http, pop3, IMAP, SSL/IMAP, SSL/pop3, etc. are available, and the system displays their respective versions.</span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">Such that we see the HTTP services running, let us hunt our first flag by looking up the webpage on the browser.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.0.170</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6vgNZ3iDgns/X66Xc4pLy_I/AAAAAAAAqj4/g4jtlqPispME5N4SNqz97D-fFU_Tf_eJQCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">Firstly, let us go to the “<strong>View</strong> <strong>page source”</strong> of the HTML page and look if we can find something related to capturing the flag. And here we find our first clue which indicates the presence of a .mp4 file in the machine. So, let us look for the .mp4 file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6o2kWNH-wFw/X66Xn_W7aMI/AAAAAAAAqkA/tMiLABEfQjMSdhelw_hbL2X8iWR3DxzXQCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Then, we try to pick up the keywords from the comment found in the HTML page source and see two prominent names i.e.<strong> Irene</strong> and Sherlock. So, we try using the two names as a<strong> .mp4</strong> file in the web browser. And here at <strong>irene.mp4</strong>, we find a video playing, which could be password protected. So let us download the video and see</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-we99F2JY4Hw/X66XvFeS5YI/AAAAAAAAqkI/-ZChNXsuUyQszLUR71tAxiqy3yU7ktrawCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">After watching the video, we realize that there is nothing present in the video, so we move onto the ssh service. On doing that we see a banner named sherlock and we see that there is a hint in the form of  <strong>“morse code”</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fTsphxBlTNI/X66X1GZIVGI/AAAAAAAAqkM/vSUeIgHiKHoVckaT9FtLhUl4ZsDP4qeeQCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Then let us copy the morse code and use an online morse code translator. Here we have found the password as <strong>BASKERVILLE</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-v9y2rRQD-mQ/X66YCK-LBxI/AAAAAAAAqkY/gG1PiNCXhiUr8f6znnpl7ZIXJ1EBlmC3gCLcBGAsYHQ/s16000/7.1.png"/></span></p>
<p><span style="color: #000000;">We can then use the password<strong> “BASKERVILLE’ </strong>to decrypt the.mp4 file and see that there is a file with the name<strong> 15_points.txt. </strong>You can make use of OurSecret steganography tool to unhide the contents behind the video file. You can download it from <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://oursecret.soft112.com/"><strong>here</strong></a></span>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_c9lec4BnPY/X66YHp8RjlI/AAAAAAAAqkg/nBZif_L4hq4ZmMOT2Vm2szgAahVz3t9aACLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">Here you see that you have found the first flag and have earned <strong>15 points</strong>. SO, let us move on to find the remaining points spread over the machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CldnYL_XY8M/X66YNFU2Z0I/AAAAAAAAqkk/E8l_suxk4Dwpd5l0mHRIKCJ5DXqJ9q_bwCLcBGAsYHQ/s16000/8.png"/></span></p>
<h3><span class="token title important" style="color: #800000;">Email Forensics &amp; Timestamp Analysis</span></h3>
<p><span style="color: #000000;">Now let us try using Harshit’s name as a username to find more clues and lets <strong>‘brute force’</strong> into the POP3s using the tool <strong>Hydra</strong>. We use the rockyou.txt dictionary. </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hydra -l harshit -P /usr/share/wordlists/rockyou.txt 192.168.0.170 pop3s</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BZhyJ2iz4DY/X66YcZgT-5I/AAAAAAAAqkw/dFjtrDaPHj0emSDCijBYu-EaL2oDXGTqQCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">Here you see that the password to the username <strong>Harshit</strong> has been cracked and is <strong>superman. </strong>Now we connect with pop3 port.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">openssl s_client -crlf -connect 192.168.0.170:110 -starttls pop3</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-G_bWkca12hg/X66Yhu92ZxI/AAAAAAAAqk4/Oa3xGnNpBHcPR2qqfT8XIQtQpqXEcHbVwCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">You can use the above-found username and password to log in and find more clues related to the murder of Harshit. </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">user harshit
pass superman 
retr 1</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-wTmrBRVAzcU/X66Zc-TfSMI/AAAAAAAAqlU/UO4VH9avCnUOHlnIa5YAAiusEDLIXZ6swCLcBGAsYHQ/s16000/11.png"/></p>
<p>In the second email, someone exchanged certain messages and the killer has again threatened Harshit to torture him. Hence a series of messages go on.</p>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-UYSEneBi2d4/X66ZSr3T5dI/AAAAAAAAqlQ/JZzrsPhAqxg9fShR5Hmpm-SDXbpyHFPoACLcBGAsYHQ/s16000/12.png"/><br/>
</strong></span></p>
<p>In the third thread of email, the killer threatens Harshit in an email he receives on “May 27, 2020 11.02.09 AM,” and the unusual word epoch appears in the message. So let us bring all the pieces together and look up epoch on google.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Jv75_tEIZrU/X66kM7Fsm7I/AAAAAAAAqoc/zqM4SDLrBxs9FC2JthDqYF665rz5PVG9QCLcBGAsYHQ/s16000/13.png"/></p>
<p><span style="color: #000000;">Open your web browser and look for an epoch converter that converts timestamps into a different numerical value.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HQ79CuCDC_M/X66ZmcrsnBI/AAAAAAAAqlc/9y5Om1k8s9oqUr_D2fxOPD3kjLykUkCSACLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Enter the value in the Human date to timestamp converter of the epoch converter and an epoch timestamp will be generated.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-d3VLMKH0zRM/X66ZzDbf9fI/AAAAAAAAqlk/DP8OJumdmpUGt61Ie9bV8ijHciK9PwAwgCLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">Once you have found the epoch timestamp number, you can then find the directory of the same name in the URL of the web page and there you find a file with the name <strong>10_Points.txt</strong> and another file with <strong>john.mem.</strong> Let us open the two files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mRiD_ZE8YRE/X66Z5JEMiHI/AAAAAAAAqls/FP_-cL-M4YARMG-k9Fg16xMX4gr-fe5bACLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">Now let us open the text file and see that we have won another 10 points. So in all now we have 25 points. Let us look in the .mem file that we have found.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Aa1DudObQZA/X66Z_apGbBI/AAAAAAAAqlw/VJqpGOx2LZkvrw-YmdDLqw5ZfOV-Up3VgCLcBGAsYHQ/s16000/17.png"/></span></p>
<p><span style="color: #000000;">From the file extension, we can now understand that is a memory dump file and we can analyze it using the volatility framework.  We can look for the key files that can be found in the memory dump. We can use the following command to get details about the ram.</span></p>
<h5><span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/memory-forensics-using-volatility-framework/" rel="bookmark">Memory Forensics: Using Volatility Framework</a></strong></span></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">volatility -f john.mem imageinfo</pre>
<p><span style="color: #000000;">We can try the various plugs and now lets us look for a notepad file plugin and here we can find some letters in the file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">volatility -f john.mem –profile=WinXPSPx86 notepad</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-m-vJnAjv36c/X66aNO0Z-DI/AAAAAAAAql8/bz0LUhQ46QsOs3H4WiSSPlybXyHa4LuzgCLcBGAsYHQ/s16000/18.png"/></span></p>
<p><span style="color: #000000;">Copy the text that we have found in the notepad and let’s try converting it using rot13 and there you find a text that says Guptchar. Guptchar is a Hindi word for the detective. And it looks</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-14-E8wu3tnU/X66aXWTuHDI/AAAAAAAAqmE/T-vrMwjGX0s_YlK_yBwBtkCEZnX2trVHQCLcBGAsYHQ/s16000/19.png"/></span></p>
<p><span style="color: #000000;">Moving forward, we should think like sherlock. Make the <strong>username as John </strong>and can use <strong>Guptchar as the password</strong>. If you go back and remember, we had seen the FTP port to be open and let us connect to FTP.</span></p>
<p><span style="color: #000000;">We see that there are 2 files present, download them to read the contents in .txt file.</span></p>
<p><span style="color: #000000;">Then we will look at the other file named mycroft.001; the file extension implies that it is a raw image file that we need to analyze using the Autopsy tool in Kali Linux.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qfh1YrISuCI/X66aigZOm4I/AAAAAAAAqmM/I8Q4-NbRDLcYf9sL1ctZ1VfCzl1kBs22ACLcBGAsYHQ/s16000/20.png"/></span></p>
<p><span style="color: #000000;">Now we have a total of 35 points and find other points to get a full 100 points. </span><span style="color: #000000;">Let us start autopsy to start analyzing the image file.</span></p>
<h3><span class="token title important" style="color: #800000;">Disk Image Investigation</span></h3>
<p><span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/forensic-investigation-autopsy-forensic-browser-in-linux/" rel="bookmark">Forensic Investigation: Autopsy Forensic Browser in Linux</a></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FY6S7D90-jk/X66avR22TUI/AAAAAAAAqmU/8Z-V8c-87UgeXH2mqEpbo7T2oBhZJmGUQCLcBGAsYHQ/s16000/21.png"/></span></p>
<p><span style="color: #000000;">Enter the case name, investigator’s name, and create a new case.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CBNx5Rg85E4/X66a1U7ywZI/AAAAAAAAqmc/XqzHegdlNFMLNCBFObWCrVRTag8fCHcxACLcBGAsYHQ/s16000/22.png"/></span></p>
<p><span style="color: #000000;">Now add the host to the case.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xB58H1ZjuQc/X66a8jg2PvI/AAAAAAAAqmg/6riZysKWHzoWW9ynlaaP3ctdRnRs-Vj_wCLcBGAsYHQ/s16000/23.png"/></span></p>
<p><span style="color: #000000;">Then add the hostname as host1 and add the host.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5sBNYji47zc/X66bISbEDZI/AAAAAAAAqmo/fNVZsJsE3gwISlDT2mi-L3xLn71H73TDACLcBGAsYHQ/s16000/24.png"/></span></p>
<p><span style="color: #000000;">Now let us add the image file that we have found to proceed ahead.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NaZyGGXLJnk/X66bOOlvQPI/AAAAAAAAqmw/8_7i-J0usdoW2BkVqoUoLg8jDGhwWmQIACLcBGAsYHQ/s16000/25.png"/></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-F4duquf8HA0/X66bVrR94PI/AAAAAAAAqm0/O0G7t8aQxQ4RT4cJno6TjurBunPGnSGIwCLcBGAsYHQ/s16000/26.png"/></span></p>
<p><span style="color: #000000;">Add the location, and the additional type of image file it. As we know it’s not a complete disk image, we will go with partition and click on <strong>next</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aEsO1qIbQPo/X66bd7Ch0iI/AAAAAAAAqnA/P7PeIbhwVS8sM0J68CAIHSXzQrr8t0ksgCLcBGAsYHQ/s16000/27.png"/></span></p>
<p><span style="color: #000000;">You can then click on the <strong>‘add image file’.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-P2n36OPsgqo/X66b0CgXQOI/AAAAAAAAqnI/7GvoUYG8mdIF-ewTk0-7BYgNCxd8Jzl7wCLcBGAsYHQ/s16000/28.png"/></span></p>
<p><span style="color: #000000;">Now click on the option of <strong>file analysis</strong> and then you will be able to see a directory with the name important. Click on it to view its contents.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CKyJNIfCmFA/X66b5D7DBRI/AAAAAAAAqnM/NubyZR06iT0hwxxHMw2Fd0cyR6K72DLOwCLcBGAsYHQ/s16000/29.png"/></span></p>
<p><span style="color: #000000;">Then you will be able to see various files in the directory. There are three files, There are two image files and the other is a text file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qMQ1JXq1HLY/X66b-ikJREI/AAAAAAAAqnQ/Or72GyfwT40jbZLkp1AUXGZPc2Mdj7znwCLcBGAsYHQ/s16000/30.png"/></span></p>
<p><span style="color: #000000;">When we open the 10_points.txt, we will get ten 10. Now we have a total of 45 points. Let us look for more points. Let us first have a look at the <strong>hint.jpg</strong> file to proceed.  The following hexadecimal values indicate the different component source address, a destination address, etc. Here we have found this unique value <strong>16</strong> which is then converted into a hash to find the clue further.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QkPvWrqPKiQ/X66cIlc99XI/AAAAAAAAqnc/NAA9FXzYSY4Stx6ekvDX6JJok21xxTQawCLcBGAsYHQ/s16000/31.png"/></span></p>
<p><span style="color: #000000;">When you convert this hexadecimal value into a decimal value, you get a value 22. Which is an indication of port 22.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-d8JZUzGoUew/X66cPaHiKSI/AAAAAAAAqng/XszAhdKafAATcnueEIUBrVwFdpXCae2zACLcBGAsYHQ/s16000/32.png"/></span></p>
<p><span style="color: #000000;">The hexadecimal value that is highlighted in light-green is selected and converted into text and we have found the text which says <strong>khufiya. </strong>Khufiya in Hindi means confidential. So we will now see how we can make use of this word.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CET8BbEU2FI/X66cidoyKoI/AAAAAAAAqns/pQ-qMSje94MU_-i2g469j0d9VSfz3tPMQCLcBGAsYHQ/s16000/33.png"/></span></p>
<h3><span class="token title important" style="color: #800000;">Audio Steganography &amp; Privilege Escalation</span></h3>
<p><span style="color: #000000;">Previously we had found a file named <strong>Mycroft.png </strong>and we found the hint of port 22, so let’s exploit ssh login using Metasploit. Open msfconsole and makes use of the auxiliary module.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use auxiliary/scanner/ssh/ssh_login
set hosts 192.168.0.170
set username mycroft
set password Khufiya
exploit</pre>
<p><span style="color: #000000;">Then you see that the session is created and start the firsts session. We are now into the machine with session 1. </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sessions -u 1</pre>
<p><span style="color: #000000;">Now let us create a meterpreter session by connecting with session2.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sessions 2</pre>
<p><span style="color: #000000;">Bravo!!!! You have established a meterpreter session. Let’s list the files on the machine. You see the files with the name <strong>15_Points.txt</strong> and jim.wav and let us download them. Now we have 60 points in all.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TEffpK_qKp0/X66cwaqVCxI/AAAAAAAAqnw/YuyUf2b6qrkZH2I8xMcr2smhM-Qggi0QwCLcBGAsYHQ/s16000/34.png"/></span></p>
<p><span style="color: #000000;">Then let us open the audio file <strong>jim.wav</strong> using Audacity tool which can be downloaded from <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.audacityteam.org/"><strong>here</strong></a></span> and there you get the hint which says Deep sound.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9eZyHCcikyw/X66c3_jvGII/AAAAAAAAqn4/11eaeMlD9oc73gWdfSOFxn8JKIq4jv_HQCLcBGAsYHQ/s16000/36.png"/></span></p>
<p><span style="color: #000000;">So, let’s use <strong>deepsound2john.py</strong>, to convert .wav file to hash file. And the file is brute-force using John the ripper</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">/usr/share/john/deepsound2john.py jim.wav &gt; hash
john --wordlist=/usr/share/wordlists/rockyou.txt hash
john hash --show</pre>
<p><span style="color: #000000;">The password that is cracked from the video file is displayed for the <strong>jim.wav</strong> file which is <strong>poohbear.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9i-xwmfCqKE/X66c-07UZjI/AAAAAAAAqn8/KWVOU0dKKYQRvbmFoswkAFORO8mVAoiowCLcBGAsYHQ/s16000/37.png"/></span></p>
<p><span style="color: #000000;">Then we can open the <strong><a href="https://deepsound.en.uptodown.com/windows">Deep sound</a></strong> and enter the password in it. And now you can see that there are two files present in the .wav. Let us download the two files and then see them one by one.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bPhKVKpb1t4/X66dFUP8iDI/AAAAAAAAqoE/JRIzkHPQbGo52CPuBbE9Jr3mJVsAhQbrACLcBGAsYHQ/s16000/40.png"/></span></p>
<p><span style="color: #000000;">The text file says that we have one 15 more points. Hurrah! Our total is 75 points. Let us look for 25 points. Let us open the other text file that we have found</span></p>
<p><span style="color: #000000;">Here we find a fake PGP message that contained a base64 code, which we then decoded.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo "QmhlZGl5YQ=" | base64 -d</pre>
<h5><span style="color: #000000;">The password that was decoded using base64 was <strong>Bhediya.</strong></span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gpYZK5vGVdk/X66dXUQ0VMI/AAAAAAAAqoM/gi9NDUZrN68MKOdz0HFmDQkMY74RquNcgCLcBGAsYHQ/s16000/41.png"/></span></p>
<p><span style="color: #000000;">Let us login using the user sherlock</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">su sherlock</pre>
<p><span style="color: #000000;">And enter the password that was decoded previously</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l
sudo bash
cd /root</pre>
<p><span style="color: #000000;">Finally, let us change the directory and list the contents within it. And there you find the last 25 points which sum up to the 100 points!!!!</span></p>
<p><span style="color: #000000;">There you go! The HA: Sherlock virtual machine has been rooted!!</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat final.txt
cat 25_Point.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7Epkux2fp6I/X66dd7XN6sI/AAAAAAAAqoQ/rH3M4P0M4ykecLEJ461RsgqAO-dIJ1V4wCLcBGAsYHQ/s16000/43.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more VulnHub Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Jeenali Kothari is a Digital Forensics enthusiast and enjoys technical content writing. You can reach her on<strong><a style="color: #000000;" href="https://www.linkedin.com/in/jeenali-kothari"> <span style="color: #0000ff;">Here</span></a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
