<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/website-hacking/" rel="category tag">Website Hacking</a></span>            </div>
            <h1 class="post-title entry-title">Comprehensive Guide on Open Redirect</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/comprehensive-guide-on-open-redirect/" rel="bookmark"><time class="entry-date published" datetime="2020-08-04T14:29:45+00:00">August 4, 2020</time><time class="updated" datetime="2025-05-31T21:32:28+00:00">May 31, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-174 ai-optimize-introduction"><span style="color: #000000;"><strong><em>URLs are</em></strong><em> commonly referred to as a <strong>web</strong> <strong>address</strong>, which <strong>determines</strong> the <strong>exact</strong> <strong>location</strong> of a <strong>web</strong> <strong>resource</strong> <strong>over</strong> <strong>the</strong> <strong>internet</strong>. But what if this URL gets redirected and takes you to the place where you never expected to?</em> Today, in this article, we’ll take a tour on <strong>Open</strong> <strong>Redirection</strong> and will learn how an <strong>attacker</strong> can <strong>deface</strong> a <strong>website</strong> by <strong>simply redirecting its URL to a malicious one.</strong></span></p>
<h3 class="ai-optimize-7"><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li class="ai-optimize-8"><span style="color: #000000;">What is the URL?</span></li>
<li class="ai-optimize-9"><span style="color: #000000;">Introduction to Open Redirection</span></li>
<li class="ai-optimize-10"><span style="color: #000000;">Open Redirection Impact</span></li>
<li class="ai-optimize-11"><span style="color: #000000;">Open Redirection Exploitation</span>
<ul>
<li class="ai-optimize-12"><span style="color: #000000;">Basic Redirection</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">Encoded Redirection</span>
<ul>
<li class="ai-optimize-14"><span style="color: #000000;">URL Encoded Redirection</span></li>
<li class="ai-optimize-15"><span style="color: #000000;">Double URL Encoded Redirection</span></li>
<li class="ai-optimize-16"><span style="color: #000000;">Base64 Redirection</span></li>
</ul>
</li>
<li class="ai-optimize-17"><span style="color: #000000;">URL Redirection with Hash values</span></li>
<li class="ai-optimize-18"><span style="color: #000000;">Redirection with Hash values using salt.</span></li>
<li class="ai-optimize-19"><span style="color: #000000;">Redirection over inside a Web page</span></li>
<li class="ai-optimize-20"><span style="color: #000000;">DOM-based Open Redirection</span></li>
</ul>
</li>
<li class="ai-optimize-21"><span style="color: #000000;">Mitigation Steps</span></li>
</ul>
<h3 class="ai-optimize-22"><span style="color: #800000;">What is the URL?</span></h3>
<p class="ai-optimize-23"><span style="color: #000000;">A URL is an abbreviation to <strong>U</strong>niform <strong>R</strong>esource <strong>L</strong>ocator, which is nothing but an <strong>address</strong> <strong>to</strong> <strong>a unique resource or a file over the Internet</strong>. These resources can be anything, an HTML page, an image, or a CSS document.</span></p>
<p class="ai-optimize-24"><span style="color: #000000;">A URL is composed of different segments – including a <strong>protocol</strong>, a <strong>domain</strong> <strong>name</strong>, or a <strong>path</strong> – which <strong>instructs</strong> the <strong>web</strong> <strong>browser</strong> about <strong>how to fetch a resource</strong> and thus are even managed by the webserver. <em>However,  it is the <strong>responsibility</strong> of the <strong>developer</strong> to <strong>validate</strong> the resources and its associated URLs and even the user-input parameters.</em></span></p>
<p class="ai-optimize-25"><span style="color: #000000;">A basic URL is structured in a way as:</span></p>
<p class="ai-optimize-26"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BDHXdKwv8YM/XylUrjqz1DI/AAAAAAAAmgc/Kco7qyZLQXsqZb--fpZXjHAZPDuwZcyaACLcBGAsYHQ/s1600/0.png"/></span></p>
<h3 class="ai-optimize-27"><span style="color: #800000;">Introduction to Open Redirect</span></h3>
<p class="ai-optimize-28"><span style="color: #000000;"><em>Have you ever noticed about the <strong>response</strong> <strong>codes</strong> that the web-application offer as <strong>“301” or “302”, </strong>they simply speak out about the <strong>URL</strong> <strong>redirection!</strong></em></span></p>
<p class="ai-optimize-29"><span style="color: #000000;">Many developers set up their web-applications in order to <strong>request</strong> <strong>resources</strong> <strong>over</strong> <strong>from</strong> the <strong>web</strong> <strong>pages</strong> or to <strong>send</strong> their <strong>visitors</strong> to <strong>some</strong> <strong>different</strong> <strong>location</strong>, that <strong>reside</strong> <strong>within</strong> or <strong>outside</strong> the <strong>web</strong>–<strong>interface</strong>. To do so, they implement some basic functions such as <strong>header() </strong>in <strong>PHP, redirect() </strong>in <strong>Python</strong>, <strong>Response.Redirect() </strong>in <strong>C# </strong>and many others.</span></p>
<p class="ai-optimize-30"><span style="color: #000000;">But developers often overlook this URL Redirection, as they sometimes do not properly validate or filter the functions they use, or even let users enter their desired input, which thus could lead to one of the most common vulnerabilities i.e. “Open Redirect”.</span></p>
<p class="ai-optimize-31"><span style="color: #000000;"><strong>“Open Redirect” </strong>or<strong> “Unvalidated Redirection” </strong>is possible when a web application <strong>accepts</strong> <strong>untrusted</strong> <strong>input</strong> that could <strong>cause</strong> the <strong>web</strong> <strong>application</strong> to <strong>redirect</strong> <strong>the</strong> <strong>request</strong> <strong>to</strong> a <strong>URL</strong> <strong>contained</strong> <strong>within</strong> <strong>untrusted</strong> <strong>input</strong>. <em>By modifying untrusted URL input to a malicious site, an attacker may successfully launch a phishing attack and steal user credentials.</em></span></p>
<h5 class="ai-optimize-32"><span style="color: #000000;"><strong>Source – <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html">OWASP</a></span></strong></span></h5>
<p class="ai-optimize-33"><span style="color: #000000;"><em>Didn’t understood well, let’s check out the following scenario:</em></span></p>
<p class="ai-optimize-34"><span style="color: #000000;"><em>The user get’s a phishing email stating that <strong>“Example.com – A movie booking web-app”</strong> is giving its users <strong>“a free movie ticket”</strong> over the URL specified in the email as:</em></span></p>
<p class="ai-optimize-35"><span style="color: #000000;"><strong><em>” www.example.com/?url=www.abc.in</em><em>“</em></strong></span></p>
<p class="ai-optimize-36"><span style="color: #000000;"><em>The URL seems to be the genuine one, as it is having the domain name of “<strong>example.com</strong>”, but the same URL is thus having a redirecting over to “<strong>abc.in” </strong>which is nothing but the attacker’s fake web application.</em></span></p>
<p class="ai-optimize-37"><span style="color: #000000;"><em>Now, when the user opens up the URL and enters her credentials over the <strong>“example’s login portal”, </strong>and as she clicks on the <strong>login</strong> <strong>button</strong>, she thus gets redirected to a different login page rather than example’s home page, as the <strong>Login button </strong>over <strong>example.com </strong>was suffering from <strong>“Open Redirect Vulnerability”</strong>. Therefore, now when she enters up her credentials again, they got compromised and thus then she’ll get redirected to the <strong>home page.</strong> </em></span></p>
<p class="ai-optimize-38"><span style="color: #000000;"><em> <img decoding="async" src="https://1.bp.blogspot.com/-wO8gUAQs0G8/XylUwtTMiVI/AAAAAAAAmgg/kkgRLpeI57IoJteVYAp7IbtVdrridAdFACLcBGAsYHQ/s1600/1.png"/></em></span></p>
<h3 class="ai-optimize-39"><span style="color: #800000;">Open redirection Impact</span></h3>
<p class="ai-optimize-40"><span style="color: #000000;">Open Redirection is itself a minor vulnerability, but, it thus itself can cause major damage to the web-application when integrated with others as with <strong>“RCE” or “XSS”.</strong></span></p>
<p class="ai-optimize-41"><span style="color: #000000;">Therefore, it thus has been reported with <strong>“Medium Severity” </strong>with a <strong>CVSS score </strong>of <strong>“6.1” </strong>under:</span></p>
<ul>
<li class="ai-optimize-42"><span style="color: #000000;"><strong>CWE-601</strong>: URL Redirection to Untrusted Site (‘Open Redirect’)</span></li>
</ul>
<p class="ai-optimize-43"><span style="color: #000000;">So, in order to exploit this all, we’ve developed some PHP codes as the similar way the developer creates them to enable URL redirections into their applications, further we’ve even used a bWAPP-a vulnerable web-application and the PortSwigger lab.</span></p>
<p class="ai-optimize-44"><span style="color: #000000;">Let’s Start !!</span></p>
<h3 class="ai-optimize-173"><span style="color: #800000;">Open Redirection Exploitation</span></h3>
<h4 class="ai-optimize-45"><span style="color: #800000;">Basic Redirection</span></h4>
<p class="ai-optimize-46"><span style="color: #000000;">There are chances when the developer <strong>does</strong> <strong>not</strong> <strong>care</strong> about the <strong>input</strong> <strong>validations</strong> or <strong>filtrations</strong> or anything specific and simply <strong>implements</strong> the <strong>redirection</strong> <strong>functions</strong> as <strong>header() </strong>and let the <strong>redirected</strong> <strong>URL</strong> be in the <strong>clear</strong> <strong>texts</strong>.</span></p>
<p class="ai-optimize-47"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zEmPSWiipHc/XylU0WbbMuI/AAAAAAAAmgk/Zuk7vTxh3aofSvG1PqsqOY2LCUPPTfIiwCLcBGAsYHQ/s1600/2.png"/></span></p>
<p class="ai-optimize-48"><span style="color: #000000;">From the below image you can see that the <strong>redirected</strong>  <strong>URL </strong>over at the <strong>“here” </strong>text, is simply reflected as in the cleartext, which means that if we click over on it, we’ll be redirected to “<strong>hackingarticles.in</strong>”.</span></p>
<p class="ai-optimize-49"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--spcBbQ8Ngg/XylU33jhPSI/AAAAAAAAmgo/cwzTH8vVmk4fV8jttyTJvfehR7iugXwYwCLcBGAsYHQ/s1600/3.png"/></span></p>
<p class="ai-optimize-50"><span style="color: #000000;">So, let’s try to capture this all in our burpsuite and check what we could manipulate over on.</span></p>
<p class="ai-optimize-51"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-brXtIgaePQI/XylU8baT4hI/AAAAAAAAmgs/uvFvZjrqZZwlZ3M0G0OFqSvCT_9wlR90gCLcBGAsYHQ/s1600/4.png"/></span></p>
<p class="ai-optimize-52"><span style="color: #000000;">From the above image, you can see that, in the <strong>“url=” </strong>parameter<strong> http://www.hackingarticles.in </strong>is travelling, let’s try to manipulate this simple clear text with <strong>“http://www.google.com”</strong>.</span></p>
<p class="ai-optimize-53"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-A_9j1ZcPeBk/XylVAHCz85I/AAAAAAAAmgw/rUp43ZHoZrsK6nuVVMr3u_t9_MmSe8DLwCLcBGAsYHQ/s1600/5.png"/></span></p>
<p class="ai-optimize-54"><span style="color: #000000;">Simple !! From the below image you can see that, we’ve been redirected to <strong>“google.com” </strong>with a basic manipulation.</span></p>
<p class="ai-optimize-55"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-J98826FucMM/XylVDdAnkfI/AAAAAAAAmg4/24lRbc7hZ6co2XkeKrgmNKQGj6z8U27PACLcBGAsYHQ/s1600/6.png"/></span></p>
<h4 class="ai-optimize-56"><span style="color: #800000;">Encoded Redirection</span></h4>
<p class="ai-optimize-57"><span style="color: #000000;">In order to secure up the redirection process, sometimes the developers encode up the <strong>“url=”</strong> values and let the URL travel over on the internet as in with the redirection. The major encoding methods that a developer can implement are as the <strong>URL-encoding or the base-64 encoding. </strong></span></p>
<p class="ai-optimize-58"><span style="color: #000000;"><em>But, as we are aware that encoding is a 1-way technique, thus this security can simply be breached if we know about what encoding methodology the developer used into all this.</em></span></p>
<h4 class="ai-optimize-59"><span style="color: #800000;">URL Encoded Redirection</span></h4>
<p class="ai-optimize-60"><span style="color: #000000;">URL Encoding is one of the most common encoding methodologies that the developer use in order to <strong>disallow</strong> <strong>some vulnerable</strong> <strong>characters</strong> such as <strong>“&lt;” or “&gt;”</strong>, to get embedded into the URL.</span></p>
<p class="ai-optimize-61"><span style="color: #000000;"><em>The following PHP code snippet shows up a <strong>basic</strong> <strong>URL</strong> <strong>decoding redirection</strong>, which first decodes up the encoded input URL and then redirects it over to its desired destination.</em></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ixA24IOmOHY/XymvAVhWOhI/AAAAAAAAmks/eGm7JY0cm50bm9kDl8oCrIvS45GIHIFkQCLcBGAsYHQ/s1600/1.png"/></p>
<p class="ai-optimize-62"><span style="color: #000000;">Let’s try to bypass this encoding with some simple tricks.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-gva8BdqcCrs/XymvDxSExII/AAAAAAAAmkw/ikrN0_qG8asw_LQKXsCUHOIriivp7_1_QCLcBGAsYHQ/s1600/2.png"/></p>
<p class="ai-optimize-63"><span style="color: #000000;">From the following image, you can see that, as when I <strong>captured</strong> <strong>up</strong> the <strong>ongoing</strong> <strong>HTTP</strong> <strong>Request</strong> over of the <strong>“here” </strong>text, I was presented with the <strong>“url=” </strong>parameter containing the <strong>URL</strong> <strong>encoded</strong> <strong>redirection</strong> <strong>link</strong>.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-iesR8IsZntc/XymvHKQl_5I/AAAAAAAAmk0/bUf_XbLi-u44o6PXYl9hIIShQiIkTIsmwCLcBGAsYHQ/s1600/3.png"/></p>
<p class="ai-optimize-64"><span style="color: #000000;">By analyzing the captured request, it makes us clear that the <strong>“url=”</strong> parameter is having a simple <strong>basic</strong> <strong>URL</strong> <strong>encoded value</strong>. Though, let’s now try to encode our URL i.e. <strong><em>“https://www.ignitetechnologies.in”</em></strong>  over from the <strong>encode tab </strong>in our burpsuite.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-qQfU1he8tCM/XymvKBogrGI/AAAAAAAAmk4/cl5qxvHLVYwE7R6ikkkDbaTE7Magt1RAQCLcBGAsYHQ/s1600/4.png"/></p>
<p class="ai-optimize-65"><span style="color: #000000;">Cool!! Let’s check whether this would work or not. Manipulate the <strong>“url=” </strong>parameter with the <strong>ignite’s</strong> <strong>encoded</strong> value.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-hyoZKe3UAAs/XymvN2u2msI/AAAAAAAAmk8/x_nMUEcJ2k0fWjEekYu3ZIAWsZcHvHL3QCLcBGAsYHQ/s1600/5.png"/></p>
<p class="ai-optimize-66"><span style="color: #000000;">From the below image, you can see that, we’ve successfully defaced the website over with the <strong>“Open</strong> <strong>Redirection”</strong> vulnerability with some simple clicks.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-pibHfBHKKLQ/XymvRxoRLmI/AAAAAAAAmlE/ALH-ojk4UmIsoeT2uMrTBqHXiDjGCMcYwCLcBGAsYHQ/s1600/6.png"/></p>
<h4 class="ai-optimize-67"><span style="color: #000000;">Double URL Encoded Redirection</span></h4>
<p class="ai-optimize-68"><span style="color: #000000;">Being a developer, he knows that some simple clicks can easily bypass basic URL encoding; therefore, to make his application more secure in the redirection section, he implements “Double URL Encoding,” using the “urlencode() and urldecode()” functions twice, one after the other, as on the home page and the redirection page respectively.</span></p>
<p class="ai-optimize-69"><span style="color: #000000;"><em>The following redirection code snippet explains how to perform the decoding. It first takes the encoded URL and decodes it. Then, using another urldecode function, it decodes the previously decoded URL and passes it for the redirection.</em></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-0fOkJN2FGcU/XymvVq01-2I/AAAAAAAAmlM/pQM24FcSqGM7WJ1cQQdiMqA_7XEhF8JVQCLcBGAsYHQ/s1600/7.png"/></p>
<p class="ai-optimize-70"><span style="color: #000000;">So now, as we hover on the <strong>“here” </strong>text, we’ll find that this time the URL is not in the readable format, thus to be more precise let’s capture this all over in the burpsuite.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-5iOHaIiayu8/XymvZc-rgAI/AAAAAAAAmlU/Vr87EDvf8msNmRjh6o_6HVUmOTyY00udQCLcBGAsYHQ/s1600/8.png"/></p>
<p class="ai-optimize-71"><span style="color: #000000;">From the below image, you can see that the <strong>“url=” parameter’s value </strong>is different from the one that we see earlier when we hovered on the text, which simply means that, there is some more encoding over it.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ExN1YfnY5Jk/XymvcsghOdI/AAAAAAAAmlc/uAaYHEkzCmEh1yCJ6kEaDD_9dyxjsEl_wCLcBGAsYHQ/s1600/9.png"/></p>
<p class="ai-optimize-72"><span style="color: #000000;">Let’s copy it out and check it over in the <strong>decode</strong> <strong>tab. </strong>From the below image, you can see that we got the decoded  URL to be as <strong>“http://hackingarticles.in” </strong>when we opted the “<strong>URL Decode” </strong>option for about two times.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-HVL7ZyR20bI/Xym2cgVR99I/AAAAAAAAmmM/YPgX7vrDM-0CxQ39uH6s-H_SimnDuS6twCLcBGAsYHQ/s1600/Screenshot_1.png"/></p>
<h5 class="ai-optimize-73"><span style="color: #000000;">Manipulating URL</span></h5>
<p class="ai-optimize-74"><span style="color: #000000;">Until now, we are aware that, this application is taking up the URL’s that are <strong>double-encoded.</strong> Let’s now try to deface this web-application by manipulating up its <strong>“url=” parameter value </strong>again with <strong><em>“https://ignitetechnologies.in”</em></strong>.</span></p>
<p class="ai-optimize-75"><span style="color: #000000;">But wait, before that, we need to implement the <strong>double</strong> <strong>encoding </strong>methodology, which will thus make the redirection successful.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-FA_O8py3aYs/XymvjakR4HI/AAAAAAAAmls/mRkJu1nfNTIi8M2vH5kRHF7qHaaNMKBpgCLcBGAsYHQ/s1600/11.png"/></p>
<p class="ai-optimize-76"><span style="color: #000000;">Copy the double encoded value, and paste it over to the <strong>“url=” </strong>value.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-gMUOYBOhwNY/XymvmQXXWlI/AAAAAAAAmlw/mrHSM5piZSg_WLasP6JFvUzzA_01I459QCLcBGAsYHQ/s1600/12.png"/></p>
<p class="ai-optimize-77"><span style="color: #000000;">Great!! We are almost done. Let’s click on the <strong>Forward button, </strong> and check out what it displays to us.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-_V6ifwJqHzk/Xymvpgejz7I/AAAAAAAAml0/QcR6VXACh-M8TQxBh45xstHKBAJ4tf1sQCLcBGAsYHQ/s1600/13.png"/></p>
<h4 class="ai-optimize-78"><span style="color: #800000;">Base64 Redirection</span></h4>
<p class="ai-optimize-79"><span style="color: #000000;">URL Encoding is not the only encoding methodology that the developer implements. Thus in order to make the <strong>redirection</strong> <strong>process</strong> <strong>more</strong> <strong>secure</strong>, they may use base64, hex, octal, binary, HTML or anything specific.</span></p>
<p class="ai-optimize-80"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-462rgqslMdk/XylVHWUv8RI/AAAAAAAAmhE/lpcdLwJIJ_UQOHcFwvm2fxybYWaLO0W1wCLcBGAsYHQ/s1600/7.png"/></span></p>
<p class="ai-optimize-81"><span style="color: #000000;">From the above image, you can see that if we hover over the <strong>“here” </strong>text. We get the <strong>“url=” </strong>value in the encoded form. So, let’s try to bypass this encoding:</span></p>
<p class="ai-optimize-82"><span style="color: #000000;">In my burp suite monitor, I’ve captured up the ongoing request and have copied the <strong>“url=” </strong>value.</span></p>
<p class="ai-optimize-83"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LWGPYmA5Ec8/XylVLdtAhnI/AAAAAAAAmhI/QSY9KzlpP1MuM0IRJYaxDqbFwQNLvLRewCLcBGAsYHQ/s1600/8.png"/></span></p>
<p class="ai-optimize-84"><span style="color: #000000;">Now, with the <strong>copied</strong> <strong>encoded</strong> <strong>value</strong>. I tried to <strong>decode</strong> it with different encoding methodologies, and thus there, I got it for <strong>Base64.</strong></span></p>
<p class="ai-optimize-85"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--CCwII7hpwo/XylVPsX16dI/AAAAAAAAmhM/4vXJaLUavhkoI1vfEMywr0QqsLVd75o4ACLcBGAsYHQ/s1600/9.png"/></span></p>
<p class="ai-optimize-86"><span style="color: #000000;">Cool !! As we are now aware of the encoding method. Let’s now try to encode some other URL’s and check for their outcomes.</span></p>
<p class="ai-optimize-87"><span style="color: #000000;">Back in the burpsuite, and in the <strong>decode</strong> tab. I’ve tried to encode <strong>“google.com”</strong> over with <strong>Base64. </strong>There I’ve further copied up its encoded value.</span></p>
<p class="ai-optimize-88"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LVYazWnp1AQ/XylVTDTM9UI/AAAAAAAAmhY/AlxuXJpu8JYFahh9CsTfyKRkQp4jSXjpQCLcBGAsYHQ/s1600/10.png"/></span></p>
<p class="ai-optimize-89"><span style="color: #000000;">Let’s now manipulate the <strong>“url=” parameter </strong>with the copied value and thus then fire up the <strong>Forward button</strong> and check the response over back in the browser.</span></p>
<p class="ai-optimize-90"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-c3L2scKq7EE/XylVXH7BCBI/AAAAAAAAmhc/B_Kpjx_oxEYJhDRYovEfKJcPhps_mLdYQCLcBGAsYHQ/s1600/11.png"/></span></p>
<p class="ai-optimize-91"><span style="color: #000000;">Great!! From the below image, you can see that we’ve again successfully bypassed this security.</span></p>
<p class="ai-optimize-92"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yIWOi_EjUEI/XylVaTTbqUI/AAAAAAAAmhk/wgPEJrDhfoIRooDSX6x8EZAV0e4HX-mrwCLcBGAsYHQ/s1600/12.png"/></span></p>
<p class="ai-optimize-93"><span style="color: #000000;">Let’s check out why this all happened:</span></p>
<p class="ai-optimize-94"><span style="color: #000000;">From the below code snippet, you can see that the developer is again trusting his visitors and is reliable on the <strong>header()</strong> function which <strong>first</strong> <strong>decodes</strong> up the <strong>encoded</strong> <strong>input</strong> <strong>URL</strong> with <strong>URL decode and then with base-64 decoding. </strong>Thus further redirects the user to his desired webpage.</span></p>
<p class="ai-optimize-95"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-nkdhFd-etN8/XylVdkRg96I/AAAAAAAAmhs/bg1MWdTqaxYEBOSSiZvhvMjdduYckI_TACLcBGAsYHQ/s1600/13.png"/></strong></span></p>
<h4 class="ai-optimize-96"><span style="color: #800000;">URL Redirection with Hash values</span></h4>
<p class="ai-optimize-97"><span style="color: #000000;">Experienced developers use hash values, which immunes up the web –applications from the “Open Redirect” vulnerability. They could have used any hashing algorithm, whether it is MD5, SHA512 or SH1 or any other. </span></p>
<p class="ai-optimize-98"><span style="color: #000000;">Some developers even implement the <strong>combination</strong> of <strong>URL</strong> and the <strong>hash</strong> <strong>values</strong> as we’ve used in this section i.e. when choose the <strong>“</strong>Copy Link Location<strong>”</strong> of <strong>“</strong>here<strong>” </strong>text we’ll get the output</span></p>
<p class="ai-optimize-99"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jlhnlZ6ofn4/XylVhO1y0aI/AAAAAAAAmhw/On60UIV1UEkZEm_axOiyoMrHnU5jzDQoACLcBGAsYHQ/s1600/14.png"/></span></p>
<p class="ai-optimize-100"><span style="color: #000000;">From the below image, you can see that this time rather than the <strong>“url=” </strong>parameter. We have one more as “<strong>hash=”.</strong></span></p>
<p class="ai-optimize-101"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xRSOhcSRVvE/XylVlZqGKFI/AAAAAAAAmh4/M4MBLJs6kqEhifPuK1plnAiN3C7K2JgzQCLcBGAsYHQ/s1600/15.png"/></span></p>
<p class="ai-optimize-102"><span style="color: #000000;">Now, if we manipulate the <strong>“url=” </strong>with <strong>“https://www.bing.com”</strong> and <strong>leaves</strong> <strong>up</strong> <strong>the</strong> <strong>hash</strong> <strong>value</strong> <strong>the</strong> <strong>same</strong> <strong>as</strong> <strong>it</strong> <strong>was</strong>. Thus then we will face the error.</span></p>
<p class="ai-optimize-103"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ALS-Y-xrWRY/XylVo-6TPII/AAAAAAAAmh8/kXJ8v9KNOvEyxYWeBjkNb1RSXjWqJYYbgCLcBGAsYHQ/s1600/16.png"/></span></p>
<p class="ai-optimize-104"><span style="color: #000000;"><em>“As when we clicked on the <strong>“here” </strong>text, the redirection script will catch the passed URL and generate its hash value. And <strong>compare the generated hash value with the hash value we have sent with the request. </strong>If both the hash values match the redirection would <strong>work</strong> else it will <strong>fail</strong>.”</em></span></p>
<p class="ai-optimize-105"><span style="color: #000000;"><em>Here in this segment, the developer used the <strong>MD5</strong> <strong>hash</strong> <strong>algorithm.</strong></em></span></p>
<p class="ai-optimize-106"><span style="color: #000000;">So, let’s now try to exploit this major security again with some manipulations. But this time we need to encrypt our URL over with the <strong>MD5 hash</strong>.</span></p>
<p class="ai-optimize-107"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-o2c54k0BCag/XylVt7zlauI/AAAAAAAAmiE/XgIbA93cemwRCJ1KQ1kVLISUWkyC8QD3QCLcBGAsYHQ/s1600/18.0.png"/></span></p>
<p class="ai-optimize-108"><span style="color: #000000;">With a basic MD5 Hash generator<strong>, </strong>we’ve encrypted <strong>https://www.bing.com</strong>. Copy this all and craft it in with the URL.</span></p>
<p class="ai-optimize-109"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XYY7zg3GoMU/XylV8ADXaVI/AAAAAAAAmiU/x9YsNFXlg6cdjIIcUQAj4lZsFasRKyXywCLcBGAsYHQ/s1600/19.0.png"/></span></p>
<p class="ai-optimize-110"><span style="color: #000000;">Great!! From the below image you can see that, as soon as I execute the above-manipulated URL in the browser, I got redirected to my desired result.</span></p>
<p class="ai-optimize-111"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-orBu0KfCiG0/XylWAUAsUlI/AAAAAAAAmig/OrEFvsvpleUDPpP9bvKu0-dAEgRGb3YngCLcBGAsYHQ/s1600/20.png"/></span></p>
<h4 class="ai-optimize-112"><span style="color: #800000;">Redirection with Hash values using Salt</span></h4>
<p class="ai-optimize-113"><span style="color: #000000;"><em>Encoded</em><em> URL’s can be bypassed, URL parameter with a hash can even be misguided, but what, if the redirected URL is encrypted with a salt value?</em></span></p>
<p class="ai-optimize-114"><span style="color: #000000;"><strong>Salt</strong> could be <strong>anything</strong>, it could be a combination of characters, digits, alphanumeric, special character or anything we want. A salt further increases the security for redirecting the URL or even it make up impossible to deface a web-application. </span><span style="color: #000000;">But, there is still a chance to misguide the users, if we could guess up the salt value or even if the developer displays it in the URL itself.</span></p>
<p class="ai-optimize-115"><span style="color: #000000;">From the below image, you can see that here the developer passed up his salt value in the URL as <strong>“ignite”. </strong>Cool!! This was all we need to deface this web-application, let’s try to do so.</span></p>
<p class="ai-optimize-116"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Z5wIsIgwTsE/XylWESlB9cI/AAAAAAAAmio/ZGBN3dMGYL0wSR3eqjjX87-rfzDLGspXACLcBGAsYHQ/s1600/21.png"/></span></p>
<p class="ai-optimize-117"><span style="color: #000000;">Over in <strong>burpsuite, </strong>I’ve captured the ongoing HTTP Request that was generated with the <strong>“here” </strong>text.</span></p>
<p class="ai-optimize-118"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TftNw19rEhs/XylWHheUFUI/AAAAAAAAmis/WZ_crks7aaYkCQEaP7-6zPQSRxDrxMROwCLcBGAsYHQ/s1600/22.png"/></span></p>
<p class="ai-optimize-119"><span style="color: #000000;">Great!! So its time to manipulate the URL as we are now aware of <strong>the</strong> <strong>salt</strong> <strong>value</strong>, but wait we don’t know the type of hash it is using. Okay !! with some permutations and combinations and some hit &amp; trial methods,  I got it as <strong>a SHA256 hash</strong>.</span></p>
<p class="ai-optimize-120"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-eTEKA-ChDZc/XylWMM_ImEI/AAAAAAAAmiw/wp68Z9mG1tECzSyD4gPS1EZiFLLBiP0fACLcBGAsYHQ/s1600/23.png"/></span></p>
<p class="ai-optimize-121"><span style="color: #000000;">So let’s now try to deface this web-application by generating the hash value of our <strong>“URL” </strong>with the same procedure we decrypted that earlier.</span></p>
<p class="ai-optimize-122"><span style="color: #000000;">Therefore you can do so over through this <strong><a style="color: #000000;" href="https://www.symbionts.de/tools/hash/sha256-hash-salt-generator.html">SHA256</a></strong><strong> hash generator</strong>.</span></p>
<p class="ai-optimize-123"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7ekjg4FodS0/XylWP23HFrI/AAAAAAAAmi8/dKQzfiM8VuwatQ6OtVEfuXO_gxkMrsdTACLcBGAsYHQ/s1600/24.png"/></span></p>
<p class="ai-optimize-124"><span style="color: #000000;">Copy this all – the <strong>URL and the generated Hash value</strong>. And thus <strong>manipulate</strong> it over in our <strong>burpsuite</strong>.</span></p>
<p class="ai-optimize-125"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-A8MLC6oas9w/XylWT05nDsI/AAAAAAAAmjA/uKW_ccj04V0HjL078KVRlA0i1Ils-00RACLcBGAsYHQ/s1600/25.png"/></span></p>
<p class="ai-optimize-126"><span style="color: #000000;">Woah!! We’ve successfully bypassed this security level which was expected to the most secure one.    </span></p>
<p class="ai-optimize-127"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MP4E03RUXF4/XylWXK3y_RI/AAAAAAAAmjI/1elvSohRhlIYHz352oDuUl0MiWoA7gdbACLcBGAsYHQ/s1600/26.png"/></span></p>
<h4 class="ai-optimize-128"><span style="color: #800000;">Redirection over inside a Web-Page</span></h4>
<p class="ai-optimize-129"><span style="color: #000000;">So, up till now, we have seen that the developer redirects his visitors to the resources that were outside the web-application. But there are chances that he might set the <strong>redirect()</strong> or <strong>header()</strong> function to make its users, to travel the web-pages which reside inside the application’s interface.</span></p>
<p class="ai-optimize-130"><span style="color: #000000;">Let’s boot into our vulnerable web-application <strong>bWAPP as “bee : bug” </strong>and set the <strong>“Choose your bug” option </strong>to <strong>“<em>Unvalidated Redirects &amp; Forwards (2)</em>”. </strong></span></p>
<p class="ai-optimize-131"><span style="color: #000000;">Thus, there on the page, if we hover the <strong>“here”</strong> text we can see that there is a <strong>“ReturnUrl=”</strong> parameter.</span></p>
<p class="ai-optimize-132"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LxrVvP-XkvM/XylWbVnvfcI/AAAAAAAAmjM/CKgcovLL97UphT7W80cm0Ew29BV7z6jHACLcBGAsYHQ/s1600/27.png"/></span></p>
<p class="ai-optimize-133"><span style="color: #000000;">Let’s capture the passing HTTP Request over of the <strong>“here” </strong>text and check what we could grab with it.</span></p>
<p class="ai-optimize-134"><span style="color: #000000;">From the below image. You can see that the “ReturnURL=” parameter forwards the user back to the “portal.php” page. Which is thus nothing but a URL redirection and therefore can leverage an “Open Redirect” vulnerability.</span></p>
<p class="ai-optimize-135"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pEANolsI89U/XylWihKRg-I/AAAAAAAAmjU/Y4YemBc55GAVe0POtpbjEi3qlTgfVUPyACLcBGAsYHQ/s1600/28.png"/></span></p>
<p class="ai-optimize-136"><em><span style="color: #000000;">Isn’t it great that we, as low privileged users, can grab the content of the “configuration files” or anything specific for which we’re not authorized, and this all happens when the developers patch the “LFI” vulnerability?</span></em></p>
<p class="ai-optimize-137"><span style="color: #000000;">So let’s try to do so – as we’re aware, that the <strong>configuration files </strong>reside inside the web-applications default folder. Thus it would be easy to call that up over from the <strong>“here” </strong>text, by manipulating the captured request with our desired URL.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.0..11/bWAPP/unvalidated_redir_fwd_2.php?ReturnURL=config.php</pre>
<p class="ai-optimize-138"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VVMIr9l8vQQ/XylWm1KIMfI/AAAAAAAAmjY/3QCBCkjnouMhjf34dMzzLyzA4zkyEkqpQCLcBGAsYHQ/s1600/29.png"/></span></p>
<p class="ai-optimize-139"><span style="color: #000000;">As soon as we hit the <strong>Forward</strong> button. The system redirected us to the <strong>config.inc</strong>, which thus contains all the basic configurations.</span></p>
<p class="ai-optimize-140"><span style="color: #000000;">Great!! We’re into the <strong>config.inc</strong> file and though we are now having more information about our target’s server.</span></p>
<p class="ai-optimize-141"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WsTD_aJvJho/XylWqceDIFI/AAAAAAAAmjg/gb70hlPQGdUHlonK1kqyr53uA5VtwJZUgCLcBGAsYHQ/s1600/30.png"/></span></p>
<h4 class="ai-optimize-142"><span style="color: #800000;">DOM-based Open Redirect</span></h4>
<p class="ai-optimize-143"><span style="color: #000000;">DOM-based open-redirection vulnerabilities arise when a script writes attacker-controllable data into a sink that can trigger cross-domain navigation which thus <strong>facilitates</strong> <strong>phishing</strong> <strong>attacks</strong> against users of the websites.</span></p>
<h5 class="ai-optimize-144"><span style="color: #000000;"><strong>So what is a sink?</strong></span></h5>
<p class="ai-optimize-145"><span style="color: #000000;"><em>An attacker can cause undesirable effects if they pass controlled data to a potentially dangerous JavaScript function or DOM object.</em></span></p>
<p class="ai-optimize-146"><span style="color: #000000;"><em>The major sinks that could lead to DOM-based Open Redirection vulnerability are <strong>“location”<br/>
“location.hostname” “location.href” “location.pathname”.</strong></em></span></p>
<p class="ai-optimize-147"><span style="color: #000000;">So, let’s try to implement it, in some real scenarios over at<span style="color: #0000ff;"><strong> <a style="color: #0000ff;" href="https://portswigger.net/web-security/dom-based/open-redirection/lab-dom-open-redirection">The Portswigger Academy</a></strong></span> and exploit this DOM-based Open Redirect vulnerability.</span></p>
<p class="ai-optimize-148"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-A9GXvd90c34/XylWulRD4RI/AAAAAAAAmjk/kMz2DfCF-yE0q0CI0ApkwdIkDYrM7vDHQCLcBGAsYHQ/s1600/31.png"/></span></p>
<p class="ai-optimize-149"><span style="color: #000000;">As we hit the <strong>“Access the lab”</strong> button. A blog that is somewhere or the other suffering from “<strong>Open Redirection</strong>” redirects us<strong>.</strong></span></p>
<p class="ai-optimize-150"><span style="color: #000000;">But before that, we got something new as <strong>“Go to exploit server”, </strong>let’s check that out.</span></p>
<p class="ai-optimize-151"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jNSdGwuhy3s/XylWy-BQbBI/AAAAAAAAmjs/yc1ica35NmgvaxIVBslJYrgL7SDHJtbDACLcBGAsYHQ/s1600/32.0.png"/></span></p>
<p class="ai-optimize-152"><span style="color: #000000;">That’s nice, we’re having our exploit server here, let’s copy its URL and we’ll try to redirect that blog to our server.</span></p>
<p class="ai-optimize-153"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KAjZoe0Pq8E/XylW3kYjZhI/AAAAAAAAmj0/FaKf_DPntBEeEZ1PexEzHp9p8S2g2DPKQCLcBGAsYHQ/s1600/33.0.png"/></span></p>
<p class="ai-optimize-154"><span style="color: #000000;">So let’s open a specific blog-post, say the first one and check <strong>its source code</strong> with a simple right-click over any segment of the page.</span></p>
<p class="ai-optimize-155"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WDVGNDUi0bw/XylW7Fc7PfI/AAAAAAAAmj4/obRw9jaGg9gvVjBRJcsaaumWHJEpBgNHQCLcBGAsYHQ/s1600/34.png"/></span></p>
<p class="ai-optimize-156"><span style="color: #000000;">Great!! From the below image, I see that the “Back to Blog” text contains some URL, indicating an “Open Redirect” since the code does not validate or sanitize user input in the “location” property, and it even sets an onclick event as <strong>“url=(https”</strong></span></p>
<p class="ai-optimize-157"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fmiG7shKf08/XylW_HF8nCI/AAAAAAAAmj8/91Y6vXDLXB8Mj4wKxVZ0TYIHY3F45saGACLcBGAsYHQ/s1600/35.png"/></span></p>
<p class="ai-optimize-158"><span style="color: #000000;">However, if we manipulate the <strong>web</strong>–<strong>page</strong> <strong>URL</strong> by <strong>integrating</strong> <strong>our</strong> <strong>exploit</strong> <strong>server’s</strong> <strong>URL</strong> with <strong>“&amp;url=” parameter </strong>as</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">web-security-academy.net/post?postId=1&amp;url=https://acae1fa01f50080b2d7d801d30034.web-security-academy.net</pre>
<p class="ai-optimize-160"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-K_K0hAquRU8/XylXCvEWZKI/AAAAAAAAmkE/3KMvSnO6M7ASXqMIDZxfAemsbBEY7aatQCLcBGAsYHQ/s1600/36.png"/></span></p>
<p class="ai-optimize-161"><span style="color: #000000;">From the above image, you can see that, now if I hover the <strong>“Back to Blog” </strong>section. I got the redirection link to as the one I manipulated earlier.</span></p>
<p class="ai-optimize-162"><span style="color: #000000;">Let’s check out its output, by clicking over the <strong>“Back to Blog” </strong>text.</span></p>
<p class="ai-optimize-163"><span style="color: #000000;">Great!! From the below image, you can see that we successfully solved this lab and thus redirected ourselves to our exploit server.</span></p>
<p class="ai-optimize-164"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GyqagCv3DIE/XylXG1O1vfI/AAAAAAAAmkI/zhWS52s2n8Eq3WGtOMDUr_F1Ot6RV-a4wCLcBGAsYHQ/s1600/37.png"/></span></p>
<h3 class="ai-optimize-165"><span style="color: #800000;">Mitigation Steps</span></h3>
<ul>
<li class="ai-optimize-166"><span style="color: #000000;">The system should properly sanitize and validate the user input.</span></li>
<li class="ai-optimize-167"><span style="color: #000000;">The developer should set up a whitelist of his trustworthy URLs.</span></li>
<li class="ai-optimize-168"><span style="color: #000000;">If the developer is setting up any hash or a salt value, they should hide it and not display it in the URL.</span></li>
<li class="ai-optimize-169"><span style="color: #000000;">Instead of using the redirect function, the developer should implement specific links over on the text keywords.</span></li>
<li class="ai-optimize-170"><span style="color: #000000;">The web-application should pop out a warning when a user tries to redirect to an untrusted domain.</span></li>
</ul>
<p class="ai-optimize-171"><span style="color: #000000;">To learn more about Website Hacking. Follow this</span> <a href="https://www.hackingarticles.in/category/website-hacking/"><strong>Link.</strong></a></p>
<p class="ai-optimize-172"><span style="color: #000000;"><b>Author</b>: Geet Madan is a Certified Ethical Hacker, Researcher and Technical Writer at Hacking Articles on Information Security<b>. </b>Contact <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/geet-madan/"><b>here</b></a></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
