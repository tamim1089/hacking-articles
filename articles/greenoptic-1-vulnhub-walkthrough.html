<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">GreenOptic: 1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/greenoptic-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-07-20T19:16:59+00:00">July 20, 2020</time><time class="updated" datetime="2025-06-10T20:10:21+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another boot2root challenge called “GreenOptic – 1”.  It’s available at VulnHub for penetration testing and you can download it from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/greenoptic_1,510/">here</a></strong></span>.</span></p>
<p><span style="color: #000000;">The credit for making this lab goes to<span style="color: #0000ff;"><strong> Thomas Williams</strong></span>. Let’s get started and learn how to successfully break it down.</span></p>
<p><span style="color: #000000;">Level: <strong>Hard</strong></span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<p><span style="color: #000000;"><strong>Recognition</strong></span></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Gobuster</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Local File Inclusion Vulnerability (LFI)</span></li>
<li><span style="color: #000000;">John The Ripper</span></li>
<li><span style="color: #000000;">Wireshark</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Credential theft with network forensics</span></li>
<li><span style="color: #000000;">Abuse of Wireshark group</span></li>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #000000;"><strong>Recognition</strong></span></h3>
<p><span style="color: #000000;">We are looking for the machine IP with netdiscover</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0jQ93d6RW78/XxXq8pldf5I/AAAAAAAAmGo/fLtde892vToiGu4qJgFlxDLSMSl0VHqogCLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">So, let’s start by running map to all ports with OS detection, software versions, scripts and traceroute.</span></p>
<pre class="lang:default decode:true">nmap -A -p- 192.168.10.160</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yLUcz8tC0_I/XxXrBDdu4dI/AAAAAAAAmGs/PsP1meQtQJkdlGkdPHRNWqC7zSgFF97VACLcBGAsYHQ/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">We access the website and by visiting the different sections, we can list the name and surname of the CEO and other employees.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-db3Txai5k5I/XxXrIiM4UCI/AAAAAAAAmGw/5vnO85ppFgQppUM9KjpibpTzWHAafdJtQCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We enter the web service through port<strong> 10000</strong> and see that it indicates a route that includes your domain name</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oRGUdwLNWf0/XxXrPspz_VI/AAAAAAAAmG4/SFU78_RHkXsepzOd1Gfd-8WPrnYuO8YmQCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We will configure our “<strong>/etc/hosts</strong>” file:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xf-mC2eUBE0/XxXrVM4c7MI/AAAAAAAAmHA/Exq7UBji4NYnHA9djelJzSb6NbDFgKoSQCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We open the web address<strong> websrv01.greenoptic.vm:10000</strong> and find a control panel “<strong>Webmin</strong>“. Although it seems interesting, we won’t listen to it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KH61HqO0sYU/XxXraBKXFyI/AAAAAAAAmHI/tWK7Ob8Mt3IyjjwU0O2izKLKwzoBHhBNgCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We used<strong> Gobuster</strong> to further investigate the first website, we found a directory called “<strong>account</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uqGO-k8RGAs/XxXreZfgUeI/AAAAAAAAmHM/QNV7GMWQB5csZE1J9YeAGuFiAg7-e7UgQCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">We access it and find an authentication system, but the variable “<strong>?include=cookiewarning</strong>” catches our attention.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-G0hNAUizlm0/XxXrirId0ZI/AAAAAAAAmHQ/sWofgoqC4OUoKuD2YaWBZvAbaWO9FwMDwCLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Change “<strong>cookiewarning</strong>” to “<strong>.. /.. /.. /.. /.. /.. /.. /etc/passwd</strong>” and show that the application is vulnerable to LFI (Local File Inclusion).</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-73eYGWp7Z0A/XxXrm7tvmaI/AAAAAAAAmHY/b-RaMbZ788MVbgE9wzoPcYf2oao5GL4vgCLcBGAsYHQ/s1600/9.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">We went through the<strong> DNS service</strong> with “<strong>dig</strong>” and listed a subdomain called “<strong>recoveryplan.greenoptic.vm</strong>“. Strange, isn’t it? A company that has backup!!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-umR8hluq_Ic/XxXrsHCnpRI/AAAAAAAAmHc/3-nhd0f_HtsucexfrZeSzvcblsH-uCS0QCLcBGAsYHQ/s1600/10.png"/></span></p>
<p><span style="color: #000000;">We introduce this subdomain to the file “<strong>/etc/hosts</strong>” and enter it from the web browser.</span></p>
<p><span style="color: #000000;">It asks for authentication, we try with “guessing” but without success.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-98gp0-h-1q0/XxXrwBg62cI/AAAAAAAAmHk/MaS4FinDXws2lhZFWlIFrsdSlQBdIzGJQCLcBGAsYHQ/s1600/11.png"/></span></p>
<p><span style="color: #000000;">This type of authentication is done through the “<strong>.htpasswd</strong>” file, taking advantage of the<a href="https://www.hackingarticles.in/comprehensive-guide-to-local-file-inclusion/"><span style="color: #0000ff;"><strong><u> LFI vulnerability</u> </strong></span></a>found above, we can load the file and read the encrypted credentials.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jRpTQ-3XpR8/XxXr0Mtks_I/AAAAAAAAmHs/vi3MuCxfW-024Zj7p6YoNkrts5IcqAKzACLcBGAsYHQ/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Using<strong> JohnTheRipper</strong> and the “<strong>rockyou</strong>” dictionary we managed to crack the hash and get the password in plain text.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--gF_6_EGOpk/XxXr4cJ1UwI/AAAAAAAAmH0/SvjHSKk55JEiV56CFHo7p6CWjU3qsNbQQCLcBGAsYHQ/s1600/13.png"/></span></p>
<p><span style="color: #000000;">We use the credentials to access the “<strong>phpBB</strong>” forum and view an administrator’s post, which includes a “<strong>.zip</strong>” file containing “<em>juicy</em>” information.</span></p>
<p><span style="color: #000000;">They also mention that the “<strong>dpi.zip</strong>” file is password protected and that this has been sent to “<strong>Sam</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Fat_ge9myVY/XxXr-QY-cVI/AAAAAAAAmH4/1g9ZLej536YdukMxCnO4_WHj_fsxb3pjwCLcBGAsYHQ/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Again we use the<strong><u> LFI vulnerability</u></strong> and read the email from “<strong>Sam</strong>“, we get the password to be able to unzip the file “<strong>dpi.zip</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9fJuSmlEj_4/XxXsCgBR-pI/AAAAAAAAmIA/XAQP5-ns8dM5ZVpraVkjTlmiLtHWjvBMQCLcBGAsYHQ/s1600/15.png"/></span></p>
<p><span style="color: #000000;">We open the file “<strong>dpi.pcap</strong>” and analyzing it we find the credentials of the FTP service of the user “<strong>Alex</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-w2EKICHRSd0/XxXsGc0DyLI/AAAAAAAAmII/RDtNo3r7wqgZarDOyt_A7T-0jUpWx_5jwCLcBGAsYHQ/s1600/16.png"/></span></p>
<p><span style="color: #000000;">We access via FTP and read the file “<strong>user.txt</strong>“.</span></p>
<p><span style="color: #000000;">It tells us to try the same credentials to access through the<strong> SSH service</strong>, we connect through it and get access to the inside of the machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3Gq9YveA88E/XxXsKeDf-nI/AAAAAAAAmIQ/1DVGG43hddkJpE95ED5gNc0CNJ0nbgCsgCLcBGAsYHQ/s1600/17.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation (root)</strong></span></h3>
<p><span style="color: #000000;">We check files and binaries we have access to, we check privileges and permissions and the only interesting thing is that we belong to the “<strong>Wireshark</strong>” group.</span></p>
<p><span style="color: #000000;">We open Wireshark and sniff all the traffic, we see that there is an attempt of authentication that happens frequently. We check the package in question and find some credentials in “<strong>base64</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-s1tKMrgy9EQ/XxXsOwTQC8I/AAAAAAAAmIY/N3_4D-f_7YcTuqVM4TYnhVWLKIX6RF6cgCLcBGAsYHQ/s1600/18.png"/></span></p>
<p><span style="color: #000000;">We decode these credentials (password is: <strong>ASfojoj2eozxczzmedlmedASASDKoj3o</strong>), authenticate ourselves as “<strong>root</strong>” and read your flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bpldS_8-LTc/XxXsSFUx-NI/AAAAAAAAmIc/an8BnEXEcfc13eGTOPsOA5dTBrF69NW6gCLcBGAsYHQ/s1600/19.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>David Utón</strong> is Penetration Tester and security auditor for Web applications, perimeter networks, internal and industrial corporate infrastructures, and wireless networks Contacted on<strong> LinkedIn</strong> and <strong><a style="color: #000000;" href="https://twitter.com/David_Uton">Twitter</a></strong>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
