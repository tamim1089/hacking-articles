<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/active-directory-certificate-attack/" rel="category tag">Active Directory Certificate Attack</a></span>            </div>
            <h1 class="post-title entry-title">ADCS ESC10 – Weak Certificate Mapping</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/adcs-esc10-weak-certificate-mapping/" rel="bookmark"><time class="entry-date published" datetime="2025-06-16T18:01:42+00:00">June 16, 2025</time><time class="updated" datetime="2025-06-29T19:21:24+00:00">June 29, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000"><strong>ESC10</strong> is a powerful <strong>post-exploitation technique in Active Directory Certificate Services (ADCS)</strong> that lets attackers authenticate as any user even <strong>Domain Admins</strong> without knowing their password. It exploits two key weaknesses: <strong>weak certificate mapping enforcement</strong> and <strong>shadow credentials</strong> (custom certificate logins). Unlike traditional attacks, ESC10 abuses <strong>PKI trust and AD flexibility</strong>, making it stealthy, persistent, and often overlooked in enterprise environments.</span></p>
<h3><span style="color: #800000">Table of Content</span></h3>
<ul>
<li><span style="color: #000000"><strong>Overview of the ESC10 Attack</strong></span></li>
<li><span style="color: #000000"><strong>Working of ESC10</strong></span></li>
<li><span style="color: #000000"><strong>ESC10 as an Extension of ESC9</strong></span></li>
<li><span style="color: #000000"><strong>Prerequisites</strong></span></li>
<li><span style="color: #000000"><strong>Lab Setup</strong></span></li>
</ul>
<p><span style="color: #000000"><strong>Enumeration &amp; Exploitation </strong></span></p>
<ul>
<li><span style="color: #000000">Weak UPN Mapping via Shadow Credentials</span></li>
</ul>
<p><span style="color: #000000"><strong>Post Exploitation</strong></span></p>
<ul>
<li><span style="color: #000000">Lateral Movement &amp; Privilege Escalation using certipy LDAP Shell as Administrator</span></li>
<li><span style="color: #000000">Lateral Movement &amp; Privilege Escalation using Evil-Winrm</span></li>
</ul>
<p><span style="color: #000000"><strong>Mitigation </strong></span></p>
<h3><span style="color: #800000">Overview of the ESC10 Attack</span></h3>
<p><span style="color: #000000">ESC10 is a <strong>powerful variation</strong> of the <strong>ESC9 attack</strong>, both of which result in full domain compromise. While ESC9 requires an attacker to identify a misconfigured certificate template and an account they can modify (via GenericWrite), it is limited to templates with specific dangerous configurations (e.g., ENROLLEE_SUPPLIES_SUBJECT). In contrast, <strong>ESC10 removes that limitation entirely</strong>, making it far more flexible and broadly applicable. It leverages <strong>system-level trust assumptions</strong> rather than relying solely on specific certificate template properties.</span></p>
<p><span style="color: #000000">ESC10 exploits weaknesses in AD CS and Kerberos certificate-based authentication (PKINIT):</span></p>
<p><span style="color: #000000"><strong>Weak certificate mapping enforcement (StrongCertificateBindingEnforcement = 0)</strong></span></p>
<ul>
<li><span style="color: #000000">When strong binding is disabled, AD relies only on the certificate’s <strong>User Principal Name (UPN)</strong>, ignoring the <strong>Security Identifier (SID)</strong>.</span></li>
<li><span style="color: #000000">This allows attackers to spoof the UPN of privileged users (e.g., Domain Admins) and gain unauthorized access using a forged certificate.</span></li>
</ul>
<p><span style="color: #000000"><strong>Shadow credentials via msDS-KeyCredentialLink write access</strong></span></p>
<ul>
<li><span style="color: #000000">If an attacker has write permissions to this attribute on a user account, they can inject a custom certificate-based credential.</span></li>
<li><span style="color: #000000">This enables <strong>Pass-the-Certificate</strong> attacks and persistent, passwordless access.</span></li>
</ul>
<p><span style="color: #000000"><strong>UPN spoofing through account manipulation</strong></span></p>
<ul>
<li><span style="color: #000000">With <strong>GenericWrite</strong> rights, an attacker can change the UPN of a controlled or target account to impersonate another user.</span></li>
<li><span style="color: #000000">Combined with weak binding, this allows certificate enrollment and Kerberos authentication as the spoofed identity.</span></li>
</ul>
<p><span style="color: #000000">This attack chain requires no password cracking, no memory injection, and leaves minimal forensic traces.</span></p>
<h3><span style="color: #800000">Working of ESC10</span></h3>
<p><span style="color: #000000">The ESC10 technique typically involves the following steps:</span></p>
<ul>
<li><span style="color: #000000"><strong>Attacker gains control of a low-privileged user account</strong> through any initial access method (e.g., phishing, brute force, credential dumping).</span></li>
<li><span style="color: #000000">The attacker identifies that checking the registry key weakens the domain’s certificate-based authentication trust model:</span></li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">HKEY_LOCAL_MACHINESYSTEMCurrentControlSetServicesKdcStrongCertificateBindingEnforcement</pre>
<p><span style="color: #000000">If you set this value to 0, the domain does not enforce strong binding between certificates and user accounts during Kerberos authentication (a common default or legacy setting).</span></p>
<ul>
<li><span style="color: #000000">Using <strong>GenericWrite</strong> permissions over another user object (e.g., Administrator), the attacker modifies the <strong>User Principal Name (UPN)</strong> of the controlled account to match the target (e.g., Administrator@ignite.local).</span></li>
<li><span style="color: #000000">The attacker then requests a certificate in the name of that target user using any <strong>enrollment-capable certificate template</strong>.</span></li>
<li><span style="color: #000000">With this forged certificate, the attacker authenticates as the privileged user and gains <strong>full domain access</strong>.</span></li>
</ul>
<p><span style="color: #000000">This attack works <strong>even if no specific misconfigured template exists</strong>, as long as there’s <strong>any usable certificate template</strong> and the domain does not enforce strong certificate binding.</span></p>
<h3><span style="color: #800000">ESC10 as an Extension of ESC9</span></h3>
<p><span style="color: #000000">ESC10 extends the same core abuse path introduced in ESC9:</span></p>
<ul>
<li><span style="color: #000000"><strong>ESC9</strong>: Relies on a specific vulnerable certificate template where ENROLLEE_SUPPLIES_SUBJECT is enabled and the attacker has GenericWrite over another user object.</span></li>
<li><span style="color: #000000"><strong>ESC10</strong>: Generalizes the technique by removing the certificate template limitation and instead exploits weak enforcement of certificate-to-user binding (i.e., StrongCertificateBindingEnforcement = 0), significantly increasing the attack surface.</span></li>
</ul>
<p><span style="color: #000000">Thus, <strong>ESC10 is a more universal and dangerous evolution</strong> of ESC9, allowing an attacker with control of just one user account and minimal privileges to impersonate <strong>any user in the domain</strong>, including Domain Admins.</span></p>
<p><span style="color: #000000">This article walks through a <strong>complete ESC10 exploitation chain</strong>, including enumeration, certificate abuse, and live shell access, all while maintaining stealth and clarity.</span></p>
<p><span style="color: #000000">To perform this ESC10 attack successfully, a few conditions must be met in the target Active Directory environment:</span></p>
<ul>
<li><span style="color: #000000">The <strong>certificate mapping enforcement</strong> must be <strong>set to weak</strong> or disabled.</span></li>
<li><span style="color: #000000">The attacker (raj) must have <strong>write access</strong> (e.g., GenericWrite, WriteProperty) to the target user account (sanjeet) to manipulate attributes like UPN and msDS-KeyCredentialLink.</span></li>
<li><span style="color: #000000">A low privileged <strong>certificate template</strong> (like raj) must be available for enrollment.</span></li>
</ul>
<p><span style="color: #000000">These conditions are surprisingly common in under-audited ADCS environments.</span></p>
<h3><span style="color: #000000"><span style="color: #800000">Prerequisite</span> </span></h3>
<ul>
<li><span style="color: #000000">Windows Server 2019 as Active Directory that supports PKINIT</span></li>
<li><span style="color: #000000">Domain must have Active Directory Certificate Services and Certificate Authority configured.</span></li>
<li><span style="color: #000000">Kali Linux packed with tools</span></li>
<li><span style="color: #000000">Tools: Evil-Winrm, certipy-ad</span></li>
</ul>
<h3><span style="color: #800000">Lab Setup</span></h3>
<p><span style="color: #000000">To simulate an ESC10 attack in a lab, begin by setting StrongCertificateBindingEnforcement = 0 on the domain controller to allow weak certificate mapping, then grant GenericWrite access on a low privileged account (sanjeet) to your attacker account (raj) to enable shadow credential injection and UPN manipulation.</span></p>
<h4><span style="color: #000000">Modify Certificate Mapping to Allow Weak Enforcement </span></h4>
<p><span style="color: #000000">To enable conditions exploitable by ESC10, or to <strong>verify that the environment is vulnerable</strong>, inspect the following registry setting on a <strong>Domain Controller</strong>: HKEY_LOCAL_MACHINESYSTEMCurrentControlSetServicesKdc</span></p>
<p><span style="color: #000000"><img fetchpriority="high" decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj5dOUaTeZAMBz4se2mLBa3cSqDTdLhxTzczsHSH_PgropTKAokOnynKFATl-XxK_Nh8brEsIIHlq7Xym3paDIV95aGHnvkW6EpJPwYzHhaw9ocBzLIHty10STkj5Zkk41-BHiHpSW6Ixml7iGxLCRgvPS-fWX9FhOKI05ZEjLbc4-xzulXllK0B_lXYSA5/s16000/1.png" alt="ADCS ESC10 Weak Certificate Mapping" width="1319" height="746"/></span></p>
<ul>
<li><span style="color: #000000"><strong>0 = Disabled</strong> — Certificate mapping is based <strong>only on UPN</strong>, and <strong>SID validation is skipped</strong>. This setting makes the domain <strong>fully exploitable</strong> by ESC10 and other certificate abuse attacks.</span></li>
<li><span style="color: #000000"><strong>1 = Compatibility mode</strong> — Tries to enforce SID binding when possible but falls back to UPN matching if SID is missing. Still <strong>partially vulnerable</strong>.</span></li>
<li><span style="color: #000000"><strong>2 = Strict</strong> — Requires <strong>SID mapping</strong>, effectively <strong>mitigating ESC10</strong>.</span></li>
</ul>
<p><span style="color: #000000">If the value is set to 0, the domain is using weak certificate mapping, meaning an we can spoof UPNs or inject shadow credentials into a target account and successfully authenticate without needing the user’s password.</span></p>
<p><span style="color: #000000">Next, we’ll set the stage by giving our attacker (raj) control over a proxy account (sanjeet) to use in the certificate impersonation chain.</span></p>
<h4><span style="color: #000000">Grant Write Access to the Proxy Account </span></h4>
<p><span style="color: #000000">To set up for ESC10, assign GenericWrite or WriteProperty permissions on the target proxy account (e.g., sanjeet) to the attacker-controlled account (raj). This can be done using<strong> Active Directory Users and Computers</strong> (enable <em>Advanced Features</em>), <strong>Active Directory ACL Editor</strong><strong>, </strong>or via<strong> PowerShell.</strong></span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg9oy1KY5sejXq8_uIckmh1v7v9rri7ic40ToD5YFuSqNkGN7IxfOkktY7AL4QiyNM6CRqj1ItTfsRxsk7ugn99L0U3FNzXLccnHyMUThl5oOBHubkEBqQhFU_WzzkguvMZzXTzC1sdrc5Y4EB1vLJWLLnRdvmxN6ehSlnUgY-JD552fllzTcxoBdqtmViV/s16000/2.png"/></span></p>
<p><span style="color: #000000"><strong>Why this matters:</strong> With these rights, raj gains the ability to:</span></p>
<ul>
<li><span style="color: #000000"><strong>Inject a forged certificate (shadow credential)</strong> into sanjeet using the msDS-KeyCredentialLink</span></li>
<li><span style="color: #000000"><strong>Modify the UPN</strong> of sanjeet to match that of a high-privilege user like Administrator@ignite.local.</span></li>
<li><span style="color: #000000"><strong>Control how certificate mapping behaves</strong>, especially when weak enforcement is enabled (StrongCertificateBindingEnforcement = 0).</span></li>
</ul>
<p><span style="color: #000000">This step essentially transforms sanjeet into a certificate-based impersonation proxy, setting the stage for <strong>passwordless authentication as any domain user</strong>, a critical move in executing the ESC10 attack chain.</span></p>
<h3><span style="color: #000000"><span style="color: #800000">Enumeration &amp; Exploitation</span> </span></h3>
<h4><span style="color: #800000">Weak UPN Mapping via Shadow Credentials</span></h4>
<p><span style="color: #000000">This allows us to inject a forged certificate into a target account’s msDS-KeyCredentialLink attribute and authenticate as that user, exploiting weak UPN-to-SID mapping when StrongCertificateBindingEnforcement = 0. Let’s proceed</span></p>
<h5><span style="color: #000000"><strong>Add and Use a Shadow Credential (Auto Mode)</strong></span></h5>
<p><span style="color: #000000">Using <strong>Certipy</strong>, execute a one-liner to inject a <strong>shadow credential</strong> into the sanjeet account and authenticate immediately:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">certipy-ad shadow auto -u raj@ignite.local -p Password@1 -account sanjeet -dc-ip 192.168.1.16</pre>
<p><span style="color: #000000">By running the certipy-ad shadow auto command, we injects a stealthy certificate-based login (KeyCredential) into the sanjeet account, immediately authenticates as that user, and then removes the injected key to avoid detection.</span></p>
<p><span style="color: #000000"><img decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjoGwnfeTkK2B6JPbuHvZ4aEvHMFg7Dt-g2MU1r3f2AQwBSP9WmIn_5xkCsOBAo2y_E-L6xxnmYn58KH6yABp4-HoJOBSEkj_wAree_b5CBo4yolNZpL6HvYy7YqiF95SUSqr1p0PSw4CcvpWLRj5_9Qkys_QRkrJ2hhqZ4lmZCeG0kkS-q0W21rgFYa5zv/s16000/3.png" alt="ADCS ESC10 Weak Certificate Mapping" width="1406" height="509"/></span></p>
<p><span style="color: #000000">This gives full, passwordless access to the user <em>sanjeet</em><em>,</em> allowing us to spoof their UPN and set up for impersonating privileged accounts—key steps in the ESC10 attack chain.</span></p>
<h5><span style="color: #000000"><strong>Spoof UPN to Match </strong><strong>Administrator</strong></span></h5>
<p><span style="color: #000000">Using the following Certipy command, we modifies the <strong>User Principal Name (UPN)</strong> of sanjeet to impersonate the domain’s Administrator account:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">certipy-ad account update -u raj@ignite.local -password Password@1 -user sanjeet -upn Administrator -dc-ip 192.168.1.16</pre>
<p><span style="color: #000000">This change exploits the earlier registry misconfiguration (StrongCertificateBindingEnforcement = 0), where the domain controller trusts <strong>UPN-based certificate mapping</strong> without validating the account’s SID.</span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjcojCi8U_7qF0HGS0HRZ2VvDUyIN3fEFRWswW5r9ytMbrnY235XoFDqLTP8-U9iS3p3DBjhyPDWaJbg11Q_D7_F00pwT0hMHkaI1HSwfPb6g613h7EMWePx2bNbv1HsG4C2uER6nIemO-ufhl67gqe3xXQQbKxLef5vl6WLvCPkVxIfWTHxhaJOZ0AWc9u/s16000/4.png"/></span></p>
<p><span style="color: #000000">As a result, Any certificate requested for sanjeet will be accepted as Administrator, letting the us authenticate as a Domain Admin while still controlling sanjeet’s identity.</span></p>
<p><span style="color: #000000">This sets the stage for authenticating as a <strong>Domain Admin</strong> in the next phase of the ESC10 attack.</span></p>
<h5><span style="color: #000000"><strong>Request a Certificate with a spoofed SPN</strong></span></h5>
<p><span style="color: #000000">Next, use Certipy to request a certificate for sanjeet, who has already spoofed his UPN to match Administrator.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">certipy-ad req -u sanjeet@ignite.local -hashes 64fbae31cc352fc26af97cbdef151e03 -ca ignite-DC1-CA -template USER -dc-ip 192.168.1.16</pre>
<p><span style="color: #000000">This step issues a certificate containing the <strong>spoofed UPN</strong> (Administrator) but signed for sanjeet. Because the Certificate Authority (CA) does <strong>not validate the UPN</strong> against the requester’s actual privileges or SID, and due to weak mapping enforcement, Active Directory will treat this certificate as legitimate for <strong>Administrator</strong>.</span></p>
<p><span style="color: #000000"><img decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEifa_2j9ZqkRRnLICUgONfMeL3S4h-sxMKVY-3VJ-HSMMb054eWobSAwP8IndLxtKdJByJiBHLOA2DTk9kN3raPGnluYkrfTMblWwHe7RdJFon_AwRKZa5_U4H-Yo8E26HmZpdqUBoRUzQrVFIKfuuw5ccy_lzoUS_fERRhOLhXEVYy5ZeVeJWEtlZnvs57/s16000/5.png" alt="ADCS ESC10 Weak Certificate Mapping" width="1778" height="263"/></span></p>
<p><span style="color: #000000">The result is a valid .pfx certificate that we can now use to <strong>authenticate as a Domain Admin</strong>, completing the critical stage of the ESC10 attack chain.</span></p>
<h5><span style="color: #000000"><strong>Reverting UPN for Stealth</strong></span></h5>
<p><span style="color: #000000">To restore the original User Principal Name (UPN) for sanjeet, the following command is used:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">certipy-ad account update -u raj@ignite.local -p Password@1 -user sanjeet -upn sanjeet@ignite.local -dc-ip 192.168.1.16</pre>
<p><span style="color: #000000">This command reverts sanjeet’s UPN to its original value. Reverting the UPN reduces the forensic footprint of previous modifications and helps avoid straight forward detection methods used to map elevated privileges or account impersonation.</span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhPv1vslK-9DmWWEuOC9gg8D7Hpy0xHe4uw02NdepF7VhJpiMJEzmPDjCKk4zX_2wVQMvbeYVPwDXvOyewy1e2Bd7ql2WJZrvCCZFH5FZTetvOcMNbPV_dYGlzKEpWqgkHgsH7AjVXqwHEPKs3o7IrEZBltYlAZVSLKQY1pBw5X6C8YEzBrM6sXfRBm_Jcy/s16000/6.png"/></span></p>
<p><span style="color: #000000">Restoring the UPN enables the user to blend seamlessly back into the environment, effectively concealing any prior UPN spoofing and lowering the risk of tracing administrative activity.</span></p>
<h5><span style="color: #000000"><strong>Authenticate as Administrator Using the Certificate</strong></span></h5>
<p><span style="color: #000000">To authenticate as the Administrator using the spoofed certificate, the system executes the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">certipy-ad auth -pfx administrator.pfx -domain ignite.local</pre>
<p><span style="color: #000000">This command uses the spoofed certificate to request a Kerberos ticket as Administrator. PKINIT supports certificate-based login, which trusts the issued certificate if the User Principal Name (UPN) matches. As a result, we are now authenticated as a Domain Admin, granting full administrative privileges.</span></p>
<p><span style="color: #000000"><img loading="lazy" decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh9eB0aFPckdyDXzBtn-VNBPMfoHrhIEHCtDfWHpySnE-7XOVoZwcHkyCLAbd4TBzeVXHcRl2v6yVzCOh4HHexe7ANnT7AM7-5u9T7kH-ztApNG46yJlgy3Z07mSlruPAxm0h3k4sT_yRfWldBlvzuY5ewBE1HS-3fEHN6hZ-7c71SUW-wN7OIXeK_dhxAg/s16000/7.png" alt="ADCS ESC10 Weak Certificate Mapping" width="1448" height="269"/></span></p>
<h3><span style="color: #800000">Post Exploitation</span></h3>
<h4><span style="color: #800000">Lateral Movement &amp; Privilege Escalation using Certipy LDAP Shell as Administrator</span></h4>
<p><span style="color: #000000">To initiate an interactive LDAP session on the Domain Controller as Administrator, use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">certipy-ad auth -pfx administrator.pfx -domain ignite.local -ldap-shell -dc-ip 192.168.1.16</pre>
<p><span style="color: #000000"> This command opens an LDAP shell to enumerate AD, perform DCSync, change groups, create users, extract credentials, and move freely in the domain.</span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjevih5UVd-219zbadoaS2PU2EUV5JfD4CCtwSF_L9ekc97SYx6Fl2c_5ZD1iUQzKKhhQLAvxJMmj8TQuUO3ZGzDREFeRmKwaX9G1nFfopDu43ACuxkncb2fFxY6oiCoks8gsLmWUitymmNk6g6KuIHvQjtB2oAxaO_oJb0WOx1XEFaDX-SxZSax_ajxX2y/s16000/8.png"/></span></p>
<h4><span style="color: #800000">Lateral Movement &amp; Privilege Escalation using Evil-Winrm</span></h4>
<p><span style="color: #000000">After already gaining access through certipy-ad ldap-shell, we can optionally use Evil-WinRM to get a full remote shell. By using an NTLM hash of a privileged account, we run:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">evil-winrm -i 192.168.1.16 -u administrator -H 64fbae31cc352fc26af97cbdef151e03</pre>
<p><span style="color: #000000">This gives a direct admin PowerShell session for greater control. Optional, but boosts stealth and command flexibility.</span></p>
<p><span style="color: #000000"><strong> <img loading="lazy" decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjl8Aiff6gzss7UrR4q5lzaQbKp8vXe-b_v9QiqfS2OQd0_IaUO4oX14Axw7B4GJIf8Z6BZrvOuHPDv87AVlL0P-0X0GG6Ezl2HVWJbVfzdgeCwy-vCxloHE8fo0N3rYOHC0kJDSn-MDSukn5cI1a653S2xNKXuzTgiCbf8xG0Ff5PxnJsdVyJV9Cdxqupe/s16000/9.png" alt="ADCS ESC10 Weak Certificate Mapping" width="1185" height="304"/></strong></span></p>
<h3><span style="color: #800000">Mitigation</span></h3>
<ul>
<li><span style="color: #000000">Enforce StrongCertificateBindingEnforcement = 2 or higher.</span></li>
<li><span style="color: #000000">Restrict msDS-KeyCredentialLink write access.</span></li>
<li><span style="color: #000000">Ensure proper template permissions and approval workflows.</span></li>
<li><span style="color: #000000">Audit UPN changes, especially to Admin-type accounts.</span></li>
<li><span style="color: #000000">Monitor PKINIT and cert issuance logs (Event IDs 4886/4887).</span></li>
</ul>
<p><span style="color: #000000"><strong>Author: </strong>MD Aslam drives security excellence and mentors teams to strengthen security across products, networks, and organizations as a dynamic Information Security leader. Contact <strong><a href="https://www.linkedin.com/in/md-aslam-7b04ab144">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
