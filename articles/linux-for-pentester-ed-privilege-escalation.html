<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux for Pentester: ed Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-for-pentester-ed-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2019-07-14T13:52:48+00:00">July 14, 2019</time><time class="updated" datetime="2025-06-07T13:11:31+00:00">June 7, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">Here in this article, we will introduce a line-oriented text editor command i.e. “ed” that generates, displays, alters, and operates on text files. All ed commands operate on whole lines or ranges of lines; e.g., the “d” command deletes lines; the “m” command moves lines, “t” command copy the lines and so on, therefore, now we will check that how we can successfully execute our task of Privilege Escalation by accomplishing all these significant of “ed” command.</span></p>
<h3 class="ai-optimize-7"><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<p class="ai-optimize-8 ai-optimize-introduction"><span style="color: #000000;"><strong>Overview to ed                                </strong></span></p>
<ul>
<li class="ai-optimize-9"><span style="color: #000000;">Summary to ed</span></li>
<li class="ai-optimize-10"><span style="color: #000000;">Primary Action attained using ed</span></li>
</ul>
<p class="ai-optimize-11"><span style="color: #000000;"><strong>Abusing ed</strong></span></p>
<ul>
<li class="ai-optimize-12"><span style="color: #000000;">SUDO Lab setups for privilege Escalation</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">Exploiting SUDO</span></li>
</ul>
<h3 class="ai-optimize-14"><span style="color: #800000;"><strong>Summary to ed</strong></span></h3>
<p class="ai-optimize-15"><span style="color: #000000;"><strong>ed</strong> command in Linux is used for initiation of the “<em>ed </em><strong>text editor,”</strong> which is a line-based text editor. Its minimal interface makes it less complex for working on text files. It helps user to perform many operations like creating, editing, displaying and manipulating the files.</span></p>
<p class="ai-optimize-16"><span style="color: #000000;">Editing occurs in two distinct modes: “command and input.” In the “command” mode, “ed” reads commands from the standard input and executes them to manipulate the contents of the editor buffer, whereas when a user gives an input command, such as ‘m’ (move), ‘d’ (delete), ‘t’ (copy), or ‘c’ (change), “ed” enters its “input mode”.</span></p>
<p class="ai-optimize-17"><span style="color: #000000;">The text editors Vi and Emacs replaced the oldest editor, which was developed in 1969 for UNIX.</span></p>
<p class="ai-optimize-18"><span style="color: #000000;">Now type its help command to know more about “ed”.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ed --help</pre>
<p class="ai-optimize-19"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KttVEDRSIG8/XSsxvN9Vc7I/AAAAAAAAfSk/GtNGoQ9HE9EaprwompOhar6eoWkqEU1XACLcBGAs/s1600/1.png"/></span></p>
<h5 class="ai-optimize-20"><span style="color: #000000;"><strong><em><u>Fundamental activities achieved by “ed”:</u></em></strong> </span></h5>
<p class="ai-optimize-20"><span style="color: #000000;">As we know “ed” does many operations so now we will go through its entire functionality one by one.</span></p>
<h5 class="ai-optimize-21"><span style="color: #000000;"><strong>Initializing file with ed</strong>: </span></h5>
<p class="ai-optimize-21"><span style="color: #000000;">At the initial phase, running the command will make the terminal space appear as shown in the image below . By default, the editor creates an empty buffer to write, similar to the way any other command-line based editor works when you invoke it without a file name.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ed</pre>
<p class="ai-optimize-22"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mMvLNIP_L6A/XSsxvNL15vI/AAAAAAAAfSs/n8lp1cNp_owq5qyzGgDvKZl6jlvb_SVGgCLcBGAs/s1600/0.png"/></span></p>
<p class="ai-optimize-23"><span style="color: #000000;">Now we will start to create a text file that contains some text within it. For doing so, very first we will press ‘a’ before entering anything to the file and once we accomplished our task of writing we will enter a period (.) to signify this to the editor.</span></p>
<p class="ai-optimize-24"><span style="color: #000000;"><strong><em>Note</em></strong>: <em>The main thing that needs to remember is to use <strong>‘a’</strong> (initial) and <strong>‘.’</strong> (Final) as the ways to enter and exit the insert mode. Now, to save the buffer in a file, use <strong>‘w’</strong> followed by a file name of own choice which helps to save the file by the desired name as well as will also display the total no. of bytes that a file contains, and then <strong>‘q’</strong> to quit the editor. </em></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ed
a
.
w info.txt
q
cat info.txt</pre>
<p class="ai-optimize-25"><span style="color: #000000;">To confirm whether you created the file or not, you can recheck it by using the “cat” command.</span></p>
<p class="ai-optimize-26"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-eZkH8uVlbtk/XSsxwJS0p2I/AAAAAAAAfSw/J_Iv_3HX54YuaSEekbOoFzETHGWQhksMgCLcBGAs/s1600/2.png"/></strong></span></p>
<h5 class="ai-optimize-27"><span style="color: #000000;"><strong>Edit the file with ed</strong>: </span></h5>
<p class="ai-optimize-27"><span style="color: #000000;">Now, in case you need to edit the same file again, you can simply pass the name of the file as an argument to the ed command and then follow the same procedure as discussed above.</span></p>
<p class="ai-optimize-28"><span style="color: #000000;">Here in the image below, I’m adding one more line to my file “info.txt” which I have created above by following the same process.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ed info.txt</pre>
<p class="ai-optimize-29"><span style="color: #000000;"><strong>Note</strong> Every time we need to use <strong>‘a’, ‘.’, ‘w’, ‘q’</strong> commands whenever we use any option of ed command.</span></p>
<p class="ai-optimize-30"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-lX8yLOknQqM/XSsxwfiGWkI/AAAAAAAAfS0/8upQ5ES2T_42ldbS7GRQnJlJd-bqR4m8ACLcBGAs/s1600/3.png"/></strong></span></p>
<h5 class="ai-optimize-31"><span style="color: #000000;"><strong>Change any specific line</strong>: </span></h5>
<p class="ai-optimize-31"><span style="color: #000000;">Till now we have learnt basic editing using ed, now let’s move ahead to discuss more editing aspects by using ed. For example, if we want to make changes in a specific line then how we can attain that operation using ed.</span></p>
<p class="ai-optimize-32"><span style="color: #000000;">In the image below, it shows how we can print any particular line using arguments ‘p’ and ‘n’</span></p>
<p class="ai-optimize-33"><span style="color: #000000;">When we type <strong>‘p’</strong> it gives us the current line at which the control is currently, while on using <strong>‘n’</strong> it gives us the line number as well.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ed info.txt
p</pre>
<p class="ai-optimize-34"><span style="color: #000000;">So after typing ‘n’ we simply need to mention that line no. for which we want alteration. By default ‘n’ displays the last line of the file so after that you can type the line no. as per your search.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">n
2
5</pre>
<p class="ai-optimize-35"><span style="color: #000000;">Once you achieved the line where you want to make a change, then you can enter<strong> ‘c’</strong> to change that line by typing the text again. For example, I have changed the 5th line which is the last line of my file, by adding some more detail to it. To recheck my modification I have read my file by using ‘cat’ command and will save the file by following the same process.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">c
cat info.txt</pre>
<p class="ai-optimize-36"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QGfq1Zxqbfk/XSsxwhDo-ZI/AAAAAAAAfS4/q3DoX7jrdj0AgHvd_kFaPwCY9yC4N7hogCLcBGAs/s1600/4.png"/></span></p>
<p class="ai-optimize-37"><span style="color: #000000;"><strong>Display error message by using ed</strong>: </span></p>
<p class="ai-optimize-37"><span style="color: #000000;">When you type something that ed can’t understand, it displays a question mark (?) by default. To know more about where you have mistaken ed provides a very helpful option i.e. <strong>‘h’</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ed info.txt
b
h</pre>
<p class="ai-optimize-38"><span style="color: #000000;">As shown in the screenshot below, I clearly understood that when I used the ‘b’ option, it gave me (?), which is the symbol of error, and while typing ‘h’, it displayed the error message as an unknown command for option ‘b’.</span></p>
<p class="ai-optimize-39"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-x8SiRz2lzBY/XSsxxH3ZpCI/AAAAAAAAfS8/qipXyw7NPpEAFFyHadU-Z8DkzN8anlGywCLcBGAs/s1600/5.png"/></span></p>
<h5 class="ai-optimize-40"><span style="color: #000000;"><strong>Copy and move operation by ed</strong>: </span></h5>
<p class="ai-optimize-40"><span style="color: #000000;">Apart from all the above discussed functions ed also gives the option for copy and paste a line at some other location, in this case, we use <strong>’t’</strong> command to copy the line and <strong>‘m’</strong> to move any line. You need to precede’t’ with the line number to which you want to copy and append the destination line number. For example, as in the below image, I have copied the 5th line to position 0 and will save changes.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ed info.txt
5t0
cat info.txt</pre>
<p class="ai-optimize-41"><span style="color: #000000;">In the above-mentioned command, 5 represents the line that needs to be copied, and 0 represents the line no. for where it needs to be copied.</span></p>
<p class="ai-optimize-42"><span style="color: #000000;"><strong><em>Note:</em></strong><em> One can also use’ instead of ‘t’ if he/she wants to move the line to another place. </em></span></p>
<p class="ai-optimize-43"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rDYCRZn1W64/XSsxxVo2TXI/AAAAAAAAfTE/BKRNJfavU4wj5xnlMjce7Uy1hjeaPl17gCLcBGAs/s1600/6.png"/></span></p>
<h5 class="ai-optimize-44"><span style="color: #000000;"><strong>Search operation using ed</strong>:</span></h5>
<p class="ai-optimize-44"><span style="color: #000000;">Searching for any line by its keyword can be easily done by ed.  For doing so first we will use <strong>“-p%”</strong> followed by ed which will prompt you further for your search mission. After that to search forward, enter/followed by the search keyword. The moment at which you press enter, the editor will display the first line (containing the keyword) it encounters. You can run that command again to continue searching.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ed -p% info.txt
%/misconfiguration
%/Linux</pre>
<p class="ai-optimize-45"><span style="color: #000000;">Here in the image below ed has printed only those lines as output that consist of search keywords, i.e., <em>misconfiguration and Linux</em>.</span></p>
<p class="ai-optimize-46"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wfMvmUBDKws/XSsxxfJAh9I/AAAAAAAAfTA/mUN9PP5I5v4VK8MiIB9riMobFPv768qGQCLcBGAs/s1600/7.png"/></span></p>
<h3 class="ai-optimize-47"><span style="color: #800000;"><u>Exploiting ed</u></span></h3>
<h3 class="ai-optimize-48"><span style="color: #800000;">Sudo Rights Lab setups for Privilege Escalation</span></h3>
<p class="ai-optimize-49"><span style="color: #000000;">Now we will start to perform privilege escalation for “ed”. For doing so we need to set up our lab of ed command with administrative rights. After that, we will check for the “ed command” that what effect it has after getting sudo rights and how we can use it more for privilege escalation.</span></p>
<p class="ai-optimize-50"><span style="color: #000000;">It can be clearly understood by the below image in which I have created a local user (test) who own all sudo rights as root.</span></p>
<p class="ai-optimize-51"><span style="color: #000000;">To add sudo right open /sudoers file and type following as user Privilege specification.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">test All=(root) NOPASSWD: /bin/ed</pre>
<p class="ai-optimize-52"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-g_d6iRdvvUw/XSsxxr1nnhI/AAAAAAAAfTI/Af7OtvJAqxUO-UYHVJvvZKrBfIKP9I4RgCLcBGAs/s1600/9.png"/></span></p>
<h3 class="ai-optimize-53"><span style="color: #800000;">Exploiting Sudo rights</span></h3>
<p class="ai-optimize-54"><span style="color: #000000;">Now we will start exploiting ed service by taking the privilege of sudoer’s permission. For this, we need sessions of the victim’s machine that will assist us to have local user access of the targeted system through which we can escalate the root user rights.</span></p>
<p class="ai-optimize-55"><span style="color: #000000;">Very first we will connect to the target machine with ssh, therefore, type following command to get access through local user login.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh test@192.168.1.31</pre>
<p class="ai-optimize-56"><span style="color: #000000;">Then we look for sudo right of “test” user (if given) and found that user “test” can execute the ed command as “root” without a password.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-57"><span style="color: #000000;">Now, after knowing the fact that the test user attains sudo rights so, taking this benefit here we can use ed command to access empty buffer to call bash/sh shell, with higher privileges if permitted on sudo.</span></p>
<p class="ai-optimize-58"><span style="color: #000000;"><strong>Conclusion</strong>: Hence, we have efficaciously exploited “ed” by attaining its functionality after granting higher privilege.  </span></p>
<p class="ai-optimize-59"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XCEUMI40hL8/XSsxvMEwYII/AAAAAAAAfSo/wdCS4XVYYtcrC9VFWVxFkhOVrQuyzMxtQCLcBGAs/s1600/10.png"/></span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To Learn more about Privilege Escalation. Follow this</span> <a href="https://www.hackingarticles.in/category/privilege-escalation/">Link.</a></p>
<p class="ai-optimize-60"><span style="color: #000000;"><strong>Author</strong>: Komal Singh is a Cyber Security Researcher and Technical Content Writer. She is a completely enthusiastic pentester and Security Analyst at Ignite Technologies. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/komal-rajput-26b783131/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
