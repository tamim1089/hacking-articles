<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">VULS-  An Agentless Vulnerability Scanner</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/vuls-an-agentless-vulnerability-scanner/" rel="bookmark"><time class="entry-date published updated" datetime="2020-10-04T13:03:43+00:00">October 4, 2020</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">VULS is an open-source agentless vulnerability scanner that is written In GO Language for Linux Systems. For server Administrator having to perform software updates and security vulnerability analysis daily can be a burden. VULS can be useful or helpful to automate Vulnerability Analysis and to Avoid the burden of manually performing of Vulnerability analysis of the software installed on the system.  It uses multiple Vulnerability databases, such as Metasploit, Exploit DB, NVD (National Vulnerability Database).</span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Vuls </strong></span>
<ul>
<li><span style="color: #000000;">Key Features</span></li>
<li><span style="color: #000000;">Architecture</span></li>
</ul>
</li>
<li><strong><span style="color: #000000;">Prerequisites</span></strong></li>
<li><strong><span style="color: #000000;">Installation &amp; Configuration of Dependencies</span></strong></li>
<li><strong><span style="color: #000000;">Installing Dependencies</span></strong></li>
<li><strong><span style="color: #000000;">Installation &amp; Configuration of GO-CVE-Dictionary</span></strong></li>
<li><strong><span style="color: #000000;">Installation &amp; Configuration of Goval-Dictionary</span></strong></li>
<li><strong><span style="color: #000000;">Installation &amp; Configuration of Gost</span></strong></li>
<li><strong><span style="color: #000000;">Install and Configure VULS</span></strong>
<ul>
<li><span style="color: #000000;">Install and configure VULS repo (GUI) Server</span></li>
<li><span style="color: #000000;">Requirements</span></li>
<li><span style="color: #000000;">Installation</span></li>
<li><span style="color: #000000;">Usage</span></li>
<li><span style="color: #000000;">DigestAuth</span></li>
<li><span style="color: #000000;">Configuration of TOML file</span></li>
</ul>
</li>
<li><strong><span style="color: #000000;">Running Local Scan</span></strong></li>
<li><strong><span style="color: #000000;">Scanning Multiple Remote Host systems</span></strong></li>
</ul>
<h3><span style="color: #800000;"><strong>Vuls Feature &amp; Architecture</strong></span></h3>
<h3><span style="color: #800000;"><strong><u>Key Features</u></strong></span></h3>
<ul>
<li><span style="color: #000000;">VULS provides a way of automating Vulnerability for Linux packages</span></li>
<li><span style="color: #000000;">VULS can be installed on all Linux based distros for example: – Linux, Ubuntu, Debian, FreeBSD, CentOS, Solaris, and so on…</span></li>
<li><span style="color: #000000;">VULS has the ability to scan multiple systems at a single time by using SSH protocol and to send reports via Slack or Email.</span></li>
<li><span style="color: #000000;">VULS uses three Scan modes Fast, Fast Root, and Deep you can select according to Situation or as per your requirements.</span></li>
<li><span style="color: #000000;">Scan results can be Viewed by using TUI (Terminal user interface) and GUI (Graphical user interface).</span></li>
<li><span style="color: #000000;">When generating reports VULS prioritizes High Severity Vulnerabilities using an established ranking system from Database.</span></li>
</ul>
<p><span style="color: #000000;"><strong><u>Architecture</u></strong></span></p>
<p><span style="color: #000000;"><strong> </strong></span></p>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-2z4NdXqLZuk/X3m-RWWmFwI/AAAAAAAApHE/v8zYqyUJOn0xix8y630uqbF72rRccMbCQCLcBGAsYHQ/s16000/0.png"/></strong></span></p>
<p><span style="color: #000000;"><strong>Fast Scan: – </strong>It performs scans without root privilege, No dependencies, almost no load on the scan target server.</span></p>
<p><span style="color: #000000;"><strong>Fast-root Scan: – </strong>It performs scans with root privilege, no dependencies, almost no load on the scan target server.</span></p>
<p><span style="color: #000000;"><strong>Deep Scan: – </strong>It performs a scan with root privilege, containing all dependencies, almost full load on the scan target server.</span></p>
<p><span style="color: #000000;"><strong>Offline Scan Mode: – </strong>Fast, Fast-root, and Deep have Offline Scan Mode. VULS can Scan with no internet access with offline scan mode.</span></p>
<p><span style="color: #000000;">Now we see how to install and Configure VULS as a Vulnerability scanner for further investigations.</span></p>
<p><span style="color: #000000;"><strong>Let’s take a look </strong><strong>🤔!!</strong></span></p>
<h3><span style="color: #800000;"><strong>Prerequisites</strong></span></h3>
<p><span style="color: #000000;">To configure VULS in your Ubuntu platform, there are some prerequisites required for installation.</span></p>
<ul>
<li><span style="color: #000000;">Ubuntu 20.04.1 with minimum 4GB RAM and 2 CPU</span></li>
<li><span style="color: #000000;">SSH Access with Root Privileges</span></li>
<li><span style="color: #000000;">Firewall Port: – 5111</span></li>
<li><span style="color: #000000;">Multiple servers running (ubuntu 20.04 or any vulnerable server) if you want to set up VULS to scan remotely.</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Installation &amp; Configuration </strong><strong>of Dependencies</strong></span></h3>
<p><span style="color: #000000;"> Let’s begin the installation process</span></p>
<p><span style="color: #000000;">Note: – The whole installation process will take a long time to finish so make your self comfortable and begin the installation process.</span></p>
<h3><span style="color: #800000;"> <strong><u>Installing Dependencies</u></strong></span></h3>
<p><span style="color: #000000;">In this section, we’re going to create a folder Vuls-data. VULS uses SQLite to store their vulnerability information so, that we’re going to install SQLite, Go programming language, and other dependencies.</span></p>
<p><span style="color: #000000;">We are going to store all VULS related data in the /usr/share/vuls-data directory. To create it run the following as described below.</span></p>
<pre class="lang:default decode:true">mkdir /usr/share/vuls-data</pre>
<p><span style="color: #000000;">Now we have created the vuls-data folder where we are going to store all data, and this will be our workspace before getting started let’s install the required dependencies.</span></p>
<p><span style="color: #000000;">Now, we’re going to install</span></p>
<ul>
<li><span style="color: #000000;"><strong>SQLite: –</strong> VULS uses SQLite to store its vulnerability information.</span></li>
<li><span style="color: #000000;"><strong>Debian-goodies: –</strong> it is the check restart utility that provides the information which package needs to be restarted in any moment.</span></li>
<li><span style="color: #000000;"><strong>GCC: –</strong> GNU compiler collection is a compiler system. GCC is a toolchain and the standard compiler for Unix-like systems.</span></li>
<li><span style="color: #000000;"><strong>Wget </strong></span></li>
<li><span style="color: #000000;"><strong>Make: –</strong> Make is used to detect automatically which part of a large program need to be recompiled and issue the commands to recompile them.</span></li>
</ul>
<p><span style="color: #000000;">Install all dependencies by using the following command.</span></p>
<pre class="lang:default decode:true">apt install sqlite git debian-goodies gcc make wget</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-f8SttTTA8UA/X3m-YsQzNAI/AAAAAAAApHI/Y-hajqJjED8iRj1MLbhYX1Vu-N9VnFaeACLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">now you have installed the required dependencies Next, install GO using snap package manager by issuing the following command</span></p>
<pre class="lang:default decode:true">snap install go --classic</pre>
<p><span style="color: #000000;">Next, you need to set up a few environment variables for Go that specifies the working directory for Go.</span></p>
<p><span style="color: #000000;">To prevent from setting these variables every time the user logs on you need to automate this process by creating an executable file go-env.sh under /etc/profile.d. This will execute the directory every time the users log on. To automate this process, follow the below commands.</span></p>
<pre class="lang:default decode:true">nano /etc/profile.d/go-env.sh</pre>
<p><span style="color: #000000;">Add the following commands to the file:</span></p>
<pre class="lang:default decode:true">export GOPATH=$HOME/go
export PATH=$PATH:$GOPATH/bin:/snap/bin</pre>
<p><span style="color: #000000;">Still, the go-env.sh file is not executable. Make it executable by running by changing the permission of that file or directly running by the following command.</span></p>
<pre class="lang:default decode:true">chmod +x /etc/profile.d/go-env.sh</pre>
<p><span style="color: #000000;">And then reload the environment variables by running the following command.</span></p>
<pre class="lang:default decode:true">source /etc/profile.d/go-env.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CObDH-UGvWE/X3m-d0Iea6I/AAAAAAAApHM/UZwxNIMqM44Vo35P53IqCS0mLjhfu70wACLcBGAsYHQ/s16000/2.png"/></span></p>
<h3><span style="color: #800000;"><strong><u>Installation &amp; Configuration of Go-CVE-dictionary</u></strong></span></h3>
<p><span style="color: #000000;">Let’s download and install go-cve-dictionary. The go-cve-dictionary is a tool that provides access to NVD (National Vulnerability Database). NVD is the US government repository of publicly reported cybersecurity vulnerabilities, that contains vulnerability IDs (CVE — Common Vulnerabilities and Exposures), summaries, and impact analysis, and is available in a machine-readable format. You can access the NVD using the Go package. Then you’ll need to run and fetch vulnerability data for VULS to use.</span></p>
<p><span style="color: #000000;">Let’s install Go-cve-dictionary under $GOPATH/src/ by cloning GO packages from GitHub which is made by Kotakanbe and compiling it afterwards.</span></p>
<p><span style="color: #000000;">Let’s start it by creating a directory where to store Go-cve-dictionary by running the following command.</span></p>
<pre class="lang:default decode:true">mkdir -p $GOPATH/src/github.com/Kotakanbe</pre>
<p><span style="color: #000000;">Navigate to it and clone g0-cve-dictionary from GitHub by issuing the following command</span></p>
<pre class="lang:default decode:true">cd $GOPATH/src/github.com/kotakanbe
git clone https://github.com/kotakanbe/go-cve-dictionary.git</pre>
<p><span style="color: #000000;">And then navigate to the cloned package further then start the installation.</span></p>
<pre class="lang:default decode:true">cd go-cve-dictionary
make install</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BD4AyhxBoes/X3m-kO33DVI/AAAAAAAApHU/cruBNcZuw6AH6E9V2-Om2JPaxqVk67kSwCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">Further then, make it available wide into your system copy It to /usr/local/bin by running below command.</span></p>
<pre class="lang:default decode:true">cp $GOPATH/bin/go-cve-dictionary /usr/local/bin</pre>
<p><span style="color: #000000;">go-cve dictionary requires a log output directory and logs are generally created under /var/logs/.</span></p>
<p><span style="color: #000000;">Let’s create a directory for go-cve-dictionary and the log directory is readable by everyone restrict to the current user by issuing following command.</span></p>
<pre class="lang:default decode:true">mkdir /var/log/vuls
chmod 700 /var/log/vuls</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Tv6_lkaUdiM/X3m-rxxNP0I/AAAAAAAApHc/vKpfSKi70CM5EnDoIXPs4wGAy0f5w7jZgCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Now fetch vulnerability data from NVD and store it to VULS workspace under /usr/share/vuls-data:</span></p>
<pre class="lang:default decode:true">for i in `seq 2014 $(date +"%Y")`; do sudo go-cve-dictionary fetchnvd -dbpath /usr/share/vuls-data/cve.sqlite3 -years $i; done</pre>
<p><span style="color: #000000;">In my case I’m cloning the cve database from the year 2014 this will download the NVD data from 2014 to the current year you can clone or download data as desired year as you want.</span></p>
<p><span style="color: #000000;"><strong>Note: – </strong>This command will take a long time to finish, till then go get served you with a Coffee <strong>☕.</strong></span></p>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-8S-6SH-BLXk/X3m-zDgHXtI/AAAAAAAApHg/A2p1dFOAu9My3IdVvztWHAXgPUWQ0Ep_gCLcBGAsYHQ/s16000/5.png"/></strong></span></p>
<h3><span style="color: #800000;"><strong><u>Installation &amp; Configuration of goval-dictionary</u></strong></span></h3>
<p><span style="color: #000000;">Let’s download and install “goval-dictionary”. The goval-dictionary is a tool that will copy the OVAL (Open Vulnerability and Assessment Language) which is an open language used to express checks for determining whether software vulnerabilities exist on a given system and provides access to the OVAL database for Ubuntu.</span></p>
<p><span style="color: #000000;">The <strong>goval-dictionary is also written by Kotakanbe</strong> so, install goval-dictionary in the same folder that previously you created under <strong>“$GOPATH/src/github.com/Kotakanbe”</strong> and then clone the Package from the GitHub by running the following command.</span></p>
<pre class="lang:default decode:true">cd $GOPATH/src/github.com/kotakanbe
git clone https://github.com/kotakanbe/goval-dictionary.git</pre>
<p><span style="color: #000000;">And then navigate to the cloned package further then compile or install it with <strong>“make”</strong> by running the following command.</span></p>
<pre class="lang:default decode:true">cd goval-dictionary
make install</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nPWp_hbOkFs/X3m_B2qlYwI/AAAAAAAApHw/VHyskCHP6DwRqcJIYzEPFvm6QsdaieGywCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Copy it to /usr/local/bin to make it globally accessible and then after that Fetch the OVAL data for Ubuntu 20.x or another version as per your requirement by running the following command.</span></p>
<pre class="lang:default decode:true">cp $GOPATH/bin/goval-dictionary /usr/local/bin
goval-dictionary fetch-ubuntu -dbpath=/usr/share/vuls-data/oval.sqlite3 20</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cJgbRRp1kIE/X3m_JKywOvI/AAAAAAAApH0/8T_ifr-9JncrcIq_RC2BFZ4vpKeOEJ-0QCLcBGAsYHQ/s16000/7.png"/></span></p>
<h3><span style="color: #800000;"><strong><u>Installation &amp; Configuration of gost</u></strong></span></h3>
<p><span style="color: #000000;">Let’s download and install “gost”. Gost is a Debian security Bug tracker that collects all information about the vulnerability status of packages distributed with Debian and provides access to the Debian security bug tracker database.</span></p>
<p><span style="color: #000000;">Let’s install this package into a new folder by running the following command:</span></p>
<pre class="lang:default decode:true">mkdir -p $GOPATH/src/github.com/knqyf263</pre>
<p><span style="color: #000000;">Navigate to the folder just you have created after that, clone the gost packages from GitHub, and then make install by running the following command:</span></p>
<pre class="lang:default decode:true">cd $GOPATH/src/github.com/knqyf263
sudo git clone https://github.com/knqyf263/gost.git</pre>
<p><span style="color: #000000;">After it finishes entering to the cloned package than <strong>“make install” </strong></span></p>
<pre class="lang:default decode:true">cd gost
make install</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-X1NJTbyKmAI/X3m_RZ-0ECI/AAAAAAAApIA/Whz7sQhwiRYtZYqx4HfigEj15qvqTvrFQCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">Don’t forget to make it accessible globally and then link its database to the /usr/share/vuls-data by running the following command:</span></p>
<pre class="lang:default decode:true">cp $GOPATH/bin/gost /usr/local/bin
ln -s $GOPATH/src/github.com/knqyf263/gost/gost.sqlite3  /usr/share/vuls-data/gost.sqlite3</pre>
<p><span style="color: #000000;">Create a log file directory for gost it requires access to the log output directory and then restricts access to the current user by using the following command:</span></p>
<pre class="lang:default decode:true">mkdir /var/log/gost
chmod 700 /var/log/gost</pre>
<p><span style="color: #000000;">And then, fetch the Debian security tracker data by issuing the following command:</span></p>
<pre class="lang:default decode:true">gost fetch debian</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hI9pe-Lpehg/X3m_XLKJZnI/AAAAAAAApIE/TCjMeOr3Xyw3UlQyOk16wOIlDyyjv_GmACLcBGAsYHQ/s16000/9.png"/></span></p>
<h3><span style="color: #800000;"><strong>Install &amp; Configure VULS</strong></span></h3>
<p><span style="color: #000000;">We have installed all required Dependencies of VULS. Now you can download and install Vuls from source code. Afterwards, you’ll configure the VULS reps server which is the GUI interface of the VULS.</span></p>
<p><span style="color: #000000;">Let’s Create a new directory that contains the path to the Vuls repository, by issuing the following command:</span></p>
<pre class="lang:default decode:true">mkdir -p $GOPATH/src/github.com/future-architect</pre>
<p><span style="color: #000000;">Navigate to the created directory then Clone Vuls from GitHub by running the following command:</span></p>
<pre class="lang:default decode:true">cd $GOPATH/src/github.com/future-architect
git clone https://github.com/future-architect/vuls.git</pre>
<p><span style="color: #000000;">Enter to the Package Folder and then compile and install by running the following command:</span></p>
<pre class="lang:default decode:true">cd vuls
make install</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gVL1gGr0Cww/X3m_d8GgtKI/AAAAAAAApIM/AG9Zlex2mfQ7mlDMYis7cYrbtY3ynrLYACLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">Also, don’t forget to make it accessible globally</span></p>
<pre class="lang:default decode:true">cp $GOPATH/bin/vuls /usr/local/bin</pre>
<p><span style="color: #000000;"><strong>Hmm </strong><strong>😃</strong><strong> !! you have successfully installed VULS in your system </strong></span></p>
<h3><span style="color: #800000;"><strong>Install &amp; Configure VULS repo server (GUI)</strong></span></h3>
<p><span style="color: #000000;"><strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://github.com/usiusi360/vulsrepo">VulsRepo</a></span></strong> is an awesome OSS Web UI for Vuls. With VulsRepo you can analyze the scan results like an Excel pivot table.</span></p>
<p><span style="color: #000000;"><strong>Requirements</strong></span></p>
<p><span style="color: #000000;">To configure VULS in your Ubuntu platform, there are some prerequisites required for installation.</span></p>
<ul>
<li><span style="color: #000000;"><span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/future-architect/vuls">future-architect/Vuls</a>&gt;</strong></span>= v0.4.0</span></li>
<li><span style="color: #000000;">Web Browser: Google Chrome or Firefox</span></li>
</ul>
<h3><span style="color: #800000;"><strong><u>Installation </u></strong></span></h3>
<p><span style="color: #000000;">In manner to install Vuls-repo server in your Ubuntu platform follow the steps as stated below</span></p>
<p><span style="color: #000000;"><strong>Step1. Installation</strong></span></p>
<p><span style="color: #000000;">Clone the vuls-repo from GitHub by running the following command:</span></p>
<pre class="lang:default decode:true">cd $HOME
git clone https://github.com/usiusi360/vulsrepo.git</pre>
<p><span style="color: #000000;"><strong>Step 2. Change the setting of vulsrepo-server</strong></span></p>
<p><span style="color: #000000;">Set Path according to your environment.</span></p>
<pre class="lang:default decode:true">cd $HOME/vulsrepo/server
cp vulsrepo-config.toml.sample vulsrepo-config.toml
nano vulsrepo-config.toml
[Server]
rootPath = "/root/vulsrepo"
resultsPath  = "/usr/share/vuls-data/results"
serverPort  = "5111"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-l7cEfdIIaeY/X3m_kjtE1NI/AAAAAAAApIU/1kHPOxH6Nt8Zj4AgrgyEjzIqQFSs8cVRgCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;"><strong>Step 3. Start vulsrepo-server</strong></span></p>
<p><span style="color: #000000;">Start the vulsrepo-server by executing the below command under the directory</span></p>
<pre class="lang:default decode:true">HOME/vulsrepo/server
cd $HOME/vulsrepo/server
./vulsrepo-server</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gN8d_ZEV2Q8/X3m_qptOkoI/AAAAAAAApIc/b_HvxDOfFosseWPwCXOwg8LzdkkSm--qQCLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">You can also verify whether it is running or not by opening the below URL, you need to make sure port 5111 is open on your server firewall and then you can access vulsrepo-server on the web interface at</span></p>
<pre class="lang:default decode:true">http://localhost:5111</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-h4pzxZsnHCs/X3m_wCMtEqI/AAAAAAAApIg/oOZu0gaTrhs5L0tJ7nTOsy87xJ-gVTk2wCLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">Nice 😀  !! As you can see it is successfully installed </span></p>
<p><span style="color: #000000;"><strong>Step 4. Always activate vulsrepo-server</strong></span></p>
<p><span style="color: #000000;">In Case: SystemV (/etc/init.d)</span></p>
<p><span style="color: #000000;">Copy the startup file. Change the variable according to the environment.</span></p>
<pre class="lang:default decode:true">cp $HOME/vulsrepo/server/scripts/vulsrepo.init /etc/init.d/vulsrepo
chmod 755 /etc/init.d/vulsrepo
nano /etc/init.d/vulsrepo</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CnUIqH-SqF8/X3m_4W1IIQI/AAAAAAAApIk/LM2jWiQnJCsd3t5KszBha15XdkLKiQl2gCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">And then make changes conf file as per your environment</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uH6huUIYS1E/X3m_-ELMZ6I/AAAAAAAApIo/u2BshS__JZMn3bxoveRI7WdcXGBfL9-YQCLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">In Case of systemd (systemctl)</span></p>
<p><span style="color: #000000;">Copy the startup file. Change the variables according to the environment.</span></p>
<pre class="lang:default decode:true">sudo cp $HOME/vulsrepo/server/scripts/vulsrepo.service /lib/systemd/system/vulsrepo.service
nano /lib/systemd/system/vulsrepo.service</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-APBlTCuvJwU/X3nAC0Di_0I/AAAAAAAApIw/fCvIAbY3eOU8lpdx6IT6t9k63ibUqXQ5QCLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">And then make a change in the conf file as per your environment as shown below</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JO47G18Gynk/X3nAyTPXWPI/AAAAAAAApJM/Km4VuzilGDQE1PrgJQtJ8-8YsOXjP4BawCLcBGAsYHQ/s16000/17.png"/></span></p>
<pre class="lang:default decode:true">start vulsrepo-server
systemctl start vulsrepo</pre>
<p><span style="color: #000000;"><strong><u>Usage</u></strong></span></p>
<p><span style="color: #000000;">Access the browser</span></p>
<pre class="lang:default decode:true">http://&lt;server-address&gt;:5111</pre>
<p><span style="color: #000000;"><strong><u>DigestAuth</u></strong></span></p>
<p><span style="color: #000000;">create an authentication file to perform digest authentication,</span></p>
<pre class="lang:default decode:true">./vulsrepo-server -h
./vulsrepo-server -m</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-h4ECJDlZkT8/X3nA5fqzZ1I/AAAAAAAApJU/x3qqtuJKBFs52EdQZAysO8-Bar4CO0ZmwCLcBGAsYHQ/s16000/18.png"/></span></p>
<p><span style="color: #000000;"><strong><u>Edit vulsrepo-config.toml</u></strong></span></p>
<pre class="lang:default decode:true">nano vulsrepo-config.toml</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6rx8PRaWX4Q/X3nA9RHGEjI/AAAAAAAApJY/YRfZ80tOK3EWIbW9TM2EZkC221klOfj7ACLcBGAsYHQ/s16000/19.png"/></span></p>
<h3><span style="color: #800000;"><strong><u>Use SSL</u></strong></span></h3>
<p><span style="color: #000000;"><strong>Create a self-signed certificate </strong>by issuing the following command</span></p>
<pre class="lang:default decode:true">openssl genrsa -out key.pem 2048
openssl req -new -x509 -sha256 -key key.pem -out cert.pem -days 3650</pre>
<p><span style="color: #000000;"><strong>Edit vulsrepo-config.toml </strong>file as shown below by running the following command</span></p>
<pre class="lang:default decode:true">nano vulsrepo-config.toml</pre>
<h3><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8qzNT1spzmY/X3nBF1kF-UI/AAAAAAAApJg/RTJK9ITd2BU-llUBs4jAZQHa3TVm96ZFACLcBGAsYHQ/s16000/20.png"/></span></h3>
<h3><span style="color: #800000;">Start vulsrepo-server</span></h3>
<p><span style="color: #000000;">Restart Vulsrepo-server by running the following command:</span></p>
<pre class="lang:default decode:true">systemctl restart vulsrepo-server</pre>
<p><span style="color: #000000;">And then visit the web interface, enter the login credentials that you created during the installation process to access the GUI interface. Once you logged in then you will have your VULS GUI Dashboard ready to set fire on the Vulnerability 😊.</span></p>
<p><span style="color: #000000;"><strong><u>Configuration of TOML file</u></strong></span></p>
<p><span style="color: #000000;">Now, it’s time to create a configuration file for Vuls. Navigate back to /usr/share/vuls-data:</span></p>
<pre class="lang:default decode:true">cd /usr/share/vuls-data</pre>
<p><span style="color: #000000;">Vuls stores its configuration in a TOML file, which is config.toml. Create by issuing the following command:</span></p>
<pre class="lang:default decode:true">nano config.toml</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3P82pVAfHoY/X3nBK1TI66I/AAAAAAAApJk/V7MU1ZpUo9IIafpaHRa2SYa3wNv_FIj6ACLcBGAsYHQ/s16000/21.png"/></span></p>
<p><span style="color: #000000;">And then Enter the following configuration:</span></p>
<pre class="lang:default decode:true">[cveDict]
type = "sqlite3"
SQLite3Path = "/usr/share/vuls-data/cve.sqlite3"
[ovalDict]
type = "sqlite3"
SQLite3Path = "/usr/share/vuls-data/oval.sqlite3"
[gost]
type = "sqlite3"
SQLite3Path = "/usr/share/vuls-data/gost.sqlite3"
[servers]
[servers.localhost]
host = "localhost"
port = "local"
scanMode = [ "fast" ]
#scanMode = ["fast", "fast-root", "deep", "offline"]</pre>
<p><span style="color: #000000;">Then save and close the file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5UpkyRHUDeU/X3nBPVcrPUI/AAAAAAAApJs/jbtfteHb-GAOpo0ImyYyDCYNISSKz0GJwCLcBGAsYHQ/s16000/22.png"/></span></p>
<p><span style="color: #000000;"><strong>Ok </strong><strong>😃</strong><strong> !! you have successfully created a conf.toml file</strong></span></p>
<p><span style="color: #000000;">To test the validity of the configuration file, run the following command:</span></p>
<pre class="lang:default decode:true">vuls configtest</pre>
<p><span style="color: #000000;">Congratulations!! You’ve installed and configured Vuls to scan the local server on your Ubuntu Platform 😉.</span></p>
<h3><span style="color: #800000;"><strong>Running local Scan</strong></span></h3>
<p><span style="color: #000000;"><strong>Exited? let’s do it </strong><strong>😁</strong><strong> !! </strong></span></p>
<p><span style="color: #000000;">The default scan mode, if not explicitly specified, is fast.</span></p>
<p><span style="color: #000000;">To run a scan, execute the following command:</span></p>
<pre class="lang:default decode:true">vuls scan</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KBFZaLOhE9A/X3nBUz3q8PI/AAAAAAAApJw/rfg4aG6DWv4kVwNzvvOhT7_-BQx-IrFzwCLcBGAsYHQ/s16000/23.png"/></span></p>
<p><span style="color: #000000;">Wow  !! As we can see it scanned the whole system and generated a report</span></p>
<p><span style="color: #000000;">Wait this is not enough… Let’s what’s inside the report </span></p>
<p><span style="color: #000000;">To check the report on TUI (Terminal based user interface) issue the following command </span></p>
<p><span style="color: #000000;"><strong>vuls tui</strong></span></p>
<p><span style="color: #000000;">Vuls divides the generated report view into four panels as stated below:</span></p>
<ul>
<li><span style="color: #000000;">Scanned hosts: located on the upper left, lists hosts that Vuls scanned.</span></li>
<li><span style="color: #000000;">Found vulnerabilities: located right of the host’s list, shows the vulnerabilities that VULS found in installed packages.</span></li>
<li><span style="color: #000000;">Vulnerabilities information: it is up of the left part of the screen, that shows detailed information about the vulnerability, pulled from the databases.</span></li>
<li><span style="color: #000000;">Vulnerable packages: the located right of the detailed information, shows the affected packages and their versions.</span></li>
</ul>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-uyvfoFlpBi0/X3nBqSfxlwI/AAAAAAAApKA/2AOdlUwphz4325UbTdo4ILXeCMD4iVr4gCLcBGAsYHQ/s16000/24.png"/></strong></span></p>
<p><span style="color: #000000;"><strong>Aha </strong><strong>😵</strong><strong> !! It’s hilarious </strong></span></p>
<p><span style="color: #000000;">Let’s check the How the GUI shows these results</span></p>
<p><span style="color: #000000;">Get back to the GUI Dashboard and then mark and submit the generated report that you want to view as shown below</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-F_8w4pFp9a4/X3nBvai9YhI/AAAAAAAApKE/zJZQlFxUzcIS9mck0gI1v9Tgnu2A_skwACLcBGAsYHQ/s16000/25.png"/></span></p>
<p><span style="color: #000000;">And then see the magic 🙃 !!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NQgQiAMSAbk/X3nB01NvSQI/AAAAAAAApKI/PWrI7xDdoacSGB-MlvIKeCqCmdxEI7GpgCLcBGAsYHQ/s16000/26.png"/></span></p>
<p><span style="color: #000000;">As we can see it converted to JSON report inti GUI with detailed information. By tapping on CVE ids you can more information about their vulnerability.</span></p>
<p><span style="color: #000000;">Also, you can filter this report as per your known by dragging the required report from the Heatmap section to Count as shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--hEEPnl1DKU/X3nB6-_X6dI/AAAAAAAApKM/3G7ffPD_VVgPon2Lx8K6u8Cp-T1D-oeiQCLcBGAsYHQ/s16000/27.png"/></span></p>
<p><span style="color: #000000;">Let’s make it more informative by applying filters as shown below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0vdLsP8vHag/X3nCG7fogvI/AAAAAAAApKc/VJzZZp3eMeUW40Ar4thfo2V46oT2-XODwCLcBGAsYHQ/s16000/28.png"/></span></p>
<p><span style="color: #000000;"><strong>Scanning Multiple remote host systems</strong></span></p>
<p><span style="color: #000000;"><strong>Step 1: </strong>Enable to SSH from localhost</span></p>
<p><span style="color: #000000;">Vuls doesn’t support SSH password authentication. So we have to use SSH key-based authentication. Create a key pair on the localhost then copy the id_rsa.pub key to authorized_keys on the remote host.</span></p>
<p><span style="color: #000000;"><strong>On Localhost:</strong></span></p>
<pre class="lang:default decode:true">ssh-keygen -t rsa</pre>
<p><span style="color: #000000;">Copy /.ssh/id_rsa.pub key to the clipboard.</span></p>
<p><span style="color: #000000;">And go to the <strong>Remote Host</strong> and issue the following command:</span></p>
<pre class="lang:default decode:true">mkdir ~/.ssh
chmod 700 ~/.ssh
nano ~/.ssh/authorized_keys</pre>
<p><span style="color: #000000;">and then Paste the rsa.pub key from the clipboard to ~/.ssh/authorized_keys and then follow the below steps:</span></p>
<pre class="lang:default decode:true">chmod 600 ~/.ssh/authorized_keys</pre>
<p><span style="color: #000000;"><strong>Come back to the Localhost:</strong></span></p>
<p><span style="color: #000000;">And also, we need to confirm that the host keys of the remote scan target has been registered in the known_hosts of the localhost. Further, then we need to add the remote host’s Host Key to $HOME/.ssh/known_hosts, log in to the remote host through SSH before scanning.</span></p>
<pre class="lang:default decode:true">ssh root@192.168.29.219 -i ~/.ssh/id_rsa</pre>
<p><span style="color: #000000;">where 192.168.29.219 is the IP of remote Host</span></p>
<p><span style="color: #000000;"><strong>Step 2: </strong><strong>Configure (config.toml) as shown below</strong></span></p>
<pre class="lang:default decode:true">cd /usr/share/vuls-data
nano config.toml
[servers.ignite]
 host        = "192.168.29.219"
 port        = "22"
 user        = "root"
 keyPath     = "/root/.ssh/id_rsa"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UaPfONHLG1w/X3nCOEWlJzI/AAAAAAAApKk/sP5FkC-7ApgfMLPtwXceP5OqY884VsMQwCLcBGAsYHQ/s16000/29.png"/></span></p>
<p><span style="color: #000000;">Check and verify config.toml and settings on the server before scanning:</span></p>
<pre class="lang:default decode:true">vuls configtest</pre>
<p><span style="color: #000000;">Start scanning remote host by issuing the below command:</span></p>
<pre class="lang:default decode:true">vuls scan</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bUP1NPiFOnA/X3nCTZcNbeI/AAAAAAAApKs/BjnsDO7NjSEErjv81-9Cczo50YHL-Va9wCLcBGAsYHQ/s16000/30.png"/></span></p>
<p><span style="color: #000000;">Congratulation 🙂!! As you can see you have been successfully scanned your remote host. Let’s check the generated report on the GUI dashboard.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6Acwz8gC2LM/X3nCXfXDhiI/AAAAAAAApK0/2yj8gryPPLwjX8LIZP5SbdgoCx8BmlvWgCLcBGAsYHQ/s16000/31.png"/></span></p>
<p><span style="color: #000000;">By applying more filters, you can make you can hunt or investigate Vulnerable packages deeper.</span></p>
<p><span style="color: #000000;">Let’s end Here !! 😊</span></p>
<p><span style="color: #000000;"><strong>Author – </strong>Vijay is a Certified Ethical Hacker, Technical writer and Penetration Tester at Hacking Articles. Technology and Gadget freak. Contact <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/vijay-igcbr/">Here</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
