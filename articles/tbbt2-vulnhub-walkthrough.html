<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">TBBT2: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/tbbt2-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-05-21T10:17:44+00:00">May 21, 2020</time><time class="updated" datetime="2025-06-10T20:10:35+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">TBBT2 is made by emaragkos. This boot2root machine is part of the TBBT Fun with Flags series and it is themed after the famous TV show, The Big Bang Theory and has really strong CTF elements. It’s more like solving a set of interesting CTF challenges as a puzzle than facing these in a real-life scenario.</span></p>
<p><span style="color: #000000;"><strong>Goal:</strong> Hack Sheldon and get user and root flag</span></p>
<p><span style="color: #000000;">Since these labs are available on the Vulnhub Website. We will be downloading the VM Machine from this <strong><a style="color: #000000;" href="https://www.vulnhub.com/entry/tbbt-2-funwithflags,461/">link</a></strong>.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Methodologies</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Examine HTTP web pages</span></li>
<li><span style="color: #000000;">Web Directory Enumeration (Dirb)</span></li>
<li><span style="color: #000000;">De Obfuscate Js Code</span></li>
<li><span style="color: #000000;">Decoding ROT13</span></li>
<li><span style="color: #000000;">Dictionary Generating (CRUNCH)</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploiting</strong></span>
<ul>
<li><span style="color: #000000;">Brute forcing (HYDRA)</span></li>
<li><span style="color: #000000;">Steganography (Stegsnow)</span></li>
<li><span style="color: #000000;">Port Knocking</span></li>
<li><span style="color: #000000;">Spawning TTY Shell</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Abusing Path Variable</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #000000;"><strong> </strong></span><span style="color: #000000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">Let’s start by scanning the network for targets using Netdiscover.</span></p>
<pre class="lang:default decode:true ">netdiscover</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ORqF4WXIoBA/XsZRSGmjyyI/AAAAAAAAkK8/ICgL08K0nVUev701Vzc5ernThe9KOOe8QCLcBGAsYHQ/s1600/0.png"/></p>
<p><span style="color: #000000;">We found the target IP Address 192.168.1.105. Let’s begin with basic port scanning with NMAP.</span></p>
<pre class="lang:default decode:true ">nmap -sV 192.168.1.105</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-NsLb4e1YgDg/XsZRSSEwY5I/AAAAAAAAkLA/_yG5TzFhswwaKLygHCx9hwyNMGB0nyqoACLcBGAsYHQ/s1600/1.png"/></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">For more details, we will navigate to a web browser for exploring HTTP service since port 80 is open. It clearly is not enough for a clue to proceed.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-gfZRj04Jz4A/XsZRWaxou1I/AAAAAAAAkLo/qrqfVjLum2oEWCIQAEl1VjPnrVS0ZIJqwCLcBGAsYHQ/s1600/2.png"/></p>
<p><span style="color: #000000;">Since looking for a clue, we checked the source code and found a directory. Let’s see what next on browsing it.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-pjIR9RXFuHI/XsZRXud2jwI/AAAAAAAAkL4/ViwwJqsBa4YUnGWXYZORXrQpYc8dz9EmgCLcBGAsYHQ/s1600/3.png"/></p>
<p><span style="color: #000000;">Again, a secret from Sheldon on this page. We knew Sheldon wants us to check the source code of this page.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-hHxEeNWfor8/XsZRX_cu1_I/AAAAAAAAkL8/8nawjde6skARJXMfHwmQYsRpIcBixnIqQCLcBGAsYHQ/s1600/4.png"/></p>
<p><span style="color: #000000;">So, on checking the source code we found this html code that is using an interesting JS File. Let’s find out what’s inside it.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-BsrWJlrlDHY/XsZRYevJBUI/AAAAAAAAkMA/jmi05pUPib4l3AGNQMdJlVnYSdIEoaehwCLcBGAsYHQ/s1600/5.png"/></p>
<p><span style="color: #000000;">It’s very clear that we need to DEobfuscate this code. To do that we need to bring up the console in the browser.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-crivgAZcjcs/XsZRY0hXW3I/AAAAAAAAkME/larKb995dygG_K_tS4u2FHBefoX17W5RACLcBGAsYHQ/s1600/6.png"/></p>
<p><span style="color: #000000;">We copied the code and pasted in the console of the browser, also change the last line document.write(em) with console.log(alert)em);</span></p>
<p><span style="color: #000000;">This gave us an alert in the browser. And there we see the ROT13 string. Time to Decode!</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-TjAiy8Qo1Nc/XsZRZHPXtNI/AAAAAAAAkMI/NYJ962mno0EnutJKcjdf_ZqYsirREBG_ACLcBGAsYHQ/s1600/7.png"/></p>
<p><span style="color: #000000;">Using an online ROT13 decoder, on decoding the code we found a secret directory.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-VhxIOxCUJYc/XsZRZe1Mu0I/AAAAAAAAkMM/VslKz1d4uiI3hRXM3evO2yo7EEuKJb-hwCLcBGAsYHQ/s1600/8.png"/></p>
<p><span style="color: #000000;">On browsing the directory, we saw the directory is protected with HTTP Basic Authentication. Since we have no idea about the credentials. We thought of proceeding with further enumeration.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-HB4Wimf2dhA/XsZRZ4yv2MI/AAAAAAAAkMQ/DbxTBtUlSgg48pMNi7o62XXdQ9SBlTcbQCLcBGAsYHQ/s1600/9.png"/></p>
<p><span style="color: #000000;">On enumerating using DIRB, we found the password text file. Hope it will hold some password that might help us login.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.105/ -X .txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-7Zk1jDMqBmc/XsZRSVOTTtI/AAAAAAAAkLE/TUqr9PrrUkUdCPQFBq_y0PjXwLj0N3hcgCLcBGAsYHQ/s1600/10.png"/></p>
<p><span style="color: #000000;">Another hidden password along with some hint. Since it has 3 “*” which denotes <strong>3 lower case letters</strong>. It’s time to generate password dictionary using crunch tool.</span></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">Using crunch, we made a dictionary and tried to Brute forced the Login credentials using HYDRA. So, after few minutes HYDRA gave us the password as “oldtrain”.</span></p>
<pre class="lang:default decode:true">crunch 8 8 -t @@@train &gt; password.txt
hydra -l sheldon -P password.txt http-get://192.168.1.105/the_real_secret_dir -e nsr</pre>
<p><span style="color: #000000;">And successfully we found password “oldtrain” for user “sheldon”</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-6yJ91ILoYX8/XsZRThwxDJI/AAAAAAAAkLM/cz7geo6EA-oG_HFCPipW65t4UCBr7KrBACLcBGAsYHQ/s1600/12.png"/></p>
<p><span style="color: #000000;">After successfully logging in, we got a <strong>/p4ssw0rd.txt</strong> file hint, and notice the thing that caught our eyes was these symbols on the webpage.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-6V9UIKQAA18/XsZRTmrFKZI/AAAAAAAAkLQ/QHJNPSuxliEOSYymf8YYJUcDNISnf6jsACLcBGAsYHQ/s1600/13.png"/></p>
<p><span style="color: #000000;">On reading the p4aaw0rd file. We saw some strange spaces in between the text.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-SvaNnLGBDxA/XsZRTyiSBvI/AAAAAAAAkLU/YucJbDVuhKckDAy5pu0aNRMa4Zf_8Ph5wCLcBGAsYHQ/s1600/14.png"/></p>
<p><span style="color: #000000;">So, after a lot of thinking, we thought of performing “white space steganography”. So, we save the whole content a text file and used the tool called “stegsnow” and obtain the password “ilikeklingon”. May this could a hint that s Sheldon likes Klingon which is also a type encryption which might be used as shown in above web page.</span></p>
<pre class="lang:default decode:true">stegsnow -C stegno.txt &gt; result.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-JauYMNFR9KU/XsZRU5BQrjI/AAAAAAAAkLY/QISYjthz4K8B4N5DRg_6jDFYMkgl9dmbQCLcBGAsYHQ/s1600/15.png"/></p>
<p><span style="color: #000000;">Ongoing through the source of the page we saw another hint. The Knock term want us to perform port knocking that is for sure. Let us see what’s in the secret image.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-gOZ98WRgjno/XsZRVXmZ_pI/AAAAAAAAkLc/Yna8zaF7dFETaMc1N1IY7_CRZIKm7BCFwCLcBGAsYHQ/s1600/16.png"/></p>
<p><span style="color: #000000;">So, on browsing the Secret image file, we saw some symbols shown in the image. They are hiding some secret behind them using Klingon encryption.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-su6AF_N8sdA/XsZRVlWWm_I/AAAAAAAAkLg/szvTO9B94yoDrk36yS97u0d2-RtGouj5QCLcBGAsYHQ/s1600/17.png"/></p>
<p><span style="color: #000000;">Since Sheldon is fond of Klingon. We found a Klingon Language decoder. And got the result as 1000,2000 and 3000 ports.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-QuAYLhnBSTE/XsZRVxgbNkI/AAAAAAAAkLk/znJacyJFQpcUqEtgAkc27dMt-vw7Jyk-gCLcBGAsYHQ/s1600/18.png"/></p>
<p><span style="color: #000000;">As you can observe that we got the hint for port knocking, so on knocking the ports. It shows the SSH port 22 get opened 😊.</span></p>
<pre class="lang:default decode:true">knock -u 192.168.1.105 1000 2000 3000
nmap 192.168.1.105</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-c55gocERjWU/XsZRWuEU-1I/AAAAAAAAkLs/FH__XGDemLwxI9obvbO4tUE2ZyhjGJTpQCLcBGAsYHQ/s1600/20.png"/></p>
<p><span style="color: #000000;">Since we have everything now, it’s time to login SSH using the Password- ilikeklingon. And further digging in we found our first flag.</span></p>
<pre class="lang:default decode:true">ssh sheldon@192.168.1.105
id
ls
cat flag.txt</pre>
<p><span style="color: #000000;">Further we used python one liner to spawn the TTY shell. There we found a program having SUID permission for a program “iliketrains” which is a C compiled program. We found a C program where we got to know that SL is running everytime we execute the program “iliketrains”.</span></p>
<pre class="lang:default decode:true">cd Desktop
python -c 'import pty;pty.spawn("/bin/bash")'
cd Desktop
ls -al
cat .iliketrains.c</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-oSFQDvjb9nk/XsZRXLxgQ1I/AAAAAAAAkLw/A4rkbC5Be0wVD-QMpJzUf-qAtHUW3LJHACLcBGAsYHQ/s1600/21.png"/></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation </strong></span></h3>
<p><span style="color: #000000;">So now we are overwriting the “SL” with /bin/bash and giving full permission and changing environment variable which known as abusing path variable that you can read from <strong><a style="color: #000000;" href="https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/">here</a></strong>.  Also exporting the current directory into Path Variable. On executing the program “iliketrains”. We made it to the root. Read the final flag.</span></p>
<pre class="lang:default decode:true ">echo "/bin/bash" &gt; sl
chmod 777 sl
export PATH=/home/sheldon/Desktop:$PATH
./iliketrains
cd /root
cat flag.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-WehJ3UKqksg/XsZRXv1VU5I/AAAAAAAAkL0/TeG4dVASw3YXwQhrpZqtKx_uqv3RuaxXwCLcBGAsYHQ/s1600/22.png"/></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sushma Ahuja is a Technical Writer, Researcher, and Penetration Tester. Can be Contacted on</span> <a href="https://www.linkedin.com/in/sushma-ahuja-284907157/"><strong>LinkedIn</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
