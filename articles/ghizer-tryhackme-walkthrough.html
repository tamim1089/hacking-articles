<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/" rel="category tag">TryHackME</a></span>            </div>
            <h1 class="post-title entry-title">Ghizer TryHackMe Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/ghizer-tryhackme-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-11-21T06:09:52+00:00">November 21, 2020</time><time class="updated" datetime="2025-06-25T13:34:39+00:00">June 25, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we’re going to solve another boot2root challenge called “<span style="color: #0000ff;"><strong>Ghizer</strong></span>“. It’s available at TryHackMe for penetration testing practice. This lab is not difficult if we have the right basic knowledge to break the labs and are attentive to all the details we find during the reconnaissance. The credit for making this lab goes to <span style="color: #0000ff;"><strong>stuxnet</strong></span>. Let’s get started and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;">Level: <strong>Easy</strong></span></p>
<p><span style="color: #000000;">Since these labs are available on the <span style="color: #0000ff;"><strong>TryHackMe</strong> </span>website.</span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Dirsearch</span></li>
<li><span style="color: #000000;">Searchsploit</span></li>
<li><span style="color: #000000;">Linpeas</span></li>
<li><span style="color: #000000;">Jdb</span></li>
<li><span style="color: #000000;">Chisel</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Exploit LimeSurvey &lt; 3.16 Remote Code Execution (RCE)</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Abuse of debug mode Ghidra</span></li>
<li><span style="color: #000000;">Abuse of permissions of python scripts with SUDO</span></li>
</ul>
<ul>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<h3><span style="color: #800000;">Walkthrough</span></h3>
<h3><span style="color: #800000;">Reconnaissance</span></h3>
<p><span style="color: #000000;">We put the IP address in “<strong>etc/hosts</strong>” file and execute <strong>nmap</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p- -A ghizer.thm</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CctbrdmFnhI/X7iqg8eBYWI/AAAAAAAAq2k/AZMXmVzyB9QcmlYA45ksY72vf9mw34LkgCLcBGAsYHQ/s16000/1.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">Firstly, we enumerate with <strong>nmap</strong> the access <strong>FTP</strong> services with an anonymous account, But we don’t have to write and read permissions</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-eNkJr_hXTUM/X7iqoLv7OaI/AAAAAAAAq2o/naP56B189lo2hkL7dVAHmBsqzcfBIOPqwCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Then, we access the website and look at the website, review code and sections, but find nothing that can be useful to us.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-O3OhVr7oMf4/X7iqyY0Y9dI/AAAAAAAAq2w/bJkZoWHQWroyZPCghCYERFprkffxWy4YACLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">We found a working <strong>WordPress</strong> on port 443. We a hint for administration panel found, it is protected for <strong>WPS Hide Login</strong> plugin.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2LEraOwg12E/X7iq4lTiI4I/AAAAAAAAq24/NxDOfmnaXgYKI6MKpBN5blroSr_WXPcXQCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Is easy, we search link in the bottom of the page web and we will have the route panel administration.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YZ0LtqpS0PU/X7iq9ZckJ3I/AAAAAAAAq28/rEe-b1Fqh18S1WlJ83assS55iz-dWo9ywCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">We use <strong>Dirsearch</strong> tool and we enumerate files with version software, directories and other files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_BFV6qyo8_8/X7irEQmHjLI/AAAAAAAAq3A/QJe9A_-ThkMAIqX9xNsPdRx5UiqEClBFwCLcBGAsYHQ/s16000/6.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">We use <strong>searchsploit</strong> in searched of exploits for <strong>LimeSurvey</strong>, we found an exploit for <strong>Remote Code Execution</strong> (RCE).</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pL5OnNQgZv4/X7irIwWhUeI/AAAAAAAAq3E/9Y7FoKjT5SIYYpbQL3uOz-cVNy4srH3YQCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">This exploit <strong>required credentials</strong> for you use, we search in <strong>Google</strong> for “<em>Credentials default LimeSurve</em>” and we enumerated default credentials.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LQWv-bFCxLA/X7irMyAN1MI/AAAAAAAAq3M/w8v44_41cIgWWbAGKvN7Dz9mq-kFgDx4gCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">We use the exploit with the credentials found and we have a shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fpLGbfyg_cU/X7irXjnEw8I/AAAAAAAAq3Y/3JvlVTUmbV4LcQk9DUpA4Xmd-b7JzJ-gACLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">However, we have a very limited shell. Therefore, I used the web shell of <strong>PentestMonkey’s,</strong> downloading it to the folder and executed it with netcat in listening.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0jaiJhy8ScU/X7irhuTLP3I/AAAAAAAAq3g/t8ASrMj2aisqWol12qmNrQ8uMOsaDqgeACLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">As a result, we have a new shell! Next, we execute two favourite commands for an interactive shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vqnk4mfEZes/X7irl5D9sgI/AAAAAAAAq3o/I9_FVKXUyAokkBYAaiwjm8Yugepdh9e6wCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">Eventually, we found the <strong>config.php</strong> file. In it, we found the username and password of <strong>limeDB.</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-J1jOSOhVNbk/X7irpt2rmyI/AAAAAAAAq3w/NPD6uCtIP1gnOivoUAbvt9GpagzEPb_VwCLcBGAsYHQ/s16000/12.png"/></p>
<h3><span style="color: #800000;">Privilege Escalation (user Veronica)</span></h3>
<p><span style="color: #000000;">Firstly, we use “<strong>linpeas.sh</strong>” script and we enumerated connections in use of <strong>ghidraDebug</strong> with <strong>Veronica</strong> user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-11q8WG15zDo/X7irvP-1DRI/AAAAAAAAq30/ETruuKRub1kPHc-TLgbk14heRi0lMvw1gCLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">We enumerate <strong>GhidraDebug</strong> service internal on port <strong>18001</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kjnBRfJ-I30/X7ir4R_RviI/AAAAAAAAq4A/HSOZQFjbyegl_ImA-Fw9LRI12_PXzRk6wCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Afterwards, we need remote command to execute in <strong>GhidraDebug</strong>, I used this guide my friends “<span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackplayers.com/2019/03/probando-el-rce-de-ghidra-en-modo-debug.html">HackPlayers</a></strong></span>“.</span></p>
<p><span style="color: #000000;">After that, we use “<strong>Chisel</strong>” for port forwarding on local port 18001.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-caQvXUntHAo/X7ir-tmWh-I/AAAAAAAAq4M/I-w2Je3GjNA5L1ERcsc1ptJ-eNfBizNGwCLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">Subsequently, we <strong>jdb</strong> tool for connecting with we localhost, we executed “<strong>classpath</strong>” command and we view the base directory of <strong>“Veronica”</strong> user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5_Pr5u3zrhI/X7isEZXe47I/AAAAAAAAq4Q/havZqK9n9MEvccLDvQ9T4jFDMA0z2HTXQCLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">We listed “<strong>WatchManager$WatchRunnable</strong>“, so we’re on the right track.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-r44wVj_NpLE/X7isIKV0gaI/AAAAAAAAq4U/95OO_efmQ14V64-J9jMTX6TzpLaSHPCOwCLcBGAsYHQ/s16000/17.png"/></span></p>
<p><span style="color: #000000;">Afterwards, we stop the service and wait a few seconds until we get the second answer.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5zXSvy17fg0/X7isMbKa-8I/AAAAAAAAq4Y/vUIt4viGOespKtam2uN8v0kl4gmhoYMvACLcBGAsYHQ/s16000/18.png"/></span></p>
<p><span style="color: #000000;">Then, we set a netcat to listen and execute the following command, this will return a shell as the user <strong>“Veronica”.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5vmLXwgSeII/X7isRq1BDbI/AAAAAAAAq4g/UyUOq91aGsQsuD4h3UG62P08MflfADvtgCLcBGAsYHQ/s16000/19.png"/></span></p>
<p><span style="color: #000000;">And with the access to this user, we can read the flag of <strong>user.txt</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HyxP7-FtbGw/X7isb0fdHzI/AAAAAAAAq4s/VJh5CLfcdP4EKmwkSBt3nqvj4JBoL0P6gCLcBGAsYHQ/s16000/20.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation (root)</strong></span></h3>
<p><span style="color: #000000;">We execute the command “<strong>sudo -l</strong>“, we have permission to execute a script in Python called “<strong>base.py</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SBBMj37GAS8/X7isg9b_lII/AAAAAAAAq40/0ftX8Ws08h4bOqM287_5N7FIjGfbqxZwwCLcBGAsYHQ/s16000/21.png"/></span></p>
<p><span style="color: #000000;">Initially, we tried to insert a new line, but we do not have permission to edit the file. However, <strong>we do to delete it!</strong></span></p>
<p><span style="color: #000000;">So, we delete the file, create a new one inserting the execution of a bash as root, execute as sudo this file, scale privileges as root and read the flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-k2j5_L4bb1o/X7isk-iJ74I/AAAAAAAAq48/anwTtSHf3C8xiyHRCERuWtM-pnOJ7imWACLcBGAsYHQ/s16000/22.png"/></span></p>
<p><span style="color: #000000;">Hope you have enjoyed this TryHackMe Write-up. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/">Link</a> </strong><span style="color: #000000;">for more TryHackMe CTF’s.</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>David Utón</strong> is Penetration Tester and security auditor for Web applications, perimeter networks, internal and industrial corporate infrastructures, and wireless networks. Contacted on <span style="color: #0000ff;"><strong>LinkedIn </strong></span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://twitter.com/David_Uton">Twitter</a></strong></span>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
