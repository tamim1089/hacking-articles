<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Mantis Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-mantis-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-04-04T15:02:59+00:00">April 4, 2018</time><time class="updated" datetime="2025-07-06T17:46:17+00:00">July 6, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “<strong>Mantis</strong>” which is categories as retired lab presented by <strong>Hack the Box</strong> for making online penetration practices. Solving challenges in this lab is not that much easy until you don’t have some knowledge of Penetration testing. Let start and learn how to analyze any vulnerability in a network then exploit it for retrieving desired information.</span></p>
<p><span style="color: #000000;"><strong>Level: </strong>Intermediate</span></p>
<h5><strong><span style="color: #000000;">Task: find user.txt and root.txt file on the victim’s machine.</span></strong></h5>
<p><span style="color: #000000;">Since these labs are online accessible therefore they have static IP. The IP of Mantis is <strong>10.10.10.52</strong> so let’s initiate with nmap port enumeration.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 10.10.10.52</pre>
<p><span style="color: #000000;">From the given below image, you can observe we found so many ports are open in the victim’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ff12tHu22Xw/WsTkiZp2YlI/AAAAAAAAWDo/4PZUKnMWIZwesxEWPIoQ9C-xJwo89U0fQCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Since we have run nmap aggressive scan therefore in below image you can observe remaining result where the highlighted text is pointing towards victim’s system domain name and FQDN.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-JcLFY1KXuPA/WsTkk5xwlCI/AAAAAAAAWDU/i4xvmClzSZQrbg9Wc7iQ_4Ow1qfxUqyowCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">First of all, we browse target IP through port 1337 in our web browser and saw following the image of IIS7 and although here I didn’t get any clue for next step therefore automatically next I move for directory buster.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-7VPIzrQChZM/WsTkmXeHQ-I/AAAAAAAAWDU/WefoVF0rEfE80sJVQxI2oIncvOcCdGV4wCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Then I preferred to use dirbuster tool and chose <strong>directory list 2-3 medium.txt</strong> file for directory brute force attack on <strong>http://10.10.10.52:1337</strong> for PHP file extension.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FFJlL4gCRjs/WsTkmm1XSaI/AAAAAAAAWDo/8MyiI3dOUAYFsJleRcz6LU9kTdRGYguegCEwYBhgL/s1600/4.png"/></span></p>
<h5><span style="color: #000000;">As result, I found a directory <strong>/secure notes</strong> with 200 ok response.</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-a_FI83djbTE/WsTkmpzTu_I/AAAAAAAAWDY/wAOMaqEa7c8RQ4p4PLmnE4AmkZFxxwonQCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Here I saw two files dev_notes and web.config among these I’m interested in <strong>dev_notes</strong> test file to let’s open it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-1GxeDAeLmMs/WsTknKhvQdI/AAAAAAAAWDk/IAY4i8V76uUj2OxgBL7mqJhZFeCIPYYsQCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">When I open a dev_notes text file I read following contents as shown in below image and realize that it points towards a database “orcharddb” have “admin” as username, now I only need to know the required password for login into the database.</span></p>
<p><span style="color: #000000;">I found the file “/dev_notes_NmQyNDI0NzE2YzVmNTM0MDVmNTA0MDczNzM1NzMwNzI2NDIx.txt.txt” suspicious because someone base 64 encoded “NmQyNDI0NzE2YzVmNTM0MDVmNTA0MDczNzM1NzMwNzI2NDIx”; therefore, I need to decode this text to correctly assume the password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XqKKOJKzAFY/WsTknb8ambI/AAAAAAAAWDg/liYRVwQL5qcXZFYlk7dlVW6_SeErcYybQCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">When I decode our base 64 encoded text further I get hex code from inside it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-1sZnYTDHHnE/WsTknQjOQAI/AAAAAAAAWDo/49okrmw-kiEPoVHxGy53neYnwUVlv12KwCEwYBhgL/s1600/8.1.png"/></span></p>
<p><span style="color: #000000;">After decoding the above hex text finally I found a password for admin user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BSkpNQWKjWI/WsTkoN8rvrI/AAAAAAAAWDk/xuLOejn5cuISX-7QHQN5uSOZmsegx5Q0gCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Using <strong>dbeaver</strong> we are going to connect to ms SQL server as shown below in the image. Now let login into the database using database name and above-found credential via port 1433</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LI8Wp67d5Rs/WsTkiZyTq7I/AAAAAAAAWDk/zNGkL0DZztcR-Vu2wdTb71zUBVWLscQLwCEwYBhgL/s1600/11.png"/></span></p>
<h5><span style="color: #000000;">Great!! We are inside the database now let enumerate database tables for retrieving some important information.</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wdOvu1AYE70/WsTkjdmVYMI/AAAAAAAAWDY/0zXgQNtwMZMbBN9YN8t4hS2-ezG1r_inQCEwYBhgL/s1600/15.1.png"/></span></p>
<p><span style="color: #000000;">Further down the table <strong>blog_Orchad_Users_UserPartRecord</strong>, I was able to catch the columns that hold usernames and passwords and found two usernames.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-D8DB2K9EW9g/WsTkjveI8_I/AAAAAAAAWDY/hOcVsZDU6ukrTkWkYEt7cA9wfQbyGUNGgCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">We had manually added target IP with <strong>htb.local</strong> and <strong>matis.htb.local</strong> the domain names which we have found through nmap in our local host file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-WZFYHRpe7MQ/WsTkjYZZHaI/AAAAAAAAWDk/mfuS9dqQWBMoqtPzBJDKlZabeqYJFF05ACEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Then we have i<strong>nstalled </strong>impacket from git hub as given below command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/CoreSecurity/impacket.git</pre>
<p><span style="color: #000000;">Impacket is an assembly of Python classes for working with network protocols. Impacket is focused on providing low-level programmatic access to the packets and for some protocols (for instance NMB, SMB1-3, and MS-DCERPC) the protocol implementation itself.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-rnDwOc1tVLI/WsTkkA_sDdI/AAAAAAAAWDQ/AOZ5Q7nsubgqgdkNPpcl-B8jdGy5ntBFACEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now run install the downloaded file by executing following command</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python setup.py install</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-0hagrnX3R1M/WsTkkVaElfI/AAAAAAAAWDc/QCQ869WazSEyp0v1H7BgBSSyWHzHQKNXACEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Impacket contains goldenpac python file which is used for post exploitation. Now execute given below command and access the victim’s terminal through that.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">goldenPac.py htb.local/james@mantis.htb.local</pre>
<p><span style="color: #000000;">From given below image you can observe that we had access victim’s terminal.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-osxLYxMm4cI/WsTkkebm1AI/AAAAAAAAWDk/DjMAIZLiA1QqEuEORYCMdhlUyYe-6piyACEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Now let’s finished the task by grabbing user.txt and root.txt file. First I move into james directory and check available files and directories inside it.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd james
dir</pre>
<p><span style="color: #000000;">Here I got a Desktop directory and after exploring it we found so many files and directory. At last, I fetch the user.txt file from inside /<strong>james /Desktop/</strong> and use cat command for reading.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">type user.txt</pre>
<h5><span style="color: #000000;"><strong>Our 1<sup>st</sup> challenges finished successfully now move for 2<sup>nd</sup> challenge.</strong></span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-dPBlls7b4XI/WsTklhmTXUI/AAAAAAAAWDo/H_1Mwdl6YqMW6Xzwn7BL6XrwTSPWsVpBACEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">At last, I fetch the user.txt file from inside /<strong>Administrator/Desktop/</strong> and use cat command for reading.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">type root.txt</pre>
<p><span style="color: #000000;"><strong>Awesome!!</strong> We had successfully completed the challenge by finding both the text file.</span></p>
<p><span style="color: #000000;"><strong>Happy Hacking!!</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-86RQNWBHh1s/WsTkl-lSpyI/AAAAAAAAWDo/F5ea_Kt6R7UNiOWy0O9F5JjesW9jX0hpwCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
