<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/credential-dumping/" rel="category tag">Credential Dumping</a></span>            </div>
            <h1 class="post-title entry-title">Credential Dumping: Phishing Windows Credentials</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/credential-dumping-phishing-windows-credentials/" rel="bookmark"><time class="entry-date published" datetime="2020-04-14T15:40:38+00:00">April 14, 2020</time><time class="updated" datetime="2025-07-20T11:57:11+00:00">July 20, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This is the ninth article in our series of Credentials Dumping. In this article, we will trigger various scenarios where Windows will ask for the user to perform authentication and retrieve the credentials. For security purposes, Windows make it essential to validate user credentials for various authentications such as Outlook, User Account Control, or to sign in Windows from the lock screen. We can use this feature to our advantage to dump the credentials after establishing the foothold on the Target system.  To exploit this feature, we will use phishing techniques to harvest the credentials.  </span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Metasploit Framework</strong></span>
<ul>
<li><span style="color: #000000;">phish_windows_credentials</span></li>
<li><span style="color: #000000;">FakeLogonScreen</span></li>
<li><span style="color: #000000;">SharpLocker</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>PowerShell Empire </strong></span>
<ul>
<li><span style="color: #000000;">Collection/prompt</span></li>
<li><span style="color: #000000;">Collection/toasted</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Koadic</strong></span>
<ul>
<li><span style="color: #000000;">Password_box</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>PowerShell</strong></span>
<ul>
<li><span style="color: #000000;">Invoke-CredentialsPhish.ps1</span></li>
<li><span style="color: #000000;">Invoke-LoginPrompt.ps1</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Lockphish</strong></span></li>
<li><span style="color: #000000;"><strong>Conclusion</strong></span></li>
</ul>
<h3><span style="color: #800000;">Metasploit Framework: phish_windows_credentials</span></h3>
<p><span style="color: #000000;">Metasploit comes with an in-built post exploit which helps us to do the deed. As it is a post-exploitation module, it just needs to be linked with an ongoing session. To use this module, simple type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use post/windows/gather/phish_windows_credentials
set session 1
exploit</pre>
<p><img fetchpriority="high" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-H6sjiINeNsQ/XpXLUGhcreI/AAAAAAAAjjI/nc7HsWLGHscQOPI7vPtNxpl91x-lI8BNACLcBGAsYHQ/s1600/1.png" alt="Credential Dumping via Phishing Windows Credentials" width="690" height="132"/></p>
<p><span style="color: #000000;">This module waits for a new process to be started by the user. After the initiation of the process, a fake Windows security dialogue box will open, asking for the user credentials as shown in the image below:</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-cM0zpNdhdD0/XpXLWgg4tDI/AAAAAAAAjjk/n6Ri91ZkJA8IeYw9pne5bb9y5qFFcofHQCLcBGAsYHQ/s1600/2.png"/></p>
<p><span style="color: #000000;">As the user enters their credentials, the system captures and displays them as shown in the image below:</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Nk16xeVrmQo/XpXLZ3JHwqI/AAAAAAAAjkI/WNRjQW7LrSUo7vJnxhpHkhdKe4-0agNggCLcBGAsYHQ/s1600/3.png"/></p>
<h3><span style="color: #800000;">FakeLogonScreen</span></h3>
<p><span style="color: #000000;">Additionally, Arris Huijgen created the <strong data-start="225" data-end="244">FakeLogonScreen</strong> tool. It is developed in C# because this language supports various frameworks that can inject the utility into memory. We will remotely execute this tool using Metasploit. But first, let’s download the tool using the link provided below</span></p>
<p><span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/bitsadmin/fakelogonscreen/releases">Download FakeLogonScreen</a></strong></span></p>
<p><span style="color: #000000;">We simply upload this tool from our meterpreter session and then remotely execute it using the following set of commands:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">upload /root/FakeLogonScreen.exe .
shell
FakeLogonScreen.exe</pre>
<pre class="lang:default decode:true"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-7_F88ffqAB8/XpXLaDMLH9I/AAAAAAAAjkM/UHFb_p_15ncH3wSLalVD5oZ9F0VpfXY-wCLcBGAsYHQ/s1600/4.png" alt="Credential Dumping via Phishing Windows Credentials" width="644" height="191"/></pre>
<p><span style="color: #000000;">Upon execution, it will simulate the Windows lock screen to obtain the password from the user. To do so, this tool will manifest the lock screen exactly like it is configured so that the user doesn’t get suspicious, just as it is shown in the image below:</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-WiA8cuMb4FI/XpXLasY89tI/AAAAAAAAjkQ/MTcnMVOt7MgCB-RvtTm16VTzKpIapUj3ACLcBGAsYHQ/s1600/6.png"/></p>
<p><span style="color: #000000;">It will validate the credentials locally or from Domain Controller as the user enters them and then display it on the console as shown in the image below:</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-R4TQp4ezGZA/XpXLbDFcNOI/AAAAAAAAjkU/_p6i2d_xYyQs_OpB1kE69S-NbP0x12ePACLcBGAsYHQ/s1600/7.png"/></p>
<h3><span style="color: #800000;">SharpLocker</span></h3>
<p><span style="color: #000000;">This tool is very similar to the previous one. It was developed by Matt Pickford. just like FakeLogonScreen, this tool, too, will exhibit the fake lock screen for the user to enter credentials and then dump then keystroke by keystroke to the attacker.</span></p>
<p><span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/Pickfordmatt/SharpLocker/releases/tag/v0.5">Download SharpLocker</a></strong></span></p>
<p><span style="color: #000000;">We will first upload this tool from our attacker machine to the target system and then execute it. So, when you have the meterpreter session just type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">upload /root/Downloads/SharpLocker.exe .
shell
SharpLocker.exe</pre>
<p>We downloaded the tool on the Desktop so we will traverse to that location and then execute it</p>
<p><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-i0K8RWVCClA/XpXTJkCwDvI/AAAAAAAAjlM/ViBEvMzC9FMKLduyW5ZgO2gk0T5XGvWbQCLcBGAsYHQ/s1600/8.1.png" alt="Credential Dumping via Phishing Windows Credentials" width="676" height="144"/></p>
<p><span style="color: #000000;">Upon execution the tool will trigger the lock screen of the target system as shown in the image below:</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-DeDoalXOYyQ/XpXLb83NdPI/AAAAAAAAjkc/dWLQ7Pei_JowTt20SiQaIuYfwweXAPBFACLcBGAsYHQ/s1600/8.2.png"/></p>
<p><span style="color: #000000;">And as the user enters the password, it will capture the keystrokes until the whole password is revealed as shown in the image below:</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-NIdbEtNo-Gc/XpXLcD-OKUI/AAAAAAAAjkg/GVcYJRtu4zAb0OpBX1FkQfuP3Vr_NCftgCLcBGAsYHQ/s1600/8.3.png"/></p>
<h3><span style="color: #800000;">PowerShell Empire: Collection/prompt</span></h3>
<p><span style="color: #000000;">This module of the PowerShell Empire will prompt a dialogue box on the target system, asking for credentials like we did earlier. We can use this module with the following commands:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usemodule collection/prompt
execute</pre>
<p><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-53K6F81V9ZM/XpXLceTmUFI/AAAAAAAAjkk/spthWXcNEGMInuMa6hYdam4ZMR37m2SYwCLcBGAsYHQ/s1600/8.png" alt="Credential Dumping via Phishing Windows Credentials" width="709" height="167"/></p>
<p><span style="color: #000000;">Once the user types in the credentials on the dialogue box, the module will display it on the terminal as shown in the image below:</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-MsjklulDSmQ/XpXLc9VMI-I/AAAAAAAAjko/MilPDe1zofUIs8w2HLhHxiYRqpoUJbWCwCLcBGAsYHQ/s1600/9.png"/></p>
<h3><span style="color: #800000;">PowerShell Empire: Collection/toasted</span></h3>
<p><span style="color: #000000;">This module of PowerShell Empire triggers a restart notification like the one which is generated when updates require and reboot to install. To use this module type the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usemodule collection/toasted
execute</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-dYVypXfIpeg/XpXLUFIIR8I/AAAAAAAAjjM/ZXv9MNZZw0oITtqBvTY9J7taohi3uPVuACLcBGAsYHQ/s1600/10.png"/></p>
<p><span style="color: #000000;">Once the module executes, it will show the following dialogue box:</span></p>
<p><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-fOdp8PUXx1g/XpXLUImI_0I/AAAAAAAAjjE/0C46WkDl0HELp3P2F5ZdCGzBvrpC-FG4QCLcBGAsYHQ/s320/11.jpg" alt="Credential Dumping via Phishing Windows Credentials" width="320" height="240"/></p>
<p><span style="color: #000000;">And once the Postpone button is clicked, it will ask for credentials to validate the decision to postpone as shown in the image below:</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-6uljqPTd7eU/XpXLVT4ISfI/AAAAAAAAjjQ/SYGPO3Xu-SI1TcZek1_tw-Wn960vi1lagCLcBGAsYHQ/s1600/12.png"/></p>
<p><span style="color: #000000;">And as the user enters the credentials, It will print them as shown in the image below:</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-bOmtLaCfB9c/XpXLVU8427I/AAAAAAAAjjU/tKwC-ia15k8cJN5k6wRcOjbjSkGQ_s2OACLcBGAsYHQ/s1600/13.1.png"/></p>
<h3><span style="color: #800000;">Koadic</span></h3>
<p><span style="color: #000000;">A similar module to the one in PowerShell Empire can be found in Koadic. Once you have the session using Koadic, use the following command to trigger the dialogue box:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use password_box
execute</pre>
<p><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-aiXF9se8BHs/XpXLVj5VtWI/AAAAAAAAjjY/ynw3vh_MBDElkNvmnDHY-fyV-HSSJaeXgCLcBGAsYHQ/s1600/13.png" alt="Credential Dumping via Phishing Windows Credentials" width="496" height="127"/></p>
<p><span style="color: #000000;">When the user enters the username and password in the dialogue box, the password will be displayed in the terminal too as shown in the image below:</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-lu0bhmOJFNI/XpXLWMtSmdI/AAAAAAAAjjc/R2j010Oafq0Fw380MbyaQRo7OZdx-FhXgCLcBGAsYHQ/s1600/15.png"/></p>
<h3><span style="color: #800000;">PowerShell: Invoke-CredentialsPhish.ps1</span></h3>
<p><span style="color: #000000;">You can run a script on PowerShell that creates a fake login prompt for users to enter their credentials. </span></p>
<p><span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://raw.githubusercontent.com/samratashok/nishang/master/Gather/Invoke-CredentialsPhish.ps1">Download Invoke-CredentialsPhish.ps1</a></strong></span></p>
<p><span style="color: #000000;">To initiate the script, type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Import-Module C:\Users\raj\Desktop\Invoke-CredentialsPhish.ps1
Invoke-CredentialsPhish</pre>
<pre class="lang:default decode:true"><span style="color: #000000;">The execution of the above commands will pop out a prompt asking for credentials as shown in the image below:</span></pre>
<p><img loading="lazy" decoding="async" class="alignnone" style="font-size: 1.0625rem; letter-spacing: 0px;" src="https://1.bp.blogspot.com/-vWTZFXpgriQ/XpXLWa3sWUI/AAAAAAAAjjg/BzDVi7-8N9U9mSx8TYYYCeSuAwDKjn2rACLcBGAsYHQ/s1600/19.png" alt="Credential Dumping via Phishing Windows Credentials" width="660" height="324"/></p>
<p><span style="color: #000000;">So, once the user enters the credentials, they will be displayed on the screen as shown in the image below:</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-7lOiW4QRivA/XpXLXONpQAI/AAAAAAAAjjo/TdQ1InRaWocij6ppuGA1C_kciC6l9NktwCLcBGAsYHQ/s1600/20.png"/></p>
<h3><span style="color: #800000;">PowerShell: Invoke-LoginPrompt.ps1</span></h3>
<p><span style="color: #000000;">Similarly, there is another script developed by Matt Nelson. This script will again open a dialogue box for the user to enter the passwords. </span></p>
<p><span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://raw.githubusercontent.com/enigma0x3/Invoke-LoginPrompt/master/Invoke-LoginPrompt.ps1">Download Invoke-LoginPrompt.ps1</a></strong></span></p>
<p><span style="color: #000000;">To initiate the script, type the following:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Import-Module C:\Users\raj\Desktop\Invoke-LoginPrompt.ps1
Invoke-LoginPrompt.ps1</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-z-iAhVu5pR8/XpXLXWGyWtI/AAAAAAAAjjs/5_4uKWWz5RgOh03La9gniPmOe9A2WAiGQCLcBGAsYHQ/s1600/21.png"/></p>
<p><span style="color: #000000;">Moreover, as you can see, when the dialog box appears on the screen and the user enters their credentials, the system will display them back on the terminal.</span></p>
<p><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-Hb1wF0GhdiU/XpXLXz9LVeI/AAAAAAAAjjw/3IJ_jhdtYJUQoU3XO30V2wtqgcTw8gfMQCLcBGAsYHQ/s1600/22.png" alt="Credential Dumping via Phishing Windows Credentials" width="341" height="155"/></p>
<h3><span style="color: #800000;">Lockphish</span></h3>
<p><span style="color: #000000;">Furthermore, <strong data-start="541" data-end="554">Lockphish</strong> is another tool that you can use to phish for credentials. You can download this tool from here. It creates a template that appears to redirect the user to a YouTube video hosted on a PHP server, but it actually prompts the user to enter their login credentials and then sends them to the attacker.</span></p>
<p><span style="color: #000000;">Initiate the tool using the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./lockphish.sh</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-LVatDndHnA0/XpXLYI5TXCI/AAAAAAAAjj0/uUYsMk0pj_IJHt5BaTV4ry2GRjIcacNCQCLcBGAsYHQ/s1600/23.png"/></p>
<p><span style="color: #000000;">It will generate a public link using ngrok as shown in the image above, send that link to the target. When the target executed the link it asks to save a file. For this step, strong social engineering skills are required.</span></p>
<p><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-Yho5EUHdYXM/XpXLYQXEqrI/AAAAAAAAjj4/2quEhiOTdAkAuh2wHiuBnLFW3SaF2S5XwCLcBGAsYHQ/s1600/24.png" alt="Credential Dumping via Phishing Windows Credentials" width="629" height="394"/></p>
<p><span style="color: #000000;">And after the user has entered the credentials, it will redirect the user to YouTube.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-IaEIw1mxmWg/Xp6vaFyvI7I/AAAAAAAAjrk/MJiDmprHAqUphlZDfWZy1Haosow3IbkjwCLcBGAsYHQ/s1600/ggg.png"/></p>
<p><span style="color: #000000;">Next, after you execute the downloaded file, the lock screen triggers, forcing the user to enter their credentials as shown in the image below.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-RtGpNe_raXY/XpXLY9UI9pI/AAAAAAAAjj8/_Vp2OXespgUvWmKHHHPnr2HUiINM5SY-QCLcBGAsYHQ/s1600/26.png"/></p>
<p><span style="color: #000000;">And, we will have our credentials as shown in the image below:</span></p>
<p><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-FZRqQl_PHQc/XpXLZV2ALNI/AAAAAAAAjkE/vqa9triCsr8KQK8rLW7gVp2yyOOYs0z4wCLcBGAsYHQ/s1600/27.png" alt="Credential Dumping via Phishing Windows Credentials" width="539" height="181"/></p>
<h3><span style="color: #800000;">Conclusion</span></h3>
<p><span style="color: #000000;">These were various methods that we can use to dump the credentials of the target system. Finally, depending on the scenario, you should choose the most appropriate method for dumping credentials. PowerShell methods are particularly effective for validating credentials, as the prompt remains open until the correct credentials are entered. Lockphish method doesn’t create the lock screen as accurately as other tools and it also does not validate the credentials. Hence each method and tool have their advantages and disadvantages. But all of them are fairly good and working.</span></p>
<p><span style="color: #000000;">To learn more about Credential Dumping. Follow this</span> <strong><a href="https://www.hackingarticles.in/tag/credential-dumping/">Link.</a></strong></p>
<p><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. Contact <strong><a class="broken_link" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
