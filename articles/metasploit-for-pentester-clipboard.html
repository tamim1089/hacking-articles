<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Metasploit for Pentester: Clipboard</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/metasploit-for-pentester-clipboard/" rel="bookmark"><time class="entry-date published" datetime="2021-07-28T05:37:04+00:00">July 28, 2021</time><time class="updated" datetime="2025-05-12T21:17:37+00:00">May 12, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this series of articles, we will focus on the various mechanisms of the <strong data-start="374" data-end="398">Metasploit Framework</strong> that penetration testers can use. Specifically, we will discuss the <strong data-start="467" data-end="493">External API extension</strong> provided by <strong data-start="506" data-end="520">Metasploit</strong>, which, among other things, allows attackers to target the <strong data-start="580" data-end="607">clipboard of the target</strong>.</span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Introduction</strong></span></li>
<li><span style="color: #000000;"><strong>Starting Clipboard Monitoring</strong></span></li>
<li><span style="color: #000000;"><strong>Getting a File from Clipboard</strong></span></li>
<li><span style="color: #000000;"><strong>Dumping Clipboard Data</strong></span></li>
<li><span style="color: #000000;"><strong>Pausing the Clipboard Capture</strong></span></li>
<li><span style="color: #000000;"><strong>Purging Clipboard Capture</strong></span></li>
<li><span style="color: #000000;"><strong>Setting Clipboard Data</strong></span></li>
<li><span style="color: #000000;"><strong>Stopping Clipboard Capture</strong></span></li>
<li><span style="color: #000000;"><strong>Conclusion</strong></span></li>
</ul>
<h3><span style="color: #800000;"><strong>Introduction</strong></span></h3>
<p><span style="color: #000000;">During the late 2014s, the <strong data-start="637" data-end="661">Metasploit Framework</strong> received an update featuring a functionality similar to the <strong data-start="722" data-end="769">OJ TheColonial Reeves Extended API (extapi)</strong>. Initially, the update targeted <strong data-start="802" data-end="821">Windows systems</strong> only. However, developers refined and expanded it over time to include more capabilities.</span></p>
<p><span style="color: #000000;">The update introduced three functionalities.</span></p>
<p><span style="color: #000000;">Service Management: With the help of this, <strong data-start="1014" data-end="1029">Meterpreter</strong> users access a service management interface. This interface allows them to read detailed information about services running on the target, including the startup status and interaction capabilities with the desktop.<br/>
</span></p>
<p><span style="color: #000000;">Window Management: Using this functionality, users can enumerate all open windows. Consequently, this helps penetration testers determine if the target is worth connecting to via VNC at a particular time.<br/>
</span></p>
<p><span style="color: #000000;">Clipboard Management: which we will discuss in detail in this post. It allows the attacker to read and write to the target’s clipboard. Moreover, it is not limited to text, as attackers can also download files and images.<br/>
</span></p>
<p><span style="color: #000000;">To begin the process, we first need to obtain a <strong data-start="1768" data-end="1789">meterpreter shell</strong> on the target machine. After achieving this, we then use the <strong data-start="1851" data-end="1874">load extapi command</strong> to load the <strong data-start="1887" data-end="1910">External API module</strong> into the session, as demonstrated below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">load extapi</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-k6H6nagnlck/YQDmTMghkRI/AAAAAAAAx4E/SwcC2mY-eTspGaz-ghbhkffdG61TT85mACLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Running the help command generates a list of commands that users can run from the <strong data-start="2035" data-end="2056">meterpreter shell</strong>. In addition to regular commands, the list also includes commands that are part of the <strong data-start="2144" data-end="2161">Extapi module</strong>. Here, we can observe commands for reading the <strong data-start="2209" data-end="2236">target’s clipboard data</strong>, dumping captured clipboard data, initializing, pausing, resuming, terminating clipboard capture, and setting clipboard data on the target.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-I2RgXd3yXbw/YQDmsQDYymI/AAAAAAAAx4M/R6Lb4lHFpqQMAPEwlGEB4yRkLE1N6h3_QCLcBGAsYHQ/s16000/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Starting Clipboard Monitoring</strong></span></h3>
<p><span style="color: #000000;">This module does not indefinitely capture clipboard data because the clipboard overwrites itself each time the target copies new data into memory. Consequently, this data can range from plain text to files. Surprisingly, the amount of valuable data obtained from the <strong data-start="2645" data-end="2658">clipboard</strong> can be significant. To initialize the capture process, we simply use the <strong data-start="2732" data-end="2767">clipboard_monitor_start command</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">clipboard_monitor_start</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Ppgz57WA7Lc/YQDm13_3itI/AAAAAAAAx4Q/MRjykZ7kCeoFCR1X6jIzWdQG0dfoTI-zwCLcBGAsYHQ/s16000/3.png"/></span></p>
<h3><span style="color: #800000;"><strong>Getting a File from Clipboard</strong></span></h3>
<p><span style="color: #000000;">After starting the clipboard monitoring using the command in the previous section, we move to our target machine to stimulate the Copying of files. Here we can see that inside a directory we are copying a PowerShell script file named OpenSSH. It is quite possible that it might contain a key that can be used to connect via SSH service.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4hE5HF9E50g/YQDm7kTi7PI/AAAAAAAAx4U/ob-6kGi0h5UXwF8uxs6YHAYbE4Y0MtRJgCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Back to our attacker machine to the meterpreter shell. Here, we run the get data command to retrieve the file copied on the clipboard.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">clipboard_get_data</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fAh6qdxlF4c/YQDm_3EUusI/AAAAAAAAx4c/9wmydOp-91gcHKIQExaxc4fAnHmnHAeeACLcBGAsYHQ/s16000/5.png"/></span></p>
<h3><span style="color: #800000;"><strong>Dumping Clipboard Data</strong></span></h3>
<p><span style="color: #000000;">We just grabbed a singular file from the target but what if we want to get multiple files that are copied on its clipboard. To stimulate this, we again get back to the target machine. Here, we see that the target has an image file, text file and an application file inside a directory by the name of data. As the target user, we copied all the files inside the directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-E6wNBeMSsrY/YQDnEwPiExI/AAAAAAAAx4g/w2iUECg61TI8hfGqtmonJcjejEcLJjZLQCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Back to our attacker machine to the meterpreter shell. Here, we run the dump command to retrieve the files copied on the clipboard. We can see that the OpenSSH file was downloaded again. It is because we initialized the capture earlier, so any files that were copied since then will be retrieved.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">clipboard_monitor_dump</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-voi249S0dUI/YQDnIy2OHkI/AAAAAAAAx4o/qqr6vZ-B42kMfw9riH1d3bJRjWvHsqrrwCLcBGAsYHQ/s16000/7.png"/></span></p>
<h3><span style="color: #800000;"><strong>Pausing the Clipboard Capture</strong></span></h3>
<p><span style="color: #000000;">It is possible to get a large capture that could result in a failure and the amount of data transfer can raise some flags. Hence, it is recommended to pause the capture when you are not actively gathering the clipboard data from the target machine. If you ever want to un pause the capture, use the resume command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">clipboard_monitor_pause</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Nzib3Wm90XY/YQDnMd2kyZI/AAAAAAAAx4s/zh2hKzbFsdIXNR-4Q_ldxDsOPTB0D6eAQCLcBGAsYHQ/s16000/8.png"/></span></p>
<h3><span style="color: #800000;"><strong>Purging Clipboard Capture</strong></span></h3>
<p><span style="color: #000000;">The next command to discover is another that can help while working with the clipboard data. The amount of data captured by the clipboard can be overwhelming or maybe you just want to remove the captured data altogether. In such scenarios, you can use the purge command. In the demonstration, we tried to dump the capture after running the purge and we can see that there is no data in the capture.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">clipboard_monitor_purge</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sXziyw-nPk4/YQDnQYwA-QI/AAAAAAAAx40/A6-GsEHAbSkpA1MiCkD5F0YYRMIuVuaTgCLcBGAsYHQ/s16000/9.png"/></span></p>
<h3><span style="color: #800000;"><strong>Setting Clipboard Data</strong></span></h3>
<p><span style="color: #000000;">While introducing the clipboard commands, we said that it is possible to set the clipboard of the target machine as well. We need to use the set text command for this task. We take the text that we want to be stored inside the clipboard of the target user and then use it as a parameter between the double quotes as demonstrated in the image below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">clipboard_set_text “You have been hacked”</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BtVGrfoozzw/YQDnWt2YIMI/AAAAAAAAx48/8Lb7KdYsG008QjIB8nqiMTqqASbpqPnYQCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">To stimulate the response from the target end, we move back to the Target machine and open a text editor. Then we paste onto the text editor to find the same text stored inside the clipboard as we set through our attacker machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hhzPrcu5yTQ/YQDnaDf1KwI/AAAAAAAAx5E/AETwl5iiPO4-s7uRE_sbLiiUOGlt8-yLQCLcBGAsYHQ/s16000/11.png"/></span></p>
<h3><span style="color: #800000;"><strong>Stopping Clipboard Capture</strong></span></h3>
<p><span style="color: #000000;">Similar to the Pausing of the Clipboard. There is a command to stop the capture altogether. The difference between the both is that while Paused capture can be resumed but the stopped cannot be resumed and the data that is captured is not accessible after the fact.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">clipboard_monitor_stop</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-E0UVy494z6Y/YQDneQ0h7VI/AAAAAAAAx5I/ELXVCzFOSusrINh9t5E4bhTKdWvu06okACLcBGAsYHQ/s16000/12.png"/></span></p>
<h3><span style="color: #800000;"><strong>Conclusion</strong></span></h3>
<p><span style="color: #000000;">Concluding this article, we can say that this was one of the lesser-known mechanisms of the Metasploit Framework that can be used by any Penetration Tester. We will be discussing about the External API extension provided by Metasploit later.</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Can be Contacted on <span style="color: #0000ff;"><strong>Twitter</strong> </span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
