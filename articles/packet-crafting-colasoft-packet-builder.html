<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Packet Crafting with Colasoft Packet Builder</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/packet-crafting-colasoft-packet-builder/" rel="bookmark"><time class="entry-date published" datetime="2017-12-31T07:38:42+00:00">December 31, 2017</time><time class="updated" datetime="2024-06-28T12:34:13+00:00">June 28, 2024</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this tutorial, we are going to discuss Packet Crafting by using a great tool Colasoft packet builder which is quite useful in testing the strength of Firewall and IDS and several servers against malicious Flood of network traffic such as TCP and UDP Dos attack. This tool is very easy to use especially for beginners.</span></p>
<p><span style="color: #000000;"><strong>Packet crafting</strong> is a technique that allows network administrators to probe firewall rule-sets and find entry points into a targeted system or network. This is done by manually generating packets to test network devices and behavior, instead of using existing network traffic. Testing may target the firewall, IDS, TCP/IP stack, router or any other component of the network. Packets are usually created by using a packet generator or packet analyzer which allows for specific options and flags to be set on the created packets. The act of packet crafting can be broken into four stages: Packet Assembly, Packet Editing, Packet Play, and Packet Decoding.</span></p>
<p><span style="color: #000000;">For more detail visit <strong>Wikipedia.org</strong></span></p>
<p><span style="color: #000000;"><strong>Mode of Operation </strong></span></p>
<p><span style="color: #000000;"><strong>Packet Assembly: </strong>It is the initial state of packet crafting where tester needs to decide the network that can be compromised easily by creating a packet which can exploit the network by shooting its vulnerability. The packet should be designed in a manner that it maintains its ability to be undetectable in the target’s network.</span></p>
<p><span style="color: #000000;">Famous Tools for Packet Assembly are: <strong>Hping3 </strong>and<strong> Yersinia</strong>   </span></p>
<p><span style="color: #000000;"><strong>Packet Editing: </strong>In this stage captured packet is edited or modified which cannot be possible to do in Packet Assembly phase. In this phase, the packet is edited in a manner that it can dump more and more information about the target’s network by making a small amount of change in it. For example, change data length (payload) of packets.</span></p>
<p><span style="color: #000000;">Famous Tool of packet Editing: <strong>Colasoft </strong>and<strong> Scapy</strong>   </span></p>
<p><span style="color: #000000;"><strong>Packet Playing:</strong> In this phase when the packet is ready to launch then it sends to target’s network for exploiting its network and collect the information. This is the actual arena where above both actions is tested and if the packet is failed to complete its goal of retrieving victim’s information or exploit its vulnerability then again the packet send back to Packet Editing phase for modification.</span></p>
<p><span style="color: #000000;"><strong>Packet Analysis: </strong>This is the last stage where the packet is analysis when it received on the targeted network. The captured packet is decoded for further investigating for retrieving its internal details which can speak up its goal for establishing a connection on the target’s network.</span></p>
<p><span style="color: #000000;">Famous Tool of Packet Analysis: <strong>Wireshark </strong>and<strong> Tcpdump</strong></span></p>
<p><span style="color: #000000;"><strong>Colasoft Packet Builder</strong> enables creating custom network packets; users can use this tool to check their network protection against attacks and intruders. Colasoft Packet Builder includes a very powerful editing feature. Besides common HEX editing raw data, it features a Decoding Editor allowing users to edit specific protocol field values much easier.</span></p>
<p><span style="color: #000000;">Users are also able to edit decoding information in two editors – Decode Editor and Hex Editor. Users can select one from the provided templates <strong>Ethernet Packet, ARP Packet, IP Packet, TCP Packet, and UDP Packet,</strong> and change the parameters in the decoder editor, hexadecimal editor or ASCII editor to create packets. Any changes will be immediately displayed in the other two windows. In addition to building packets, Colasoft Packet Builder also supports saving packets to packet files and sending packets to the network.</span></p>
<p><span style="color: #000000;"><strong>From:  </strong><a style="color: #000000;" href="https://www.colasoft.com/packet_builder/"><strong>http://www.colasoft.com/packet_builder/</strong></a></span></p>
<p><span style="color: #000000;"><strong>Let’s start!!!</strong></span></p>
<h3><span style="color: #800000;"><strong>TCP Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">You can download it from the above-given link, once it gets downloaded then <strong>run the application as an administrator</strong>, to begin with crafting various Packets. As I had an example above a packet crafting involves 4 phases, let’s start it by adding the packet which we will craft for testing our network.</span></p>
<p><span style="color: #000000;">Click on<strong> ADD</strong> given in menu bar.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-oL_O451IYig/WkhwSE-YHQI/AAAAAAAAS4Y/Ql8-aSyt_EE1HOibgFL9SdZujkEULjzMQCLcBGAs/s1600/0.png"/></span></p>
<p><span style="color: #000000;">A small window will pop up to select the mode of IP packet to be crafted. Here we are going to choose <strong>TCP packet</strong> for crafting for example by increasing the size of the packet or by sending the individual flag of the Tcp Protocol to the destination IP address. Well if you will notice given below image then you will observe that I had set delta time <strong>0.1 sec</strong> as time elapses for the flow of traffic for all crafted packets. The delta time is the time gap between each packet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dhGnWjA7PZc/WkhwSERX6-I/AAAAAAAAS54/ZB_boMA9oeY4IncXZV0hd0eTgLg1N1GowCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Window is categories into three phases as <strong>Decode Editor</strong>, <strong>Hex Editor</strong>, and <strong>packet List</strong>. From the given image you can observe the following information which I had edited for TCP packet</span></p>
<p><span style="color: #000000;"><strong>Decode Editor:</strong> This section contains packet information such as protocol, Time to live and etc. Here you need to <strong>add</strong> <strong>source address</strong> responsible for sending a packet and then <strong>add destination address</strong> which is responsible for receiving incoming packet traffic.</span></p>
<ul>
<li><span style="color: #000000;"><strong>Source address:</strong> 192.168.1.102</span></li>
<li><span style="color: #000000;"><strong>Destination address:</strong> 192.168.1.107</span></li>
</ul>
<p><span style="color: #000000;"><strong>Hex Editor:</strong>  This section displays the raw information (Hexadecimal) related to the data size of the packet. By typing a random string you can increase the size of the packet.</span></p>
<p><span style="color: #000000;"><strong>Packet size:</strong> 77 bytes</span></p>
<p><span style="color: #000000;">This phase is also known as <strong>Packet Editing</strong> mode where we can modify our packet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-MrWOGxxAubA/WkhwVgNq5LI/AAAAAAAAS54/4-A5iHHtmUQ52g62tWpeFG5-_0Odh4EFACEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;"><strong>Packet List: </strong>It displays complete information of your packet which contains a source address, destination address<strong>, </strong>time to live and other information which we had edited.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-TsJOkr4whGQ/WkhwXjrJ2gI/AAAAAAAAS54/Fj2TUB4JDPwEg3w4oSVHCJl3JsyfmkqTACEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Click on <strong>Adapter </strong>given in the menu bar to select a specific adapter from which packets will be sent. From given below image you can observe it, it showing adapter status: LAN Operational.</span></p>
<p><span style="color: #000000;"><strong>Note: It is only available when you have run the application as administrator. </strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wm_qATmrlNU/WkhwX9hWCbI/AAAAAAAAS54/LEKIyx5OUQYb3tc6pzMoyX_AZq7w7WdigCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Click on <strong>Send</strong> option from the menu bar and enable the checkbox for “Burst Mode” and “Loop sending” and adjust the number of packets to be sent to the Destination Network and the delay time gap between each packet.</span></p>
<p><span style="color: #000000;">Then click on<strong> start</strong> to send the TCP packets. This phase is known as <strong>Packet playing</strong> mode where are ready to the sent packet on the target network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-DjCTEfBWp1M/WkhwYGrRitI/AAAAAAAAS54/zIJJLQjRM7AX2PjpQs6yoNUca3uOgbXjwCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Using Wireshark we can capture packet and traffic between source and destination. So here you can perceive that infinite <strong>TCP packet</strong> is being transferred to target’s network. This phase is known as <strong>packet analysis </strong>mode where the sent packet is sniff or analysis for identifying sender objectives behind sending the packet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Bv8aFTt2_kI/WkhwYSUdZzI/AAAAAAAAS54/dphROpl8sF0vwwS0w94VMfwyrTLE3Mt5QCEwYBhgL/s1600/6.png"/></span></p>
<h3><span style="color: #800000;"><strong>ARP Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">Again repeat the same to choose ARP packet for crafting Packet for ARP protocol on the target’s network. Well if you will notice given below image again then you will observe that I had set same delta time 0.1 sec.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-N-oz2pu3QWo/WkhwYoPqywI/AAAAAAAAS54/vPk2XlfGz9QHYPFRMhqNN1n2SRvUQjC2wCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Apart from editing source and destination IP here we need to add source and destination physical address also.</span></p>
<p><span style="color: #000000;">Hence this time I had set below information in decoder Editor and Hex editor.</span></p>
<ul>
<li><span style="color: #000000;"><strong>Source MAC: </strong>AA:AA:AA:AA:AA:AA</span></li>
<li><span style="color: #000000;"><strong>Source address:</strong> 192.168.1.102</span></li>
<li><span style="color: #000000;"><strong>Destination MAC:</strong> BB:BB:BB:BB:BB:BB</span></li>
<li><span style="color: #000000;"><strong>Destination address:</strong> 192.168.1.107</span></li>
<li><span style="color: #000000;"><strong>Packet size:</strong> 78 bytes</span></li>
</ul>
<p><span style="color: #000000;">You can use any method to find the destination MAC address.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-q6H8IBn4SOQ/WkhwSZQ8PFI/AAAAAAAAS58/ZGXfNl-yKlYz-DJu3Xakm09ufLGA4X6vwCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">After editing your packet information verifies that changes through packet list are given on the right side of the window before sending the packet. If you notice given image below then you can read the summary where it is show broadcasting ARP message who is 192.168.1.107?</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-GEfGyNgKCpg/WkhwTHwIZvI/AAAAAAAAS54/kPkF1cxEpa8lGAkuwBeXm1o8yuTo-hrpACEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Click on <strong>Adapter </strong>given in menu bar to select specific adapter for network selection. From given below image you can observe it showing adapter status: LAN Operational.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--cKuv9yyLgM/WkhwTQKZpFI/AAAAAAAAS54/XREEdZCHfLclbxPNOM4FNE7DZ2p6nnHSACEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Click on <strong>Send</strong> option from the menu bar and enable the checkbox for “Burst Mode” and “Loop sending” and adjust the number of packets to be sent to the Destination network according to your wish.</span></p>
<p><span style="color: #000000;">Then click on<strong> start</strong> to launch the sending process of ARP packet. This action is known as Packet playing.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-97oO4xx9AQQ/WkhwTxitbUI/AAAAAAAAS54/sIRV4ZvY9qIyahitrtxD7KuJhgzTWLKGACEwYBhgL/s1600/14.png"/></span></p>
<p> </p>
<p><span style="color: #000000;">From the given image below you can observe the continue ARP packet making a request for who is 192.168.1.107, which meaning our packet playing is given a positive result. From Wireshark target is able to analysis the goal of the packet received from the sender’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-3I65cpf8lfk/WkhwT7zYSvI/AAAAAAAAS54/LZSXCVuVXnsTOYEkzXkzDha9hN3EzixzwCEwYBhgL/s1600/16.png"/></span></p>
<h3><span style="color: #800000;"><strong>IPv4 Packet Crafting  </strong></span></h3>
<p><span style="color: #000000;">Again repeat the same process to choose <strong>IP packet</strong> for crafting Packet for IPv4 protocol on the target’s network. Again if you will notice given below image again then you will observe that I had set same delta time <strong>0.1 sec.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EM6otkocmAI/WkhwT75mpHI/AAAAAAAAS54/Pr2OG-e6Y0MvhycmlCvsiC2PBdN58nNjgCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">This time I had set below information in decoder Editor and Hex editor for Editing Packet.</span></p>
<ul>
<li><span style="color: #000000;"><strong>Source address:</strong> 192.168.1.102</span></li>
<li><span style="color: #000000;"><strong>Destination address:</strong> 192.168.1.107</span></li>
<li><span style="color: #000000;"><strong>Packet size:</strong> 71 bytes</span></li>
</ul>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-yCELpYlvbko/WkhwUYpHioI/AAAAAAAAS54/W042ScgMWM4rDCahRYDG1IDXhAGg0fzFwCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">After editing your packet information verifies that changes through packet list are given on the right side of the window before sending the packet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-pyR0G6j82bs/WkhwUxlUgZI/AAAAAAAAS54/fzuvFEJPXUsN3OJw_nPwo9bKyIYyP3jPgCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Click on Adapter given in menu bar to select specific adapter for sending the packet. From given below image you can observe it showing adapter status: LAN Operational.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-825B6hB_FwQ/WkhwV9qtI-I/AAAAAAAAS54/L2kZRDc35UoCTrILUaAClvOUDWuKvQZmgCEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Click on <strong>Send</strong> option from the menu bar and enable the checkbox for “Burst Mode” and “Loop sending” and adjust the number of packets to be sent to the Destination network according to your wish.</span></p>
<p><span style="color: #000000;">Then click on<strong> start</strong> to send the IPv4 packet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-8-CQMN9ElAM/WkhwWNei5zI/AAAAAAAAS54/GqXOPmLJi4USG5uR8oCkMoucddjxmJNsgCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">You can clearly observe in given below image the flow of traffic of <strong>IPv4 packets </strong>from senders network to Receivers network in packet analyzing mode.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-UFAz_YZ9wA0/WkhwWuvPJJI/AAAAAAAAS54/6uKfsk4tMcAXVfrmzmXtDB9FSNN_AGAPQCEwYBhgL/s1600/23.png"/></span></p>
<h3><span style="color: #800000;"><strong>UDP Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">Again repeat the same to choose <strong>UDP packet</strong> for crafting UDP Packet. If you will notice given below image then you will observe that again I had set delta time <strong>0.1 sec </strong>as time elapses for the flow of traffic for all packets.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tghqblV-wsc/WkhwWnH04hI/AAAAAAAAS54/kziCvn_ZCmsOcpAZg99dfSJjPmxEI_92QCEwYBhgL/s1600/24.png"/></span></p>
<p><span style="color: #000000;">This time I had Edited below information in decoder Editor and Hex editor for designing my packet.</span></p>
<p><span style="color: #000000;"><strong>Source address:</strong> 192.168.1.102</span></p>
<p><span style="color: #000000;"><strong>Destination address:</strong> 192.168.1.107</span></p>
<p><span style="color: #000000;"><strong>Packet size:</strong> 72 bytes</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zBuRIBxV12o/WkhwW6f98qI/AAAAAAAAS54/8FNW1R-Ko40HWAHOCoT0747032JVcGiBACEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">After editing your packet information verifies that changes through packet list are given on the right side of the window.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-2nRPobeMuOs/WkhwWy0GiOI/AAAAAAAAS54/0CKvNzRd594mMauyAFxgTISYcAc0mU54QCEwYBhgL/s1600/26.png"/></span></p>
<p><span style="color: #000000;">Click on <strong>Adapter</strong> to select specific adapter for sending the packets. From given below image you can observe it is showing adapter status: LAN Operational.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-AqAnfNRec4U/WkhwXAlIvwI/AAAAAAAAS54/xe6bLtbiGCke_8RLDkDVmJwAjfhgrBzSwCEwYBhgL/s1600/27.png"/></span></p>
<p><span style="color: #000000;">Click on <strong>Send </strong>option from the menu bar and <strong>enable the checkbox</strong> for “Burst Mode” and “Loop sending” and adjust the number of packets to be sent to the Destination network according to your wish.</span></p>
<p><span style="color: #000000;">Then click on the start button to sending the crafted UDP packet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-weyCd7TlQU4/WkhwXT_F7sI/AAAAAAAAS54/t7pEe6loBNcW1DsOD7NdIh6JDMO0FqllwCEwYBhgL/s1600/28.png"/></span></p>
<p><span style="color: #000000;">You can clearly observe in given below image the flow of traffic of <strong>UDP packets </strong>from senders network to the Receivers network.</span></p>
<p><span style="color: #000000;">Hence in this tutorial, we tried to explain all for the mode of operation of crafting a packet for testing a network using colasoft and Wireshark.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-bAbaevp4h6M/WkhwXiaqBoI/AAAAAAAAS54/bzkzVKdpRX8ZWGD-TiOlWOmQ84zpt9ZuACEwYBhgL/s1600/30.png"/></span></p>
<p><strong>Author</strong>: <strong>Rahul Virmani</strong> is a Certified Ethical Hacker and the researcher in the field of network Penetration Testing (CYBERSECURITY).    Contact <strong><a href="https://www.linkedin.com/in/rahul-virmani-4280666a/">Here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
