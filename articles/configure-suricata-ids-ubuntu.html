<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">How to Configure Suricata IDS in Ubuntu</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/configure-suricata-ids-ubuntu/" rel="bookmark"><time class="entry-date published" datetime="2018-01-12T17:01:35+00:00">January 12, 2018</time><time class="updated" datetime="2025-06-19T21:22:49+00:00">June 19, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Suricata is developed by the Open Information Security Foundation. Suricata is a high performance Network IDS, IPS and Network Security Monitoring engine. Open Source and owned by a community run non-profit foundation, the Open Information Security Foundation (OISF). Suricata is developed by the OISF and its supporting vendors.</span></p>
<p><span style="color: #000000;"><strong>Features</strong></span></p>
<p><span style="color: #000000;"><strong>IDS / IPS</strong></span></p>
<p><span style="color: #000000;">Suricata implements a complete signature language to match on known threats, policy violations and malicious behaviour. Suricata will also detect many anomalies in the traffic it inspects. Suricata is capable of using the specialized Emerging Threats Suricata ruleset and the <a style="color: #000000;" href="http://snort.org/vrt">VRT ruleset</a>.</span></p>
<p><span style="color: #000000;"><strong>High Performance</strong></span></p>
<p><span style="color: #000000;">A single Suricata instance is capable of inspecting multi-gigabit traffic. The engine is built around a multi threaded, modern, clean and highly scalable code base. There is native support for hardware acceleration from several vendors and through PF_RING and AF_PACKET.</span></p>
<p><span style="color: #000000;">Automatic protocol detection</span></p>
<p><span style="color: #000000;">Suricata will automatically detect protocols such as HTTP on any port and apply the proper detection and logging logic. This greatly helps with finding malware and CnC channels.</span></p>
<p><span style="color: #000000;"><strong>NSM: More than an IDS</strong></span></p>
<p><span style="color: #000000;">Suricata can log HTTP requests, log and store TLS certificates, extract files from flows and store them to disk. The full pcap capture support allows easy analysis. All this makes Suricata a powerful engine for your Network Security Monitoring (NSM) ecosystem.</span></p>
<p><span style="color: #000000;">From: https://suricata-ids.org/</span></p>
<p><span style="color: #000000;"><strong>Lets Begin!!</strong></span></p>
<p><span style="color: #000000;">We had chosen Ubuntu operating system for installation and configuration of suricata. Earlier than installing suricata in your machine, you should need to install necessary dependencies of Ubuntu. Therefore open the terminal and type given below command to install per-requisites by a making update.</span></p>
<pre class="lang:default decode:true">apt-get update</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-_MMG3pUb50Q/WljjIq6uNqI/AAAAAAAATQA/VostLvIBlLgo0r0PI-favXWcvlcs4_OtACEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">It is an easiest way to install and configure the suricata in your system because it’s entire requirement whether it is suricata rules directory or logging directory every packages is are stored by apt repository. Enter given below command to begin the suricata installations. <strong> </strong></span></p>
<pre class="lang:default decode:true">apt-get install suricata -y</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-zM3pzqFXzhU/WljjKfCvIDI/AAAAAAAATQA/OC7w3t72dmA-0Qh2vgl57F_JY1HfDn-1gCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Now we need to create an empty text document file for our local rules inside rule folder of suricata</span></p>
<pre class="lang:default decode:true">touch /etc/suricata/rules/local.rules</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-YcUpq3A7cnc/WljjKZI0_NI/AAAAAAAATQA/DYJ1EzilHN8q-rWC7ZUVzd7ikVYF6wm0wCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">After then open the configuration file using gedit for making some changes inside.</span></p>
<pre class="lang:default decode:true">gedit /etc/suricata/suricata-debian.yaml</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/--O3JOn940aY/WljjKisGo2I/AAAAAAAATQA/b0rZZgl4ANkXhkvgaxk3hFrMbAvvKiuLQCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">The two most important steps we need to perform here:</span></p>
<ol>
<li><span style="color: #000000;"><strong>Comment</strong> all others available file of rules so that only yours local rule file will be in priority.</span></li>
<li><span style="color: #000000;">Mention the local.rules under the rule files list.</span></li>
</ol>
<p><span style="color: #000000;"><strong> </strong><img decoding="async" src="https://2.bp.blogspot.com/-UKR6kfE2e5Y/WljjLX_xTEI/AAAAAAAATQA/ulNNmY7WcnYNFP_2E4-B1i-Qj6HWfdWIwCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Now add the network CIDR for which IDS will filter the incoming and outgoing traffic as shown in given below image.</span></p>
<p><span style="color: #000000;">Here we had set <strong>HOME_NET 192.168.1.0/24</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-3Z3nG4NXoF0/WljjLjXurTI/AAAAAAAATQA/Qtl7I4GKdXUSkME5DwwPqP6FUVQiN6rvgCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Now open the local rule file to add your own network filtering rules in side it</span></p>
<pre class="lang:default decode:true">gedit /etc/suricata/rules/local.rules</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-4IBJ768cqFQ/WljjLspk3kI/AAAAAAAATQA/LV1AhwHDwkkLQFlva6FT-5ZtAZ3elBg_ACEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now if you are not much aware about its rule configuration then you need not to be worry about it because implementing rule in suricata is as similar as in snort. For help open this <a style="color: #000000;" href="https://www.hackingarticles.in/comprehensive-guide-on-snort-part-1/">Link</a> to get details of IDS rule implementation.</span></p>
<pre class="lang:default decode:true">alert icmp any any -&gt; 192.168.1.111 any (msg: “ICMP detected”; sid:10000001;)</pre>
<p><span style="color: #000000;">The above rule will generate an alert when found any network IP sending ICMP packets in our network by pinging IP 192.168.1.111.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9uGx9nT0OCk/WljjMQzWjwI/AAAAAAAATQE/b7VH6DXYXs48CFr89NS0Sm4IxJ8ClXeRwCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now execute following command to make GRO (Generic receive offload) disable on specific interfaces with help of Ethtool.</span></p>
<pre class="lang:default decode:true">ethtool -K ens33 gro off</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5u0iSpRnySM/WljjMlxVuDI/AAAAAAAATQA/e3tEPvy4m70pU1vwBXW6G00ZVSTDnbEegCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Then again turn On NIDS mode of surictata using given below command.</span></p>
<pre class="lang:default decode:true">suricata -c /etc/suricata/suricata-debian.yaml -i ens33</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-015UrtE5nd4/WljjIioNWJI/AAAAAAAATQA/hoXF4V21eFY5-vibnzJ2iGtEsRqQ0GlagCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now let’s ping the <strong>IP: 192.168.1.111</strong> from another system to test whether our NIDS will generate alert for ICMP packet or not. From given image you can read the command: <strong>ping 192.168.1.111 where you can observe it has sent 3 ICMP request packets. </strong> </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mdjMi51KqMk/WljjInbyflI/AAAAAAAATQA/NTVLdpT2IYcabaqyd7zFEmOA3Qg4txU5ACEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Basically suricata alert logs are generated under var/log and you can use given below command to read the captured logs.</span></p>
<pre class="lang:default decode:true  ">tail -f /var/log/suricata/</pre>
<p><span style="color: #000000;">As result suricata with NIDS mode had capture only 3 ICMP packets from <strong>IP 192.168.1.102</strong> which you can observe from given below image that generated alert for “ICMP Detected”, this happens because in above rule we had applied “<strong>-&gt;</strong>”one-directional operators which mean it will only capture traffic coming from source IP to destination IP.</span></p>
<p><span style="color: #000000;">Here you can perceive that both two packets of ICMP is coming from 192.168.1.102 to 192.168.1.111 which means it has only captured ICMP Echo-request packets form source IP. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-3cHQ8eWfsb0/WljjJ4Fq-cI/AAAAAAAATQA/T7Hixyik-pcwoE8o0Mg_MxgNmALkzA4agCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Mohit Chauhan is a technical writer at hacking articles and cyber security enthusiast. Contact</span> <a href="https://www.linkedin.com/in/mohit-chauhan-149013137/"><strong>Here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
