<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Android Pentest: Deep Link Exploitation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/android-pentest-deep-link-exploitation/" rel="bookmark"><time class="entry-date published" datetime="2021-01-24T16:31:33+00:00">January 24, 2021</time><time class="updated" datetime="2025-06-04T16:53:39+00:00">June 4, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-7 ai-optimize-introduction"><span style="color: #000000;">In many situations, an application must work with web-based URLs to build and transfer session IDs, authenticate users using OAuth login, and handle other test cases. In these situations, developers set up deep links, also known as bespoke URL schemas, which instruct the program to open a certain kind of URL within the program itself. Only Android versions 6.0 and higher can use this. An Android Manifest file defines the intent filter to accept URIs with example.com as the host and http:// as the URL protocol:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;intent-filter android:label="@string/filter_view_http_gizmos"&gt;
&lt;action android:name="android.intent.action.VIEW" /&gt;
&lt;category android:name="android.intent.category.DEFAULT" /&gt;
&lt;category android:name="android.intent.category.BROWSABLE" /&gt;
&lt;!-- Accepts URIs that begin with "http://www.example.com/gizmos” --&gt;
&lt;data android:scheme="http"
android:host="www.example.com"
android:pathPrefix="/gizmos" /&gt;
&lt;!-- note that the leading "/" is required for pathPrefix--&gt;
&lt;/intent-filter&gt;</pre>
<p class="ai-optimize-8"><span style="color: #000000;">Pay focus to <strong>data android:scheme=”http”</strong> and <strong>android:host=”&lt;domain&gt;”</strong></span></p>
<p class="ai-optimize-9"><span style="color: #000000;">Similarly, the intent filter to define a custom scheme (eg: to open URLs that open with <strong>example://gizmos.com</strong>) is as follows:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;intent-filter android:label="@string/filter_view_example_gizmos"&gt;
&lt;action android:name="android.intent.action.VIEW" /&gt;
&lt;category android:name="android.intent.category.DEFAULT" /&gt;
&lt;category android:name="android.intent.category.BROWSABLE" /&gt;
&lt;!-- Accepts URIs that begin with "example://gizmos” --&gt;
&lt;data android:scheme="example"
android:host="gizmos" /&gt;
&lt;/intent-filter&gt;</pre>
<p class="ai-optimize-10"><span style="color: #000000;">In this article, we’ll be looking at how an attacker can exploit poor implementation of URL schemas to conduct various attacks.</span></p>
<h3 class="ai-optimize-11"><span style="color: #800000;">Where can it go wrong?</span></h3>
<p class="ai-optimize-12"><span style="color: #000000;">Oftentimes developers use deep links to pass sensitive data from a web URL to an application like usernames, passwords, and session Ids. An attacker can create an application that fires off an intent and exploit this custom URL scheme (deep link) to perform attacks like:</span></p>
<ul>
<li class="ai-optimize-13"><span style="color: #000000;">Sensitive data exposure</span></li>
<li class="ai-optimize-14"><span style="color: #000000;">Session hijacking</span></li>
<li class="ai-optimize-15"><span style="color: #000000;">Account takeovers</span></li>
<li class="ai-optimize-16"><span style="color: #000000;">Open redirect</span></li>
<li class="ai-optimize-17"><span style="color: #000000;">LFI</span></li>
<li class="ai-optimize-18"><span style="color: #000000;">XSS using WebView implementation of a Deep Link</span></li>
</ul>
<p class="ai-optimize-19"><span style="color: #000000;">For example, a poor implementation would be: <strong>example://api.example.com/v1/users/sessionId=12345</strong></span></p>
<p class="ai-optimize-20"><span style="color: #000000;">Here, One can change the session ID to 12346 or 12347, and in the application, that particular user’s session would open as to which that session ID corresponds. This Url could be obtained while traffic analysis and a rogue application/HTML phishing page could trigger that activity and perform account takeover.</span></p>
<p class="ai-optimize-21"><span style="color: #000000;">Let’s see a basic real-time demonstration of exploiting deep links using drozer.</span></p>
<h3 class="ai-optimize-22"><span style="color: #800000;">Demonstration</span></h3>
<p class="ai-optimize-23"><span style="color: #000000;">I have coded this small application that I initially built to demonstrate android hooking and added a deep link scheme to call this activity. To download this app follow <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/harshitrajpal/Vulnerable-DeepLinkActivity">here</a></strong></span>. Ideally, you must decompile this app and figure out what the URL scheme is from the Manifest file. Here is how the application looks like. Read the instructions given in the screenshot.</span></p>
<p class="ai-optimize-24"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UG5dilF2YlI/YA2bNkzesPI/AAAAAAAAtIo/GYe_KSuKYvI7iAhQnhDVj6KvJgwavROtQCLcBGAsYHQ/s16000/1.png"/></span></p>
<p class="ai-optimize-25"><span style="color: #000000;">Then, you’ll notice that you won’t be able to open the activity directly using the button below. Hence, we’ll have to exploit deeplink to launch the activity.</span></p>
<h4 class="ai-optimize-74"><span style="color: #000000;">Analyzing the Application Manifest</span></h4>
<p class="ai-optimize-26"><span style="color: #000000;">The first step here would be to view the manifest file and check which URL scheme is being used. For that, I run the following drozer command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">run app.package.manifest in.harshitrajpal.deeplinkexample</pre>
<p class="ai-optimize-27"><span style="color: #000000;">Note here, the <strong>&lt;data scheme=””&gt;</strong> has a value <strong>“noob” </strong>so maybe we can fire an intent with a data URL containing a URL of this scheme so that it launches this activity?</span></p>
<p class="ai-optimize-28"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-z7ggn71-SyQ/YA2bYOb3THI/AAAAAAAAtIs/fzuLslukVDw84526RqO7CxVLIHT-7TcCQCLcBGAsYHQ/s16000/2.png"/></span></p>
<p class="ai-optimize-29"><span style="color: #000000;">Note: It is to be noted that any activity that is declared under an intent filter is by default exported and hence can be called via a rogue app that fires off that particular intent. Developers must also be very mindful of the fact that mere URL authentication is not sufficient due to this fact.</span></p>
<p class="ai-optimize-30"><span style="color: #000000;">To view exported activities:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">run app.activity.info -a in.harshitrajpal.deeplinkexample</pre>
<p class="ai-optimize-31"><span style="color: #000000;">We see DeepLinkActivity being used here.</span></p>
<p class="ai-optimize-32"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NlWfFukUAb4/YA2bf6B1B2I/AAAAAAAAtI0/3u61MbBpbZgxvA-VMIHoOZjVt7LNzAVGgCLcBGAsYHQ/s16000/3.png"/></span></p>
<h4 class="ai-optimize-75"><span style="color: #000000;">Exploiting Deep Links</span></h4>
<p class="ai-optimize-33"><span style="color: #000000;">We can launch this activity using our DeepLink exploitation technique. On exploring its source code we see that it is accepting data URL with an intent to perform some action. This action could be authentication, webviews, etc. But for the purpose of demonstration, I have coded a simple 10+50 sum calculator (that we saw in the android hooking article)</span></p>
<p class="ai-optimize-34"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jQybJ1nRFso/YA2blv6LlsI/AAAAAAAAtI4/3_xW_lmBCIYdroFpOBMb02hriGcixXHMgCLcBGAsYHQ/s16000/4.png"/></span></p>
<p class="ai-optimize-35"><span style="color: #000000;">First, let’s see what happens when we open a generic URL:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">run app.activity.start --action android.intent.action.VIEW --data-url http://google.com</pre>
<p class="ai-optimize-36"><span style="color: #000000;">As visible, the intent is fired up in a browser.</span></p>
<p class="ai-optimize-37"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PN_rMgh2OcM/YA2br6AO2rI/AAAAAAAAtJA/rO8X98eN6UYGQB8KeIClLeBAm1aBOUSWQCLcBGAsYHQ/s16000/5.png"/></span></p>
<p class="ai-optimize-38"><span style="color: #000000;">Now, let’s form another query in drozer that’ll fire up DeepLinkActivity.java in our application using deeplink.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">run app.activity.start --action android.intent.action.VIEW –data-uri noob://harshit.com/auth=sum</pre>
<p class="ai-optimize-39"><span style="color: #000000;">This is a random URL that doesn’t mean anything and doesn’t perform any action. I’ve just demonstrated that an authentication action can be performed using deep links like this.</span></p>
<p class="ai-optimize-40"><span style="color: #000000;">As you can see, this URL has fired up the application class that I had created. This is because Android Manifest has directed the android system to redirect any URL that begins with the scheme <strong>“noob://”</strong> to open up with my application DeepLinkExample</span></p>
<p class="ai-optimize-41"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-P41WSEiGUGs/YA2bxAsjnGI/AAAAAAAAtJI/ls1vlZKYu6cB8bAvMjWVc8usftx0RyfQwCLcBGAsYHQ/s16000/6.png"/></span></p>
<h4 class="ai-optimize-76"><span style="color: #000000;">Creating Phishing Scenarios</span></h4>
<p class="ai-optimize-42"><span style="color: #000000;">Now, an attacker could host a phishing page with <strong>“a href”</strong> tag that contains a URL of this scheme, sends this page to a victim via social engineering, he could steal his session ID using this. In the screenshot below you can see one such URL that I’ve crafted to steal session key from the DeepLinkExample app using noob:// scheme.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;html&gt;
&lt;body&gt;
&lt;a href="noob://hello.com/yolo?=auth&amp;session=exampleKey"&gt;click here to exploit&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
<p class="ai-optimize-43"><span style="color: #000000;">Let’s host this using our python server</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 -m http.server 80</pre>
<p class="ai-optimize-44"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vqn7HHNIkXI/YA2b11A_q0I/AAAAAAAAtJM/M6vqg9YaVVQDTqXClnTPkbuKLHbBUGuNQCLcBGAsYHQ/s16000/7.png"/></span></p>
<p class="ai-optimize-45"><span style="color: #000000;">Let’s open this HTML link on our mobile browser. We see something like this:</span></p>
<p class="ai-optimize-46"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-St_CVJjTrY4/YA2b-0T119I/AAAAAAAAtJQ/G7j6ApV1m4YhkSRKJ_x6m8zKreq9RoDBgCLcBGAsYHQ/s16000/8.png"/></span></p>
<p class="ai-optimize-47"><span style="color: #000000;">On clicking this link our application opens successfully!</span></p>
<p class="ai-optimize-48"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lc18pLnK-hs/YA2cEDPvZvI/AAAAAAAAtJY/TeCvnvoOo1kbnQCE6XUc6ASpYDbDvovOgCLcBGAsYHQ/s16000/9.png"/></span></p>
<p class="ai-optimize-49"><span style="color: #000000;">Then, let’s see another intentionally vulnerable application called InjuredAndroid created by b3nac (Follow <u><a style="color: #000000;" href="https://github.com/B3nac/InjuredAndroid">here</a></u>). This application also has a vulnerable Deep Link activity. Since it is in intent filter, it is exported by default. Hence, we can launch this activity directly using Drozer.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">run app.activity.info -a b3nac.injuredandroid</pre>
<p class="ai-optimize-50"><span style="color: #000000;">We see DeepLinkActivity is exported. We try to call it using drozer</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">run app.activity.start --component b3nac.injuredandroid b3nac.injuredandroid.DeepLinkActivity</pre>
<p class="ai-optimize-51"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wwKXzCQgOHU/YA2cKfZnYxI/AAAAAAAAtJc/IHF3YUhCi78cQF8FYGdw0wmmzj9ZzbHUgCLcBGAsYHQ/s16000/10.png"/></span></p>
<p class="ai-optimize-52"><span style="color: #000000;">Then, take a look at its manifest file to discover the scheme that’s being used.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">run app.package.maifest in.harshitrajpal.deeplinkexample</pre>
<p class="ai-optimize-53"><span style="color: #000000;">Here, we see the<strong> flag11</strong> scheme being used in DeepLinkActivity.</span></p>
<p class="ai-optimize-54"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--CIMo7epGmE/YA2cQTxiJiI/AAAAAAAAtJg/EpWssLKEtTgRosb3mbIh_v6ImdYi8pN8ACLcBGAsYHQ/s16000/11.png"/></span></p>
<p class="ai-optimize-55"><span style="color: #000000;">Then, to open this activity using this custom URL scheme, we can do something like:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">run app.activity.start --action android.intent.action.VIEW --data-uri flag11://abc.com</pre>
<p class="ai-optimize-56"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-s-B4bziDLsg/YA2cUsinApI/AAAAAAAAtJo/se026dZG0S8-0TBP2aVHG9kW-msceXxIwCLcBGAsYHQ/s16000/12.png"/></span></p>
<p class="ai-optimize-57"><span style="color: #000000;">Alternatively, it can also be exploited using an HTML phishing page and social engineering attack:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;html&gt;
&lt;body&gt;
&lt;a href="flag11://hello.com/yolo?=auth&amp;session=exampleKey"&gt;click here to exploit&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;
python3 -m http.server 80</pre>
<p class="ai-optimize-58"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KpSXg59hP8s/YA2cangnODI/AAAAAAAAtJs/wwLMlNLhQpgx1IBbBAjVJa25Vt9v84z_gCLcBGAsYHQ/s16000/13.png"/></span></p>
<p class="ai-optimize-59"><span style="color: #000000;">Finally, clicking on this link in a browser, we see that DeepLinkActivity successfully opens up!</span></p>
<p class="ai-optimize-60"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OCyUfafPRGs/YA2cf8wXv6I/AAAAAAAAtJ0/Zp0_cp93hN4WsPVesAr7qkXGzf94qQjzwCLcBGAsYHQ/s16000/14.png"/></span></p>
<h5 class="ai-optimize-61"><strong><span style="color: #000000;">How to avoid the misuse of insecure deep link implementation</span></strong></h5>
<p class="ai-optimize-62"><span style="color: #000000;">The measures are as follows: –</span></p>
<ul>
<li class="ai-optimize-63"><span style="color: #000000;">Since the app configures deep links, a developer could communicate a secret value to the app through a remote back-end server over a secure transmission protocol.</span></li>
<li class="ai-optimize-64"><span style="color: #000000;">A developer can set android:autoVerify=”true” in the manifest file to verify Deep Links as App Links.</span></li>
<li class="ai-optimize-65"><span style="color: #000000;">You can include a JSON file named assetlinks.json in your web server that the web URL intent filter describes.</span></li>
</ul>
<h3 class="ai-optimize-66"><span style="color: #800000;">Conclusion</span></h3>
<p class="ai-optimize-67"><span style="color: #000000;">Overall, the article taught us how to take advantage of deep links to eventually do significant harm. <span style="box-sizing: border-box; margin: 0px; padding: 0px;">A</span> deep link can be the ideal butterfly effect that creates numerous serious vulnerabilities in a well-designed application. Furthermore, you can find some real-time bug bounty reports that include deep link misuse in the references below. Thank you for reading.</span></p>
<h3 class="ai-optimize-68"><span style="color: #800000;">References</span></h3>
<p class="ai-optimize-69"><span style="color: #0000ff;"><strong><u><a style="color: #0000ff;" href="https://hackerone.com/reports/401793">https://hackerone.com/reports/401793</a></u>        </strong></span></p>
<p class="ai-optimize-70"><span style="color: #0000ff;"><strong><u><a style="color: #0000ff;" href="https://hackerone.com/reports/583987">https://hackerone.com/reports/583987</a></u>        </strong></span></p>
<p class="ai-optimize-71"><span style="color: #0000ff;"><strong><u><a style="color: #0000ff;" href="https://hackerone.com/reports/855618">https://hackerone.com/reports/855618</a></u></strong></span></p>
<p class="ai-optimize-72"><span style="color: #0000ff;"><strong><u><a style="color: #0000ff;" href="https://www.nowsecure.com/blog/2019/04/05/how-to-guard-against-mobile-app-deep-link-abuse/">https://www.nowsecure.com/blog/2019/04/05/how-to-guard-against-mobile-app-deep-link-abuse/</a></u></strong></span></p>
<p class="ai-optimize-73"><span style="color: #000000;"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and left and right brain thinker. Contact</span><strong> <a class="broken_link" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
<!-- YARPP Thumbnails -->
<h3>Related posts:</h3>
<div class="yarpp-thumbnails-horizontal">
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/msfvenom-cheatsheet-windows-exploitation/" title="Msfvenom Cheatsheet: Windows Exploitation">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">Msfvenom Cheatsheet: Windows Exploitation</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/ad-certificate-exploitation-esc1/" title="AD Certificate Exploitation: ESC1">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">AD Certificate Exploitation: ESC1</span></a>
</div>
</div>
            </div><!-- .entry-content -->
            <footer class="post-footer entry-footer">
                                                
            </footer><!-- .entry-footer -->
            
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://www.hackingarticles.in/exploiting-stored-cross-site-scripting-at-tenda-ac5-ac1200/" rel="prev">Exploiting Stored Cross-Site Scripting at Tenda AC5 AC1200</a></div><div class="nav-next"><a href="https://www.hackingarticles.in/comprehensive-guide-on-dirsearch/" rel="next">Comprehensive Guide on Dirsearch</a></div></div>
	</nav>        </div>
