<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Presidential: 1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/presidential-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-07-23T19:38:02+00:00">July 23, 2020</time><time class="updated" datetime="2025-06-10T20:10:19+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another boot2root challenge called “Presidential – 1”.  It’s available at VulnHub for penetration testing and you can download it from<span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/presidential-1,500/"> here</a></strong></span>.</span></p>
<p><span style="color: #000000;">The credit for making this lab goes to<strong> Thomas Williams</strong>. Let’s get started and learn how to successfully break it down.</span></p>
<p><span style="color: #000000;">Level: <strong>Hard</strong></span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<p><span style="color: #000000;"><strong>Recognition</strong></span></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Gobuster</span></li>
<li><span style="color: #000000;">Forgotten backup files</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">John The Ripper</span></li>
<li><span style="color: #000000;"> RCE via LFI from phpMyAdmin</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Abuse of Linux Capabilities</span></li>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #000000;"><strong>Recognition</strong></span></h3>
<p><span style="color: #000000;">We are looking for the machine with netdiscover</span></p>
<pre class="lang:default decode:true"> netdiscover -i ethX</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Cdr6lHVrKhc/XxnkgvjI5vI/AAAAAAAAmO8/6Arpe6miwHYxWF0bhWlH8D19KjBuEn_1wCLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">So, let’s start by running map to all ports with OS detection, software versions, scripts and traceroute.</span></p>
<pre class="lang:default decode:true">nmap -A -p- 192.168.10.172</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oKzojeUR428/XxnkksdAqvI/AAAAAAAAmPA/l36P_x-KucM755d_-Fq-gLOAjsxzqfvgwCLcBGAsYHQ/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">We entered the web service and visited the different sections and found an email with the domain name.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NvEQNabZ-dw/XxnkqJHUNkI/AAAAAAAAmPE/xNR0U4pWeGcfUX16Olwknj3gwDl7qV7-gCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We edit the file “<strong>/etc/hosts</strong>” and associate the IP address with the domain found.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QXb5CVia43E/XxnkvMn2FDI/AAAAAAAAmPI/1-jR4o6glRIFpRCb5AGtO8Dusr8BxONBgCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We start<strong> Gobuster</strong> and configure it to find files by specific extensions.  </span></p>
<p><span style="color: #000000;">We find a file called “<strong>config.php.bak</strong>“, these files usually contain database access credentials.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tkYETGRo4_8/XxnkzrAhQbI/AAAAAAAAmPQ/H2wk8TgzcL4QtZ1Ptk_QsNrt2Vmww3eSQCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">File content “<strong>config.php.bak</strong>“:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-c2UOko7bVFY/Xxnk6z_US4I/AAAAAAAAmPg/a26MlO6hGdUAEfOMlohgbO3h6RCIzm5PQCLcBGAsYHQ/s1600/6.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">Back to<strong> Gobuster</strong>, this time we’ll pass a “<span style="color: #0000ff;"><strong><u>medium directory</u>“</strong></span> dictionary with the “<strong>vhost</strong>” option, this way we’ll list sub-domains.</span></p>
<p><span style="color: #000000;">We’ll get a single result:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ua-3ZwHzK1s/Xxnk_HHIHmI/AAAAAAAAmPo/B7wc_vQuB8oGY7RbfH8lEnBmHOd4EYBsACLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">We access the address of the subdomain, find an access panel to “<strong>phpMyAdmin</strong>“, insert the credentials obtained in the previous file and find the password of the user “<strong>admin</strong>“. It is likely that the user will reuse the same credential for other corporate services.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wu1zjsFu8Xc/XxnlDoiskMI/AAAAAAAAmPw/JaUVyuIO7Vk2DJ8aA0LqGRqnbnq8vFXUACLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">We saved the hash in a file and cracked it with<strong> John The Ripper</strong> and the famous “<strong>rockyou</strong>” dictionary.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YM-9cGBue8I/XxnlH8ArTOI/AAAAAAAAmP0/nO6suYv7h0IchUgda_8R8acRyck00zw-gCLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">The next step will be to list the version of “<strong>phpMyAdmin</strong>” and find some exploit that can serve to gain access to the interior of the machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bCjZKJ8RT80/XxnlMQKWXbI/AAAAAAAAmP8/pFqegswSMxcftrO97P3KxTQzvjaIBe3FACLcBGAsYHQ/s1600/10.png"/></span></p>
<p><span style="color: #000000;">We found this<strong><a style="color: #000000;" href="https://www.exploit-db.com/exploits/44928"> exploit</a></strong> that allows us to execute commands from a SQL statement and embedding a file (<strong>LFI</strong>) with our session cookie.</span></p>
<p><span style="color: #000000;">We make a test by executing a phpinfo() as a proof of concept.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1wuLZdSCRyE/XxnlQxLFQPI/AAAAAAAAmQE/KsAMhB9kI0cKiH-2HRa_9lCAdC85MXKlgCLcBGAsYHQ/s1600/11.png"/></span></p>
<h3><span style="color: #800000;"><strong>Result PoC:</strong></span></h3>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-A4wRtVVe8QY/XxnlVCtvtII/AAAAAAAAmQI/4X6yDSxJu-IWow0gaYXlLRgGbA6fxJc8gCLcBGAsYHQ/s1600/12.png"/></span></p>
<p><span style="color: #000000;">It works! It’s time to complicate it, we will create a file called “<strong>m3n0shell.sh</strong>” with a reverse shell, we will raise a server with Python and we will execute a sequence of three commands so that it downloads it, gives it execution permissions and executes it.</span></p>
<p><span style="color: #000000;">And don’t forget to have a netcat listening to port <strong>4444</strong>!!!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-esBqbiKTEnc/XxnlZtkR8aI/AAAAAAAAmQM/DVQYmNiFJmU_zN5V_vY7xBx6_DeQUzufwCLcBGAsYHQ/s1600/13.png"/></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-y7oYdD39y_o/XxnlmLViJOI/AAAAAAAAmQg/aaEeXrveI24sV4JZzd8dLBXG7o0X_ZJAQCLcBGAsYHQ/s1600/14.png"/></span></p>
<p><span style="color: #000000;">If all goes well, we’ll have a reverse shell. We authenticate ourselves with the credentials of the user “<strong>admin</strong>“, we use Python to get an interactive shell, we read the flag of “<strong>user.txt</strong>” and the file “<strong>notes.txt</strong>”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aKFKhmmqEq4/XxnlpypxCwI/AAAAAAAAmQo/l3lVvkMGr5w4f6qJGUq436HvnXoMK9n-QCLcBGAsYHQ/s1600/15.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation (root)</strong></span></h3>
<p><span style="color: #000000;">We list the available capabilities, we see that we have “<strong>+EP</strong>” to the tarS binary. This binary allows us to compress any file on the system without being root. Therefore, once we have it compressed, we will only have to decompress it to be able to read the content of the file.</span></p>
<p><span style="color: #000000;">Having said this, we can now compress the file “<strong>id_rsa</strong>“, decompress it and we will be able to obtain visibility to the content.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vvAnEMTU9VQ/XxnludT8QOI/AAAAAAAAmQs/YhWIhJYCwVYXQ-oYiA-QRDFE8Mc7YOWPACLcBGAsYHQ/s1600/16.png"/></span></p>
<p><span style="color: #000000;">We copy the content of “<strong>id_rsa</strong>“, give it permissions and connect as the “<strong>root</strong>” user through the SSH service.</span></p>
<p><span style="color: #000000;">Once inside, we can read the flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UWa6YtBYDmY/Xxnlx0MC3cI/AAAAAAAAmQw/h2g4A4IyR3gSzCbDdOgRhb-xsMzWKnBSgCLcBGAsYHQ/s1600/17.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>David Utón</strong> is Penetration Tester and security auditor for Web applications, perimeter networks, internal and industrial corporate infrastructures, and wireless networks.  Contacted on<strong> LinkedIn</strong> and <strong><a style="color: #000000;" href="https://twitter.com/David_Uton">Twitter</a></strong>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
