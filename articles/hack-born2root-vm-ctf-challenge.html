<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Born2Root VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-born2root-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-11-13T16:26:13+00:00">November 13, 2017</time><time class="updated" datetime="2025-06-10T20:29:58+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF challenge known as Born2Root. The credit for making this vm machine goes to “Hadi Mene” and it is another boot2root challenge where we have to root the server to complete the challenge. You can download this VM <a href="https://www.vulnhub.com/entry/born2root-1,197/#download"><strong>here</strong></a>.</span></p>
<p><span style="color: #000000;"><strong>Let’s Breach!!!</strong></span></p>
<p><span style="color: #000000;">Let us start form getting to know the IP of VM (Here, I have it at <strong>192.168.1.137 </strong>but you will have to find your own)</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ej1MkGwFjeM/WgnBMTmgyaI/AAAAAAAASUk/XzBs6VPWWYQ8HaSaEDgqjvAlYfTQCwOhACEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Use nmap for port enumeration.</span></p>
<pre class="lang:default decode:true">nmap -sV 192.168.1.137</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-CwL1ENS8kbo/WgnBNmdmHFI/AAAAAAAASUk/K4Rg9IDSNsIKSI72VWW1xKg0dFreiP4HwCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Nmap scan shows us port 80 is open, so we open the ip address in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VSqHJT5zboE/WgnBOBFU3aI/AAAAAAAASUk/gm_3YhwuZgwzZqlcCclzpEhWvYpEteaGACEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We don’t find anything on the web page. So we use dirb to find the directories for more information.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.137</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-j47BGIVTdx0/WgnBOulXinI/AAAAAAAASUw/P5yqGlo5UyIYqbWkXEkhdj_78BvwJiEfACEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Now the dirb scan shows us directories. We open the icons/ directory and find a few files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-abl7lwRT2-E/WgnBOpVfjuI/AAAAAAAASUk/YKQm-57uVf0g9LDq1oC3enXAMpoyXp0ywCEwYBhgL/s1600/5.1.png"/></span></p>
<p><span style="color: #000000;">Among the files, there is a text file we open it and find a private key.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-gUpxzOGsryA/WgnBPYk4OPI/AAAAAAAASUo/NiDY_zd9CAUvqOvBPHEF2hDTPMl2kFhRgCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We use this key to log in through ssh to the target machine we use the names we find on the page we first opened. First, we change the permissions of the private key. Then we use it to connect through ssh.</span></p>
<pre class="lang:default decode:true">chmod 600 id_rsa
ssh -i id_rsa martin@192.168.1.137</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Uii2MwA4aKM/WgnBPdq01JI/AAAAAAAASUw/T9Zkt-THURw4mC2naZhIGC1IbsXBIOToQCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">When we connect it will ask for password just press enter, it is there for trolling.</span></p>
<p><span style="color: #000000;">Searching through the files we take a look at cron job.</span></p>
<pre class="lang:default decode:true">cat /etc/crontab</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-9VrMyh9gM7g/WgnBP6eZ-_I/AAAAAAAASUo/htx5SYhzoKEc1jQhQqytVIuE0rJTAVjOwCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">We find that a file to called <strong>sekurity.py</strong> in the <strong>/tmp/</strong> is to be executed every 5 minutes. But the file is missing from the folder. So we create a reverse shell of our own and save it as <strong>sekurity.py</strong> in the<strong> /tmp/</strong> folder.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-npf-letDvLQ/WgnBQJZNMPI/AAAAAAAASUo/VT2QdelSGtgoTlrDulJnvdN0ZkWnb_HDwCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now we set up our listener using netcat and wait for the cronjob to execute our file. Once the file is executed we get our reverse shell as a different user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-KjIXwBKEwsU/WgnBQAgo7_I/AAAAAAAASUk/nthHP0T4nRAmnYqmopi3FmznoGbPIlg4wCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">We couldn’t find anything that could help us root the machine. Now we use the third the user to root the machine. We know that the third user is hadi. So we create a dictionary using this name.</span></p>
<p><span style="color: #000000;">We use cupp to create a dictionary.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-qUv9jZGOp08/WgnBMRWLliI/AAAAAAAASUo/ekcTA1QpfFgOKP7iwGXMjf9EvFr5Vgn2wCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">After we create a dictionary we use metasploit to bruteforce our way into ssh.</span></p>
<pre class="lang:default decode:true">msf &gt; use auxiliary/scanner/ssh/ssh_login
msf auxiliary(ssh_login) &gt; set rhosts 192.168.1.137
msf auxiliary(ssh_login) &gt; set username hadi
msf auxiliary(ssh_login) &gt; set pass_file hadi.txt
msf auxiliary(ssh_login) &gt; run</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-P92WuFhMlOs/WgnBMeccFlI/AAAAAAAASUw/61jXTlcJ6VMGpWODDnM_zrf5dxTOY61eQCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now once we enter the shell we spawn the terminal and use hadi’s password (‘hadi123’) to enter the root shell.</span></p>
<pre class="lang:default decode:true">python -c "import pty; pty.spawn('/bin/bash')"
su root</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-IKPrVNDAkDI/WgnBNWg1n9I/AAAAAAAASUw/QntIkITBUg4WefqM5qGHa7r1JxUDA9VTwCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Now that we are root we open the flag.txt and find a congratulatory message for completing the VM challenge.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-yE2bgtZgqlc/WgnBNaMMYCI/AAAAAAAASUo/X2-umIFpEA4Z3GqSysgSOSAaxOsiyotYACEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cybersecurity enthusiast. Contact <a href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
