<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Windows Privilege Escalation: Insecure GUI Application</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/windows-privilege-escalation-insecure-gui-application/" rel="bookmark"><time class="entry-date published" datetime="2021-10-14T19:24:52+00:00">October 14, 2021</time><time class="updated" datetime="2025-07-29T07:09:08+00:00">July 29, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In the series of Privilege escalation, till now we have learned that Microsoft Windows offers a wide range of fine-grained permissions and privileges for controlling access to Windows components including services, files, and registry entries. Today through applications we are going to exploit the privileges. Many GUI applications need higher privileges other than the current user to have, to access some of their particular services. Secondly, just due to misconfiguration of the application. Let’s deep dive into it.</span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<ul>
<li><span style="color: #000000;">Introduction</span></li>
<li><span style="color: #000000;">Prerequisites</span></li>
<li><span style="color: #000000;">Lab setup of insecure GUI Application</span></li>
<li><span style="color: #000000;">Abusing Insecure GUI Application</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Prerequisites:</strong></span></h3>
<p><span style="color: #000000;">Machine A-Window 10 (Ignite as an admin user)</span></p>
<p><span style="color: #000000;">Notepad++ Installed application on window 10</span></p>
<h3><span style="color: #800000;"><strong>Lab Setup of Insecure GUI Application</strong></span></h3>
<p><span style="color: #000000;">Machine A, has ignite as an admin user.</span></p>
<p><span style="color: #000000;">Now, by the whoami /priv command, we get to know that “Ignite “an admin user has only 5 privileges of shut down, change notification etc. with the enable and disable state which is displayed in the below screenshot</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">whoami /priv</pre>
<p><span style="color: #000000;">We have to understand that if any user has admin access even though that user does not have full or higher privileges.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEg1kBaLUqGqnhG8TqvZGp7y5KXOWbfKfqJ2_oorW9ZAs3wQbHHuOTvVqFVORNWcD5DO1mkAbbijdCB-hNpNyhShRhyTv5oiaqlFJZfBK1BmhQtgJj5XNzbZpBXoahyOrL-0IKnoghvPmLqRbeM-g9HxlRF4cnSNPxlbIxzbGHkXWkmWbc9yXnURdkN3bA=s16000"/></span></p>
<p><span style="color: #000000;">Now we will check the ignite admin user’s privileges by adding a new user “demo”. Unfortunately, access is denied. It means “ignite” user does not have full higher privileges.</span></p>
<p><span style="color: #000000;">Install Notepad++ on window 10 and misconfigure the application or insecure it by providing the run as administrator.</span></p>
<p><span style="color: #000000;">Right-click on the<strong> Notepad++</strong> icon and click on the properties to edit <strong>advance</strong> settings.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEga64wQeJAMqpQjiI-2u5fd9bahjuXsHRGlZ2dJSE99kIMshNPZlsPAV83h6YUWXQDhV3MtqZHyzcbf8cDZqb0qibwKbbBs944wvwogDy5mAkbOVO6aLsD4gSKThLEvbCJELd29fKJUC34V4TNnQXRCX9B6XQt5BJcCRZ28n9cjNwwxY4T6Pq9A2GHRnA=s16000"/></span></p>
<p><span style="color: #000000;">Edit the Notepad++ properties just by click on advanced and then ok, by default it will display some of the information of Notepad++ properties as mentioned in the following screenshot.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgf2YJe_NJBZWbGCeAYQkluMk-Cp7Qd2478K1s95isdut4fvXKu3LM-uhtOTL_3FVHSGeWzVlOwqMpAuRexH-M0BLrsa-OesT5NCQgja6-9eHN02Q_1U4RFmWSXfMNgNK1vXG-BM1ETM7OY0ZnNkW34mUvmMUdoISXgzNQE_ocWcEUHOUAv0BN10_khyQ=s16000"/></span></p>
<p><span style="color: #000000;">In the next window of advanced properties, there is an option to run the application as an administrator. Just tick the option and click on OK. Now whenever we will execute the Notepad++ automatically it will run as administrator.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhALAbpoT_SwA8mu7gnIo51B2LISqeQoS6zfqhL0nj2Pd5i-QqUA-15vdNl7pTR7XAvmfSUI0lvzu2Jo46gKGntSTIPZ8sCHTNnb5bIx1dOOGsmWp8Ps5dKfpsOBE_H4p_LWUkH5WJWzeqs-_A0qTqIqPqGdxDgXQy2VF0xWtlAD4e_mdrKX-JJkNSkvw=s16000"/></span></p>
<h3><span style="color: #800000;"><strong>Abusing Insecure GUI Application</strong></span></h3>
<p><span style="color: #000000;">After enumerate some time on windows applications, we found that the Notepad++ application has a feature that allows us to open the file, the short key to open the file is CTRL+O or by navigating to the option File then go to open.</span></p>
<p><span style="color: #000000;"><strong>Note</strong>: In lab set up we had already granted permission to run as administrator, whenever we execute the Notepad++.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhz-Zw62R1XP97JN1QSG8iIRwlfIvln800hNva66zuuGhn1jggzevQwHzYxXchizdTzOYgpJRlQaSx8Zxfwx-tUTaZRAxCihvvkvQmNWbJZu0nfGG4PzSG65uon5zHkYLQRIF4tq9t8cW3-XUNhnizJ-wldBzKC7ZUXepoT334ecr6tNlRfc5imp0dgNg=s16000"/></span></p>
<p><span style="color: #000000;">The next open prompt will allow us to run a binary with the same privilege escalation same as the Notepad++ process.</span></p>
<p><span style="color: #000000;">Just by entering the cmd exe in the navigating bar, it will open a command prompt.</span></p>
<p><span style="color: #000000;">Now, the Command prompt will open with the Notepad++‘s administrator privileges. The following command will display all the privileges names, descriptions and enabled and disabled features</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">whoami /priv</pre>
<p><span style="color: #000000;">If it will allow operations like to open a command prompt or to run executable with the high privileges then it will allow escalating the privileges.</span></p>
<p><span style="color: #000000;">This demonstrates that admin user “ignite” does not have the same privileges as the Notepad++ application that runs as an administrator. Just compare the first and last screenshots for a better understanding. We will characterize this as privilege escalation even though we can now add any new user through the command line. Finally, demo user is successfully added and take the advantage of insecure GUI application to exploit the privileges.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhWTfxBvnnJ2Y5KLV5tXMh1FOBjt31NPXUADWYqv6L367xV66-o-6UniKnU_2sVZ4OONBhWawyO67FIi7fmgHWGYg6yBJSMGg2mjc_qJRqYFlDua8nlt4qLwIlfD0D7IWD1AzSyLN7K7R98CbbqrihnhGwBnnJrEctdWuX_JJ8UDyN5C7Nfy4-6jSQASA=s16000"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Nisha Sharma is an Experienced and Certified Security Consultant.Highly skilled in Infrastructure, web pentesting along SIEM and other security devices. Connect with her <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/nishasharmaa"><strong>here</strong></a></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
