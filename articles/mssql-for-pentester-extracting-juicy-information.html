<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ms-sql-penetration-testing/" rel="category tag">MS-SQL Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">MSSQL for Pentester: Extracting Juicy Information</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/mssql-for-pentester-extracting-juicy-information/" rel="bookmark"><time class="entry-date published" datetime="2021-10-06T22:12:35+00:00">October 6, 2021</time><time class="updated" datetime="2025-05-10T18:15:01+00:00">May 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this post, you will learn how will can extract sensitive sample information stored in the mssql by using powerupsql and mssql. In our <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/mssql-for-pentester-discovery/">previous</a> </strong></span>article, we have mention tools and techniques that can be used to enumerate MSSQL Instances.</span></p>
<h3><span style="color: #800000;"><strong>Table of Contents</strong></span></h3>
<p><strong><span style="color: #000000;">Lab setup</span></strong></p>
<p><strong><span style="color: #000000;">PowerupSQL</span></strong></p>
<ul>
<li><span style="color: #000000;">Extracting Database Name</span></li>
<li><span style="color: #000000;">Extracting Database Information</span></li>
<li><span style="color: #000000;">Extracting Database Login</span></li>
</ul>
<p><span style="color: #000000;">Metasploit</span></p>
<p><span style="color: #000000;"><strong>Lab Setup</strong></span></p>
<p><span style="color: #000000;">Follow the <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/penetration-testing-lab-setupms-sql/">article</a> </strong></span>for MSSQL Lab Setup and download PowerupSQL from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/NetSPI/PowerUpSQL">Github</a></strong></span>. <strong data-start="364" data-end="378">PowerUpSQL</strong> not only supports <strong data-start="397" data-end="421">SQL Server discovery</strong>, but also audits <strong data-start="439" data-end="461">weak configuration</strong>, escalates privileges on the scale, and performs <strong data-start="511" data-end="540">post-exploitation actions</strong> such as OS command execution.<br/>
</span></p>
<p><span style="color: #000000;">Therefore, to enumerate juicy information, let’s create a <strong data-start="630" data-end="642">database</strong>, <strong data-start="644" data-end="654">tables</strong>, and <strong data-start="660" data-end="671">records</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">create database bank;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--E81-nBeV_8/YV4dxA1sCxI/AAAAAAAAy0I/Ot8VnHWV1uUQ6XAIWzv9brQrS9LNubWMgCLcBGAsYHQ/s16000/1.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">CREATE TABLE Customers (
    CustomerID int,
    LastName varchar(255),
    FirstName varchar(255),
    passw varchar(255),
    creditcard varchar(255)
);</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vrHVL49ywaA/YV4d3FPS9-I/AAAAAAAAy0M/ccNrk6bKau0ki57EHv1WdIDRHkYjlMLLgCLcBGAsYHQ/s16000/2.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">INSERT INTO Customers(CustomerID, LastName, FirstName, passw, creditcard)
VALUES ('01', 'Technologies','Ignite', 'admin123', '1111-2222-3333-4444');

INSERT INTO Customers(CustomerID, LastName, FirstName, passw, creditcard)
VALUES ('02', 'Sharma','Nisha', 'admin1234', '5555-6666-7777-8888');

INSERT INTO Customers(CustomerID, LastName, FirstName, passw, creditcard)
VALUES ('03', 'Chandel','Raj', 'admin12345', '9999-1010-1020-1030');

INSERT INTO Customers(CustomerID, LastName, FirstName, passw, creditcard)
VALUES ('04', 'Madan','Geet', 'admin12311', '1234-5678-9012-3456');</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OiECt5whHz0/YV4d7iUXvDI/AAAAAAAAy0Q/gHSw2paa6R0iG-RkKZMFKl03Ix7qFepgwCLcBGAsYHQ/s16000/3.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Extracting Database Name</span> </strong></span></h3>
<p><span style="color: #000000;">You may use the command below to get a list of all SQL Server databases that are accessible.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Get-SQLDatabaseThreaded -Threads 10 -Username sa -Password Password@1 -Instance WIN-P83OS778EQK\SQLEXPRESS -verbose | select -ExpandProperty DatabaseName</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qlQbnO2Y_2I/YV4eAa2gDkI/AAAAAAAAy0U/Pv6a_wRJvAQTe3LZzUfb-g6pYhszHs1YwCLcBGAsYHQ/s16000/4.png"/></span></p>
<h3><span style="color: #800000;"><strong>Extracting Database Information</strong></span></h3>
<p><span style="color: #000000;">The script given below utilises that variable to search all available SQL Servers for database table column names containing the given keywords.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Get-SQLColumnSampleDataThreaded -Threads 10 -Keywords "password, credit" -SampleSize 5 -ValidateCC -NoDefaults -Username sa -Password Password@1 -Instance WIN-P83OS778EQK\SQLEXPRESS -Verbose</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-a4HzAFTjq4U/YV4eE3oVfnI/AAAAAAAAy0c/VK6MrabZBUAmUz57PZ9bY_njfhLPbyy1QCLcBGAsYHQ/s16000/6.png"/></span></p>
<h3><span style="color: #800000;"><strong>Extracting Database Login</strong></span></h3>
<p><span style="color: #000000;">This module will enumerate SQL Server Logins based on login id using SUSER_NAME() and only the Public role.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Import-Module .\PowerUpSQL
Get-SQLFuzzServerLogin -Username sa -Password Password@1 -Instance WIN-P83OS778EQK\SQLEXPRESS -verbose</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rWLP7h059Xo/YV4eJ5PMUtI/AAAAAAAAy0k/LoTNNlSh51wu1JAyLelSEUj1-ryb6K_YwCLcBGAsYHQ/s16000/7.png"/></span></p>
<h3><span style="color: #800000;"><strong>Metasploit</strong></span></h3>
<p><span style="color: #000000;">This script quickly searches through all of the non-default <strong data-start="734" data-end="747">databases</strong> on the <strong data-start="755" data-end="769">SQL Server</strong> for columns that match the keywords defined in the <strong data-start="821" data-end="838">TSQL KEYWORDS</strong> option. When the script finds matching column names and detects available data in the associated tables, it immediately selects a sample of the records from each of the affected tables. Moreover, the <strong data-start="1039" data-end="1054">sample size</strong> depends on the <strong data-start="1070" data-end="1085">SAMPLE_SIZE</strong> option and outputs the results in a <strong data-start="1122" data-end="1136">CSV format</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use auxiliary/admin/mssql/mssql_findandsampledata
set rhosts 192.168.1.146
set username Password@1
set  sample_size 4
set keywords FirstName|passw|credit
exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qVLW_SGCKc4/YV4eOvuvqfI/AAAAAAAAy0o/PCW69bURadUkuv65XPH8M9omE2d2PcQEACLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contac</span>t<strong><a href="https://www.linkedin.com/in/aarti--singh/"> <span style="color: #0000ff;">here</span></a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
