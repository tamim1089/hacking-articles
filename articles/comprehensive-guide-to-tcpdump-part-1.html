<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Comprehensive Guide to tcpdump (Part 1)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/comprehensive-guide-to-tcpdump-part-1/" rel="bookmark"><time class="entry-date published" datetime="2020-03-19T16:50:26+00:00">March 19, 2020</time><time class="updated" datetime="2025-06-06T09:20:32+00:00">June 6, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In this article, we are going to learn about tcpdump. It is a powerful command-line tool for network packet analysis. Tcpdump helps us troubleshoot the network issues as well as help us analyze the working of some security tools.</span></p>
<h3 class="ai-optimize-7"><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li class="ai-optimize-8"><span style="color: #000000;"><strong>Introduction</strong></span></li>
<li class="ai-optimize-9"><span style="color: #000000;"><strong>Available Options</strong></span></li>
<li class="ai-optimize-10"><span style="color: #000000;"><strong>List of interfaces</strong></span></li>
<li class="ai-optimize-11"><span style="color: #000000;"><strong>Default working</strong></span></li>
<li class="ai-optimize-12"><span style="color: #000000;"><strong>Capturing traffic of a particular interface</strong></span></li>
<li class="ai-optimize-13"><span style="color: #000000;"><strong>Packet count</strong></span></li>
<li class="ai-optimize-14"><span style="color: #000000;"><strong>Verbose mode</strong></span></li>
<li class="ai-optimize-15"><span style="color: #000000;"><strong>Printing each packet in ASCII</strong></span></li>
<li class="ai-optimize-16"><span style="color: #000000;"><strong>Don’t convert address</strong></span></li>
<li class="ai-optimize-17"><span style="color: #000000;"><strong>Port filter</strong></span></li>
<li class="ai-optimize-18"><span style="color: #000000;"><strong>Host filter</strong></span></li>
<li class="ai-optimize-19"><span style="color: #000000;"><strong>The header of each packet</strong></span></li>
<li class="ai-optimize-20"><span style="color: #000000;"><strong>TCP sequence number</strong></span></li>
<li class="ai-optimize-21"><span style="color: #000000;"><strong>Packet filter</strong></span></li>
<li class="ai-optimize-22"><span style="color: #000000;"><strong>Packet Direction</strong></span></li>
<li class="ai-optimize-23"><span style="color: #000000;"><strong>Live number count</strong></span></li>
<li class="ai-optimize-24"><span style="color: #000000;"><strong>Read and Write in a file</strong></span></li>
<li class="ai-optimize-25"><span style="color: #000000;"><strong>Snapshot length</strong></span></li>
<li class="ai-optimize-26"><span style="color: #000000;"><strong>Dump mode</strong></span></li>
</ul>
<h3 class="ai-optimize-27"><span style="color: #800000;">Introduction</span></h3>
<p class="ai-optimize-28"><span style="color: #000000;">Tcpdump was originally developed in 1988 by Van Jacobson, Sally Floyd, Vern Paxson, and Steven McCanne. They worked at the Lawrence Berkeley Laboratory Network Research Group.</span></p>
<p class="ai-optimize-29"><span style="color: #000000;">It allows its users to display the TCP/IP and other packets being received and transmitted over the network. Tcpdump works on most of the Linux based operating systems. It uses the libpcap library to capture packets, which is a C/C++ based library. Tcpdump has a windows equivalent as well. It is named windump. It uses a winpcap for its library.</span></p>
<h3 class="ai-optimize-30"><span style="color: #800000;">Available Options</span></h3>
<p class="ai-optimize-31"><span style="color: #000000;">We can use the following parameter to print the tcpdump and libpcap version strings. Also, we can print a usage message that shows all the available options.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -h
tcpdump --help</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-OTTZIu9EUok/XnOUdVv8VKI/AAAAAAAAjBs/BrTiNMWNT_8z9jwRPA9COo6I8z-lGEhwgCLcBGAsYHQ/s1600/1.png"/></p>
<h3 class="ai-optimize-32"><span style="color: #800000;">List of interfaces</span></h3>
<p class="ai-optimize-33"><span style="color: #000000;">An interface is the point of interconnection between a computer and a network. We can use the following parameter to print the list of the network interfaces available on the system. It can also detect interfaces on which tcpdump can capture packets. For each network interface, a number is assigned. This number can be used with the ‘-i’ parameter to capture packets on that particular interface.</span></p>
<p class="ai-optimize-34"><span style="color: #000000;">There might be a scenario where the machine that we are working on, is unable to list the network interfaces it is running. This can be a compatibility issue or something else hindering the execution of some specific commands (ifconfig -a).</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump –list-interface
tcpdump -D</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-sZdJJ4pEsE8/XnOUgs9anpI/AAAAAAAAjCU/3Yyyfb4BlYk7zwK1V2yKF4uPKr071HfLACLcBGAsYHQ/s1600/2.png"/></p>
<h3 class="ai-optimize-35"><span style="color: #800000;">Default Capture</span></h3>
<p class="ai-optimize-36"><span style="color: #000000;">Before moving onto to advanced options and parameters of this network traffic capture tool let’s first do a capture with the default configurations.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-7uHbwzeXs5c/XnOUhCmR64I/AAAAAAAAjCc/Wnok2BZadzUJ3pPHfjbgP8N7M9qkkoi0wCLcBGAsYHQ/s1600/3.png"/></p>
<h3 class="ai-optimize-37"><span style="color: #800000;">Capturing traffic of a particular interface</span></h3>
<p class="ai-optimize-38"><span style="color: #000000;">We will capture traffic using the ethernet network known as “eth0.” A category 5 cable usually connects this type of interface to the network.</span></p>
<p class="ai-optimize-39"><span style="color: #000000;">To select this interface we need to use -i parameter.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-C0LM7PU6tqo/XnOUhfVuhUI/AAAAAAAAjCg/KaTj9q-_ymw4pk8xeIuRmc1PyxtN5J_YQCLcBGAsYHQ/s1600/4.png"/></p>
<h3 class="ai-optimize-40"><span style="color: #800000;">Packet count</span></h3>
<p class="ai-optimize-41"><span style="color: #000000;">Tcpdump has some amazing features which we can use to make our traffic analysis more efficient. We can access some of these features using various parameters. We use the -c parameter, it will help us to capture the exact amount of data that we need and display those. It refines the amount of data we captured.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 -c10</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-kz6epKRlzcc/XnOUh2Ova2I/AAAAAAAAjCk/uf5aZdyFf9oxgVdBw-V9MAmGOTaV9gZxgCLcBGAsYHQ/s1600/5.png"/></p>
<h3 class="ai-optimize-42"><span style="color: #800000;">Verbose mode</span></h3>
<p class="ai-optimize-43"><span style="color: #000000;">The verbose mode provides information regarding the traffic scan. For example, time to live(TTL), identification of data, total length and available options in IP packets. It enables additional packet integrity checks such as verifying the IP and ICMP headers.</span></p>
<p class="ai-optimize-44"><span style="color: #000000;">To get extra information from our scan we need to use -v parameter.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 -c 5 -v</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-YHJQ0HDxgcU/XnOUiKjH02I/AAAAAAAAjCo/jgIug7kd3JEDt1PfeZVxdRgkP6WcI4g3gCLcBGAsYHQ/s1600/6.png"/></p>
<h3 class="ai-optimize-45"><span style="color: #800000;">Printing each packet in ASCII</span></h3>
<p class="ai-optimize-46"><span style="color: #000000;">ASCII is the abbreviation of the American Standard Code for Information Interchange. It is a character encoding standard for electronic communication. ASCII codes represent the text in computers and other devices. Most of the modern character encoding techniques were based on the ASCII codes. To print each packet in ASCII code we need to use -A parameter.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 -c 5 -A</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-2aWJelmjPug/XnOUia_ONQI/AAAAAAAAjCs/4Lj_qt3_MYA0XDUAGHWBLltBJZdoRYhHACLcBGAsYHQ/s1600/7.png"/></p>
<h3 class="ai-optimize-47"><span style="color: #800000;">Don’t convert address</span></h3>
<p class="ai-optimize-48"><span style="color: #000000;">With the help of the tcpdump -nn parameter, we can see the actual background address without any filters. This feature helps us to understand the data traffic better without any filters.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 -c 5
tcpdump -i eth0 -c 5 -nn</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-YGpfeueFMk0/XnOUinJT_dI/AAAAAAAAjCw/k23MKzBhIs83FicA_pjM9Sel2KtBuxCXQCLcBGAsYHQ/s1600/8.png"/></p>
<h3 class="ai-optimize-49"><span style="color: #800000;">Port filter</span></h3>
<p class="ai-optimize-50"><span style="color: #000000;">Port filter helps us to analyze the data traffic of a particular port. It helps us to monitor the destination ports of the TCP/UDP or other port-based network protocols.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 -c 5 -v port 80</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-I-b44NM8p6M/XnOUjX_0tZI/AAAAAAAAjC0/HFXriHmNfhAJgePdGb6-L71B_7kdx_AzACLcBGAsYHQ/s1600/9.png"/></p>
<h3 class="ai-optimize-51"><span style="color: #800000;">Host filter</span></h3>
<p class="ai-optimize-52"><span style="color: #000000;">This filter helps us to analyze the data traffic of a particular host. It also allows us to stick to a particular host through which further makes our analyzing better. Multiple parameters can also be applied, such as -v, -c, -A,-n, to get extra information about that host.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump host 104.28.6.89 -c10 -A -n</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-dqmt7SVLNJU/XnOUdjNc5wI/AAAAAAAAjBw/VA63BCXfE6MDtolbxEjHI6pbfmunYbIEACLcBGAsYHQ/s1600/11.png"/></p>
<h4 class="ai-optimize-53"><span style="color: #000000;">The header of each packet</span></h4>
<p class="ai-optimize-54"><span style="color: #000000;">The header contains all the instructions given to the individual packet about the data carried by them. These instructions can be packet length, advertisement, synchronization, ASCII code, hex values, etc. We can use -X parameter to see this information on our data packets.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 -c 3 -X</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-c6Hj8ZqIA3s/XnOUdp7BwcI/AAAAAAAAjB0/RQxo5HX0fZcF5bWYfObww9qTjgbcQi1bQCLcBGAsYHQ/s1600/12.png"/></p>
<h4 class="ai-optimize-55"><span style="color: #000000;">TCP sequence number</span></h4>
<p class="ai-optimize-56"><span style="color: #000000;">All bytes in TCP connections has there sequence number which is a randomly chosen initial sequence number (ISN). SYN packets have one sequence number, so data will begin at ISN+1. The sequence number is the byte number of data in the TCP packet that is sent forward. -S parameter is used to see these data segments of captured packets.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 -nnXS</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-AervHijE5mI/XnOUev-z0MI/AAAAAAAAjB4/_9aWKetKqbscitbb6GbravcVS4_IKFVMgCLcBGAsYHQ/s1600/13.png"/></p>
<h3 class="ai-optimize-57"><span style="color: #800000;">Packet filter</span></h3>
<p class="ai-optimize-58"><span style="color: #000000;">Another feature that is provided by tcpdump is packet filtering. This helps us to see the packet results on a particular data packet in our scan. If we want to apply this filter in our scan we just need to add the desired packet in our scan.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 icmp -c 10</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-mVTufkDDRqU/XnOUeyN9fLI/AAAAAAAAjCA/9e2JLbd0oXUVh3OL9Xa-62UJBxBOpHUfQCLcBGAsYHQ/s1600/14.png"/></p>
<h4 class="ai-optimize-59"><span style="color: #000000;">Packet directions</span></h4>
<p class="ai-optimize-60"><span style="color: #000000;">To the direction of data flow in our traffic, we can use the following parameter :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 icmp -c 5 -Q in</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-iK70sp3NMdo/XnOUexwa51I/AAAAAAAAjB8/UyjagFCoVKoGh2upYarAKyTvWNc85yiMgCLcBGAsYHQ/s1600/15.png"/></p>
<p class="ai-optimize-61"><span style="color: #000000;">To see all the requests which we are sending to the server  following (- Q out) parameter can be used:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 icmp -c 5 -Q out</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-TdmLcBFJxlU/XnOUfQMJemI/AAAAAAAAjCE/wZz3MPkoVF8ETV8yFVofJK8LbQK6NFeDwCLcBGAsYHQ/s1600/16.png"/></p>
<h3 class="ai-optimize-62"><span style="color: #800000;">Live number count</span></h3>
<p class="ai-optimize-63"><span style="color: #000000;">We can apply the live number count feature to see how many packets the system scanned or captured during the data traffic scans. –The number parameter counts the number of packets that the system captures in a live scan. We also compared packet count to live number count to see its accuracy.</span></p>
<h3 class="ai-optimize-64"><span style="color: #800000;">Read and write in a file</span></h3>
<p class="ai-optimize-65"><span style="color: #000000;">In TCPDump, we can write and read into a.pcap extension file. Specifically, the write option(-w) allows us to write raw data packets that we receive as output to a standard.pcap file. On the other hand, the read option(-r) helps us read that file. To illustrate, follow the steps below to write the output in .pcap format:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 icmp -c 10 -w file.pcap</pre>
<p class="ai-optimize-66"><span style="color: #000000;">To read this .pcap file we follow:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -r file.pcap</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-g5mlCCe8tG0/XnOUfzd-7vI/AAAAAAAAjCM/5yyfhVU1niUVB-tShFtHmWrFcFfRLkfZgCLcBGAsYHQ/s1600/18.png"/></p>
<h3 class="ai-optimize-67"><span style="color: #800000;">Snapshot length</span></h3>
<p class="ai-optimize-68"><span style="color: #000000;">Snapshot length/snaplen is referred to as the bytes of data from each packet. It is by default set on the 262144 bytes. With tcpdump, we can adjust this limit to our requirement to better understand it in each snap length. -s parameter helps us to do it just apply -s parameter along with the length of bytes.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 icmp -s10 -c2
tcpdump -i eth0 icmp -s25 -c2
tcpdump -i eth0 icmp -s40 -c2
tcpdump -i eth0 icmp -s45 -c2</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-pvag_42vvbw/XnOUgO0oCUI/AAAAAAAAjCQ/4m_iqCl3t0I9WjQ_qAVXgC4nKxPM4Ew0gCLcBGAsYHQ/s1600/19.png"/></p>
<h3 class="ai-optimize-69">Dump mode</h3>
<p class="ai-optimize-70"><span style="color: #000000;">Dump mode has multiple parameters like -d, -dd, -ddd. To begin with, the -d parameter dumps the compiled matching code into a readable output. Furthermore, the -dd parameter dumps the code as a C program fragment. Finally, the -ddd parameter dumps the code as a decimal number with a count. To see these results in our scan, we need to follow the steps below:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 -c 5 -d
tcpdump -i eth0 -c 5 -dd
tcpdump -i eth0 -c 5 -ddd</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-kujeoq9Gj3A/XnOUhDC87WI/AAAAAAAAjCY/3dZrjyOKICktgVOgYF5wTmulXGM7elxcACLcBGAsYHQ/s1600/20.png"/></p>
<p class="ai-optimize-71"><span style="color: #000000;">This is our first article in the series of a comprehensive guide to tcpdump. Which is based on some basic commands of tcpdump. Stay tuned for more advance option in this amazing tool.</span></p>
<p class="ai-optimize-55"><span style="color: #000000;">To learn more about Penteration Testing. Follow this</span> <a href="https://www.hackingarticles.in/category/penetration-testing/">Link.</a></p>
<p class="ai-optimize-72"><span style="color: #000000;"><strong>Author: </strong>Shubham Sharma is a Pentester and a Cybersecurity Researcher, contact <a style="color: #000000;" href="https://www.linkedin.com/in/shubham-sharma-626964153/">LinkedIn</a> and <a style="color: #000000;" href="https://twitter.com/Shubham_pen">Twitter</a>.  </span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
