<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/password-cracking/" rel="category tag">Password Cracking</a></span>            </div>
            <h1 class="post-title entry-title">Password Cracking: FTP</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/ftp-password-cracking/" rel="bookmark"><time class="entry-date published" datetime="2016-03-02T11:25:55+00:00">March 2, 2016</time><time class="updated" datetime="2025-05-27T18:57:45+00:00">May 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-62 ai-optimize-introduction"><span style="color: #000000;">Gaining initial access through an open FTP port is a common and effective technique in penetration testing. This article demonstrates how to identify and exploit FTP services using a range of popular tools, each suited for different scenarios, from quick brute-force attempts to large-scale automated attacks.</span></p>
<h4 class="ai-optimize-63"><span style="color: #000000;">MITRE ATT&amp;CK Techniques:</span></h4>
<ul>
<li class="ai-optimize-64"><span style="color: #000000;"><strong>T1110.001 – </strong>Brute Force: Password Guessing</span></li>
<li class="ai-optimize-65"><span style="color: #000000;"><strong>T1046 – </strong>Network Service Scanning</span></li>
<li class="ai-optimize-66"><span style="color: #000000;"><strong>T1078 – </strong>Valid Accounts</span></li>
</ul>
<h2 class="ai-optimize-67"><span style="color: #800000;">Table of Contents</span></h2>
<p class="ai-optimize-68"><span style="color: #000000;"><strong>Introduction</strong></span></p>
<p class="ai-optimize-69"><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li class="ai-optimize-70"><span style="color: #000000;">Scan for Open FTP Port with Nmap</span></li>
</ul>
<p class="ai-optimize-71"><span style="color: #000000;"><strong>Brute-Force Techniques</strong></span></p>
<ul>
<li class="ai-optimize-72"><span style="color: #000000;">Hydra</span></li>
<li class="ai-optimize-73"><span style="color: #000000;">Metasploit</span></li>
<li class="ai-optimize-74"><span style="color: #000000;">Medusa</span></li>
<li class="ai-optimize-75"><span style="color: #000000;">NetExec (nxc)</span></li>
<li class="ai-optimize-76"><span style="color: #000000;">Ncrack</span></li>
<li class="ai-optimize-77"><span style="color: #000000;">Patator</span></li>
<li class="ai-optimize-78"><span style="color: #000000;">Nmap NSE Script (ftp-brute.nse)</span></li>
<li class="ai-optimize-79"><span style="color: #000000;">BruteSpray</span></li>
</ul>
<h2 class="ai-optimize-80"><span style="color: #800000;">Introduction</span></h2>
<p class="ai-optimize-81"><span style="color: #000000;"><strong>FTP (File Transfer Protocol)</strong> is a standard network protocol used to transfer files between a client and server over a TCP-based network such as the internet. It operates on port 21 and allows users to upload, download, and manage files on remote servers. FTP can support anonymous access or require authentication using usernames and passwords. However, by default, it transmits data—including credentials—in plaintext, making it vulnerable to eavesdropping and attacks like brute force. For secure transfers, alternatives like FTPS (FTP Secure) or SFTP (SSH File Transfer Protocol) are recommended. Despite its age, FTP is still commonly found in legacy systems and networks.</span></p>
<h2 class="ai-optimize-82"><span style="color: #800000;">Enumeration</span></h2>
<h3 class="ai-optimize-83"><span style="color: #800000;">Nmap Scan</span></h3>
<p class="ai-optimize-84"><span style="color: #000000;">MITRE Technique: T1046</span></p>
<p class="ai-optimize-85"><span style="color: #000000;">Firstly, to start the enumeration process, we perform a simple Nmap scan on the target IP address to check for an open <strong>FTP</strong> port and identify the service version:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p 21 -sV 192.168.1.110</pre>
<p class="ai-optimize-87"><span style="color: #000000;"><strong>Explanation:</strong></span></p>
<ul>
<li class="ai-optimize-88"><span style="color: #000000;"><strong>-p 21</strong>: Scans for FTP service on port 21.</span></li>
<li class="ai-optimize-89"><span style="color: #000000;"><strong>-sV</strong>: Enables version detection to gather more information about the running FTP service.</span></li>
</ul>
<p class="ai-optimize-90"><span style="color: #000000;">Then, once Nmap identifies that port 21 is open and an FTP service is active, we can proceed to the next phase: <strong>brute force attacks</strong> to test for weak or default credentials.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhQkPAVcevhG6UdZO7PkZ_qF-ZGR1Z1Y3dw_3OuvUBm9O3n3tvivgU0ah5wcp_5quCPJpIGtkiIBgvhB0LQyp8yjDXDkKQCKwhCS6TaxgCumVW7Jo_mM9U3ZbqOGYk9jHs9nnfWMys5QNYbjlCPNjtTtVwe-lBwAF3jxdM1VbGlf7YoO1ombPjBKHwxa5N6/s16000/1.png"/></p>
<h4 class="ai-optimize-91"><span style="color: #000000;">Defensive Strategy:</span></h4>
<p class="ai-optimize-92"><span style="color: #000000;">Deploy network intrusion detection/prevention systems (NIDS/NIPS) such as <strong>Snort</strong> or <strong>Zeek</strong> to detect excessive port scans or fingerprinting behavior. Flag unexpected FTP usage inside internal VLANs.</span></p>
<h2 class="ai-optimize-222"><span style="color: #800000;">Brute-Force Techniques</span></h2>
<h3 class="ai-optimize-224"><span style="color: #800000;">Tools Quick Reference</span></h3>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjz_1zarjYfLe8c5jb3QPuu98mSet50PYepD4eE682u4gTRexP8L6wdMwxOO0rJQyBn13GkvF2yGACpMNuKsCtDHt4K0Ae2frw1TVcOrxw8t3EEVND7q1oM8wvcH1s0KfdmwY3LjjRzNIrBde09HpOrLQgPt2_TFKeyBN8hsGV24uyYw8iX4K7-fYuFx8OK/s16000/table%202.png"/></p>
<h3 class="ai-optimize-225"><span style="color: #800000;">Hydra</span></h3>
<p class="ai-optimize-96"><span style="color: #000000;"><strong>Hydra</strong> is a fast, flexible, and widely-used tool designed for brute force password cracking across a wide range of protocols and services—including <strong>FTP, SSH, HTTP, SMB</strong>, and various databases. It automates the process; more specifically, it systematically tests username and password combinations from provided wordlists..</span></p>
<p class="ai-optimize-97"><span style="color: #000000;">As with any dictionary-based attack, the effectiveness of Hydra depends heavily on the quality of the wordlists used.</span></p>
<p class="ai-optimize-98"><span style="color: #000000;">Kali Linux includes several built-in wordlists (for example rockyou.txt), but you can also create custom ones—such as user.txt and pass.txt—based on credential harvesting or common password patterns.</span></p>
<h4 class="ai-optimize-99"><span style="color: #000000;">Step To Reproduce</span></h4>
<p class="ai-optimize-100"><span style="color: #000000;">To perform a brute force attack against an FTP service, use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hydra -L user.txt -P pass.txt 192.168.1.110 ftp</pre>
<p class="ai-optimize-102"><span style="color: #000000;"><strong>Explanation</strong><strong>:</strong></span></p>
<ul>
<li class="ai-optimize-103"><span style="color: #000000;"><strong>-L user.txt</strong>: Specifies the path to the username list.</span></li>
<li class="ai-optimize-104"><span style="color: #000000;"><strong>-P pass.txt</strong>: Specifies the path to the password list.</span></li>
<li class="ai-optimize-105"><span style="color: #000000;"><strong>168.1.110</strong>: Target IP address.</span></li>
<li class="ai-optimize-106"><span style="color: #000000;"><strong>ftp</strong>: Protocol to attack.</span></li>
</ul>
<p class="ai-optimize-107"><span style="color: #000000;">Hydra will systematically test each username-password pair against the FTP service on the specified host. If valid credentials are found, Hydra will clearly report the success.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgemmPwSH0VbKI8ZhHp63w4qntBkIGNuW730xrlAUWsaGrIyN6aRxa4kG5Z8XEhQUzNM7Ng0zlGYrcgL1V08svfTRic7N7ErrONt6bvDBeXuHnZNqRdQlMXK5AKt1fXuUBoPLgrbofTBCVO3YkKosgnQSPtoJTgD81WwHexQlcfTacqp2jCCtUp2MEWFl90/s16000/2.png"/></p>
<h4 class="ai-optimize-108"><span style="color: #000000;">Detection Strategy:</span></h4>
<p class="ai-optimize-109"><span style="color: #000000;">Monitor for failed login spikes and excessive session establishment using SIEM queries against FTP logs or NetFlow.</span></p>
<h3 class="ai-optimize-226"><span style="color: #800000;">Metasploit</span></h3>
<p class="ai-optimize-111"><span style="color: #000000;"><strong>Metasploit</strong> includes auxiliary modules that can perform brute force attacks on various services—including FTP. In this case, we can effectively automate login attempts to find weak or default credentials on target systems by utilizing our dictionaries, user.txt and pass.txt.</span></p>
<h4 class="ai-optimize-227"><span style="color: #000000;">Step To Reproduce</span></h4>
<p class="ai-optimize-113"><span style="color: #000000;">On kali terminal type msfconsole then run following commands:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf6 &gt; use auxiliary/scanner/ftp/ftp_login
set rhosts 192.168.1.110
set user_file user.txt
set pass_file pass.txt
set verbose false
run</pre>
<p class="ai-optimize-120"><span style="color: #000000;"><strong>Explanation</strong>:</span></p>
<ul>
<li class="ai-optimize-121"><span style="color: #000000;"><strong>use auxiliary/scanner/ftp/ftp_login</strong>: Selects the Metasploit module designed for brute forcing FTP login credentials.</span></li>
<li class="ai-optimize-122"><span style="color: #000000;"><strong>set rhosts target ip</strong>: Specifies the target machine’s IP address for the scan.</span></li>
<li class="ai-optimize-123"><span style="color: #000000;"><strong>set user_file user.txt</strong>: Defines a file containing potential usernames to try during the brute force attack.</span></li>
<li class="ai-optimize-124"><span style="color: #000000;"><strong>set pass_file pass.txt</strong>: Defines a file containing potential passwords to pair with each username.</span></li>
<li class="ai-optimize-125"><span style="color: #000000;"><strong>set verbose false</strong>: Disables verbose output, reducing on-screen clutter during the attack but if you are interested in knowledge failed attempt or all tried combination then you can reset as true.</span></li>
</ul>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEju1ZgnMjSSkJtql0sZghjwPxqcgLLHQaBMnDFrkgKWsWbsvNJjqDHlNQ99PEfzxArAFsX_PUVmbb-i3Wo4V-u2pfjLPwzhjIldgcB4TQzI05u7-doFXlqUWzkJz1WPfyfCN0pwQckX5sQAv55J0jKGmwFshlC1VqE32GtNRz3Q9IWFfBhZ8q8AvCEET4Wh/s16000/3.png"/></p>
<h4 class="ai-optimize-126"><span style="color: #000000;">Defensive Control:</span></h4>
<p class="ai-optimize-127"><span style="color: #000000;">Enable account lockouts and monitor for failed authentication events (Event ID 4625 in Windows, auth.log in Linux).</span></p>
<h3 class="ai-optimize-128"><span style="color: #800000;">Medusa</span></h3>
<p class="ai-optimize-129"><span style="color: #000000;"><strong>Medusa</strong> is a speedy, parallel, and modular login brute forcer—much like Hydra. It supports multiple protocols; more specifically, it allows testers to perform dictionary-based attacks against services like <strong>SSH, FTP, HTTP, AFP, CVS, IMAP, rlogin, Subversion, VNC</strong>, and more.</span></p>
<h4 class="ai-optimize-130"><span style="color: #000000;">Step To Reproduce</span></h4>
<p class="ai-optimize-131"><span style="color: #000000;">Below we have successfully grabbed credentials using following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">medusa -h 192.168.1.110 -U user.txt -P pass.txt -M ftp | grep "ACCOUNT FOUND"</pre>
<p class="ai-optimize-133"><span style="color: #000000;"><strong>Explanation</strong>:</span></p>
<ul>
<li class="ai-optimize-134"><span style="color: #000000;"><strong>medusa</strong>: Invokes the Medusa brute force tool.</span></li>
<li class="ai-optimize-135"><span style="color: #000000;"><strong>-h target ip</strong>: Specifies the IP address of the target machine.</span></li>
<li class="ai-optimize-136"><span style="color: #000000;"><strong>-U</strong>: Points to a file containing a list of usernames to try.</span></li>
<li class="ai-optimize-137"><span style="color: #000000;"><strong>-P</strong>: Points to a file containing a list of passwords.</span></li>
<li class="ai-optimize-138"><span style="color: #000000;"><strong>-M ftp</strong>: Indicates that the FTP module should be used for this attack.</span></li>
<li class="ai-optimize-139"><span style="color: #000000;"><strong>| grep “ACCOUNT FOUND”</strong>: Filters the command output to display only successful login attempts, making it easier to identify valid credentials.</span></li>
</ul>
<h4><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjBoY2f_v_HUxdAOxOp7atiedjSTWWqSinOON40duG5Nul8VM7RctMVeEQdJ_DJi7u7PbUFsKnbeWaofi0NODpycz2wd0xA5quqxB_3iOW1ikHwGltcDnLooJyeRnEfjdQhxQdpX2cacYWsRDj6465cxGKFYO2an4Hkv0c0HdFb9ym-ZkYMgHBLhx_qw8Pu/s16000/4.png"/></h4>
<h4 class="ai-optimize-140"><span style="color: #000000;">Defensive Strategy:</span></h4>
<p class="ai-optimize-141"><span style="color: #000000;">Use anomaly detection to flag spikes in login attempts across protocols.</span></p>
<h3 class="ai-optimize-142"><span style="color: #800000;">Netexec (aka nxc)</span></h3>
<p class="ai-optimize-143"><span style="color: #000000;"><strong>NetExec</strong>, commonly used via its command alias nxc, is a powerful post-exploitation and lateral movement framework built as a successor to the well known <strong>CrackMapExec</strong> project. It supports a wide array of network protocols—including <strong>SMB, FTP, RDP</strong>, <strong>WINRM, SSH</strong> and more—making it a versatile tool for both offensive security assessments and red team operations.</span></p>
<p class="ai-optimize-144"><span style="color: #000000;">Among its many capabilities, NetExec can perform brute force attacks on FTP services using specified username and password lists. Its clean, efficient syntax and structured output make it ideal for quickly identifying weak or default credentials during targeted password audits.</span></p>
<h4 class="ai-optimize-145"><span style="color: #000000;">Step To Reproduce</span></h4>
<p class="ai-optimize-146"><span style="color: #000000;">To initiate a brute force attack against an FTP service using NetExec, run the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc ftp 192.168.1.110 -u user.txt -p pass.txt</pre>
<p class="ai-optimize-148"><span style="color: #000000;"><strong>Explanation</strong><strong>:</strong></span></p>
<ul>
<li class="ai-optimize-149"><span style="color: #000000;">ftp: Specifies the protocol to target.</span></li>
<li class="ai-optimize-150"><span style="color: #000000;"><strong>168.1.110</strong>: The IP address of the target host.</span></li>
<li class="ai-optimize-151"><span style="color: #000000;"><strong>-u user.txt</strong>: Path to the file containing a list of usernames.</span></li>
<li class="ai-optimize-152"><span style="color: #000000;"><strong>-p pass.txt</strong>: Path to the file containing a list of passwords.</span></li>
</ul>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgfOoOZoWlnL_Pr4xNY1XbOLUwq9UkfmWI6IvvLnwkc8yQHdu16FZsR0EC9hBTA4jn_txFNBd9Akh4tp0-ByN1XPChwA7bXykQo0PCmT65Tn2Q8BTiow5QqHrqaxsqoUuT9BLXuPQILoK8zTK8WOEUS2_0BT3Xgp_Bfzp0MioyYouxdSEGbZVhy4jcPZNSv/s16000/6.png"/></p>
<h4 class="ai-optimize-153"><span style="color: #000000;">Filtering Successful Logins</span></h4>
<p class="ai-optimize-154"><span style="color: #000000;">To view only successful login attempts, you can pipe the output through grep:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc ftp 192.168.1.110 -u user.txt -p pass.txt | grep [+]</pre>
<p class="ai-optimize-156"><span style="color: #000000;">This highlights successful authentication events, streamlining the process of identifying valid credential pairs for further exploitation or lateral movement.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjDi1GRornDtudGNP7nDQcwzKQw4dlZRhGFjundwWt-3s2Jtw7ibn6xVRwZq8AFGyLsEtO1NHBAUakl3TReMEFqq9NtwFn2mIBSuZFISPtu1xO6Vw75IBb6xb4DS-TZJaK0pNK_KbQ_pq0beKEBO5e2Wpa5TCtT0oB9m_tftyo3HuyKR6HwftCYqpkl7rK4/s16000/5.png"/></p>
<h4 class="ai-optimize-157"><span style="color: #000000;">Security Control:</span></h4>
<p class="ai-optimize-158"><span style="color: #000000;">Segment internal assets. Use jump hosts and enforce MFA to prevent lateral movement even after brute force success.</span></p>
<h3 class="ai-optimize-228"><span style="color: #800000;">Ncrack</span></h3>
<p class="ai-optimize-160"><span style="color: #000000;">To begin with, Ncrack is a high-speed network authentication cracking tool, developed by the creators of Nmap. It’s designed for large-scale password auditing against network services like <strong>SSH, RDP, FTP</strong>, and others, with a focus on performance and reliability.</span></p>
<p class="ai-optimize-161"><span style="color: #000000;">Specifically, Ncrack can perform brute force attacks against FTP services by iterating through supplied username and password lists. It’s favoured for its speed, modularity, and seamless integration with other tools in a penetration tester’s toolkit. Let’s get started<strong>.</strong> </span></p>
<h4 class="ai-optimize-162"><span style="color: #000000;">Step To Reproduce</span></h4>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ncrack -U user.txt -P pass.txt 192.168.1.110 -p 21</pre>
<p class="ai-optimize-164"><span style="color: #000000;"><strong>Explanation:</strong></span></p>
<ul>
<li class="ai-optimize-165"><span style="color: #000000;"><strong>ncrack</strong>: Launches the Ncrack password-cracking tool.</span></li>
<li class="ai-optimize-166"><span style="color: #000000;"><strong>ftp://target ip</strong>: Specifies the target FTP service and its IP address.</span></li>
<li class="ai-optimize-167"><span style="color: #000000;"><strong>-U user.txt</strong>: Indicates the file containing a list of potential usernames.</span></li>
<li class="ai-optimize-168"><span style="color: #000000;"><strong>-P pass.txt</strong>: Indicates the file containing a list of potential passwords.</span></li>
<li class="ai-optimize-169"><span style="color: #000000;"><strong>| grep [+]</strong>: Filters the command’s output to display only successful login attempts, typically marked with a [+] in Ncrack’s output.</span></li>
</ul>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjRX-gbv0QyU3-F9eP6btG-Yl0enUz06zZNbdtO3JBo26owX5tybFdMhjH2abNu8RXn0q3W43I5GIY77qFPwKadIzhd_U0-FuV8ZOfVPhjNgOwBEEJw1aNkkzT1-sANU8kLfdbfbwu5I3F50mqPCWYKlcoAbrapNcuBl2Em4UhpL28MAHzUbpWrLzMmW-eL/s16000/7.png"/></p>
<h4 class="ai-optimize-170"><span style="color: #000000;">Defensive Strategy:</span></h4>
<p class="ai-optimize-171"><span style="color: #000000;">Integrate FTP login anomaly alerts into SOC dashboards using SIEM tools (e.g., Splunk query with event thresholds).</span></p>
<h3 class="ai-optimize-229"><span style="color: #800000;">Patator</span></h3>
<p class="ai-optimize-173"><span style="color: #000000;">Patator is a versatile, multi-threaded brute forcing tool capable of attacking a wide range of protocols including FTP, SSH, HTTP, and more. It’s modular, highly customizable, and known for its stability and clear, structured output.</span></p>
<p class="ai-optimize-174"><span style="color: #000000;">Its flexible syntax allows you to easily specify input files for both usernames and passwords, and it provides organized feedback on successful or failed login attempts.</span></p>
<h4 class="ai-optimize-175"><span style="color: #000000;">Step To Reproduce</span></h4>
<p class="ai-optimize-176"><span style="color: #000000;">Patator can be used to perform FTP brute force attacks by iterating through supplied username and password lists which in this case will be user.txt and pass.txt.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">patator ftp_login host=192.168.1.110 user=FILE0 0=user.txt password=FILE1 1=pass.txt</pre>
<p class="ai-optimize-178"><span style="color: #000000;"><strong>Explanation</strong>:</span></p>
<p class="ai-optimize-179"><span style="color: #000000;">patator: Launches the Patator brute force tool.</span></p>
<ul>
<li class="ai-optimize-180"><span style="color: #000000;"><strong>ftp_login</strong>: Specifies the module for brute forcing FTP credentials.</span></li>
<li class="ai-optimize-181"><span style="color: #000000;"><strong>host=target ip</strong>: Indicates the target machine’s IP address.</span></li>
<li class="ai-optimize-182"><span style="color: #000000;"><strong>user=FILE0 0=user.txt</strong>: Assigns FILE0 as a placeholder for usernames, pulling values from user.txt.</span></li>
<li class="ai-optimize-183"><span style="color: #000000;"><strong>password=FILE1 1=pass.txt</strong>: Assigns FILE1 as a placeholder for passwords, pulling values from pass.txt.</span></li>
</ul>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhBx2fSMOczCxFlsKINFjiiO3nweu3NPcZAWTBoTSI6cXq4mlnNgVW5A0yPcUi1s2cv4Rap-KdGR4-3kwO8q46t6gCZ2ph2EBCr9XvqDutCMBTsReVt4VS9tYUW_h68YXEha-Y-zM6gfoOFdxmRlLFEZNNKbwG575baHRCXte6J5udDYGXlzzlkOP-376Zs/s16000/8.png"/></p>
<p class="ai-optimize-184"><span style="color: #000000;"><strong><em>Note</em></strong><em>: You can add | grep ‘200 OK’ or -x ignore:code=530 for success filtering or to skip known failed responses based on Patator’s output codes.</em></span></p>
<h4 class="ai-optimize-185"><span style="color: #000000;">Defensive Suggestion:</span></h4>
<p class="ai-optimize-186"><span style="color: #000000;">Limit connections by IP and impose filtering on FTP sessions..</span></p>
<h3 class="ai-optimize-187"><span style="color: #800000;">NMAP</span></h3>
<p class="ai-optimize-188"><span style="color: #000000;">Nmap is widely recognized as a powerful tool for network scanning and host enumeration. Beyond its core functionality, it features the Nmap Scripting Engine (NSE)—a collection of scripts that extend its capabilities to perform a wide range of tasks, including brute force attacks against services like FTP.</span></p>
<p class="ai-optimize-189"><span style="color: #000000;">One such script, ftp-brute.nse, enables brute-force login attempts on FTP servers using custom username and password lists. Although not as fast as dedicated brute force tools, it offers a convenient, built-in option for quick password audits during reconnaissance.</span></p>
<h4 class="ai-optimize-190"><span style="color: #000000;">Step To Reproduce</span></h4>
<p class="ai-optimize-191"><span style="color: #000000;">Firstly, to perform a brute force attack against an FTP service using Nmap, run the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p21 --script ftp-brute.nse --script-args userdb=user.txt,passdb=pass.txt 192.168.1.110</pre>
<p class="ai-optimize-193"><span style="color: #000000;"><strong>Explanation</strong><strong>:</strong></span></p>
<ul>
<li class="ai-optimize-194"><span style="color: #000000;">–<strong>p21</strong>: Scans port 21 (FTP).</span></li>
<li class="ai-optimize-195"><span style="color: #000000;"><strong>–script ftp-brute.nse</strong>: Specifies the use of the FTP brute-force NSE script.</span></li>
<li class="ai-optimize-196"><span style="color: #000000;"><strong>–script-args userdb</strong>=user.txt,passdb=pass.txt: Provides the script with your custom username and password lists.</span></li>
</ul>
<p class="ai-optimize-197"><span style="color: #000000;">This method is especially useful during early-stage reconnaissance to identify weak or default FTP credentials on a target system.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEggV95nqhyPjjHP8Yf8exy0FElztE0sj88W5Qh8N5wOJgay6Ew1-avBdDxAD_J8b7LRAq-rLdKtMNi6v9T3QG_7Gp0IZdw5nS3D1QLj8NKsf4dZbx_msr3Ec3nIbq3UhBvihwS1XmDWZfpTA25P1KUiVbPfr_-C8Pgev97ORsf2RVTal3I7QBSBAdNZcfIn/s16000/9.png"/></p>
<h4 class="ai-optimize-198"><span style="color: #000000;">Mitigation Stratergy:</span></h4>
<p class="ai-optimize-199"><span style="color: #000000;">Whitelist approved scanning hosts and flag brute-force attempts from unknown sources.</span></p>
<h3 class="ai-optimize-230"><span style="color: #800000;">BruteSpray</span></h3>
<p class="ai-optimize-201"><span style="color: #000000;"><strong>BruteSpray</strong> is a powerful post-scan automation tool designed to perform credential brute force attacks using the results of an Nmap scan. Furthermore, it supports a variety of common protocols—including FTP, SSH, SMB, and more—making it a versatile solution for mass login attempts across multiple hosts and services.</span></p>
<p class="ai-optimize-202"><span style="color: #000000;">BruteSpray integrates seamlessly with Nmap’s output formats (grepable or XML), allowing you to quickly move from service discovery to targeted brute-force attacks.</span></p>
<h4 class="ai-optimize-203"><span style="color: #800000;">Step 1: Scan for FTP Services with Nmap</span></h4>
<p class="ai-optimize-204"><span style="color: #000000;">Firstly, run an Nmap scan to identify open FTP ports and save the output in grepable format:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p 21 target_ip -oG ftp_scan.txt</pre>
<p class="ai-optimize-206"><span style="color: #000000;"><strong>Explanation</strong><strong>:</strong></span></p>
<ul>
<li class="ai-optimize-207"><span style="color: #000000;"><strong>-p 21</strong>: Scans for FTP service on port 21.</span></li>
<li class="ai-optimize-208"><span style="color: #000000;"><strong>-oG ftp_scan.txt</strong>: Outputs the results in grepable format, which BruteSpray can parse.</span></li>
</ul>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhjNzZEuTdKQMeXqQ-n7xUG4WAsJGjPR1q9nBMS8ZiuysGMM9a4_OUe3KcVAd4lAvjS_Cr0Ev13S_-kB12PJcR8GxvMEC6hOOY2nAFcNPjKm1H6QKa90Lm9kdFhaIldDF1GfvUfcnih49LHG27RuubbXDT7c09GMcvpzWnUIK7xJD5xEL2q0NLxabBz7vel/s16000/10.png"/></p>
<h4 class="ai-optimize-209"><span style="color: #800000;">Step 2: Brute-Force FTP Logins with BruteSpray</span></h4>
<p class="ai-optimize-210"><span style="color: #000000;">Then, once the scan is complete, use BruteSpray to attempt logins against the identified FTP services using a username and password list:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">brutespray -f ftp_scan.txt -u user.txt -p pass.txt</pre>
<p class="ai-optimize-212"><span style="color: #000000;"><strong>Explanation</strong><strong>:</strong></span></p>
<ul>
<li class="ai-optimize-213"><span style="color: #000000;"><strong>-f ftp_scan.txt</strong>: Specifies the Nmap output file to use.</span></li>
<li class="ai-optimize-214"><span style="color: #000000;"><strong>-u user.txt</strong>: Path to the list of usernames.</span></li>
<li class="ai-optimize-215"><span style="color: #000000;"><strong>-p pass.txt</strong>: Path to the list of passwords.</span></li>
</ul>
<p class="ai-optimize-216"><span style="color: #000000;"> This workflow is particularly effective because it is ideal for automating brute force attempts immediately after service discovery, thereby streamlining the reconnaissance and exploitation phases of an engagement.</span><span style="color: #000000;">.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgohH2-49PMqLNu45bodxvjpsPNRa2R6nvlaK_LSAHRqQ8K-nC_bT7pU5sX2uPIaCXsg7SVDcUZ_W8aW-tOj96Hqx-VQxqSsAlYzDZVgGZ6N4RwXyh_tLWl20Emtk8FD0iwgq6olo5pBo2K90ybRtxplxIsvoGQAeaRCZmgdS4oa4dhsHZDY2RKTZ3ATn03/s16000/11.png"/></p>
<h4 class="ai-optimize-218"><span style="color: #000000;"><strong>Response Plan:</strong></span></h4>
<p class="ai-optimize-219"><span style="color: #000000;">IPs doing automated scans across several targets should be alerted and blocked; for instance, take Tarpitting as an example of dynamic deceit. Tarpitting is a defensive technique where a system intentionally slows down responses to suspected malicious activity—typically brute force or scanning attempts</span></p>
<h3 class="ai-optimize-220"><span style="color: #800000;">FTP Brute-Force – Offense, Defense &amp; MITRE Mapping</span></h3>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjnZU8ASgshPCC_qC9LOD0XAaQGJdvBxY3qXjMD6hrHS6OztP_bRFh2PyZp6C3mQwJDA37XYUta5p7r6Uy4Fqm8OcknHJmE9dxMEHTV1lo2iOg2JDQ59TUhjJhzZsvtk1BuGXRdKbsHV2knf81AHQgAoLk2w47uadl2sxEbHTAFeinowddF629juMh23ng3/s16000/1.png"/></p>
<h3 class="ai-optimize-221"><span style="color: #800000;">Defense-in-Depth Summary</span></h3>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg-KCbhuFhkeL3pBKplyZchjPeJlU4zknvuJhhhKMm5hWRb1JS-uUd6vCKh-htAx3PEvhq4gcxWL2HomDc4oVG45we9FyDp1DVB6PxCBeuJWKeUz0TGCS-EQKFKpi4AXJuxhZa2WTF4SdR6KJoajeZrWm7Tu0mo4RSv163jaqsqejrB0lwSMvuprHK3TAAp/s16000/table%203.png"/></p>
<p class="ai-optimize-231"><span style="color: #000000;">To learn more about Password Cracking. Follow this <a href="https://www.hackingarticles.in/category/password-cracking/"><strong><span style="color: #0000ff;">Link</span></strong>.</a></span></p>
<p class="ai-optimize-6"><strong><span style="color: #000000;">Author</span>: <span style="color: #000000;">Anmol Dev </span></strong><span style="color: #000000;">is a Technical Writer, Researcher and Penetration Tester<strong>. Contact here: <a href="https://www.linkedin.com/in/anmoldev/">Linkedin</a> </strong>and <a href="https://x.com/_anmoldev?t=TVZ743gyC6KMDH8kwaifBw&amp;s=09"><strong>Twitter.</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
