<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">HacktheBox Heist Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-heist-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-12-26T14:39:37+00:00">December 26, 2019</time><time class="updated" datetime="2025-06-27T13:07:32+00:00">June 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello! Everyone and Welcome to yet another CTF challenge from Hack the Box, called ‘Heist,’ which is available online for those who want to increase their skills in penetration testing and Black box testing. Heist is a retired vulnerable lab presented by Hack the Box for making online penetration testing practice suitable to your experience level; they have a large collection of vulnerable labs as challenges ranging from beginner to expert level.</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Easy</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> Find user.txt and root.txt in the victim’s machine</span></p>
<p><span style="color: #000000;">Penetration Methodologies</span></p>
<p><span style="color: #000000;"><strong>Scanning</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Browsing HTTP service</span></li>
<li><span style="color: #000000;">Extracting and decrypting User Information from config.txt</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploitation</strong></span></p>
<ul>
<li><span style="color: #000000;">Bruteforcing more users using impacket tool   </span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Using WinRm to get Root Access</span></li>
<li><span style="color: #000000;">Uploading Procdump64.exe to dump process</span></li>
<li><span style="color: #000000;">Capturing the flag</span></li>
</ul>
<h3><span style="color: #000000;">Walkthrough</span></h3>
<h3><span style="color: #800000;">Network Scanning</span></h3>
<p><span style="color: #000000;">Let’s get started then!</span></p>
<p><span style="color: #000000;">Since these labs have a static IP, the IP address for Heist is 10.10.10.149. Let us scan the VM with the most popular port scanning tool, nmap.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sC -sV -p- 10.10.10.149</pre>
<p><span style="color: #000000;">We learned from the scan that we have the port 80 open which is hosting Microsoft IIS httpd 10.0 service, and we have the port 135,445,5985,49669 open. This tells us that we have the Microsoft windows Rpc and Microsoft HTTP API service running on the target machine respectively.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2RfbHHMQSxk/XgTD5A2VCtI/AAAAAAAAiDc/I3076H8C4QQDxa2VmJifOo1UHbZYX_bFACLcBGAsYHQ/s1600/1.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">For more details, we will navigate to a web browser for exploring HTTP service since port 80 is open, which has a login portal.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Z0a5z9sJ4kA/XgTD54QddnI/AAAAAAAAiDo/QhrEFzqoLVsaIq7fCjfXOi2z9H5aRiHigCLcBGAsYHQ/s1600/2.png"/></span></p>
<p><span style="color: #000000;">There’s also an option to login as a guest so let’s try that.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ljHku97maRw/XgTD56VrI2I/AAAAAAAAiDk/KAFQBOXcbTUT_UWnqPSmeMNPy_n9UdBQgCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">From the picture above, We can see while login as a guest there is a user called hazard has posted an issue with his cisco router and has attached the configuration of it. Let’s open the file in the browser and see what information we get.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iP7XtMcwLoU/XgTD6OkwnYI/AAAAAAAAiDs/OvL6XzLyzK0-qRfjAdmdZx0sdM1N-u1SwCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">By reading the configuration files we can see that it contains two cisco <strong>type</strong> 7 and one cisco <strong>type</strong> 5 passwords.</span></p>
<p><span style="color: #000000;">We can decrypt <strong>type</strong> 7 passwords using a tool online tool. Following link :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://ibeast.com/tools/CiscoPassword</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-D-F80wvilSg/XgTD6rkAQdI/AAAAAAAAiD0/bkwgfs4JFSsLICLptwXfDWi_gmIeoamigCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">So here are the credentials we have collected till now:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">rout3r: $uperP@ssword</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IryCvWGvaUg/XgTD6neLieI/AAAAAAAAiDw/GQuU_igo0vUDU1onornw8PQaR9wPQMQaACLcBGAsYHQ/s1600/5a.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">admin: Q4)sJu\Y8qz*A3?d</pre>
<p><span style="color: #000000;">Also, we decrypted Cisco type 5 hash using hashcat command below</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hashcat -m 500 pass.txt /usr/share/wordlists/rockyou.txt --force --outfile output.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5ixe3kUP0-c/XgTD633O8AI/AAAAAAAAiD4/DDQl40qqAFEXLFSEb17H7ryesDxh11T9wCLcBGAsYHQ/s1600/5b.png"/></span></p>
<p><span style="color: #000000;">Which successfully cracked hash $1$pdQG$o8nrSzsGXeaduXrjlvKc91 : <strong>stealth1agent</strong></span></p>
<p><span style="color: #000000;">We tried all the combinations as well as to use these credentials on login portal but we failed to login.</span></p>
<p><span style="color: #000000;">Coming back to nmap scan. We can see that port 5895 is open which is used by Microsoft Windows Remote Management), which is basically a service/protocol used to manage remote systems.</span></p>
<p><span style="color: #000000;">So we tried to bruteforce more users with the tool Impacket. You can read more about the tool from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/impacket-guide-smb-msrpc/">here</a></strong></span>. And download the tool from <a style="color: #000000;" href="https://github.com/SecureAuthCorp/impacket">https://github.com/SecureAuthCorp/impacket</a></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python lookupsid.py Hazard:stealth1agent@10.10.10.149</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mBgk4n1l9EM/XgTD7VEOm1I/AAAAAAAAiD8/mgRS_4_6PC8eEsD9ztYB4W7SOq_VxiSpQCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">So to try these users with the combination of passwords we got earlier. We use a very great tool available WinRm shell for hacking/pentesting.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">https://github.com/Hackplayers/evil-winrm</pre>
<p><span style="color: #000000;">We tried all these users with the password and the pair below worked.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">"Chase:Q4)sJu\Y8qz*A3?d"</pre>
<p><span style="color: #000000;">Also, make sure to create ps1_scripts and exe_files directories in your home otherwise the tool won’t work. (mkdir ps1_scripts &amp; mkdir exe_files)</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">evil-winrm -i 10.10.10.149 -u chase -p 'Q4)sJu\Y8qz*A3?d' -s './ps1_scripts/' -e './exe_files/'
whoami
cd ..
cd Desktop
cat user.txt</pre>
<p><span style="color: #000000;">Here we managed to get user.txt as our first flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-p8CNxjfA3uo/XgTD7upAA_I/AAAAAAAAiEA/Ga8o3-UIGDoYncdvOGrXfPCn4vHWn3k1gCLcBGAsYHQ/s1600/7.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Now that we had a user.txt we have to find root.txt. So, after searching for a while we found that firefox instance was running.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd appdata\Roaming\Mozilla\firefox</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_4ngh84L1m0/XgTD8CpeCOI/AAAAAAAAiEE/8GkZovuJlY073idOyzrz8vt4kry34BhHACLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">We uploaded procdump64.exe to dump one of the processes. You can download procdump64.exe from <a style="color: #000000;" href="https://docs.microsoft.com/en-us/sysinternals/downloads/procdump">here</a>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">upload /var/www/html/procdump64.exe
ps</pre>
<p><span style="color: #000000;">After uploading procdump64.exe. We saw that there was 4 firefox process were running. So we took the having the highest CPU usage.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-bYVl0kAgd0U/XgTD8XVD2xI/AAAAAAAAiEI/My4_siio87Qw5-EA22LA6sntTXfBdPOnQCLcBGAsYHQ/s1600/9.png"/></strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./procdump64.exe -ma 7024</pre>
<p><span style="color: #000000;">This created a dump file and to analyse and search for sensitive information from dump file we used Winrm shell itself.</span></p>
<p><span style="color: #000000;">As the dump file has a lot of information so we use Select-String to filter the information as Select-String in PowerShell is similar to grep in Linux.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">firefox.exe_191291_111009.dmp | Select-String "username="</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JxXVe6jk33A/XgTD5ZZbJbI/AAAAAAAAiDg/q_AHNouDWLoIigzgoAHRbNBDX9wmXbvsQCLcBGAsYHQ/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Here we got administrator credentials. So we try to login as administrator in WinRm shell and try to capture the root flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">evil-winrm -i 10.10.10.149 -u administrator -p '4dD!5}x/re8]FBuZ' -s './ps1_scripts/' -e './exe_files/'\
whoami
cd ..
cd Desktop
cat root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4Sld7obsJh4/XgTD4_5MorI/AAAAAAAAiDY/I2iiotqoiZY12Gh6EraHZl8l_7gLADyegCLcBGAsYHQ/s1600/11.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Prabhjot Dunglay</strong> is a Cyber Security Enthusiast with 2 years of experience in Penetration Testing at Hacking Articles. Contact <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/prabhjotdunglay">here</a></strong></span>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
