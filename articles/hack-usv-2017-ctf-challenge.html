<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the USV: 2017 (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-usv-2017-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2018-01-26T05:35:44+00:00">January 26, 2018</time><time class="updated" datetime="2025-06-10T20:29:54+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF challenge known as USV: 2017. The credit for making this vm machine goes to “Suceava University” and it is another capture the flag challenge in which our goal is to find 5 flags to complete the challenge. You can download this VM <a style="color: #000000;" href="https://www.vulnhub.com/entry/usv-2017,219/#download"><strong>here</strong></a>.</span></p>
<p><span style="color: #000000;"><strong>Let’s Breach!!!</strong></span></p>
<p><span style="color: #000000;">Let us start form getting to know the IP of VM (Here, I have it at <strong>192.168.0.18 </strong>but you will have to find your own)</span></p>
<p><span style="color: #000000;">Let’s do an nmap scan for port enumeration.</span></p>
<pre class="lang:default decode:true">nmap -A -p- 192.168.0.18</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-qL7MPFNJMoc/WmofGPrhXlI/AAAAAAAATlg/L5z_TUSQxDYccRFqp4YeKQbzYVfI5RTSgCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">We find port 21,22,80,4369,5222,5269,5280,15020,33939 to be open. Port 80 is running http and port 15020 is running https.</span></p>
<p><span style="color: #000000;">So we first open 192.168.0.18 in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-81kmn41JhN0/WmofIhwFtdI/AAAAAAAATmA/X3cL6kTPrZQ7mzmzrpB0MAAafYjy_4_hQCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">We don’t find anything on this page so we enumerate the directories for further information.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.0.18</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ntnytglwfhA/WmofLO1iRBI/AAAAAAAATmg/FNp2gBSEqQwowprzdkARdEwkXFXo9u63ACLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">During our directory enumeration we find a page called admin2, we open it in our browser and find it to be login page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-fZ8H1Rwy9vw/WmofLanRYwI/AAAAAAAATmk/mhQ7Zh485_UxjiZlMJJZRvKAXZBhtv8kwCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We take a look at the source code and find that the password is hidden itself in the page. The page uses javascript to verify the password. The javascript is in hex encode</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-URF4YvLrPvI/WmofL-YGAlI/AAAAAAAATmo/NOTTbqQOELomH1OlEzMw-hO34T_V-S8fQCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We first decrypt the hex encode and find that if the value is 1079950212331060 it will let you enter or it will show wrong password. Now the final value is calculated using a formula:</span></p>
<p><span style="color: #000000;"><strong>(stringconcat(password+4469)-234562221224)*1988=1079950212331060</strong></span></p>
<p><span style="color: #000000;">Now when we calculate the value of the password we find it to be 77779673. When we enter it we get the 1<sup>st</sup> flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-M5ScpKJpm5w/WmofLwvVmpI/AAAAAAAATms/l5jQt7nB3Q4bYi2NcOF_F9P14LATiOwIgCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Now we open the ip 192.168.0.18 at port 15020 as it is running another apache service. When we open the ip on our browser we find that we need to install ssl certificate. We take a look at the details of the certificate for information; at the issuer section we find our 2<sup>nd</sup> flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-7a-a78eVPjA/WmofMPQmONI/AAAAAAAATmw/hp861X9W21YNfatVPFRFc5hUIXlHVUpLwCLcBGAs/s1600/7.1.png"/></span></p>
<p><span style="color: #000000;">We accept the certificate and open the web page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-uXS5iP-IZr4/WmofNbl2bLI/AAAAAAAATm0/VRNW4b1qcgog02PWBLSbv80fk_lBYmRZACLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">We don’t find anything on the webpage. So we enumerate the directories on this page.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.0.18:15020</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ceeHKa5GvTw/WmofNSKSBEI/AAAAAAAATm4/sHUGtPNBlpY96EZsrW4YdHesRo0WzdvtACLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Here we find two interesting directories blog/ and vault/. The vault/ directory contain an enormous amount of directories so we leave it for now.</span></p>
<p><span style="color: #000000;">We open blog/ directory and find a few blogs with few comments.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/--Xm571Gd6fI/WmofNpBDtWI/AAAAAAAATm8/wRuKtK2hhZcGvMITtWUEZDC7iBk4986XQCLcBGAs/s1600/9.png"/></span></p>
<p> </p>
<p><span style="color: #000000;">Now going through the blogs we find kevin’s blog with 1 comment that hints it has a flag inside his home directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ZVjP-zk3SHs/WmofGEtDBqI/AAAAAAAATlo/UCjFsx1gGgcgAjrf8ia5NW1MQe7r4PVsgCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">We take a look inside source code and hint to open a php file called download.php.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-WuZQs7r5sio/WmofGERy9LI/AAAAAAAATlk/qO-k9xcKHIAdotGB7kaQO3lAzExIg9LogCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">When we open it we find to use image parameter to open file, this page maybe vulnerable to LFI.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-N1dMyBpFapU/WmofHCnKMTI/AAAAAAAATls/DHLz3h5_F4kZQLc3X9HptPbcBDawlPQnQCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">We cannot exploit LFI vulnerability using the browser, we use post data using curl to exploit the LFI vulnerability.</span></p>
<pre class="lang:default decode:true">curl -d "image=/etc/passwd" https://192.168.0.18:15020/blog/download.php -k</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wewh6PGwt2c/WmofHQfGGYI/AAAAAAAATlw/_yoEO8remaox2DXXm34N2cOKh1i9atBagCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Now as it was wriiten in the comment of kevin’s blog we check for the flag in /home/kevin/ directory and find the 3<sup>rd</sup> flag.</span></p>
<pre class="lang:default decode:true">curl -d "image=/home/kevin/flag.txt" https://192.168.0.18:15020/blog/download.php -k</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-UgZTKrVZq3g/WmofHhBfAVI/AAAAAAAATl0/mCwBzh51IQUx3LHBuCa_Y4yCtnk6NO85QCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Now we go to the other vault/ directory, it contains a lot of directories so we download it on our system to make it easier for us to look through the directories. We download the entire site using recursive download utility of wget.</span></p>
<pre class="lang:default decode:true">wget  -r –no-check-certificate http://192.168.0.18:15020/vault</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ntzu7EHwesg/WmofH7uJQoI/AAAAAAAATl4/gBMRlNP8m5ETnu2Hi5CHQBMYqX-8rYqCQCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now we use find command to look for files and we use grep to rule out .html files. We found two files rockyou.zip and and a cap file.</span></p>
<pre class="lang:default decode:true">find ./ -type f | grep -v .html</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-mZvDGespDrQ/WmofIKUKaVI/AAAAAAAATl8/PEIElhsCvGUJRofFCwr-D0tvEgnls50cQCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">We open the cap file using wireshark going through the packets we found it to be a wifi handshake file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-YfSvrTUceHg/WmofI0GMjUI/AAAAAAAATmE/ImgbwGkc-xI-T6xGOcsXLPyHg0RJUN6jgCLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">We use this site here to convert the cap file to hccapx, to make it compatible for hashcat.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-lA_XcV-6eVE/WmofJDf_FYI/AAAAAAAATmI/-9hubvQTZC0RH0lAxX3ubJzpE9STsp7kQCLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;">Now we use hashcat to decrypt the the handshake. We use the wordlist provided by the server just in case it had some extra keywords.</span></p>
<pre class="lang:default decode:true">hashcat -m 2500 -a 0 ctf.hccapx 192.168.0.18:15020/rockyou.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HIZVn1e9yw4/WmofOD0IHPI/AAAAAAAATnA/uI2yuFwBQvgL1jeGnkbkYTA0yJ2Wl_71wCLcBGAs/s1600/hash.png"/></span></p>
<p><span style="color: #000000;">We use username admin and the password we find from hashcat that is “minion.666” to login through the admin page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FyXV2YLbpT4/WmofJQMhcaI/AAAAAAAATmM/xmMyux_mQ4sm7jUoKXCkDr8LzaxDtTaiQCLcBGAs/s1600/22.png"/></span></p>
<p><span style="color: #000000;">As soon as we login this page, we find that this page maybe vulnerable to sql injection.</span></p>
<p><span style="color: #000000;">Now we use burpsuite to capture the request and use CO2 extension of burpsuite to exploit the sql injection but first we take a look at the source code.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-PVyColgwUI4/WmofJyo_kiI/AAAAAAAATmU/W2c5tB0iLGAuctx6mOsfF12Lt4QZOb7FgCLcBGAs/s1600/23.png"/></span></p>
<p><span style="color: #000000;">When we look at the source code we find our 4<sup>th</sup> flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-19AXl5ibu48/WmofJw-9QXI/AAAAAAAATmQ/4aQ3kocR8HgrQg2K2LHsUm3pzHCnB4l3ACLcBGAs/s1600/24.1.png"/></span></p>
<p><span style="color: #000000;">Now we use CO2 for SQL injection. We select database, tables, columns and dump to grab all the name of databases,tables and columns. </span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-AeDcOBiBSQY/WmwvP_CWNfI/AAAAAAAATns/jSbNd335zk8AOvXnD7D7sBLl1gI6rElBgCLcBGAs/s1600/24.2%2B%25281%2529.png"/></p>
<p><span style="color: #000000;">It gave us the name of the database, tables and columns. Unfortunately it couldn’t dump the database for some reason. So we manually exploit the sql injection through the browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-1ZmE0ZLNypo/WmofKD7D_1I/AAAAAAAATmY/CpyI2piWqBIY2aQjLytuble8Nr_ASIYKACLcBGAs/s1600/24.png"/></span></p>
<p><span style="color: #000000;">We find that the server uses a firewall that blocks any sql query. We use normalization method to bypass this firewall. With name of the columns and table we were able to execute our SQL injection.</span></p>
<pre class="lang:default decode:true  ">https://192.168.0.18:15020/blog/admin/edit.php?id=7 /*union*/union/*all*/all/*select*/select%20,1,login,password,4%20from%20users%20order%20by%201%20limit%201,1</pre>
<p><span style="color: #000000;">When we change the parameter of the id the output also changes, after going through different parameters we find that parameter 7 gave us our 5<sup>th</sup> and final flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-c9Yz5cyj1ts/WmofLBUaoQI/AAAAAAAATmc/BcdjTImych4uFp7kk5aY8vDIlbw8AL1FwCLcBGAs/s1600/25.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
