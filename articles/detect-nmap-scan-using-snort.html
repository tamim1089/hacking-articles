<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/nmap/" rel="category tag">Nmap</a>, <a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">How to Detect NMAP Scan Using Snort</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/detect-nmap-scan-using-snort/" rel="bookmark"><time class="entry-date published" datetime="2017-12-22T14:37:55+00:00">December 22, 2017</time><time class="updated" datetime="2025-05-28T12:47:44+00:00">May 28, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">Today we are going to discuss how to Detect NMAP scan using Snort but before moving ahead kindly read our previous articles related to Snort Installation (<a style="color: #000000;" href="http://www.hackingarticles.in/ids-ips-penetration-testing-lab-setup-snort/"><strong>Manually</strong></a> or using <a style="color: #000000;" href="https://www.hackingarticles.in/comprehensive-guide-on-snort-part-1/"><strong>apt-respiratory</strong></a>)and its <a style="color: #000000;" href="https://www.hackingarticles.in/comprehensive-guide-on-snort-part-1/"><strong>rule configuration</strong></a> to enable it as IDS for your network.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;">Basically, in this article, we are testing Snort against NMAP various scan which will help network security analyst to setup snort rule in such a way so that they become aware of any kind of NMAP scanning.</span></p>
<h3 class="ai-optimize-8"><span style="color: #000000;"><span style="color: #800000;">Requirement</span> </span></h3>
<p class="ai-optimize-9"><span style="color: #000000;"><strong>Attacker:</strong> Kali Linux (NMAP Scan)</span></p>
<p class="ai-optimize-10"><span style="color: #000000;"><strong>Target:</strong> Ubuntu (Snort as IDS)</span></p>
<p class="ai-optimize-11"><span style="color: #000000;"><strong>Optional:</strong> Wireshark (we have added it in our tutorial so that we can clearly confirm all incoming and outgoing packets of a network)</span></p>
<p class="ai-optimize-12"><span style="color: #000000;"><strong>Let’s Begins!!</strong></span></p>
<h3 class="ai-optimize-13"><span style="color: #800000;">Identify NMAP Ping Scan</span></h3>
<p class="ai-optimize-14"><span style="color: #000000;">As we know any attacker will start the attack by identifying host status by sending ICMP packet using ping scan. Therefore be smart and add a rule in snort which will analyst NMAP Ping scan when someone tries to scan your network for identifying a live host of a network.</span></p>
<p class="ai-optimize-15"><span style="color: #000000;">Execute given below command in ubuntu’s terminal to open snort local rule file in text editor.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo gedit /etc/snort/rules/local.rules</pre>
<p class="ai-optimize-16"><span style="color: #000000;">Now add given below line which will capture the incoming traffic coming on 192.168.1.105(ubuntu IP) network for ICMP protocol.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">alert icmp any any -&gt; 192.168.1.105 any (msg: "NMAP ping sweep Scan"; dsize:0;sid:10000004; rev: 1;)</pre>
<p class="ai-optimize-17"><span style="color: #000000;">Turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p class="ai-optimize-18"><span style="color: #000000;">Now using attacking machine execute given below command to identify the status of the target machine i.e. host is UP or Down.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sP 192.168.1.105 --disable-arp-ping</pre>
<p class="ai-optimize-19"><span style="color: #000000;">If you will execute above command without parameter “disable arp-ping” then will work as default ping sweep scan which will send arp packets in spite of sending ICMP on targets network and maybe snort not able to capture NMAP Ping scan in that scenario, therefore we had use parameter “disable arp-ping” in the above command.</span></p>
<p class="ai-optimize-20"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-WMbujilAGTM/Wj0LjcqfC-I/AAAAAAAASt4/IloEwrtPYKgZ_4Q-ngAqaPynJZrmoPsHgCEwYBhgL/s1600/2.1.png"/></span></p>
<p class="ai-optimize-21"><span style="color: #000000;">As I had declaimed above why we are involving Wireshark in this tutorial so that you can clearly see the packet sends form attacker network to targets network. Hence in given below image, you can notice ICMP request packet along with ICMP reply packets. These both are parts of network traffic.</span></p>
<p class="ai-optimize-22"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ZtV5VQOvPeA/Wj0Lji7sGgI/AAAAAAAASt4/GtcgX4L_O70SCauNokK3prdmlPht2qqCACEwYBhgL/s1600/2.png"/></span></p>
<p class="ai-optimize-23"><span style="color: #000000;">Come back to over your target machine where snort is capturing all in-coming traffic. Here, you will observe that it is generating an alert for NMAP Ping Sweep scan.  Hence, you can block the attacker’s IP to protect your network from further scanning.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p class="ai-optimize-24"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-TB76M24AJoY/Wj0Lk0q63mI/AAAAAAAASt4/zQ8fuGDnrbo26kbLwgMyv0gGFCnqvOQhgCEwYBhgL/s1600/3.png"/></span></p>
<h3 class="ai-optimize-25"><span style="color: #800000;">Identify NMAP TCP Scan</span></h3>
<p class="ai-optimize-26"><span style="color: #000000;">Now in order to connect with the target network, an attacker may go for networking enumeration either using TCP Protocol or UDP protocol. Let’s assume attacker may choose TCP scanning for network enumeration then in that situation we can apply the following rule in snort local rule file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">alert tcp any any -&gt; 192.168.1.105 22 (msg: "NMAP TCP Scan";sid:10000005; rev:2; )</pre>
<p class="ai-optimize-27"><span style="color: #000000;">Above rule is only applicable for port 22 so if you want to scan any other port then replace 22 from the port you want to scan or else you can also use “any” to analysis all ports. Enable the NIDS mode of snort as done above.</span></p>
<p class="ai-optimize-28"><span style="color: #000000;">Now again using the attacker machine execute the given below command for TCP scan on port 22.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sT -p22 192.168.1.105</pre>
<p class="ai-optimize-29"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Z0geTV4R2c8/Wj0LldzbJGI/AAAAAAAASt4/vlSGsxHQaz8TEmwITuJuS-79RiNNvYEswCEwYBhgL/s1600/5.png"/></span></p>
<p class="ai-optimize-30"><span style="color: #000000;">From the image given below, you can observe Wireshark has captured TCP packets from 192.168.1.104 to 192.168.1.105</span></p>
<p class="ai-optimize-31"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jQ45rTW5sFA/Wj0LlpD6lzI/AAAAAAAASt4/yUjXnwyceboJHYJ5Co9tycYEL_s-so5WQCEwYBhgL/s1600/6.png"/></span></p>
<p class="ai-optimize-32"><span style="color: #000000;">Here you can confirm that our snort is absolutely working when the attacker is scanning port 22 using nmap TCP scan and it is showing attacker’s IP from where traffic is coming on port 22. Hence you can block this IP to protect your network from further scanning.</span></p>
<p class="ai-optimize-33"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-yj5j62hePy8/Wj0Ll60BZDI/AAAAAAAASt4/bZNEVukmsDECPJjo7gkd-E08HcifNr8TQCEwYBhgL/s1600/7.png"/></span></p>
<h3 class="ai-optimize-34"><span style="color: #800000;">Identify NMAP XMAS Scan</span></h3>
<p class="ai-optimize-35"><span style="color: #000000;">As we know that TCP communication follows three-way handshake to established TCP connection with target machine but sometimes instead of using SYN, SYN/ACK, ACK flag attacker choose XMAS scan to connect with the target by sending data packets through Fin, PSH &amp; URG flags.</span></p>
<p class="ai-optimize-36"><span style="color: #000000;"> Let assume attacker may choose XMAS scanning for network enumeration then in that situation we can apply the following rule in snort local rule file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">alert tcp any any -&gt; 192.168.1.105 22 (msg:"Nmap XMAS Tree Scan"; flags:FPU; sid:1000006; rev:1; )</pre>
<p class="ai-optimize-37"><span style="color: #000000;">Again above rule is only applicable for port 22  which will listen for incoming traffic when packets come from Fin, PSH &amp; URG flags. So if you want to scan any other port then replace 22 from the port you want to scan else you can also use “any” to analysis all ports. Enable the NIDS mode of snort as done above.</span></p>
<p class="ai-optimize-38"><span style="color: #000000;">Now again using the attacker machine execute the given below command for XMAS scan on port 22.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sX -p22 192.168.1.105</pre>
<p class="ai-optimize-39"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-kyjA3U4FxBU/Wj0LmdSSWwI/AAAAAAAASt4/gPLjiT237rU1roTx_SjAHhx0xCrCFUfywCEwYBhgL/s1600/9.png"/></span></p>
<p class="ai-optimize-40"><span style="color: #000000;">From given below image you can observe that Wireshark is showing 2 packets from attacker machine to target machine has been sent using FIN, PSH, URG flags.</span></p>
<p class="ai-optimize-41"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-AvjeYEbhHJY/Wj0Lf1iYtxI/AAAAAAAASt4/av2hoVLDZk42s1IkJo8J9QwsXwNNZ8pmACEwYBhgL/s1600/10.png"/></span></p>
<p class="ai-optimize-42"><span style="color: #000000;">Come back to over your target machine where snort is capturing all incoming traffic here you will observe that it is generating an alert for NMAP XMAP scan.  Hence you can block the attacker’s IP to protect your network from further scanning.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p class="ai-optimize-43"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-p3XV2g1_tyg/Wj0Lfx1l_SI/AAAAAAAASt4/PjnJJf4QDDkJW_DYVO-53T5WFUT9UleHgCEwYBhgL/s1600/11.png"/></span></p>
<h3 class="ai-optimize-44"><span style="color: #800000;">Identify NMAP FIN Scan</span></h3>
<p class="ai-optimize-45"><span style="color: #000000;">Instead of using SYN, SYN/ACK and ACK flag to established TCP connection with the target machine may attacker choose FIN scan to connect with the target by sending data packets through Fin flags only.</span></p>
<p class="ai-optimize-46"><span style="color: #000000;"> Let assume attacker may choose FIN scanning for network enumeration then in that situation we can apply the following rule in snort local rule file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">alert tcp any any -&gt; 192.168.1.105 22 (msg:"Nmap FIN Scan"; flags:F; sid:1000008; rev:1;)</pre>
<p class="ai-optimize-47"><span style="color: #000000;">Again above rule is only applicable for port 22 which will listen for incoming traffic when packets come from Fin Flags. So if you want to scan any other port then replace 22 from the port you want to scan else you can also use “any” to analysis all ports. Enable NIDS mode of snort as done above.</span></p>
<p class="ai-optimize-48"><span style="color: #000000;">Now again using the attacker machine execute the given below command for FIN scan on port 22.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sF -p22 192.168.1.105</pre>
<p class="ai-optimize-49"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Y_y0JMKEhas/Wj0LgtIY-EI/AAAAAAAASt4/EkhdhHsGgvEBCcntPbl6TY7Pr5ICEV2nwCEwYBhgL/s1600/13.png"/></span></p>
<p class="ai-optimize-50"><span style="color: #000000;">From given below image you can observe that Wireshark is showing 2 packets from attacker machine to target machine has been sending using FIN flags.</span></p>
<p class="ai-optimize-51"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yK1gIX-KDiY/Wj0LhNy8_xI/AAAAAAAASt8/sXq1lS8RK3o7KAfGiWjsAMFRH28-JmpegCEwYBhgL/s1600/14.png"/></span></p>
<p class="ai-optimize-52"><span style="color: #000000;">Come back to over your target machine where snort is capturing all incoming traffic here you will observe that it is generating an alert for NMAP FIN scan. Hence you can block the attacker’s IP to protect your network from further scanning.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p class="ai-optimize-53"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-nUeeKwCFae4/Wj0LhcMi5PI/AAAAAAAASt4/cD2LP7y037IYslovhM28zZm-YKsyPxoTACEwYBhgL/s1600/15.png"/></span></p>
<h3 class="ai-optimize-54"><span style="color: #800000;">Identify NMAP NULL Scan</span></h3>
<p class="ai-optimize-55"><span style="color: #000000;">Instead of using SYN, SYN/ACK and ACK flag to established TCP connection with the target machine may attacker choose NULL scan to connect with the target by sending data packets through NONE flags only.</span></p>
<p class="ai-optimize-56"><span style="color: #000000;"> Let assume attacker may choose NULL scanning for network enumeration then in that situation we can apply the following rule in snort local rule file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">alert tcp any any -&gt; 192.168.1.105 22 (msg:"Nmap NULL Scan"; flags:0; sid:1000009; rev:1; )</pre>
<p class="ai-optimize-57"><span style="color: #000000;">Again above rule is only applicable for port 22 which will listen for incoming traffic when packets come from NONE Flags. So if you want to scan any other port then replace 22 from the port you want to scan else you can also use “any” to analysis all ports. Enable the NIDS mode of snort as done above.</span></p>
<p class="ai-optimize-58"><span style="color: #000000;">Now again using the attacker machine execute the given below command for the NULL scan on port 22.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sN -p22 192.168.1.105</pre>
<p class="ai-optimize-59"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-dldHDytbadg/Wj0Lh7SqHxI/AAAAAAAASt4/iMpSOluS8TswnWq77Ntn5ZbSMJd4eK89wCEwYBhgL/s1600/17.png"/></span></p>
<p class="ai-optimize-60"><span style="color: #000000;">From given below image you can observe that Wireshark is showing 2 packets from attacker machine to target machine has been sending using NONE flags.</span></p>
<p class="ai-optimize-61"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-EszMF9Kndfs/Wj0Li7-W5jI/AAAAAAAASt4/qxJ85qFNChEnEoFBNY23D6dpQyBTljUGwCEwYBhgL/s1600/18.png"/></span></p>
<p class="ai-optimize-62"><span style="color: #000000;">Come back to over your target machine where snort is capturing all incoming traffic here you will observe that it is generating an alert for NMAP Null scan. Hence you can block the attacker’s IP to protect your network from further scanning.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p class="ai-optimize-63"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ME0H9L53MDI/Wj0Li_m5AbI/AAAAAAAASt8/mKqmMo4twKMysgmKZc4AfgGa7YXoLm-PACEwYBhgL/s1600/19.png"/></span></p>
<h3 class="ai-optimize-64"><span style="color: #800000;">Identify NMAP UDP Scan</span></h3>
<p class="ai-optimize-65"><span style="color: #000000;">In order to Identify open UDP port and running services attacker may choose NMAP UDP scan to establish a connection with target machine for network enumeration then in that situation, we can apply the following rule in snort local rule file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">alert udp any any -&gt; 192.168.1.105 any ( msg:"Nmap UDP Scan"; sid:1000010; rev:1; )</pre>
<p class="ai-optimize-66"><span style="color: #000000;">Again above rule is applicable for every UDP port which will listen for incoming traffic when packets are coming over any UDP port, so if you want to capture traffic for any particular UDP port then replace “any” from that specific port number as done above. </span><span style="color: #000000;">Enable the NIDS mode of snort as done above.</span></p>
<p class="ai-optimize-67"><span style="color: #000000;">Now again using the attacker machine execute the given below command for a NULL scan on port 22.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sU -p68 192.168.1.105</pre>
<p class="ai-optimize-68"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uObHnBQx6kM/Wj0Ljy8D88I/AAAAAAAASt4/qToxkWt4J6QjQLPNAD90yQUiezBMMBAVACEwYBhgL/s1600/21.png"/></span></p>
<p class="ai-optimize-69"><span style="color: #000000;">From given below image you can observe that Wireshark is showing 2 packets from attacker machine to target machine has been sending over UDP Port.</span></p>
<p class="ai-optimize-70"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sxnEA8XT3Lc/Wj0LkOA6P9I/AAAAAAAASt4/Esba5Wk7exA3Smx9vfu9aM-sCH9e0LuSQCEwYBhgL/s1600/22.png"/></span></p>
<p class="ai-optimize-71"><span style="color: #000000;">Come back to over your target machine where snort is capturing all incoming traffic here you will observe that it is generating an alert for NMAP UDP scan. Hence you can block the attacker’s IP to protect your network from further scanning.</span></p>
<p class="ai-optimize-72"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-PdLTT-H4gPs/Wj0LkhKfnqI/AAAAAAAASt4/SHD7-1hB6o0_Pve8n6jEDo-Wl_ghpI4CwCEwYBhgL/s1600/23.png"/></span></p>
<p class="ai-optimize-73"><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
