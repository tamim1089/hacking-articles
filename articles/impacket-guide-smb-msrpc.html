<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Impacket Guide: SMB/MSRPC</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/impacket-guide-smb-msrpc/" rel="bookmark"><time class="entry-date published" datetime="2020-05-07T08:01:09+00:00">May 7, 2020</time><time class="updated" datetime="2025-05-31T10:40:18+00:00">May 31, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">There have been many Red Team scenarios, Capture the Flag challenges where we face the Windows Server. After exploiting and getting the initial foothold in the server, it is tough to extract the data and as well as there are scenarios where we couldn’t get onto the server per se. But using the SMB, we can execute commands remotely on the server. The SecureAuth visualized this, and they gave us one of the most amazing collections of Python classes for working on different protocols. This collection is named Impacket.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;">Official GitHub Repository:   <a style="color: #000000;" href="https://github.com/SecureAuthCorp/impacket">SecureAuthCorp /impacket</a></span></p>
<h3 class="ai-optimize-8"><span style="color: #800000;">Table of Contents</span></h3>
<ul>
<li class="ai-optimize-9"><span style="color: #000000;"><strong>Introduction to SMB</strong></span></li>
<li class="ai-optimize-10"><span style="color: #000000;"><strong>Introduction to MSRPC</strong></span></li>
<li class="ai-optimize-11"><span style="color: #000000;"><strong>Configurations Used in Practical</strong></span></li>
<li class="ai-optimize-12"><span style="color: #000000;"><strong>Impacket Categories</strong></span></li>
<li class="ai-optimize-13"><span style="color: #000000;"><strong>Installation</strong></span></li>
<li class="ai-optimize-14"><span style="color: #000000;"><strong>smbclient.py</strong></span></li>
<li class="ai-optimize-15"><span style="color: #000000;"><strong>lookupsid.py</strong></span></li>
<li class="ai-optimize-16"><span style="color: #000000;"><strong>reg.py</strong></span></li>
<li class="ai-optimize-17"><span style="color: #000000;"><strong>rpcdump.py</strong></span></li>
<li class="ai-optimize-18"><span style="color: #000000;"><strong>samrdump.py</strong></span></li>
<li class="ai-optimize-19"><span style="color: #000000;"><strong>services.py</strong></span></li>
<li class="ai-optimize-20"><span style="color: #000000;"><strong>ifmap.py</strong></span></li>
<li class="ai-optimize-21"><span style="color: #000000;"><strong>opdump.py</strong></span></li>
<li class="ai-optimize-22"><span style="color: #000000;"><strong>getArch.py</strong></span></li>
<li class="ai-optimize-23"><span style="color: #000000;"><strong>netview.py</strong></span></li>
<li class="ai-optimize-24"><span style="color: #000000;"><strong>Conclusion</strong></span></li>
</ul>
<h3 class="ai-optimize-25"><span style="color: #800000;">Introduction to SMB</span></h3>
<p class="ai-optimize-26"><span style="color: #000000;">The SMB is a network protocol which is also known as the Server Message Block protocol. It is used to communicate between a client and a server. SMB can be used to share the files, printers and some other network resources. It was created by IBM in the 1980s.</span></p>
<h3 class="ai-optimize-27"><span style="color: #800000;">Introduction to MSRPC</span></h3>
<p class="ai-optimize-28"><span style="color: #000000;">MSRPC, or Microsoft Remote Procedure Call, is essentially a modified version of DCE/RPC. Specifically, it was created by Microsoft to seamlessly implement a client/server model within the Windows environment. Moreover, the Windows Server domain protocols are entirely based on MSRPC, highlighting its foundational role in Microsoft’s network architecture.</span></p>
<h3 class="ai-optimize-29"><span style="color: #800000;">Configurations Used in Practical</span></h3>
<ul>
<li class="ai-optimize-30"><span style="color: #000000;"><strong>Attacker Machine</strong></span>
<ul>
<li class="ai-optimize-31"><span style="color: #000000;"><strong>OS: </strong>Kali Linux 2020.1</span></li>
<li class="ai-optimize-32"><span style="color: #000000;"><strong>IP Address: </strong>168.1.112</span></li>
</ul>
</li>
<li class="ai-optimize-33"><span style="color: #000000;"><strong>Target Machine</strong></span>
<ul>
<li class="ai-optimize-34"><span style="color: #000000;"><strong>OS: </strong>Windows Server 2016</span></li>
<li class="ai-optimize-35"><span style="color: #000000;"><strong>IP Address: </strong>168.1.105</span></li>
</ul>
</li>
</ul>
<h3 class="ai-optimize-36"><span style="color: #800000;">Impacket Categories</span></h3>
<ul>
<li class="ai-optimize-37"><span style="color: #000000;"><strong>Remote Execution</strong></span></li>
<li class="ai-optimize-38"><span style="color: #000000;"><strong>Kerberos</strong></span></li>
<li class="ai-optimize-39"><span style="color: #000000;"><strong>Windows Secrets</strong></span></li>
<li class="ai-optimize-40"><span style="color: #000000;"><strong>Server Tools/MiTM Attacks</strong></span></li>
<li class="ai-optimize-41"><span style="color: #000000;"><strong>WMI</strong></span></li>
<li class="ai-optimize-42"><span style="color: #000000;"><strong>Known Vulnerabilities</strong></span></li>
<li class="ai-optimize-43"><span style="color: #000000;"><strong>SMB/MSRPC</strong></span>
<ul>
<li class="ai-optimize-44"><span style="color: #000000;">smbclient.py</span></li>
<li class="ai-optimize-45"><span style="color: #000000;">lookupsid.py</span></li>
<li class="ai-optimize-46"><span style="color: #000000;">reg.py</span></li>
<li class="ai-optimize-47"><span style="color: #000000;">rpcdump.py</span></li>
<li class="ai-optimize-48"><span style="color: #000000;">samrdump.py</span></li>
<li class="ai-optimize-49"><span style="color: #000000;">services.py</span></li>
<li class="ai-optimize-50"><span style="color: #000000;">ifmap.py</span></li>
<li class="ai-optimize-51"><span style="color: #000000;">opdump.py</span></li>
<li class="ai-optimize-52"><span style="color: #000000;">getArch.py</span></li>
<li class="ai-optimize-53"><span style="color: #000000;">netview.py</span></li>
</ul>
</li>
<li class="ai-optimize-54"><span style="color: #000000;"><strong>MSSQL / TDS</strong></span></li>
<li class="ai-optimize-55"><span style="color: #000000;"><strong>File Formats</strong></span></li>
<li class="ai-optimize-56"><span style="color: #000000;"><strong>Other</strong></span></li>
</ul>
<h3 class="ai-optimize-57"><span style="color: #800000;">Installation </span></h3>
<p class="ai-optimize-58"><span style="color: #000000;">Before using the Impacket tool kit on our system, we need to install it. The installation process is quite simple. First, head to the GitHub Repository by clicking <a style="color: #000000;" href="https://github.com/SecureAuthCorp/impacket">here</a>. Then using the git clone command, we clone the complete repository to our Attacker Machine. After cloning we can see that there is a setup.py file, let us install it. After installation, we will head to the examples directory and use the scripts as per our convenience.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/SecureAuthCorp/impacket.git
cd impacket/
ls
python setup.py install</pre>
<h3><img decoding="async" src="https://1.bp.blogspot.com/-b6AT1zs6_b4/XrO6XLX4AXI/AAAAAAAAj5I/vGKeMzTL-lwlyzZ5IEs1_dd6l4o1IfboACLcBGAsYHQ/s1600/0.png"/></h3>
<h3 class="ai-optimize-59"><span style="color: #800000;">smbclient.py</span></h3>
<p class="ai-optimize-60"><span style="color: #000000;">There are moments where we needed to perform multiple actions between the attacker machine and the target machine. It can be listing shares and files, renaming some file, uploading the binaries or downloading files from the target machine. There are some situations where we even need to create a folder or two on the target machine. Performing such actions can get tricky while working with a shell that can be detected or can close at any time. The smbclient.py script helps us in these situations. It can connect to the Target Machine with the help of a bunch of attributes.</span></p>
<p class="ai-optimize-61"><span style="color: #000000;"><strong>Requirements:</strong></span></p>
<ul>
<li class="ai-optimize-62"><span style="color: #000000;"><strong>Domain</strong></span></li>
<li class="ai-optimize-63"><span style="color: #000000;"><strong>Username</strong></span></li>
<li class="ai-optimize-64"><span style="color: #000000;"><strong>Password/Password Hash</strong></span></li>
<li class="ai-optimize-65"><span style="color: #000000;"><strong>Target IP Address</strong></span></li>
</ul>
<p class="ai-optimize-66"><span style="color: #000000;">When we provide the following parameters to the smbclient in such a format as shown below and we will get connected to the target machine and we have an smb shell which can run a whole range of commands like dir, cd, pwd, put, rename, more, del, rm, mkdir, rmdir, info, etc</span></p>
<p class="ai-optimize-67"><span style="color: #000000;"><strong>Syntax: </strong></span></p>
<p class="ai-optimize-68"><span style="color: #000000;"><strong>smbclient.py [domain]/[user]:[password/password hash]@[Target IP Address]</strong></span></p>
<p class="ai-optimize-69"><span style="color: #000000;"><strong>Command:</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">smbclient.py ignite/Administrator:Ignite@987@192.168.1.105</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-vy6Cq2EqEI0/XrO6XJ0p7iI/AAAAAAAAj5E/-HEApXasYmw1kBujyMeKodUnO9obPVa-QCLcBGAsYHQ/s1600/1.png"/></p>
<h3 class="ai-optimize-70"><span style="color: #800000;">lookupsid.py</span></h3>
<p class="ai-optimize-71"><span style="color: #000000;">A Security Identifier (SID) is a unique value of variable length that is used to identify a user account. Through a SID User Enumeration, we can extract the information about what users exist and their data. Lookupsid script can enumerate both local and domain users. There is a Metasploit module too for this attack. If you are planning on injecting a target server with a golden or a silver ticket then one of the things that are required is the SID of the 500 user. Lookupsid.py can be used in that scenario. When we provide the following parameters to the Lookupsid in such a format as shown below.</span></p>
<p class="ai-optimize-72"><span style="color: #000000;"><strong>Requirements:</strong></span></p>
<ul>
<li class="ai-optimize-73"><span style="color: #000000;"><strong>Domain</strong></span></li>
<li class="ai-optimize-74"><span style="color: #000000;"><strong>Username</strong></span></li>
<li class="ai-optimize-75"><span style="color: #000000;"><strong>Password/Password Hash</strong></span></li>
<li class="ai-optimize-76"><span style="color: #000000;"><strong>Target IP Address</strong></span></li>
</ul>
<p class="ai-optimize-77"><span style="color: #000000;"><strong>Syntax: </strong></span></p>
<p class="ai-optimize-78"><span style="color: #000000;"><strong>lookupsid.py [domain]/[user]:[password/password hash]@[Target IP Address]</strong></span></p>
<p class="ai-optimize-79"><span style="color: #000000;"><strong>Command:</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">lookupsid.py ignite/Administrator:Ignite@987@192.168.1.105</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-fQnOFVv4gHc/XrO6YJe_PBI/AAAAAAAAj5Q/E1CnhusKG98DyCZKr7mjL_GoGuiYHVrbwCLcBGAsYHQ/s1600/2.png"/></p>
<h3 class="ai-optimize-80"><span style="color: #800000;">reg.py</span></h3>
<p class="ai-optimize-81"><span style="color: #000000;">This Impacket script is ripped straight out of the reg.exe of the Windows OS. Reg.exe is an executable service that can read, modify and delete registry values when used with eh combination of the query, add, delete keywords respectively. We can even begin to express the importance of access to the registry. Registry controls each and every aspect of the system. It can be used to gain information about the various policies, software and also alter some of those policies.</span></p>
<p class="ai-optimize-82"><span style="color: #000000;"><strong>Requirements:</strong></span></p>
<ul>
<li class="ai-optimize-83"><span style="color: #000000;"><strong>Domain</strong></span></li>
<li class="ai-optimize-84"><span style="color: #000000;"><strong>Username</strong></span></li>
<li class="ai-optimize-85"><span style="color: #000000;"><strong>Password/Password Hash</strong></span></li>
<li class="ai-optimize-86"><span style="color: #000000;"><strong>Target IP Address</strong></span></li>
<li class="ai-optimize-87"><span style="color: #000000;"><strong>Registry Key Name </strong></span></li>
</ul>
<p class="ai-optimize-88"><span style="color: #000000;"><strong>Syntax: </strong></span></p>
<p class="ai-optimize-89"><span style="color: #000000;"><strong>reg.py [domain]/[user]:[password:password hash]@[Target IP Address] [action] [action parameter]</strong></span></p>
<p class="ai-optimize-90"><span style="color: #000000;"><strong>Command:</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">reg.py ignite/Administrator:Ignite@987@192.168.1.105 query -keyName HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows -s</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-km-QguM1wng/XrO6Y20yNsI/AAAAAAAAj5U/LdU_l5-UV9I8rNLvXU6tJCTRMSEjUNOUACLcBGAsYHQ/s1600/3.png"/></p>
<h3 class="ai-optimize-91"><span style="color: #800000;">rpcdump.py</span></h3>
<p class="ai-optimize-92"><span style="color: #000000;">RPC or Remote Procedure Call is when a computer program causes a procedure to execute in different address space which is coded as a normal procedure call. This script can enumerate those endpoints for us. It also matches them to some of the well-known endpoints in order to identify them.</span></p>
<p class="ai-optimize-93"><span style="color: #000000;"><strong>Requirements:</strong></span></p>
<ul>
<li class="ai-optimize-94"><span style="color: #000000;"><strong>Domain</strong></span></li>
<li class="ai-optimize-95"><span style="color: #000000;"><strong>Username</strong></span></li>
<li class="ai-optimize-96"><span style="color: #000000;"><strong>Password/Password Hash</strong></span></li>
<li class="ai-optimize-97"><span style="color: #000000;"><strong>Target IP Address</strong></span></li>
</ul>
<p class="ai-optimize-98"><span style="color: #000000;"><strong>Syntax: </strong></span></p>
<p class="ai-optimize-99"><span style="color: #000000;"><strong>rpcdump.py [domain]/[user]:[Password/Password Hash]@[Target IP Address]</strong></span></p>
<p class="ai-optimize-100"><span style="color: #000000;"><strong>Command:</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">rpcdump.py ignite/Administrator:Ignite@987@192.168.1.105</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-vN6tujaD58E/XrO6ZNFY0DI/AAAAAAAAj5Y/J87O7icw6EM5WuomgfbvViADjDlAa3KYwCLcBGAsYHQ/s1600/4.png"/></p>
<h3 class="ai-optimize-101"><span style="color: #800000;">samrdump.py</span></h3>
<p class="ai-optimize-102"><span style="color: #000000;">Samrdump is an application that retrieves sensitive information about the specified target machine using the Security Account Manager (SAM). Specifically, it is a remote interface accessible under the Distributed Computing Environment / Remote Procedure Calls (DCE/RPC) service. Moreover, it lists out all the system shares, user accounts, and other useful information regarding the target’s presence in the local network. As illustrated in the image, it clearly shows all the user accounts that are held by the remote machine. Inspecting all the available shares for sensitive data and accessing other user accounts can further reveal valuable information.</span></p>
<p class="ai-optimize-103"><span style="color: #000000;"><strong>Requirements:</strong></span></p>
<ul>
<li class="ai-optimize-104"><span style="color: #000000;"><strong>Domain</strong></span></li>
<li class="ai-optimize-105"><span style="color: #000000;"><strong>Username</strong></span></li>
<li class="ai-optimize-106"><span style="color: #000000;"><strong>Password/Password Hash</strong></span></li>
<li class="ai-optimize-107"><span style="color: #000000;"><strong>Target IP Address</strong></span></li>
</ul>
<p class="ai-optimize-108"><span style="color: #000000;"><strong>Syntax: </strong></span></p>
<p class="ai-optimize-109"><span style="color: #000000;"><strong>samrdump.py [domain]/[user]:[Password/Password Hash]@[Target IP Address]</strong></span></p>
<p class="ai-optimize-110"><span style="color: #000000;"><strong>Command:</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">samrdump.py ignite/Administrator:Ignite@987@192.168.1.105</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-LXubprVxE3E/XrO6ZQGbuyI/AAAAAAAAj5c/1MeVr6HQVBggwCpoZ_LI6YAtA-Cm-3sdACLcBGAsYHQ/s1600/5.png"/></p>
<h3 class="ai-optimize-111"><span style="color: #800000;">services.py</span></h3>
<p class="ai-optimize-112"><span style="color: #000000;">The services script of the Impacket communicates with Windows services with the help of MSRPC Interface. It can start, stop, delete, read status, config, list, create and change any service. While working on Red Teaming assignments there were so many tasks that could have been simplified if only, we have access to the services of the Target machine. This makes it all a simple task.</span></p>
<p class="ai-optimize-113"><span style="color: #000000;"><strong>Requirements:</strong></span></p>
<ul>
<li class="ai-optimize-114"><span style="color: #000000;"><strong>Domain</strong></span></li>
<li class="ai-optimize-115"><span style="color: #000000;"><strong>Username</strong></span></li>
<li class="ai-optimize-116"><span style="color: #000000;"><strong>Password/Password Hash</strong></span></li>
<li class="ai-optimize-117"><span style="color: #000000;"><strong>Target IP Address</strong></span></li>
<li class="ai-optimize-118"><span style="color: #000000;"><strong>Action</strong></span></li>
</ul>
<p class="ai-optimize-119"><span style="color: #000000;"><strong>Syntax: </strong></span></p>
<p class="ai-optimize-120"><span style="color: #000000;"><strong>services.py [domain]/[user]:[Password/Password Hash]@[Target IP Address] [Action]</strong></span></p>
<p class="ai-optimize-121"><span style="color: #000000;"><strong>Command:</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">services.py ignite/Administrator:Ignite@987@192.168.1.105 list</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-HXGoKLJ19c4/XrO6aEbPHcI/AAAAAAAAj5g/qWMvls1enzURG1njQj1j3bgN5Ua_X_RpgCLcBGAsYHQ/s1600/6.png"/></p>
<h3 class="ai-optimize-122"><span style="color: #800000;">ifmap.py</span></h3>
<p class="ai-optimize-123"><span style="color: #000000;">Initially, Ifmap scripts bind to the MGMT interface of the target machine. Subsequently, they fetch a list of interface IDs and add those IDs to another extensive list of UUIDs already present in their database. After that, the script attempts to bind to each interface and reports the interface’s status—typically as either <em data-start="415" data-end="423">listed</em> or <em data-start="427" data-end="438">listening</em>. Notably, its ability to gather detailed information is unmatched. Furthermore, a Metasploit module that functions similarly to this script is auxiliary/scanner/dcerpc/endpoint_mapper. The retrieved list of UUIDs (Universal Unique Identifiers) corresponds to various services mapped by the endpoint mapper. Consequently, after identifying these services, an attacker can search online to determine if any are vulnerable to buffer overflow attacks over RPC.</span></p>
<p class="ai-optimize-124"><span style="color: #000000;"><strong>Requirements:</strong></span></p>
<ul>
<li class="ai-optimize-125"><span style="color: #000000;"><strong>Target IP Address</strong></span></li>
<li class="ai-optimize-126"><span style="color: #000000;"><strong>Target Port</strong></span></li>
<li class="ai-optimize-127"><span style="color: #000000;"><strong>Hostname (optional)</strong></span></li>
</ul>
<p class="ai-optimize-128"><span style="color: #000000;"><strong>Syntax: </strong></span></p>
<p class="ai-optimize-129"><span style="color: #000000;"><strong>ifmap.py [Target IP Address] [Target Port] </strong></span></p>
<p class="ai-optimize-130"><span style="color: #000000;"><strong>Command:</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ifmap.py 192.168.1.105 135</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-eE2aJHlsR6U/XrO6aZ7zflI/AAAAAAAAj5k/W6HLsVODUlANmdthUEfyJUTeoNA2BlAkQCLcBGAsYHQ/s1600/7.png"/></p>
<h3 class="ai-optimize-131"><span style="color: #800000;">opdump.py</span></h3>
<p class="ai-optimize-132"><span style="color: #000000;">To begin with, this script binds to the given hostname:port and connects to the DCERPC (Distributed Computing Environment/Remote Procedure Calls) interface. After connecting, it tries to call each of the first 256 operation numbers in turn and reports the outcome of each call. This generates a burst of TCP connections to the given host:port!</span></p>
<p class="ai-optimize-133"><span style="color: #000000;">It gives the output as follows:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">op 0 (0x00): rpc_x_bad_stub_data
op 1 (0x01): rpc_x_bad_stub_data
op 2 (0x02): rpc_x_bad_stub_data
op 3 (0x03): success
op 4 (0x04): rpc_x_bad_stub_data
ops 5-255: nca_s_op_rng_error</pre>
<p class="ai-optimize-140"><span style="color: #000000;">rpc_x_bad_stub_data, rpc_s_access_denied, and success generally means there’s an operation at that number.</span></p>
<p class="ai-optimize-141"><span style="color: #000000;"><strong>Requirements:</strong></span></p>
<ul>
<li class="ai-optimize-142"><span style="color: #000000;"><strong>IP Address</strong></span></li>
<li class="ai-optimize-143"><span style="color: #000000;"><strong>Hostname (optional)</strong></span></li>
<li class="ai-optimize-144"><span style="color: #000000;"><strong>Port Interface Version</strong></span></li>
</ul>
<p class="ai-optimize-145"><span style="color: #000000;"><strong>Syntax: </strong></span></p>
<p class="ai-optimize-146"><span style="color: #000000;"><strong>opdump.py [Target IP Address] [Port Interface Version]</strong></span></p>
<p class="ai-optimize-147"><span style="color: #000000;"><strong>Command:</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">opdump.py 192.168.1.105 135 99FCFEC4-5260-101B-BBCB-00AA0021347A 0.0</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-P4PyOpr6DfI/XrO6ajlyZ7I/AAAAAAAAj5o/LsDtzjqrNcAPCaYnuI8u6tEMfP9xUWeWQCLcBGAsYHQ/s1600/8.png"/></p>
<h3 class="ai-optimize-148"><span style="color: #800000;">getArch.py</span></h3>
<p class="ai-optimize-149"><span style="color: #000000;">All PDUs (Protocol Data Unit) encoded with the NDR64 transfer syntax must use a value of 0x10 for the data representation format label. This value is used only in the transfers of the x64 bit systems. This scripts when provided with a target tried to communicate with the target system and collects the value of the data representation format label. Then it matches it to the NDR64 syntax stored in its code. Then it can provide the information to the attacker if the Operating System is a 64 bit or 32-bit system. We can also provide a list of targets and it can work simultaneously on all the targets.</span></p>
<p class="ai-optimize-150"><span style="color: #000000;"><strong>Requirements:</strong></span></p>
<ul>
<li class="ai-optimize-151"><span style="color: #000000;"><strong>Target IP Address</strong></span></li>
</ul>
<p class="ai-optimize-152"><span style="color: #000000;"><strong>Syntax: </strong></span></p>
<p class="ai-optimize-153"><span style="color: #000000;"><strong>getArch.py -target [Target IP Address]</strong></span></p>
<p class="ai-optimize-154"><span style="color: #000000;"><strong>getArch.py -targets [Target List]</strong></span></p>
<p class="ai-optimize-155"><span style="color: #000000;"><strong>Command:</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">getArch.py -targets /root/Desktop/target.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-37kAoW8ffrE/XrO6bEWpuoI/AAAAAAAAj5s/a9qRjten7yodmOsAYgGEKt-txYWqa3fDwCLcBGAsYHQ/s1600/9.png"/></p>
<h3 class="ai-optimize-156"><span style="color: #800000;">netview.py</span></h3>
<p class="ai-optimize-157"><span style="color: #000000;">netview.py is an enumeration tool. It requires the domain name to enumerate hosts. It can also be provided with a list of hosts or targets. Once a list is gathered then netview checks each of the following:</span></p>
<ul>
<li class="ai-optimize-158"><span style="color: #000000;"><strong>IP addresses</strong></span></li>
<li class="ai-optimize-159"><span style="color: #000000;"><strong>Shares</strong></span></li>
<li class="ai-optimize-160"><span style="color: #000000;"><strong>Sessions </strong></span></li>
<li class="ai-optimize-161"><span style="color: #000000;"><strong>Logged On Users</strong></span></li>
</ul>
<p class="ai-optimize-162"><span style="color: #000000;">Once it finds the information, it doesn’t stop; instead, it continues looping over the discovered hosts and maintains a detailed track of who logged in or out from remote servers. Furthermore, it preserves the connections with the target systems and remains very stealthy, as it sends only a few DCERPC packets. Particularly, this script requires that the attacker machine be able to resolve the domain machine’s NetBIOS names. To accomplish this, the DNS on the attacker machine must be configured to point to the domain DNS.</span></p>
<p class="ai-optimize-163"><span style="color: #000000;"><strong>Requirements:</strong></span></p>
<ul>
<li class="ai-optimize-164"><span style="color: #000000;"><strong>Domain</strong></span></li>
<li class="ai-optimize-165"><span style="color: #000000;"><strong>Target IP Address</strong></span></li>
<li class="ai-optimize-166"><span style="color: #000000;"><strong>Username</strong></span></li>
</ul>
<p class="ai-optimize-167"><span style="color: #000000;"><strong>Syntax:</strong></span></p>
<p class="ai-optimize-168"><span style="color: #000000;"><strong>netview.py [domain]/[User] -target [Target IP Address] -users [User List]</strong></span></p>
<p class="ai-optimize-169"><span style="color: #000000;"><strong>netview.py [domain]/[User] -targets [Target List] -users [User List] </strong></span></p>
<p class="ai-optimize-170"><span style="color: #000000;"><strong>Command:</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">netview.py ignite/Administrator -targets /root/Desktop/target.txt -users /root/Desktop/user.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-WKpHD73RcJs/XrO6XGbcxGI/AAAAAAAAj5M/Ij6I3RxmiB4ON_kxJRwzPExAmIAdlk3ywCLcBGAsYHQ/s1600/10.png"/></p>
<h3 class="ai-optimize-171"><span style="color: #800000;">Conclusion</span></h3>
<p class="ai-optimize-172"><span style="color: #000000;">In this article, we discussed the scripts in the Impacket Toolkit that can interact with the SMB/MSRPC services on a target system. Impacket has many categories which will further explore in due time.</span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To learn more about Red Teaming. Follow this <a href="https://www.hackingarticles.in/category/red-teaming/">Link.</a></span></p>
<p class="ai-optimize-173"><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester. Contact on</span> <strong>Twitter</strong> <span style="color: #000000;">and </span><strong><a href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
