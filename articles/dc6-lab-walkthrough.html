<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">DC6-Lab Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/dc6-lab-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-05-09T11:15:05+00:00">May 9, 2019</time><time class="updated" datetime="2025-06-10T20:34:19+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">DC-6 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing. This isn‚Äôt an overly difficult challenge so should be great for beginners. The ultimate goal of this challenge is to get root and to read the one and only flag. Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</span></p>
<p><span style="color: #000000;">Download it from here ‚Äì https://www.five86.com/dc-6.html</span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<ol>
<li><strong><span style="color: #000000;">Scanning</span></strong></li>
</ol>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">NMAP</span></li>
</ul>
<ol start="2">
<li><strong><span style="color: #000000;">Enumeration</span></strong></li>
</ol>
<ul>
<li><span style="color: #000000;">WPSCAN</span></li>
</ul>
<ol start="3">
<li><strong><span style="color: #000000;">Exploiting</span></strong></li>
</ol>
<ul>
<li><span style="color: #000000;">Searchsploit</span></li>
</ul>
<ol start="4">
<li><strong><span style="color: #000000;">Privilege Escalation</span></strong></li>
</ol>
<ul>
<li><span style="color: #000000;">sudo rights</span></li>
</ul>
<ol start="5">
<li><strong><span style="color: #000000;">Capture the Flag</span></strong></li>
</ol>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Walkthrough</span> </strong></span></h3>
<p><span style="color: #000000;">Here the author has left a clue which will be helpful in this CTF.</span></p>
<p><span style="color: #000000;"><strong><em>‚Äú</em></strong><em>OK, this isn‚Äôt really a clue as such, but more of some ‚Äúwe don‚Äôt want to spend five years waiting for a certain process to finish‚Äù kind of advice for those who just want to get on with the job.</em><strong><em>‚Äù</em></strong></span></p>
<p><span style="color: #000000;"><em>cat /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt</em></span></p>
<p><span style="color: #000000;"><em>That should save you a few years. üòâ</em></span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-IoiP8WICovU/XNQIBvurRoI/AAAAAAAAeT8/ZhpTSsDwS_AGkAcBQBHmNt-LDILLvsLxQCLcBGAs/s1600/0.png"/></span></p>
<h3><span style="color: #800000;"><strong>Scanning</strong></span></h3>
<p><span style="color: #000000;">Now, start the CTF challenge by scanning the network and identifying host IPs. As illustrated below, we can identify our host IP 192.168.1.103.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-s6AHIHqER0M/XNQIB_Xe7pI/AAAAAAAAeUE/RnbgUyopmeEr9Ut7QaVZWqJ8L3a7TZ5LwCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Then, it‚Äôs time to run nmap following command to identify open ports and running services.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.103</pre>
<p><span style="color: #000000;">As ever, this time also we got port 22 and 80 is open for SSH and HTTP services, moreover all HTTP services are made to redirected on domain i.e. //wordy</span></p>
<pre class="lang:default decode:true">cat /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-2BAnVbCQqOU/XNQID4lLPWI/AAAAAAAAeUc/amv9I0fdgz4TqtB8hAb2_6q4n2z6-mFbgCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Therefore, we thought of adding the Domain Name into our Host file, so that we will be able to access http services.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-PTL48w8E5g4/XNQIEFKz_EI/AAAAAAAAeUg/VGVtDZ2Z5jQ_9FSf9_xacm8TGfpc5u6UQCLcBGAs/s1600/3.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">Since port 80 is open, we explored the Domain Name on the browser. We discovered the webpage got a <strong>WordPress CMS</strong> installed on it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-Lo0AkWjUOOQ/XNQIFVsHm0I/AAAAAAAAeUs/OstsG7A-8iwexsZ68h6OytqMUm6LbfSdACLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Since I didn‚Äôt find any remarkable clue on the website, therefore, the next idea that came to us was to run a wpscan on the webpage and see what the scan enumerates for us.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-TBeOoF-Hojw/XNQIFGT2n3I/AAAAAAAAeUk/Q-w_DncY3BI6g5EpZ2czFq0KghYGO87MgCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Hmmm!! Not bad, here I got usernames as shown in the below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-TEWB8jXrYlI/XNQIFRZ_iPI/AAAAAAAAeUo/mF6FJBlIPBEtgYf9eQ6MIqo8g-eQtiQfQCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Moreover, in a text file named users, I saved all the usernames that I had found from WPScan. If you remember the CLUE I discussed at the beginning of the post, generating a password dictionary would be helpful.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-R3cnfy41j-8/XNQIF030V7I/AAAAAAAAeUw/dUS3ommDXOUmmIwzwZulODAzYFfQSYlzgCLcBGAs/s1600/7.png"/></span></p>
<pre class="lang:default decode:true">wpscan --url //wordy/ -U users -P password</pre>
<p><span style="color: #000000;">We have successfully found the password for the mark; Let‚Äôs make good use of them.</span></p>
<p><strong><span style="color: #000000;"><em>mark:helpdesk01</em></span></strong></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-V7ZoDcNzLVo/XNQIGSxKaKI/AAAAAAAAeU0/x_0hEkQeb1QiKDkLBXTx0tcF8EUz_ZobwCLcBGAs/s1600/8.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploiting</strong></span></h3>
<p><span style="color: #000000;">After login into WordPress, I notice a plugin ‚ÄúActive-monitor‚Äù is installed in the dashboard.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-AwFRlfAtG-E/XNQIMlP0FXI/AAAAAAAAeU4/IScqo_RZe4c_ilPcflpSHjMp6yH3UkLlgCLcBGAs/s1600/8_1.png"/></span></p>
<p><span style="color: #000000;">So, quickly I checked for its exploit inside searchsploit and surprisingly I found this plugin is vulnerable to reflected XSS and CSRF attack, moreover this vulnerability cloud lead to remote code execution. You will get its exploit from searchsploit which is an html form to exploit CSRF attack.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-QcZXPFarhhA/XNQIM4anMqI/AAAAAAAAeU8/0CxbbgxgXTEWT05AVMRNDi1Xq-wJsdaJwCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">From searchsploit I found 45274.html file to exploit CRSF attack, but before executing it we need to make to some Cosmo changes as shown below and launch netcat listener.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-jxZOpgyab7k/XNQIB91IkHI/AAAAAAAAeUA/cz9uhz01BPk3qPUieNRThbt1tM8eUStYQCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now, execute the shell.html file to get the reverse connection.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-Ekp3aY8NkR4/XNQICjzMKHI/AAAAAAAAeUI/e0VeZU3__0gCnzQgD5FJmCM7WUCr7TsMwCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">OKAY!! We got a reverse connection at netcat, where I need to run python command to spawn a proper shell. While traversing I found a bash ‚Äúbackup.sh‚Äù and tar ‚Äúbackups.tar.gz‚Äù and moreover I found a text file ‚Äúthings-to-do‚Äù from inside /home/mark/stuff which stored credential for another user ‚Äúgraham‚Äù as shown below.</span></p>
<p><strong><span style="color: #000000;"><em>graham : GSo7isUM1D4</em></span></strong></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-skMuviTLeNY/XNQIC9JB1uI/AAAAAAAAeUM/6ejZdVRzvQYkqeL28-Xx9HLnChClO-DmQCLcBGAs/s1600/12.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">As we knew port 22 is open for ssh and here I try to connect with ssh using <em>graham : GSo7isUM1D4</em> and luckily I got ssh access as shown below. Since this is boot to root challenge where I need to escalate privilege for root access.</span></p>
<pre class="lang:default decode:true">ssh graham@192.168.1.103</pre>
<p><span style="color: #000000;">Therefore, I check for sudo rights, where I found Graham can execute backup.sh as jens without a password.</span></p>
<pre class="lang:default decode:true">sudo -l</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-KySWm8YCtNk/XNQIC34979I/AAAAAAAAeUQ/qfFsS_ebzuI8cIFrWTErTPmbWwfn_oa4ACLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">After reading this bash script, I decided to edit this file by adding /bin/bash as shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-c0_JNF5Y2oo/XNQIDQQON7I/AAAAAAAAeUU/5Uy_LeNMwTgovTmX-XUfTXE28GkyaCJngCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Then with the sudo right I executed the following command successfully login as jeans.</span></p>
<pre class="lang:default decode:true">sudo -u jens /home/jens/backups.sh</pre>
<p><span style="color: #000000;">Now when we have access to jens shell and further I check sudo rights for jeans. As per suoders file permission, jens can run nmap as root. To escalate root privilege, I generate a nmap script to access /bin/sh shell called root.nse and then use nmap command to run the script with sudo.</span></p>
<pre class="lang:default decode:true ">echo "os.execute('/bin/sh')"&gt;/tmp/root.nse
sudo nmap --script=/tmp/root.nse</pre>
<p><span style="color: #000000;">WELL DONE! We have found the final flag and complete the challenges.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-O6DRH_7lze8/XNQID_kcm6I/AAAAAAAAeUY/jIKqq3GzITYVruIcZseDYvx9AN2wfgFHgCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;"><strong>Author:¬†</strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/">¬†here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
