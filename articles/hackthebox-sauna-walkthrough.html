<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Sauna Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hackthebox-sauna-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-07-19T12:26:31+00:00">July 19, 2020</time><time class="updated" datetime="2025-06-27T11:28:54+00:00">June 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve a HTB machine named <strong>Sauna</strong>. Sauna is an easy difficulty Windows machine that features Active Directory enumeration and exploitation.</span></p>
<p><span style="color: #000000;">The credit for making this lab goes to egotisticalSW.</span></p>
<p><span style="color: #000000;">Level: Easy</span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<p><strong>Recon</strong></p>
<ul>
<li>Nmap</li>
</ul>
<p><strong>Enumeration</strong></p>
<ul>
<li>Web application</li>
<li>username-anarchy</li>
</ul>
<p><strong>Exploitation (Initial Access)</strong></p>
<ul>
<li>AS-REP Roasting</li>
<li>john the ripper</li>
<li>evil-winrm</li>
</ul>
<p><strong>Privilege Escalation</strong></p>
<ul>
<li>winPEASx64</li>
<li>bloodhound-python</li>
<li>DCSync</li>
<li>mimkatz</li>
<li>impacket-secretsdump</li>
<li>Pass The Hash</li>
<li>Capture the Flag</li>
</ul>
<p><strong>Walkthrough</strong></p>
<h3><span style="color: #800000;">Recon</span></h3>
<p><span style="color: #000000;">Starting the enumeration with port and service scan by running nmap.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV 10.129.128.245</pre>
<p><span style="color: #000000;">Nmap results suggests the Domain name as <strong>EGOTISTICAL-BANK.LOCAL</strong></span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhHDKsfSKonceuZ8GdJSbIQ_W-NeIjZpNAszTlhL3p5jXiwEmf8Cf97I4wdVS5FZBAU2cz0uKhIiGwGLPtKWInJrExwK3GIzdzLTdP0Ywcwa-O-SkRF06IwBfu70KuAcLO01Y_s5SAlVD5CTGqjVSApzaSc0nJph-K9B21pIB5afnP1sUY2jD3b70sPS0kD/s16000/1.png"/></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">At port 80, there is a website running in which there is an About Us page containing the list of team members.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgwJhD-5s3yyP70lR1O3Wp-mTQx5h3dkRmQzDUhSJGDDk7WuEEKSq2b3N8cAl06VlEpHxl_x7PXrn9_jeQYIYdMtMQD4i33U_q1HjmP3j0xJiquWGFELOEC-m9zlnNkpcLzeIHgYFEDZvNyfj2lKYQ7pwlboYvqJdbUj3THVkT4Ct_JummU8_mVr4RInHMP/s16000/2.png"/></p>
<p><span style="color: #000000;">To create a list of users from the About Us page, someone used the username-anarchy tool, which you can download from:</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiZCp1do0oqEh3tkBJtyo-skDk9aDPJsX7u8o41EOMJc1TJnYRAWtapiu90gN5TOfB-1kq524CieWZxP0IPPVQhhMMM4NM2a5rG81EdW7JSEg6IIB13TFhutATutYqC7iXrq6JQZCr-Pej96Bw_859-WkNKdqLOFqjsxPSNgLSF7XvVL0v9eInc_JNaQ0cV/s16000/3.2.png"/></p>
<p><span style="color: #000000;">Before starting any exploitation, performing the host entry in the <strong>/etc/hosts</strong> file for the target machine IP.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj4p4GMkXFdGc08cQCQkM8eSxvKCS26l-ZvUiETkvnUArPAneEHvQfM3W0j5MdAO8Jm5kkurUoE0cIT21PcIXQw2jfbBz9uDV2Tb6byc2RczKZ7UbP9_XlcrOr2ubmL9XhOAabDMJSkxBOWOC0FnJJ6MMVZsECGslrN-AjhnUnLapR43joBiMqmKQu4jJrb/s16000/3.png"/></p>
<h3><span style="color: #800000;">Exploitation</span></h3>
<p><span style="color: #000000;">During the enumeration, we observed that the port 88 i.e., Kerberos service port is open. This article can be used to perform the attacks related to port 88 : <a style="color: #000000;" href="https://viperone.gitbook.io/pentest-everything/everything/ports/port-88-or-kerberos">h<span style="color: #0000ff;">ttps://viperone.gitbook.io/pentest-everything/everything/ports/port-88-or-kerberos</span></a></span></p>
<p><span style="color: #000000;">So, the AS-REP roasting can be tried here.</span></p>
<p><span style="color: #000000;"><strong>AS-REP roasting</strong> is a technique that allows retrieving password hashes of users that have <strong>Do not require Kerberos preauthentication</strong> property selected.</span></p>
<p><span style="color: #000000;">Since we already have a list of users and the Kerberos service enabled, we will use the <strong>impacket-GetNPUsers</strong> script inside kali that will allow us to capture the users’ hashes.</span></p>
<p><span style="color: #000000;">It can be seen that <strong>fsmith</strong> user’s hash is obtained after successful AS-REP roasting attack.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">impacket-GetNPUsers -dc-ip 10.129.128.245 EGOTISTICAL-BANK.LOCAL/ -usersfile users.txt</pre>
<p><span style="color: #000000;">Copying the obtained hash into a file named <strong>hashes</strong>.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0cx-kSxiFzcl9pieJJjqVvzvu5klC1_gLP-0ipr02CcCWRTS6Qp6fHW5jWCQf0fqBHbyZwEPbxQ5Oa1i1-Y5r5eb0RbgZcgXjuxZa18N9AbvVvuXMTH9VUwaYzFA2xRBgcQ6ikziVnH9fiNi1qeb7DCUZmT7_dkgBNzkdqkRMDacEnANP09S_21wm7-Ez/s16000/4.png"/></p>
<p><span style="color: #000000;">Cracking the above obtained hash using <strong>john the ripper</strong> tool.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john --wordlist=/usr/share/wordlists/rockyou.txt hashes</pre>
<p><span style="color: #000000;">It can be seen that the password for the <strong>fsmith</strong> user is <strong>Thestrokes23</strong>.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhAO-RchZZTKNW-a-bpKPtmkvF3gZa0P-V2GRoFbxriE2tyjxz6zVP5E2gKIucHMwca4unom4r8Vi5tjpFzbZBdpvFcMi7B1NNsU4RGH0RJCzXREsTa-bIWsQIGBvD7q-EGO3k1yHCFvPeBE2k1St2ECQ5x_50jattnEaACzNUg4TDt1Uj26T54p7RPrIKc/s16000/5.png"/></p>
<h3><span style="color: #800000;">Initial Access</span></h3>
<p><span style="color: #000000;">The initial access can be taken by login into the target system using <strong>evil-winrm</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">evil-winrm -I 10.129.128.245 -u fsmith -p Thestrokes23</pre>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgqYBQFgqpkRVR5adddcCDfEsoB_xDJxH5zPnqe53rLrIeqg8z2Fue2-qM39c-L8Ghb7p6RNRct1z7yad8C4tnOi6nQ1Tp0-9Syl2uMnZDT0n0-xKGoC9ekF2RHtecP8btsFLiPIuIVH5qGIAl1PMslviNvyc56Qgg-Pwi7lRl2Gj1bNwaG2OXlWgJAhHXy/s16000/6.png"/></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<p><span style="color: #000000;">To perform privilege escalation, the attacker transfers winPEASx64.exe into the target system using the upload command through evil-winrm.</span></p>
<p><span style="color: #000000;">Running the winPEASx64.exe after someone transfers it.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh-e_okt19rV683VM_YgqNxdD00krxzMgnW5csq1_pSjdSQqLKZQctyLX07oziWbJZQB3HD6MHuMRtAbP0fbehYnIQX0ggDjSEvgPmnT2L_Nh9QFlEFjyVS3y_9Df1hGqMK8VQHtbHhBg8p_QRIxDP88y8ZE7PpqoE-HygjtX8ewzZrKjuJuS1xQYY_Lb7A/s16000/7.png"/></p>
<p><span style="color: #000000;">Winpeas output showed a set of credentials for the domain user <strong>svc_loanmanager</strong> as <strong>Moneymakestheworldgoround!</strong>.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjerRsHvdgqE_DpMYQ0RIGdumjTAfrl-nu0IieTpMf5S9nIiVYB-Qt2oSlrcz7qECIESzUGeV-KT0m5CtGP7wbp34Gozv9s5SJP8Ld6rgiy13sS8MHgIdRwZGX77tzhjskiI3UY-v3v9QS2ZRhiRbCZj15tF89e6y5vRL9sMZ7eBVsCBi-uWIlprs7oK3NF/s16000/8.png"/></p>
<p><span style="color: #000000;">After logging in using the svc_loanmanager user, we observed that there was a local user by the name svc_loanmgr. So we tried using the same password for the svc_loanmgr user, and it worked. Now, to further enumerate, we can use Bloodhound to map the Active Directory rights and permissions.</span></p>
<p><span style="color: #000000;">We can take an overview of the Active Directory structure using the bloodhound-python script. The following command will generate the .json files, which we can later import into the Bloodhound (neo4j database) to analyze the results.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">bloodhound-python -u svc_loanmgr -p 'Moneymakestheworldgoround!' -ns 10.129.128.245 -d EGOTISTICAL-BANK.LOCAL -c All</pre>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhMRKXZZWrDDRBI3YjRYsgwjMZlcLj_lTstPxUi1wnuqzl6_EJVy3fh-Hnsy4FVBITlUy5bW9xyb3wbNwUHqmjCaHlBC29dllyhxz1qwxz04xAx8hzD7aM-yWzmrDoM5UpgaKLapl7A3p0MIjpwk7G8jp6Mc3ZOXo9RMjYJWd57U11XMi0fgYNu6ZKdM-g4/s16000/9.png"/></p>
<p><span style="color: #000000;">Starting the neo4j as console application,</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgqpUIyROYkmeu3cGNNF0AO5nALbZnYDM59sNJ4qPhQ3X7RJeZTaiV1p_k9uGfF2E3c7E_g1yxyqiHaUvofb_7BRh3ldkmer9jskHzWri3d6PNGCogBJsWP8MN-2VwAzkOdZV0tU-YzVHSfSYawYA4jojiesKdvnU7mVwJHacSBIlRTqesxpMxq50cpSp7u/s16000/10.png"/></p>
<p><span style="color: #000000;">Running the bloodhound and importing all the .json files.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhVX-W8cGtw3tyfDcSqKjd7P2J3QCCoQ9I-7K1DkDf1mvROLW1S8iXanS5mPpsT2GWd0tNtgLwB584wocgdUT26d5l5Rk8FUd4jTsXqfH7CkmTcVeZRlB764JrQrmUkcR2QacwqpW4KntYrzPGCTOUJtFjIztap1Ujm-JQLy51wyKO8OV7tMQD2lifkiDeN/s16000/11.png"/></p>
<p><span style="color: #000000;">Since, the svc_loanmgr user has DCSync Rights on the Domain Controller, allowing them to perform a DCSync attack and request any user credentials from the domain.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgLcR_6vnp6668FqhJ0ywjPC21epsr-Wb2g4JwzFFUgCG_hlky9tzHZt81gNbXMhU9VwM3BLTXrKT1pJO2Je0C5GyV7m8NJq1qMgVvoB71LhphDpDVPV0lyqdT81dy0etMrNATmvQwtVcvzPIDsdPQxKNwFkBUGOmhOoVFXgusDGlfIXWe1dXaw7w25pFze/s16000/12.png"/></p>
<p><span style="color: #000000;">You can dump the credentials using mimikatz.exe or the impacket-secretsdump script. Here we will use both methods, first starting with <strong>mimikatz.exe</strong>.</span></p>
<p><span style="color: #000000;">After you transfer mimikatz.exe, run the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./mimikatz.exe "lsadump::dcsync /user:Administrator" "exit"</pre>
<p><span style="color: #000000;">Then, you can use the above command to dump the NTLM hash of the Administrator user.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiU1BdyCugm0ZfVtuhj1UxFEZgHf_5nVKEB54tnN_7-05FjQ29kvJk4M4-SxrrybnpVNh5EovgQaZEO2eM1zWIwcx4XusaDzGUbxq665nU_2Px6x2fA7DREOOHs9tiyslD1xAOCB2H-lbefg3DAdA_2AJBsUdC6GyW3g_xSMmPUHLGe29vxCzoBmSpd3Su7/s16000/13.png"/></p>
<p><span style="color: #000000;">You can obtain a similar NTLM hash using the impacket-secretsdump script.</span></p>
<p><span style="color: #000000;">The following command can be used to dump the hash:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">impacket-secretsdump egotistical-bank/svc_loanmgr@10.129.128.245 -just-dc-user Administrator</pre>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh1loza50rygneytb3WaP6R_ipIh3M7Im1J-DJ_DsbWORWuSMLhotnbJZMl8HyQjamkiHIt1KaWrEveJ3XKzzfLyeTA1FP-VymOc5IkTgHO2Vb3Is3d5bsedWIECnUQIjJ48VCLe3R20J0X6vfPr5lBbFzTDBUGWlsrSs6trqQ9jYKCSoIL4OcgNVqYrZ8I/s16000/14.png"/></p>
<p><span style="color: #000000;">Finally, an attacker can use the obtained hash to login into the target system as Administrator using Pass the Hash attack.</span></p>
<p><span style="color: #000000;">Therefore, an attacker can use evil-winrm to perform the attack and login into the target system as Administrator.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi8CZSXXGSdk2TSKP09EuJdYFth95zw40RcFsj1rSzzqkryW50UTiEwHFPMU2fNyQL6zKffThyphenhyphenIN2_sNpIr7Gj-nf1RIcNZB2ml_fqfoBiCR8a6IbQ_YQgi8NTPayvk6l-RBI-A6161gMwqK4gWPB3q7x8S-CQ7n9pfzfpJlFYUjeABAEMkOggdU2j4Ur81/s16000/15.png"/></p>
<p><span style="color: #000000;">If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong></p>
<p><span style="color: #000000;"><strong>Author</strong>: Vinayak Chauhan is an InfoSec researcher and Security Consultant. Contact</span> <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/vinayak--chauhan/"><strong>here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
