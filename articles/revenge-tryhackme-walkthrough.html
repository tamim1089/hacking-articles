<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/" rel="category tag">TryHackME</a></span>            </div>
            <h1 class="post-title entry-title">Revenge TryHackMe Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/revenge-tryhackme-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-11-14T14:27:23+00:00">November 14, 2020</time><time class="updated" datetime="2025-06-25T13:16:15+00:00">June 25, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we‚Äôre going to solve another boot2root challenge called ‚ÄúRevenge‚Äù. It‚Äôs available at TryHackMe for penetration testing practice. This lab is not difficult if we have the right basic knowledge to break the labs and are attentive to all the details we find during the reconnaissance. The credit for making this lab goes to <strong>Nameless0ne</strong>. Let‚Äôs get started and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;">Level: <strong>Medium</strong></span></p>
<p><span style="color: #000000;">Since these labs are available on the <strong>TryHackMe</strong> website.</span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Dirsearch</span></li>
<li><span style="color: #000000;">John the Ripper</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">SQL Injection with SQLMap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Cracking hashes with John the Ripper</span></li>
<li><span style="color: #000000;">Abuse of SUDO in systemctl</span></li>
</ul>
<ul>
<li><span style="color: #000000;"><strong>Capture the flag</strong></span></li>
</ul>
<h3><span style="color: #800000;">Walkthrough</span></h3>
<h3><span style="color: #800000;">Reconnaissance</span></h3>
<p><span style="color: #000000;">We put the IP address in ‚Äú<strong>etc/hosts</strong>‚Äù file and execute <strong>nmap</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p- -A revenge.thm</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CGNYUmSbZ_U/X6_k8FnlkQI/AAAAAAAAqok/hfqT2SMnvgo5zI-psJAEXPvfaccle6a1QCLcBGAsYHQ/s16000/1.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">We downloaded Billy file:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CC2aloTkV0o/X6_lGp1FW9I/AAAAAAAAqoo/PF42119dHYkpCs6ndtib70et8JWd8x_iACLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">We read the file‚Äôs content, which tells us that we need to launch a web defacement attack.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mv-gElRDR_Q/X6_lL6PQmOI/AAAAAAAAqow/wi3fKMmPEGktp4WSTT6DDOaDY5PyCHaQwCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">When we enter the company‚Äôs website, we see a few incomplete logins, portions of some items, and information about the CEO and his staff.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yC4xFT6I7Tk/X6_lRfOexUI/AAAAAAAAqo0/mJu6AQVwb4sCXSPv8rkqNVmkqy1E0kjUwCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">When we start the <strong>dirsearch</strong> tool, it lists the ‚Äú<strong>admin</strong>‚Äù directory, but we find the authentication panel inoperable.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-itqUcSaXwYc/X6_lVsSZyKI/AAAAAAAAqo4/qE7vduRr5Z4niTEhW71px6gvz6qUudwLgCLcBGAsYHQ/s16000/5.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">It seems that the only thing that works is the product section. We copy the URL and pass it to <strong>SQLMap</strong>, and it will show us the list of databases.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -u "http://revenge.thm/products/1" --batch --dbs</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ijyWZEoeE40/X6_lm5xVJcI/AAAAAAAAqpQ/ROfz_mw2AGoMQSbkmIsue80ju92XXoaEACLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">We run the tool again, this time we will get the tables from the ‚Äú<strong>duckyinc</strong>‚Äù database.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -u "http://revenge.thm/products/1" --batch -D duckyinc --table</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aNR7hcO7hmY/X6_l2u_uDvI/AAAAAAAAqpc/IKdJeuKIuOQp7kL7VpK_PQEYKSIfd2QJACLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">Now we will dump the information about the table ‚Äú<strong>user</strong>‚Äù and we will obtain the first flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -u "http://revenge.thm/products/1" --batch -D duckyinc -T user --dump</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-J2mRoESmzlI/X6_l9oBhcyI/AAAAAAAAqpg/yj6EB6DR7_wWRy5IOtjV-kuEh1vc-tnmQCLcBGAsYHQ/s16000/9.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation (user)</span></h3>
<p><span style="color: #000000;">We repeat the same process, but this time we will do it in the ‚Äúsystem_user‚Äù table. Then, we will obtain the password hashes of three users and copy them to a file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -u "http://revenge.thm/products/1" --batch -D duckyinc -T system_user --dump</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0iJgoEjcWdM/X6_mFHjx0SI/AAAAAAAAqpk/gZdQne5zKowChFK535GtD2SKO3o-AQNxwCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">We crack the hash list with <strong>john the ripper</strong>, we will get some credentials to be able to access through the <strong>SSH service</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-o4Zwbp-6iKw/X6_mKkNNYhI/AAAAAAAAqps/0gjcmUb1GqMJyac2YAnrsPzP50THqrVQgCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">Then, we authenticate ourselves by <strong>SSH</strong> and read the <strong><u>2nd flag</u></strong>. We also do a ‚Äú<strong>sudo -l</strong>‚Äù and check that we can run several ‚Äú<strong>systemctl</strong>‚Äù services as root.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VvXyX64z25c/X6_mQzDgvpI/AAAAAAAAqpw/Zsb6W2vYpgoS-0f1nnc50rM-7eDktCu_QCLcBGAsYHQ/s16000/12.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation (root)</span></h3>
<p><span style="color: #000000;">We edit the service as SUDO, we modify the file by changing ‚Äútype=oneshot‚Äù, we add the line ‚ÄúExecStart=‚Ä¶.‚Äù with our command. For a strange reason, I couldn‚Äôt execute a reverse shell, so I created a new user with root permissions (We comment the rest of the options with ‚Äú‚Äù).</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9XI3Z6IAXK8/X6_mW8KCDmI/AAAAAAAAqp4/qHIJ4RyhpUc2a6IiIo4HLrEFYRVJPXQUACLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">We reset the daemon, restart the service and authenticate with the new user ‚Äú<strong>m3</strong>‚Äú. We check that we are already <strong>root</strong>, but we cannot read the file flag3.txt, since it does not exist üôÅ</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-F-FBaDWRbKM/X6_mbZSu4EI/AAAAAAAAqqA/OcXb7OupVdAnU9xyLxtLZIDScTWVQQzEQCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Let‚Äôs remember that Billy told us that we had to carry out a ‚Äú<strong>deface attack</strong>‚Äú. So we read the file ‚Äú<strong>.viminfo</strong>‚Äú, usually gives a lot of information, we see that the administrator has been ‚Äúmessing‚Äù with the index.html of the website.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bLiuh_cEMNg/X6_mgCjHBQI/AAAAAAAAqqE/dNnJenlQCq4zd3Fep-tMFr1hd-p-6TyRACLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">Modify the file ‚Äú<strong>index.html</strong>‚Äù and put a nice ‚Äú<em>Hacked by‚Ä¶.</em>‚Äú. üòÄ</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qYnnkX3DZIE/X6_mk-ogPfI/AAAAAAAAqqM/627nZBkUVp8n9p-_OWj3vwM7W2xwa5tKACLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">We list the directory again and now we can read the last flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RgELHGXb8vE/X6_mpi25BhI/AAAAAAAAqqU/sChOnFMDtw0v7WPNfs_C-iLa-s5_1YOxACLcBGAsYHQ/s16000/17.png"/></span></p>
<p><span style="color: #000000;">Hope you have enjoyed this TryHackMe Write-up. Follow this¬†</span><strong><a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/">Link</a>¬†</strong><span style="color: #000000;">for more TryHackMe CTF‚Äôs.</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>David Ut√≥n</strong> is Penetration Tester and security auditor for Web applications, perimeter networks, internal and industrial corporate infrastructures, and wireless networks. Contact on <span style="color: #0000ff;"><strong>LinkedIn </strong></span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://twitter.com/David_Uton">Twitter</a></strong></span>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
