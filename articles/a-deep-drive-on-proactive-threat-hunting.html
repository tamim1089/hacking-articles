<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/threat-hunting/" rel="category tag">Threat Hunting</a></span>            </div>
            <h1 class="post-title entry-title">A Deep Drive on Proactive Threat Hunting</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/a-deep-drive-on-proactive-threat-hunting/" rel="bookmark"><time class="entry-date published" datetime="2020-03-17T13:27:40+00:00">March 17, 2020</time><time class="updated" datetime="2025-06-02T06:15:41+00:00">June 2, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">We all know that the proactive threat hunting is need of the hour and as we have already discussed the basic requirement that highlights all generic step required for Threat Hunting Activity in our previous article “<span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/threat-hunting-a-proactive-method-to-identify-hidden-threat/">Threat Hunting – A proactive Method to Identify Hidden Threat</a></strong></span>”.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;">In this post, we will explain the main factors that organizations should consider before conducting a threat hunting activity. These key factors will help an organisation to prepare a roadmap of the hunting activity before execution.</span></p>
<h3 class="ai-optimize-8"><span style="color: #000000;"><span style="color: #800000;">Table of Content</span> </span></h3>
<ul>
<li class="ai-optimize-9"><span style="color: #000000;">The pyramid of Pain</span></li>
<li class="ai-optimize-10"><span style="color: #000000;">Threat Hunting Techniques</span></li>
<li class="ai-optimize-11"><span style="color: #000000;">Datasets</span></li>
<li class="ai-optimize-12"><span style="color: #000000;">Hunting Maturity Model (HMM)</span></li>
</ul>
<h3 class="ai-optimize-13"><span style="color: #800000;">The Pyramid of Pain</span></h3>
<p class="ai-optimize-14"><span style="color: #000000;">The Pyramid of Pain, first proposed by security professional David J Bianco in 2013, concentrates on incident response and threat hunting in order to improve the applicability of attack indicators.</span></p>
<ul>
<li class="ai-optimize-15"><span style="color: #000000;">The Pyramid measures the potential usefulness of your Intel</span></li>
<li class="ai-optimize-16"><span style="color: #000000;">It also measures the difficulty of obtaining that Intel</span></li>
<li class="ai-optimize-17"><span style="color: #000000;">The higher you are, the more resources your adversaries have to expend.</span></li>
</ul>
<p class="ai-optimize-18"><span style="color: #000000;"><strong>For example,</strong> if an attacker uses malware to exploit an endpoint within their attack chain and the security professional, as a defender, uses file hash values to distinguish such actions, they can trivially recompile the malware illustration so that the file hash value the team uses to detect the original sample becomes useless.</span></p>
<p class="ai-optimize-19"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ur29Wt0NcNo/XnC-8TK8iyI/AAAAAAAAjBA/xs9IpvyjQyM0dTZhKk85UOJaaCyXNjDVQCLcBGAsYHQ/s1600/1.png"/></span></p>
<p class="ai-optimize-20"><span style="color: #000000;"><strong><u>Hash Values:</u></strong> Identifying Indicator of compromise with the help of the corresponded hash values is a most trivial step. Unfortunately, they are extremely susceptible to change (even accidentally).</span></p>
<p class="ai-optimize-21"><span style="color: #000000;"><strong><u>IP Addresses:</u></strong> An IPv4 or IPv6 address, in most cases netblocks or CIDR ranges also fit here.</span></p>
<p class="ai-optimize-22"><span style="color: #000000;">An only foolish person uses their own addresses. VPNs, Tor, open proxies all make it easy to change the IP address.</span></p>
<p class="ai-optimize-23"><span style="color: #000000;">If it’s hardcoded into a config, maybe adversaries have to do a little work to update it. We have found that attackers have begun to manipulate or confuse targets with malicious IP in DWORD format. The definition of a malicious URL is as follows:</span></p>
<p class="ai-optimize-24"><span style="color: #000000;"><em>“http:// 77683606/GoogleSearch.image”</em></span></p>
<h5 class="ai-optimize-25"><span style="color: #000000;"><strong><u>IP to DWORD format</u></strong></span></h5>
<p class="ai-optimize-26"><span style="color: #000000;">1)  This can be done by separating the original IP into four octets. Let’s take the above IP address, which is “74.21.11.150”. Split the IP address into four octets – 74, 21, 11 and 150.</span></p>
<p class="ai-optimize-27"><span style="color: #000000;">2) Covert each octet into HEX and you will get “4a15b96” for all four octets.</span></p>
<p class="ai-optimize-28"><span style="color: #000000;">3) Further, change HEX “4a15b96” into decimal and ultimately you will get “77683606” which is the DWORD form of the IP address.</span></p>
<h5 class="ai-optimize-29"><strong><span style="color: #000000;"><u>Domain Names:</u> </span></strong></h5>
<p class="ai-optimize-29"><span style="color: #000000;">This could be either a domain name itself (e.g., “freeinternet.net”) or maybe even a sub- or sub-sub-domain (e.g., “the.new.game.freeinternet.net”).</span></p>
<p class="ai-optimize-30"><span style="color: #000000;">The attackers use the fast-flux or double flux to mask and safeguard their actual infrastructure. They compromised a range of easy targets like vulnerable computers or weak home routers. These routers are then used as tunnels for carrying command-control messages and data across the actual network</span></p>
<p class="ai-optimize-31"><span style="color: #000000;">As per a report “<strong><a style="color: #000000;" href="https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/mandiant-apt1-report.pdf">APT1: Exposing One of China’s Cyber Espionage Units | Mandiant | FireEye</a>,</strong>” you can read how an attacker plan to get a domain registered for APT1.</span></p>
<p class="ai-optimize-32"><span style="color: #000000;"><em>1) The first persona, “UglyGorilla”, has been active in computer network operations since October 2004. His activities include registering domains attributed to APT1 and authoring malware used in APT1 campaigns. “UglyGorilla” publicly expressed his interest in China’s “cyber troops” in January 2004.</em></span></p>
<p class="ai-optimize-33"><span style="color: #000000;"><em>2)  The second persona, an actor we call “DOTA”, has registered dozens of email accounts used to conduct social engineering and spear-phishing attacks in support of APT1 campaigns. “DOTA” used a Shanghai phone number while registering these accounts.</em></span></p>
<p class="ai-optimize-34"><span style="color: #000000;"><em>3)  We have observed both the “UglyGorilla” persona and the “DOTA” persona using the same shared infrastructure, including FQDNs and IP ranges that we have attributed to APT1</em></span></p>
<h5 class="ai-optimize-35"><span style="color: #000000;"><strong>Network/Host Artifacts:</strong> </span></h5>
<p class="ai-optimize-35"><span style="color: #000000;">It is very difficult for an adversary to conduct any useful operation without leaving any traces, which ensures that any byte flowing through the network as a result of an adversary’s involvement may be an artefact.</span></p>
<p class="ai-optimize-36"><span style="color: #000000;">For example, Classify the outbound traffic with a C&amp;C server that will be viewed as network artifacts, while on hosts, search for files &amp; folders, registry objects, mutexes, memory strings will be considered as host artifacts.</span></p>
<p class="ai-optimize-37"><span style="color: #000000;"><strong><u>Tools:</u></strong> In this step, the hunter tries to investigate “what kind of program or command might be used by intruders to achieve their target” such as PowerShell, mimikatz, or other restriction circumvent commands for a lateral moment.</span></p>
<p class="ai-optimize-38"><span style="color: #000000;"><strong><u>Tactics, Techniques and Procedures (TTPs):</u></strong> In this phase, the hunter attempts to examine “how the intruder achieves its target with the aid of the cyber-kill-chain” (as discussed in Part-I). They choose social engineering to target such as phishing, which is the most common TTP used to trap the user in order to gain a foothold in the network by linking a malicious object to the mail.</span></p>
<h3 class="ai-optimize-39"><span style="color: #800000;">Threat Hunting Techniques</span></h3>
<p class="ai-optimize-40"><span style="color: #000000;">Skilled threat hunters use a variety of techniques when reviewing data sources such as firewall logs, SIEM and IDS warnings, DNS logs, file and network data, authentication systems, and other sources in order to detect IoCs and recognize the threat.</span></p>
<p class="ai-optimize-41"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2s-mKbuohnQ/XnC-8qMjOuI/AAAAAAAAjBI/36LMnDeCiEIRgOiTPjxXxV-F9-ofd05nQCLcBGAsYHQ/s1600/2.png"/></span></p>
<h3 class="ai-optimize-42"><span style="color: #000000;">SEARCHING</span></h3>
<p class="ai-optimize-43"><span style="color: #000000;">This is the simplest and least difficult technique used in threat hunting. It is the process for querying data for specific artifacts using defined search criteria and tools. It involves environmental data to analyze like logs, alerts, memory dumps, system events etc. As a security professional who involves in threat hunt need to analyze more data so in starting of threat searching. It’s not possible to know exactly what you are looking for. So, there are two important factors need to keep in mind while doing a search:</span></p>
<ul>
<li class="ai-optimize-44"><span style="color: #000000;">Too wide hunting for common artifacts that can produce unnecessarily varied results of very little use.</span></li>
<li class="ai-optimize-45"><span style="color: #000000;">Focusing too specifically will lead to very few findings and prevent it from being concluded.</span></li>
</ul>
<h3 class="ai-optimize-46"><span style="color: #000000;">CLUSTERING</span></h3>
<p class="ai-optimize-47"><span style="color: #000000;">Clustering is an analytical process, typically performed using machine learning. Involving the classification of related classes (or clusters) of data points based on certain behaviors from a wider range of data. In actual fact, the technique is popular in various fields such as machine learning, pattern recognition, retrieval of information, data compression and computer graphics, for statistical data analytics.</span></p>
<p class="ai-optimize-48"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MRuz5-Fl__g/XnC-8jo6t5I/AAAAAAAAjBE/eRhKaTKSpV8RXGMNaL8FjareGb5nJF7uQCLcBGAsYHQ/s1600/3.png"/></span></p>
<p class="ai-optimize-49"><span style="color: #000000;">source: https://en.wikipedia.org/wiki/Cluster_analysis</span></p>
<p class="ai-optimize-50"><span style="color: #000000;">A statistical technique in which analysts establish groups of like data points on specific aspects of a large data set and separate them into groups. This is most effective when acting upon a broad group of data points that do not share behavioral characteristics. Clustering finds precise cumulative behaviors, like an unusual number of instances of a common occurrence, through various applications such as outlier detection.</span></p>
<p class="ai-optimize-51"><span style="color: #000000;">Read more from here: <a style="color: #000000;" href="https://en.wikipedia.org/wiki/Cluster_analysis">https://en.wikipedia.org/wiki/Cluster_analysis</a></span></p>
<h3 class="ai-optimize-52"><span style="color: #000000;">GROUPING </span></h3>
<p class="ai-optimize-53"><span style="color: #000000;">The grouping includes taking a variety of different objects and determining when multiple objects come together based on common criteria. This involves identifying common criteria that people use to group objects, such as incidents that occur within a given period. Users should best apply this when hunting for other artifacts that are equally unusual.</span></p>
<p class="ai-optimize-54"><span style="color: #000000;">Researchers perform the grouping differently from clustering by looking at unusual data sets and their concerns to see the root cause, whereas clustering uses enormous quantities of data to classify data sets that require more analysis using the grouping technique.</span></p>
<h3 class="ai-optimize-55"><span style="color: #000000;">STACKING </span></h3>
<p class="ai-optimize-56"><span style="color: #000000;">Hunters conduct the stack counting analysis method in a simulated haystack to find the needle. It is the most popular practice for examining a hypothesis.</span></p>
<p class="ai-optimize-57"><span style="color: #000000;">“You are familiar with the term if you have ever used the pivot tables of Microsoft Office, the stats command of Splunk, or the “top” command of Arcsight”.</span></p>
<p class="ai-optimize-58"><span style="color: #000000;">Researchers use data stacking to isolate and classify patterns by using frequency analyses in large quantities of related data. They need an algorithmic method to reduce vast volumes of data that can be processed and analyzed into manageable chunks.</span></p>
<p class="ai-optimize-59"><span style="color: #000000;">In the context of a large data set, the investigator identifies the characteristics that differentiate the odd data rows and may prove that they are malicious. Instead, these attributes are the grouping parameters used to build estimates for the frequency analysis.</span></p>
<p class="ai-optimize-60"><span style="color: #000000;"><em>For example, To identify a thread count with the help of Process Explorer.</em></span></p>
<p class="ai-optimize-61"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xwIgnHaQgsE/XnC-9DtRb1I/AAAAAAAAjBM/U2mbOYVCOLE0fqWx1vwXo5l7a5ydJEuJwCLcBGAsYHQ/s1600/4.png"/></span></p>
<h3 class="ai-optimize-62"><span style="color: #800000;">Datasets</span></h3>
<p class="ai-optimize-63"><span style="color: #000000;">The methods you use are all part of the strategy and experience of what you will do. If you don’t have sufficient details, but what is the right details, you can’t hunt? The response to that question is dependent on what you are aiming for. But the following is a broad list of datasets that are well-suited for hunting and security:</span></p>
<p class="ai-optimize-64"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WiMxBgRLHF0/XnC-9Vta_LI/AAAAAAAAjBQ/A550SPuyeRw5yjzquo73pZ13GdbyhJBMgCLcBGAsYHQ/s1600/5.png"/></span></p>
<h3 class="ai-optimize-65"><span style="color: #800000;">Hunting Maturity Model (HMM)</span></h3>
<p class="ai-optimize-66"><span style="color: #000000;">The Hunting Maturity Model was developed by Sqrrl’s security architect and David JBianco. It measures the current maturity level of hunting of any organization based on the data collection, creates data analysis procedures, incident responses, and hunting automation.</span></p>
<h4 class="ai-optimize-67"><span style="color: #000000;">There are five levels of Hunting Maturity Model (HMM)</span></h4>
<p class="ai-optimize-68"><span style="color: #000000;">The increasing level of maturity demonstrates how an organization can track and establish data analysis procedures (DAP) based on the data it collects and its hunting automation. Analysts and managers will use the HMM to assess the current maturity and to build a roadmap.</span></p>
<h5 class="ai-optimize-69"><span style="color: #000000;"><strong>HM0 – INITIAL:</strong> </span></h5>
<p class="ai-optimize-69"><span style="color: #000000;">HM0 uses automated alerting tools, such as IDS, SIEM, or antiviruses, mainly to identify malicious activities across the organization. They may provide signature update feeds or indicators of threats and even build their signatures or indicators, but these are fed directly into the monitoring system.</span></p>
<h5 class="ai-optimize-70"><span style="color: #000000;"><strong>HM1-Minimal:</strong> </span></h5>
<p class="ai-optimize-70"><span style="color: #000000;">An organization in HM1 still relies mainly on automatic warnings, but at least some routine IT data collection they carry out. They also utilize threat intelligence to drive</span></p>
<p class="ai-optimize-71"><span style="color: #000000;">detection.</span></p>
<h5 class="ai-optimize-72"><span style="color: #000000;"><strong>HM2-Procedural:</strong> </span></h5>
<p class="ai-optimize-72"><span style="color: #000000;">At Level 2 maturity, an organization follows analysis procedures created by others. It has a high or very high level of routine data collection. They may periodically practice and adapt procedures developed by others and can make minor improvements but are not yet able to establish entirely new guidelines themselves.</span></p>
<h5 class="ai-optimize-73"><span style="color: #000000;"><strong>HM3-Innovative:</strong>  </span></h5>
<p class="ai-optimize-73"><span style="color: #000000;">At least a few hunters are present in HM3 organizations who understand different forms of data analysis techniques and are able to use these approaches to detect malicious activities. Such organizations are typically those which establish and publish procedures rather than depend upon procedures established by other parties (as in the HM2 case).</span></p>
<h5 class="ai-optimize-74"><span style="color: #000000;"><strong>HM4-Leading:</strong>  </span></h5>
<p class="ai-optimize-74"><span style="color: #000000;">HM4 is exactly the same as HM3, with a significant difference: automation. We will introduce and translate every effective hunting process at HM4 into automatic detection. This liberates analysts from the pressure of continued implementation of the same processes and encourages them than to focus on developing current or new processes.</span></p>
<p class="ai-optimize-75"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wazTt8qKspk/XnC-9lijabI/AAAAAAAAjBU/Bst31Zz4_Xg3oUYZMKLD63cIPl7EfbjtwCLcBGAsYHQ/s1600/6.png"/></span></p>
<p class="ai-optimize-76"><span style="color: #000000;"><strong><span style="color: #800000;">Keywords:</span> </strong>Crown jewels analysis: Crown Jewels Analysis (CJA) is a process for identifying those cyber assets that are most critical to the accomplishment of an organization’s mission.</span></p>
<p class="ai-optimize-77"><span style="color: #000000;">Reference:</span></p>
<p class="ai-optimize-78"><span style="color: #000000;"><a style="color: #000000;" href="https://www.threathunting.net/files/hunt-evil-practical-guide-threat-hunting.pdf">https://www.threathunting.net/files/hunt-evil-practical-guide-threat-hunting.pdf</a></span></p>
<p class="ai-optimize-79"><span style="color: #000000;"><a style="color: #000000;" href="https://www.threathunting.net/files/huntpedia.pdf">https://www.threathunting.net/files/huntpedia.pdf</a></span></p>
<p class="ai-optimize-80"><span style="color: #000000;"><strong>Author</strong>: Nisha Sharma is trained in Certified Ethical Hacking and Bug Bounty Hunting. Connect with her <a style="color: #000000;" href="https://www.linkedin.com/in/nishasharmaa"><strong>here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
