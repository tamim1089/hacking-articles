<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Metasploit for Pentester: Database &amp; Workspace</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/metasploit-for-pentester-database-workspace/" rel="bookmark"><time class="entry-date published" datetime="2021-07-24T17:43:37+00:00">July 24, 2021</time><time class="updated" datetime="2025-05-12T21:17:37+00:00">May 12, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;"><span class="_fadeIn_4f9by_7">In </span><span class="_fadeIn_4f9by_7">this </span><span class="_fadeIn_4f9by_7">series </span><span class="_fadeIn_4f9by_7">of </span><span class="_fadeIn_4f9by_7">articles</span><span class="_fadeIn_4f9by_7">, </span><span class="_fadeIn_4f9by_7">we </span><span class="_fadeIn_4f9by_7">are </span><span class="_fadeIn_4f9by_7">focusing </span><span class="_fadeIn_4f9by_7">on </span><span class="_fadeIn_4f9by_7">the </span><span class="_fadeIn_4f9by_7">various </span><span class="_fadeIn_4f9by_7">mechanisms </span><span class="_fadeIn_4f9by_7">of </span><span class="_fadeIn_4f9by_7">the </span><span class="_fadeIn_4f9by_7">Metasploit </span><span class="_fadeIn_4f9by_7">Framework </span><span class="_fadeIn_4f9by_7">that </span><span class="_fadeIn_4f9by_7">can </span><span class="_fadeIn_4f9by_7">be </span><span class="_fadeIn_4f9by_7">used </span><span class="_fadeIn_4f9by_7">by </span><span class="_fadeIn_4f9by_7">Penetration </span><span class="_fadeIn_4f9by_7">Testers</span><span class="_fadeIn_4f9by_7">. </span><span class="_fadeIn_4f9by_7">Today</span><span class="_fadeIn_4f9by_7">, </span><span class="_fadeIn_4f9by_7">we </span><span class="_fadeIn_4f9by_7">are </span><span class="_fadeIn_4f9by_7">going </span><span class="_fadeIn_4f9by_7">to </span><span class="_fadeIn_4f9by_7">learn </span><span class="_fadeIn_4f9by_7">about </span><span class="_fadeIn_4f9by_7">the </span><strong data-start="301" data-end="338"><span class="_fadeIn_4f9by_7">Metasploit </span><span class="_fadeIn_4f9by_7">Database </span><span class="_fadeIn_4f9by_7">and </span><span class="_fadeIn_4f9by_7">Workspace</span></strong> <span class="_fadeIn_4f9by_7">commands </span><span class="_fadeIn_4f9by_7">of </span><span class="_fadeIn_4f9by_7">the </span><span class="_fadeIn_4f9by_7">Metasploit </span><span class="_fadeIn_4f9by_7">Framework</span><span class="_fadeIn_4f9by_7">.</span></span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Introduction</strong></span></li>
<li><span style="color: #000000;"><strong>Creating a Workspace</strong></span></li>
<li><span style="color: #000000;"><strong>Hosts Database</strong></span></li>
<li><span style="color: #000000;"><strong>Vulnerabilities Database</strong></span></li>
<li><span style="color: #000000;"><strong>Credentials Database</strong></span></li>
<li><span style="color: #000000;"><strong>Renaming Workspace</strong></span></li>
<li><span style="color: #000000;"><strong>Deleting a Workspace</strong></span></li>
<li><span style="color: #000000;"><strong>Verbose Details of Workspaces</strong></span></li>
<li><span style="color: #000000;"><strong>Exporting Workspace </strong></span></li>
<li><span style="color: #000000;"><strong>Importing Hosts</strong></span></li>
<li><span style="color: #000000;"><strong>Listing Hosts in Database</strong></span></li>
<li><span style="color: #000000;"><strong>Adding Hosts</strong></span></li>
<li><span style="color: #000000;"><strong>Deleting a Host</strong></span></li>
<li><span style="color: #000000;"><strong>Exporting Hosts Database</strong></span></li>
<li><span style="color: #000000;"><strong>Search and Tag Hosts</strong></span></li>
<li><span style="color: #000000;"><strong>Filter Search </strong></span></li>
<li><span style="color: #000000;"><strong>Deleting Services of a Host</strong></span></li>
<li><span style="color: #000000;"><strong>Filter Search </strong></span></li>
<li><span style="color: #000000;"><strong>Exporting Services Database</strong></span></li>
<li><span style="color: #000000;"><strong>Search Services</strong></span></li>
<li><span style="color: #000000;"><strong>Port Specific Vulnerabilities</strong></span></li>
<li><span style="color: #000000;"><strong>Service Specific Vulnerabilities</strong></span></li>
<li><span style="color: #000000;"><strong>Host Specific Vulnerabilities</strong></span></li>
<li><span style="color: #000000;"><strong>Loot Database</strong></span></li>
<li><span style="color: #000000;"><strong>Search Loot</strong></span></li>
<li><span style="color: #000000;"><strong>Type Specific Loot</strong></span></li>
<li><span style="color: #000000;"><strong>Deleting Loot</strong></span></li>
<li><span style="color: #000000;"><strong>Conclusion</strong></span></li>
</ul>
<h3><span style="color: #800000;"><strong>Introduction</strong></span></h3>
<p><span style="color: #000000;"> The database service provided by Metasploit is one of the greatest for keeping a record of your Penetration Testing activity. One of the greatest things about the <strong data-start="542" data-end="579">Metasploit Database and Workspace</strong> is the fact that if you have a bigger assessment, you have even more reasons to use the database and its features. It keeps a record of all the hosts that you have tracked and gathered data from. It also records the time and date of when you enumerated and gathered data, so that you can keep track of your activity. To initiate the PostgreSQL database, use the command msfdb init to initialize the database.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfdb init</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-M1oFybdJRO4/YPxHUXcYXVI/AAAAAAAAxxg/RDTJnU2cf0cc3ec2jpP2ofbSZshY6Z3ygCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">After you initialized the database, you can check the status to verify if the database was initialized successfully using the db_status command. For a session you don’t need to initialize the database again.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">db_status</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mfAQR85HDPY/YPxHZ2YH7rI/AAAAAAAAxxk/9Ki4XNm0wXsvT-TJHl1auXsQz0pmgrgZwCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Using Workspaces helps you to divide and structure your Penetration Testing assessments. It helps by managing the hosts and data derived from those hosts in a database. Workspaces can be used to logically separate targets and assessments. For example, if you require to create a workspace for each subnet within an organization that you are performing Penetration Testing on. It will restrict the hosts to a specific network in a separate workspace which will be easy to understand and manage.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">workspace -h</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pBfkuNGYU4A/YPxHdaS9q4I/AAAAAAAAxxo/IRkwfDSQZ6w5I74rtpruGky26eEi7T03gCLcBGAsYHQ/s16000/3.png"/></span></p>
<h3><span style="color: #800000;"><strong>Creating a Workspace</strong></span></h3>
<p><span style="color: #000000;">Now that we have discussed in detail the <strong data-start="254" data-end="274">Database command</strong>, the <strong data-start="280" data-end="293">Workspace</strong>, and the <strong data-start="303" data-end="327">Metasploit Framework</strong>, it is time to begin the demonstration of the various options and actions you can perform using them. When working with the <strong data-start="452" data-end="465">workspace</strong>, the default workspace comes enabled by default. Moreover, you can create your own workspace. This can help you collect data based on different projects as a penetration tester. For the demonstration, we will create a workspace by the name of pentest. Simply running the workspace command without any options will list the various workspaces present in the database. A workspace with an asterisk (*) denotes the current workspace.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">workspace -a pentest</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CtF4vm6qT1I/YPxHjHKWXeI/AAAAAAAAxxs/9zwuBHp6Tl46Kmupr3AWCw6lpA-PE9EzgCLcBGAsYHQ/s16000/4.png"/></span></p>
<h3><span style="color: #800000;"><strong>Database Nmap Scan</strong></span></h3>
<p><span style="color: #000000;">As a part of penetration testing any machine, it is fundamental to perform a port scan. Earlier we used to perform a Nmap port scan and then export the result into a file for future reference. But with the help of workspace, we can perform a Nmap scan and save its result into the workspace database. From the Metasploit shell, we need to run the db_nmap command with the usual Nmap options to run a Nmap scan and save its result into the workspace database. In the demonstration, we performed the Nmap scan against the entire subnet. From all the active machines that have been detected by Nmap, we selected the two targets 192.168.1.12 and 192.168.1.16 for our assessment.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">db_nmap -sP 192.168.1.0/24</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ON8Xs1ps-Hs/YPxHoO7FZCI/AAAAAAAAxx0/FMWsLQbDRzU6AgBewGuEex4biGQETryCACLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">Since we have the selected target, we can perform a focused Aggressive Nmap scan against the target host. In the demonstration, we are targeting the host with the IP Address 192.168.1.12. We see that the options and the results used and generated are quite similar to the ones we normally use. However, the main difference is that all the <strong data-start="369" data-end="384">enumeration</strong> we perform gets saved in the <strong data-start="414" data-end="436">workspace database</strong> we created earlier.<br/>
</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">db_nmap -A 192.168.1.12</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-K2LCxMd5LDk/YPxHr_CjEsI/AAAAAAAAxx4/jAmymIqsSzozbbzh2qoSSp6XaN31DeffgCLcBGAsYHQ/s16000/6.png"/></span></p>
<h3><span style="color: #800000;"><strong>Hosts Database</strong></span></h3>
<p><span style="color: #000000;">As we used the db_nmap for scanning the host 192.168.1.12, after the conclusion of the scan we can run the hosts command. It will list all the hosts that have been subject to the port scan performed using the db_nmap. We can see that our Nmap scan was able to get the MAC Address, Operating System and Purpose for the targeted host. We can use a list of different scan options and auxiliary tools to enumerate and the data that is collected will automatically be filled inside the table presented.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hosts</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zAnc3aigh2k/YPxHwnM1WXI/AAAAAAAAxx8/J3OtPRAr87UoWLk3urWJgcezuAPL0DWbwCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">Moving on, the db_nmap command is not the only method to add the data inside the workspace data. There are various specifications of different organisations that demand that the penetration tester uses Nmap and export the scan result into a predefined format. If that is the case with you, it is still possible to use the workspace database. Let’s us demonstrate. First, we will be performing a Version Nmap scan on our other targeted hosts 192.168.1.16 with the -oX option so that the scan result is exported into an XML file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV -oX 192.168.1.16</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-X3fKgrgskxQ/YPxH01TcxII/AAAAAAAAxyE/FKK9F9E5yCAgHcwCuUo4z2Dgk2tjZZbLQCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">We have the Nmap scan result saved into an XML file by the name of the result. We will use the db_import command from the Metasploit shell to import the data from the result file. After exporting the data, we ran the hosts command to find that the data from the external Nmap scan is now a part of the Workspace database.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">db_import result
hosts</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Q2GMvU3GQDY/YPxH7hof2TI/AAAAAAAAxyQ/nH8zEpol924O0OGikLfFMiXmiIGOzmY2gCLcBGAsYHQ/s16000/9.png"/></span></p>
<h3><span style="color: #800000;"><strong>Services Database</strong></span></h3>
<p><span style="color: #000000;">Now we have two hosts, 192.168.1.12 and 192.168.1.16. We have performed db_nmap and Nmap scan on them respectively.  We saw earlier that we have the information about both machines in the hosts table but we know one of the primary goals of performing a Nmap scan is to enumerate the open ports and running services on the target machine. Since we used the db_nmap scan and imported a Nmap scan, we should have the details about the services running on both machines. We can check them out using the services command as demonstrated. To get a defined result about a particular result uses the IP address of your target as a parameter while running the services command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">services
services 192.168.1.12</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gzIhbaO6odM/YPxIGEBrDfI/AAAAAAAAxyc/ia9LwnL9pIg95n7iUhyZTaQmrZV0J1W_ACLcBGAsYHQ/s16000/11.png"/></span></p>
<h3><span style="color: #800000;"><strong>Vulnerabilities Database</strong></span></h3>
<p><span style="color: #000000;">After the detection of hosts and the running services, we need to find vulnerabilities on the target machine. We will be using the db_nmap to scan the target hosts with a Vulnerability Script scan. It will help to enumerate the target with possible vulnerabilities. We will be targeting the SSH service running on 192.168.1.12.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">db_nmap -sV -p22 --script=vuln 192.168.1.12</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VDWqFGdBYGU/YPxIMWXj9UI/AAAAAAAAxyg/j3ycNEgDudQqFUjaQ8EJJV9ZHytmVGsnQCLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">After the completion of the Vulnerability Script scan using the db_nmap, we can check for the vulnerabilities detected using the command vulns as demonstrated below. Here we have a table with the Timestamp when the vulnerability was detected, with the Host on which the vulnerability was detected, the name of the vulnerability and the Reference containing the respective CVEs and EDB details.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">vulns</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MO8VNo1wJZc/YPxIQwNKKqI/AAAAAAAAxyo/p-A_T7LwjH0sUvdRqVd4i0a_hCF7ZzslwCLcBGAsYHQ/s16000/13.png"/></span></p>
<h3><span style="color: #800000;"><strong>Credentials Database</strong></span></h3>
<p><span style="color: #000000;">From <strong data-start="963" data-end="982">vulnerabilities</strong>, we move on to the extraction of valuable <strong data-start="1025" data-end="1040">credentials</strong> from the target machine and save them to the <strong data-start="1086" data-end="1108">workspace database</strong>. When you use any <strong data-start="1127" data-end="1148">Metasploit module</strong> that extracts or attempts credentials on the target machine, it saves them inside the credentials section. You can view this section by running thecreds command. In the demonstration, we use the ftp_login auxiliary scanner to perform a bruteforce attack on the FTP login of our target machine. As a result, the correct credentials have made an entry inside the Credentials section.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Z0lkIwAqqqk/YPxIVQacQRI/AAAAAAAAxys/EHATpx2e0oAGf0N4ZyP2iCRE_b7Qdh8CwCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">After the brief introduction of the various commands that you can run inside the <strong data-start="1676" data-end="1696">Metasploit shell</strong>, we will now, therefore, focus on the various aspects of them in detail. We will start by exploring <strong data-start="1797" data-end="1810">Workspace</strong>.</span></p>
<h3><span style="color: #800000;"><strong>Renaming Workspace</strong></span></h3>
<p><span style="color: #000000;">Earlier we learnt about creating a workspace but in case you require to rename a Workspace to provide better management it is possible with the help of the -r option. We first use the workspace command to list the various workspace. As we see that there are three workspaces namely default, pentest and ignite. We will use the -r option to rename the pentest workspace to raj. And we can see that we were able to change the name of the said workspace.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">workspace
workspace -r pentest raj
workspace</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6PPu8uWWc_w/YPxIaJo0IuI/AAAAAAAAxy0/xJP-T3NXcaY1KDe4VaewsnBOBeMRqJIhwCLcBGAsYHQ/s16000/15.png"/></span></p>
<h3><span style="color: #800000;"><strong>Deleting a Workspace</strong></span></h3>
<p><span style="color: #000000;">Now that we renamed a workspace, there might be a workspace that you want to delete from the database. Although keep in mind that deleting the database will delete all the consiquest data as well such as the hosts, vulns and loot from that database. In the scenario presented below, we are shown that there exists three workspaces namely default, raj and ignite. Using the -d option we deleted the ignite workspace.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">workspace
workspace -d ignite
workspace</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-59p-5X8bjl4/YPxIfVd1IkI/AAAAAAAAxy8/eh4JXLGgwyE2-ls4qokBWAgsUB81GQrQQCLcBGAsYHQ/s16000/16.png"/></span></p>
<h3><span style="color: #800000;"><strong>Verbose Details of Workspaces</strong></span></h3>
<p><span style="color: #000000;">During the penetration testing, there will be a time where you might require to get a quick look at your various workspaces. When you make dedicated workspaces for different projects and need a reference for the data stored inside the workspace such as the hosts detected, services running, vulnerabilities found, credentials scrapped and loots grabbed. Use the -v option to check out all this information at once.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">workspace -v</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IVpLua2nUSQ/YPxIk7pLgAI/AAAAAAAAxzE/BEyiUkvBzagvqu_i0VUmTotIEbbiGzyvQCLcBGAsYHQ/s16000/17.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Exporting Workspace</span> </strong></span></h3>
<p><span style="color: #000000;">As we discussed earlier that documentation is an important part of penetration testing. While working with workspace it gets easier to sort your data but with the ability to export the data from the workspace into an XML file for creating reports is an underrated feature.  Use the db_export command for this task. You will need to provide the format you want to use with the -f option followed by the name of the file as demonstrated below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">db_export -f xml workspace_backup.xml</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pnbuRY7Ehpk/YPxIqcoL2wI/AAAAAAAAxzQ/0zgRRlODHlE1MEsU_GmC8bsnhK0IkUrXwCLcBGAsYHQ/s16000/18.png"/></span></p>
<h3><span style="color: #800000;"><strong>Deleting all Workspaces</strong></span></h3>
<p><span style="color: #000000;">Every once a while there comes a time when even the very structured format of the workspace becomes a mess-making no sense at all. You could always delete the workspace as we previously demonstrated. But in case you have multiple workspaces and now want to use the nuclear option on all of them then -D option comes in handy.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">workspace -D</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9xWWXa8LjoQ/YPxIwrCMizI/AAAAAAAAxzY/J0QY9w4OneIiRfWq2iiTwK6oexdKaz2ZwCLcBGAsYHQ/s16000/19.png"/></span></p>
<h3><span style="color: #800000;"><strong>Importing Hosts</strong></span></h3>
<p><span style="color: #000000;">Earlier, we exported the data from a <strong data-start="1908" data-end="1921">workspace</strong> into an XML file. We mentioned that this file can be used for references and creating reports. However, this XML file can also serve as a backup for your work. It is highly unlikely that your work gets deleted or corrupted from the <strong data-start="2154" data-end="2176">workspace database</strong>. We even tried to crash the database but were not able to kill it. Furthermore, we restarted the system to check, and all the data still retained inside the workspace. If you want to import the data from your workspace backup, then you can use the db_import command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">db_import workspace_backup.xml
hosts</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yemQriMCqnw/YPxJEgaP3gI/AAAAAAAAxzo/suZKFa4_bYsMUwh6ZW1-yJe36rGuqutZgCLcBGAsYHQ/s16000/20.png"/></span></p>
<p><span style="color: #000000;">This completes our testing with the workspace commands. Let’s move on to the different options inside the host’s command.</span></p>
<h3><span style="color: #800000;"><strong>Listing Hosts in Database</strong></span></h3>
<p><span style="color: #000000;">As we saw earlier, when we performed an <strong data-start="2545" data-end="2558">Nmap scan</strong> with the db_nmap command, we populated the <strong data-start="2604" data-end="2619">hosts table</strong>. We can list all the hosts and the data enumerated from the Nmap scan into a structured table. This table contains the IP Address, MAC Address, Name, Operating System, and other details.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hosts</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-x1eLIalxhxA/YPxJNjwls-I/AAAAAAAAxzs/AEWiI7ghstkIge1Y19bAIonc8W1HagOoACLcBGAsYHQ/s16000/50.png"/></span></p>
<h3><span style="color: #800000;"><strong>Adding Hosts</strong></span></h3>
<p><span style="color: #000000;">Earlier we used the Nmap scan to enumerate for hosts inside the database. But it is not the only way to do so. We can add hosts using the -a option as well. In scenarios where you want to add particular hosts into your database so that you can perform attacks from the hosts table then you can add hosts as demonstrated below:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hosts -a 192.168.1.101 192.168.1.102</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uIDbh19A3-I/YPxJXORuynI/AAAAAAAAxz4/nFBbDhg-W2Ee4lG60yH505V2Y8WPjCrtwCLcBGAsYHQ/s16000/51.png"/></span></p>
<h3><span style="color: #800000;"><strong>Deleting a host</strong></span></h3>
<p><span style="color: #000000;">As we can add a host into the database it is also possible to remove or delete any user from the database. This can be achieved using the -d option. Previously we added two IP addresses into the database. Now we will delete one of them.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hosts -d 192.168.1.102</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vpnd18LUyIo/YPxJczJ8eXI/AAAAAAAAxz8/ssfif5rtIWw2k0hKVI0064lB2BULNop1ACLcBGAsYHQ/s16000/52.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exporting Hosts Database</strong></span></h3>
<p><span style="color: #000000;">As we mentioned before, the most important part of any <strong data-start="2921" data-end="2953">penetration testing activity</strong> is the documentation process. Earlier, we exported the <strong data-start="3009" data-end="3027">workspace data</strong> into an XML file. If you want to populate the <strong data-start="544" data-end="559">hosts table</strong> in your database into a manageable CSV file, you can simply use the -o option. Consequently, this CSV file becomes usable for uploading into a scanner or software, as it contains all your targeted IP addresses.<br/>
</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hosts -o demo.csv</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-s4KVlscuAmM/YPxJhgQ4_4I/AAAAAAAAx0E/OUTpCLX6Mb0N0XPv4lFEObaTYgQKMJKCQCLcBGAsYHQ/s16000/53.png"/></span></p>
<h3><span style="color: #800000;"><strong>Search and Tag Hosts</strong></span></h3>
<p><span style="color: #000000;">While working with multiple hosts inside a dense network of machines, it becomes difficult to identify and search for a particular target. Fortunately, the Hosts command, an integral part of the <strong data-start="1368" data-end="1405">Metasploit Database and Workspace</strong>, has the -S option that can help you search for a particular machine based on a keyword such as the Operating System of the machine. In the demonstration, we used the keyword “Windows.” This gave us the two machines that were detected running the Windows Operating System. Similarly, it is also possible to define a tag for your hosts to make them easily identifiable. In the demonstration below, we have tagged the system bearing the IP Address 192.168.1.3 as “raj-pc.” We then can use this tag to search for the device in question.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hosts -S Windows
hosts -t raj-pc 192.168.1.3
hosts -S raj-pc</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XKVUsE-Urig/YPxJnC10XLI/AAAAAAAAx0M/X9oFXKu_dWQH82v6kQmvUA2Iw1KnANywACLcBGAsYHQ/s16000/54.png"/></span></p>
<h3><span style="color: #800000;"><strong>Filter Search</strong></span></h3>
<p><span style="color: #000000;">As we observed in the previous steps that the hosts table contains a variety of columns. But it is possible to view only the columns that you desire in your hosts table. It can be done with the help of a filtered search. In the demonstration we used -c option to filter only the address, mac and os_name columns from the hosts table and another example with only IP Address and the Operating System for a clean and readable format. </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hosts -c address,mac,os_name
hosts -c address,os_name</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Kv0xWbnpIs8/YPxJygS30bI/AAAAAAAAx0Y/Gi_7FZeKYS4Jjmuf2zNt36Ac1QdeyYJcQCLcBGAsYHQ/s16000/55.png"/></span></p>
<h3><span style="color: #800000;"><strong>Deleting Services of a Host</strong></span></h3>
<p><span style="color: #000000;">We introduced the services database earlier. It contained the various services running on the target machines that Nmap enumerated and saved in the services database. We can delete a hosts and all of their services along with it with the -d option as demonstrated below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">services -d 192.168.1.40</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_T--Scajb9M/YPxJ42ZA3WI/AAAAAAAAx0g/4GnE7hH9x6kuXzt_IAfYw8JdCxhNFjt1QCLcBGAsYHQ/s16000/60.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Filter Search</span> </strong></span></h3>
<p><span style="color: #000000;">The option to filter the columns in a workspace is not limited to the hosts command. We can use the -c option in the services as well. By default there are a bunch of columns visible when we list the services in the database. With the help of -c option, we can filter our columns such as the Host, Port and Name of the Services as demonstrated below. As Host being the primary key in this table, it will display by default.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">services -c port,name</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zy62BRnIWL8/YPxJ-8ddOQI/AAAAAAAAx0k/fLb8gC85EZUhobrHR4jl84RZRZicyYKggCLcBGAsYHQ/s16000/61.png"/></span></p>
<h3><span style="color: #800000;"><strong>Port Specific Services</strong></span></h3>
<p><span style="color: #000000;">When we deal with the <strong data-start="3380" data-end="3392">services</strong>, the most common way to recognize and differentiate between them is based on the <strong data-start="3474" data-end="3490">port numbers</strong>. There are default ports for various services, although they can be changed. Nevertheless, if they are not, we can use the -p option to make a list of all the hosts that have a certain service running on a particular port. Additionally, it is not limited to a single port; you can specify multiple ports or even a range of ports as well.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">services -p 80</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NRE8yEl-go8/YPxKENVY9aI/AAAAAAAAx0s/T01_YyaiJWc9Ebv7p0dFLXjqAtgu6nx1gCLcBGAsYHQ/s16000/62.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exporting Services Database</strong></span></h3>
<p><span style="color: #000000;">Till now we have exported the complete workspace database and hosts database. But the ability to export the data is not limited to those commands. We can export the data in the services database into a CSV file similarly as we did with the hosts database.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">services -o result.csv</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QcVvseKBXgc/YPxKIdJBdrI/AAAAAAAAx0w/C4QZKkSdlAI2rjFCKs5UinhUiurVsYzjgCLcBGAsYHQ/s16000/63.png"/></span></p>
<h3><span style="color: #800000;"><strong>Search Services</strong></span></h3>
<p><span style="color: #000000;">We can search services based on the hosts, ports, service names, their state and even with the Protocol they are running on. There are services running on the TCP and UDP and other protocols. We can search those services using the -S option.  But it is not limited to protocol. You can use any keyword for the search.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">services -S udp</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qinqBoNMmt0/YPxKOVy76cI/AAAAAAAAx00/akP2LyBRAvE4Q3bol9OW-bxlDp_poWnvwCLcBGAsYHQ/s16000/64.png"/></span></p>
<h3><span style="color: #800000;"><strong>Port Specific Vulnerabilities</strong></span></h3>
<p><span style="color: #000000;">Next, inside the <strong data-start="3907" data-end="3929">workspace database</strong>, we explored the database of the <strong data-start="3963" data-end="3982">vulnerabilities</strong> present in the target machine. These vulnerabilities are enumerated using an <strong data-start="4060" data-end="4080">Nmap script scan</strong> or one of the <strong data-start="4095" data-end="4125">Metasploit Auxiliary scans</strong>. Furthermore, you can search for a specific vulnerability on a service running on a particular port. In the demonstration, we targeted port 22, which is famous for running SSH services. As shown, we detected various probable vulnerabilities inside the References column.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">vulns -p 22</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mElVBERQLiw/YPxKUOfpmlI/AAAAAAAAx1A/lo9B1StIpiofBA9xjLdvPnEYfqfJx7GkwCLcBGAsYHQ/s16000/70.png"/></span></p>
<h3><span style="color: #800000;"><strong>Service Specific Vulnerabilities</strong></span></h3>
<p><span style="color: #000000;">We just listed the Vulnerabilities based on the port number but as we know that services are not always running on their default ports. We can target the particular service that we are looking for with the help of the -s option.  Here, we presented all the ports from 1 to 65536 and the FTP as the service and we can see the various Vulnerabilities for the FTP service no matter on what port it is running on.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">vulns -p 1-65536 -s ftp</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2Scs1YJxEaY/YPxKX91k9VI/AAAAAAAAx1E/H19NqHkfShsSSXeEGcpXxU0uicXoK2VYQCLcBGAsYHQ/s16000/71.png"/></span></p>
<h3><span style="color: #800000;"><strong>Host Specific Vulnerabilities</strong></span></h3>
<p><span style="color: #000000;">We are not limited to listing the <strong data-start="866" data-end="885">Vulnerabilities</strong> data based on port and service alone. Additionally, we can list the vulnerabilities detected on a particular <strong data-start="995" data-end="1003">host</strong>. This becomes one of the most useful representations. It provides a quick look at the services hosted on the targeted host and the possible vulnerabilities associated with it.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">vulns -i 192.168.1.12</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-C4R5pUAMfWM/YPxKc2laLzI/AAAAAAAAx1M/ben-ucaSS_YF8LPlmqaXX5EU7qugMRxawCLcBGAsYHQ/s16000/72.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exporting Vulnerabilities Database</strong></span></h3>
<p><span style="color: #000000;">Similar to the <strong data-start="1254" data-end="1263">hosts</strong>, <strong data-start="1265" data-end="1277">services</strong>, and <strong data-start="1283" data-end="1306">workspace databases</strong>, we can also export the data from the <strong data-start="1345" data-end="1364">Vulnerabilities</strong> into a CSV file. Since the <strong data-start="1392" data-end="1426">Vulnerabilities database table</strong> contains the host’s IP Address, services running on the machine, and the possible vulnerabilities, it basically forms a preliminary report. You can use this report effectively during the <strong data-start="1614" data-end="1649">Penetration Testing assessments</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">vulns -o vulnerblities.csv</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RDEVwBr3DSA/YPxKixcF6HI/AAAAAAAAx1U/h2_VwHGXDP4ITwYM469LhahzMFqqfjY4QCLcBGAsYHQ/s16000/73.png"/></span></p>
<h3><span style="color: #800000;"><strong>Loot Database</strong></span></h3>
<p><span style="color: #000000;">Up until this point, we have demonstrated and discussed the various types of databases that are provided by the Metasploit Framework. That includes the Workspace database, Hosts database, Services database, and Vulnerabilities database—but we saved this one for the last. It is called the Loot database. The <strong data-start="458" data-end="495">Metasploit Database and Workspace</strong> play an important role in systematically organizing and storing the data extracted during assessments, including loot like credentials and sensitive files.</span><br class="yoast-text-mark" data-start="1292" data-end="1295"/>&gt;<span style="color: #000000;">During any Penetration Testing Assessments, there are times when you are able to exploit a vulnerability and gain access to the target. This is where you start some post-exploitation activities, including enumerating for credentials and hashes. In case you are able to extract those using the Metasploit Post-Exploitation Module, they will be stored inside the workspace that you are working on.</span><br class="yoast-text-mark" data-start="1690" data-end="1693"/>&gt;<span style="color: #000000;">To demonstrate, we have exploited and gained a session on the Metasploitable Vulnerable Server, and we will be using the enum_configs post-exploitation module to extract configuration files that might contain some passwords or important information stored in them.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6iEEzmcVHww/YPxKo8ZPQyI/AAAAAAAAx1c/5UM7Z5VeSQ4LY0398uFgm5JK_WLWHHZBACLcBGAsYHQ/s16000/74.png"/></span></p>
<p><span style="color: #000000;">As we can see that the enum_configs grabbed a bunch of config files. Now, when we run the loot command on the <strong data-start="1831" data-end="1851">Metasploit shell</strong>, we see a detailed table. This table displays all the config files along with the hosts they were acquired from and the paths at which they are currently stored.<br/>
</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">loot</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WvlFz9p7Gj8/YPxKvJ5i1EI/AAAAAAAAx1k/0wbsB7zDqoQUmmTl9v4NpooueduZOmZNgCLcBGAsYHQ/s16000/80.png"/></span></p>
<h3><span style="color: #800000;"><strong>Search Loot</strong></span></h3>
<p><span style="color: #000000;">Since you might work on multiple targets simultaneously, the <strong data-start="251" data-end="265">loot table</strong> can quickly populate with too much <strong data-start="301" data-end="309">data</strong>. Therefore, managing and searching specific entries inside the <strong data-start="373" data-end="395">workspace database</strong> becomes crucial. This can make it difficult to look for a particular loot item when needed. Therefore, you can use the Search option to find a specific loot. In the demonstration, we searched for loot related to <strong data-start="4780" data-end="4788">ldap</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">loot -S ldap</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kSXb8TCSilk/YPxK10x-kOI/AAAAAAAAx1s/xyzZUxgRvmE8LV5YkhABTtna1sv9v7e8ACLcBGAsYHQ/s16000/81.png"/></span></p>
<h3><span style="color: #800000;"><strong>Type Specific Loot</strong></span></h3>
<p><span style="color: #000000;">As it is possible to be working on multiple targets, it is also possible that we are able to gather different types of loots based on the method used or exploit used on the target. We can sort and search for a particular type of loot with the help of -t option as demonstrated below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">loot -t linux.enum.conf</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hDNbvBzbwts/YPxK6iyoCOI/AAAAAAAAx10/LwpEDgf4Z9gFvW7_CsaTfnCnDo-1WssbACLcBGAsYHQ/s16000/82.png"/></span></p>
<h3><span style="color: #800000;"><strong>Deleting Loot</strong></span></h3>
<p><span style="color: #000000;">As we did with each and every section and database discussed here, it is possible to delete the loot that you have acquired. To do so we can use the -d option. We will be using the keyword to target specific loot that we want to delete. For example, in case we want to delete the loot of a specific target, then we can provide the IP address of that target and delete all the loot from that source.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">loot -d 192.168.1.12</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3X3w7_ZLlvw/YPxK_N6Mg4I/AAAAAAAAx18/BXc8Xdjr61w9vgIixirRuBO2mZKMBYoDgCLcBGAsYHQ/s16000/83.png"/></span></p>
<h3><span style="color: #800000;"><strong>Conclusion</strong></span></h3>
<p><span style="color: #000000;">This was a learning experience, as when we start with Penetration Activities, we often tend not to focus on the documentation process or giving our work a proper structure and backup. However, over time, and through incidents where the absence of these qualities proved costly, we recognized their importance. One essential area that highlights this need is the <strong data-start="498" data-end="535">Metasploit Database and Workspace</strong>. Although the workspace and database functions of Metasploit are not new features—they have been available for years—their actual usage in real-life penetration testing scenarios remains surprisingly low. This realization inspired us to create this guide, aiming to help more Penetration Testers leverage the <strong data-start="845" data-end="882">Metasploit Database and Workspace</strong> effectively and benefit significantly from it.</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Contact on <span style="color: #0000ff;"><strong>Twitter</strong></span> and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
