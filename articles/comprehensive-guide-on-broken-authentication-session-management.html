<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/website-hacking/" rel="category tag">Website Hacking</a></span>            </div>
            <h1 class="post-title entry-title">Comprehensive Guide on Broken Authentication &amp; Session Management</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/comprehensive-guide-on-broken-authentication-session-management/" rel="bookmark"><time class="entry-date published" datetime="2020-07-12T18:42:23+00:00">July 12, 2020</time><time class="updated" datetime="2025-05-31T22:23:56+00:00">May 31, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;"><span class="relative -mx-px my-[-0.2rem] rounded px-px py-[0.2rem] transition-colors duration-100 ease-in-out">In today’s digital landscape, merely having a strong password isn’t sufficient to safeguard user accounts.</span> <span class="relative -mx-px my-[-0.2rem] rounded px-px py-[0.2rem] transition-colors duration-100 ease-in-out">This article delves into the intricacies of a <strong data-start="46" data-end="78">Broken Authentication attack</strong>, highlighting how attackers can exploit vulnerabilities in authentication and session management to gain unauthorized access.</span> <span class="relative -mx-px my-[-0.2rem] rounded px-px py-[0.2rem] transition-colors duration-100 ease-in-out">By understanding these threats, we can better fortify our applications against such breaches.</span></span></p>
<p class="ai-optimize-7"><span style="color: #000000;">Does just keeping secure and a strong password can really protect you? Today in this article we’ll learn, how an attacker analyzes and take over the user’s account that have been logged in inside some weakly authenticated web-application with an immune password.</span></p>
<h3 class="ai-optimize-8"><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li class="ai-optimize-9"><span style="color: #000000;">Introduction to Authentication</span></li>
<li class="ai-optimize-10"><span style="color: #000000;">Broken Authentication and Session Management</span></li>
<li class="ai-optimize-11"><span style="color: #000000;">Sessions</span></li>
<li class="ai-optimize-12"><span style="color: #000000;">Cookies</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">Impact of Broken Authentication</span></li>
<li class="ai-optimize-14"><span style="color: #000000;">Broken Authentication</span>
<ul>
<li class="ai-optimize-15"><span style="color: #000000;">Credential Stuffing</span></li>
<li class="ai-optimize-16"><span style="color: #000000;">Insecure Web-Applications</span>
<ul>
<li class="ai-optimize-17"><span style="color: #000000;">Insecure Login forms</span></li>
<li class="ai-optimize-18"><span style="color: #000000;">Logout management</span></li>
</ul>
</li>
<li class="ai-optimize-19"><span style="color: #000000;">Bypassing Forget Password Option</span></li>
</ul>
</li>
<li class="ai-optimize-20"><span style="color: #000000;">Improper Session Management</span>
<ul>
<li class="ai-optimize-21"><span style="color: #000000;">Administrative Portal Login</span></li>
<li class="ai-optimize-22"><span style="color: #000000;">Session Hijacking</span>
<ul>
<li class="ai-optimize-23"><span style="color: #000000;">Using the Browser’s Plugin</span></li>
<li class="ai-optimize-24"><span style="color: #000000;">Using Burpsuite</span></li>
</ul>
</li>
<li class="ai-optimize-25"><span style="color: #000000;">Mitigation Steps</span></li>
</ul>
</li>
</ul>
<h3 class="ai-optimize-26"><span style="color: #800000;">Introduction to <strong>Authentication</strong></span></h3>
<p class="ai-optimize-27"><span style="color: #000000;">Authentication is the process of validating a user who is claiming to be a genuine one. Thus in a web-application, password plays a major role in the authentication phase. In order to get the desired access, the user must enter his username and password. Furthermore, he sends these credentials to the server for the authentication process. </span></p>
<p class="ai-optimize-28"><span style="color: #000000;">However the server checks them into its database and if found valid, it generates a session and passes it to the browser in the form of Cookie Session ID.</span></p>
<p class="ai-optimize-29"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-roosl15hJZk/Xwsk2-Bi2qI/AAAAAAAAltY/JSp2-U9CvXoFD-hN-Ohva-F-JchXnJ4RwCLcBGAsYHQ/s1600/0.png"/></span></p>
<h3 class="ai-optimize-30"><span style="color: #800000;">What is Broken Authentication &amp; Session Management </span></h3>
<p class="ai-optimize-31"><span style="color: #000000;">But what if an intruder bypasses this authentication process either by guessing up the username and passwords or even by capturing up an active session of any particular user. Thus, we consider this scenario as Broken Authentication, where developers often do not implement the authentication and session management of the web applications correctly, leading attackers to gain unauthorized access to the user’s data.</span></p>
<p class="ai-optimize-32"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wGnV0Ue8Q9Y/XwslECdpwII/AAAAAAAAltc/aPVKm8Ry1n8oDaGr4P50O62V15V0JhWTwCLcBGAsYHQ/s1600/1.png"/></span></p>
<p class="ai-optimize-33"><span style="color: #000000;">From the above picture you can see that the attacker is trying to get into the web-application by the credential stuffing method. Where he is having a bunch of breached passwords which thus in-turn helps him to gain an authenticated session.</span></p>
<h5 class="ai-optimize-34"><strong> A website or application is vulnerable to Broken Authentication when:</strong></h5>
<ul>
<li class="ai-optimize-35">Username and password are easy to guess using fuzzing or brute force.</li>
<li class="ai-optimize-36">Password Does not match Password complexity policy.</li>
<li class="ai-optimize-37">Enumeration of username/password at the of Authentication failure response invalid username or an invalid password.</li>
</ul>
<h5 class="ai-optimize-38"><strong>A website or application is vulnerable to Session Management when:</strong></h5>
<ul>
<li class="ai-optimize-39">Login credentials are not protected when stored and lacking hashing and salt.</li>
<li class="ai-optimize-40">Transmission of username and password over an unencrypted channel such as HTTP</li>
<li class="ai-optimize-41">Session ID exposes in URL.</li>
<li class="ai-optimize-42">User session or authentication tokens are not timeouts after user logout.</li>
</ul>
<p class="ai-optimize-43"><span style="color: #000000;">In order to explore more, let’s take a deep dive and learn about the sessions and the cookies concepts.</span></p>
<h3 class="ai-optimize-44"><span style="color: #800000;">Sessions</span></h3>
<p class="ai-optimize-45"><span style="color: #000000;">When a user made any changes in a web application like a sign in or sign out, the server does not know who that person is. In order to solve this issue, sessions were introduced, which holds the information of a single user that can be reused across several web pages over a particular web-application.</span></p>
<p class="ai-optimize-46"><strong><span style="color: #000000;">Example: login ID user name and password.</span></strong></p>
<p class="ai-optimize-47"><span style="color: #000000;">Therefore, a system generates a unique identification number in the form of a hash for that specific session, consisting of a random string of 32 hexadecimal numbers such as <strong>5f7dok65iif989fwrmn88er47gk834,</strong> and thus it is known as <strong>sessionID.</strong></span></p>
<h3 class="ai-optimize-48"><span style="color: #800000;">Cookies</span></h3>
<p class="ai-optimize-49"><span style="color: #000000;">A cookie is a small piece of data similar to the sessions, and the server sends them to the browser. Thus, the user’s computer stores this data while he/she is browsing. Cookies have a short time period due to their preset expiry date and time.</span></p>
<p class="ai-optimize-50"><span style="color: #000000;">Cookies are classified into major categories but the most common one is –</span></p>
<h4 class="ai-optimize-51"><span style="color: #800000;">Session Cookie</span></h4>
<p class="ai-optimize-52"><span style="color: #000000;">These cookies die when the browser closes because the browser’s temporary memory stores them. E-commerce websites majorly use them so the user can continue browsing without losing what he put in his cart and can finally check out. The system deletes the session cookie only when it reaches its expiration date or when a user shuts down the browser.</span></p>
<p class="ai-optimize-53"><span style="color: #000000;">To know more about cookies and session management read from <strong><a href="https://www.hackingarticles.in/beginner-guide-understand-cookies-session-management/">here</a></strong></span></p>
<h3 class="ai-optimize-54"><span style="color: #800000;">Impact of Broken Authentication</span></h3>
<p class="ai-optimize-55"><span style="color: #000000;">Broken Authentication is the vulnerability which allows the attacker to gain the user data without proper authentication. This vulnerability arises in the web application where the sessions are not properly sanitized. Therefore it stood as the second most critical vulnerability in the OWASP top10 having <strong>“a CVSS Score of 8.8”.</strong></span></p>
<p class="ai-optimize-56"><span style="color: #000000;">However, the Broken Authentication vulnerability has been majorly reported under</span></p>
<ol>
<li class="ai-optimize-57"><span style="color: #000000;">CWE- 287 Improper Authentication</span></li>
<li class="ai-optimize-58"><span style="color: #000000;">CWE-345 Insufficient Verification of Data Authenticity</span></li>
<li class="ai-optimize-59"><span style="color: #000000;">CWE-522 Insufficiently Protected Credentials</span></li>
</ol>
<p class="ai-optimize-60"><span style="color: #000000;">To learn more about the other CWE categories for Broken Authentication and Session Management click <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://cwe.mitre.org/data/definitions/724.html">here</a></strong></span>.</span></p>
<h2 class="ai-optimize-61"><span style="color: #800000;">Vulnerability Walkthrough to demonstrate Various Attack </span></h2>
<p class="ai-optimize-62"><span style="color: #000000;">Until now you might be clear with the concept of authentication and aware with the fact that how crucial the sessions are. So now it’s time to exploit and analyze these vulnerabilities over the most vulnerable platforms i.e. bWapp and WebGoat.</span></p>
<h3 class="ai-optimize-63"><span style="color: #800000;">Credential Stuffing</span></h3>
<p class="ai-optimize-64"><span style="color: #000000;">During the major data breaches, it is easy for the attackers to grab a list of commonly used usernames and passwords. Thus using these different login pairs, they are able to gain the actual user’s credential of a particular web-application. Credential stuffing somewhere also known as <strong>bruteforcing</strong> or <strong>fuzzing</strong>.</span></p>
<h4 class="ai-optimize-65"><span style="color: #000000;">Capturing and Configuring the HTTP Request in BurpSuite</span></h4>
<p class="ai-optimize-66"><span style="color: #000000;">Therefore we’ll try to bypass this <strong>high-security captcha login</strong> using one of the best web-fuzzing tools i.e. Burpsuite.</span></p>
<p class="ai-optimize-67"><span style="color: #000000;">Boot in your burpsuite in order to capture the ongoing HTTP request, by setting up the <strong>proxy server</strong> at the localhost and enabling the <strong>intercept</strong> option in the proxy tab. </span></p>
<p class="ai-optimize-68"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OwVfqa0ydMY/XwslLFD7iQI/AAAAAAAAltk/jWWpwFjUyXAXqMg1UkftjDRYwdEvWTslQCLcBGAsYHQ/s1600/2.png"/></span></p>
<p class="ai-optimize-69"><span style="color: #000000;">As soon as you grab the request just send it directly to the <strong>intruder</strong><strong>.</strong></span></p>
<p class="ai-optimize-70"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0hVyM2RDt3Y/XwslRHrWWBI/AAAAAAAAlto/IknTBES6OkAjBwENKYlSzAPBhxP4qnQSACLcBGAsYHQ/s1600/3.png"/></span></p>
<p class="ai-optimize-71"><span style="color: #000000;">Now it’s time to configure our attack!!</span></p>
<p class="ai-optimize-72"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aHN1zIUh4WU/XwslaGzOOGI/AAAAAAAAlts/_rHik69rn2U8iT1BvUxeMgYvvFdBKPWJACLcBGAsYHQ/s1600/4.png"/></span></p>
<p class="ai-optimize-73"><span style="color: #000000;">Switch to the <strong>Position </strong>tab and choose the Attack type to <strong>Cluster Bomb</strong>, further add up the attack position by simple clearing all the preset positions with the <strong>Clear $ </strong>button and adding the new positions with the <strong>Add $</strong> button.</span></p>
<p class="ai-optimize-74"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fn-10anuPZ4/Xwsll-a82EI/AAAAAAAAlt0/IHIDZbDeQcYuXK204LWBofX2i79owkqfACLcBGAsYHQ/s1600/5.png"/></span></p>
<p class="ai-optimize-75"><span style="color: #000000;">From the above image, you can see that, I’ve set the attack position over the login and the password fields, where my dictionaries would work.</span><span style="color: #000000;"> Then in the <strong>Payload </strong>section, we’ll be adding up our dictionaries.</span></p>
<p class="ai-optimize-76"><span style="color: #000000;">Choose the <strong>Payload Set 1 and 2</strong> simultaneously one after the other and include our lists in both of them by simply clicking on the <strong>Load</strong> button and at last click on <strong>Start Attack.</strong></span></p>
<p class="ai-optimize-77"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5jwzbjswiZs/XwsltZIDEuI/AAAAAAAAlt8/qW29JkHPtj0IHGzISDfsDH995inDhhuFACLcBGAsYHQ/s1600/6.png"/></span></p>
<h4 class="ai-optimize-78"><span style="color: #000000;">Launching the Attack and Identifying Valid Credentials</span></h4>
<p class="ai-optimize-79"><span style="color: #000000;">From the below image, you can see that we have started our attack. There is a fluctuation in the length section, and our lists are working in the way we want. </span><span style="color: #000000;">I’ve double-clicked over the length section in order to check the lowest value first.</span></p>
<p class="ai-optimize-80"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FXZGTKASbT8/XwslzM_bPMI/AAAAAAAAluA/DGThRfKBTXscLBLxcRsoAlSAqFh_bFV-QCLcBGAsYHQ/s1600/7.png"/></span></p>
<p class="ai-optimize-81"><span style="color: #000000;">Here, I was able to see that the <strong>payload 1</strong> and <strong>2</strong> with <strong>bee </strong>and <strong>bug </strong>inputs respectively are giving a <strong>successful login</strong> in the Response section<strong>.</strong> Therefore I was able to get into the web-application by entering the credentials as a<strong> bee : bug</strong>.</span></p>
<p class="ai-optimize-82"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-B8vQk4hZ5s8/Xwsl77E6vuI/AAAAAAAAluI/mutEf1fEvysZlmlPlAUK8iKwHMWUEcXXgCLcBGAsYHQ/s1600/8.png"/></strong></span></p>
<h3 class="ai-optimize-83"><span style="color: #800000;">Insecure Login Forms</span></h3>
<p class="ai-optimize-84">As mentioned above, when someone stores login credentials without using proper security measures, such as failing to add hashing or salt values with the username and password at the storage location, they can create insecure logins that are vulnerable to session management.</p>
<p class="ai-optimize-85"><span style="color: #000000;">Simply right-click anywhere on the form screen and choose <strong>View Page Source</strong> option.</span></p>
<p class="ai-optimize-86"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PN4u4ctbyFw/XwsmE3inH_I/AAAAAAAAluU/APFGh8aooSApVeXW1GYwYTbs-f_jQt4AwCLcBGAsYHQ/s1600/9.png"/></span></p>
<p class="ai-optimize-87"><span style="color: #000000;">While analyzing the HTML form code, I identify the username and the password values as tonystark and I am Iron Man hidden with the white font.</span></p>
<p class="ai-optimize-88"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-n8FdAhkR9tc/XwsmK4H3m_I/AAAAAAAAluY/IDJA9yROXVYeyMutJ2BYYG2h7_IBmclHQCLcBGAsYHQ/s1600/10.png"/></span></p>
<h3 class="ai-optimize-89"><span style="color: #800000;">Insecure Logout Management</span></h3>
<p class="ai-optimize-90"><span style="color: #000000;">This is one of the most common vulnerabilities, where the developers simply setup the hyperlinks of the logout page at the <strong>logout </strong>text without having any concern about the generated session and do not validate the weather the session ID is getting timeout or not once the user logout from the application. </span></p>
<p class="ai-optimize-91"><span style="color: #000000;">I’ve set the <strong>“Choose your bug”</strong> option at <strong>“Broken Authentication –Logout Management”.</strong> From the below image you can see that as I’ve clicked on the <strong>OK </strong>option in the popped up confirmation field. Thus further I had been redirected to the logout page.</span></p>
<p class="ai-optimize-92"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rep-T1_R2lk/XwsmR1lNQ4I/AAAAAAAAlug/_XueM3jMdw4BRTRD3G7xRps2ssgHVFZ4ACLcBGAsYHQ/s1600/11.png"/></span></p>
<p class="ai-optimize-93"><span style="color: #000000;">Now let’s try to simply click on the back button. Great!! We are back into the account again. That means we were just redirected to the new page but our session cookies were not expired yet.</span></p>
<p class="ai-optimize-94"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qBr7VNzoSfA/XwsmWurQjJI/AAAAAAAAluk/UIAoC2PuAgwKAEF-9d5JW7ipydHwHW6DgCLcBGAsYHQ/s1600/12.png"/></span></p>
<h3 class="ai-optimize-95"><span style="color: #800000;">Bypassing Forget Password Option</span></h3>
<p class="ai-optimize-96"><span style="color: #000000;">Forget Password is the most common feature of every web-application. The majority of applications use it, in order to send <b>a</b> <strong>reset password link</strong> to their users at their registered email addresses. But what, if we exploit this feature and change the credentials of the users without their concern or even without capturing anything from their browsers?</span></p>
<p class="ai-optimize-97"><span style="color: #000000;">Let’s try how we can exploit it!!</span></p>
<h4 class="ai-optimize-98"><span style="color: #000000;">Exploiting the Password Reset Flow in WebGoat</span></h4>
<p class="ai-optimize-99"><span style="color: #000000;">I’ve logged in into the WebGoat’s platform by creating a new user account as <strong>hackingarticles</strong> (Attacker) in order to exploit this vulnerability. To install and setup WebGoat click <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/web-application-pentest-lab-setup-using-docker/">here</a></strong></span>. </span></p>
<p class="ai-optimize-100"><strong><span style="color: #000000;">Note: </span></strong><em><span style="color: #000000;">Here at port 8080 the  Webgoat server is enabled for HTTP service and at port 9090 the webwolf is enabled for SMTP.</span></em></p>
<p class="ai-optimize-101"><span style="color: #000000;">From the left-hand side, the panel selects <strong>Broken Authentication </strong>following with <strong>Password Reset </strong>field. </span><span style="color: #000000;">Thus selecting the <strong>6<sup>th</sup> </strong>option from the top, we’ll be redirected to our desired task.</span></p>
<p class="ai-optimize-102"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Pc4TQXSMtM0/XwsmlCgPbcI/AAAAAAAAlu0/qcU9z46MHVg77kHbIzaDVZn7CKAmAFBPwCLcBGAsYHQ/s1600/14.png"/></span></p>
<p class="ai-optimize-103"><span style="color: #000000;">Dragging to the bottom we’ll find the <strong>Account Access</strong> form, below there we can find a “<strong>forgot password” </strong>option.</span></p>
<p class="ai-optimize-104"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-utI2DS0eNYY/XwsmsVDwm9I/AAAAAAAAlu4/BPEa6qoFQlQ938bTRS0HipAK3P-WAcfmACLcBGAsYHQ/s1600/15.png"/></span></p>
<p class="ai-optimize-105"><span style="color: #000000;">As soon as we click on it we’ll be redirected to the <strong>“Forgot Your Password” </strong>page.</span></p>
<p class="ai-optimize-106"><span style="color: #000000;">Now, it’s time to start our attack, </span><span style="color: #000000;">I’ve entered <a style="color: #000000;" href="mailto:hackingarticles@webgoat-cloud.org">hackingarticles@webgoat-cloud.org</a> as the registered email address.</span></p>
<p class="ai-optimize-107"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EFnlxenCcG4/Xwsm0YW1TDI/AAAAAAAAlvA/7ZG0rxrkMLsLMgLRCjc5IhNexqOMWQn5QCLcBGAsYHQ/s1600/16.png"/></span></p>
<p class="ai-optimize-108"><span style="color: #000000;">From the above image, you can see that we got the response as “<strong>An email has been sending to hackingarticles@webgoat-cloud.org”</strong></span></p>
<p class="ai-optimize-109"><span style="color: #000000;">Now let’s surf the<strong> WebWolf’s</strong> webpage and enter the same credentials (Attack’s) that you have used while logging into WebGoat</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.0.11:9090/login</pre>
<p class="ai-optimize-110"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kBkeGlRSOVM/XwsnQUCBH1I/AAAAAAAAlvc/bz2AznqnC5gDisOZdZLPUJLrpom9fqvMwCLcBGAsYHQ/s1600/17.png"/></span></p>
<p class="ai-optimize-111"><span style="color: #000000;">From the below image, you can see that I’ve received an email with a <strong>reset link</strong> in order to set up the new password.</span></p>
<p class="ai-optimize-112"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fAGfuT1Pbyg/XwsnDtsQsrI/AAAAAAAAlvQ/-q0LKH-Fs2wa6GC3MmKvtICdt4D7tJXfgCLcBGAsYHQ/s1600/18.png"/></span></p>
<h4 class="ai-optimize-113"><span style="color: #000000;">Hijacking the Target User’s Password</span></h4>
<p class="ai-optimize-114"><span style="color: #000000;">Now it’s time to break and get into the victim’s account i.e.<strong>“tom’s account” </strong>who is my target and with the help of footprinting, I have identified his email ID. </span><span style="color: #000000;">Back to the WebGoat server, we’ll write the tom’s email address as <strong><a style="color: #000000;" href="mailto:tom@webgoat-cloud.org">tom@webgoat-cloud.org</a></strong>. But this time we’ll capture the request in the burpsuite before sending it to the server.</span></p>
<p class="ai-optimize-115"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7LXpH9HsGI4/XwsnW4BsYOI/AAAAAAAAlvk/O8jca0fwM78_VVYadBK9t9YuBn90G_rrACLcBGAsYHQ/s1600/19.png"/></span></p>
<p class="ai-optimize-116"><span style="color: #000000;">As soon as we capture the “<strong>Post Request”,</strong> we’ll send it all to the <strong>repeater.</strong></span></p>
<p class="ai-optimize-117"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Tgbkkcb8dX4/XwtZSSHbhEI/AAAAAAAAly4/3W1EIqeXSqwsQignDWpFkEVh8j4rHo4CwCLcBGAsYHQ/s1600/20.png"/></span></p>
<p class="ai-optimize-118"><span style="color: #000000;">Now we’ll manipulate the request and send it to our server i.e. the server we set at <strong>192.168.0.11:9090.</strong></span></p>
<p class="ai-optimize-119"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MP-6P--l-sU/XwtZVtNGR6I/AAAAAAAAly8/0HG5DC9wPewl6NS3aIx_ROQwGzfkZ77dQCLcBGAsYHQ/s1600/21.png"/></span></p>
<p class="ai-optimize-120"><span style="color: #000000;">From the above image, you can see that <strong>“An email has been send to <a style="color: #000000;" href="mailto:tom@webgoat-cloud.org">tom@webgoat-cloud.org</a>”</strong>. But this email has actually been sent over our WebWolf server.</span></p>
<p class="ai-optimize-121"><span style="color: #000000;">Let’s get back to our “<strong>WebWolf”</strong> application and check what we have received as in our <strong>Incoming Request.</strong></span></p>
<p class="ai-optimize-122"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SJR0Bm61o1s/XwsnurpvqxI/AAAAAAAAlv8/eQAb1M32qtwVzMwOLnUm4rUWU8fdCMj2QCLcBGAsYHQ/s1600/22.png"/></span></p>
<p class="ai-optimize-123"><span style="color: #000000;">From the above image, you can see that I’ve successfully manipulated the WebGoat server, which sends the request over my account. </span><span style="color: #000000;"><strong>Copy</strong> the unique Id as highlighted, which we will use in our future case.</span></p>
<p class="ai-optimize-124"><span style="color: #000000;">We’re now almost done, go back to the inbox of “<strong>hackingarticles@webgoat-cloud.org” </strong>and open that reset link that we got earlier.</span></p>
<p class="ai-optimize-125"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1JGTlsdnEts/Xwsnz86R8CI/AAAAAAAAlwA/fG9acpVACa08-JDJSW4aolGk_aWoqfqLgCLcBGAsYHQ/s1600/23.png"/></span></p>
<p class="ai-optimize-126"><span style="color: #000000;">From the above image you can see that, in the URL section, we’re having a unique ID here too. </span><span style="color: #000000;">Let’s change this unique ID with the one we copied earlier.</span></p>
<p class="ai-optimize-127"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-m6bw-CdQ2XA/XwsoKgn9OrI/AAAAAAAAlwQ/AuNP3H41f-UviNFdwSVZugbibmT92a9CwCLcBGAsYHQ/s1600/24.png"/></span></p>
<p class="ai-optimize-128"><span style="color: #000000;">Woah!! We are redirected to a new <strong>“Reset your password” </strong>page, seems like we’re changing Tom’s credentials.</span></p>
<p class="ai-optimize-129"><span style="color: #000000;">I’ve now set the password here as <strong>“tomandjerry”.</strong> And fired the <strong>“SAVE” </strong>button.</span></p>
<p class="ai-optimize-130"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-R-kO8lKE0oc/Xwsoj0Xd_dI/AAAAAAAAlwY/sQXShjXYxmIbA-uCzC60J3Hv3AL7NuMmwCLcBGAsYHQ/s1600/25.png"/></span></p>
<p class="ai-optimize-131"><span style="color: #000000;">Let’s check whether we’re able to change the tom’s credentials or not.</span></p>
<p class="ai-optimize-132"><span style="color: #000000;">Go back to the WebGoat web-application and select the option to “<strong>Account Access</strong>” and enter the following credentials:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tom@webgoat-cloud.org
tomandjerry</pre>
<p class="ai-optimize-133"><span style="color: #000000;">Great!! We’ve successfully changed Tom’s password just with his email account, without knowing who is <strong>tom</strong>.</span></p>
<p class="ai-optimize-134"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Y0lLKPhT8Rw/XwsoqUHfkRI/AAAAAAAAlwc/zie3Vbv-vwA97XaNdpOKp2RNx1jIhnWSgCLcBGAsYHQ/s1600/26.png"/></span></p>
<h3 class="ai-optimize-135"><span style="color: #800000;">Improper Administrative Login</span></h3>
<p class="ai-optimize-136"><span style="color: #000000;">Attackers consider administrative logins one of the most important and the most crucial vulnerabilities. This occurs due to unsanitized sessions generated from the server’s end.</span></p>
<p class="ai-optimize-137"><span style="color: #000000;">Let’s try to exploit this vulnerability and get into the web-application with the administrative privileges.</span></p>
<p class="ai-optimize-138"><span style="color: #000000;">Boot back into your bWapp server and select <strong>“Session Management – Administrative Portals” </strong>in the “<strong>Choose Your Bug” </strong>option keeping the security at <strong>low.</strong></span></p>
<p class="ai-optimize-139"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kZD7BbrLESo/XwsoyXRRHiI/AAAAAAAAlwg/SEyl8WezgWkT3VkqGl2fNTlY4bAGAUf6ACLcBGAsYHQ/s1600/27.png"/></span></p>
<p class="ai-optimize-140"><span style="color: #000000;">From the above image you can see that after the <strong>“.php?” </strong>we’ve got <strong>“admin=0”, </strong>let’s manipulate this but <strong>“admin=1” </strong>and check out the grabbed result.</span></p>
<p class="ai-optimize-141"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cqjaYzSmNEs/XwspCwb97rI/AAAAAAAAlww/4ixfkpurtMgSHrH76WCHVcQT6hmmsrShgCLcBGAsYHQ/s1600/28.png"/></span></p>
<p class="ai-optimize-142"><span style="color: #000000;">Simple!! We’ve unlocked this page with the administrative rights.</span></p>
<p class="ai-optimize-143"><span style="color: #000000;">Let’s try to increase up the level and set it to <strong>“medium”, </strong>now checking the same in the URL, we won’t be able to find anything. So is this vulnerability <strong>patched? </strong></span></p>
<p class="ai-optimize-144"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-dI8wkvsAzTQ/XwspJ1hVyLI/AAAAAAAAlw0/BpU2VzP5-Cg0EUkHM9NjPmOLZhRzRgLXQCLcBGAsYHQ/s1600/29.png"/></strong></span></p>
<p class="ai-optimize-145"><span style="color: #000000;">Wait, let’s try to capture its cookies and analyze them.</span></p>
<p class="ai-optimize-146"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KacnR2Rr_og/XwspUlSJoMI/AAAAAAAAlw4/X_osqRUvNvkK5V_QosWb6Tmtwf60jtqlwCLcBGAsYHQ/s1600/30.png"/></span></p>
<p class="ai-optimize-147"><span style="color: #000000;">Look there it is, the flaw is still the same, but this time it is in the cookies. So now let’s check whether our manipulation will work or not?</span></p>
<p class="ai-optimize-148"><span style="color: #000000;">I’ve again manipulated the <strong>“admin=0” </strong>to <strong>“admin=1”</strong></span></p>
<p class="ai-optimize-149"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yCPeYcOM3iU/XwspdeGZ-qI/AAAAAAAAlw8/CEl8dsPz0aIfm_cyj4CLTlqGUTOy9FJUACLcBGAsYHQ/s1600/31.png"/></span></p>
<p class="ai-optimize-150"><span style="color: #000000;">From the below image you can see that we’ve successfully unlocked the webpage again with some simple manipulations</span></p>
<p class="ai-optimize-151"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Jd9Qwp9ICcc/XwspkdDv_hI/AAAAAAAAlxA/M7q_-4KRIkofuXhhMtRShAjH7WhRba0mgCLcBGAsYHQ/s1600/32.png"/></span></p>
<h3 class="ai-optimize-152"><span style="color: #800000;">Session Hijacking</span></h3>
<p class="ai-optimize-153"><span style="color: #000000;">Until now, we all are aware that a unique session ID generates for every different user, thus when an attacker sniffs the network traffic via a man-in-the-middle attack or via Cross-Site Scripting, they steal the session ID or the session tokens of the legitimate user’s authenticated session to gain an unauthorized login. This methodology is known as Session Hijacking.</span></p>
<p class="ai-optimize-154"><span style="color: #000000;">The idea about session hijacking would be more clear from this image.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-3qM8UTBGv3E/Xws2DCAZ_ZI/AAAAAAAAlyo/bOBfhEilnGgrIAe3CDlIphnMQDTvhQLvQCLcBGAsYHQ/s1600/new%2Baccess%2Bgranted.png"/></p>
<p> </p>
<p class="ai-optimize-155"><em><span style="color: #000000;">Here the user enters his credentials into the web-application, thus application sends them to the server for authentication. Therefore as soon as the system finds the credentials valid, the server generates a session and shares it with the browser, such that the user does not need to enter his credentials every time for every single page he requests.</span></em></p>
<p class="ai-optimize-156"><span style="color: #000000;">But the attacker sniffs the network and steals these freshly generated session IDs before the system sends them to the user. Now the attacker just needs to send these session IDs to the web server, and the server tries to match them with its database-stored session IDs. If they both match, the server responds to the attacker with an HTTP 200 OK reply, and the attacker gains successful access without submitting proper identification.</span></p>
<p class="ai-optimize-157"><span style="color: #000000;">So it’s time to play with these sessions and hijack some accounts.</span></p>
<h4 class="ai-optimize-158"><span style="color: #000000;">Session Hijacking using Browser’s extensions</span></h4>
<p class="ai-optimize-159"><em><span style="color: #000000;">Isn’t it great if you could simply get into other’s account without bruteforcing or resetting the password or by not finding any flaws in the web-application?</span></em></p>
<p class="ai-optimize-160"><span style="color: #000000;">To perform all this, we will use a simple browser extension, i.e., “Cookie Editor,” which allows us to import and export the browser-generated cookies by simply copying them into our clipboard, which we can further use to gain authenticated access. </span></p>
<p class="ai-optimize-161"><span style="color: #000000;">Let’s Start!!</span></p>
<p class="ai-optimize-162"><span style="color: #000000;">In the below image, you can see that I have enabled the Cookie Editor in my browser and logged in to bWapp as “Hackingarticles: 123.” Now, I will click on the “Export” button from the provided options to export all the cookies of this particular session.</span></p>
<p class="ai-optimize-163"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uVL6qi_p9pQ/XwspzJgNQrI/AAAAAAAAlxQ/AEAUzXuBYXUtOHCIfm0NL3AM-P4GMDGHQCLcBGAsYHQ/s1600/34.0.png"/></span></p>
<p class="ai-optimize-164"><span style="color: #000000;">Since I’ve successfully exported the user’s cookies now it’s time to import them into the attacker’s machine. </span><span style="color: #000000;">From the below image you can see that the user <strong>“bee” </strong>is active with an enabled cookie editor extension.</span></p>
<p class="ai-optimize-165"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qFHlYAeZ3vE/Xwsp30DrVuI/AAAAAAAAlxY/t1wRlWgC6As-rflBEBBZzyO5dinbmAzSQCLcBGAsYHQ/s1600/35.0.png"/></span></p>
<p class="ai-optimize-166"><span style="color: #000000;">Now let’s try to import these cookies into the attacker’s browser by pasting the exported cookies into the Cookie Editor console.</span></p>
<p class="ai-optimize-167"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KVqHv61Bq8w/Xwsp81Xgw9I/AAAAAAAAlxg/UZRHADBGifsmBBOgx6ao71kKmHkWJKGEACLcBGAsYHQ/s1600/36.0.png"/></span></p>
<p class="ai-optimize-168"><span style="color: #000000;">As I hit the “<strong>enter” </strong>button the exported cookies of the user <strong>hackingarticles</strong> will be imported directly into the browser where the user <strong>bee </strong>resides.</span></p>
<p class="ai-optimize-169"><span style="color: #000000;">So everything is up now, just simply refresh the browser and there it goes. From the below image you can see that we’ve successfully captured the <strong>hackingarticles session</strong> with just <strong>3 clicks.</strong></span></p>
<p class="ai-optimize-170"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-B-co8fhnK1M/XwsqCYJzfxI/AAAAAAAAlxk/fxb5SaUO--8ooSJlonw9XzNUO8ht6LYdQCLcBGAsYHQ/s1600/37.png"/></strong></span></p>
<h3 class="ai-optimize-171"><span style="color: #800000;">Session ID exposure in URL</span></h3>
<p class="ai-optimize-172"><span style="color: #000000;">Many times the developers fail to manage the privacy of the web-applications by leaving some basic flaws such as disclosing the session ID in the URLs, which allows the attacker to steal these session ids by simply monitoring up the network and manipulate them in order to exploit the authenticated user to compromise his account.</span></p>
<p class="ai-optimize-173"><span style="color: #000000;">For this exploitation, we’ll be using the <strong>bWAPP</strong>, selecting up the <strong>“Choose your bug” </strong>option to <strong>“Session Management – Session ID in URL” </strong>and setting the security level to <strong>“low”.</strong></span></p>
<p class="ai-optimize-174"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-HPz4mgRF7Y4/XwsqRcDsjuI/AAAAAAAAlx0/zDFmYG63ggwhdKreEh7RNrV3vayBGnE8ACLcBGAsYHQ/s1600/38.png"/></strong></span></p>
<p class="ai-optimize-175"><span style="color: #000000;">From the above image, you can see that the browser displays the “<strong>PHPSESSID</strong>=” of the user <strong>“Hackingarticles,”</strong> so just copy the same into a text file.</span></p>
<p class="ai-optimize-176"><span style="color: #000000;">Similarly, we’ll copy the <strong>“PHPSESSID=” </strong>from the user <strong>“Bee”</strong> and paste it into the same text file.</span></p>
<p class="ai-optimize-177"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ESLuPaUIk28/XwsqhP0TD6I/AAAAAAAAlx8/AuiEPnl7VF8kPzPXUknEjE4gh93aAQCOwCLcBGAsYHQ/s1600/39.png"/></span></p>
<p class="ai-optimize-178"><span style="color: #000000;">From the above image, you can see that both these session ID’s are different.</span></p>
<p class="ai-optimize-179"><span style="color: #000000;">Thus, it’s time to exploit this vulnerability.</span></p>
<p class="ai-optimize-180"><span style="color: #000000;">In the Bee’s account, we’ll go to the <strong>“Change Password” </strong>option, and will try to change the password.</span></p>
<p class="ai-optimize-181"><span style="color: #000000;">But before hitting up the <strong>“change”</strong> button, we’ll run our favourite tool <strong>“burpsuite” </strong>and capture the ongoing <strong>HTTP Request.</strong></span></p>
<p class="ai-optimize-182"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5H_PlpeTouo/XwsqsgYSI7I/AAAAAAAAlyE/ChFsKiEI7LE_Waldtn438QOBw_hnbviYACLcBGAsYHQ/s1600/40.png"/></span></p>
<p class="ai-optimize-183"><span style="color: #000000;">The below image shows that we’ve successfully captured the HTTP request, and we are again presented with the “PHPSESSID”.</span></p>
<p class="ai-optimize-184"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NUvXowygWec/XwsqzfWZWsI/AAAAAAAAlyM/Id_gzhiTlmoAz67iEQG1O2nc1152i-JugCLcBGAsYHQ/s1600/41.png"/></span></p>
<p class="ai-optimize-185"><span style="color: #000000;">Now we’ll be sharing this captured request to the <strong>repeater</strong> and replace the session ID<strong>, </strong>and further will check its generated response.</span></p>
<p class="ai-optimize-186"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-X6m1503h-vI/Xwsq5cnn2PI/AAAAAAAAlyQ/BZ0Toi7JoKEBY2GxU5OxyrYGVbeFpGAuwCLcBGAsYHQ/s1600/42.png"/></span></p>
<p class="ai-optimize-187"><span style="color: #000000;">From the above image, you can see that we changed the user from bee to Hackingarticles as we hit the Send button.</span></p>
<p class="ai-optimize-188"><span style="color: #000000;">We’re almost there, just change the “PHPSESSID=” with the one that we’ve used in our previous step, in the <strong>Proxy tab.</strong></span></p>
<p class="ai-optimize-189"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fTDyWu1QvzQ/Xwsq-xaGRFI/AAAAAAAAlyU/_o1dTN7c764Utd4oxObOBVTwAmRs7PnBACLcBGAsYHQ/s1600/43.png"/></span></p>
<p class="ai-optimize-190"><span style="color: #000000;">As soon as I hit the <strong>Forward </strong>button, I will be redirected to a new web page.</span></p>
<p class="ai-optimize-191"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sZeRRpPF3h0/XwsrFXtYOcI/AAAAAAAAlyY/A5q4b42GsNIay26x05U2F6mzs9TViuXugCLcBGAsYHQ/s1600/44.png"/></span></p>
<p class="ai-optimize-192"><span style="color: #000000;">Great!! We are back into <strong>Hackingarticles</strong> account by simply manipulating up the <strong>SessionID</strong>.</span></p>
<h3 class="ai-optimize-193"><span style="color: #800000;">Mitigation Steps</span></h3>
<ol>
<li class="ai-optimize-194"><span style="color: #000000;">Developers should setup the Session ID’s, username, password, session tokens in the most encrypted way where they stored.</span></li>
<li class="ai-optimize-195"><span style="color: #000000;">Validate appropriate session timeout and invalidated during logout for session tokens.</span></li>
<li class="ai-optimize-196"><span style="color: #000000;">The client’s or the Users should use multi-factor authentication and even follow-up with strong password policies in order to increase the password complexities.</span></li>
<li class="ai-optimize-197"><span style="color: #000000;">Do not expose Session ID’s in the URL.</span></li>
<li class="ai-optimize-198"><span style="color: #000000;">Use the Encrypted channel for transmitting username and password to the server.</span></li>
</ol>
<p class="ai-optimize-199"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a href="https://www.linkedin.com/in/aarti--singh/"> <span style="color: #0000ff;">here</span></a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
