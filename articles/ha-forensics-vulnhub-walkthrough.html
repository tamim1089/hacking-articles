<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">HA: Forensics: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/ha-forensics-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-10-23T18:03:36+00:00">October 23, 2020</time><time class="updated" datetime="2025-07-10T15:40:31+00:00">July 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to crack this vulnerable machine called HA: Forensics. This is a Capture the Flag type of challenge. It contains FOUR flags that are accessible as the solving of the lab progresses based on hints. It is a Forensics focused machine.</span></p>
<p><span style="color: #000000;">Download Lab from here.</span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Penetration Testing Methodology</span> </span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Flag #1</strong></span>
<ul>
<li><span style="color: #000000;">Browsing the HTTP service</span></li>
<li><span style="color: #000000;">Directory Bruteforce using dirb</span></li>
<li><span style="color: #000000;">Enumerating an Image file</span></li>
<li><span style="color: #000000;">Extracting Metadata of Image file</span></li>
<li><span style="color: #000000;">Reading Flag #1</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Flag #2</strong></span>
<ul>
<li><span style="color: #000000;">Directory Bruteforce using dirb</span></li>
<li><span style="color: #000000;">Decrypting PGP Encryption</span></li>
<li><span style="color: #000000;">Creating a Dictionary using crunch</span></li>
<li><span style="color: #000000;">Performing a Dictionary on ZIP file</span></li>
<li><span style="color: #000000;">Reading Flag #2</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Flag #3</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating DMP file using pypykatz</span></li>
<li><span style="color: #000000;">Extracting an NT hash</span></li>
<li><span style="color: #000000;">Cracking Hash using John the Ripper</span></li>
<li><span style="color: #000000;">SSH login using Metasploit</span></li>
<li><span style="color: #000000;">Convert SSH to Meterpreter</span></li>
<li><span style="color: #000000;">Enumerating Network Interfaces</span></li>
<li><span style="color: #000000;">AutoRoute an internal docker instance</span></li>
<li><span style="color: #000000;">Perform a ping sweep scan internally</span></li>
<li><span style="color: #000000;">Connect to the FTP service as Anonymous</span></li>
<li><span style="color: #000000;">Downloading the Image file</span></li>
<li><span style="color: #000000;">Transferring the Image file to the local machine</span></li>
<li><span style="color: #000000;">Analyze the image file using Autopsy</span></li>
<li><span style="color: #000000;">Reading Flag #3</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Flag#4</strong></span>
<ul>
<li><span style="color: #000000;">Decoding the Base64 Encryption</span></li>
<li><span style="color: #000000;">Enumerating for Sudo permission</span></li>
<li><span style="color: #000000;">Exploiting the Sudo permissions on ALL</span></li>
<li><span style="color: #000000;">Reading Flag #4</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #800000;">Walkthrough</span></h3>
<h3><span style="color: #800000;">Network Scanning</span></h3>
<p><span style="color: #000000;">Firstly, to attack any machine, we need to find the IP Address of the machine. This can be done using the netdiscover command. To find the IP Address, we will need to co-relate the MAC Address of the machine that can be obtained from the Virtual Machine Configuration Setting. The IP Address of the Machine was found to be <strong>192.168.0.174</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UfuRRvx5bes/X5MSiKs3TCI/AAAAAAAAps8/zI6n7BFUqsMxcaLiWNEQkNw5lJ2cAfBbgCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Following the netdiscover scan, we need a nmap scan to get the information about the services running on the virtual machine. An aggressive nmap scan reveals that 2 services: SSH (22) and HTTP (80) are running on the application.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 192.168.0.174</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tuYEBa51Seo/X5MSstTcjuI/AAAAAAAAptA/lNZ2LY7C7n4jJ0sxFFxfmUFr5oMOOOXPwCLcBGAsYHQ/s16000/2.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">Since we have the HTTP Service running on the virtual machine, let’s takes a look at the webpage hosted:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.0.174</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LE1UuTvsrIk/X5MS1JL4KzI/AAAAAAAAptI/CgbtetQWGkMsho0fYuJs1eQXDwsZmxYmACLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">The webpage says a button that says “Click here to get flag!”. Make sure to click that.</span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">FLAG #1</span> </span></h3>
<p><span style="color: #000000;">We see the webpage is a simple page with some forensics images. Nothing special. Next on the Enumeration tasks was Directory Bruteforce. We used our reliable dirb tool for the directory bruteforce.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://192.168.0.174/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-88OSi8NipqU/X5MS6DkmbEI/AAAAAAAAptM/AvFeBws0xm01Rp9jinihFxitytLzA6vXgCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">This gave us an image directory. We looked into it through the Web Browser and found two images called DNA and fingerprint. We checked DNA it was just a rabbit hole. Then we downloaded the fingerprint.jpg file to the local system to further analyze it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vcqCHuwkpEI/X5MS_qAQ4tI/AAAAAAAAptU/zZeyRTdRu9E-BB7uZ1vUPNq6caTFNSK3ACLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">This machine is based on Forensics and we have an image at our hands, Exiftool seems the right tool to use. Upon a simple look at the metadata of the image using Exiftool, we see that we have our First Flag!</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">exiftool fingerprint.jpg</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WouQdANMH1U/X5MTHRiYJ9I/AAAAAAAAptY/qEFUufkzyVUaOLKHExAuNdTQs2rHjY0ZACLcBGAsYHQ/s16000/6.png"/></span></p>
<h3><span style="color: #800000;">Flag #2</span></h3>
<p><span style="color: #000000;">Now, Enumeration doesn’t always end with the one version of Directory Bruteforce. When in doubt, always use the Extension filter on the dirb. We got a hit on the txt filter and we have some tips.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://192.168.0.174 -X .txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gV0KLLp1Aak/X5MTMcdb-aI/AAAAAAAAptg/nFlYoiTVPDgRfBtUROiWLQV0c8gb3vnkACLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">Looking at the tips.txt we see that it is a kind of robots.txt file just named tips. As we are on the hunt for flags, we choose to browse the flag.zip file first.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-r5muSmwvNr4/X5MTRfhuYOI/AAAAAAAApto/NhPJX8gySOE0RKe-MwjIPyAmDol3igoBACLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">It gave us an option to save the file. </span></p>
<h5><span style="color: #000000;">Let’s do it.</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5SGAKHABxGc/X5MTXNSLsvI/AAAAAAAAptw/SReS85SQ-CMrmeeRqnkSsmjbvQCNhQrCACLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">Now that we have the zip file on our local system, its time to extract the contents of this file. We use the unzip command to extract the files inside the flag.zip file. It requires a password. We don’t have one!!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6W1XcvhiXwY/X5MTdVqHXiI/AAAAAAAApt4/T3xE9CDRfrAFXFc5GV6gjwRF3cBVTVgqACLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">Then, we go back to the Web browser and the tips file. Here is a folder named igolder. It resembles a website that encrypts and decrypts public and private key messages. We browse the folder and see that there is another text file called clue.txt. Upon reading the file we see that it is a combination of a private key and a message.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.0.174/igolder/clue.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--Nmioh7FjGI/X5MTigVayUI/AAAAAAAApuA/Rtw9AL9nW3U46TRRD8S44pTbQsgx5MLigCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">To decrypt the message, we went on the igolder website and pasted the PGP Private Key and the Encrypted message from the clue.txt file. After clicking the Decrypt Message button, we have the secret message. It says to us that the password is 6 characters, with the first 3 being letters “for” and the last 3 being numeric characters.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-W12RMX81IG4/X5MToqbQskI/AAAAAAAApuI/jbMErLTgecsmVko3-R7f0mdh6Eq0oHMXgCLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">Whenever we are in a situation where we have some partial hint of the password, we use crunch to create a dictionary fitting to that pattern. We used crunch and created a dictionary for cracking the password named dict.txt. Using fcrackzip we cracked the password to be for007.</span></p>
<p><span style="color: #000000;">We unzip the file and we have a pdf file labelled flag. We also get a DMP file but more on that later.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">crunch 6 6 -t for%%% -o dict.txt
fcrackzip -u -D -p dict.txt flag.zip
unzip flag.zip</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5F0dv3KX8b8/X5MTw1dWW0I/AAAAAAAApuQ/MEjjb2Q4HVEaqfAzM66Iw7vGirVyAvmiwCLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">Let’s open the PDF file and take a look at our Second Flag</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5ea_YMqObCU/X5MT12il5GI/AAAAAAAApuY/N325Epp0esErbPX5ymgbgDVycbRsJL7TQCLcBGAsYHQ/s16000/14.png"/></span></p>
<h3><span style="color: #800000;">Flag #3</span></h3>
<p><span style="color: #000000;">Now, we have 2 flags, 2 more to go. We received a DMP file from the previous section. In forensics, a dump file can be inspected using pypykatz. So, we will use it to check for some hints inside.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pypykatz -lsa -k /root/Downloads minidump lsass.DMP</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Oqe2TbLvxfs/X5MT8fA87AI/AAAAAAAApuc/cjyk7jHtEcERt_bq4PLms2XcK5RFoditgCLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">Looking at the DMP file a bit thoroughly and we find an NT hash file for a user called jasoos. It means a detective in Hindi. That might be a clue.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-eubnFh4-r1M/X5MUCMB59AI/AAAAAAAApug/d7uOi_tzzeYS13eDoAWlrvNtDWxxJJmPACLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">Then, we copy the has and paste it inside a file named hash. Now we have a hash file and to crack that hash we need John the Ripper. After churning through, John the Ripper gave us the password. It was “Password@1”. That’s not super secure, is it?</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john --format=NT hash</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-w74eTm_VgME/X5MUJQEQ5RI/AAAAAAAApuo/Rzq_NAkBifYciiINceHZQJMLhlE9YaVrgCLcBGAsYHQ/s16000/17.png"/></span></p>
<p><span style="color: #000000;">Now, here we can directly connect via SSH but logging in using Metasploit is better as it has a ton of post-exploitation tools that can be used afterwards. Hence using the ssh_login module we get an SSH session on the machine as user jasoos. Using the shell_to_meterpreter script we got ourselves a meterpreter session on the target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use auxiliary/scanner/ssh/ssh_login
set rhosts 192.168.0.174
set username jasoos
set password Password@1
exploit
session -u 1</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fJH2jGFz8QM/X5MUOsYMe4I/AAAAAAAApus/jTwIqE2KKtoPnb4avxUxcCPaYqLflrGFQCLcBGAsYHQ/s16000/18.png"/></span></p>
<p><span style="color: #000000;">Using the ifconfig command, we see that there is a docker interface running on the application with an IP Address <strong>172.17.0.1 </strong></span></p>
<h5><span style="color: #000000;">It is an internal IP address; means we cannot access it from outside normally.</span></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sessions 2
ifconfig</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PNxX8pcW8FE/X5MUUHwSDkI/AAAAAAAApu0/N5kqPSX0wdscIc3UTyly0Ts8VmcRrHvRQCLcBGAsYHQ/s16000/19.png"/></span></p>
<p><span style="color: #000000;">No need for Panic. Metasploit has our back here. It has an autoroute exploit that can route the network in such a way that internal IP is accessible from outside. The autoroute will create a new host to connect with whose traffic will be redirected to the internal service. But, Autoroute doesn’t tell us the IP Address of the new host. </span></p>
<p><span style="color: #000000;">So, we need to perform a ping sweep to find that particular IP Address which can be used to further exploit the target. Ping sweep gives us the IP address. It is <strong>172.17.0.2.</strong> Now that we know the target IP Address, let’s see exactly what kind of service is this docker instance running at this moment. A Port scan reveals that it is an FTP service. But this service is unknown to us. We don’t have any credentials for us. But there is a feature in FTP service where an anonymous user can log in and access the files through the FTP. To confirm if this FTP has that kind of configuration, we use the ftp anonymous scanner in Metasploit.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use post/multi/manage/autoroute
set session 2
exploit

use post/multi/gather/ping_sweep
set session 2
set rhosts 172.17.0.0/24
exploit

use auxiliary/scanner/portscan/tcp
set rhosts 172.17.0.2
set port 1-100
exploit

use auxiliary/scanner/ftp/anonymous</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cQvmLzGiVv8/X5MUcbDFbKI/AAAAAAAApu4/HBoAndA2ir8ZfP_ve8Yv_cN20ansu2C9wCLcBGAsYHQ/s16000/20.png"/></span></p>
<p><span style="color: #000000;">It says that ftp allows anonymous service. So, let’s enumerate the FTP service by connecting to it as anonymous. We have a directory called pub. Inside that directory, we have a file with a 001 extension. It seems to be an image file that is usually used in forensic investigation. It is labeled sabot which is known as saboot. </span></p>
<h5><span style="color: #000000;">This means Evidence in Hindi.</span></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">shell
python3 -c 'import pty;pty.spawn("/bin/bash")'
ftp 172.17.0.2
anonymous
ls
cd pub
ls
get saboot.001</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HqXlvhIG5NY/X5MUhwdIXoI/AAAAAAAApvA/sSeu8C3xBm4lWgSsg_p4Pki18foXP3wOwCLcBGAsYHQ/s16000/21.png"/></span></p>
<p><span style="color: #000000;">Now using the Python One liner HTTP service we transfer the file from the target machine to our local machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">exit
ls
python -m SimpleHTTPServer</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rvuGCZpS32g/X5MUnht6mBI/AAAAAAAApvI/7qk_1LaVa4Un0FjauDG8gjDJfrg_N3D9gCLcBGAsYHQ/s16000/22.png"/></span></p>
<p><span style="color: #000000;">As the Python One liner runs and provides the service at port 8000, we browse that port and get our saboot file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.0.174:8000</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-88JRxVjvZ-E/X5MUsVGz7pI/AAAAAAAApvQ/O3pnMnPkQywz4uW9-c_J5zhVQgzs86GlQCLcBGAsYHQ/s16000/23.png"/></span></p>
<p><span style="color: #000000;">We decided to use the Autopsy Forensic Investigation tool to inspect the image captured. It can be started using the following command. It tells us that the Autopsy is accessible on localhost port 9999. </span></p>
<h5><span style="color: #000000;">Let’s open it.</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6jht0cX0MjE/X5MUxzOQb7I/AAAAAAAApvY/gYaZkOKjgCUecCsfro7JH3-orPS8jMbygCLcBGAsYHQ/s16000/24.png"/></span></p>
<p><span style="color: #000000;">Here, we have a Web Interface for the Autopsy. We click on the New Case button</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-R30vjVJM8sI/X5MU3FKw3SI/AAAAAAAApvg/hPF9SxDMt4E-_VpcU1xU8YLMM8HiwgLIACLcBGAsYHQ/s16000/25.png"/></span></p>
<p><span style="color: #000000;">We name the Case, Provide the description, and give the Investigator name for the documentation purposes. And again, click on the New Case button.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QsFV65SHJYE/X5MU8eX_TAI/AAAAAAAApvo/d_V9oAyXBL45rHXhHAFlTz9drcC3RFj1gCLcBGAsYHQ/s16000/26.png"/></span></p>
<p><span style="color: #000000;">Now it creates a case. After creating a case, it requires a host for that particular case. It asks for the name of the host. After providing the name click on the Add Host button to continue.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--xAVbb73n-A/X5MVBq2dNkI/AAAAAAAApvw/mZDuwq_jPeQl2ec5WZYVHTJekYXvzZPKgCLcBGAsYHQ/s16000/27.png"/></span></p>
<p><span style="color: #000000;">After the creation of the host, it asks us to add an image file. This is the step where we add the image file, we acquired from the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--wb150bZqa0/X5MVyfLp21I/AAAAAAAApwM/MGMk2hwLcPwnS0FIJK7raVEl0QVInGYpgCLcBGAsYHQ/s16000/29.png"/></span></p>
<p><span style="color: #000000;">It asks for the location of the image file. Since we downloaded it from our Web Browser, it must be in the Downloads folder. We provide the path as shown in the image below. Also, choose the Partition in the Type option. As it is a partition, otherwise it would be quite bigger. Disks are bigger than partitions. After completing, click on the Next button to continue.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-o5gGGZEF-04/X5MV_Ag0m_I/AAAAAAAApwQ/HXZ9m3nDAHkuQyc0hlPnMY1fWJ_Z1lwwwCLcBGAsYHQ/s16000/30.png"/></span></p>
<p><span style="color: #000000;">Here it asks for further options. Let them be the default and click on the Add button.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iASoUfhwr_I/X5MWjZssk7I/AAAAAAAApws/B3fq--xeMVM50F2_0fe1UJ7fu0BTEtGDwCLcBGAsYHQ/s16000/31.png"/></span></p>
<p><span style="color: #000000;">Now that our image has been mounted. It is time for Analyse-it. This can be done as shown in the image below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jtCJe3LKzhI/X5MWsB9a89I/AAAAAAAApww/9D4Rn0ohZGgRn0Zmp2XK_RHYcXiAuXC3ACLcBGAsYHQ/s16000/32.png"/></span></p>
<p><span style="color: #000000;">We see that we have a bunch of files. Among those files, we have 2 text files. A flag file and a creds file. Let’s take a look at our Third Flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-j-jhzxg86-E/X5MWzgZpN-I/AAAAAAAApw4/4FSe9e1wOxADGhWu2t9csnWUT0Xu74BuACLcBGAsYHQ/s16000/33.png"/></span></p>
<h3><span style="color: #800000;">Flag #4</span></h3>
<p><span style="color: #000000;">Now, we have a creds.txt file. We take a look at it to find that there is some encrypted text inside it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2SowcrfFZsU/X5MW6Hy6ahI/AAAAAAAApw8/PO5ExSEiZSg8iAKtByhFC4J8Ny0wjwK2wCLcBGAsYHQ/s16000/34.png"/></span></p>
<p><span style="color: #000000;">It seems like it is a Base64 encoding. We use the echo command with a base 64 decoder as shown in the image below. This might be the password for another user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NEOZkHEqbJY/X5MW_LQOH_I/AAAAAAAApxA/51Uaoep0jGU1aYkRf_UEYH1OmDcyEwYuQCLcBGAsYHQ/s16000/35.png"/></span></p>
<p><span style="color: #000000;">We enumerate the home directory and found that there is another user by the name of forensics. The password must be for this user. We use the su command to login as forensic and the password we found. Then we use the sudo -l command to find what kind of binaries we can use to elevate privileges. We find that ALL is permitted. So, we just use the sudo bash command and get the root. Then look for the final flag in the root directory and we have our fourth and final flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /home
ls
su forensics
jeenaliisagoodgirl
sudo -l
sudo bash
cd /root
cat root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-u8xtKsEHdvM/X5MXFZOFEZI/AAAAAAAApxE/OKaBBuDG62sfS6XjIQ8GDxTrO15Nj2XpQCLcBGAsYHQ/s16000/36.png"/></span></p>
<p><span style="color: #000000;">This concludes this vulnerable machine.</span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more VulnHub Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Contact on <span style="color: #0000ff;"><strong>Twitter</strong> </span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
