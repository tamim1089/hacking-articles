<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Broken 2020: 1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/broken-2020-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-08-11T16:20:00+00:00">August 11, 2020</time><time class="updated" datetime="2025-07-15T16:24:05+00:00">July 15, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Broken 2020 is a beginner level virtual machine created by EuSecinfo. There was no running of public exploits, no rabbit holes in the machine, however, there was a need for custom exploitation and a little bit of common sense.</span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<ol>
<li><span style="color: #000000;"><strong>Reconnaissance</strong></span>
<ol>
<li><span style="color: #000000;">Nmap and directory enumeration</span></li>
<li><span style="color: #000000;">Locating a malicious script to gain shell access</span></li>
</ol>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ol>
<li><span style="color: #000000;">Writing our own script to gain a reverse shell</span></li>
</ol>
</li>
<li><span style="color: #000000;"><strong>Post Exploitation</strong></span>
<ol>
<li><span style="color: #000000;">Gaining Alice’s shell by modifying a python script</span></li>
<li><span style="color: #000000;">Understanding the algorithm of the script’s working</span></li>
</ol>
</li>
<li><span style="color: #000000;"><strong>Snagging the flag</strong></span>
<ol>
<li><span style="color: #000000;">Manipulating a script to read root flag</span></li>
</ol>
</li>
</ol>
<p><strong><span style="color: #000000;">Let’s start</span></strong></p>
<p><span style="color: #000000;">We detected the IP address of the vulnerable machine and ran nmap scan on it to begin with.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5Ze995KwbdE/XzK8v20TnZI/AAAAAAAAm6I/GUHE4DIM7OMo_D2OZlGdWA5OIZ5LPCFJgCLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">We could only find port 80 open.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-m1uXZsrNj1k/XzK9MW6vSMI/AAAAAAAAm6Q/exGSlFnahqsTkhLgCCkUIQMI_A9sIHACwCLcBGAsYHQ/s1600/2.png"/></span></p>
<p><span style="color: #000000;">We immediately scrolled to the website but didn’t find anything useful over there.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bpvdspRCnHs/XzK9XOvHwCI/AAAAAAAAm6U/rxAejD5nsiQt4wMrmyMEPxRNQLL_uRxkACLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Next obvious step was to run directory enumeration. We used dirb for the purpose and found a directory “/cms”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ROZ_7lttTrU/XzK9fp1DpTI/AAAAAAAAm6c/PcLt5PnTm300YsohvmG1c-ZMqWEEIb34wCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">It looked like an installation page of a CMS. We clicked install.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0p8lvWt24Q4/XzK9ru8qTlI/AAAAAAAAm6k/DQeAZaSJ4II1hizMjpQaqBhNmteVFRdVQCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Upon clicking install, something vague happened and seemed like it was a trap.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HCqFpRTv0VA/XzK9zfNPOWI/AAAAAAAAm6s/774vYrSm71Atsn02158C5jnzpRFDYj66wCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Here we could see flag 1 and it is self-explanatory, our website got defaced by that installation of CMS.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Ce6pRidyckw/XzK98Z0ykHI/AAAAAAAAm60/dHnczrhZw9EskwPkZD4Lr1Vs8OSVdXAyQCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">However, since the website got defaced, some change in directories, new files, or some payload must have been executed or created. So we ran directory enumeration once more in the “/cms” directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vM8nc1o1qA0/XzK-EoDJ2pI/AAAAAAAAm68/V6H5UB2DFvkvzaFpZND_0KllJk-Eo6z7ACLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">A new directory called “/cc/” seemed to have been created by this installation. We head over there to see what had been created. As the page explains itself, it is a malicious script that is used to connect the server to a remote IP with a remote port! That means a ready-made shell. But let’s see what it actually does first by inputting a random IP and port.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kukE2mCuIOo/XzK-OgFtMNI/AAAAAAAAm7A/H9QqTZ1RT-EdMK_ntck8oX1fOrRDKIfeQCLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Hence, it is searching for some script in the designated IP. Lets actually create a simple python server and see what script it is searching for.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aHR8tUOyaIw/XzK_qgw4TVI/AAAAAAAAm7o/rB-7m6ikodYaxzbeKBRdy82Y5O-i3Mu6wCLcBGAsYHQ/s1600/12.png"/></span></p>
<p><span style="color: #000000;">So, it was asking for a shell script with a random system-generated name. So, we created a script with the specified name with a python reverse shellcode in it (<span style="color: #0000ff;"><strong>Pentest Monkey python reverse shell</strong></span>). Make sure you also launch a netcat reverse listener on port 8888 in a new terminal window.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0wnqgwyTl20/XzK_QiNgtGI/AAAAAAAAm7g/ilIoMe9Cw_01WDrW7ZWEVWTxOqQsgUtOgCLcBGAsYHQ/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Upon inputting this python server’s IP and port we see a new status code in the website.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pNtde862eIw/XzK_282R-RI/AAAAAAAAm7s/Cfqr5KOEjrwcnwo22l4XLZY_nUQkcOpgACLcBGAsYHQ/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Meanwhile, on our other terminal, we saw a shell was obtained. We traversed to /home/alice directory and read our next flag. There was also a note left there that said that a script log.py was created to clear apache logs.</span></p>
<p><span style="color: #000000;">Upon inspecting log.py we saw that it was clearing out apache logs and creating a log file “clear.log” that was updated every time the machine cleared it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pbqzAjual_U/XzK__0Wd9QI/AAAAAAAAm70/otvBOh40fPgvtIcs32IyG8JqsoQyjwbtwCLcBGAsYHQ/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Here is the catch: upon inspecting clear.log we found that the logs were being cleared after every 1 minute sharp. This could be due to a cron job. Since the script log.py is being run as alice we could gain Alice’s account access if we somehow manage to insert our reverse shellcode in log.py.</span></p>
<p><span style="color: #000000;">Now, log.py is not editable by www-data (the current user) but the directory is writable! So we replaced the log.py file with our own log.py file as below.</span></p>
<p>1: Create a log.py file in our own system with the code as used before:</p>
<p>2: Launch a python server</p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RtySHHXuMWc/XzLALfk9eQI/AAAAAAAAm78/LYA2ttOmVyAecxWglYikYJMUVoZX7ulYgCLcBGAsYHQ/s1600/16.png"/></span></p>
<p><span style="color: #000000;">3. Rename the existing log.py in the VM’s session to log_new.py</span></p>
<p><span style="color: #000000;">4. Copy log.py using wget command and give execute permissions.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JAauXt-_8cU/XzLZ28iTt8I/AAAAAAAAm-U/6K-QJsxjBAQL-y1cpxXrTPHa57Z8kGFkACLcBGAsYHQ/s1600/17.png"/></span></p>
<p><span style="color: #000000;">In a new terminal, start a netcat listener on the port specified in the payload. Here, 5555, and wait for a reverse shell.</span></p>
<p><span style="color: #000000;">Surely, we received Alice’s shell. Now we traversed through directories and found a /back directory with the backup folder. There we snagged our third flag!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-t1cqWisV3d4/XzLAd3jzEqI/AAAAAAAAm8M/1Ox20YXJXXASp84fa_u1THJwi47eCtFWQCLcBGAsYHQ/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Now, we saw a note.txt too which had a message saying “Please put the path of the website backup directory in path.txt and bot will do the rest.” That means those three scripts (backup.py, check.py and hack.sh) were doing something using the contents in path.txt.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6iy5SYnkmMM/XzLA3y59XJI/AAAAAAAAm8U/prhhnT5l8nY8qEklJ8iuQ-4zHwLcveSPgCLcBGAsYHQ/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Upon analyzing the three scripts we understood that the bot (scripts) are picking up the contents in the directory specified in “path.txt” and copying it in the current directory! That solved our purpose since we can just dump the contents of /root directory using this.</span></p>
<p><span style="color: #000000;">Hence, we input /root in path.txt with the command:</span></p>
<p><span style="color: #000000;"><strong>Echo “/root” &gt; path.txt</strong></span></p>
<p><span style="color: #000000;">After waiting for about a minute again, we easily saw the contents of the root directory and read the congratulatory flag!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-E3ukCOtOtkY/XzLBFp0UnaI/AAAAAAAAm8Y/DsmMkFyszTM_OJaEGpoP1574ddPEZQy5ACLcBGAsYHQ/s1600/20.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and left and right brain thinker. Contact<strong> <span style="color: #0000ff;"><a class="broken_link" style="color: #0000ff;" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></span></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
<!-- YARPP Thumbnails -->
<h3>Related posts:</h3>
<div class="yarpp-thumbnails-horizontal">
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/darkhole-2-vulnhub-walkthrough/" title="DarkHole: 2 Vulnhub Walkthrough">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">DarkHole: 2 Vulnhub Walkthrough</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/thales1-vulnhub-walkthrough/" title="Thales1 Vulnhub Walkthrough">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">Thales1 Vulnhub Walkthrough</span></a>
</div>
</div>
            </div><!-- .entry-content -->
            <footer class="post-footer entry-footer">
                                                
            </footer><!-- .entry-footer -->
            
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://www.hackingarticles.in/defense-evasion-hide-artifacts/" rel="prev">Defense Evasion: Hide Artifacts</a></div><div class="nav-next"><a href="https://www.hackingarticles.in/forensic-investigation-examine-corrupt-file-metadata/" rel="next">Forensic Investigation: Examine Corrupt File Metadata</a></div></div>
	</nav>        </div>
