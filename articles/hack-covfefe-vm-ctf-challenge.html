<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Covfefe VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-covfefe-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-11-15T08:40:00+00:00">November 15, 2017</time><time class="updated" datetime="2025-06-10T20:29:57+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to take on another challenge known as “covfefe”.IT is a Debian 9 based Boot to root VM, originally created as a CTF for SecTalks_BNE. The author of this VM is “Tim Kent”.   We have to find 3 flags to complete the challenge.</span></p>
<p><span style="color: #000000;">You can download this VM:  <a style="color: #000000;" href="https://www.vulnhub.com/entry/covfefe-1,199/">https://download.vulnhub.com/covfefe/covfefe.ova</a></span></p>
<p><span style="color: #000000;"><strong>Security Level</strong>: Beginner</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodology:</strong></span></h3>
<p><span style="color: #000000;"><strong>Scanning</strong></span></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">NMAP</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Web spidering</span></li>
<li><span style="color: #000000;">Directory enumeration</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Ssh login</span></li>
<li><span style="color: #000000;">John</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Exploiting SUID Executables</span></li>
</ul>
<p><span style="color: #000000;"><strong>Capture the Flag</strong></span></p>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Scanning</strong></span></h3>
<p><span style="color: #000000;">Let’s start off by scanning the network and identifying host IPs. As illustrated below, we can identify our host IP as 192.168.1.101.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-t4ddW7fc9cA/XQUCvve96EI/AAAAAAAAezc/f95_-1VNyxA66gtDWjiao78QEmJ9AAtLACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Time to scan the Target’s IP with Nmap.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.101</pre>
<p><span style="color: #000000;">As you can see in the following screenshot that port 22, 80 and 31337 are open.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-k67HLxTeqBE/XQUCw5f53uI/AAAAAAAAezw/gJhyc81Y4poVFjVYTrvfJDTjl1V7hVH0ACLcBGAs/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">Browsing the IP with HTTP port 31337 doesn’t give any result.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Yf4sFLNuhV4/XQUCxBlx5yI/AAAAAAAAez0/QYeMtZZQnmIVSlgXgDBXouwaZVuPbgEegCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Directory enumeration using dirb shows two interesting directories “/.ssh” and “/.robots.txt”. Nmap scan has earlier shown robots.txt as well but to dig dipper we went with dirb.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.101:31337/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HXl3IieKz4A/XQUCxgjHYwI/AAAAAAAAez4/2QEQwhfGXIMr7pf6P15egE_pbAVNq3D9gCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Further enumeration of robots.txt using curl shows a file “/taxes” among others. And as soon as we open it, we get our first flag.</span></p>
<pre class="lang:default decode:true">curl http:// 192.168.1.101:31337/robots.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nWbDeZHLWa4/XQUCxw-ZtTI/AAAAAAAAez8/CdOPvtGW1AsBKBHPUUD4J9Qc5mzrVTwjgCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">On browsing 192.168.1.101:31337/.ssh we find ssh private and public key respectively as ‘id_rsa’ and ‘id_rsa.pub’ &amp; authorized_keys.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UhiyP6jxEI0/XQUCyPnV5iI/AAAAAAAAe0A/15zq8FdSkLgFbZ6h5XTIgP0pyKYR6wzewCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We get a download prompt while opening ‘authorized_keys’ in the browser so we download it. We downloaded id_rsa too in the same way.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mfTpfzQdJPo/XQUCym-XjmI/AAAAAAAAe0E/pQ75tajOGHgFutCuJOTwhqumahNhqr6owCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">When we open authorized_keys we find a username ‘simon’ for the private key.</span></p>
<pre class="lang:default decode:true">cat authorized_keys</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OCD2NuBfl6M/XQUCynoiVyI/AAAAAAAAe0I/YFLNS2cLYLwjRpYWU8mThJ7NShCTHRtoQCLcBGAs/s1600/8.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploiting </strong></span></h3>
<p><span style="color: #000000;">Now we use the private key to connect to the VM through ssh. But it is asking for a passphrase here.</span></p>
<pre class="lang:default decode:true">ssh -i id_rsa simon@192.168.1.101</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kbJyM2dr2nM/XQUCy28nq4I/AAAAAAAAe0M/x8iWHPtjBMwEnV_ACkzMatN8njfPsqzEwCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">We have to change its format, which can be done using a john utility called “<a style="color: #000000;" href="https://github.com/truongkma/ctf-tools/blob/master/John/run/ssh2sshng.py">ssh2john</a>”. It will convert ‘ id_rsa’  to a hash format recognized by johntheripper. Now let’s use John the Ripper to crack this hash.</span></p>
<pre class="lang:default decode:true">chmod 777 ssh2john.py
python ssh2john.py id_rsa &gt; hash
john hash --show</pre>
<p><span style="color: #000000;">We find that passphrase of the key is starwars. Now we use this passphrase along with the key to connect through ssh.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_sQhUsGlh0I/XQUCvvXKWeI/AAAAAAAAezk/0zMBLZQU44IBW01srYIvj6niFHBKBSidACLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">After successful ssh login using our newly acquired passphrase, we search for the SUID binaries.</span></p>
<pre class="lang:default decode:true">ssh -i id_rsa simon@192.168.1.101
find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;">Here we notice ‘usr/local/bin/read_message” that takes the user input and displays a message. We provide ‘simon’ as a username when asked. There is a hint for username inside the message. It should be ‘Simon’ instead of ‘simon’.</span></p>
<pre class="lang:default decode:true">usr/local/bin/read_message</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-stkBDkKrsmY/XQUCvqMcC3I/AAAAAAAAezg/Bm_n7rJHdks_-xOmZtAlrQ4hHZ1hKPmuACLcBGAs/s1600/11.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Again when we open ‘read_message’  and provide ‘Simon’ as username,  we get a message with a hint that we can find something in the root. Now when we enter the ‘/root’ folder and list its content we find two files named ‘flag.txt’ and ‘read_message.c’. We can’t access flag.txt yet. Moving on, inside <strong>‘read_message</strong>’  we find our second flag.</span></p>
<pre class="lang:default decode:true">cd /root
ls
cat flag.txt
cat read_meassage.c</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-LsFoWTcx-OI/XQUCwTtOoBI/AAAAAAAAezo/hm57opC6VJoSRqnP51Dyru39gJ-Ws-bkgCLcBGAs/s1600/12.png"/></strong></span></p>
<p><span style="color: #000000;">In above screenshot reading through the source code we find that, when we enter a string it reads the first 5 characters of the string as Simon, if it matches then it runs /<strong>usr/local/sbin/message</strong>. But the input allocation for this is 20 bytes. So, we have to overflow the stack entering more than 20 bytes of data. We use the first 5 char to be ‘<strong>Simon</strong>’ followed by 15 ‘<strong>A</strong>’ and then ‘<strong>/bin/sh</strong>’ at the 21<sup>st</sup> byte.</span></p>
<pre class="lang:default decode:true  ">read_message
SimonAAAAAAAAAAAAAAA/bin/sh
cd /root
ls
cat flag.txt</pre>
<p><span style="color: #000000;">As soon as we provide this string, we spawn a shell as root. Now we can access <strong>flag.txt</strong>. Finally, we found the third flag.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-nOQYoDsHGT0/XQUCwmFfpSI/AAAAAAAAezs/BUPcvO9hMVEb7y6nwMwTRuz2bdwyXQ2TwCLcBGAs/s1600/13.png"/></strong></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Nisha Yadav is trained in Certified Ethical hacking and Bug Bounty Hunter. She is currently working at Ignite Technologies as a Security Analyst. Connect with her <a style="color: #000000;" href="https://www.linkedin.com/in/nisha-yadav-90816120/"><strong>here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
