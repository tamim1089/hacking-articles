<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/wireless-penetration-testing/" rel="category tag">Wireless Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Wireless Penetration Testing: Password Cracking</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/wireless-penetration-testing-password-cracking/" rel="bookmark"><time class="entry-date published" datetime="2021-06-16T18:48:54+00:00">June 16, 2021</time><time class="updated" datetime="2025-05-10T17:37:46+00:00">May 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="" data-start="508" data-end="634"><span style="color: #000000;">In this article, we will demonstrate various methods for password cracking to perform penetration testing on wireless devices.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Introduction</strong></span></li>
<li><span style="color: #000000;"><strong>Simulation Mechanism</strong></span></li>
<li><span style="color: #000000;"><strong>Pre-requisites</strong></span></li>
<li><span style="color: #000000;"><strong>Initial Setup</strong></span></li>
<li><span style="color: #000000;"><strong>Password Cracking</strong></span>
<ul>
<li><span style="color: #000000;">Aircrack-ng</span></li>
<li><span style="color: #000000;">cowpatty</span></li>
<li><span style="color: #000000;">Hashcat</span></li>
<li><span style="color: #000000;">John The Ripper</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #800000;"><strong>Introduction</strong></span></h3>
<p><span style="color: #000000;">Brute-forcing is probably one of the most well-known techniques when it comes to gaining access. It’s a soft cushion to land upon when nothing seems to work anymore and rightfully so since the majority of network devices and applications lack the resilience to effectively detect and prevent brute-force attacks, it comes as an effective attack. In this article, we’ll be focusing on various Wi-Fi password brute-forcing tools to demonstrate how easy it can be for an attacker to guess your Wi-Fi password and <strong><em>the necessity to keep a complex password</em>.</strong></span></p>
<h3><span style="color: #800000;"><strong>Simulation Mechanism</strong></span></h3>
<p><span style="color: #000000;">Since we don’t want to be breaking into unauthorized devices, we’ll set up our own lab. And by the lab I mean we’ll use our own Wi-Fi access point, keep a password that we know, forget the device and attempt brute forcing using a dictionary containing that password.</span></p>
<h3><span style="color: #800000;"><strong>Pre-requisite</strong></span></h3>
<p class="" data-start="51" data-end="258"><span style="color: #000000;">If you use a virtual machine with Kali Linux, you will need an external Wi-Fi adapter because the virtual machine, by default, bridges or NATs to the adapter you specify and cannot detect the WLAN interface.  Therefore, you should research and purchase an external adapter capable of going into monitor mode. Afterward, go to your VM settings and connect the adapter to your virtual machine.</span></p>
<h3><span style="color: #800000;"><strong>Initial Setup</strong></span></h3>
<p><span style="color: #000000;">Let’s first set up the password of our access point here. Let’s say <strong>raaj:raj12345</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LNSduUXEeAo/YMpAaidjhMI/AAAAAAAAwfQ/cX_OC4gWYYYmt8rSUaMgEkrSosIF4Lf8wCLcBGAsYHQ/s16000/0.png"/></span></p>
<p><span style="color: #000000;">We are good to go now and since the password has changed you obviously aren’t connected to the access point. Before going any further, let me throw out some theory now. In the previous article <span style="color: #0000ff;"><strong><u><a style="color: #0000ff;" href="https://www.hackingarticles.in/wireless-penetration-testing-fern/">here</a></u> </strong></span>we saw some background about <strong>monitor mode</strong> and <strong>Wlan</strong> interface. Let’s begin by putting our Wi-Fi adapter in monitor mode first.</span></p>
<p><span style="color: #000000;">Assuming that the Wi-Fi interface is Wlan0, the command is:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">airmon-ng start wlan0</pre>
<p><span style="color: #000000;">We are using the airmon module for this which comes with built-in Kali Linux. Next, we’ll have to scan for the access point (here, SSID=raaj). If you check your interfaces with the <strong>iwconfig </strong>command now you’d see your <strong>Wlan0 </strong>has been transformed to <strong>Wlan0mon. </strong>Good for us. Now we scan access points around us</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">airodump-ng wlan0mon</pre>
<p><span style="color: #000000;">This should start scanning for Access Points’ SSIDs and BSSIDs (Basic service set identifiers or simply a 48 bit MAC) around you. We see raaj in there too.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CkOUhsZBTeg/YMpAkcXJmcI/AAAAAAAAwfU/TfdCzwfc1Bw7-w_y2mYCfEp02YgjcmqfQCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Now let us understand this screen first. On the top left you see <strong>CH 3 </strong>written. That is a Wi-Fi channel.</span></p>
<h5><span style="color: #000000;"><strong>Definition: </strong></span></h5>
<p><span style="color: #000000;">In layman terms<strong>, </strong>a Wi-Fi channel is a path on which Wi-Fi packets travel to and from your device to the access point.</span></p>
<p><span style="color: #000000;">A 2.4 GHz Wi-Fi uses 11 channels and a 5 GHz Wi-Fi uses 45 channels. Each channel may vary or depending on what the vendor may use– higher or lower channel size is possible but generally is under 100 MHz in width. Your Wi-Fi access point uses a specified channel to transmit data. This channel to<strong> transmit</strong> can be manually configured in access points. A Wi-Fi adapter, however, just like your FM<strong> receiver</strong> can tune to listen to any channel.</span></p>
<h5><span style="color: #000000;"><strong>Analogy</strong>: </span></h5>
<p><span style="color: #000000;">Just like radio channels, a Wi-Fi adapter working on channel 3 (lets say a 60 MHz frequency) won’t listen to what’s happening on channel 6 (let’s say a 100 MHz frequency) until you tune it to listen to channel 6. But your Wi-Fi adapter/NIC is able to change its listening channel automatically. We’ll use airodump-ng to specify a channel later in this article.</span></p>
<p><span style="color: #000000;">Now that I have the target, I will capture a handshake.</span></p>
<h5><span style="color: #000000;">Handshake: </span></h5>
<p><span style="color: #000000;">A handshake in Wi-Fi is a mechanism by which an access point authenticates a client to onboard it and use its services. </span><span style="color: #000000;">Interestingly, in a handshake, the pairwise master key (PMK) is not transferred, so you cannot directly grab the PMK. If it were possible, it would present a significant vulnerability.</span> <span style="color: #000000;">Rather, this handshake file has something called a message integrity check (MIC) which is a combination of your Wi-Fi passphrase, nonce (random numbers), SSID and some other keys.</span></p>
<h5><span style="color: #000000;"><strong>Goal: </strong></span></h5>
<p><span style="color: #000000;">Our goal is to capture this handshake file (.cap file), extract juicy information and brute force against the MIC to finally obtain a password. Since MIC is analogous to a hash in Wi-Fi, we need a dictionary to calculate hashes and compare against the value given in the handshake capture and confirm the password.</span></p>
<p><span style="color: #000000;">Since a handshake is happening on a channel, we can use the same channel to see what a handshake file looks like. But since this handshake only occurs when a user authenticates, we have to wait for a client to connect himself or deauthenticate the client and force him to connect  (yeah, possible).</span></p>
<p><span style="color: #000000;">We saw in the above screenshot that “raaj” operates on channel 3 with a given BSSID. Let’s use airodump to capture a handshake file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">airodump-ng wlan0mon -c3 --bssid 18:45:93:69:A5:19 -w pwd</pre>
<p><span style="color: #000000;">-c : channel</span></p>
<p><span style="color: #000000;">-w : name to save as</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-a_bAYYi8Q3I/YMpAq80XfkI/AAAAAAAAwfY/YfiooSrvZFwBvJNGh4l4gPL1HH3EWHREgCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Now, while airodump would wait for a handshake, we can’t just sit quietly. We have to force a user to reauthenticate by deauthenticating him. It can be done by aireplay-ng like this:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">aireplay-ng --deauth 0 -a 18:45:93:69:A5:19 wlan0mon</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9rCbS-ZQny0/YMpAu7Y79hI/AAAAAAAAwfc/TvgqgbgktCUWDgnVGHc5ugAOqJ9jvfu8ACLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">And it seemed to have worked like magic as you can see the client has re-authenticated and we have a handshake! The file is saved as pwd-01.cap</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KbiyRt5qO0E/YMpAy5YCYEI/AAAAAAAAwfg/oraXSqmxGvYSNnknMNKuZndZMRP6H5I_QCLcBGAsYHQ/s16000/4.png"/></span></p>
<h3><span style="color: #800000;">Aircrack-ng</span></h3>
<p><span style="color: #000000;">For simplicity, I’ll rename it to “handshake.cap” and run aircrack-ng using a very long dictionary of millions of most common passwords and some passwords I created from the information about my target! Let’s call it dict.txt. And instead of millions let’s only add 5-10 passwords because we already know it and just have to demonstrate the attack!</span></p>
<p><span style="color: #000000;">So, the command is:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">aircrack-ng handshake.cap -w dict.txt</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-eZFKRKHtsVQ/YMpA6QoI2kI/AAAAAAAAwfo/VP7vyamY7k0QmBGm0RGRKwOEN7l0HpDMQCLcBGAsYHQ/s16000/5.png"/></strong><strong> </strong></span></p>
<p><span style="color: #000000;">As evident below, we have the password thanks to aircrack.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uepJmd36w2g/YMpA__sHbOI/AAAAAAAAwfs/44cNvIBMDrcN7xVmDGAqLQ6jaEWFnVKpwCLcBGAsYHQ/s16000/6.png"/></span></p>
<h3><span style="color: #800000;"><strong>cowpatty</strong></span></h3>
<p><span style="color: #000000;">You can also use another well-known tool called cowpatty to perform the same method. Here’s the <span style="color: #0000ff;"><strong><u><a style="color: #0000ff;" href="https://github.com/joswr1ght/cowpatty">Link</a></u></strong></span>. During my testing, the “<strong>handshake.cap</strong>” file was renamed to “wifi.cap,” so don’t get confused.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cowpatty -r wifi.cap -f dict.txt -s raaj</pre>
<p><span style="color: #000000;">-s: SSID</span></p>
<p><span style="color: #000000;">It worked like a charm!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sNJA7kBginU/YMpBGnpV9iI/AAAAAAAAwf0/qgLxAJcPAy4jrhRvLydSuAFdMijLTWa1gCLcBGAsYHQ/s16000/7.png"/></span></p>
<h3><span style="color: #800000;"><strong>Hashcat</strong></span></h3>
<p><span style="color: #000000;">For this next method, we would need to install hashcat first. It is the undisputed go-to tool when we talk about hash cracking. You can download it from <span style="color: #0000ff;"><strong><u><a style="color: #0000ff;" href="https://github.com/hashcat/hashcat">here</a></u></strong></span>. In Kali Linux, hashcat is preinstalled with utilities as well. We would use the “cap2hccapx” script for this method.</span></p>
<p><span style="color: #000000;"><strong>hccapx: </strong>It is a custom format specifically developed for hashcat for usage on WPA and WPA2.</span></p>
<p><span style="color: #000000;"><strong>cap2hccapx</strong> would convert the .cap file to .hccapx and hashcat would be able to bruteforce against it.</span></p>
<p><span style="color: #000000;">We can do this by:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /usr/share/hashcat-utils
./cap2hccapx.bin /root/wifi.cap /root/wifi.hccapx</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Pm6z8LDKl-s/YMpBLPtnvKI/AAAAAAAAwf8/iMpFTccSjgsNlpPUb19Jzbq249zcID30gCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">It is done. We now need to run hashcat to brute force this file:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hashcat -m 2500 wifi.hccapx dict.txt --show</pre>
<p><span style="color: #000000;">-m : hash type. 2500= WPA/WPA2 hashes</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qZJaSBOaBbI/YMpBQJV_wII/AAAAAAAAwgE/sdYBtnDBvqg025ErvdH8oYX-cjjZHSH1ACLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">Quiet simple.</span></p>
<h3><span style="color: #800000;"><strong>John The Ripper</strong></span></h3>
<p class="" data-start="80" data-end="253"><span style="color: #000000;">You can also do the same using <strong>John the Ripper.</strong> You just need to convert the file into a standard John hash file. To do this, you can use the <strong>hcxpcapng tool</strong>, as shown below:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hcxpcapngtool --john hash.john wifi.cap</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-n_vczLPEoZU/YMpBV61207I/AAAAAAAAwgI/mpAnzHxe3qQ0HDrCskycB_IysyZHtW66gCLcBGAsYHQ/s16000/10.png"/></strong></span></p>
<p><span style="color: #000000;">A gorgeous thing to observe here is the contents of the capture file! Juicy, isn’t it? Let’s use john to crack the hash now:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john --format=wpapsk --wordlist dict.txt hash.john
john --show hash.john</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-LPqVpeESlNM/YMuGb4mbnkI/AAAAAAAAwg4/BQEuWtMorT0UW8GOzYzELbwKylW0sk4JQCLcBGAsYHQ/s16000/13.png"/></p>
<h3><span style="color: #800000;"><strong>Second Method</strong></span></h3>
<p><span style="color: #000000;">For all the pros who converted .cap to .hccapx, here’s the last method for you. You can use the hccap2john script pre-existing in your Kali to convert that .hccapx file to a John hash!</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">/usr/sbin/hccap2john wifi.hccpax &gt; wifihash</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CBbmkjLwloM/YMpBrwlND3I/AAAAAAAAwgk/0A00fVPk5r0jxk__msF7oIJIl83rXXv5wCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">And finally, use John to crack it</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john --wordlist=/root/dict.txt --format=wpapsk wifihash</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-D7uOLrYuHh8/YMpBxElkzUI/AAAAAAAAwgs/SCRcWSO7hfoJm7ROGrjQySCEgzFBz_soACLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">We learnt various methods to brute force a captured handshake .cap file. The aim is to have multiple arrows in your quiver so if one technique fails you, you know how you can cross it over. Thanks for reading.</span></p>
<p><span style="color: #000000;"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and left and right brain thinker. Contact</span><strong> <a class="broken_link" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
