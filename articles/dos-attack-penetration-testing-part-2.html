<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">DOS Attack Penetration Testing (Part 2)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/dos-attack-penetration-testing-part-2/" rel="bookmark"><time class="entry-date published updated" datetime="2017-12-26T16:40:29+00:00">December 26, 2017</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In our previous “<a style="color: #000000;" href="http://www.hackingarticles.in/dos-penetration-testing-part-1/">DOS Attack Penetration testing</a>” we had described several scenarios of DOS attack and receive alert for Dos attack through snort. DOS can be performed in many ways either using a command line tool such as Hping3 or GUI based tool. So today you will learn how to Perform Dos attack using GUI tools as well as a command line tool and get an alert through snort.</span></p>
<p><span style="color: #000000;"><strong>Let start!!</strong></span></p>
<h3><span style="color: #800000;"><strong>TCP Flood Attack  using LOIC</strong></span></h3>
<p><span style="color: #000000;">As we have described in our both article Part 1 and part 2 that in target system Snort is working as NIDS for analyzing network traffic packets.  Therefore first we had built a rule for in snort to analysis random TCP packets coming in our network rapidity.</span></p>
<p><span style="color: #000000;">Execute given below command in ubuntu’s terminal to open snort local rule file in text editor.</span></p>
<pre class="lang:default decode:true">sudo gedit /etc/snort/rules/local.rules
alert TCP any any -&gt; 192.168.1.10 any (msg: "TCP Flood"; sid:1000001;)</pre>
<p><span style="color: #000000;">The above rule will monitor incoming TCP packets on 192.168.1.10 by generating alert for it as “TCP Flood”. Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<p><span style="color: #000000;"><strong>sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vrokYPYLqSY/WkJfknNxUmI/AAAAAAAAS1s/Tz-2aSmlat8EOYWAWoikTvKM_xeKMiCYACEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;"><strong>LOIC:</strong> It stands for low Orbit iron cannon which is a GUI tool developed by Praetox Technologies which is a network stress testing tool. We had used it only for educational purpose in our local network, using it over public sector will consider as crime and take an illegal job.  Download it from Google.  </span></p>
<p><span style="color: #000000;">We had downloaded LOIC in our Windows system run the setup file for installation. Start the tool follow the given below step:</span></p>
<ol>
<li><span style="color: #000000;"><strong>Select your target:</strong> Here we will go with <strong>IP option</strong> and enter the victims IP: 192.168.1.10 then click on Lock on the tab.</span></li>
<li><span style="color: #000000;"><strong>Attack Option:</strong> Enter <strong>port</strong> no. and select <strong>metho</strong>d such as TCP and enter no. of <strong>threads</strong>. If you want to wait for a reply packet from the victim’s network then enable the checkbox else to disable it.</span></li>
<li><span style="color: #000000;"><strong>Adjust the scale: </strong> Drawn the cursor left or right for setting the speed of your TCP packet either faster or slower mode.</span></li>
<li><span style="color: #000000;"><strong>Attack status:</strong> describe the attack state such as connecting or request or etc.</span></li>
<li><span style="color: #000000;"><strong>Ready: </strong> Now click on IMMA CHARGIN MAH LAZER to launch the DOS attack and click on stop flood In order to stop DOS attack.</span></li>
</ol>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4zgFScLlmu0/WkJflcKNw6I/AAAAAAAAS18/M31BV8JTIUEaEc-WJTbWf1jNPx_TdhwpQCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">We are involving Wireshark in this tutorial so that you can clearly see the packet sends from an attacker network to targets network. Hence in given below image, you can notice endless TCP packet has been sent on target’s network. It is considered as Volume Based DOS Attack which floods the target network by sending infinite packets to demolish its network for other legitimate users.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-maSNMhJNRyk/WkJfovOUv3I/AAAAAAAAS2s/M1DeUpzpLQwlVChfKmV4f7Y4VKa4Rpu8ACEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Return to over your target machine where you will notice that snort is exactly in same way capturing all incoming traffic, here you will observe that it is generating <strong>alerts </strong>for “TCP Flood”.  Hence you can block the attacker’s IP (192.168.1.16) to protect your network from discard all further coming packets toward your network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-W9-HQg-ttCI/WkJfpK-PCGI/AAAAAAAAS24/Mgq8jb_zog02YO7o3tVCaQvyWoRiD5ZZQCEwYBhgL/s1600/4.png"/></span></p>
<h3><span style="color: #800000;"><strong>UDP Flood Attack  using LOIC</strong></span></h3>
<p><span style="color: #000000;">I think now everything is clear to you how you can build rule in snort get alert for the suspicious network again repeat the same and execute given below command in ubuntu’s terminal to open snort local rule file in text editor and add a rule for UDP flood.</span></p>
<p><span style="color: #000000;"><strong>sudo gedit /etc/snort/rules/local.rules</strong></span></p>
<pre class="lang:default decode:true">alert UDP any any -&gt; 192.168.1.10 any (msg: "UDP Flood"; sid:1000003;)</pre>
<p><span style="color: #000000;">The above rule will monitor incoming UDP packets on 192.168.1.10 by generating alert for it as “UDP Flood”. Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-9BkkARogPvw/WkJfpBokb9I/AAAAAAAAS28/4CMhoCfiRgoiGcTYupkS0VJT2JM5hlRqACEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Repeat the whole steps as done above only change the method attack option to choose UDP method and launch the DOS attack on target IP. You can set any set number of threads for attack since it is tutorial, therefore, I had set 20 for UDP. It is considered as <strong>Volume Based DOS Attack</strong> which floods the target network by sending infinite packets to demolish its network for other legitimate users.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-WvvpTu-OtaY/WkJfpZiyV6I/AAAAAAAAS3A/_8waCdXGZ3I4S4DsUACBJycL9H3bmIPagCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Return to over your target machine where you will observe that snort is precisely capturing all incoming traffic in the same way, here you will observe that it is generating <strong>alerts </strong>for “UDP Flood”.  Hence again you can block the attacker’s IP (192.168.1.16) to protect your network from discard all further coming packets toward your network on port 80.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/--8rM1aAwU2Y/WkJfphITuuI/AAAAAAAAS3E/daVCwyPf4McpU09j1Mzu8c6T4TBOfqj1wCEwYBhgL/s1600/7.png"/></span></p>
<h3><span style="color: #800000;"><strong>TCP Flood Attack  using HOIC</strong></span></h3>
<p><span style="color: #000000;">Next, we are using HOIC which is also a GUI tool for tcp attack and if you remember we had already configured TCP flood rule in our local rule file. Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><strong>HOIC:</strong> It stands for higher orbit ion cannon developed by Praetox Technologies which is a network stress testing tool. We had used it only for educational purpose in our local network, using it over public sector will consider as crime and take an illegal job. Download it from Google.</span></p>
<p><span style="color: #000000;">We had downloaded HOIC in our Windows system run the setup file for installation. Start the tool follow the given below step:</span></p>
<p><span style="color: #000000;">Add the target by making Click on plus symbol “<strong>+</strong>”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-oqn2xutSxlI/WkJfputkqYI/AAAAAAAAS3M/wZwUto8AeEI4yq7V08JVn9JU25n019ZegCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">A list of attack option will get pop up as shown in the given below image and follow the given below step:</span></p>
<p><span style="color: #000000;"><strong>URL:</strong> Enter your target network address as <strong>http://192.168.1.10</strong></span></p>
<p><span style="color: #000000;"><strong>Power:</strong> Low/<strong>medium</strong>/high to decide the speed of packet to bent to the target machine.</span></p>
<p><span style="color: #000000;">At last click on <strong>Add</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-S-WP9sAq2Ew/WkJfk8s20bI/AAAAAAAAS1w/katFNVsPJdw0iUfR9p2CIkXAMP71Hz72QCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">From give below image you can check the status of attack “ready”, now set number of threads and then click on FIRE THE LAZER tab to lunch the dos attack.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-eszzhjhK8FY/WkJfk3gQ0rI/AAAAAAAAS10/PFIdQO3zxdoEnS8T27YwQHUDmNuSfPxkACEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">You can clearly observe the TCP packet is sending from the attacker network to targets network. In given below image you can notice the endless TCP packet has been sent on target’s network using TCP Flags such as SYN/RST/ACK. It is considered as <strong>Volume Based DOS Attack</strong> which floods the target network by sending infinite packets to demolish its network for other legitimate users.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-8eihmuAdHaM/WkJflMKChLI/AAAAAAAAS14/WLYSmJSHX4gJu3i3t8pCyvIV5e99ApVOQCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Return to over your target machine where you will notice that snort is capturing all incoming traffic exactly in same way as above, here you will observe that it is generating <strong>alerts </strong>for “TCP Flood”.  Hence you can block the attacker’s IP (192.168.1.11) to protect your network from discard all further coming packets toward your network on port 80.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Ln-VvrESgCY/WkJflbIa1PI/AAAAAAAAS2A/Hlil00KwuoAlqyXpN4QwAJfpBEg0BUGzwCEwYBhgL/s1600/13.png"/></span></p>
<h3><span style="color: #800000;"><strong>GoldenEye</strong></span></h3>
<p><span style="color: #000000;">Goldeneye is a command line tool used for security testing purpose we had used only for tutorial don’t use it over public sector it will consider as crime and take an as an illegal job. Execute given below in your Kali Linux to download it from GitHub.</span></p>
<pre class="lang:default decode:true">git clone https://github.com/jseidl/GoldenEye.git</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nWfdO8gGfbY/WkJfltcxgkI/AAAAAAAAS2E/vH9gwb6jxZAGdZCNO7k3nrdNRIAU4kpWQCEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Now give all permission to the python script and execute given below command for Launching a DOS attack on the target network. Basically, Goldeneye is used for HTTP dos testing for testing any web-server network security.</span></p>
<pre class="lang:default decode:true">./goldeneye.py http://192.168.1.10</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Hq7xROFuM-U/WkJfmPhc_UI/AAAAAAAAS2M/bRS8KskQoEUBtYrJ_dyV9IbImn2B26qYwCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">Using Wireshark you can observe the flow of traffic between victim and attacker network. So if notices were given below image then you will find that first attacker (192.168.1.103) sends TCP syn packet for establishing a connection with victim’s network then the attacker is sending http packet over victim’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-IISMq4gJpjE/WkJfmt6IzKI/AAAAAAAAS2I/DnxbN7bZbZUp_teaYueu11lxZEUzLxZYwCEwYBhgL/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Here you will observe that it is generating <strong>alerts </strong>for “TCP Flood” since the port is 80 follow TCP protocol, therefore, snort captured the traffic generated by goldeneye. Hence you can block the attacker’s IP (192.168.1.103) to protect your network from discard all further coming packets toward your network on port 80.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2yY-HzTrLVg/WkJfnOF9BsI/AAAAAAAAS2Q/eSpgMwlLBV0AOiftGDEAlWR_1BUXk-cmACEwYBhgL/s1600/23.png"/></span></p>
<h3><span style="color: #800000;"><strong>Slowloris</strong></span></h3>
<p><span style="color: #000000;">Slowloris is a command line tool used for security testing purpose we had used only for tutorial don’t use it over public sector it will consider as crime and take an illegal job. Execute given below in your Kali Linux to download it from GitHub.</span></p>
<pre class="lang:default decode:true">git clone https://github.com/llaera/slowloris.pl.git</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-4S7aefPK5o8/WkJfnBJyc9I/AAAAAAAAS2U/F6uxC2n-pzslhsPTQb3hijUWsdolxR0RACEwYBhgL/s1600/24.png"/></span></p>
<p><span style="color: #000000;">Now give all permission to the Perl script and execute given below command for Launching the DOS attack on the target network.</span></p>
<pre class="lang:default decode:true">perl slowloris.pl -dns 192.1681.10</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-BMM0uEB99cQ/WkJfnd3FppI/AAAAAAAAS2Y/6UdLuZYu7gYMbAdflqaIn058u7qPLQmLACEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Using Wireshark you can observe the flow of traffic between victim and attacker network. So if notices were given below image then you will find that first attacker (192.168.1.103) sends TCP syn packet for establishing a connection with victim’s network then victim’s is sending SYN, ACK packet over attacker’s network and then attacker sends ACK packet and this will keep on looping.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-t5aVhzZh-eI/WkJfnq0oOII/AAAAAAAAS2c/qh3va5lTgDg80kh0RxnI5l-vuU5_DCNkgCEwYBhgL/s1600/26.png"/></span></p>
<p><span style="color: #000000;">Return to over your target machine where you will notice that snort is capturing all incoming traffic exactly in same way as above, here you will observe that it is generating <strong>alerts </strong>for “TCP Flood”.  Hence you can block the attacker’s IP (192.168.1.11) to protect your network from discard all further coming packets toward your network on port 80.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-9W2JJ08yJpE/WkJfnpGSSqI/AAAAAAAAS2g/04M8B5IBafcQTBG1pNyAAgwBe8y1Y3zcQCEwYBhgL/s1600/27.png"/></span></p>
<h3><span style="color: #800000;"><strong>Xerxes</strong></span></h3>
<p><span style="color: #000000;">Xerxes is a command line tool used for security testing purpose we had used only for tutorial don’t use it over public sector it will consider as crime and take an as the illegal job. Execute given below in your Kali Linux to download it from GitHub.</span></p>
<pre class="lang:default decode:true">git clone https://github.com/zanyarjamal/xerxes.git</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-JiSdEkvAr1s/WkJfniN-DOI/AAAAAAAAS2k/7ySYcZFAPdMne4-ZdaHzzWDQolkDW_eYwCEwYBhgL/s1600/28.png"/></span></p>
<p><span style="color: #000000;">Since it is written in c language there we need to compile it using gcc as shown in given below command and run then run the script in order to launch DOS attack.</span></p>
<pre class="lang:default decode:true ">gcc xerxes.c -o xerxes
./xerxes 192.168.1.10 80</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-xvjZxaF6NhM/WkJfoTCwIkI/AAAAAAAAS2o/RMewM4PXvNMHCe9uDObfAxx2Z0MeSJPowCEwYBhgL/s1600/29.png"/></span></p>
<p><span style="color: #000000;">You can clearly observe the TCP packet is sending from the attacker network to targets network. In given below image you can notice the endless TCP packet has been sent on target’s network using TCP Flags such as SYN/ACK/PSH. These packets are sent in a loop between the attacker can target network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-D9dJSrCqIgI/WkJfol62DOI/AAAAAAAAS2w/GOScSO0Dj8cuw5GNSDIaun3rHnXSzNymACEwYBhgL/s1600/30.png"/></span></p>
<p><span style="color: #000000;">Return to over your target machine where you will notice that snort is capturing all incoming traffic exactly in same way as above, here you will observe that it is generating <strong>alerts </strong>for “TCP Flood”.  Hence you can block the attacker’s IP (192.168.1.11) to protect your network from discard all further coming packets toward your network on port 80.</span></p>
<p><span style="color: #000000;">Well in this tutorial we had used most powerful top 5 tools for DOS attack.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-uVlP2vIqCEA/WkJfozVRxYI/AAAAAAAAS20/Sk3MvThrj1M4Ah-wh-3KcC1ftHq_lMxDACEwYBhgL/s1600/31.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Rahul Virmani</strong> is a Certified Ethical Hacker and the researcher in the field of network Penetration Testing (CYBERSECURITY).    Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/rahul-virmani-4280666a/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
