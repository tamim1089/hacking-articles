<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Bsides London VM 2017(Boot2Root)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-bsides-london-vm-2017boot2root/" rel="bookmark"><time class="entry-date published" datetime="2018-02-03T07:43:44+00:00">February 3, 2018</time><time class="updated" datetime="2025-06-10T20:12:27+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF challenge known as Bsides London 2017. The credit for making this vm machine goes to “Hacker House” and it is another boot2root challenge in which our goal is to get root to complete the challenge. You can download this VM <strong><a style="color: #000000;" href="https://www.vulnhub.com/entry/hackerhouse-bsides-london-2017,202/">here</a></strong>.</span></p>
<p><span style="color: #000000;">Let’s Breach!!!</span></p>
<p><span style="color: #000000;">Let us start form getting to know the IP of VM (Here, I have it at 192.168.0.7 but you will have to find your own)</span></p>
<p><span style="color: #000000;">Let’s do an nmap scan for port enumeration.</span></p>
<pre class="lang:default decode:true">nmap -p- -sV 192.168.0.7</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Ykqh2i80LOk/WnU-l4jvVVI/AAAAAAAAT_0/8T99qX3MgxgxYUeqf3XTaOSFUR1BoCPiwCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">We find port 80 to be open, port 80 is running http.</span></p>
<p><span style="color: #000000;">So we first open 192.168.0.7 in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UDFUuVPzwNg/WnU-pECC96I/AAAAAAAAUCs/I-yjy79IUAoD6JXbvMbesnBhLjk2mb6rwCEwYBhgL/s1600/2.1.png"/></span></p>
<p><span style="color: #000000;">We find a hint to use rafting directory, it is a wordlist that is used to enumerate directories. So we enumerate the directories using raft-large-directories for further information.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.0.7 raft-large-directories</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-u83Klgtzo3g/WnU-s-ySlqI/AAAAAAAAUCg/hVbV2tWvmts5ySBY5oaD0pURJcRBLiL6gCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Now we enumerate the directories with common wordlist and find a directory called cgi-bin/.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.0.7 -w</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-HtanLbuF6Nw/WnU-ppUXmiI/AAAAAAAAUCc/Hhd9iXFLXQ07Vemv7ZZMv0UkX-qzwCW5gCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">As the dirb scan gave us a forbidden error on cgi-bin/ directory. We try to look through the files inside cgi-bin</span></p>
<pre class="lang:default decode:true">dirb http://192.168.0.7/cgi-bin/ -N 403</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-JerleKiizGo/WnU-pZXJvWI/AAAAAAAAUCc/Uvyn-34gxH434PagLFFK75FZlyVymfXgACEwYBhgL/s1600/2.2.png"/></span></p>
<p><span style="color: #000000;">We open the links found using dirb, one of those links contains a login page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-N6qeAcRpZvY/WnU-v0d1goI/AAAAAAAAUCc/_lok3sqJIUYmNdAwclA4qCWEv5ezmXtygCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We take a look at the source code and find a hexadecimal string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ymcDUd_8Aao/WnU-wFW_imI/AAAAAAAAUCo/BlehNTZ6Fh0RwTNuQVBEQ3yBxWiWvcCyQCEwYBhgL/s1600/5.png"/><img decoding="async" src="https://2.bp.blogspot.com/-ymcDUd_8Aao/WnU-wFW_imI/AAAAAAAAUCo/BlehNTZ6Fh0RwTNuQVBEQ3yBxWiWvcCyQCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We decode it using xxd and find a base64 encoded string. After decoding it we found that the base64 string starts from Y so we select the string from Y and found a hexadecimal string inside a flag. We decode it and find a string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-v9M_EELPdRc/WnU-wUf0YRI/AAAAAAAAUCs/05eJY8rvyDcRivJIboURiH2abTL1HQStgCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We use this string as password to login through the login page, we use username as admin.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-OD2TE_VYd5g/WnU-wjMAd5I/AAAAAAAAUCo/9l_LQ6QsA9wFei5e3Mk6LvtqZdS6jKe-wCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Even after login we don’t find anything on the login page, so we move to the links provided by the dirb scan.</span></p>
<p><span style="color: #000000;">We found one page that looks like a blank page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-s61XypW4X70/WnU-w_c2XmI/AAAAAAAAUCs/8nrXR3gRhDogDRZ_-OikGzn4UkvVeeplgCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">When we take a look at the source page, we found that it is xml based page that may be vulnerable to XML Entity Injection(XXE).</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Gl3BY1b0tnc/WnU-xMRBhdI/AAAAAAAAUCs/3iOSz2uA3qY5NUSjjd20PjZwXfz0ae2HACEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">We use burpsuite to capture request of that page and then send it to repeater, we then use XXE to exploit the system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-t1sPrhFSSTc/WnU-l2nRd5I/AAAAAAAAUCo/AWgl548WOagaNHIDOPPudYHwpCnoYrZwgCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">We find that only /etc/passwd is visible in plain text, to get the rest of the files we need to php base64 filter.  So we get apache.conf file to know about the system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-21IcRLZ-F4k/WnU-l8UBNqI/AAAAAAAAUCs/MFCwmf8ashoe63SYfXOWZ6Egpw7eRDkRACEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now we decode the base64 encoded string and save it in a file ‘bsides-apache.conf’.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ncSsxEahOlg/WnU-mxdtkDI/AAAAAAAAUCg/nJGFfvMfS8gjvN8GuDe7pJqVjNcKOZDcQCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Now when we check the configuration to find information about the system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-jJ0nWk6yx0U/WnU-nJe3iYI/AAAAAAAAUCo/zaFoOxwyZZkfSbOrQx-uenT33Yc0pYpZgCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Now we use XXE to get the rest of the configuration files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-agu_DGMfVao/WnU-nBxRUUI/AAAAAAAAUCg/lEel8X4Yo9kCGqq9W8tPCWkr2c6N0PqhACEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">We decode the base64 encoded string and then save it as bsides-default.conf.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-UEwFAmlofL4/WnU-nl3vxMI/AAAAAAAAUCs/3P244Oqa7CwQ9Vvulw616vrFpJFbWM2AACEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now we take a look at the configuration file, we get the location of the cgi configuration file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1PEAEytn9Cc/WnU-oN_bc1I/AAAAAAAAUCo/emNfNnLTZo8TEj4jg4i96aPqM-fWbjvVgCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Now we use XXE to get the configuration file for CGI files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nWbFmoyBbCU/WnU-oN8QcVI/AAAAAAAAUCs/pqH7lPIG3ls-jTKH1VV2BbYDX888DMVyQCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">We decode the base64 encoded string and save it as bsides-cgi.conf</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-H8XMgraeSFA/WnU-oquEgwI/AAAAAAAAUCs/peiOwEYnjPgWG9AAWxNEprdtC-_Rkb1OwCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Now we take a look at the cgi configuration file and find the location of load file that we dirb scan showed us.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-bf18DPbcFXw/WnU-o_W_fuI/AAAAAAAAUCg/hqD9YoEOU8wvJSZsE4p-eyScbQ_3mW5vACEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Now we download the load file using XXE to find more information about the file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pZbJZ77CXII/WnU-p5-iyqI/AAAAAAAAUCk/RhwkrXIwhaIZDuR7jbbqnz3IXqQj2iksACEwYBhgL/s1600/20.1.png"/></span></p>
<p><span style="color: #000000;">We decode the base64 encoded string and save it as bsides-load.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-DIYXuRs2Cqw/WnU-qdnasNI/AAAAAAAAUCk/fcsl_lNpsMMpJ4BtQf_KDqgH9fljTMndwCEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Now we check the file type and find it is an elf executable file.</span></p>
<pre class="lang:default decode:true">file bsides-load</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-M9wJ75aYeFs/WnU-qu9MePI/AAAAAAAAUCo/tqzlwigc_Fk7-X20D-ChrqkkII-4d_HNgCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">We use strings to check the content of the file and find that it is compressed using UPX.</span></p>
<pre class="lang:default decode:true">strings bsides-load</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-BNIGaHymwV0/WnU-qme5MSI/AAAAAAAAUCc/VmxAttdLcTwUH4FeiINZcvoJp3gSaiWhwCEwYBhgL/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Now we use UPX to decompress the file</span></p>
<pre class="lang:default decode:true">upx -d bsides-load</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-qnZOk6uj18U/WnU-rJ6-RyI/AAAAAAAAUCo/d-AqCGZbt9UtAJ9hBhU2NCRQ3R0ZR6xhwCEwYBhgL/s1600/23.png"/></span></p>
<p><span style="color: #000000;">After decompressing the file we check the strings and find that it read a file and decrypts the file using the hex value of “WannaCry?”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-P6aCTRz78m8/WnU-rdezrMI/AAAAAAAAUCg/afDTUuifXTEbPfaPYEUzL1-HJFPCMOtCQCEwYBhgL/s1600/24.png"/></span></p>
<p><span style="color: #000000;">Now we use radare to reverse engineer the file and find that it can run files that are encrypted with hex value of ‘WannaCry?’</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-mlVv9UJdwms/WnU-rYYqhpI/AAAAAAAAUCk/ltQ9yNkGUGgYtq61OX1pl_2YPThJzrh6wCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Now we create a hex value of ‘WannaCry?’. We use od to convert it into hex and sed to remove the space between values.</span></p>
<pre class="lang:default decode:true">echo -n "WannaCry?" | od -A n -t x1 |sed 's/ *//g’</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-_XJaaaU9-XI/WnU-r7wwuPI/AAAAAAAAUCk/ozE_I7r0nAUjHxjSvcWrInf_wKPhJW1XQCEwYBhgL/s1600/26.png"/></span></p>
<p><span style="color: #000000;">We create a reverse shell first to exploit the system. We create pipe files to execute our command.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-pRbhXv05YH0/WnU-sPzwStI/AAAAAAAAUCs/X1Iou_zo_nQI2SLZc0A7JIOQ7idPU3scACEwYBhgL/s1600/27.png"/></span></p>
<p><span style="color: #000000;">Now we create a 32-bit shared object file using gcc and convert it to a binary file using the hex value of ‘WannaCry?’ as key with openssl.</span></p>
<pre class="lang:default decode:true">gcc -m32 -shared -fPIC -o exploit.so exploit.c
openssl aes-128-cbc -K 'key’ -iv 0 -e -in exploit.so -out exploit.bin</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-QyAaQk3s_RI/WnU-sHeg-kI/AAAAAAAAUCc/-2F_fB9c8aMvWf-U6LBRJHmD1TIJtmmiwCEwYBhgL/s1600/28.png"/></span></p>
<p><span style="color: #000000;">Now we upload the file to the server, dirb scan gave us a link that can be used to bin files. After upload file we get the location of the file where it is uploaded. The name of our file also changes after we upload it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HknMynLRb3U/WnU-s3TInrI/AAAAAAAAUCk/vZODrwElxUAqJ1LNnxgX8KWQMPH4TxHPgCEwYBhgL/s1600/29.png"/></span></p>
<p><span style="color: #000000;">We copy the new file name and use the load file to run our shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-N0ZjEmpQvIo/WnU-tOOXxuI/AAAAAAAAUCg/BkZC1wWy6mE2jugc0laFGozBrAWioJWTwCEwYBhgL/s1600/30.png"/></span></p>
<p><span style="color: #000000;">We setup our listener using netcat, as soon as we execute the shell we get the reverse shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-kmVioMFcFbI/WnU-tpoKhRI/AAAAAAAAUCg/_-P3eNufCzEoHE9BpkgUzsAHzHPZpyPxACEwYBhgL/s1600/31.png"/></span></p>
<p><span style="color: #000000;">Now we find files with suid bit set and find a file in /home/level1/ called shisu</span></p>
<pre class="lang:default decode:true">find / -perm -4000 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-V9Bhmr1NSP0/WnU-tmTWRxI/AAAAAAAAUCo/BkC-fFqwXucyDUz7MpKH_ay3tvUFN3ufACEwYBhgL/s1600/32.png"/></span></p>
<p><span style="color: #000000;">We move to the directory and run the command and find that it is an executable file.</span></p>
<p><span style="color: #000000;"><strong>file shisu</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HGqhcZjdkpY/WnU-trC1kzI/AAAAAAAAUCs/BNooYivOjoEl81oNaIUu9Vv4hg2f_6zYwCEwYBhgL/s1600/33.png"/></span></p>
<p><span style="color: #000000;">When we run the file we find that it runs the command ps.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-3nE2cBk5eoA/WnU-uHfwe_I/AAAAAAAAUCc/k-Ps_fHzoc0TzpudpdE9Cu0nL2b2sP1JACEwYBhgL/s1600/34.png"/></span></p>
<p><span style="color: #000000;">We are unable to read debugging symbols in gdb so we use objdump to reverse engineer the file and found that the file has a string copy after which it removes the top 10 bytes in stack.</span></p>
<pre class="lang:default decode:true ">objdump -M intel -d shisu</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-E7r-JDNPeD8/WnU-ucSHsiI/AAAAAAAAUCk/BTYOtlvMeNk6CFGgWvQ0zAZl3wnE9cfMgCEwYBhgL/s1600/35.png"/></span></p>
<p><span style="color: #000000;">We now use gdb to add a breakpoint before it removes the memory from the stackpoint. We use python to print 500 ‘A’. Then we check the stack and find it is overwritten with A’s.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-nCHyUIoY3aM/WnU-uuabOQI/AAAAAAAAUCc/s29xlOLzxXoJywG7dg475zWy1PbR4R1RQCEwYBhgL/s1600/36.png"/></span></p>
<p><span style="color: #000000;">Now this file maybe vulnerable to buffer overflow.  After fuzzing a few times we find that at 516 bytes of data we can overwrite the EIP and we get a segmentation fault.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Cbeg0-STLHg/WnU-u32VcBI/AAAAAAAAUCs/1f_K8PRZyRoiJSxXUkcYPYSk9bVcPb-_ACEwYBhgL/s1600/37.png"/></span></p>
<p><span style="color: #000000;">So we now use this to exploit this vulnerability and get a privileged shell.</span></p>
<p><span style="color: #000000;">Now we run the file along with a 516 byte of shellcode and we get a privileged shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-CKDye0nAI_g/WnU-vN_mJII/AAAAAAAAUCg/rJksD0HVwrkU6dzZOCteofrNUdJ1ERbtACEwYBhgL/s1600/38.png"/></span></p>
<p><span style="color: #000000;">Now we use id command and find that we are root user now.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EWO6mQU3nts/WnU-voJitdI/AAAAAAAAUCk/z-jJVx4eZqsn9W3iuaVNjd0wJerxFYhtACEwYBhgL/s1600/39.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
