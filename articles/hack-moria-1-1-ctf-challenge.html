<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Moria: 1.1 (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-moria-1-1-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-08-13T09:23:52+00:00">August 13, 2017</time><time class="updated" datetime="2025-06-10T20:30:09+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we found a Vulnerable Lab based on the Lords of The Rings World. So get your Gandalf mode on, to solve this fun Vulnerable Lab <strong>Moria 1.1.</strong> We are going to download the VM Machine from <a href="https://www.vulnhub.com/entry/moria-11,187/">here</a>.</span></p>
<p><span style="color: #000000;">The credit for developing this VM machine goes to <a href="https://www.vulnhub.com/author/abatchy,393/">Abatchy</a>. It is a Boot2Root Lab.</span></p>
<p><span style="color: #000000;"><strong>Note:</strong> According to the author you don’t need LOTR knowledge to hack this VM but trust me, you need it.</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodologies</strong></span></h3>
<ul>
<li><span style="color: #000000;">Network Scanning (Nmap, netdiscover)</span></li>
<li><span style="color: #000000;">Surfing HTTP service port (80)</span></li>
<li><span style="color: #000000;">Enumeration for FTP password</span></li>
<li><span style="color: #000000;">FTP Login and further Enumeration</span></li>
<li><span style="color: #000000;">Decrypting MD5 passwords using John the ripper</span></li>
<li><span style="color: #000000;">SSH Login</span></li>
<li><span style="color: #000000;">Get Flag</span></li>
</ul>
<p><span style="color: #000000;"><strong>Let’s Breach!!!</strong></span></p>
<p><span style="color: #000000;">As always, Let’s start from getting the IP of VM (Here, we have it at <strong>192.168.1.125 </strong>but you will have to find your own).</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-l1zLdoyj6pg/WZAVbDCs2sI/AAAAAAAAQ3E/yXLmGm9A9z09SPk0-qJTN-7eRn5dKGTSwCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">After getting the IP Address of the Machine, we will do a port enumeration on the IP Address using the nmap tool.<br/>
</span></p>
<pre class="lang:default decode:true">nmap -sV 192.168.1.125</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-DEY9ml4350s/WZAVddUCWzI/AAAAAAAAQ3o/OCMRWcJjUHEZh7aWZqZgZEMNrLFl1iIxwCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">From the NMAP Version Scan we enumerated the following details:<br/>
</span></p>
<table>
<tbody>
<tr>
<td width="78"><strong>Port No.</strong></td>
<td width="78"><strong>Service</strong></td>
</tr>
<tr>
<td width="78">Port 21</td>
<td width="78">FTP</td>
</tr>
<tr>
<td width="78">Port 22</td>
<td width="78">SSH</td>
</tr>
<tr>
<td width="78">Port 80</td>
<td width="78">HTTP</td>
</tr>
</tbody>
</table>
<p>As the HTTP service is running on the target server, let’s open the IP Address on the Web Browser.</p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-GQ6F9qLgw9Q/WZAVdp4vuAI/AAAAAAAAQ3s/RRL9CouyECYOn8oQS5zl3ngMKcFDH2tVACEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">On Browsing, we found this image with the label “Gates of Moria”. We decided to do a bit of research on the text written in the given image. After searching through some wiki pages, we found its translation. It says “Say Friend and Enter” where Mellon means Friend. So Mellon must be one of the passwords.<br/>
</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Bjm7RYYXecs/WZAVdR414_I/AAAAAAAAQ3k/XUNpB6ra6ts8JscMhdOfFt2025FDc5iYACEwYBhgL/s1600/4.1.png"/></span></p>
<p><span style="color: #000000;">Keeping that in mind, let’s move forward. Here we decided to scan the target directory using <strong>dirb scan.</strong> Now open the terminal in Kali Linux and type the following command:</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.125/</pre>
<p><span style="color: #000000;">From the scanning result, we chose the highlighted directory for further enumeration.</span></p>
<pre class="lang:default decode:true">http://192.168.1.125/w/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-chFjOWgrgsM/WZAVeLlc_BI/AAAAAAAAQ3w/EgbUjegK388j4-R0HuqX9kHm3mUfS00lgCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">So, we opened this directory in the Browser and found another directory inside it. That is “<strong>h/”.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MHW-B4zjk1k/WZAVeRCO7kI/AAAAAAAAQ30/1SfwXaOjOrUslNRxHjKGZCJ5c8oU383bQCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">On opening it we got another directory and so on until it completes the path <strong>/w/h/i/s/p/e/r. </strong>Here we find the last directory named <strong>the_abyss/.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-w7XDqVO16Kc/WZAVehoqrSI/AAAAAAAAQ4I/8m8vpsREiRgJQg53WGiy1S__E-uW4NwsQCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">On opening <strong>the_abyss</strong>, we got some text as shown in the image. </span></p>
<p><span style="color: #000000;"><strong>Fundin</strong><strong>: ”That human will never save us!”</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-8fSNfdPzoNU/WZAVepjNd4I/AAAAAAAAQ4I/QDnsOKMXatMJEBLSPVdSXMUA0f32TskNwCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">We tried to look at the source code but found nothing. Afterward, we tried to refresh the page and found that the text gets changed into another text each time we refresh the page. </span><span style="color: #000000;">Hence it was a cluster of random texts that were saved at some location.<br/>
</span></p>
<p><span style="color: #000000;">So we decided to do a dirb scan but it gave no result, so we did an extension dirb scan as shown.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.125/w/h/i/s/p/e/r/the_abyss/ -X .txt .img .html</pre>
<p><span style="color: #000000;">This dirb scanner scans for a particular extension which is specified like .txt or .img etc.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-oeXfOK0ikbg/WZAVfLZZ34I/AAAAAAAAQ4I/uNG6fmljDBEJzAnXR8cxOaVlkoFfwXwGQCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Aha! Found a file named <strong>random.txt</strong>.</span></p>
<p><span style="color: #000000;">So, we opened it on a web-browser and found all the recurring text on the same page as shown in the image.<br/>
</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-4A4blqaghoE/WZAVfWbFO-I/AAAAAAAAQ4I/cAJYaXuKl_I8RBdLsoEpCSQGD03Y-8m7gCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">This text contains a lot of names like <strong>Balin, Oin, Ori, Fundin, Nain, Eru, Balrog, </strong>we noted them because they might be Login Credentials.</span></p>
<p><span style="color: #000000;">Now we tried to connect with FTP port.</span></p>
<pre class="lang:default decode:true">ftp 192.168.1.125</pre>
<p><span style="color: #000000;"><strong> </strong></span><span style="color: #000000;">It greeted with <strong>Welcome Balrog</strong></span></p>
<p><span style="color: #000000;">And we knew that it must be the username because it was in the random.txt too but for the password, we tried multiple names which we found earlier and then we remembered the text form the image, “Say friend and enter”. On entering Friend the login failed then we tried <strong>Mellon</strong> and it got us logged in successfully.</span></p>
<p><span style="color: #000000;">Therefore for FTP Login give following credential:</span></p>
<pre class="lang:default decode:true">Username: Balrog
Password: Mellon</pre>
<p><span style="color: #000000;"><strong>NOTE:</strong> – If you get an error, restart VM and also try multiple times with the above username and password.</span></p>
<p><span style="color: #000000;">After login, we used <strong>pwd</strong> command and found the path to be <strong>/prison</strong>. We looked around, in hope of getting a flag but it was worthless. Then we found a folder named <strong>var</strong>. We traversed in it using<strong> cd</strong>.<br/>
</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-FjGifvVwbEI/WZAVaxijHoI/AAAAAAAAQ4I/IPqmIHUE1kAPCAj5DjsYsW3W9mHKgIERwCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Then we got to <strong>/var/www/html.</strong> Here we found this folder <strong>QlVraKW4fbIkXau9zkAPNGzviT3UKntl.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-5Jepy_nHtok/WZAVbEFi3lI/AAAAAAAAQ4I/KiZMWPi8pggYX8DetjrOA164ck_F2lL7ACEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">On opening it in the browser we found a table having two columns for <strong>Prisoner’s name</strong> and <strong>Passkey</strong> as shown in the given image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-lgqWwiS_w4A/WZAVbhyk8qI/AAAAAAAAQ4I/F0SIH8Eesvcw_cnQ9qqGG8EN3ljoGl5BACEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">As always, we searched the source code for some hint. From the <strong>View Source</strong> page, we found the “salt” which can be used to decrypt the MD5 Password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-aY5uANUvrxM/WZAVb2M1u0I/AAAAAAAAQ4I/gGaHwfuvUwkITLd2Jw9qy5sseao71zxlACEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">After trying different kinds of formats to decrypt above MD5 password, we created a file with name and passkey and salt in this format.</span></p>
<p><span style="color: #000000;"><strong>Prisoner’s Name:Passkey$Salt</strong></span></p>
<p><span style="color: #000000;">Name it whatever you want (Here we named it passwords and saved it on my Kali’s Desktop).</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Abw-MMN23MM/WZAVb1RpjFI/AAAAAAAAQ4I/uzqSLRuFSGkXIDthUvbL8MVQAEONgW4gwCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now we will run <strong>John The Ripper</strong> on this file to decrypt it.<br/>
</span></p>
<pre class="lang:default decode:true">john –form=dynamic_6 /root/Desktop/lol</pre>
<p><span style="color: #000000;">John The Ripper gave us the Login Credentials as shown in the given image.<br/>
</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-r2tKCz8GMyU/WZAVcv48e2I/AAAAAAAAQ4I/EqC-PV8RHC0IVKe0xePhRQ5NpFGQpYFpACEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">After trying all user credentials decrypted to login in <strong>ssh</strong>, we got success with:</span></p>
<p><span style="color: #000000;"><strong>SSH Login</strong></span></p>
<pre class="lang:default decode:true">Username:Ori
Password:spanky</pre>
<p><span style="color: #000000;">Now login into ssh using the above credentials.<br/>
</span></p>
<pre class="lang:default decode:true">ssh Ori@192.168.1.125</pre>
<p><span style="color: #000000;">Here we got the bash shell. Now we tried multiple commands in search of a flag. On running <strong>ls-al</strong>, we found a text file named <strong>poem</strong>, which contains a poem. But we didn’t find any flag inside it.</span></p>
<p><span style="color: #000000;">Then we looked into the <strong>.ssh/ directory</strong> and found the <strong>know_hosts</strong> file and <strong>id_rsa</strong> file which contains the private key. Let’s read the data inside these files using <strong>cat</strong> command.<br/>
</span></p>
<pre class="lang:default decode:true">cat id_rsa</pre>
<p><span style="color: #000000;">Copy the entire text found inside id_rsa in a text file and save as id_rsa.</span></p>
<p><span style="color: #000000;">Now, we opened another file <strong>known_host</strong>, here you will found the host “<strong>127.0.0.1</strong>”. Let’s use this information for ssh login as a root user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-X_3JKVRMf2Q/WZAVctnHNmI/AAAAAAAAQ4I/_zR2BnL4dOkD-emAb2018gEI8cLFipPkQCEwYBhgL/s1600/17.png"/></span></p>
<pre class="lang:default decode:true">ssh -i id_rsa root@127.0.0.1</pre>
<p><span style="color: #000000;">This got us to the <strong>ROOT. </strong></span></p>
<p><span style="color: #000000;">But to finish the Lab properly we need the flag.  So we tried <strong>ls -la</strong> to search for the flag. We found a <strong>flag.txt.</strong> Inside the flag.txt, we got the Final Message “<strong>All that is gold does not glitter</strong>”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-6q1G2_Bd2IM/WZAVcm1jX_I/AAAAAAAAQ4I/pR-a8ogmb_MdtrcrRqr5kicy6Ly3Yt49gCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;"><strong>Author:</strong> Pavandeep Singh is An <strong>Ethical Hacker</strong>, <strong>Cyber Security Expert, Penetration Tester,</strong> India. Contact <a href="https://www.linkedin.com/in/pavandeep-singh-6b1074132"><strong>here.</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
