<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/credential-dumping/" rel="category tag">Credential Dumping</a>, <a href="https://www.hackingarticles.in/category/red-teaming/domain-credential/" rel="category tag">Domain Credential</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Credential Dumping with NetExec (nxc)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/credential-dumping-with-netexec-nxc/" rel="bookmark"><time class="entry-date published" datetime="2025-08-11T04:50:30+00:00">August 11, 2025</time><time class="updated" datetime="2025-08-11T05:13:40+00:00">August 11, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In modern enterprise environments, <strong>Active Directory credentials</strong> are the ultimate prize for attackers. Whether you’re a <strong>red teamer</strong>, <strong>penetration tester</strong>, or <strong>adversary simulation professional</strong>, gaining access to credentials is essential for <strong>privilege escalation</strong>, <strong>lateral movement</strong>, and <strong>persistence</strong>. But how do attackers actually collect these credentials in real-world scenarios? </span><span style="color: #000000;">Enter <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/active-directory-pentesting-using-netexec-tool-a-complete-guide/">NetExec</a> </span>(nxc)</strong> a powerful, modern post-exploitation framework and the advanced successor to CrackMapExec. NetExec is built to automate and streamline <strong>credential dumping</strong>, making it one of the most effective tools for red teams and security professionals working in <strong>Windows and Active Directory environments</strong>.</span></p>
<h5><span style="color: #000000;">What Is NetExec (nxc)?</span></h5>
<p><span style="color: #000000;">NetExec is a <strong>post-exploitation Swiss Army knife</strong> designed for internal network operations. With extensive support for <strong>SMB</strong>, <strong>WinRM</strong>, and other protocols, it allows attackers to gather credentials from multiple sources including:</span></p>
<ul>
<li><span style="color: #000000;">LSASS memory (plaintext and NTLM hashes</span></li>
<li><span style="color: #000000;">Windows registry and Winlogon keys</span></li>
<li><span style="color: #000000;">Browsers, Wi-Fi profiles, and SSH clients</span></li>
<li><span style="color: #000000;">LAPS-managed passwords and NTDS.dit database</span></li>
<li><span style="color: #000000;">gMSA (Group Managed Service Accounts) secrets</span></li>
<li><span style="color: #000000;">Third-party tools like <strong>PuTTY</strong>, <strong>mRemoteNG</strong>, and <strong>Notepad++</strong></span></li>
</ul>
<p><span style="color: #000000;">In this hands-on guide, we walk through a <strong>step-by-step red team simulation</strong> using <strong>NetExec over SMB</strong> to demonstrate how attackers collect credentials from a misconfigured Active Directory environment. Each step represents a real-world tactic commonly seen in offensive security operations.</span></p>
<h5><span style="color: #000000;">Why This Matters for Red and Blue Teams?</span></h5>
<p><span style="color: #000000;">For <strong>red teamers</strong>, this guide shows how NetExec can be weaponized to identify and exploit weak configurations within minutes; simulating realistic post-exploitation behavior that adversaries use daily.</span></p>
<p><span style="color: #000000;">For <strong>blue team defenders</strong> and <strong>SOC analysts</strong>, it highlights <strong>critical detection opportunities</strong> and misconfiguration pitfalls that often go unnoticed, including:</span></p>
<ul>
<li><span style="color: #000000;">Stored credentials in plain text</span></li>
<li><span style="color: #000000;">Misused service accounts</span></li>
<li><span style="color: #000000;">Poor Wi-Fi and registry hygiene</span></li>
<li><span style="color: #000000;">Over-permissive user group memberships (e.g., Backup Operators)</span></li>
</ul>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Dump Local SAM Hashes</strong></span></li>
<li><span style="color: #000000;"><strong>Test Hash as Login Credential</strong></span></li>
<li><span style="color: #000000;"><strong>Extract LSA Secrets</strong></span></li>
<li><span style="color: #000000;"><strong>Retrieve Winlogon Registration Data</strong></span></li>
<li><span style="color: #000000;"><strong>Dump DAPI Password Credentials</strong></span></li>
<li><span style="color: #000000;"><strong>Extract Credentials from LSASS via LSASSASSY</strong></span></li>
<li><span style="color: #000000;"><strong>Dumping LSASS Memory with </strong><strong>nanodump</strong><strong> Module</strong></span></li>
<li><span style="color: #000000;"><strong>Extracting Stored Credentials from mRemoteNG Configuration</strong></span></li>
<li><span style="color: #000000;"><strong>Retrieve PuTTY Private Key Files</strong></span></li>
<li><span style="color: #000000;"><strong>Extract Notepad++ Session Logs</strong></span></li>
<li><span style="color: #000000;"><strong>Retrieve PowerShell Command History</strong></span></li>
<li><span style="color: #000000;"><strong>Extract WinSCP Configuration Files</strong></span></li>
<li><span style="color: #000000;"><strong>Dumping VNC Passwords</strong></span></li>
<li><span style="color: #000000;"><strong>Extract Wi-Fi Profiles/PSKs as Administrator</strong></span></li>
<li><span style="color: #000000;"><strong>Dumping Backup Operators Permission</strong></span></li>
<li><span style="color: #000000;"><strong>Dumping NTDS.dit Using an Authenticated User</strong></span></li>
<li><span style="color: #000000;"><strong>Extract gMSA Credentials</strong></span></li>
<li><span style="color: #000000;"><strong>Retrieve LAPS Password via NetExec (nxc) </strong></span></li>
<li><span style="color: #000000;"><strong>Mitigation</strong></span></li>
</ul>
<p><span style="color: #000000;">Ready to unlock the next level of password dumping? Let’s dive into NXC SMB post-access enumeration, leveraging <strong>NetExec</strong> to dump credentials in multiple ways.</span></p>
<h3><span style="color: #800000;">Dump Local SAM Hashes</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.80 -u ieuser -p 123 –sam</pre>
<p><span style="color: #000000;">This command instructs <strong>nxc</strong> to authenticate to the target system over SMB and extract NTLM password hashes from the local <strong>SAM</strong> database, which stores credentials for local user accounts.</span></p>
<p><span style="color: #000000;"><strong><em> <img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgcQ0zfLj4b9cIPk8AC8sJadYlBx6NQ8RY2LrolJsC3SZ4hyphenhyphenQvPuFpr2xkybZR7L4OGeGuv5SnU_m4WqmVlRkbxp25qF-SqnVzQrqQGs71uCQ7IkdRzBNUJUXRxD6DPJRhK2QHDMUyHoyOg1U4bAirH5O80C8HEXPtipRJFF828HBJx7aKmqZx153ngSVpz/s16000/1.png" border="0" data-original-height="249" data-original-width="1031"/></em></strong></span></p>
<p><span style="color: #000000;"><strong><em>Why This Matters:</em></strong></span></p>
<p><span style="color: #000000;">Accessing SAM hashes enables attackers to crack passwords offline. Perform <strong>Pass-the-Hash</strong> attacks across systems with shared local accounts, and maintain persistence by manipulating or recreating local users.</span></p>
<h3><span style="color: #800000;">Test Hash as Login Credential</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">impacket-psexec ieuser@192.168.180 -hashes:3dbde697d71690a769204beb12283678</pre>
<p><span style="color: #000000;">The command remotely executes actions using the captured NTLM hash, validating the stolen credentials and enabling lateral movement and privilege escalation across the network.</span></p>
<p><span style="color: #000000;"><em> <img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEheJb9AnGIWg3-1nIs7QQtaZST14nMLYTtyIaf6rmtiCQ0CD9dmdEBVGXwvvp_kE2cGPooj1tNv49gten_oFI4LzBycZc5w1AiRCvn3F5ZIW5ry-RyJrZlyqscYDj9U20WHn9PmRWS0K5VuGicGl0PHRbdyUnC-9pDSib8tzgWfiBikHUTjbcSCc1WMW2Z6/s16000/2.png" border="0" data-original-height="302" data-original-width="789"/></em></span></p>
<h3><span style="color: #800000;">Extract LSA Secrets</span></h3>
<p><span style="color: #000000;">LSA secrets are highly valuable in post-exploitation, as they store credentials, service account secrets, and decryption keys for other sensitive data. In enterprise networks, these secrets play a crucial role in enabling lateral movement between machines and services.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.80 -u ieuser -p 123 --lsa</pre>
<p><span style="color: #000000;">Then, this command retrieves LSA secrets, such as credentials and service keys, which contain long-lasting credentials and encrypted service passwords for persistent access.</span></p>
<p><span style="color: #000000;"><em> <img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjc2JOzC5-rBw2oKDjTeZLjGsB64saGBsHDrXTnuB0WRj5IuIQyijmfgcHH1eRP1i1btGoWy6qL0-a82Jt35UFa0q-5p9YR06xmeQQrkYU-VfT35VPGhCT5xpIZOWey_TJY8VvQtwUtq8V5SeM9RZPm9FT1srv00dZ_LkP6mDSOdYtuDOJZbQzb8rB1CXen/s16000/3.png" border="0" data-original-height="195" data-original-width="865"/></em></span></p>
<h3><span style="color: #800000;">Retrieve Winlogon Registration Data</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.80 -u ieuser -p 123 -M reg-winlogon</pre>
<p><span style="color: #000000;">This command leverages NetExec’s <strong>reg-winlogon</strong> module to query the registry keys in <strong>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon</strong>, which control automatic logins in Windows. Key values like <strong>AutoAdminLogon</strong>, <strong>DefaultUsername</strong>, and <strong>DefaultPassword</strong> can store credentials in plaintext, making them a valuable target for credential harvesting, especially in misconfigured environments where automatic login is enabled.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgoEwn6Z4l1WojriqzxMEPFKvIPNzSgjfrmhYg8e2JsjfT88u3SfedxSmlERSGPZ2kAuCBKtl0lsv0CyoIXnqUp5iXqSxezOBTcYJ01_2EbeTscqDWVEswZ3gdSkLQx2aQ461RDP0ELHUNjhSyiBqMmbkg6WDsrCCwGd9y7U8ZuwjuoDGzDaVUN830lniXW/s16000/4.png" border="0" data-original-height="175" data-original-width="826"/></strong></span></p>
<h3><span style="color: #800000;">Dump DPAPI Password Credentials</span></h3>
<p><span style="color: #000000;"><strong>DPAPI</strong> (Data Protection API) is a Windows feature that securely stores user secrets like web credentials, browser passwords, Outlook, RDP, WiFi, and cached domain credentials, encrypting them with user-specific keys stored locally.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.80 -u ieuser -p 123 --dapi</pre>
<p><span style="color: #000000;">Then, this command retrieves passwords stored by legacy <strong>DAPI</strong> services, which can serve as a vector for <strong>privilege escalation</strong> on older Windows systems vulnerable to outdated credential management.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhBkEDL3gXDwv6vGe7XDEgbwBC2_ov2-XGbnof31Q6QgQqsx6Ua4v-o2pCx5nrxG01-bQNgvefmuW29Wu8c6b5cjXpnBx_uO3leT6BSbtzV9ZIDxp9TswoLKlrO9wIWatDkpeWYiLYsdbu3y3kvoB7FZNStAHrfLT_6qcA7dFGnyjtLFpadCuT872WwyK-o/s16000/5.png" border="0" data-original-height="191" data-original-width="1225"/></span></p>
<p><strong><span style="color: #000000;">This reveals:</span></strong></p>
<ul>
<li><span style="color: #000000;">Windows Credential Manager dump (raj:Password@1)</span></li>
<li><span style="color: #000000;">Facebook login recovered from Microsoft Edge</span></li>
<li><span style="color: #000000;">LinkedIn password recovered from Firefox</span></li>
</ul>
<p><span style="color: #000000;"><em><strong>Note</strong>: This is a <strong>post-exploitation goldmine</strong>; allowing lateral movement, credential chaining, and account hijacking across services.</em></span></p>
<h3><span style="color: #800000;">Extract Credentials from LSASS via LSASSASSY</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.80 -u ieuser -p 123 -M lsassy</pre>
<p><span style="color: #000000;">This command uses NetExec’s <strong>lsassy</strong> module to extract credentials directly from <strong>LSASS (Local Security Authority Subsystem Service)</strong>, a critical Windows process managing logins and sensitive data like password hashes and Kerberos tickets. It automates credential dumping using methods such as <strong>Procdump via SMB</strong>, <strong>Comsvcs.dll injection</strong>, and <strong>MiniDumpWriteDump APIs</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg9AJS1j2D7cNYytSQ0nd_FWpN10WqXWdqftOgFobVsP9o66l0geHhuBe2KRqaxi-4HOhjcXPg8DX9SiV6iTvhYfW2hTjWi_3hG09HC4sMdVumTWb6LTaRkAVFpxanQeokIUc80QvujDIFN-c4lNg3nc-q7BvAYc9jt618Xzg0d7b_86MTfjrX4IgeKT4II/s16000/6.png" border="0" data-original-height="135" data-original-width="955"/></span></p>
<p><strong><span style="color: #000000;"><em>Why It Matters:</em></span></strong></p>
<p><span style="color: #000000;">LSASS stores sensitive data in memory, including <strong>NTLM hashes</strong>, <strong>clear-text passwords</strong> (if <strong>WDigest</strong> is enabled), <strong>Kerberos tickets</strong>, and <strong>cached credentials</strong>. Dumping this information grants attackers valuable post-exploitation access, particularly if domain admins or other privileged users are logged in.</span></p>
<h3><span style="color: #800000;">Dumping LSASS Memory with nanodump Module</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.80 -u ieuser -p 123 -M nanodump</pre>
<p><span style="color: #000000;">This command uses NetExec’s <strong>nanodump</strong> module to remotely dump LSASS contents using the <strong>NanoDump</strong> tool, a modern, stealthy LSASS dumper designed to bypass security measures like <strong>Windows Defender</strong>, <strong>Anti-malware Scan Interface (AMSI)</strong>, and <strong>LSASS access restrictions</strong>. It employs SMB to deliver and execute NanoDump, capture LSASS memory, and store the dump file locally.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhI55f7Ty_tzrRZQLYxwWoF89fHAXHyZ3xQxcXlTWk_n1SQ2rVr0NKvEj7Wx4efGZiyCSYdQSVdOP5bEOpJxFhUTjiEoCP01n8cNU1FPt-PeYJfymDkc6Zx7oXTcoFtLRlB_mBJVpkpXwfjZUpjv-gIhAZRRXuikcD0tuU_oOu_RRu1BIY2mIvA5ee4G87Q/s16000/7.png" border="0" data-original-height="362" data-original-width="1009"/></span></p>
<p><strong><span style="color: #000000;"><em>Why It’s Effective:</em></span></strong></p>
<p><span style="color: #000000;">NanoDump is highly effective in <strong>credential harvesting</strong> because it bypasses detection from <strong>AV/EDR systems</strong>, avoids access restrictions, and produces a clean <strong>.dmp</strong> file for offline analysis, making it a more stealthy and reliable method compared to older tools.</span></p>
<h3><span style="color: #800000;">Extracting Stored Credentials from mRemoteNG Configuration</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.80 -u ieuser -p 123 -M mremoteng</pre>
<p><span style="color: #000000;">This command targets the <strong>mRemoteNG</strong> application, a remote connection manager commonly used by sysadmins. The <strong>NetExec mremoteng</strong> module searches for configuration files like <strong>confCons.xml</strong>, decrypts stored credentials using known static keys, and displays them in cleartext for further use.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjt0IM3lSWs62voDCyDCXWLSHEu7i2w9p17aNNiErwDBgQBDeTo7Hrc8QrAHG7C8sta_vSFtrGS5Tb2_QWAUM6EPl4zv7yHaorOtqH9iKUeD8CHdwHmmnDZL-6GcmV_Ujda36ZMIY4uKs-06Jb4UJOE834959Ua-JSQ0LiFgjycfBU7vyPb99gHzawn4sPT/s16000/9.png" border="0" data-original-height="137" data-original-width="1097"/></span></p>
<p><strong><span style="color: #000000;"><em>Why It’s Effective:</em></span></strong></p>
<p><span style="color: #000000;">Admins often store high-privilege credentials or reuse passwords in remote session managers for convenience. If <strong>mRemoteNG</strong> is found, the dumped credentials could include <strong>Domain Admins</strong>, <strong>service accounts</strong>, or other privileged users, enabling immediate lateral movement via <strong>WinRM</strong>, <strong>RDP</strong>, or <strong>SSH</strong>.</span></p>
<h3><span style="color: #800000;">Retrieve PuTTY Private Key Files</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.80 -u ieuser -p 123 -M putty</pre>
<p><span style="color: #000000;">This command uses NetExec’s <strong>putty</strong> module to locate and extract <strong>SSH private keys</strong> stored by <strong>PuTTY</strong>, a popular SSH client for Windows. It searches both the Windows registry (<strong>HKCU\Software\SimonTatham\PuTTY\Sessions</strong>) and disk files (commonly in <strong>.ppk</strong> format), retrieving saved hostnames, usernames, and private keys (either encrypted or plain).</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh5iY4ZxKJBhf-119lKrP0zL4xhkfl5InL1GXKmWPDJ4ArOsEN1N60K2ltAZxf09LpFsqU55qzT6XID-PRJdxndjkMr7Ec4PkCuNPe_3ig0_2iHp19xWlzs2ePpRrETBxjDPF9o0hyaJ9d0_XYOah1VCrgtoEkK9QO5qyrj8bBAuvWjJuW73RDBS-iAUipg/s16000/10.png" border="0" data-original-height="205" data-original-width="970"/></span></p>
<p><span style="color: #000000;"><strong><em>Why It’s Effective:</em></strong></span></p>
<p><span style="color: #000000;">Admins often use <strong>PuTTY</strong> to manage <strong>Linux servers</strong> or network devices, and private keys may be stored with weak or no passphrases. If SSH keys are reused across different environments, this allows attackers to gain <strong>SSH-level access</strong> without needing a password.</span></p>
<h4><span style="color: #800000;">View the Dumped Key Locally</span></h4>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat 'putty_IEUser_UbuntuKey_2025-05-22_175949.sec'</pre>
<p><span style="color: #000000;">Displays the extracted private key or passphrase information. Test the extracted SSH keys on accessible targets using ssh -i for Linux or tools like <strong>Plink</strong> or <strong>WinSCP</strong> for Windows.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhBkEstqOtq1aJT8WFlw5UslY_ZU4IBFvXtSoGEhgL3LZF8CL4x5KiIGhwPdIv17khCtW65TbGs2F230z3RIes1ra3rSecTj18A2_wmnX4G5r47tXwgIPOvXrkNFwXp6AkgCbwlQrwcb4DSE9Fl3RW-UZAVidKGcdiTdD8Ff5M6ol31D1j4RB8anvjW4dHH/s16000/11.png" border="0" data-original-height="553" data-original-width="717"/></span></p>
<h3><span style="color: #800000;">Extract Notepad++ Session Logs</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.80 -u ieuser -p 123 -M notepad++</pre>
<p><span style="color: #000000;">This command uses <strong>NetExec’s notepad++ module</strong> to locate session data, configuration files, or backups saved by <strong>Notepad++</strong>, a popular text editor. While Notepad++ isn’t designed for credential storage, its autosave feature may inadvertently retain <strong>passwords in scripts</strong>, <strong>open files with sensitive data</strong>, or even <strong>clipboard history</strong>.</span></p>
<p><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgwDWI2gD6WPMlowKhgXDBKAnMbpaOuDuPIbF7RsOgV70dAj3K16lxJUUS6DtFZgsXgrLsCq15ICvP5ASidymnGe2mexwoYa7MEq5QKwoUiN2LNYRze3J0ImHh0FDRkadnuF5xOOAz28b-Ks0eD4euG_9Y32rPYvzHfFw1sXK4fPfio1NgQ0kFHkHhrx3GX/s16000/12.png" alt="credential dumping with NetExec" width="904" height="235" border="0" data-original-height="235" data-original-width="904"/></span></p>
<p><strong><span style="color: #000000;"><em>Why This Matters:</em></span></strong></p>
<p><span style="color: #000000;">Developers, sysadmins, or red teamers may temporarily store secrets in Notepad++ while working. Session recovery or backup files can persist even after the editor is closed and can be accessed via <strong>SMB</strong> if you have proper credentials and share access.</span></p>
<p><span style="color: #000000;"><em><strong>Note</strong>: This step enhances reconnaissance in the credential harvesting process, and while not always successful, it can uncover valuable assets such as access tokens, database connection strings, and SSH or admin credentials embedded in plaintext scripts.</em></span></p>
<h3><span style="color: #800000;">Retrieve PowerShell Command History</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.80 -u ieuser -p 123 -M powershell_history</pre>
<p><span style="color: #000000;">This command uses the <strong>powershell_history module</strong> in <strong>NetExec</strong> to retrieve and analyze PowerShell command logs from a target user’s system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgKYUKQ19p0cFMApk1s1k78pcmPiV7DepjVBldkX2D_v0e8SzV3mxpGrkYSgDR_4svhnm9ILQ9PV5eeJ9qcBGmjNn2mZ-XMGcAMlJo7L4bR1e5v2oVQEp4D6mI6aD8FsFIsNrpaEu3lBauBBWAnDv8mxSJXghkNPVCYY3FSv1pqnUVAH_UkWSwzYWqUmbUR/s16000/13.png" border="0" data-original-height="474" data-original-width="1147"/></span></p>
<p><span style="color: #000000;">By default, PowerShell stores command history in:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">C:\Users\IEUser(user)\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt</pre>
<p><span style="color: #000000;"><strong><em>Why This Is Valuable</em></strong></span></p>
<p><span style="color: #000000;">Attackers, admins, or developers frequently run credential-related commands in PowerShell, such as net use commands with hardcoded passwords, AD enumeration tools with -Credential arguments, or commands like Set-ADAccountPassword and New-ADUser. If not cleared, these commands are logged and can be retrieved to gain access to sensitive information.</span></p>
<p><span style="color: #000000;"><em><strong>Note</strong>: PowerShell history can expose plaintext credentials or system details, enhancing post-exploitation by enabling lateral movement or privilege escalation based on user activity.</em></span></p>
<h3><span style="color: #800000;">Extract WinSCP Configuration Files</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.80 -u ieuser -p 123 -M winscp</pre>
<p><span style="color: #000000;">This command uses <strong>NetExec’s winscp module</strong> to extract saved <strong>WinSCP site profiles</strong>, which may include <strong>remote hostnames, usernames, passwords</strong> (in plaintext or Base64), and <strong>SSH keys</strong>, stored either in the <strong>WinSCP.ini</strong> file or the <strong>Windows Registry</strong>, potentially allowing attackers to access <strong>FTP/SFTP/SSH</strong> targets, extract data, or deploy payloads.</span></p>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEisgAO3aEPpMZj30yVItYuhX2iCGtgwHpb6EIrOylxa_c-NRHwovIdk9qtt3teHX3xyknOuSWWqC8LtnlL67a6qzIz8p1gTNg59z1wzRyJ1owp_-O0_kKHOysEOF9GQTcA-F7hvq0V9O53gvGR_DUHG0jgjbqP2TJEG1Y33lymNo-Rr8uiCguurn_ruE9Ck/s16000/14.png" alt="credential dumping with NetExec" width="789" height="231" border="0" data-original-height="231" data-original-width="789"/></span></p>
<h3><span style="color: #800000;">Dumping VNC Passwords</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.80 -u ieuser -p 123 -M vnc</pre>
<p><span style="color: #000000;">This command uses <strong>NetExec’s vnc module</strong> to search for stored <strong>VNC credentials</strong> on the target machine, scanning common registry keys or configuration files where VNC clients (like <strong>UltraVNC</strong>, <strong>RealVNC</strong>, and <strong>TightVNC</strong>) often store access passwords, which may be poorly encrypted or even in plaintext. It looks in locations like:</span></p>
<ul>
<li><span style="color: #000000;"><strong>HKEY_LOCAL_MACHINE\SOFTWARE\ORL\WinVNC3\Password</strong></span></li>
<li><span style="color: #000000;"><strong>HKEY_LOCAL_MACHINE\SOFTWARE\RealVNC\vncserver</strong></span></li>
</ul>
<p><span style="color: #000000;">NetExec attempts to decode any found credentials.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjfuFb0eQhVezDXOPQos062dCOS9w599TAlAYoQp8b4PsxqocjRSpna0gPASrkFwGSVyuoqaUaQt7jcGI_Q6k2ZGcaalMDPoOsi4V0OmmHgIb63DpnAH7xrhIF3aG5nTeiIfB-voh2n-LjHFEz-DAelLNgFr4zK6eZNIGudNoUa6-tSmoNuzLrf6wWUWy5V/s16000/15.png" border="0" data-original-height="115" data-original-width="808"/></span></p>
<p><strong><span style="color: #000000;"><em>Why This Is Important:</em></span></strong></p>
<p><span style="color: #000000;"><strong>VNC</strong> provides remote desktop access, and if passwords are extracted from the registry or config files, attackers can access systems without needing valid user credentials. These passwords are often reused across multiple systems, enabling <strong>lateral movement</strong> and maintaining <strong>persistence</strong> on the network.</span></p>
<p><span style="color: #000000;"><em><strong>Note</strong>: Harvesting VNC credentials lets attackers bypass Windows authentication, often found in exposed legacy systems or unmanaged remote support setups.</em></span></p>
<h3><span style="color: #800000;">Extracting Wi-Fi Credentials</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.46 -u administrator -p 123 -M wifi</pre>
<p><span style="color: #000000;">This command uses NetExec’s <strong data-start="100" data-end="108">wifi</strong> module in order to extract stored Wi-Fi credentials (SSIDs and PSKs) from a target Windows machine by querying <strong>PowerShell</strong> or reading registry paths. Thereby allowing attackers to access internal networks, pivot to insecure Wi-Fi zones, and reuse credentials for other access.</span></p>
<p><span style="color: #000000;"><em> <img decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiyTClSBr5h5f6TZRWMg4tPh9Q_g1GauTZGnGWR_lJT0aIgwKqPNsmR4_MB8_Fg92A_jlqPkZTbOOX5ad6fygg9aIV5ueo_p_uWWPy1QDF0mLOThctwfNxoQ-2m0tKqi3rPwgvn55q31mMAZhkrdxDouKT9_8NQvQcSVeN2Sn5gfEyp6lplYjzKR1GMc7I9/s16000/16.png" alt="credential dumping with NetExec" width="987" height="309" border="0" data-original-height="309" data-original-width="987"/></em></span></p>
<h3><span style="color: #800000;">Dumping Backup Operators Permission</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.53 -u raj -p Password@1 -M backup_operator</pre>
<p><span style="color: #000000;">This command uses <strong>NetExec’s -M backup_operator module</strong> to check if a user (e.g., <strong>raj</strong>) is a member of the <strong>Backup Operators</strong> group. Similarly checks whether they can read sensitive files, such as <strong>SAM</strong>, <strong>SYSTEM</strong>, <strong>SECURITY</strong>, and <strong>NTDS.dit</strong>, which are typically restricted to administrators.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgK79XdxEdnnjWPocur1JLkENhkGTzwLzG-5XI4K4Z9o8z2T-Ez-yx_DufKOtSxLWnxUfuLWX5lyIGkHvJZl_kJ4hAKmdQpxaInadYd_34IeRjO7AJd7AjaixKVUlZQT-9goFMVE5-bFucg3QaU4Gnfg-hkkRk9xOv0BY7zGCebz96HEfqMVd4efmHuHi-5/s16000/19.png" border="0" data-original-height="611" data-original-width="1082"/></span></p>
<p><strong><span style="color: #000000;"><em>Why This Matters:</em></span></strong></p>
<p><span style="color: #000000;"><strong>Backup Operators</strong> have the ability to bypass file system permissions for backup and restore operations. Even without admin rights, a user in this group can:</span></p>
<ul>
<li><span style="color: #000000;">Extract the <strong>dit</strong> database</span></li>
<li><span style="color: #000000;">Access <strong>SAM</strong> and <strong>SYSTEM</strong> hives</span></li>
<li><span style="color: #000000;">Bypass certain system protections</span></li>
</ul>
<p><span style="color: #000000;">This makes a low-privilege user in the <strong>Backup Operators</strong> group a significant <strong>domain takeover</strong> vector.</span></p>
<p><span style="color: #000000;"><em><strong>Note</strong>: Backup Operators are a high-risk group in misconfigured AD setups and should be treated as privileged, with regular membership audits.</em></span></p>
<h3><span style="color: #800000;">Dumping NTDS.dit Using an Authenticated User</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.53 -u yashika -p Password@1 --ntds</pre>
<p><span style="color: #000000;">This command uses <strong>NetExec</strong> to dump the <strong>NTDS.dit</strong> file. This file contains critical Active Directory data such as <strong>usernames</strong>, <strong>NTLM password hashes</strong>, <strong>group memberships</strong>, and <strong>domain trust details</strong>. NetExec automates the process by using <strong>Volume Shadow Copy</strong> and exporting the <strong>SYSTEM hive</strong> to decrypt the hashes.</span></p>
<p><span style="color: #000000;"><em> <img loading="lazy" decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi6vqjJFSSxfE4PABMBRRuM9G6vHphWmRmMbkA_Oxdu_1Do7eOJN0w1JlpxZOcpQbjfHGETvNvJm9OZV926nTqRtUK6Y_07XqOO46nM6MQaOpitRDDH6ZXvPCQqK0s1PruIi1-PfrwWQCdA9A4BGgQcHsyHyDOmODRE2jV6QPOiMdoPqpPYSh9fGfyYKhJN/s16000/20.png" alt="credential dumping with NetExec" width="1165" height="352" border="0" data-original-height="352" data-original-width="1165"/></em></span></p>
<p><strong><span style="color: #000000;"><em>Why This Matters:</em></span></strong></p>
<p><span style="color: #000000;"><strong>NTDS.dit</strong> is essential for attackers in a Windows domain. Extracting it allows for <strong>offline cracking of domain hashes</strong>, <strong>Pass-the-hash</strong> attacks, and provides <strong>full control</strong> over all domain users, including <strong>administrators</strong> and <strong>service accounts</strong>, making it a key step in red team operations or APT engagements.</span></p>
<p><span style="color: #000000;"><em><strong>Note</strong>: The NTDS.dit dump enables domain-wide credential exfiltration, allowing attackers to crack weak hashes, reuse them in <strong>Pass-the-Hash</strong> attacks, or forge <strong>Golden Tickets</strong> with <strong>krbtgt</strong> credentials.</em></span></p>
<h3><span style="color: #800000;">Extract gMSA Credentials</span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.53 -u komal -p Passwor@1 –gmsa</pre>
<p><span style="color: #000000;">This command uses <strong>NetExec</strong> to enumerate <strong>Group Managed Service Accounts (gMSAs)</strong> from Active Directory, retrieving their <strong>account names</strong>, <strong>Kerberos keys</strong> (plaintext or hashes), and related metadata if permissions allow.</span></p>
<p><span style="color: #000000;"><em> <img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjwgnpb69A3PtjecsawjXTEf8ftZEpS2XD8yCWUsIXfvK8oipa_HoJyKmzdu-a_u-O2d7unBMDShp6iQ1UUfJdXNXnKG6NFOuUQh45vEZVL-d3c6J72hpmxHziKkH3Y88uNWp7DZIGFMLeY9B3Ad4W8qgxl_qzYulixSCKjCpdsuBc3JPMUksmTkwAWq_w2/s16000/21.png" border="0" data-original-height="154" data-original-width="1100"/></em></span></p>
<p><strong><span style="color: #000000;"><em>Why This Matters:</em></span></strong></p>
<p><span style="color: #000000;">Dumping a gMSA’s secret lets attackers <strong>impersonate the account</strong>, gain <strong>lateral movement</strong>, and <strong>authenticate to services</strong> like MSSQL or IIS for further internal attacks.</span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Retrieve LAPS Password via NetExec (nxc)</span> </span></h3>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc smb 192.168.1.53 -u komal -p Passwor@1 -M laps</pre>
<p><span style="color: #000000;">This command uses NetExec’s <strong>-M laps module</strong> to target <strong>Microsoft LAPS</strong> (Local Administrator Password Solution), which stores unique local admin passwords in Active Directory. Specifically, It attempts to query the <strong>ms-Mcs-AdmPwd</strong> attribute of computer accounts to retrieve the current local admin password.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgH6VH3byuH7yk8dMe6CVAYvEFsDs_PncUEHpGmFlfMgZrhR3vi_Neg48XSqTA8Pvnlkv1WPNvP_ePqH4UUpgp49vsBM5Y3xApMFbxMDqAsl3ASm9uMYxlvjW2LG9YRKBOywxeV4Xupmt4avqz9jxcYqftWqAGHydONx71okKT1aQDwcB6sw63a6nmSqb0o/s16000/22.png" alt="credential dumping with NetExec" width="1097" height="159" border="0" data-original-height="159" data-original-width="1097"/></span></p>
<p><strong><span style="color: #000000;"><em>Why This Matters:</em></span></strong></p>
<p><span style="color: #000000;">If successful, it provides <strong>local admin access</strong> to target machines using their LAPS-managed password. It enables <strong>privilege escalation</strong> and <strong>lateral movement</strong> across the network via <strong>SMB</strong>, <strong>PSExec</strong>, <strong>WinRM</strong>, etc., effectively granting full control over the machine.</span></p>
<p><span style="color: #000000;">Would like to learn more about credential dumping. Please see the information provided <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/category/credential-dumping/">here</a></span>.</span></p>
<h3><span style="color: #800000;">Mitigation</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Segregate SMB access</strong>: Especially remote registry and file share access for low-privilege accounts.</span></li>
<li><span style="color: #000000;"><strong>Monitor access</strong>: Alert on LSA, SAM, or registry accesses via SMB.</span></li>
<li><span style="color: #000000;"><strong>Limit stored credentials</strong>: Encourage disabling auto-login and removing saved sessions in apps.</span></li>
<li><span style="color: #000000;"><strong>Restrict roles</strong>: Minimize Backup Operator and gMSA membership.</span></li>
<li><span style="color: #000000;"><strong>Validate file access</strong>: Detect unusual WinSCP, PuTTY, VNC config access patterns.</span></li>
</ul>
<p><span style="color: #000000;"><strong>Author</strong>: MD Aslam drives security excellence and mentors teams to strengthen security across products, networks, and organizations as a dynamic Information Security leader. Contact </span><strong><a href="https://www.linkedin.com/in/md-aslam-7b04ab144">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
