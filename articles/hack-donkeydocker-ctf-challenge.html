<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the DonkeyDocker (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-donkeydocker-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-08-11T11:04:18+00:00">August 11, 2017</time><time class="updated" datetime="2025-06-10T20:30:10+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve a fun Vulnerable Lab <strong>DonkeyDocker,</strong> download this VM Machine from <strong>here</strong>.</span></p>
<p><span style="color: #000000;">The credit for developing this VM machine is goes to <strong>Dennis Herrmann</strong> who hid 3 flags inside this lab as a challenge for hackers.</span></p>
<p><span style="color: #000000;"><strong>Let’s Breach!!!</strong></span></p>
<p><span style="color: #000000;">Let us start form getting to know the IP of VM (Here, I have it at <strong>192.168.1.120 </strong>but you will have to find your own)</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-C0fURDm5rVc/WY2IXXsRGOI/AAAAAAAAQ1Y/qPvuT88-hi4KDxGc5V0TT2LrDqQBcSoNACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Use nmap command for port enumeration</span></p>
<pre class="lang:default decode:true">nmap -sV 192.168.1.120</pre>
<p><span style="color: #000000;">As you can see port 22 for ssh and 80 for HTTP are open, so let’s explore port 80 through Browser</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NFU2edVz6WU/WY2IZ0R4BtI/AAAAAAAAQ2A/87-UzdS0yT44b7v7CLexlCpFfpW38IVAwCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">After browsing I found three tabs Home, About and Contact but didn’t found any clue for the next step, then I decided to scan the target directory using<strong> dirb scan.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-i0zaD0A1F0U/WY2IZhUS7VI/AAAAAAAAQ14/WZPWLc9FbIsc15SfXUYjpnDxNQEUFsm4QCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Now open the terminal in Kali Linux and type the following command:</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.120</pre>
<p><span style="color: #000000;">From scanning result, I choose the highlighted directory <strong>http://192.168.1.120/mailer/examples/ </strong>for further enumeration.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-PfBfRvs6YTc/WY2IaXDK0II/AAAAAAAAQ2E/xTW-o_10VRgXoxVwFjmaDARXI5jyjVqDwCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Here, we get to know that <strong>PHPMailer</strong> is running on a targeted system. Let try to find out its version.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-fZbdMQbDigw/WY2IalyddHI/AAAAAAAAQ2I/piTWY53bBZAeCyqunnMI_xSs7BKdyDFDgCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">So After browsing a bit about PHP Mailer, we came to know that how to get the version of phpmailer</span></p>
<pre class="lang:default decode:true">http://192.168.1.120/mailer/VERSION</pre>
<p><span style="color: #000000;">We got the version of PHPMailer i.e. <strong>5.2.16.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-98K2dhSrYUc/WY2IavmbTrI/AAAAAAAAQ2c/-kGPgVuEW9cPm2YA3yiqwuAwiqT71rPAgCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">From Google, we came to known that PHPMailer 5.2.16 is vulnerable to Remote Code Execution (python) {<strong>CVE-2016-10033</strong>}. Exploiting PHPMail with the back connection (reverse shell) from the target<strong>. </strong>You can download this exploit from <a href="https://www.exploit-db.com/exploits/40974/"><strong>here</strong></a>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Wq1J8XZghB4/WY2IbMn10PI/AAAAAAAAQ2c/rwfC8Naca-ofR-ZbjUkd7trqB_NRmQTqQCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">After Downloading the Python File and make the following changes:</span></p>
<ol>
<li><span style="color: #000000;">Open the file and add “<strong># coding: utf-8</strong>” at the beginning.</span></li>
<li><span style="color: #000000;">Set <strong>target = ‘http://192.168.1.120/contact’</strong> (victim IP), it is the location where<strong> backdoor.php</strong> get uploaded in the victim’s machine automatically.</span></li>
<li><span style="color: #000000;">Give attacker IP: <strong>192.168.1.101</strong>(Kali Linux IP) inside payload code </span></li>
<li><span style="color: #000000;">After making the above changes save it.</span></li>
</ol>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-_ecRXcgg24o/WY2IcE8LGJI/AAAAAAAAQ2c/Sh0gQ19qTvI5GU6A_5GAYDZgnpcye-mCACEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now start netcat at the same port on which the payload is binding i.e. 4444 for establishing a reverse connection with the target.</span></p>
<pre class="lang:default decode:true">nc -lvp 4444</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ghFhnkgng14/WY2IbZgQXOI/AAAAAAAAQ2c/uAM9oWZSvRIY-Kwyz2_gfB05-p600GcagCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Before you run the python script, type following command in a new terminal which will install the exploit dependency.</span></p>
<pre class="lang:default decode:true">pip2 install requests_toolbelt</pre>
<p><span style="color: #000000;">Now run the script in order to exploit the target as shown in the given image.</span></p>
<pre class="lang:default decode:true">python 40974.py</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sK3lZ_bj76E/WY2IXYBLyQI/AAAAAAAAQ2c/LB82sScFdrgbhPIhY8Xh7mCw07jPmfCygCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Move back <strong>netcat shell</strong> and here you will find that it is connected to the victim but not able to access proper shell of the victim system, therefore, type the given command in order to access victim shell properly as shown in the image.</span></p>
<pre class="lang:default decode:true">python -c 'import pty;pty.spawn("/bin/bash")'</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-N6KNc7QpmUI/WY2IXTkLuKI/AAAAAAAAQ2c/Zx2jAQAicD807KiOcbzoQ9Y0Xk5AZfQRgCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Once you got the victim shell type following commands for finding the hidden flag.</span></p>
<pre class="lang:default decode:true">ls
cat main.sh</pre>
<p><span style="color: #000000;">Here we found user smith which is a directory has <strong>flag.txt</strong> let approach toward this directory.</span></p>
<pre class="lang:default decode:true">cd home
ls</pre>
<p><span style="color: #000000;">While again opening the smith directory, we got <strong>“Permission denied”</strong>.</span></p>
<p><span style="color: #000000;">Then we used su smith to instead of sudo because sudo is not accessible in this shell</span></p>
<pre class="lang:default decode:true">su smith</pre>
<p><span style="color: #000000;">For <strong>Password</strong>, we tried “<strong>smith</strong>” and successfully get smith’s shell</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-5qy2RqsBPQs/WY2IYJaLqaI/AAAAAAAAQ2c/1jBx_Fo9hrMHMKb-9-drOSY61FTIwGXJwCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Now we are inside smith shell, type following command to get the flag</span></p>
<pre class="lang:default decode:true">ls
cd /home/smith
ls
flag.txt
cat flag.xt</pre>
<p><span style="color: #000000;"><strong>Great!!</strong> Successfully capture <strong>the 1<sup>st</sup> flag</strong></span></p>
<p><span style="color: #000000;">Moreover, if you notice the given image. You will find next clue “I like 1984 written by <strong>Geoge ORWELL</strong>” it could be possible that this might be the user name having a 2<sup>nd</sup> flag inside it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-75oedFmI6lw/WY2IYC0H2oI/AAAAAAAAQ2c/dMtzxOKyQdQTy07hklLqzZ8aqq6jt6uBwCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Type following command to view all directory list</span></p>
<pre class="lang:default decode:true ">ls -al</pre>
<p><span style="color: #000000;">We got the <strong>authorized keys,</strong> <strong>id_ed25519 </strong>and <strong>id_ed25519.pub </strong>in SSH directory, let’s open these key one by one</span></p>
<pre class="lang:default decode:true">cat authorized_keys
cat id_ed25519
cat id_ed25519.pub</pre>
<p><span style="color: #000000;">In id_ed25519 we get the OpenSSH Private Key and this key is authorized for <strong>orwell@donkeydocker</strong>. Now copy the private key and past inside the text file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-N1ryUKbctVU/WY2IYIcq6gI/AAAAAAAAQ2c/XECGH2pQgBEbx--QBrSCSucw3hNXgylEgCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Save this Private Key in a file as <strong>id_rsa </strong>as shown in the given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Tq7JNu3Ofjw/WY2IY7A_rfI/AAAAAAAAQ2c/oe3QgmLD-4oQOh73ZuLt_8e5JCg_L06SACEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now using ssh login by</span></p>
<pre class="lang:default decode:true">ssh -i id_rsa orwell@192.168.1.120</pre>
<p><span style="color: #000000;">Here you will be greeted by the Donkey Docker Shell. Now check directory list for the 2<sup>nd</sup> flag</span></p>
<pre class="lang:default decode:true ">ls
flag.txt
cat flag.xt</pre>
<p><span style="color: #000000;"><strong> </strong><strong>Nice!!</strong> Successfully got <strong>the 2<sup>nd</sup> shell</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-SUI0Rv1U6DI/WY2IY0oE0-I/AAAAAAAAQ2c/L6lxXkswc60Au10HgJDIgbdvH9_3oH2BgCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Now for the last flag, we tried a lot of different tricks but nothing seems to be getting through so we tried a method about which you can learn from <a href="https://www.elasticice.net/?p=16"><strong>here.</strong></a><br/>
</span></p>
<p><span style="color: #000000;">Type following command</span></p>
<pre class="lang:default decode:true">docker run –v /root:/hack -t debian:jessie /bin/sh -c 'ls -al /hack'</pre>
<p><span style="color: #000000;">This created a user named Jessie and gave it root access through privilege escalation; check all directory lists inside it, here we get the <strong>flag.txt</strong> file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ftB03FkAvao/WY2IY-jxsUI/AAAAAAAAQ2c/2_C7da1Szu04Qw2NlT4AToA1hy_tZuHOQCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now to open this file we will use the previous command just with slight modification as shown:</span></p>
<pre class="lang:default decode:true">docker run -v /root:/hack -t debian:jessie /bin/sh -c 'cat /hack/flag.txt'</pre>
<p><span style="color: #000000;">Awesome we got <strong>3<sup>rd</sup> flag</strong> also.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-kVYo9v6-gQs/WY2IZpIiP9I/AAAAAAAAQ2c/yO7hAHbZg6YHwe7IjYDuN8eZo_GDKq19gCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;"><strong>Author:</strong> Pavandeep Singh is An <strong>Ethical Hacker</strong>, <strong>Cyber Security Expert, Penetration Tester,</strong> India. Contact <a href="https://www.linkedin.com/in/pavandeep-singh-6b1074132"><strong>here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
