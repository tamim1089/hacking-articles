<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Understanding Guide to ICMP Protocol with Wireshark</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/understanding-guide-icmp-protocol-wireshark/" rel="bookmark"><time class="entry-date published" datetime="2017-10-07T17:54:11+00:00">October 7, 2017</time><time class="updated" datetime="2025-06-05T20:35:49+00:00">June 5, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-7 ai-optimize-introduction"><span style="color: #000000;">The <strong>I</strong>nternet <strong>C</strong>ontrol <strong>M</strong>essage <strong>P</strong>rotocol (<strong>ICMP</strong>) is a supporting protocol in the Internet protocol suite. It is used by network devices, including routers, to send error messages and operational information which indicates that a requested service is not available or that a host or router could not be reached. (From Wikipedia)</span></p>
<p class="ai-optimize-8 ai-optimize-introduction"><span style="color: #000000;">It is layer 3 i.e. network layer protocol used by the ping command for sending a message through ICMP payload which is encapsulated with IP Header Packet.  According to MTU the size of the ICMP packet cannot be greater than 1500 bytes.</span></p>
<h3 class="ai-optimize-9"><span style="color: #000000;"><span style="color: #800000;">ICMP packet at Network layer</span> </span></h3>
<table>
<tbody>
<tr>
<td width="145"><span style="color: #000000;">IP header</span></td>
<td width="144"><span style="color: #000000;">ICMP header</span></td>
<td width="190"><span style="color: #000000;">ICMP payload size</span></td>
<td width="160"><span style="color: #000000;">  MTU (1500)</span></td>
</tr>
<tr>
<td width="145"><span style="color: #000000;">20 bytes</span></td>
<td width="144"><span style="color: #000000;">8 bytes</span></td>
<td width="190"><span style="color: #000000;">1472 bytes  (maximum)</span></td>
<td width="160"><span style="color: #000000;">20 + 8 + 1472 = 1500</span></td>
</tr>
</tbody>
</table>
<p class="ai-optimize-10"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-aB1JgIOYFpY/WdkJzz0BmOI/AAAAAAAAR1E/3iaVJ8IM4qkFSnLTmxDwJo9KVrOw_inSgCLcBGAs/s1600/0.1.png"/></span></p>
<h3 class="ai-optimize-11"><span style="color: #000000;"><span style="color: #800000;">ICMP packet at Data Link layer</span> </span></h3>
<p class="ai-optimize-98"><span style="color: #000000;">An ICMP packet at the Data Link layer consists of a 14-byte Ethernet header, a 20-byte IP header, an 8-byte ICMP header, and a 1472-byte payload, totaling the maximum transmission unit (MTU) size of 1514 bytes.</span></p>
<table>
<tbody>
<tr>
<td width="115"><span style="color: #000000;">Ethernet header</span></td>
<td width="102"><span style="color: #000000;">IP header</span></td>
<td width="120"><span style="color: #000000;">ICMP header</span></td>
<td width="162"><span style="color: #000000;">ICMP payload size</span></td>
<td width="141"><span style="color: #000000;">  MTU (1514)</span></td>
</tr>
<tr>
<td width="115"><span style="color: #000000;">14</span></td>
<td width="102"><span style="color: #000000;">20 bytes</span></td>
<td width="120"><span style="color: #000000;">8 bytes</span></td>
<td width="162"><span style="color: #000000;">1472 bytes  (maximum)</span></td>
<td width="141"><span style="color: #000000;">14 + 20 + 8 + 1472 = 1514</span></td>
</tr>
</tbody>
</table>
<h3 class="ai-optimize-12"><span style="color: #800000;">ICMP Message code &amp; Packet description with Wireshark</span></h3>
<p class="ai-optimize-13"><span style="color: #000000;">ICMP message contains two types of codes i.e. query and error.</span></p>
<h4 class="ai-optimize-14"><span style="color: #000000;">Query: </span></h4>
<p class="ai-optimize-14"><span style="color: #000000;">The query messages are the information we get from a router or another destination host.</span></p>
<h5 class="ai-optimize-15"><strong><span style="color: #000000;">For example</span></strong></h5>
<p class="ai-optimize-15"><span style="color: #000000;">Given below message types are some ICMP query codes:</span></p>
<ul>
<li class="ai-optimize-16"><span style="color: #000000;">Type 0 = Echo Reply</span></li>
<li class="ai-optimize-17"><span style="color: #000000;">Type 8 = Echo Request</span></li>
<li class="ai-optimize-18"><span style="color: #000000;">Type 9 = Router Advertisement</span></li>
<li class="ai-optimize-19"><span style="color: #000000;">Type 10 = Router Solicitation</span></li>
<li class="ai-optimize-20"><span style="color: #000000;">Type 13 = Timestamp Request</span></li>
<li class="ai-optimize-21"><span style="color: #000000;">Type 14 = Timestamp Reply</span></li>
</ul>
<p class="ai-optimize-22"><span style="color: #000000;">A ping command sends an ICMP <strong>echo request</strong> to the target host. The target host responds with an <strong>echo Reply </strong>which means the target host is alive.</span></p>
<p class="ai-optimize-23"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-BWHElC1GAoU/WdkJzyayT6I/AAAAAAAAR1M/xF9OHut1XpIVXx2Hsicf6N4PzF51RFnFACLcBGAs/s1600/0.png"/></span></p>
<p class="ai-optimize-24"><span style="color: #000000;">Here we are going to test how ping command helps in identifying an alive host by Pinging host IP.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ping 192.168.0.105</pre>
<p class="ai-optimize-25"><span style="color: #000000;">From the given below image you can see a reply from the host; now notice a few more things as given below:</span></p>
<ul>
<li class="ai-optimize-26"><span style="color: #000000;">The default size of payload sent by source machine is 32 bytes (<strong>request</strong>)</span></li>
<li class="ai-optimize-27"><span style="color: #000000;">The same size of payload received by source machine is 32 bytes from Destination machine (<strong>reply</strong>)</span></li>
<li class="ai-optimize-28"><span style="color: #000000;"><strong>TTL = 128</strong> which means host machine is windows system.</span></li>
<li class="ai-optimize-29"><span style="color: #000000;">Total packets are <strong>8</strong>, 4 packets of the request and 4 of reply.</span></li>
</ul>
<p class="ai-optimize-30"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vCf3HeVUtCQ/WdkJz06ctbI/AAAAAAAAR1I/GRYbr0NwWrcECMOYGJmhg9aegSsatDEBACLcBGAs/s1600/1.png"/></span></p>
<p class="ai-optimize-31"><span style="color: #000000;">Look over the sequence of packet transfer between source and destination captured through Wireshark.</span></p>
<p class="ai-optimize-32"><span style="color: #000000;">Total numbers of packet captured are 8, 4 for request and 4 for reply between the source and destination machine.</span></p>
<p class="ai-optimize-33"><span style="color: #000000;"> The 1<sup>st</sup> packet is sent by source machine is ICMP echo request and if you look by the given below image, you will observe highlighted text is showing ICMP query code: <strong>type 8 echo ping request.</strong></span></p>
<h5 class="ai-optimize-34"><span style="color: #000000;"><strong>Length of frame is 74 now  as explained in the below table: </strong></span></h5>
<table>
<tbody>
<tr>
<td width="115"><span style="color: #000000;">Ethernet header</span></td>
<td width="102"><span style="color: #000000;">IP header</span></td>
<td width="120"><span style="color: #000000;">ICMP header</span></td>
<td width="162"><span style="color: #000000;">ICMP payload size</span></td>
<td width="141"><span style="color: #000000;">  MTU (1514)</span></td>
</tr>
<tr>
<td width="115"><span style="color: #000000;">14</span></td>
<td width="102"><span style="color: #000000;">20 bytes</span></td>
<td width="120"><span style="color: #000000;">8 bytes</span></td>
<td width="162"><span style="color: #000000;">32  (default)</span></td>
<td width="141"><span style="color: #000000;">14+20+8+32=74</span></td>
</tr>
</tbody>
</table>
<p class="ai-optimize-35"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-dz9dghHK0HY/WdkJ3ZQw0AI/AAAAAAAAR14/jDhk_87IY5MHNVUtg-B08B82CA6M5guWACLcBGAs/s1600/2.png"/></span></p>
<p class="ai-optimize-36"><span style="color: #000000;">Similarly given below image is showing details of <strong>2<sup>nd</sup></strong> packet i.e.  Echo reply, you can observe that the highlighted text is showing ICMP query code: <strong>type 0 echo ping reply.</strong>  </span></p>
<p class="ai-optimize-37"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-gdU9yjf-4is/WdkJ5qr3hCI/AAAAAAAAR2Y/lCBGFSuG7g0DTuq9gzhj6IbHbeIh3Od0ACLcBGAs/s1600/3.png"/></span></p>
<h4 class="ai-optimize-38"><span style="color: #000000;">Error: </span></h4>
<p class="ai-optimize-38"><span style="color: #000000;">The error statement messages reports problem which a router or a destination host may generate.</span></p>
<h5 class="ai-optimize-39"><span style="color: #000000;"><strong>For example:</strong> </span></h5>
<p class="ai-optimize-39"><span style="color: #000000;">Given below message types are some of the ICMP error codes:</span></p>
<ul>
<li class="ai-optimize-40"><span style="color: #000000;">Type 3 = Destination Unreachable</span></li>
<li class="ai-optimize-41"><span style="color: #000000;">Type 4 = Source Quench</span></li>
<li class="ai-optimize-42"><span style="color: #000000;">Type 5 = Redirect</span></li>
<li class="ai-optimize-43"><span style="color: #000000;">Type 11 = Time Exceeded</span></li>
<li class="ai-optimize-44"><span style="color: #000000;">Type 12 = Parameter Problems</span></li>
</ul>
<p class="ai-optimize-45"><span style="color: #000000;">When we ping an IP sometimes we don’t get echo ping reply from the host machine, instead of that, we get some reply such as<strong> destination unreachable </strong>or<strong> time exceeded</strong> this is known as <strong>ICMP error reporting message</strong>. There are so many reasons behind such kind of error message, possibly a host in a  network is down or firewall is blocking your ping request.</span></p>
<p class="ai-optimize-46"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-0pnuWi8n-pk/WdkJ5-0sO2I/AAAAAAAAR2c/n_CwR5BrVPgNeTOhJT4A-1qyp1X9ldbhwCLcBGAs/s1600/4.png"/></span></p>
<p class="ai-optimize-47"><span style="color: #000000;">The<strong> 1<sup>st</sup></strong> packet sends by source machine is ICMP echo request and if you observe by the given below image the highlighted text is showing ICMP query code: </span></p>
<h5 class="ai-optimize-47"><span style="color: #000000;"><strong>type 8 echo ping request.</strong></span></h5>
<p class="ai-optimize-48"><span style="color: #000000;">Similarly given below image is showing the detail of <strong>2<sup>nd</sup></strong> packet i.e.  Destination unreachable, you can observe that it is showing ICMP error code: </span></p>
<h5 class="ai-optimize-48"><span style="color: #000000;"><strong>type 3.</strong>  </span></h5>
<p class="ai-optimize-49"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-29eSOoaOfoU/WdkJ6LNC3mI/AAAAAAAAR2g/1zCZkQwWak0fKI0nF0kjcgrJ2S3AtGU7wCLcBGAs/s1600/5.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ping –a 192.168.0.105</pre>
<p class="ai-optimize-50"><span style="color: #000000;">-a: Resolve IP addresses to host-name, identify’s that reverse name resolution is carried out on the host IP address. If it is successful, ping shows the matching hostname.</span></p>
<p class="ai-optimize-51"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-AvR9_CTKj54/WdkJ0nbHlLI/AAAAAAAAR1Q/dIUhftVNIWAeyGIYLpCtoorwAG71oXC8ACLcBGAs/s1600/10.png"/></span></p>
<p class="ai-optimize-52"><span style="color: #000000;">From the given below image, you can observe that instead of ICMP protocol the ping request has been sent through NBNS (NetBIOS Name Service)protocol through port 137 which is a UDP port.</span></p>
<p class="ai-optimize-53"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-jX_yhcCfin8/WdkJ0xb6egI/AAAAAAAAR1U/37Vi_HIgRo83AqHjAbLJ3dhmoR1OhqWpQCLcBGAs/s1600/11.png"/></span></p>
<p class="ai-optimize-54"><span style="color: #000000;">After applying UDP filter you can read hostname captured by Wireshark “WIN-1GKSSJ7D2AE” is the part of a workgroup.</span></p>
<p class="ai-optimize-55"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-AvbaHMKlm8U/WdkJ0z3aPUI/AAAAAAAAR1Y/x4GLZ2LXyTImFCeg3wxfTjNiyzGJyY68ACLcBGAs/s1600/12.png"/></span></p>
<p class="ai-optimize-56"><span style="color: #000000;">By default, a ping sends 4 packets of the request and receives the same number of the packet as a reply from the host. You can increase or decrease this number of the packet by using given below command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ping –n 2 192.168.0.105</pre>
<p class="ai-optimize-57"><span style="color: #000000;"><strong>-n: </strong>Number of echo requests to send</span></p>
<p class="ai-optimize-58"><span style="color: #000000;">As we had set -n as 2  packets of request hence we got two packets as a reply.</span></p>
<p class="ai-optimize-59"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-tgY-8eJ3SRQ/WdkJ1SDa6cI/AAAAAAAAR1c/DH9NN6GWw-kuRcJac5wr98U-c581ECfSgCLcBGAs/s1600/13.png"/></span></p>
<p class="ai-optimize-60"><span style="color: #000000;">Similarly, we can also set TTL (Time to Live) for echo request packets; by default, the source machine sends 4 packets of request queries at the rate of 1 millisecond per packet. Suppose we want to give TTL between two packets; we set -i as 5ms so that after we deliver the first packet, we send the second packet after 5ms.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ping –i 5 192.168.0.105</pre>
<p class="ai-optimize-61"><span style="color: #000000;"><strong>-i TTL:</strong> Time To Live</span></p>
<p class="ai-optimize-62"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-kregkVwD_AQ/WdkJ1pIAQmI/AAAAAAAAR1g/1eqiRcpdVAchkzWCz1PdwcHhFsC3_eBHwCLcBGAs/s1600/14.png"/></span></p>
<p class="ai-optimize-63"><span style="color: #000000;">Let’s verify TTL for a packet sent from source to destination through Wireshark. Now if you observe by the given below image you will notice that every echo ping request packet has TTL 5 but every echo reply has default TTL value i.e.128.</span></p>
<p class="ai-optimize-64"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-oZ5K_FqvhnQ/WdkJ1ptUTfI/AAAAAAAAR1k/Gv9BmUE_LJsz2tTLsEqt1rtmxDme86wgwCLcBGAs/s1600/15.png"/></span></p>
<h3 class="ai-optimize-65"><span style="color: #000000;"><span style="color: #800000;">Payload description through Wireshark</span></span></h3>
<p class="ai-optimize-66"><span style="color: #000000;">As we discussed above, the default size of the ICMP payload is 32 bytes and the maximum is 1472; if the size of the payload packet exceeds 1472, the system fragments the packet into smaller packets.</span></p>
<p class="ai-optimize-67"><span style="color: #000000;">From the given below image, you can observe source has pinged the host which carries default 32 bytes size payload.   </span></p>
<p class="ai-optimize-68"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-HHeXvBrQfsw/WdkJ2elkx8I/AAAAAAAAR1o/IjerGciWwiM4Ymo2L9oqxnbcIe4x1zCDgCLcBGAs/s1600/16.png"/></span></p>
<p class="ai-optimize-69"><span style="color: #000000;">Now let check the information payload carries from source to destination using Wireshark. From the given below image, you can read that highlighted texts are alphabets that have been used as 32 bytes payload.</span></p>
<p class="ai-optimize-70"><span style="color: #000000;">The combination of 26 letters forms the alphabet, and they are used as 32 bytes payload:</span></p>
<p class="ai-optimize-71"><span style="color: #000000;"><strong>abcd——uvw</strong> are <strong>23</strong> letters only 9 letters needed more to complete 32 bytes therefore again it included <strong>9</strong> alphabets more  i.e. <strong>abcdefghi</strong></span></p>
<p class="ai-optimize-72"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-97NGb0avqYQ/WdkJ2ouO-MI/AAAAAAAAR1s/Br2zr8p5BEsOIRf2-UGOySKh6LgYPu4fgCLcBGAs/s1600/17.png"/></span></p>
<p class="ai-optimize-73"><span style="color: #000000;">You can reset the size of payload using the following command that will carry echo ping request from a source to destination.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ping -l 33 192.168.0.105</pre>
<p class="ai-optimize-74"><span style="color: #000000;">As we have seen above the 32 bytes payload carry data in the form of alphabets <strong>abcd—-uvw </strong>and then<strong> abcd—hi. </strong> Hence if the size of the payload is 33 then data should start from <strong>abcd—-uvw </strong>and then<strong> abcd—hij.  </strong>Alphabet <strong>“j”</strong> must be the last payload of the data packet.</span></p>
<p class="ai-optimize-75"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-sG5riSYgFwc/WdkJ2v1hYkI/AAAAAAAAR1w/xick2Cxoxuwat48GWBa8d-C2aeTRWFetwCLcBGAs/s1600/18.png"/></span></p>
<p class="ai-optimize-76"><span style="color: #000000;">From the given image you can confirm that the Alphabet <strong>“j”</strong> is the last payload of a data packet, In this way increasing the payload size will add an alphabet letter into the data packet.</span></p>
<h5 class="ai-optimize-77"><span style="color: #000000;"><strong>Length of the frame has become 75 now as shown in below table:</strong></span></h5>
<table>
<tbody>
<tr>
<td width="115"><span style="color: #000000;">Ethernet header</span></td>
<td width="102"><span style="color: #000000;">IP header</span></td>
<td width="120"><span style="color: #000000;">ICMP header</span></td>
<td width="162"><span style="color: #000000;">ICMP payload size</span></td>
<td width="141"><span style="color: #000000;">  MTU (1514)</span></td>
</tr>
<tr>
<td width="115"><span style="color: #000000;">14</span></td>
<td width="102"><span style="color: #000000;">20 bytes</span></td>
<td width="120"><span style="color: #000000;">8 bytes</span></td>
<td width="162"><span style="color: #000000;">33  (default)</span></td>
<td width="141"><span style="color: #000000;">14+20+8+33=75</span></td>
</tr>
</tbody>
</table>
<p class="ai-optimize-78"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-H9FTR0vYkbQ/WdkJ3PRUbaI/AAAAAAAAR10/Itx-6pAZT8gdv027G9PLjP76OJIRsWSqwCLcBGAs/s1600/19.png"/></span></p>
<p class="ai-optimize-79"><span style="color: #000000;">Now we are sending the maximum size of payload using the following command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ping -l 1472 192.168.0.105</pre>
<p class="ai-optimize-80"><span style="color: #000000;">From the given below image, you can see a reply from the host machine.</span></p>
<p class="ai-optimize-81"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ouJK32fhDUM/WdkJ3ZGNDhI/AAAAAAAAR18/u69io3O8qt4ha66x-8a4iDE9eA8oCS2MQCLcBGAs/s1600/20.png"/></span></p>
<p class="ai-optimize-82"><span style="color: #000000;">According to MTU, if you set the size of the payload to 1472, then the frame size will become 1514 as explained above. Let’s verify it from Wireshark.  From given below image you can read length of the frame is 1514 and highlighted text is showing data of 1472 bytes payload.</span></p>
<p class="ai-optimize-83"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-A6a9JZPIJXE/WdkJ4O0UVKI/AAAAAAAAR2A/yLRE3kqH9dkPHFkEY3eS1E1Djhb3h1PWwCLcBGAs/s1600/21.png"/></span></p>
<p class="ai-optimize-84"><span style="color: #000000;">When the size of the payload is greater than 1472 or too large for a network to hold and reach a router, the router breaks it into smaller packets (fragments).</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ping -l 1473 192.168.0.105</pre>
<p class="ai-optimize-85"><span style="color: #000000;">From the given below image, you can see now the size of the payload is 1473 which carries echo ping request from a source to destination.</span></p>
<p class="ai-optimize-86"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/--cZRNuoy37o/WdkJ4Fuj4nI/AAAAAAAAR2E/ETVqVZI23y42PG2wLBNwF4-aBtepNCvHQCLcBGAs/s1600/22.png"/></span></p>
<p class="ai-optimize-87"><span style="color: #000000;">From the given image, you can confirm that when the payload exceeds 1472 ICMP packets, it fragments as per the table below:</span></p>
<table>
<tbody>
<tr>
<td width="115"><span style="color: #000000;">Ethernet header</span></td>
<td width="102"><span style="color: #000000;">IP header</span></td>
<td width="120"><span style="color: #000000;">ICMP header</span></td>
<td width="162"><span style="color: #000000;">ICMP payload size</span></td>
<td width="141"><span style="color: #000000;">  MTU (1514)</span></td>
</tr>
<tr>
<td width="115"><span style="color: #000000;">14</span></td>
<td width="102"><span style="color: #000000;">20 bytes</span></td>
<td width="120"><span style="color: #000000;">8 bytes</span></td>
<td width="162"><span style="color: #000000;">1472</span></td>
<td width="141"><span style="color: #000000;">14+20+8+1472=1514</span></td>
</tr>
<tr>
<td width="115"><span style="color: #000000;">14</span></td>
<td width="102"><span style="color: #000000;">20</span></td>
<td width="120"><span style="color: #000000;">–</span></td>
<td width="162"><span style="color: #000000;">1</span></td>
<td width="141"><span style="color: #000000;">35</span></td>
</tr>
</tbody>
</table>
<p class="ai-optimize-88"><span style="color: #000000;">If you separate Ethernet header and IP header the size of payload will be 1480 bytes as shown below.</span></p>
<p class="ai-optimize-89"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-o8jIQ0KOq-A/WdkJ4V6JF6I/AAAAAAAAR2I/Etmza2A2JpoUX1-VAFFOSmtKhah8Md1hQCLcBGAs/s1600/23.png"/></span></p>
<p class="ai-optimize-90"><span style="color: #000000;">Using –f option with ping command will not allow packet fragmentation in the network.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ping –f –l 1472 192.168.0.105</pre>
<h5 class="ai-optimize-91"><span style="color: #000000;"><strong>-f:</strong>  Set Don’t Fragment flag in the packet</span></h5>
<p class="ai-optimize-92"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Q2SkiPQE_Qk/WdkJ47UtqsI/AAAAAAAAR2M/rktNA9yVT5UpFucZcMqsznGL4aXcpNf3ACLcBGAs/s1600/24.png"/></span></p>
<p class="ai-optimize-93"><span style="color: #000000;">From the given below image you can observe remote host has set (don’t) fragment flag which will not allow the router to fragment the payload packets. Moreover, 1472 bytes payload didn’t need fragmentation by the router. </span></p>
<p class="ai-optimize-94"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-jnXzV2dnlaE/WdkJ5AmwuGI/AAAAAAAAR2Q/y67HWNBu0WkynD9UuFbd0YA15LZ7jncagCLcBGAs/s1600/25.png"/></span></p>
<p class="ai-optimize-95"><span style="color: #000000;">When you set the packet size to 1473 with the (don’t) fragment flag using ping, the router will reject the packet and display an ICMP message indicating that the packet needs fragmentation due to the MTU size limit of 1500 bytes.</span></p>
<table>
<tbody>
<tr>
<td width="145"><span style="color: #000000;">IP header</span></td>
<td width="144"><span style="color: #000000;">ICMP header</span></td>
<td width="190"><span style="color: #000000;">ICMP payload size</span></td>
<td width="160"><span style="color: #000000;">  MTU (1500)</span></td>
</tr>
<tr>
<td width="145"><span style="color: #000000;">20 bytes</span></td>
<td width="144"><span style="color: #000000;">8 bytes</span></td>
<td width="190"><span style="color: #000000;">1473 bytes  (<strong>without fragment)</strong></span></td>
<td width="160"><span style="color: #000000;">More than 1500 bytes   <strong>Not possible</strong></span></td>
</tr>
</tbody>
</table>
<p class="ai-optimize-96"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-W_4srcPwB8g/WdkJ5FMyehI/AAAAAAAAR2U/xcMMO7n6cbsjZIoX6KYJKwr5DRBLG23jgCLcBGAs/s1600/26.png"/></span></p>
<p class="ai-optimize-99"><span style="color: #000000;">To learn more about Penetration Testing. Follow this <a href="https://www.hackingarticles.in/category/penetration-testing/">Link.</a> </span></p>
<p class="ai-optimize-97"><span style="color: #000000;"><strong> Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<a href="https://www.linkedin.com/in/aarti--singh/"> here</a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
