<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Understating Guide of Windows Security Policies and Event Viewer</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/understating-guide-windows-security-policies-event-viewer/" rel="bookmark"><time class="entry-date published updated" datetime="2017-12-19T11:08:56+00:00">December 19, 2017</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! This article will be helpful to considerate the importance of event viewer and how to read the logs generated by event view that help in troubleshooting of any system or application problem.  </span></p>
<p><span style="color: #000000;">In order to view Event logs press “window key + R” to open run command and type “<strong>eventvwr.msc</strong>” then hit the enter key.</span></p>
<p><span style="color: #000000;"><strong>Windows Event Viewer</strong> is a tool which monitors the activity of your system by maintaining some kinds of log such as application log, system log and etc. It starts automatically when you turn on your system to assemble the details critical state about hardware and software. These logs help a system administrator to troubleshoot the problems of the machine and identify with what is going on. He could use Event Viewer to view and manage the event logs.</span></p>
<p><span style="color: #000000;">From the below image, you can observe the window screen is categories into three panels as described below:</span></p>
<p><span style="color: #000000;">The <strong>left side</strong> contains some folders which keep records of every task performed by machines such as windows log i.e. system or security.</span></p>
<p><span style="color: #000000;"> The <strong>middle part</strong> contains a list of events, it contains detail of every event occurred by recording their logs which are known as <strong>Event type </strong>such as “information, warning or error” and their details.</span></p>
<p><span style="color: #000000;">The <strong>right side</strong> presents a list of some other actions such as creating custom views, filtering, or even creating a scheduled task depends on a specific event.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-KM_B0ClrZRk/WjjrzBTyH8I/AAAAAAAASsI/mVnJE6w3VmkLyHtZVim1dSZ4ljpVYxbfACEwYBhgL/s1600/0.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Most Important Event Logs</span> </strong></span></h3>
<p><span style="color: #000000;">Remarkably there are three kinds of Event Logs:</span></p>
<p><span style="color: #000000;"><strong>System Log:</strong> Any action or task performed by an operating system such as such an unexpected shutdown and turn ON/OFF of any service is recorded under the System log.</span></p>
<p><span style="color: #000000;"><strong>Application Log: </strong>The Application log records all events by programs such as successful installation or stops responding while running.</span></p>
<p><span style="color: #000000;"><strong>Security Log: </strong> The Security log records security events, such as legitimate and unacceptable logon attempts which will represent as audit success for the valid attempt and audit failure for the invalid attempt.  These logs help in identifying any possible breaches to security. By default security log is disabled you need to enable them for your system through local security policy.</span></p>
<p><span style="color: #000000;"><strong>Enable Local Security Policy for Security logs</strong></span></p>
<p><span style="color: #000000;">Now open Local security policy logs press “window key + R” to open run command and type “<strong>secpol.msc</strong>” then hit the enter key, then change the security setting for Audit policy under <strong>security setting &gt; Local Policies&gt; Audit policy</strong> in order to receive its log inside event viewer security logs.</span></p>
<p><span style="color: #000000;">From given below image you can observe that there is not any single security policy is auditing, which means it will not create any security log inside event viewer. </span></p>
<p><span style="color: #000000;">Let’s enable any one policy for auditing to test what kind of security log will be generated when we will move into event viewer security log. Here I had chosen “<strong>Audit account logon event</strong>” for auditing.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VwmLD4k6fMs/WjjrzEIg5pI/AAAAAAAASsI/TQBv5F8YrQYe48xZYnCsTV-rR4ZBqVkXQCEwYBhgL/s1600/1.1.png"/></span></p>
<p><span style="color: #000000;">It will open a new window for its property setting you as shown in given image <strong>Enable</strong> the checkbox for <strong>Success </strong>and <strong>Failure</strong>, click on apply to enable this policy for auditing.</span></p>
<p><span style="color: #000000;">Hence when a user will Enter password on logon screen it will generate log as audit success for valid login attempt and audit failure logs for the invalid attempt. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-s0d0SEgi6xQ/WjjrzAeRiAI/AAAAAAAASsM/1mCUSBE7xNklwf_xg7p9ZgQiU9KyYenOwCEwYBhgL/s1600/1.2.png"/></span></p>
<p><span style="color: #000000;">Now you can observe from given below image it is showing auditing: success &amp; failure for account logon event.</span></p>
<p><span style="color: #000000;">You can check it by login into your system and type the wrong password as invalid attempt and then finally enter the correct password for the valid attempt and then verify generated security logs for you this kind of action.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-RhmV44dT8Y4/Wjjrzuab7dI/AAAAAAAASsI/ICRrY02lOd4vYKcNejzgp9aAOCF4_quvgCEwYBhgL/s1600/1.3.png"/></span></p>
<p><span style="color: #000000;">In order to view Security Event logs press “window key + R” to open run command and type “<strong>eventvwr.msc</strong>” then hit the enter key.</span></p>
<p><span style="color: #000000;">Now explore <strong>Security event logs</strong> under Windows logs, here you will observe some log entries generated by Security-Auditing as Audit success for valid login attempt and Audit failure for invalid login attempt.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-tGZVkS4GC-Q/WjjrzhKuvEI/AAAAAAAASsI/EuvPzpbLk4Mzn16zCQokvPr6eDZ2bJh-ACEwYBhgL/s1600/1.4.png"/></span></p>
<h3><span style="color: #800000;"><strong>Event Types</strong></span></h3>
<p><span style="color: #000000;">The details of logs are depended upon different types of event and event logs mainly classify in five categories as described below:</span></p>
<table>
<tbody>
<tr>
<td><span style="color: #000000;"><strong>Event Type</strong></span></td>
<td><span style="color: #000000;"><strong>Definition</strong></span></td>
</tr>
<tr>
<td><span style="color: #000000;">Error</span></td>
<td><span style="color: #000000;">Considerable trouble, such as loss of data or loss of functionality or fault in problem execution.</span></td>
</tr>
<tr>
<td><span style="color: #000000;">Warning</span></td>
<td><span style="color: #000000;">This type of event that might not be considered, but might point out a future problem.</span></td>
</tr>
<tr>
<td><span style="color: #000000;">Information</span></td>
<td><span style="color: #000000;">An event that describes the successful operation of an application, driver, or service.</span></td>
</tr>
<tr>
<td><span style="color: #000000;">Success Audit</span></td>
<td><span style="color: #000000;">An audited security access attempt that succeeds. {In security logs}</span></td>
</tr>
<tr>
<td><span style="color: #000000;">Failure Audit</span></td>
<td><span style="color: #000000;">An audited security access attempt that fails. {In security logs}</span></td>
</tr>
</tbody>
</table>
<p><span style="color: #000000;">From given below image you can observe that the logs are records in 5 columns to store their important details</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> displays event type</span></p>
<p><span style="color: #000000;"><strong>Date and time:</strong> displays the date and time of event type when it generated</span></p>
<p><span style="color: #000000;"><strong>Source:</strong> the source of event type due to which event log is created.</span></p>
<p><span style="color: #000000;"><strong>Event Id:</strong> The Event Viewer uses event IDs to describe the uniquely identifiable events that a Windows computer can come upon. </span></p>
<p><span style="color: #000000;"><strong>Task category:</strong> Used to represent activity of the event launcher program.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-wzfHhOtDBus/Wjjrz-uQ3hI/AAAAAAAASsM/izKDO32JtNA7KyHHKr2MtrJafHGJhuSFwCEwYBhgL/s1600/2.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">General Details of Event Log</span> </strong></span></h3>
<p><span style="color: #000000;">Admin can take help of <strong>General</strong> property in order to read a brief description of the event log which could be helpful in troubleshooting of some problems. He can also read complete detail of property for any occurred event which is stored under <strong>Details Tab</strong>.</span></p>
<p><span style="color: #000000;">The general property contains the following information of an event log:</span></p>
<table width="604">
<tbody>
<tr>
<td><span style="color: #000000;"><strong>Property name </strong></span></td>
<td width="519"><span style="color: #000000;"><strong>Description</strong></span></td>
</tr>
<tr>
<td><span style="color: #000000;">Log Name</span></td>
<td width="519"><span style="color: #000000;">Window log category it may be system, application or security logs.</span></td>
</tr>
<tr>
<td><span style="color: #000000;">Source</span></td>
<td width="519"><span style="color: #000000;">The source that produced the event. It might be an application or system component</span></td>
</tr>
<tr>
<td><span style="color: #000000;">Event Id</span></td>
<td width="519"><span style="color: #000000;">The Event Viewer uses event IDs to describe the uniquely identifiable events that a Windows computer can come upon. </span></td>
</tr>
<tr>
<td><span style="color: #000000;">Level</span></td>
<td width="519"><span style="color: #000000;">Information, Warning, Error, Success Audit, and Failure Audit</span></td>
</tr>
<tr>
<td><span style="color: #000000;">User</span></td>
<td width="519"><span style="color: #000000;">Display user name who has logged onto the computer when the event occurred</span></td>
</tr>
<tr>
<td><span style="color: #000000;">OpCode</span></td>
<td width="519"><span style="color: #000000;">Operational code Contains a numeric value that identifies the activity or a point within an activity that the application was performing when it raised the event. For example, initialization or closing.</span></td>
</tr>
<tr>
<td><span style="color: #000000;">Logged</span></td>
<td width="519"><span style="color: #000000;">The name of the log where the event was recorded</span></td>
</tr>
<tr>
<td><span style="color: #000000;">Task category:</span></td>
<td width="519"><span style="color: #000000;">Used to represent activity of the event launcher program.</span></td>
</tr>
<tr>
<td><span style="color: #000000;">Keywords</span></td>
<td width="519"><span style="color: #000000;">It can be used to filter or search for events. Such as “audit failure” or “Respond time.”</span></td>
</tr>
<tr>
<td><span style="color: #000000;">Computer</span></td>
<td width="519"><span style="color: #000000;">The computer where the event occurred</span></td>
</tr>
</tbody>
</table>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-waImbBfcF5s/Wjjr0GhGoyI/AAAAAAAASsI/Taktd6gtl4obi0lkcagnW-QARQKP9LXmgCEwYBhgL/s1600/3.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Clear Logs</span> </strong></span></h3>
<p><span style="color: #000000;">If you want to remove entire records of logs then move your cursor at the right side of window screen and click on option “clear log” under Action tab as shown in the given below image. Then a dialog box will pop up to confirm your action, here it lets you save the previous log in another location.   </span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://2.bp.blogspot.com/-Ek-J0E5Q7t8/Wjjr0dkAcQI/AAAAAAAASsI/BWpV8bCD5Xc6PMdukVhM8H0clIt6p4UZACEwYBhgL/s1600/4.png"/></strong></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Create a Custom Event</span> </strong></span></h3>
<p><span style="color: #000000;">If you want to keep a record of specific event type for a particular task occurred then you can use “custom event” which will only keep records of those event type which you have defined for a particular service or application.</span></p>
<p><span style="color: #000000;">Again move your cursor at the right side of window screen and click on option “custom event” under Action tab as shown in the given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-rFe04ftgtBI/Wjjr0tTUEhI/AAAAAAAASsI/L65h5gIItygJ_3EHwtul_4sG4EYg807EACEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">A window screen will pop up which will generate a customized log according to you. From given below image you can observe that I wish to get few event types for which checkbox is enabled from event source as Remote access only for invalid login attempt.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-A61cNZNGxUQ/Wjjr02sbVVI/AAAAAAAASsI/7HPMpyeK2R0dVZnxx07iiwgXicBrqlJqgCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">This custom event log will be saved in a new folder “RDP” under event viewer &gt; custom view. Enter the name for your event log and description as shown in the given below image. It decreases the level of records and makes ease in problem troubleshoot.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-FcLptPtxTow/Wjjr06mFgRI/AAAAAAAASsI/dDau5ESozS4fmLZce_rasFq95xLJkBs0QCEwYBhgL/s1600/7.png"/></span></p>
<h3><span style="color: #800000;"><strong>Deleting Event viewer from victims system</strong></span></h3>
<p><span style="color: #000000;">This section is applicable only for the hacked system, so if you have hacked any windows machine using Kali Linux and obtain victim’s meterpreter session then run given below command for deleting all record of logs from his system. Preserve yourself from being caught by any kind of investigation.</span></p>
<pre class="lang:default decode:true ">meterpreter&gt; clearev</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-R4KzUt4XxJc/Wjjr1Fj4vtI/AAAAAAAASsI/sDOJzpzow_QZ4iZn4FPjm1J48J4tSdm_ACEwYBhgL/s1600/ev.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
