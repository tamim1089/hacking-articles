<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Windows 7 Sticky Key Hack Attack using Metasploit</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/windows-7-sticky-key-hack-attack-using-metasploit/" rel="bookmark"><time class="entry-date published" datetime="2015-09-14T11:54:26+00:00">September 14, 2015</time><time class="updated" datetime="2025-05-27T12:04:32+00:00">May 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we will learn how to extract login credentials from a victim, who is running a Windows System. Using this technique, we can see the Credentials in plain text.</span></p>
<h3><span style="color: #800000;"><strong>Table of Content:</strong></span></h3>
<ul>
<li><span style="color: #000000;">Introduction to sticky_keys module</span></li>
<li><span style="color: #000000;">Achieve Meterpreter on Remote System</span></li>
<li><span style="color: #000000;">Using sticky_keys module</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Requirements:</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Attacker:</strong> Kali Linux</span></li>
<li><span style="color: #000000;"><strong>Targets:</strong> Windows 7</span></li>
</ul>
<p><span style="color: #000000;"><strong>Introduction to sticky_keys module</strong></span></p>
<p><span style="color: #000000;">This module makes it conceivable to apply the ‘sticky keys’ hack to a session with proper rights. The hack gives a way to get a SYSTEM shell utilizing UI-level communication at an RDP login screen or by means of a UAC affirmation discourse.</span></p>
<p><span style="color: #000000;">The module adjusts the Debug library setting for certain executables. The module choices take into consideration this hack to be connected to:</span></p>
<ul>
<li><span style="color: #000000;">SETHC (exe is invoked when SHIFT is pressed 5 times)</span></li>
<li><span style="color: #000000;">UTILMAN (exe is invoked by pressing WINDOWS+U)</span></li>
<li><span style="color: #000000;">OSK (exe is invoked by pressing WINDOWS+U, then launching the on-screen keyboard)</span></li>
<li><span style="color: #000000;">DISP (exe is invoked by pressing WINDOWS+P).</span></li>
</ul>
<p><span style="color: #000000;">The hack can be included utilizing the ADD activity and expelled with the REMOVE activity. Custom payloads and doubles can be kept running as a component of this endeavor, however, should be physically transferred to the objective before running the module. Naturally, a SYSTEM order brief is introduced utilizing the vault strategy if this module is kept running without changing any parameters.</span></p>
<p><span style="color: #000000;"><strong>Achieve Meterpreter on Remote System</strong></span></p>
<p><span style="color: #000000;">Open Kali Linux terminal and type msfconsole in order to load Metasploit framework.  Now we need to compromise victim’s machine once to achieve any type of session either meterpreter or shell and to do so we can read our previous article from <a style="color: #000000;" href="https://www.hackingarticles.in/msfvenom-tutorials-beginners/">here</a>.</span></p>
<p><span style="color: #000000;"><strong>Using sticky_keys module</strong></span></p>
<p><span style="color: #000000;">After getting meterpreter on the remote system, now time to use the post-exploitation module. But this can’t be done from the meterpreter shell. So, we will use background command in meterpreter session or “Ctrl + z” shortcut to keep the session in background. Now follow the steps shown in the image to use the sticky_keys post exploitation module.</span></p>
<pre class="lang:default decode:true">use post/windows/manage/sticky_keys
set session 5
exploit</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://4.bp.blogspot.com/-3ZdWFwE6FRw/XGpGLHw0ntI/AAAAAAAAcxU/nOt7b42bwhsDii3iWJSWYEdPN7PGY2j3QCLcBGAs/s1600/1.png"/></strong></span></p>
<p><span style="color: #000000;">This will use <strong>the registry_createkey</strong> command to edit the Registry on the remote system and replace the sethc.exe  with the cmd.exe. So the next time when we invoke the sticky keys, instead of getting the sticky keys prompt we will get an Administrator Command Prompt. The good thing about sticky keys is that it can be invoked on the Login Screen without entering a password. In a similar way, it is shown in the given image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-YDKu-hEQXYU/XGpGLcvgYMI/AAAAAAAAcxY/AVgimSKuRo4nNARVmleKouyVQSleO2_EACLcBGAs/s1600/2.png"/></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
