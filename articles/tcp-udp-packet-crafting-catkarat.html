<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">TCP &amp; UDP Packet Crafting with CatKARAT</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/tcp-udp-packet-crafting-catkarat/" rel="bookmark"><time class="entry-date published updated" datetime="2018-01-03T06:28:28+00:00">January 3, 2018</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends ! in our <a style="color: #000000;" href="http://www.hackingarticles.in/packet-crafting-colasoft-packet-builder/"><strong>previous</strong></a> article we had described packet crafting using colasoft packet builder. Again we are going to use a new tool “Cat KARAT” for packet crafting to test our network by crafting various kind of network packet.</span></p>
<p><span style="color: #000000;">Cat Karat Packet Builder is a is a handy, easy to use IP4, IP6, IP4/IP6 tunnels, PPPoE, TCP, UDP, ICMPv4, ICMPv6, VRRP, IGMP, ARP, DHCP , OAM, VLAN (Q in Q), MPLS, Spanning tree BPDU and LLDP packet generation tool that allows to build custom packets for firewall or target testing and has integrated scripting ability for automated testing.</span></p>
<p><span style="color: #000000;">This Packet Builder enables the user to specify the entire contents of the packet from the GUI. In addition to building packets. Packet Builder also supports saving packets to packet files and sending packets to the network. It can be used at all kinds of network areas like traffic generator, packet generator or protocol simulator.</span></p>
<p><span style="color: #000000;">This project also provides a packet capture tool. It is designed for use by anyone who wants to inject packets into a network and/or observe packets exiting a network. Usually, packet operation by following a protocol stack is limited to command line interface. With this tool, all user have to do is click the screen, which almost everybody can do</span></p>
<p><span style="color: #000000;"><strong> </strong><strong>From: </strong>http://packetbuilder.net</span></p>
<p><span style="color: #000000;">You can download it from given link above.</span></p>
<p><span style="color: #000000;"><strong>Let’s start!!</strong></span></p>
<p><span style="color: #000000;">As we had discussed in our previous article that there is 4 mode of operation in packet crafting.</span></p>
<ol>
<li><span style="color: #000000;">Packet Assembly</span></li>
<li><span style="color: #000000;">Packet Editing</span></li>
<li><span style="color: #000000;">Packet Playing</span></li>
<li><span style="color: #000000;">Packet Analysis</span></li>
</ol>
<p><span style="color: #000000;">Let start from the first phase is “Packet Assembly” where you need to decide the type of packet and network you want to create among TCP, IP, ICMP, and UDP.</span></p>
<p><span style="color: #000000;">Now when you will run the installed application “Cat KARAT” you will observe three important sections “Interfaces”, “Packet flow” and Packet view which in their default state as shown in given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-UxGwIxhPleY/Wkxwqiu9Q3I/AAAAAAAAS9U/ujm-bCs3mUwBGwbUT95oZWqpBaIhIErCwCEwYBhgL/s1600/1.png"/></span></p>
<h3><span style="color: #800000;"><strong>TCP-SYN Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">So as we know in <strong>Packet Assembly</strong> phase we need to decide protocol for crafting any packet, which is quite easy to select with this tool. Only enable the radio button for selecting protocol and direction flow of packet. Here I had enabled radio buttons for “IPv4” and “TCP” without disturbing remaining default packet flow as shown given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Kgu3X-PcpP4/WkxwuYiHw6I/AAAAAAAAS-Y/Baoi0hmZHfAshkVPmWAiObE3W3fO2xKowCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Next, we need to select the interface which you can select from the second sections of Interfaces by double-Click on it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-UxCJswJEMFo/Wkxwug9TuqI/AAAAAAAAS-U/ZDjKgNaMoqcoTaBPxeE3n5ipLzYyoYqTwCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Now next is <strong>packet Editing</strong> phase where you need to specify the source IP address such as <strong>192.168.1.11</strong> from which packet will be sent and Destination IP address such as <strong>192.168.1.12</strong> on which packet is received. Moreover, you can also make some changes in your packet such as Time to live (TTL), Data length and also can go with packet fragmentation.</span></p>
<p><span style="color: #000000;">From given below image you can observe I had added source and destination IP in the packet under the third section <strong>protocol view -&gt; Ipv4</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-26arOPJew6o/Wkxwu9L8a1I/AAAAAAAAS-U/YgS8jgI2aQI6L9EUbCMG7n2Sc_P7U4fYACEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">As we know TCP protocol uses TCP-flag for communication to established connection with Destination IP. Therefore we are crafting TCP-SYN packet under the third section <strong>protocol view -&gt; TCP</strong> by enabling sync sequence option which flows from source port 80 to destination port 80.</span></p>
<p><span style="color: #000000;">Once everything is edited then your packet is ready to send on the target network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-eIifmnVMNRg/WkxwvcWHxNI/AAAAAAAAS-U/Sn7QGZOwek4U4YiXtvcl-db-Gxy5qWLKwCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;"><strong>Click</strong> on <strong>play </strong>button given in menu bar for sending the packet on target’s network.</span></p>
<p><span style="color: #000000;">As we know after finishing packet editing operation we need to send it on target network which is known as “<strong>Packet Playing</strong>” in this mode we actually test packet Assembly and packet Editing mode if show packet is sent successfully else again we send a packet in packet Editing mode for modification.</span></p>
<p><span style="color: #000000;">From given below image you can observe the result “<strong>Packet sent successfully”</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-YQFRh78R1NU/WkxwvW7N94I/AAAAAAAAS-U/IrK8ir5B0ckuhCZ6HbvbQNXA-xwogWnnwCEwYBhgL/s1600/6.1.png"/></span></p>
<p><span style="color: #000000;">The last phase is <strong>the Packet Analysis</strong> mode where the received packet is analysis using packet analysis tool. Here we had to use Wireshark for capturing incoming traffic. Hence from given below image, you can observe that Wireshark has captured exactly the same information which we had a bind in the packet during packet Assembly and packet Editing modes such as TCP protocol and TCP-SYN packet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Jk8tnkII7Rs/WkxwvsG-D1I/AAAAAAAAS-Y/M3IO1XCkzEUu3UoGV7zUEBDBQ6Zov6IAwCEwYBhgL/s1600/7.png"/></span></p>
<h3><span style="color: #800000;"><strong>TCP-RST Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">So the Packet Assembly phase and Packet Editing phase for TCP–RST packet crafting is almost the same as above only the difference is made in change TCP-Flag through which connection will be established with target network.</span></p>
<p><span style="color: #000000;">Since we want to send traffic through only reset packets for establishing a connection with the target network, therefore, enable the checkbox of <strong>Reset connect</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-FoNkVJtj47M/WkxwwJ54MpI/AAAAAAAAS-Y/BwUduQjbgnUen9UcOJqVxFqHINsC7wjjQCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;"><strong>Click</strong> on <strong>play</strong> button given in menu bar for sending the packet on target’s network which is part of Packet playing mode.</span></p>
<p><span style="color: #000000;">From given below image you can observe the result “<strong>Packet sent successfully”</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-TGXAJ9DuTBE/WkxwqquRB_I/AAAAAAAAS-U/66zK92Kp0FosBJgiyx0J5LCs81D_BnJvgCEwYBhgL/s1600/10.1.png"/></span></p>
<p><span style="color: #000000;">Hence from given below image, you can observe that Wireshark has captured exactly the same information which we had a bind in the packet during packet Assembly and packet Editing modes such as TCP protocol and TCP-RST packet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ObWtHd4v2hg/WkxwqgUbuqI/AAAAAAAAS-U/T3D3wEhTmAU0riplgrJyk_mVFoEJgATLQCEwYBhgL/s1600/10.png"/></span></p>
<h3><span style="color: #800000;"><strong>TCP-PSH/ACK Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">So the Packet Assembly phase and Packet Editing phase for TCP–PSH/ACK packet crafting is almost same as above only the difference is made in change TCP-Flag through which connection will be established with target network.</span></p>
<p><span style="color: #000000;">Since we want to send traffic through only Push with Acknowledgement packets for establishing a connection with the target network, therefore, enable the checkbox of <strong>PUSH Function </strong>and <strong>Acknowledgement</strong>.</span></p>
<p><span style="color: #000000;"><strong> </strong><img decoding="async" src="https://1.bp.blogspot.com/-YqWdZN0CJqE/WkxwrgOirrI/AAAAAAAAS-U/BvpQlWgUSwwPcnNg0_yA8si8hxwOltwTQCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;"><strong>Click</strong> on <strong>play</strong> button given in menu bar for sending the packet on target’s network which is part of Packet playing mode.</span></p>
<p><span style="color: #000000;">From given below image you can observe the result “<strong>Packet sent successfully”</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gxLFkgc-ibI/WkxwsDVkofI/AAAAAAAAS-U/LfuiRwnk9HMMqIvruMO6Rzc95486YrjHACEwYBhgL/s1600/13.1.png"/></span></p>
<p><span style="color: #000000;">Hence from given below image, you can observe that Wireshark has captured exactly the same information which we had a bind in the packet during packet Assembly and packet Editing mode such as TCP protocol and TCP-PSH/ACK packet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-yX9b0Idnmbs/WkxwsSNbLaI/AAAAAAAAS-Y/BE05Y5mrI7QiJm4MIyehnIbSX0ULV0SPgCEwYBhgL/s1600/13.png"/></span></p>
<h3><span style="color: #800000;"><strong>UDP Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">Similarly as above in <strong>Packet Assembly</strong> phase, we need to decide protocol for crafting UDP packet, enable the radio button for selecting protocol and direction flow of packet. Here I had enabled radio buttons for “IPv4” and “UDP” without disturbing remaining default packet flow as shown given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-6CkZbAJ8G-M/WkxwsTHn4EI/AAAAAAAAS-U/LHUiB7Zizeo7xiSVKdz1PkAFjGWGdRh5gCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Move into Protocol view section for Packet Editing and enter source and destination IP. I had added source and destination IP in the packet under the third section <strong>protocol view -&gt; Ipv4 </strong>as done above.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RtZ-Ug2sqf8/WkxwtDrk8kI/AAAAAAAAS-U/_n5pXrFjB8kxm8ONy4cPvtzOsf2hkO5sQCEwYBhgL/s1600/15.1.png"/></span></p>
<p><span style="color: #000000;">Now explore the <strong>UDP tab</strong> for design UDP packets as per your requirement, from given below image you can observe default setting details.</span></p>
<p><span style="color: #000000;"><strong>Source port</strong>: 00000</span></p>
<p><span style="color: #000000;"><strong>Destination port:</strong> 00000</span></p>
<p><span style="color: #000000;">Now the UDP traffic will flow from source port 0 to destination port 0.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-MOunOOr2b6w/WkxwtufAAYI/AAAAAAAAS-U/9YcKYtPgCscOws1uIQx5VOOQzyr6bGKmQCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;"><strong>Click</strong> on <strong>play</strong> button given in menu bar for sending the packet on target’s network which is part of Packet playing mode.</span></p>
<p><span style="color: #000000;">From given below image you can observe the result “<strong>Packet sent successfully”</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-QI84jBH0QEw/Wkxwt5t0CII/AAAAAAAAS-U/XCMIjYCIaLgTOpNhruaPKGKrFTLXHHDtwCEwYBhgL/s1600/16.1.png"/></span></p>
<p><span style="color: #000000;">From given below image you can observe that Wireshark has captured exactly same information which we had a bind in the packet during packet Assembly and packet Editing mode such as UDP protocol and from source port 0 to destination 0 of 60 lengths.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gLhe7nY-cgM/WkxwuHUaPKI/AAAAAAAAS-U/jT-R1UKWEXYoWvWJYwCpUutnq159UnuCgCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Rahul Virmani</strong> is a Certified Ethical Hacker and the researcher in the field of network Penetration Testing (CYBERSECURITY).    Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/rahul-virmani-4280666a/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
