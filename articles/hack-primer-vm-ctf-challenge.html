<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Primer VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-primer-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-09-26T08:26:16+00:00">September 26, 2017</time><time class="updated" datetime="2025-06-10T20:30:02+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF challenge known as <strong>Primer</strong>. The credit for making this vm machine goes to “couchsofa” and it is another boot2root challenge where we have to root the VM to complete the challenge. You can download this VM <a href="https://www.vulnhub.com/entry/primer-101,136/#download">here</a>.</span></p>
<p><span style="color: #000000;"><strong>Let’s Breach!!!</strong></span></p>
<p><span style="color: #000000;">Let us start form getting to know the IP of VM (Here, I have it at <strong>192.168.1.115 </strong>but you will have to find our own)</span></p>
<p><span style="color: #000000;"><strong>netdiscover</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-07_EhoIbojw/WcoAoqtPG9I/AAAAAAAARn4/48C8jC1DjLYPe47w8FwwuQLMYzo8LiKmQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Use nmap for port enumeration</span></p>
<p><span style="color: #000000;"><strong>nmap -sV  192.168.1.115</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-pyhRXm6rMdY/WcoArJty_4I/AAAAAAAARos/AMtNjweNNn8f7DBM3EmuRiT14dIIIWCowCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">We found port 80 is open so we open this ip address in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-nDA04Qn-Hak/WcoAtL_NkVI/AAAAAAAARpU/9Whn-qFZ9YUTv5xH8cEjfXrdCIdmln12ACLcBGAs/s1600/3.1.png"/></span></p>
<p><span style="color: #000000;">We use dirb to list the directories and find robots.txt</span></p>
<p><span style="color: #000000;"><strong>dirb http://192.168.1.115/ -w</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-caaU4vDIZBo/WcoAtD-B19I/AAAAAAAARpM/wnkH2YtUbTkuQ-0NZRwPYXIEX84XGXnPQCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Inside the robots.txt we find a link to a page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-tNGfNjgoX7I/WcoAtq0mLdI/AAAAAAAARpY/nRj2lyJXn1oedafnSDFDqb8eXG-tOJ0EwCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We open this link, it leads to page that has a story written on it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9Cb02fBf-2Q/WcoAtpzVfdI/AAAAAAAARpc/Zj89JvSCQosfLjpgEH65O43ulfVMRDdhACLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We take a look at the source code at the and found another link.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IDwvlRqu3jU/WcoAt5Va-MI/AAAAAAAARpg/55-hoFJcd3016S94L_xqBVDbCvSECmbHQCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">When we open the link, we found a link on the page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-qDnYc_Z6khk/WcoAuYGdhyI/AAAAAAAARpo/G4FQe-tI6_09VIwomi5l8k4wStFpb0_hgCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">When we open this link, we are prompted for a password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-PnKVYbHyCn8/WcoAuEcWMkI/AAAAAAAARpk/W1KR5owCP503TtKuYdd9AENVo-vIiaxvwCLcBGAs/s1600/8.1.png"/></span></p>
<p><span style="color: #000000;">We capture the request of this page in burpsuite and and send it to repeater. In the response from the server, we find another link.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-rwiRWKV9jBs/WcoAukcEJtI/AAAAAAAARps/e3t682F382UfC7oZaO38XUZFz239C5duwCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">When we open the link, we find another page that prompts for password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Y-jjvPV-Pd8/WcoAuy9EUDI/AAAAAAAARpw/zwTY--wNRJAcyNOX35unNnBbdhQTv8pxQCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Now we take a look at the url, it looks like md5 so we removed the first and underscore we find something interesting.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-TNAxeSPtHWY/WcoAocevKpI/AAAAAAAARn0/9fiJxT8YqbstTs-38o2rlDDVDiOc1FYcwCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">We find that the url are actually prime numbers converted into md5 hashes. We were at the 7 page, and the hash to that is 17. So we convert 19(next prime number) to md5 hash.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-n1k3kpAIsjU/WcoApI7M2pI/AAAAAAAARoE/0HH7tdw5PUEqmwTdMQ0JcMzT7UoEQEGbwCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">To open the it we add “8_” in front of the hash to complete the url. We open it in our browser and find a page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-g8kDKV3gRGY/WcoApIcKLEI/AAAAAAAARoA/dwLBQY2FUBggecx9fDmuRJM4QtcowWpjgCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">We take a look at the source code and find another url.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-C62Dxn9YNnE/WcoApZ-p8nI/AAAAAAAARoI/mfQ5N86v0hwV7-IlD-Dnb1o130B3K9ytQCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">We open it and find a custom made terminal that uses javascript to execute certain commands.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-1_Jqt6sJs74/WcoAp66SX8I/AAAAAAAARoM/Zi7fzIfUeoktDZ8KJYRSZMU8ox7U8OrtwCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">In the ~/usr/falken/ folder we find a hint, when we take a look at the processes we find a command that we need to run.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-0QEiW86hWJ8/WcoAp4CJIGI/AAAAAAAARoQ/mEnJW16-7JErP2G5e1ujYMHetgYxqCnqACLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">When we run connect <strong>falken@Erebus </strong>It prompts for password. We get a hint from the log files that the password might be related to Joshua. In the logs we find that his date of birth i 6<sup>th</sup> august 1984. We use cupp to create a dictionary file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YqvCdg46vEs/WcoAp8VPT2I/AAAAAAAARoU/exwacb6aD8ArKQimXG7wXET8cxHswcY7wCLcBGAs/s1600/17.1.png"/></span></p>
<p><span style="color: #000000;">We use burpsuite to bruteforce the password, we find that <strong>joshua1984</strong> is the password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KM4n5jG-A9s/WcoAqR72fEI/AAAAAAAARoc/bY004mdtCqozCRVXQJNkrQTMqfyX8ybKwCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">When we login, we find a page again with terminal.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-4sLq78k9mdg/WcoAqbrCU5I/AAAAAAAARoY/FWs3BIXB6JcrG4shOw7qV3oXPTB9aNlfgCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">We check the files and find a few log files that are encoded. We use the decode command provided by the terminal to decode the files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-BauCeYI5sT4/WcoAr0uv3QI/AAAAAAAARo0/JvrqGLVfQUMNaL3GuV71ijyGIbg-e43VgCLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;">There we find our next clue, we googled trivial zero and found it was discovered by Riemann. We use cupp to create a dictionary with the given information.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-LlBZ8yrvSbs/WcoArApKoYI/AAAAAAAARoo/ihP5Wl298-MF5k3jxYsh4nQFye5em6rswCLcBGAs/s1600/21.1.png"/></span></p>
<p><span style="color: #000000;">We use burpsuite to bruteforce the password and find it to be Riemann.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-e8SRV1j6V6A/WcoArp-mH3I/AAAAAAAARow/XykkCrihsMMbX7SbxkVbyuhC1ZSkeqIbQCLcBGAs/s1600/21.2.png"/></span></p>
<p><span style="color: #000000;">When we login we are again prompted with another terminal.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-XImJNZfklcg/WcoAr2tju1I/AAAAAAAARo4/4J_Z4kFQY6sOWHj7EaxOxSGRDs8uL02kgCLcBGAs/s1600/22.png"/></span></p>
<p><span style="color: #000000;">When we look through the files we find the md5 encoded string for the usernames. We check for processes and again find a command.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-X5oAN_X0dTU/WcoAsLSUvSI/AAAAAAAARo8/SyGUaX5D45UymsUm5Mwna-wfVgLGd9HogCLcBGAs/s1600/23.png"/></span></p>
<p><span style="color: #000000;">When we crack the md5 password, we find that these are password for the respective username.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-X5oAN_X0dTU/WcoAsLSUvSI/AAAAAAAARo8/SyGUaX5D45UymsUm5Mwna-wfVgLGd9HogCLcBGAs/s1600/23.png"/></span></p>
<p><span style="color: #000000;">When we crack the md5 password, we find that these are password for the respective username.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-CeoMsQFEI-A/WcoAsbhXi_I/AAAAAAAARpA/WAbBDMLci1guOxmurZ2m1VkZs2s-p3WqgCLcBGAs/s1600/24.png"/></span></p>
<p><span style="color: #000000;">When we login, we are again prompted with another terminal.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-CSte-RXqQlE/WcoAsQsSYTI/AAAAAAAARpE/z4sz6ykqA64F67FJVo1rKAwFmrrWKQgMwCLcBGAs/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Looking through the files we find username, password and hostname.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-3vjhY5v8XBQ/WcoAsom9K7I/AAAAAAAARpI/p-jZNXSGhSwFN0d9vxxivuSbQuunhDiXgCLcBGAs/s1600/26.png"/></span></p>
<p><span style="color: #000000;">We use these to login and find a page greeting us the end of the challenge.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-LDJ74OnCgUM/WcoAtCjsZFI/AAAAAAAARpQ/GuZbdB-5UhcaR7HKZ7m80nOLXvaIhD4FACLcBGAs/s1600/27.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
