<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/wireless-penetration-testing/" rel="category tag">Wireless Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Wireless Penetration Testing: Wifipumpkin3</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/wireless-penetration-testing-wifipumpkin3/" rel="bookmark"><time class="entry-date published" datetime="2021-07-28T19:38:41+00:00">July 28, 2021</time><time class="updated" datetime="2025-05-10T17:42:29+00:00">May 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;"><strong>Wifipumpkin3</strong> is a <strong data-start="322" data-end="335">framework</strong> built on <strong data-start="345" data-end="355">Python</strong> to give <strong data-start="364" data-end="394">rogue access point attacks</strong> to <strong data-start="398" data-end="413">red teamers</strong> and reverse engineers. In this article, we will explore how to use <strong data-start="481" data-end="497">Wifipumpkin3</strong> to create a bogus <strong data-start="516" data-end="538">Wi-Fi access point</strong> for our victims to connect. Additionally, we will learn how to exploit the system.</span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<ul>
<li><span style="color: #000000;">Overview</span></li>
<li><span style="color: #000000;">Installing Wifipumpkin3</span></li>
<li><span style="color: #000000;">Using captive portal attack</span></li>
<li><span style="color: #000000;">Generating Custom Captiveflask</span></li>
<li><span style="color: #000000;">Writing pulp file for Wifipumpkin</span></li>
<li><span style="color: #000000;">One-liner attack</span></li>
<li><span style="color: #000000;">DNS Spoof with Wifipumkin</span></li>
</ul>
<h3><span style="color: #800000;">Overview</span></h3>
<p><span style="color: #000000;">wifipumpkin3 is a powerful framework for rogue access point attack, written in Python, that allows and offers to security researchers, red teamers, and reverse engineers to mount a wireless network to conduct a man-in-the-middle attack.</span></p>
<p><span style="color: #000000;">Main Features</span></p>
<ul>
<li><span style="color: #000000;">Rogue access point attack</span></li>
<li><span style="color: #000000;">Man-in-the-middle attack</span></li>
<li><span style="color: #000000;">Module for deauthentication attack</span></li>
<li><span style="color: #000000;">Module for extra-captiveflask templates</span></li>
<li><span style="color: #000000;">Rogue Dns Server</span></li>
<li><span style="color: #000000;">Captive portal attack (captiveflask)</span></li>
<li><span style="color: #000000;">Intercept, inspect, modify and replay web traffic</span></li>
<li><span style="color: #000000;">WiFi networks scanning</span></li>
<li><span style="color: #000000;">DNS monitoring service</span></li>
<li><span style="color: #000000;">Credentials harvesting</span></li>
<li><span style="color: #000000;">Transparent Proxies</span></li>
<li><span style="color: #000000;">LLMNR, NBT-NS and MDNS poisoner (Responder3)</span></li>
</ul>
<h3><span style="color: #800000;">Installing Wifipumpkin3  </span></h3>
<p><span style="color: #000000;">Before we can use this tool, we need to install the dependent packages for this to work use the following command to do that.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">apt install libssl-dev libffi-dev build-essential</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mEfr8fDLWBA/YQFqhESjGII/AAAAAAAAx5U/AW0NH2fuCSo1PZtWPgb2zysTYr5vBY84ACLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Now that we have installed the dependencies, we need to download the tool from GitHub and change the directory to the wifipumpkin3 and install the python dependency.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/P0cL4bs/wifipumpkin3.git  
cd wifipumpkin3
apt install python3-pyqt5</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-AOMSgVCh6q0/YQFqoJnBC6I/AAAAAAAAx5Y/lQ4RBWe8cPEzdSibcBhaA_BcZOwLJI3vACLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Ahh, there are some more packages we would need to import from python</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 -c "from PyQt5.QtCore import QSettings; print('done')"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mERnWUfjX4E/YQFqr53M7dI/AAAAAAAAx5c/JEciut5GBJwMvnhBgQLUOcrJU2oT1of2ACLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">Now that we have completed the previous steps, we want to install the setup file that comes with <strong data-start="746" data-end="762">Wifipumpkin3</strong>. This <strong data-start="769" data-end="779">Python</strong> file installs all the other dependencies that <strong data-start="826" data-end="842">Wifipumpkin3</strong> needs to function properly.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 setup.py install</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iQwjbaI1GlE/YQFqvko90FI/AAAAAAAAx5g/0zk2E6G7Xx0M1rtQ9HBG6Vr7MJEPpNwYgCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Now that we have installed all the tools perfectly let’s get down into using wifipumpkin, the first thing we would do today is to create a fake access point with the name “<strong>Free wifi</strong>”, with this access point we would wait for a victim to connect to the network and also do a man-in-the-middle attack to sniffing packets. we will try to sniff out the post request that may contain users’ credentials like email and password, this would only work with HTTP. Let’s go in to see how this works</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wifipumpkin3
set interface wlan0
set ssid Free Wifi
set proxy noproxy
ignore pydns_server
start</pre>
<p><span style="color: #000000;">After we start the fake <strong data-start="922" data-end="938">access point</strong>, we notice that several protocols have also started. These protocols, consequently, assist in capturing <strong data-start="1043" data-end="1068">sensitive information</strong> transmitted over the <strong data-start="1090" data-end="1101">network</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pBk_CF0OdKo/YQFqz21dTDI/AAAAAAAAx5k/P8i-rz_vOiMNyzWeN9q3AWJfTbMj9_7IQCLcBGAsYHQ/s16000/20.png"/></span></p>
<p><span style="color: #000000;">From our second device, we will find the SSID for bogus AP, when the victim connects to this he will receive malicious IP from our DHCP server.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-S2HGG6osj2g/YQG137ChLZI/AAAAAAAAx90/f3RkQL6sulgY8LSP7MoSHY6qB0vDPcSugCLcBGAsYHQ/s16000/22.png"/></p>
<p><span style="color: #000000;">From our second device, we could go to an HTTP page that doesn’t have SSL (secured socket layer ) with this whatever information like email, username, or password entered we would be able to view the text entered by the victim.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-9w3rLMdXtuY/YQG1_7NdfCI/AAAAAAAAx94/UQ1t9ytBMokOuL3qTdjwjUyG3DxcgApdwCLcBGAsYHQ/s16000/23.png"/></p>
<p><span style="color: #000000;">Wifipumkin capture the traffic and the credentials which were entered by the victim</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-J66qb07eXcM/YQFrDJVCg7I/AAAAAAAAx54/k_fBLSzNETsONR8uqFklL0PAE7K2VWGiQCLcBGAsYHQ/s16000/24.png"/></span></p>
<h3><span style="color: #800000;">Using captive portal attack with wifipumpkin</span></h3>
<p><span style="color: #000000;">Like the first attack, we executed we saw that that had free Wi-Fi and didn’t have security for the access point, but in this, we would have a secure page where the victim would have to enter a username and password for the Wi-Fi, we could use this when we are doing evil twin attack. Now let’s get down to see how we could do this and create a captive portal using wifipumpkin.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set interface wlan0
set ssid Hotspot
set proxy captiveflask true
ignore pydns_server
start</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-a3kouU7Dm7g/YQFrK7vokpI/AAAAAAAAx6E/YblBbe_2m8s2luDs8u3GRKM1CEL54v7HACLcBGAsYHQ/s16000/39.png"/></span></p>
<p><span style="color: #000000;">Bellow, we can see that the access point that we have created has started and now we can connect to it from our second device</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-eZZQQ_m-JE8/YQG2FepO1vI/AAAAAAAAx98/772tr0r5l6M0MckgSO97iPXgJEFQwQM_ACLcBGAsYHQ/s16000/40.png"/></p>
<p><span style="color: #000000;">Immediately after we connect on our second device, we get directed to a <strong data-start="1202" data-end="1216">login page</strong>. Here, we must enter the <strong data-start="1242" data-end="1260">Wi-Fi username</strong> and <strong data-start="1265" data-end="1277">password</strong> before we can access the internet.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-W7qnkmw6cqc/YQG2JREN3yI/AAAAAAAAx-E/PG5J614K6To1N7yBRL1xoAtFP2AN1-xrQCLcBGAsYHQ/s16000/41.png"/></p>
<p><span style="color: #000000;">From this page, we observe that <strong data-start="1372" data-end="1388">Wifipumpkin3</strong> captures the <strong data-start="1402" data-end="1414">username</strong> and <strong data-start="1419" data-end="1431">password</strong> we entered. Subsequently, this <strong data-start="1463" data-end="1478">information</strong> gets displayed neatly in a <strong data-start="1506" data-end="1522">table format</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lO332Jbu3Ns/YQFrgFunxvI/AAAAAAAAx6Y/sdpEAN7BxHUeVUiEPAWvYrt14d9HFmItACLcBGAsYHQ/s16000/42.png"/></span></p>
<h3><span style="color: #800000;">Generate Custom Captiveflask</span></h3>
<p><span style="color: #000000;">With wifipumpkin we can use another captive flask than the generic one which we used in the last attack in the following screenshot. It allows us to generate custom templates for a captive flask attack to phish your target.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">show
use misc.extra_captiveflask
help
download</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9dCNr-_BeEk/YQFrlIbh2tI/AAAAAAAAx6g/YpfOoTpFUHgH1Cp_DiqULcJn58CI21q2ACLcBGAsYHQ/s16000/43.png"/></span></p>
<p><span style="color: #000000;">Now we would like to use the Facebook captive flask which we need to download as the last screenshot showed</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">list
install facebook</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gl7kEBsf6Iw/YQFrqL8a95I/AAAAAAAAx6k/UCDvyXTKcM83HxL9phXNh0xYTZQjmRTQgCLcBGAsYHQ/s16000/44.png"/></span></p>
<p><span style="color: #000000;">Some dependencies would need to be downloaded for us to use the customized captive flag. which would be shown below</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic"> sudo python3 setup.py install</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-omECbk-LAJc/YQFrt1632aI/AAAAAAAAx6o/1LoXGd5_s1UQV3B-aObWwi2EKtXRf7gQACLcBGAsYHQ/s16000/45.1.png"/></span></p>
<p><span style="color: #000000;">Now let’s get into it and see how we can use the customized captive flask we have downloaded, we would still use the commands we use in the previous attack but just adding the customized captive flask which we downloaded</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set interface wlan0
set ssid Open Wifi
set proxy captiveflask
set captiveflask.facebook true
ignore pydns_server
start</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ulZ0jQbzoPE/YQFrzhM5DZI/AAAAAAAAx6w/vYNM5lQxzJ00sk4aiq1VhcI8c9Usg_H2ACLcBGAsYHQ/s16000/45.png"/></span></p>
<p><span style="color: #000000;">From our second service, we need to connect to the ssid “open wifi”</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-mIXAnxOTIi4/YQG2PT5DOiI/AAAAAAAAx-I/6VHoTX9xkrozuF1FlIXsJsIYO5GDtRFHQCLcBGAsYHQ/s16000/46.png"/></p>
<p><span style="color: #000000;"> Now that we have connected to the <strong data-start="1585" data-end="1593">SSID</strong> and redirected to the login homepage, we notice an important change. Unlike last time, the page now shows a cloned <strong data-start="1709" data-end="1732">Facebook login page</strong> where a victim can enter his <strong data-start="1762" data-end="1777">credentials</strong>, and <strong data-start="1783" data-end="1799">Wifipumpkin3</strong> captures them.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-md7HPxTAJ6o/YQG2TfOi2LI/AAAAAAAAx-M/wI6Or4Dz544kiwjMNq3EvyuCdww_02pHwCLcBGAsYHQ/s16000/47.png"/></p>
<p><span style="color: #000000;">From the below screenshot credentials has been taken and printed on the attacker’s screen</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vO6ZPlu7Y_U/YQFsDystTQI/AAAAAAAAx7A/-72BJLcOmc0NEyEdS4sBDPbBujT05NX6wCLcBGAsYHQ/s16000/48.png"/></span></p>
<h3><span style="color: #800000;">Writing pulp for Wifipumkin</span></h3>
<p><span style="color: #000000;">At times as hackers we would like to make things easier for us and faster one way, we could do this not only with this tool but legitimate everything is to write a script that automates all the commands we would like to input into the program. below we would use the command “nano” to create a file which we have written the command we need to input into wifipumpkin . we need to also make sure that the extension of the file is pulp because that is how wifipumpkin would be able to read the script</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ErUf139F9VY/YQFsJay4H2I/AAAAAAAAx7I/-e8omlpk-HQ_ZgD5K6lsqnvmoJZ3u5KLQCLcBGAsYHQ/s16000/75.png"/></span></p>
<p><span style="color: #000000;">Now that we have created the pulp extension script we just need to call up wifipumpkin with the extension of where the script is located</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_ngbu-ftG_c/YQFsNJ9o5NI/AAAAAAAAx7M/s3e2embqLHwjsYU4Fax_wI19Z9QjELARwCLcBGAsYHQ/s16000/76.png"/></span></p>
<h3><span style="color: #800000;">One-liner Attack</span></h3>
<p><span style="color: #000000;">Just like we created a script to run our commands we can also do that by writing all the requests in one line.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wifipumpkin3 --xpulp "set interface wlan0; set ssid nisha; set proxy noproxy; start"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qN0vpAn-7t4/YQFsSOnTY_I/AAAAAAAAx7Q/KYB31_GTMnk9XSFSz8eHhFc6gLx5mxj4gCLcBGAsYHQ/s16000/77.png"/></span></p>
<p><span style="color: #000000;">Here we another SSID as Nisha.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-XBmRKBdpCUA/YQG2ZADbmiI/AAAAAAAAx-Y/dJN2uJRTIN8YLwnY3vG9EwMG2Ts8blwygCLcBGAsYHQ/s16000/78.png"/></p>
<h3><span style="color: #800000;">DNS Spoofing with wifipumpkin</span></h3>
<p><span style="color: #000000;">Just as we can use the customized flask which is in the tool we could also use the Html document which we have created and would like to use for the attack on a user. Bellow we would see that we are in the “www” “HTML” directory here is where any HTML file which we need to use for a website is located, we would create an HTML file which displays “welcome to the hacking article” below we would see the walkthrough on how to do this.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rd6qF4v5DjA/YQFscs8lDKI/AAAAAAAAx7c/qgaJtuapmdM6cDX-bfMNaSds9gIVP2lrACLcBGAsYHQ/s16000/80.png"/></span></p>
<p><span style="color: #000000;">Now that we have created the HTML file and know the Ip address for our ethernet cable lets go into wifipumpkin and try to add this new HTML file to our command and see how we can spoof the DNS server so that when we visit the site the DNS server will spoof it to the page which we want it to be</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set interface wlan0
set ssid HA
set proxy noproxy
ignore pydns_server
show
use spoof.dns_spoof
set domains vulnweb.com
set redirectTo 192.168.1.2
start</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nkGhXw88Hxc/YQFshpP6UmI/AAAAAAAAx7k/XDCuKIElMsYxEkS_PPv1759lRTcFpcR9gCLcBGAsYHQ/s16000/81.png"/></span></p>
<p><span style="color: #000000;">Now that the attack has started we can now connect to the ssid “HA” . and when the victim visits the “vulweb.com” he would be redirected by the DNS server to the page which we created on our attacking machine.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-h3xFUH0DL0M/YQG2f0TCIOI/AAAAAAAAx-g/HrlxQlatvcAEK6ADtqlv73D_8ICDYz6KwCLcBGAsYHQ/s16000/82.png"/></p>
<p><span style="color: #000000;">Below shows the HTML file which we created and how the DNS server spoof the webpage “vulweb.com” to the one we wanted.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-cPTUaeIDPDo/YQG2lhLzPnI/AAAAAAAAx-o/XJICU5FtcHIKsXHBgv7fGLpPPmHD_-gpQCLcBGAsYHQ/s16000/83.png"/></p>
<p><strong>Author</strong>: Tolu Badero is an infosec researcher, SOC analyst, and love gadgets .contact <span style="color: #0000ff;"><strong>here</strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
