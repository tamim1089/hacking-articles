<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Seppuku:1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/seppuku1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-06-06T10:44:18+00:00">June 6, 2020</time><time class="updated" datetime="2025-06-10T20:10:29+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to crack this machine called ‚ÄúSeppuku:1‚Äù. It is available on Vulnhub for the purpose of Penetration Testing practices. It was an intermediate box which made me learn many new things. This credit of making this lab goes to SunCSR Team. Let‚Äôs start and learn how to successfully breach it.</span></p>
<p><span style="color: #000000;">Level:¬† Intermediate to Hard</span></p>
<p><span style="color: #000000;">Since these labs are available on the Vulnhub Website. We will be downloading the lab file from this <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/seppuku-1,484/">here</a></strong></span></span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<ul>
<li><span style="color: #000000;"><strong>Netdiscover</strong></span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Abusing HTTP Services</span></li>
<li><span style="color: #000000;">Dirb</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Brute forcing using hydra</span></li>
<li><span style="color: #000000;">Connecting using SSH</span></li>
<li><span style="color: #000000;">Bypassing Restricted shell</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Abusing Sudo</span></li>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<p><span style="color: #000000;">As you know, this is the initial phase where we choose <strong>netdiscover</strong> for network scan for identifying host IP and this we have <strong>192.168.1.104</strong> as our host IP.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-n82o57ad9sI/Xttw_JPxMKI/AAAAAAAAkco/tD3aqneQgNUbaeSMwGAFwh0VsU58v6dQgCLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Then we used nmap for port enumeration. We found that port 21 for ftp, port 22 for ssh, port 80 for http, 139 and 445 for NetBIOS-ssn, port 7080 for SSL/http, port 7601 for http, port 8088 for http.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.104</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_YsL9j4g6FE/XttxAJHz0JI/AAAAAAAAkc4/3IWyO3wX0V8xOmubXf6DFEfVJEmbFHVsACLcBGAsYHQ/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">For more detail, we will be needing to start enumeration against the host machine. Since port 7601 is open I look toward browser and explore target ip 192.168.1.104 ¬†but unfortunately found nothing useful.</span></p>
<pre class="lang:default decode:true">http://192.168.1.104:7601</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Z_XBL2DPNt8/XttxATu4T4I/AAAAAAAAkc8/HN_y5AMONdITf3ZdyJnNlep8YIkHtKexACLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Further, we use dirb for directory brute-forcing and found <strong>secret </strong>&amp;<strong> key</strong> with status code 200 OK on executing following command.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.104:7601</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LpZ1ZkkoKqg/XttxAl13XsI/AAAAAAAAkdA/Jv5GQsGcEB893PXg_Tczgra7UIyFu9llACLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">When we navigate URL enumerated above, i.e. keys we found some files, here private was useful for us.</span></p>
<pre class="lang:default decode:true">http://192.168.1.104:7601/keys</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iws6f6UvrAM/XttxA94NbDI/AAAAAAAAkdE/TgP-14iBjm0ojFvQnJTL2U7Z30Bl79BYwCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">This link leads us to a page called private. This is a private key for some user which we have not found yet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Gz29u8KJdHQ/XttxA-RnIzI/AAAAAAAAkdI/jMZswtDkkiQt5m0AYgs8yd109AU63KczwCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Further, we will explore our next directory called secret which we found in our dirb scan.</span></p>
<pre class="lang:default decode:true">http://192.168.1.104:7601/secret</pre>
<p><span style="color: #000000;">AS result it gives some very important files such as password.lst and hostname.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2sKu8dLemR0/XttxBfzV96I/AAAAAAAAkdM/4QFn7AxEhXkkxWZWoaeVGog_y9lUGg4IwCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Here found a file named hostname which gave us a username i.e. seppuku.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-68wfWRqRV3Y/XttxBfnY_1I/AAAAAAAAkdQ/Yn51XSsRPZsnP1JnaW-0pK-gnpCJWa68QCLcBGAsYHQ/s1600/8.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploiting </strong></span></h3>
<p><span style="color: #000000;">We have got username seppuku , now our next job is to find the password for the user seppuku with the help of hydra for SSH login brute force. Here the best way to guess password is to use the password file which we found in the secret directory during dirb scan.</span></p>
<pre class="lang:default decode:true">hydra -l seppuku -P /root/Desktop/password.lst 192.168.1.104 ssh</pre>
<p><span style="color: #000000;">From its result, we found the password eeyoree for seppuku.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DuPu24VbAb4/XttxBnk8xdI/AAAAAAAAkdU/nzsQp-jw4vY-LH0TtwcyApPfYVnLocNXQCLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">We have a username and password, so we tried to access the SSH on the target system and we were successfully able to log in.</span></p>
<pre class="lang:default decode:true">ssh seppuku@192.168.1.104</pre>
<p><span style="color: #000000;">¬†After getting logged in let‚Äôs go for further investigation to find some hidden files. As a result, we found a hidden file called <strong>.passwd</strong> which gave us a password for what we don‚Äôt know right now.</span></p>
<p><span style="color: #000000;">After that, we tried to go inside the home directory, but we were not able to do so because of restricted rbash shell. ü§î</span></p>
<pre class="lang:default decode:true">ls -la
cat .passwd
cd /home</pre>
<p><span style="color: #000000;">Since we know the ssh credentials of the user who is part of rbash shell, then you can use the following command along ssh to break the jail and bypass the rbash by accessing proper bash shell.</span></p>
<pre class="lang:default decode:true">ssh seppuku@192.168.1.104 -t "bash --noprofile"</pre>
<p><span style="color: #000000;">Now we will again try to access the home directory this time we were successful in doing so. Now we will again check the hidden files where we found 2 new users named <strong>samurai </strong>and <strong>tanto</strong>.</span></p>
<p><span style="color: #000000;">So let‚Äôs dive in by getting logged in as <strong>samurai</strong> with the password we found in .<strong>passwd</strong> hidden file.</span></p>
<pre class="lang:default decode:true">cd /home
su samurai</pre>
<p><span style="color: #000000;">Let us use the sudo -l command to enumerate if this user can run some application with root privileges.</span></p>
<pre class="lang:default decode:true">sudo -l</pre>
<p><span style="color: #000000;">¬†We found seppuku user can run .cgi_bin/bin command as the samurai user which suppose have the root access.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9zgxDlLTtPc/Xttw_V1hNAI/AAAAAAAAkcw/g69IwywzTocT3mYGXgJ8OrYThPRVglqewCLcBGAsYHQ/s1600/10.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">If you remembered we have enumerated private key when while performing directory brute force, here I copied the content of private file found in key during dirb scan and saved it into an empty file named sshkey with chmod 600 permissions.</span></p>
<pre class="lang:default decode:true">chmod 600 sshkey</pre>
<p><span style="color: #000000;">Since we port 22 open on the target machine, we will try to connect the target machine using this key for user TANTO and execute the following command.</span></p>
<pre class="lang:default decode:true">ssh -i sshkey tanto@192.168.1.104 -t "bash ‚Äìnoprofile"
ls -la</pre>
<p><span style="color: #000000;">After login as tanto, we looked for .cgi_bin directory that will be executed through sudo user but unfortunately, I was unable to find this directory, therefore, I made a directory as .cgi_bin and save the bash script in a file named as ‚Äúbin‚Äù to get bash shell through it.</span></p>
<pre class="lang:default decode:true">mkdir .cgi_bin
cd .cgi_bin/
echo "/bin/bash" &gt; bin
chmod 777 bin
ls -la</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-U-AiM4EP2Zs/Xttw_RJ4-oI/AAAAAAAAkcs/_s2jcOfPXvkF-rwJ1un1xG-C3KMwf4M-gCLcBGAsYHQ/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now it was time to exploit .cgi_bin program, thus again we logged as Samurai and run the following command and obtain the root shell and finished the challenge by capturing the root flag üö©.¬†</span></p>
<pre class="lang:default decode:true">sudo ../../../../../../../home/tanto/.cgi_bin/bin /tmp/*
cd /root
ls
cat root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7vjY4kvOq8Q/Xttw_-jCRPI/AAAAAAAAkc0/TJyfm_7ZY9or3mvHcamhsJsjY24gbeRnACLcBGAsYHQ/s1600/12.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Japneet Kaur Gandhi¬†</strong>is a Technical Writer, Researcher and Penetration Tester.<strong>¬†Contact¬† <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/japneet-gandhi/">here</a></span></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
