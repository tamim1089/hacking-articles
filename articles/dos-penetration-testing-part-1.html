<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/others/" rel="category tag">Others</a>, <a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">DOS Attack Penetration Testing (Part 1)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/dos-penetration-testing-part-1/" rel="bookmark"><time class="entry-date published updated" datetime="2017-12-24T18:46:56+00:00">December 24, 2017</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to describe DOS/DDOS attack, here we will cover What is dos attack; How one can lunch Dos attack on any targeted network and What will its outcome and How victim can predict for Dos attack for his network.</span></p>
<p><span style="color: #000000;"><strong>Requirement</strong></span></p>
<p><span style="color: #000000;"><strong>Attacker machine:</strong> Kali Linux</span></p>
<p><span style="color: #000000;"><strong>Victim machine:</strong> Ubuntu</span></p>
<p><span style="color: #000000;"><strong>Optional:</strong> Wireshark (we have added it in our tutorial so that we can clearly confirm all incoming and outgoing packet of the network)</span></p>
<h3><span style="color: #800000;"><strong>What is DOS/DDOS Attack</strong></span></h3>
<p><span style="color: #000000;">From Wikipedia</span></p>
<p><span style="color: #000000;">A <strong>denial-of-service attack</strong> (DoS attack) is a cyber-attack where the attacker looks for to make a machine or network resource unavailable to its deliberated users by temporarily or indefinitely services of disturbing a host connected to the Internet. Denial of service is usually accomplished by flooding the targeted machine or resource with excessive requests in an attempt to overload systems and prevent some or all legitimate requests from being fulfilled.</span></p>
<p><span style="color: #000000;">In a <strong>distributed denial-of-service attack</strong> (DDoS attack), the incoming traffic flooding the victim originates from many different sources. A DoS or DDoS attack is analogous to a group of people crowding the entry door or gate to a shop or business, and not letting legitimate parties enter into the shop or business, disrupting normal operations.</span></p>
<p><span style="color: #000000;">Basically, the attacker machine either himself sends infinite request packets on the target machine without waiting for reply packet form target network or uses bots (host machines) to send request packet on the target machine. Let study more above it using given below image, here you can observe 3 Phases where <strong>Attacker</strong> <strong>machine </strong>is placed at the<strong> Top</strong> while <strong>Middle</strong> part holds <strong>Host machine</strong> which is control by attacker machine and at <strong>Bottom</strong>, you can see <strong>Target</strong> machine.</span></p>
<p><span style="color: #000000;">From given below image you can observe that the attacker machine want to send ICMP echo request packet on the target machine with help of bots so this will increase the number of attacker and number of request packet on the target network and cause traffic Flood. Now at that time, the targeted network gets overloaded and hence lead some service down then prevent some or all legitimate requests from being fulfilled.</span></p>
<h3><span style="color: #800000;"><strong>DOS/DDOS Categories</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Volume Based Attack</strong>: The attack’s objective is to flood the bandwidth of the target networks by sending ICMP or UDP or TCP traffic in per bits per second.</span></li>
<li><span style="color: #000000;"><strong>Protocol-Based Attack: </strong>This kind of attack focus actual target server resources by sending packets such TCP SYN flood, Ping of death or Fragmented packets attack per second to demolish the target and make it unresponsive to other legitimate requests.</span></li>
<li><span style="color: #000000;"><strong>Application Layer Attack: </strong>Rather than attempt to demolish the whole server, an attacker will focus their attack on running applications by sending request per second, for example, attacking WordPress, Joomla web server by infinite request on apache to make it unresponsive to other legitimate requests.</span></li>
</ul>
<p><img decoding="async" src="https://4.bp.blogspot.com/-u-rLzuFgza8/WkCT3Z2MqJI/AAAAAAAAS0o/RCnaH2pFilQt2ApYGTU7A16_-lb1y05IQCLcBGAs/s1600/0.png"/></p>
<p> </p>
<h3><span style="color: #800000;"><strong>How to Perform a DOS Attack?</strong></span></h3>
<p><span style="color: #000000;">If you are aware of OSI 7 layers model then you may know that whenever we send a request packet to the server for accessing any particular service, for example, browsing Google.com then this process executes by passing through 7 layers of OSI model and at last we are able to access Google.com on the browser.</span></p>
<p><span style="color: #000000;">Now suppose port 80 is open in target’s network (192.168.1.107) for accessing its HTTP services so that you can open their website through your browser and get the information available in those web pages. So basically attacker plan to slow down HTTP service for another user who wants to interact with target machine through port 80 as result server will not able to reply the other legitimate requests and this will consider as Protocol Dos attack.</span></p>
<p><span style="color: #000000;">An attacker can use any tool for DOS attack but we are using Hping3 for attacking to generate traffic flood for the target’s network to slow down its HTTP service for other users.</span></p>
<pre class="lang:default decode:true">hping3 -F --flood -p 80 192.168.1.107</pre>
<p><span style="color: #000000;">Above command will send endless request packet per second on port 80 of the target’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-hwnvJ_9MiWc/Wj_iQ_ICpsI/AAAAAAAASwg/orcvVxoPTo899M2X5RuFKwFyIagWulMLwCEwYBhgL/s1600/1.1.png"/></span></p>
<p><span style="color: #800000;"><strong>What will the Effect of Dos Attack?</strong></span></p>
<p><span style="color: #000000;">As we had described that any kind of Dos attack will affect the server services to their users and clients in establishing a connection with it. Here also when we had sent infinite request packet on port 80 of target’s network then it should make HTTP service unable for legitimate users.</span></p>
<p><span style="color: #000000;">So now if I will explore target IP on your browser for accessing their web site as a legitimate user then you can observe that the browser is unable to connect with the server for HTTP services as shown in given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-41kVvLj9FL8/Wj_iQ4FXhGI/AAAAAAAASwY/cMKy-_67ErASMCnfTvPkD6fe65ih0KHwQCEwYBhgL/s1600/1.2.png"/></span></p>
<p><span style="color: #000000;"><strong>How to Predict DOS Attack in Our Network?</strong></span></p>
<p><span style="color: #000000;">Configure IDS in your network which will monitor the incoming network traffic on your network and generates the alert for suspicious traffic to system administrators. We had install Snort on the system (ubuntu: 192.168.1.107) as NIDS (Network Intrusion Detection System) kindly read our previous both articles related to Snort Installation (<a style="color: #000000;" href="http://www.hackingarticles.in/ids-ips-penetration-testing-lab-setup-snort/"><strong>Manually</strong></a> or using <a style="color: #000000;" href="https://www.hackingarticles.in/comprehensive-guide-on-snort-part-1/"><strong>apt-respiratory</strong></a>)and its <a style="color: #000000;" href="https://www.hackingarticles.in/comprehensive-guide-on-snort-part-1/"><strong>rule configuration</strong></a> to enable it as IDS for your network.</span></p>
<h3><span style="color: #800000;"><strong>TCP SYN Flood</strong></span></h3>
<p><span style="color: #000000;">Execute given below command in ubuntu’s terminal to open snort local rule file in text editor.</span></p>
<p><span style="color: #000000;"><strong>sudo gedit /etc/snort/rules/local.rules</strong></span></p>
<pre class="lang:default decode:true">alert tcp any any -&gt; 192.168.1.107 any ( msg:"SYN Flood Dos"; flags:S; sid:1000006; )</pre>
<p><span style="color: #000000;">Above rule will monitor incoming TCP-SYN packets on 192.168.1.107 by generating alert for it as “SYN Flood Dos”. Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-n9vwJcgCs6k/Wj_iR-mv7zI/AAAAAAAASww/NGALKrFiu1oObMS6VXbK4FC4eXFd3GRtwCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Now test the above rule by sending infinite SYN packet using the attacker’s machine. Open the terminal and enter <strong>msfconsole</strong> for Metasploit framework and execute given below command to run the syn flood exploit.</span></p>
<p><span style="color: #000000;">This exploit will send countless syn packets on the target’s network to demolish its services.</span></p>
<pre class="lang:default decode:true">use auxiliary/dos/tcp/synflood
msf auxiliary(synflood) &gt; set rhost 192.168.1.107 (target IP)
msf auxiliary(synflood) &gt; set shost 192.168.1.105 (attacker’s IP )
msf auxiliary(synflood) &gt; exploit</pre>
<p><span style="color: #000000;">We have set shost for attacker’s IP only for tutorial else it was optional or you can address any random IP of your network, now can see SYN flood has been launched on port 80 by default it is considered as <strong>Protocol Based Dos Attack</strong> as described above.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Y3q_6zBNrB4/Wj_iWfSxJ8I/AAAAAAAASyA/Z2A-I3lH2IUk6xPTewswG02WUnC9l2NRgCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">As I had declaimed above why we are involving Wireshark in this tutorial so that you can clearly see the packet sends from an attacker network to targets network. Hence in given below image, you can notice endless SYN packet has sent on target’s network on port 80.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-8TsWP2cYd20/Wj_iZ-avgrI/AAAAAAAASzU/sksPW2FVk4IIdbpRD0GCiHN0KDiPNVGTQCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Come back to over your target machine where you will notice that snort is exactly in same way capturing all incoming traffic here you will observe that it is generating <strong>alerts </strong>for “SYN Flood Dos”.  Hence you can block the attacker’s IP (192.168.1.105) to protect your network from discard all further coming packets toward your network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-RZR3Ux4CWo0/Wj_ib7PxczI/AAAAAAAASz4/nnUhuVME9qszwsoas-qu_1DVeFTFPFJQgCEwYBhgL/s1600/4.png"/></span></p>
<h3><span style="color: #800000;"><strong>UDP Flood </strong></span></h3>
<p><span style="color: #000000;">Now again open local rule files for generating alert for UDP flood Dos attack and enter given below rule and save the file.</span></p>
<pre class="lang:default decode:true">alert udp any any -&gt; 192.168.1.107 any (msg: "UDP Flood Dos"; sid:1000001; )</pre>
<p><span style="color: #000000;">The above rule will monitor incoming UDP packets on 192.168.1.107 by generating alert for it as “UDP Flood Dos”. Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-cDrdf-dmVuY/Wj_iccSILmI/AAAAAAAAS0E/2z9FTkjGlo0bjwhHPt3QInnFkxJNoU2QwCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">We are using Hping3 for attacking to generate traffic flood for target’s network to slow down its UDP service for other users it is considered as <strong>Volume Based Dos Attack</strong> as described above.</span></p>
<pre class="lang:default decode:true">hping3 --udp --flood -p 80 192.168.1.107</pre>
<p><span style="color: #000000;">Above command will send endless bits packet per second on port 80 of the target’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-afklHMUhMyU/Wj_ic8O_nQI/AAAAAAAAS0M/e6JqNQv4i0AY_vWQQT4Vp-TX3YbxHUwcwCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">From given below image you can observe Wireshark has captured UDP packets from 192.168.1.105 to 192.168.1.107</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-K4dLnlBqsDM/Wj_idFTWKkI/AAAAAAAAS0Q/ZptW69nQ6VMYTS9KTsez2gNOXLIYUudJwCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Come back to over your target machine where snort is capturing all incoming traffic here you will observe that it is generating alert for UDP Flood Dos attack. Hence you can block the attacker’s IP to protect your network from further scanning.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-t_FR9B4egFE/Wj_iSIfRd9I/AAAAAAAASw4/qn4Bj7OYaHYFmqVfpoR6MhQvSVP6n-l3wCEwYBhgL/s1600/10.png"/></span></p>
<h3><span style="color: #800000;"><strong>SYN FIN Flood</strong></span></h3>
<p>By default snort capture SYN FIN Flood packets turn on IDS mode using given below command.</p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;">Again we are using Hping3 for attacking to generate traffic flood for the target’s network to slow down network services for other users.</span></p>
<pre class="lang:default decode:true">hping3 -SF --flood -p 80 192.168.1.107</pre>
<p><span style="color: #000000;">Above command will send endless bits packet per second on port 80 of the target’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SkT5XescuGk/Wj_iS5d6bWI/AAAAAAAASxI/w4MkdnkwqZE0CODty2JR4lyBbLbLpYgNACEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Hence in given below image, you can notice endless SYN-FIN packet has sent from 192.168.1.105 to 192.168.1.107 on port 80.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-bXXjjcZUMzE/Wj_iThmrDeI/AAAAAAAAS0Y/mGPyI04lCIg6mCpnl66Yx80dLXJ5zcsvQCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Come back to over your target machine where you will notice that snort is exactly in same way capturing all incoming traffic here you will observe that it is generating <strong>alerts </strong>for “SYN-FIN Flood Dos”.  Hence you can block the attacker’s IP (192.168.1.105) to protect your network from discard all further coming packets toward your network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-3nt9Z9FduRk/Wj_iTwtwBnI/AAAAAAAAS0Y/4BbhSJQYyJcPEagu-daLC0qRbwuHoePigCEwYBhgL/s1600/14.png"/></span></p>
<h3><span style="color: #800000;"><strong>PUSH ACK Flood</strong></span></h3>
<p><span style="color: #000000;">Now again open local rule files for generating alert for some combination of flags such as PSH-ACK packets and enter given below rule and save the file.</span></p>
<pre class="lang:default decode:true">alert tcp any any -&gt; 192.168.1.107 any (msg: "PUSH-ACK Flood Dos"; sid:1000001; flags:PA; )</pre>
<p><span style="color: #000000;">The above rule will monitor incoming TCP-PSH/ACK packets on 192.168.1.107 by generating alert for it as “PUSH-ACK Flood Dos”. Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-me0RzoEo_4I/Wj_iT1TjxUI/AAAAAAAASxU/NvnnSvsyc-wl1ukgG5QZ7m8ha88uZeraACEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Again we are using Hping3 for attacking to generate traffic flood for the target’s network to slow down network services for other users.</span></p>
<pre class="lang:default decode:true">hping3 -PA --flood -p 80 192.168.1.107</pre>
<p><span style="color: #000000;">Above command will send endless bits packet per second on port 80 of the target’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-P7h-0MQiMI8/Wj_iUaBFBHI/AAAAAAAAS0Y/umS0QoyCEicJ6aSoRVLHifZq6nVYSgKtwCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Hence in given below image, you can notice endless PSH-ACK packet has sent from 192.168.1.105 to 192.168.1.107 on port 80.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-P_YxTYBLdws/Wj_iVWp-VjI/AAAAAAAASxw/TNmiF0Zhh3odlLINeZJq89qIyWS57Sd2QCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Come back to over your target machine where you will notice that snort is exactly in same way capturing all incoming traffic here you will observe that it is generating <strong>alerts </strong>for “PUSH-ACK Flood Dos”.  Hence you can block the attacker’s IP (192.168.1.105) to protect your network from discard all further coming packets toward your network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Ut8rKvOMo7Q/Wj_iVWgLsKI/AAAAAAAASxo/D8J_gX2-jSY_upJeQIQcHFHaC9wx2KsJwCEwYBhgL/s1600/18.png"/></span></p>
<h3><span style="color: #800000;"><strong>Reset Flood</strong></span></h3>
<p><span style="color: #000000;">Now again open local rule files for generating alert for Reset flag packets and enter given below rule and save the file.</span></p>
<pre class="lang:default decode:true">alert tcp any any -&gt; 192.168.1.107 any (msg: "Reset Dos"; sid:1000001; flags:R; )</pre>
<p><span style="color: #000000;">Above rule will monitor incoming TCP-RST packets on 192.168.1.107 by generating alert for it as “Reset  Dos”. Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-lV3_FSjIU20/Wj_iVlmFulI/AAAAAAAASx4/JgpU6opwB6wUFRgQpIBVCwv14W2s1JZngCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Again we are using Hping3 for attacking to generate traffic flood for the target’s network to slow down network services for other users.</span></p>
<pre class="lang:default decode:true">hping3 -R --flood -p 80 192.168.1.107</pre>
<p><span style="color: #000000;">Above command will send endless bits packet per second on port 80 of the target’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-4dCdOcFbXKU/Wj_iWTQQxrI/AAAAAAAASyI/iC_cmpk_iMs_8PqwRB1uauuOafBZeVI2ACEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Hence in given below image, you can notice endless RST (Reset) packet has sent from 192.168.1.105 to 192.168.1.107 on port 80.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gj-m6LrLqy8/Wj_iWjDMamI/AAAAAAAASyQ/xZ2yz_HnDuM4MxIEUHZWU1sYEnVjjGM5QCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">Come back to over your target machine where you will notice that snort is exactly in same way capturing all incoming traffic here you will observe that it is generating <strong>alerts </strong>for “Reset Dos”.  Hence you can block the attacker’s IP (192.168.1.105) to protect your network from discard all further coming packets toward your network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-UursyaEwrTU/Wj_iXcNC3XI/AAAAAAAAS0Y/8REWNM65tkYIcLqKf8a_OgKvBlZA-ZezwCEwYBhgL/s1600/22.png"/></span></p>
<h3><span style="color: #800000;"><strong>FIN Flood</strong></span></h3>
<p><span style="color: #000000;">Now again open local rule files for generating alert for Fin flag packets and enter given below rule and save the file.</span></p>
<pre class="lang:default decode:true">alert tcp any any -&gt; 192.168.1.107 any (msg: "FIN Dos"; sid:1000001; flags:F; )</pre>
<p><span style="color: #000000;">The above rule will monitor incoming TCP-RST packets on 192.168.1.107 by generating alert for it as “FIN Dos”. Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-6iaSDXNE0qA/Wj_iXYlIw4I/AAAAAAAASyg/VCWrHX_8P0UIHBY_kQvnkmXdGu6KoHdLACEwYBhgL/s1600/23.png"/></span></p>
<p><span style="color: #000000;">Again we are using Hping3 for attacking to generate traffic flood for the target’s network to slow down network services for other users.</span></p>
<pre class="lang:default decode:true">hping3 -F –flood -p 80 192.168.1.107</pre>
<p><span style="color: #000000;">Above command will send endless bits packet per second on port 80 of the target’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--s1tsSVx5kk/Wj_iXtNczjI/AAAAAAAASyo/rg-DaSQtYhooGS8kxiGr2Yy6f6IZ8EWVwCEwYBhgL/s1600/24.png"/></span></p>
<p><span style="color: #000000;">Hence in given below image, you can notice endless FIN (Finished) packet has sent from 192.168.1.105 to 192.168.1.107 on port 80.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cHaGd29L0tY/Wj_iYJJX4WI/AAAAAAAASyw/HXQ9sv-GnzIcwaXzw22AmFmD9drzsBAqACEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Come back to over your target machine where you will notice that snort is exactly in same way capturing all incoming traffic here you will observe that it is generating <strong>alerts </strong>for “FIN Dos”.  Hence you can block the attacker’s IP (192.168.1.105) to protect your network from discard all further coming packets toward your network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ad_ei8jQTo8/Wj_iYVDdz8I/AAAAAAAASy0/d1h5PmHUeVYGt5oyCyInYoM3gHvisjxkQCEwYBhgL/s1600/26.png"/></span></p>
<h3><span style="color: #800000;"><strong>Smurf Attack</strong></span></h3>
<p><span style="color: #000000;">A smurf attack is a DDOS attack in which large numbers of Internet Control Message Protocol packets are used to generate a fake Echo request (ICMP type: 8) containing a spoofed source IP which is actually the target network address. This request packet is then is transmitted to all of the network hosts on the network and then each host sends an ICMP response to the spoofed source address (target IP).  The target’s computer will be flooded with traffic; this can slow down the target’s computer and make it usable for other users.</span></p>
<p><span style="color: #000000;">Now again open local rule files for generating alert for ICMP packets and enter given below rule and save the file.</span></p>
<pre class="lang:default decode:true">alert icmp any any -&gt; any any (msg: "Smurf Dos Attack"; sid:1000003;itype:8; )</pre>
<p><span style="color: #000000;">The above rule will monitor ICMP packets on 192.168.1.103 by generating alert for it as “Smurf Dos Attack”. Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true ">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><img decoding="async" src="https://2.bp.blogspot.com/-FtYCzH8XaGM/WkCR9mucfJI/AAAAAAAAS0k/kvxg1dSGzC0me6u8SNMqxyFmJimvSH2kQCLcBGAs/s1600/31.png"/></p>
<p><span style="color: #000000;">Again we are using Hping3 for attacking to generate traffic ICMP flood for target’s network to slow down network services for other users.</span></p>
<pre class="lang:default decode:true">hping3 --icmp --flood -c 1000 --spoof 192.168.1.103 192.168.1.255</pre>
<p><span style="color: #000000;">Above command will generate fake ICMP echo request packet containing a spoofed source IP: 192.168.1.103 which is basically our victim’s network and this request packet is then is transmitted to host’s network on 192.168.1.255 and then this host sends an ICMP response to the spoofed source address which our victim’s machine in IDS mode.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-TH5hIeCFKs0/WkCRgogH78I/AAAAAAAAS0g/7TNOO2HPt0M-rYLKN7S-2Iq9P3HpxwoDQCEwYBhgL/s1600/32.png"/></p>
<p><span style="color: #000000;">From given below image you can observe it is showing source machine 192.168.1.103 sending icmp echo request packet to 192.168.1.255 but as we know in actual attacker is the main culprit behind this scenario.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-7-rUlESgxCo/WkCOyjb-Z7I/AAAAAAAAS0c/jXL-eDSaa1QDEYIfpKxR8bQju6T6BbS7ACLcBGAs/s1600/33.png"/></p>
<p><span style="color: #000000;">Come back to over your target machine where you will notice that snort is capturing all the traffic flowing from 192.168.1.103 to 192.168.1.255 and generating <strong>alerts </strong>for “Smurf Dos Attack” which means is our machine (victim’s machine) is pinging another host machine of that network. Therefore the network administrator should be attentive with this kind of traffic and must check the system activity and legitimate ICMP request of a packet of his network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-NU8N7e9G38E/Wj_ibyLueKI/AAAAAAAAS0A/_tXbwhfcqrsMmvc5RQi0WGYSLkiT3ivvACEwYBhgL/s1600/34.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Rahul Virmani</strong> is a Certified Ethical Hacker and the researcher in the field of network Penetration Testing (CYBERSECURITY).    Contact <strong><a href="https://www.linkedin.com/in/rahul-virmani-4280666a/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
