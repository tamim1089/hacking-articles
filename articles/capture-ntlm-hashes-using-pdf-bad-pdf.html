<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/collection-of-hacking-tools/" rel="category tag">Hacking Tools</a>, <a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Capture NTLM Hashes using PDF (Bad-Pdf)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/capture-ntlm-hashes-using-pdf-bad-pdf/" rel="bookmark"><time class="entry-date published" datetime="2018-05-12T17:22:36+00:00">May 12, 2018</time><time class="updated" datetime="2025-05-30T07:21:59+00:00">May 30, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">Today we are demonstrating stealing NTLM hashes through a pdf file. We have already discussed the various methods to Capture NTLM Hashes in a Network in our <span style="color: #0000ff;"><a style="color: #0000ff;" href="http://www.hackingarticles.in/4-ways-capture-ntlm-hashes-network/">previous</a></span> article. Recently a new tool has launched “Bad-PDF” and in this article, we are sharing our experience.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;">Bad-PDF creates malicious PDF to steal NTLM(NTLMv1/NTLMv2) Hashes from windows machines. It utilizes vulnerability disclosed by checkpoint team to create the malicious PDF file. Bad-Pdf reads the NTLM hashes using Responder listener.</span></p>
<p class="ai-optimize-8"><span style="color: #000000;">This method works for all PDF readers(Any version) and java scripts are not required for this attack, most of the EDR/Endpoint solution fail to detect this attack.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/deepzec/Bad-Pdf.git
cd Bad.Pdf
ls
chmod 777 badpadf.py</pre>
<p class="ai-optimize-9"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-S7PviZuriGQ/WvcibhukjzI/AAAAAAAAW24/Y4DuW8AcqRktueZYaaGLxnCRSPbi9W40wCLcBGAs/s1600/1.png"/></span></p>
<p class="ai-optimize-10"><span style="color: #000000;">Now run the python file with the help of following command given below:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python badpdf.py</pre>
<p class="ai-optimize-11"><span style="color: #000000;">Then it will try to connect with Responder through its default path i.e. /user/bin /responder but in our case. The location of the responder is user/sbin/responder. After then it will ask your network IP, the name of the output file and interface name. Submit this information as per your network.</span></p>
<p class="ai-optimize-12"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-7Q7Q4spljhk/WvcicOb-ZAI/AAAAAAAAW3A/vFr0LMJj4iYCnzI4GagnaEY9vrgCpmZEACLcBGAs/s1600/2.png"/></span></p>
<p class="ai-optimize-13"><span style="color: #000000;">Then it will create a malicious pdf file with name bad.pdf, now transfer this pdf file to your target.</span></p>
<p class="ai-optimize-14"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/--duggI6W-fw/Wvcib3xvocI/AAAAAAAAW28/ANZHne71zs0LL5LiVNxOQwpp9cpy8E_sgCLcBGAs/s1600/3.png"/></span></p>
<p class="ai-optimize-15"><span style="color: #000000;">So, when the victim will click our malicious file, his NTLM hash will be captured as shown in below image. Here you can observe username ‘raj’ along with its hash password. Now copy the hash value in a text document so that you can crack this hash value for retrieving the password.</span></p>
<p class="ai-optimize-16"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-J_cmxCjRwTw/WvcicT17bEI/AAAAAAAAW3E/aTse4KisZ2Y3Dep0fBWy-f41U5QbhQwKgCLcBGAs/s1600/7.png"/></span></p>
<p class="ai-optimize-17"><span style="color: #000000;">We have pasted the hash value in a text file and save it as “hash” on the desktop. Later we had used John the ripper for cracking the hash.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john hash</pre>
<p class="ai-optimize-18"><span style="color: #000000;">Awesome!!! We have retrieved <strong>password: 133</strong> for user: raj.</span></p>
<p class="ai-optimize-19"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-6maHSuAkGok/WvcicVqCdlI/AAAAAAAAW3I/9Ro68NrVCJkq3YTT1MUT2fO3xk9DqKrNgCLcBGAs/s1600/8.png"/></span></p>
<p class="ai-optimize-20"><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
