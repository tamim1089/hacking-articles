<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">FourAndSix: 2 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/fourandsix-2-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-11-23T17:11:11+00:00">November 23, 2018</time><time class="updated" datetime="2025-06-10T20:11:56+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">FourAndSix: 2 is the sequel for previously solved vulnerable machine FourAndSix by Fred uploaded on vulnhub. It is not mandatory but is advised to read the prequel of this lab <a style="color: #000000;" href="https://www.hackingarticles.in/hack-the-fourandsix-ctf-challenge/">here</a>. You can download the FourAndSix:2 vulnerable lab from <a style="color: #000000;" href="https://www.vulnhub.com/entry/fourandsix-201,266/">here</a>. The challenge is to become root and read flag.txt in the same directory.</span></p>
<h3><span style="color: #800000;"><strong>Table of Contents:</strong></span></h3>
<ul>
<li><span style="color: #000000;">Discovery of IP address.</span></li>
<li><span style="color: #000000;">Scanning for open ports and services.</span></li>
<li><span style="color: #000000;">Discovering universally accessible directory in the victim’s machine.</span></li>
<li><span style="color: #000000;">Cracking the password of archive found in the storage partition.</span></li>
<li><span style="color: #000000;">Reading the pub file and logging in using ssh.</span></li>
<li><span style="color: #000000;">Discovering utilities with sticky bit on them.</span></li>
<li><span style="color: #000000;">Using doas to get root.</span></li>
<li><span style="color: #000000;">Snagging the flag!</span></li>
<li><span style="color: #000000;">Let’s get started then.</span></li>
</ul>
<p><span style="color: #000000;">The first step is, as usual, to find the IP of the target machine using <strong>netdiscover</strong>. In this case, it is 192.168.1.103</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-9QT9fd_4Arg/W_gvsMQFkKI/AAAAAAAAbTg/8zsFnV3TmbsfAAWSQAl1PbxaQQ0RXCERgCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Next, we discover open ports and services using nmap.<br/>
</span></p>
<pre class="lang:default decode:true ">nmap -A 192.168.1.103</pre>
<p>The ports open were 22, 111, 2049.</p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6hI7yqsrztI/W_gvs9i5VCI/AAAAAAAAbTw/9-SKQjYJqUkMaivfEn1BCdzaIG26BnwAwCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">There was only one way to proceed and that is port 2049. So, we used showmount command to check for NFS shared partitions.</span></p>
<p><span style="color: #000000;">Later, we mounted it under the folder name “raj” using the mount command. And we found a 7z compressed file.</span></p>
<pre class="lang:default decode:true ">showmount -e 192.168.1.103
mount -t nfs 192.168.1.103:/home/user/storage raj</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-U5f9diFch4Y/W_gvteIOVEI/AAAAAAAAbT0/ONLzs0_SXnUaR7OMtNprcyw23OX5tqYLwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">But the file “backup.7z” was, unfortunately, password protected.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-rJAlHhgsxBo/W_gvth55kNI/AAAAAAAAbT8/XWXHfcpz7w8BR7BmUw5aPo-kengm6Q_HACLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">So, after trying out a number of options like John The Ripper and getting zero success, we found a site online to break its password.</span></p>
<p><span style="color: #000000;">The password was: <strong>chocolate</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Tfwe12q8xZQ/W_gvtnWa6wI/AAAAAAAAbT4/vexIyhzewZk35TMd80zQwXU_rwY0KVnXACLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We extracted its contents in the same folder and found a few images along with RSA keys. As port 22 is running SSH service on the target machine, we can use RSA private key to login. We open RSA public key to taking a look at the username.</span></p>
<pre class="lang:default decode:true">cat id_rsa.pub</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fILNYUmc1eQ/W_gvuoghegI/AAAAAAAAbUI/SiPqq-u9bggCn0sNTvPF_ML7Gs8PT7nZQCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We tried logging in to ssh but it was asking for a passphrase. So, we created the following script to find the correct password.</span></p>
<pre class="lang:default decode:true">cat /usr/share/wordlists/metasploit/adobe_top100_pass.txt | while read pass; do if ssh-keygen –c –C "user@forandsix" –P $pass –f id_rsa &amp;&gt;/dev/null; then echo $pass; break; fi; done</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--gzWvXuLdQM/W_gvuQ2de9I/AAAAAAAAbUA/aoqapIrREYIsCdRP8oXSlZ2Wbx92M4NmwCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">From the id_rsa.pub file, we found the user for the secure shell of the victim and logged in to it. The password was: “<strong>12345678</strong>”.</span></p>
<pre class="lang:default decode:true">ssh -i id_rsa user@192.168.1.103</pre>
<p><span style="color: #000000;">We used the find utility to discover files or packages with SUID bit set on them.</span></p>
<pre class="lang:default decode:true">find / -perm –u=s –type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;">We found an interesting utility with SUID bit: /usr/bin/doas which is an alternate to sudo.</span></p>
<p><span style="color: #000000;">After reading the “doas.conf” file, we find that “less” can be run as root.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-zSKTxAVOoJ8/W_gvua6n6XI/AAAAAAAAbUE/olN7CXiesQIs80Utr8kNJ29KgiST_EEIACLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Let’s pick the configuration file and try to understand it word by word. Doas utility executes commands as other users according to the rules in doas.conf configuration file.</span></p>
<p><span style="color: #000000;"><strong>Permit/Deny: </strong>allows the rule.</span></p>
<p><span style="color: #000000;"><strong>Nopass: </strong>the user is not required to enter any password.</span></p>
<p><span style="color: #000000;"><strong>Persist: </strong>After the user successfully authenticates, do not ask for a password again for some time.</span></p>
<p><span style="color: #000000;"><strong>Keepenv: </strong>The user’s environment is maintained.</span></p>
<p><span style="color: #000000;"><strong>Cmd: </strong>command is allowed to run.</span></p>
<p><span style="color: #000000;">Since doas configuration file says that less can be run with no password at all as root with no password, it can be used for shell escaping.</span></p>
<pre class="lang:default decode:true">doas /usr/bin/less /var/log/authlog</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://4.bp.blogspot.com/-ZFl15kJi5wU/W_gvsXD4oUI/AAAAAAAAbTk/0oRFtgdHiSwYGb_JNHuLcbPyYFF4rVrMgCLcBGAs/s1600/10.png"/></strong></span></p>
<p><span style="color: #000000;">Enter v to escape to vi and then “:!sh” to escape to our brand new shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-yXSTijwBpjs/W_gvshVRcWI/AAAAAAAAbTo/mkDvx7feGl4D0vjK52wche8cvyo6DH7RACLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">The final step was to snag the flag! It was in the root directory as told by the creator of the VM.</span></p>
<p><span style="color: #000000;"><strong>id</strong> shows that the shell is root shell and finally we read the congratulatory flag using cat!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-18caTneKOUg/W_gvs_0fO1I/AAAAAAAAbTs/aWlNY7yJtSgGmNVa8jvSGtbPVkTOTuxegCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">So this was how we root the FourAndSix:2. Hope you liked it.</span></p>
<p><span style="color: #000000;"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and a left and right brain thinker. contact<strong> <a class="broken_link" style="color: #000000;" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
