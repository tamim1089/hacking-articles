<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/domain-enumeration/" rel="category tag">Domain Enumeration</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Active Directory Enumeration: BloodHound</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/active-directory-enumeration-bloodhound/" rel="bookmark"><time class="entry-date published" datetime="2021-04-30T18:41:41+00:00">April 30, 2021</time><time class="updated" datetime="2025-05-13T08:28:43+00:00">May 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In the article, we will focus on the Active Directory Enumeration tool called BloodHound. It takes the data from any device on the network and then proceeds to plot the graph that can help the attacker to strategize their way to the Domain Admins.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><strong><span style="color: #000000;">Introduction</span></strong></li>
<li><strong><span style="color: #000000;">Linux Installation</span></strong></li>
<li><strong><span style="color: #000000;">Extracting Data from Domain</span></strong></li>
<li><strong><span style="color: #000000;">Enumerating with BloodHound</span></strong></li>
<li><strong><span style="color: #000000;">BloodHound on Windows</span></strong></li>
<li><strong><span style="color: #000000;">Extracting Data from Domain</span></strong></li>
<li><strong><span style="color: #000000;">Windows Installation</span></strong></li>
<li><strong><span style="color: #000000;">Enumerating with BloodHound</span></strong></li>
<li><strong><span style="color: #000000;">SharpHound on PowerShell</span></strong></li>
<li><strong><span style="color: #000000;">SharpHound on PowerShell Empire</span></strong></li>
<li><strong><span style="color: #000000;">Conclusion</span></strong></li>
</ul>
<h3><span style="color: #800000;">Introduction</span></h3>
<p><span style="color: #000000;">BloodHound is programmed to generate graphs that reveal the hidden and relationships within an Active Directory Network. It also supports Azure. BloodHound enables the Attackers to identify complex attack paths that would otherwise be not possible to identify. The Blue Team can use BloodHound to identify and fix those same attack patterns.</span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Linux Installation</span> </span></h3>
<p><span style="color: #000000;">Multiple guides and methods can help you set up and install BloodHound on your host machine. We’ll follow the official documentation from BloodHound’s <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/BloodHoundAD/BloodHound">GitHub </a></strong><span style="color: #000000;">while refining the process. As always, before you install any tool on your Linux machine, make sure to update and upgrade your software packages. Also, if Java isn’t already installed, install it to proceed. However, we won’t install Java here since Kali Linux already includes it. BloodHound’s configuration involves three steps. BloodHound consists of a GUI, a data scrapper, and the Neo4j database. So, we must configure each of them individually. We’ll begin with the BloodHound GUI, which you can install directly using</span></span> the apt command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">apt install bloodhound</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-d2x8Z_FajUs/YIxKiH5fr2I/AAAAAAAAvrs/D_iFwxO6iCYJSd9SRNOIM6cD4nOCAmZpACLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Next, you need to configure the Neo4j service, which stores the data displayed graphically. When you ran apt install bloodhound, it also installed Neo4j. If that didn’t happen in your case, install it using: </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">apt install neo4j</pre>
<h4 data-start="1300" data-end="1338"><span style="color: #000000;">Setting Up Neo4j Remote Access</span></h4>
<p><span style="color: #000000;">Now configure authentication and other settings on Neo4j. To do that, run the Neo4j console, which hosts the remote interface accessible through a web browser. By default, Neo4j runs on port 7474:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">neo4j console</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uqBqxLe40Pk/YIxKrW4W-fI/AAAAAAAAvrw/C3fBUHeXnwcCulZTNOhAlhNWS_cIZbIUwCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">When you enter the displayed URL in a web browser, the Neo4j remote interface will appear. Some fields already contain default values, while others remain blank. Enter a username—let’s say neo4j—and a password. After entering the details, you’ll connect to the Neo4j database.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5FCCleweeSE/YIxKvZev0tI/AAAAAAAAvr0/EvriNMiBBZszZeaq32T8tMdg_NMX6q7WACLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">Before connecting, the system asks you to change the password because it’s your first login. Enter any password of your choice and then connect to the Neo4j Remote Interface.  </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NHG9a8qpDjo/YIxKzpsNRCI/AAAAAAAAvr8/mhdI8jRKZl86DYg42DJVGw0A4b2PQWd-gCLcBGAsYHQ/s16000/4.png"/></span></p>
<h4><span style="color: #000000;">Running BloodHound GUI</span></h4>
<p><span style="color: #000000;">Now that Neo4j runs correctly, you can start the BloodHound GUI. To launch it, type bloodhound in your terminal and press Enter. Alternatively, open the BloodHound application from Kali Linux’s application menu.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3C-8_MG25Gk/YIxK4G8l7uI/AAAAAAAAvsA/J5IYy7sk9YYVxY8jhcnX01qty8KMPpGEQCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">As soon as the BloodHound GUI kicks in, it asks for a set of credentials that we just set up in the neo4j configuration. Use the same set of credentials and you will be able to login into this interface. You can save your credentials so that you don’t need to log in each time you want to use bloodhound.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pCky6QJ2kQU/YIxK8bHaJgI/AAAAAAAAvsE/o6W6CEPTlbY3HY98f0w7A7Cl4M1PEaFhQCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Once you log in, BloodHound opens a blank screen with action buttons on the right and a search box with modules on the left. This screen marks the completion of GUI setup. As we explained earlier, BloodHound displays domain data through interactive graphs. To generate these graphs, it needs domain data collected by a scrapper—which we now need to install.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FqqEk3uP5tM/YIxLAXDRFqI/AAAAAAAAvsM/rb1wiUjOzvYIwlCcta_dCusyk2i1yv7oACLcBGAsYHQ/s16000/7.png"/></span></p>
<h4 data-start="2723" data-end="2774"><span style="color: #000000;">Installing BloodHound Python Data Collector</span></h4>
<p><span style="color: #000000;">To install this data Ingestor which is so unusually named bloodhound. This can lead to some confusion but to make it clear once again. We installed BloodHound GUI in previous steps that plot graphs based on the data. Now we are installing a bloodhound that will extract the data from the Domain. As it is made in Python, we can use pip3 to install bloodhound as shown in the image below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pip3 install bloodhound</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zCCQFIqDKwE/YIxLEQYGr6I/AAAAAAAAvsU/wQCLAEP2PdsAAjaKH_ttx8YUdZz1ZBJZwCLcBGAsYHQ/s16000/8.png"/></span></p>
<h3><span style="color: #800000;">Extracting Data from Domain</span></h3>
<p><span style="color: #000000;">We will run the Python BloodHound that we just installed using pip3 and extract the data from the Domain. It is a good time to mention that here the Domain setup is in such a way that we have connected the Domain Controller, Clients, and our Attacker Machine essentially in the same network. To get data from the Domain, any user can be used. We will use the Administrator account to extract maximum data for this enumeration. </span></p>
<p><span style="color: #000000;">In a realistic scenario, you will end up with a normal user and then you will run BloodHound and use the data enumerated to get to the Administrator. We need to provide the following parameters to extract data from the Domain: username, password, Name Server (IP Address of Domain Controller), Domain, and data we want to extract (we are using “All” to extract maximum data from the Domain). The data extracted will be in the form of .json files that BloodHound will create based on the queries that run across the Domain in search of possible paths and permissions of various groups and users.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">bloodhound-python -u administrator -p Ignite@987 -ns 192.168.1.172 -d ignite.local -c All</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dv74CXUlqjc/YIxLJR5xNgI/AAAAAAAAvsY/F2f7ODPeyDw7h8M7iM7I9LFh-fk1C_UbgCLcBGAsYHQ/s16000/9.png"/></span></p>
<h4 data-start="1467" data-end="1517"><span style="color: #000000;">Loading Extracted Data into BloodHound GUI</span></h4>
<p><span style="color: #000000;">After you run bloodhound-python, you will have json files in your current directory. You can check them with the ls command. To analyze them in the BloodHound GUI, you need to drag and drop those json files onto the GUI. As it can be observed from the image below, we have the computers.json, domains.json, groups.json, users.json.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RFfmfQG4QWY/YIxLQVHif-I/AAAAAAAAvsk/wpW05H68NT09y6gRV54FUm4MeT5KwcaDQCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">Now that you have uploaded all the json files, BloodHound GUI can start plotting the graphs. The way BloodHound works is that now that it is loaded with the data files from the domain, you can either enter queries to plot graphs or use the Pre-Built Queries. In this guide, we will use Pre-Built Queries.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Qu_nf-9EGpQ/YIxLWSQMbaI/AAAAAAAAvss/HhISloNBKfoTSKzd5RPsRyMXYKJ3Uv7dgCLcBGAsYHQ/s16000/11.png"/></span></p>
<h3><span style="color: #800000;">Enumerating with BloodHound</span></h3>
<p><span style="color: #000000;">Let’s begin our enumeration with the Pre-Built Analytics Queries. First of them that we use is the Find all Domain Admins. This Query will fetch all the Domain Admins it can find in its database and plot them on the graph as shown in the image below. Since our Domain has only one Domain Admin, it shows one node and then for 2 groups under that Domain Admin.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VyjKmlHC-Jk/YIxLbXogRDI/AAAAAAAAvs0/4ghQGJsNZ4U9gjL0D06RAaCGaHvIiPjbwCLcBGAsYHQ/s16000/12.png"/></span></p>
<h4 data-start="717" data-end="764"><span style="color: #000000;">Finding Shortest Paths to Domain Admins</span></h4>
<p class="" data-start="766" data-end="1111"><span style="color: #000000;">Next, the one that we use is pretty interesting. This one is called Find Shortest Paths to Domain Admins. This means that BloodHound will plot the Domain Admins and the users that it can find and then we will be able to deduce what kind of path we want to take to go on exploiting so that we can reach the Domain Admin with the least Resistance.</span></p>
<p><span style="color: #000000;">As we can see in the image below, there are 4 paths among which two (yellow nodes) are equidistant. Therefore, this means we can either use any one of them to get to the Domain Admins and we know that there is Generic Write permission that we can use to exploit to get to the Domain Admin. Hence, this is how in a particularly complicated and big Domain Environment, it can help the attacker to figure out their way into the mess and get that Domain Admin Access.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2cm-JK485Yw/YIxLfePgqWI/AAAAAAAAvs4/QBg9CXmqIV8S3yDbQO7Ai7CfS82siJSmgCLcBGAsYHQ/s16000/13.png"/></span></p>
<h4 data-start="1583" data-end="1621"><span style="color: #000000;">Finding AS-REP Roastable Users</span></h4>
<p><span style="color: #000000;">Another Prebuilt Query that we will be using is the Find AS-REP Roastable Users (DontReqPreAuth) Query. AS-REP roasting is an offensive technique against Kerberos that allows password hashes to be retrieved for users that do not require pre-authentication. If the user has “Do not use Kerberos pre-authentication” enabled, then an attacker can recover a Kerberos AS-REP encrypted with the user’s RC4-HMAC’d password. The attacker can then attempt to crack this ticket offline.</span></p>
<p><span style="color: #000000;">Additionally, pre-authentication is the initial stage in Kerberos authentication. It is managed by the KDC Authentication server and is meant to prevent brute-force attacks.</span></p>
<p><span style="color: #000000;">From the image, we can see that the Japneet user is vulnerable to the AS-REP Roasting attack.</span></p>
<p><span style="color: #000000;"><strong>Learn More: <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/as-rep-roasting/">AS-REP Roasting</a></span></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TXo1cuExsiQ/YIxLm8jfADI/AAAAAAAAvtE/PQwZUSqH73oYgOja40rvztO-ge5XsbB0gCLcBGAsYHQ/s16000/14.png"/></span></p>
<h4><span style="color: #000000;">Conclusion on AS-REP Roasting Enumeration</span></h4>
<p><span style="color: #000000;">The conclusion that we came to according to our Enumeration with BloodHound is that the Japneet user is vulnerable to AS-REP Roasting. This claim can be verified by browsing the Active Directory Users and Computers and then further descending into the user Properties of the Japneet user. In the Japneet user Properties Window, there is an Account Tab. Inside the Account tab, we can see that the Japneet user does not require Kerberos preauthetication.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HEvQZ11NncU/YIxLqx2M-kI/AAAAAAAAvtI/T7qIGUEgkzY-6LyGvjB7cwZHJvzNB8znQCLcBGAsYHQ/s16000/15.png"/></span></p>
<h4><span style="color: #000000;">Enumerating for DCSync Attack</span></h4>
<p><span style="color: #000000;">Another attack for which we can enumerate using the BloodHound is the DC Sync Attack. This attack allows an attacker to replicate Domain Controller (DC) behavior. Typically, the attacker impersonates a domain controller and requests other DC’s for user credential data via GetNCChanges. But compromised account should be a member of administrators, Domain Admin, or Enterprise Admin to retrieve account password hashes from the others domain controller.</span></p>
<p><span style="color: #000000;">From the BloodHound graph, we can see that Geet user is vulnerable to this attack.</span></p>
<p><span style="color: #000000;"><strong>Learn More: <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/credential-dumping-dcsync-attack/">DCSync Attack</a></span></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MpfwKkuBB5s/YIxLwSNszZI/AAAAAAAAvtQ/HxAtHkPQtYIbNWbVgthIyUblpgdeStilwCLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">The conclusion that we came to according to our Enumeration with BloodHound is that Geet user is vulnerable to DCSync Attack. This claim can be verified by browsing the Active Directory Users and Computers and then further descending into the user Properties of the Geet user. In the Geet user Properties Window, there is a Member Of Tab. Inside the Member Of tab, we can see that the Geet user is a part of Domain Admins which makes that user vulnerable to DC Sync Attack.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1zdE_DuccLM/YIxL0jFn9YI/AAAAAAAAvtU/XoqyX0lDzGo0m3hcCE8QM-gf7oNrnvwcQCLcBGAsYHQ/s16000/17.png"/></span></p>
<h4><span style="color: #000000;">Enumerating Kerberoastable Accounts</span></h4>
<p><span style="color: #000000;">The next enumeration that we are going to perform using BloodHound is the Listing of all Kerberoastable Accounts. Kerberoasting is a technique that allows an attacker to steal the KRB_TGS ticket, which is encrypted with RC4, to brute force application services hash to extract its password. From the graph plotted by the BloodHound, it can be said that KRBTGT and SVC_SQLSERVICE are the two users that are vulnerable to this attack.</span></p>
<p><span style="color: #000000;"><strong>Learn More: <span style="color: #0000ff;">Kerberoasting Attack</span></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-A1l0sbYTkfw/YIxL4v9CHEI/AAAAAAAAvtc/CXO1JAnXA1Y3xNtpUG-kUNcG0AH9NfZYACLcBGAsYHQ/s16000/18.png"/></span></p>
<p><span style="color: #000000;">There are a lot of different custom queries and built-in queries that can be used to enumerate using BloodHound. Once you are done with the Enumeration and Analysis, you can clear the database of values and add new JSON files of different values by browsing the Database Info tab on BloodHound GUI and Clicking the Clear Database Button as demonstrated below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Y45MPyse8zU/YIxL8SPb4oI/AAAAAAAAvtk/sVB6GRpEmHkCERDSkDxaH8uwghm_N8aqACLcBGAsYHQ/s16000/19.png"/></span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">BloodHound on Windows</span> </span></h3>
<p><span style="color: #000000;">It is possible to analyze and enumerate BloodHound directly from a Windows machine as well. This can be helpful in the Environments that restrict the deployment of Kali Linux and other attacker tools. The process remains more or less the same. We need to set up the Data Ingestor, BloodHound GUI, and neo4j database on Windows Machine as we did in Linux earlier. To begin, we will be installing the Data Ingestor for Windows that is named Sharphound. The difference between the Linux Investor and Windows Investor is that instead of crafting JSON files, the SharpHound creates a compressed file that includes CSV files. The data collection method remains the same.</span></p>
<p><span style="color: #000000;">SharpHound can be Downloaded for <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/BloodHoundAD/SharpHound3">GitHub</a></strong></span>.     </span></p>
<h3><span style="color: #800000;">Extracting Data from Domain</span></h3>
<p><span style="color: #000000;">In the image presented below, it can be observed that when the attacker runs the SharpHound on the machine connected to Domain, it created a compressed file with the BloodHound name as highlighted.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sharphound.exe 
dir</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EoU9VCKiM7U/YIxMBVdYV-I/AAAAAAAAvts/jP0VM0MzP9Ih0ArT3Pkd8gUDKpZFLj07wCLcBGAsYHQ/s16000/20.png"/></span></p>
<h3><span style="color: #800000;">Windows Installation</span></h3>
<p><span style="color: #000000;">From the Linux setup, we remember that BloodHound requires the neo4j service. It can be downloaded for Windows and then run using a batch file that comes with the installation package. This service runs on port 7474 as well.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Download Neo4j Windows 
dir 
neo4j.bat console</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KVuLsnq3Ggs/YIxMGKHG8WI/AAAAAAAAvt0/8BYcQMEGwmIJc6CrXh6lyAbZCt__VZhDQCLcBGAsYHQ/s16000/21.png"/></span></p>
<p><span style="color: #000000;">We take the URL from the neo4j console and open it in our Web Browser. If we remember correctly, we require to configure the credentials at this stage which will also be used for the BloodHound as well.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mUAO7dzT0zU/YIxMLyiBGfI/AAAAAAAAvt8/NPq8xzQkMmEdZHrwx244eY_rZAITXnpfQCLcBGAsYHQ/s16000/22.png"/></span></p>
<p><span style="color: #000000;">After the configuration of the password, we try and log in for the first time in the neo4j service. This requires us to rest the password as shown in the screenshot below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yMYopx5Ggs4/YIxMQcd96XI/AAAAAAAAvuA/xZ01ohZa0RUNn0rTYl8SUPZz1el3aFY4ACLcBGAsYHQ/s16000/23.png"/></span></p>
<p><span style="color: #000000;">After resetting the password and connecting to the neo4j service that we configured on our Windows device, we can access the service from our Web browser. The panel tells us that we are connected successfully to the neo4j service.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-e0VfBFZOE_Q/YIxMUJPhdRI/AAAAAAAAvuE/U00A5G7BqSMNB86IioA64ML1mz6uuaMGACLcBGAsYHQ/s16000/24.png"/></span></p>
<p><span style="color: #000000;">Now that we have installed the SharpHound Ingestor and Neo4j service on our Windows device, we are now left with the process of installing the BloodHound GUI. This is quite simple as we have executable for the same. We use the Windows Command Prompt to run the GUI as shown in the image below.</span></p>
<p><span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/BloodHoundAD/BloodHound/releases">Download BloodHound GUI Windows</a></strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dir 
BloodHound.exe</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zYKjeDtgX40/YIxMYJscEgI/AAAAAAAAvuI/4MwFyhGBkDY2_Ub-vncIm5i4ew1Ht_-ugCLcBGAsYHQ/s16000/25.png"/></span></p>
<p><span style="color: #000000;">The BloodHound GUI gets executed and we have ourselves a Login panel as shown in the image below. We use the credentials that we set up in the Neo4j Configuration to login into BloodHound GUI.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-o5r9tevV0tQ/YIxMe7G9cGI/AAAAAAAAvuQ/lXAaFZVWhyge-rcFW-EXYwOliIY2wlYeQCLcBGAsYHQ/s16000/26.png"/></span></p>
<h3><span style="color: #800000;">Enumerating with BloodHound</span></h3>
<p><span style="color: #000000;">From here onwards the process of analyzing and enumerating on BloodHound is the same as we discussed above. Using this set of instructions has made you able to run BloodHound on a Windows device.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-94Ml0gXZMdg/YIxMiRyDMII/AAAAAAAAvuU/Pz1u53ao3eQCgn9QzjaESiFEru5Il22_ACLcBGAsYHQ/s16000/27.png"/></span></p>
<h3/>
<h3><span style="color: #800000;">SharpHound on PowerShell</span></h3>
<p><span style="color: #000000;">As an extension to the BloodHound Enumeration process on Windows, we also want to demonstrate the process security professionals can follow when they want to use SharpHound on Windows through PowerShell. They can do this because we have the PowerShell scripts for the SharpHound Ingestor. After bypassing the script restriction on PowerShell, we import the modules from the SharpHound PowerShell script. It contains a cmdlet by the name of Invoke BloodHound. This can be used to collect data on the target machine. This is useful in the scenario where it is not possible to run an executable on the target machine. </span></p>
<p><span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors">Download SharpHound PowerShell Script</a></strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">powershell -ep bypass 
Import-Module .\SharpHound.ps1 
Invoke-BloodHound -CollectMethod All</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OXx9qLXslKk/YIxMnBcXd6I/AAAAAAAAvuY/y_zGttVKMJ8RzV3GkJRuxlFec58IzTAUACLcBGAsYHQ/s16000/28.png"/></span></p>
<h3><span style="color: #800000;">SharpHound on PowerShell Empire</span></h3>
<p><span style="color: #000000;">The SharpHound script that we used previously on PowerShell can be found inside the Kali Linux as well. It is located inside the PowerShell Empire. After successfully gaining the initial foothold on a device that is part of a Domain, the attacker can directly use the Empire to run SharpHound and extract the data from there as well. To do this we need to use the bloodhound module in the Empire’s Situational Awareness Modules. After execution, it tells the attacker the location at which the data csv files are located at.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usemodule situtationa_awareness/network/bloodhound 
execute</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-66vljF3M_ss/YIxMqzmyb9I/AAAAAAAAvug/a7FTa0-SCQsH3k5l375cC6BEg1Qr7rDHQCLcBGAsYHQ/s16000/29.png"/></span></p>
<p><span style="color: #000000;">An attacker can use the download command on PowerShell Empire to transfer the CSV files to the host machine, i.e., Kali Linux. We can use multiple CSV files in the same way we used the JSON files earlier. This allows us to plot graphs and enumerate an Active Directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ls 
download group_memberships.csv 
download local_admins.csv 
download trusts.csv 
download user_sessions.csv</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-c-o12p54148/YIxMuoedUGI/AAAAAAAAvuk/pWQu20c7IGoWDiakTLoHOya98C2A3G--QCLcBGAsYHQ/s16000/30.png"/></span></p>
<h3><span style="color: #800000;">Conclusion</span></h3>
<p><span style="color: #000000;">We created this guide to help security professionals, whether on the Red Team or Blue Team, deploy, configure, and use BloodHound for Active Directory enumeration. BloodHound is a powerful tool that helps understand the mechanics of an Active Directory network. Once you gather that information, you can use it to elevate privileges or exploit the network.</span></p>
<p><span style="color: #000000;"><b>Author</b>: <strong>Geet Madan</strong> is a Certified Ethical Hacker, Researcher and Technical Writer at Hacking Articles on Information Security<b>. </b>Contact</span> <a href="https://www.linkedin.com/in/geet-madan/"><b>here</b></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
<!-- YARPP Thumbnails -->
<h3>Related posts:</h3>
<div class="yarpp-thumbnails-horizontal">
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/active-directory-pentesting-using-netexec-tool-a-complete-guide/" title="Active Directory Pentesting Using Netexec Tool">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">Active Directory Pentesting Using Netexec Tool</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/credential-dumping-active-directory-reversible-encryption/" title="Credential Dumping – Active Directory Reversible Encryption">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">Credential Dumping – Active Directory Reversible Encryption</span></a>
</div>
</div>
            </div><!-- .entry-content -->
            <footer class="post-footer entry-footer">
                                                
            </footer><!-- .entry-footer -->
            
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://www.hackingarticles.in/windows-privilege-escalation-sebackupprivilege/" rel="prev">Windows Privilege Escalation: SeBackupPrivilege</a></div><div class="nav-next"><a href="https://www.hackingarticles.in/wonderland-tryhackme-walkthrough/" rel="next">Wonderland TryHackMe Walkthrough</a></div></div>
	</nav>        </div>
