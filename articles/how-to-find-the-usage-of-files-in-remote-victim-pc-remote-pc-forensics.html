<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/cyber-forensics-tricks/" rel="category tag">Cyber Forensics</a></span>            </div>
            <h1 class="post-title entry-title">How to find the usage of files in Remote victim PC (Remote PC Forensics)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/how-to-find-the-usage-of-files-in-remote-victim-pc-remote-pc-forensics/" rel="bookmark"><time class="entry-date published" datetime="2015-03-29T11:54:57+00:00">March 29, 2015</time><time class="updated" datetime="2025-05-24T10:02:30+00:00">May 24, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to learn about managing a bunch of files on </span>a remote<span style="color: #000000;"> system using the </span>forfiles<span style="color: #000000;"> command via meterpreter.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><strong><span style="color: #000000;">Introduction to forfiles command</span></strong></li>
<li><strong><span style="color: #000000;">Parameters and Syntaxes</span></strong></li>
<li><strong><span style="color: #000000;">Achieve Meterpreter on Remote System</span></strong></li>
<li><strong><span style="color: #000000;">List all the files of a particular extension modified in last 10 days</span></strong></li>
<li><strong><span style="color: #000000;">List all the files of a particular extension, name and modification date</span></strong></li>
<li><strong><span style="color: #000000;">List all the files that we modified on a particular date</span></strong></li>
<li><strong><span style="color: #000000;">List all the files modified in the last 10 days</span></strong></li>
<li><strong><span style="color: #000000;">List path of all the image files with their size</span></strong></li>
<li><strong><span style="color: #000000;">List all the image files with their Relative path and Date</span></strong></li>
<li><strong><span style="color: #000000;">List all the sub-directories inside any directory</span></strong></li>
<li><strong><span style="color: #000000;">List all the files of a particular extension and Size</span></strong></li>
<li><strong><span style="color: #000000;">Backup files modified on a particular date</span></strong></li>
<li><strong><span style="color: #000000;">Delete files of a particular extension</span></strong></li>
</ul>
<h3><span style="color: #800000;">Requirements</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Attacker:</strong> Kali Linux</span></li>
<li><span style="color: #000000;"><strong>Target:</strong> Windows</span></li>
</ul>
<h3><span style="color: #800000;">Introduction to forfiles command</span></h3>
<p><span style="color: #000000;">Forfiles is a command line utility software. It was shipped with Microsoft Windows Vista. During that time, management of multiples files through the command line was difficult as most of the commands at that time we made to work on single files. Seeing this as a major drawback, Microsoft introduced forfiles. This command runs a command on a bunch of files at the same time. Operations that for files can perform are file selection based on the first or last modified date. Users can use forfiles directly on the command-line or in batch files or scripts.</span></p>
<p><span style="color: #000000;">The parameters of the forfiles command are divided into two parts:</span></p>
<ul>
<li><span style="color: #000000;">Switches</span></li>
<li><span style="color: #000000;">Command</span></li>
</ul>
<h4><span style="color: #000000;">Switches Syntax</span></h4>
<p><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="https://4.bp.blogspot.com/-u7Z6IKEQ_VU/XGxAXGJKzyI/AAAAAAAAcyM/WUxZi6FhJQo7oWYqw-UTOfRK4PyS-grUwCLcBGAs/s1600/0.png" alt="remote PC forensics investigation" width="643" height="378"/></span></p>
<h4><span style="color: #000000;">Date Syntax</span></h4>
<p><span style="color: #000000;">Based on the last modified date, the date switch(/D) selects the files.</span></p>
<p><span style="color: #000000;">The date is accepted in the <strong>MM/DD/YYYY format</strong>. But the date can be given in</span></p>
<p><span style="color: #000000;">terms of the number of days. Like we can use the (-) minus operator to give</span></p>
<p><span style="color: #000000;">the days earlier.</span></p>
<p><span style="color: #000000;"><strong>For example:</strong> If we write /D -40 then this means 40 days <strong>before the last modified</strong></span></p>
<p><span style="color: #000000;">date.</span></p>
<p><span style="color: #000000;">Similarly, we can use the (+) plus operator to give the days <strong>after the last modified</strong></span></p>
<p><span style="color: #000000;">date.</span></p>
<h4><span style="color: #000000;">Achieve Meterpreter on Remote System</span></h4>
<p><span style="color: #000000;">Open Kali Linux terminal and type msfconsole in order to load Metasploit framework. Now we need to compromise victim’s machine one to achieve any type of session either meterpreter or shell and to do so we can read our previous article from <strong><a style="color: #000000;" href="https://www.hackingarticles.in/msfvenom-tutorials-beginners/">here</a></strong>.</span></p>
<p><span style="color: #000000;">After getting meterpreter on the remote system, we need to get to the shell of the target system. This is necessary as the forfiles is a windows command-line command. So, get to the Windows command-line using <strong>“shell” </strong>command.</span></p>
<h3><span style="color: #800000;">List all the files of a particular extension modified in last 10 days</span></h3>
<p><span style="color: #000000;">In a scenario where we want to list the files with their path which were modified recently, we can use this command. Here we are using the date switch to define the number of days. We can change the number of days with /D to our requirement. Then we specified the extension .exe this can be any extension we want to search. And then finally we used the @path to make the complete path listed in the output.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">forfiles /D -10 /S /M *.exe /C "cmd /c echo @path"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-pbremYewhzo/XGxAXcR43vI/AAAAAAAAcyQ/0U-gnbPWzqk0cHW22qChci5XmZwqAuKqQCLcBGAs/s1600/1.png"/></span></p>
<h3><span style="color: #800000;">List all the files of a particular extension, name and modification date</span></h3>
<p><span style="color: #000000;">In a scenario where we want to list the files with their path and when they were modified recently, we can use this command. Here we are using the date switch to define the number of days. We can change the number of days with /D to our requirement. Then we specified the extension .exe this can be any extension we want to search. And then finally we used the @fdate to make the date it was modified listed in the output.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">forfiles /D -10 /S /M *.exe /C "cmd /c echo @ext @fname @fdate"</pre>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://3.bp.blogspot.com/-iXf78qkFe3Y/XGxAXwqVxyI/AAAAAAAAcyU/OVoKiBMo8aA5LF0aKHVRkdodQugk_xe_QCLcBGAs/s1600/2.png" alt="remote PC forensics investigation" width="644" height="638"/></span></p>
<h3><span style="color: #800000;">List all the files that we modified on a particular date</span></h3>
<p><span style="color: #000000;">In a scenario where we want to list the files that were modified on a particular date. In our example, we take 1<sup>st</sup> in January 2019. This can be modified as per the user’s choice. But we need to take care of the format that we mentioned in the Introduction of forfiles.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">forfiles /p c: /S /D 01-01-2019</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-7f_FzNeXYNw/XGxAYCTV-gI/AAAAAAAAcyY/ELwVVqKzmjEX5LLHBHfqlzflKsICVEOJQCLcBGAs/s1600/3.png"/></span></p>
<h3><span style="color: #800000;">List all the files modified in the last 10 days</span></h3>
<p><span style="color: #000000;">In a scenario where we want to list the files modified in the last 10 days, we can use this command. This command is different from the earlier command as here we are using the date switch to define the number of days instead of a particular date.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">forfiles /p c: /S /D -10</pre>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://2.bp.blogspot.com/-GHTx3HWvJoc/XGxAYdVH9iI/AAAAAAAAcyc/a30GSEc7jZ4fLIFbCJTJ5A57uTMtNTKqwCLcBGAs/s1600/4.png" alt="remote PC forensics investigation" width="537" height="506"/></span></p>
<h3><span style="color: #800000;"> List path of all the image files with their size</span></h3>
<p><span style="color: #000000;">In a scenario where we want to list image files with their path and size which were modified recently, we can use this command. Here we are using the @fsize extension to display the size of the files in bytes. We specified the extension .jpg this can be any extension we want to search. And then finally we used the @path to make the complete path listed in the output using forfiles command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">forfiles /S /M *.jpg /C "cmd /c echo @path @fsize"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-eYHhgoIgQB8/XGxAYwsJXRI/AAAAAAAAcyg/v49ETJYg1qsmVlLNpuAB7qAPX1JTN9iUwCLcBGAs/s1600/5.png"/></span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">List all the image files with their Relative path and Date </span> </span></h3>
<p><span style="color: #000000;">In a scenario where we want to list the files with their relative path with the date on which modification was done, we can use this command. We specified the extension .jpg this can be any extension we want to search. Here we use a @fdate extension to display the date on which files were modified.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">forfiles /S /M *.jpg /C "cmd /c echo @relpath @fdate"</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://4.bp.blogspot.com/-eRZRt5C4DZI/XGxAZfSAc9I/AAAAAAAAcyk/lxvTYawSv9IP7kRDmRnyc2M2JPSAjK8xwCLcBGAs/s1600/6.png" alt="remote PC forensics investigation" width="1137" height="588"/></span></p>
<h3><span style="color: #800000;">List all the sub-directories inside any directory</span></h3>
<p><span style="color: #000000;">In a scenario where we want to list all the subdirectories inside a directory, we can use this command. Here we are using a logical statement to check the condition that the selected file is a directory or not. This is being checked using the @isdir extension.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">forfiles /m * /c "cmd /c if @isdir==TRUE echo @file"</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://4.bp.blogspot.com/-OHzX5HVasYE/XGxAZd_-nRI/AAAAAAAAcyo/PzxEjQtRLD8wfeCuwBXHltiSUITSc6xWQCLcBGAs/s1600/7.png"/></strong></span></p>
<h3><span style="color: #800000;">List all the files of a particular extension and Size</span></h3>
<p><span style="color: #000000;">In a scenario where we want to list the files with a particular extension and size, we can use this command. We specified the extension .txt this can be any extension we want to search. We use @fsize to specify the file size. Also, we use LSS to limit the size of the files to a specified size.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">forfiles /S /M *.txt /C "cmd /c if @fsize LSS 1000 echo @file"</pre>
<p><span style="color: #000000;"><strong> <img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-HB1WZ7tNmS0/XGxAaLK6iAI/AAAAAAAAcys/jGHQoDf9ypsnhWYqFTP2_QAhawUdE9WigCLcBGAs/s1600/8.png" alt="remote PC forensics investigation" width="631" height="512"/></strong></span></p>
<h3><span style="color: #800000;">Backup files modified on a particular date</span></h3>
<p><span style="color: #000000;">In a scenario where we want to take a backup or copy all the files that were modified on a particular date, we can use this forfiles command. Here we are using the date switch to define the number of days. We can change the number of days with /D to our requirement. Here we need to keep in mind that we need to first create the folder where we want to take backup otherwise, this command won’t get executed properly.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">forfiles /D 18-02-2019 /M * /C "cmd /c copy @file C:\backup\"</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://3.bp.blogspot.com/-Uvl6NjfSV8A/XGxAaifh4cI/AAAAAAAAcyw/QyA_CgWUPaYBjvIdF5Ql-O4xaRA8UUagACLcBGAs/s1600/9.png"/> </strong></span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Delete files of a particular extension </span> </span></h3>
<p><span style="color: #000000;">In a scenario where we want to delete some files, we can use this command. Here we are using the /c parameter to specify the del command that will delete files. Also, we are specifying an extension to sort the files to delete. We can use any condition instead of the extension and the command will work fine. Here we need to keep in mind that we need to run this command in the directory where we want to delete files. Like in our case we used it a directory named Test</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">forfiles /S /M *.txt /C "cmd /c del @file"</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://3.bp.blogspot.com/-ulT5nh-L6KA/XGxAWzrpr0I/AAAAAAAAcyI/RMc4CtcSu_cZM6LgP0fmUXNUFVhDr-tegCLcBGAs/s1600/10.png" alt="remote PC forensics investigation" width="544" height="80"/></span></p>
<p><span style="color: #000000;">To learn more about Cyber Forensics. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/cyber-forensics-tricks/">Link</a></strong></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester Contact <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/pavandeep-singh-6b1074132" target="_blank" rel="noopener" data-saferedirecturl="https://www.google.com/url?q=https://www.linkedin.com/in/pavandeep-singh-6b1074132&amp;source=gmail&amp;ust=1542651210170000&amp;usg=AFQjCNEYOzlThg6B1HzKcEZNou4HowCJ2Q">here</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
