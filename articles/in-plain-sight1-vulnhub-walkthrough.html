<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">In Plain Sight:1: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/in-plain-sight1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-12-08T16:48:32+00:00">December 8, 2019</time><time class="updated" datetime="2025-06-10T20:10:52+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In today’s article, we will face an Intermediate challenge. Introducing the In Plain Sight:1 virtual machine, created by “<a style="color: #000000;" href="https://twitter.com/bzyo_">bzyo_</a>” and is available on Vulnhub. This is another Capture the Flag challenge where we have to escalate privileges to find the root flag to complete the challenge.</span></p>
<p><span style="color: #000000;">Since these labs are available on the Vulnhub Website. We will be downloading the lab file from this <a style="color: #000000;" href="https://www.vulnhub.com/entry/in-plain-sight-1,400/">link</a>.</span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<ul>
<li><strong><span style="color: #000000;">Network Scanning</span></strong>
<ul>
<li><span style="color: #000000;">netdiscover</span></li>
<li><span style="color: #000000;">nmap port scan</span></li>
</ul>
</li>
<li><strong><span style="color: #000000;">Enumeration</span></strong>
<ul>
<li><span style="color: #000000;">FTP Enumeration</span></li>
<li><span style="color: #000000;">Browsing HTTP Service</span></li>
<li><span style="color: #000000;">Enumerating the wordpress</span></li>
</ul>
</li>
<li><strong><span style="color: #000000;">Exploitation</span></strong>
<ul>
<li><span style="color: #000000;">Get a meterpreter session</span></li>
</ul>
</li>
<li><strong><span style="color: #000000;">Post Exploitation</span></strong>
<ul>
<li><span style="color: #000000;">Reading passwords from file</span></li>
<li><span style="color: #000000;">Login into MySQL to find hashes</span></li>
<li><span style="color: #000000;">Using john to crack the hashes</span></li>
</ul>
</li>
<li><strong><span style="color: #000000;">Privilege Escalation</span></strong>
<ul>
<li><span style="color: #000000;">Using su command</span></li>
<li><span style="color: #000000;">Finding password</span></li>
<li><span style="color: #000000;">Checking for SUID</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #000000;">Walkthrough</span></h3>
<h3><span style="color: #800000;">Network Scanning</span></h3>
<p><span style="color: #000000;">The first step is to identify the target. So, to identify our target we will use the following command:</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--Z1u0a1VaeM/Xe0dtrjGsWI/AAAAAAAAh1Q/aF08lD-IVagN4jJD-TxReCMIW1tSjGckACEwYBhgL/s1600/1.png" border="0" data-original-height="197" data-original-width="808"/>Now we will use Nmap to gain information about the open ports and the services running on the target machine and for this, type the following command :</span></p>
<pre class="lang:default decode:true">nmap -p- 192.168.43.8</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PW91KRfChOo/Xe0dxQQLR-I/AAAAAAAAh1U/kt42gCdx_hEp_lCPklGnluA9fB4Js315gCEwYBhgL/s1600/2.png" border="0" data-original-height="249" data-original-width="480"/></span></p>
<p><span style="color: #000000;">From the nmap scan, we can see that Port 21, 22, 80 are open, it means we have the FTP, SSH and HTTP services running simultaneously. Firstly, let’s try enumeration with an anonymous login on FTP.</span></p>
<pre class="lang:default decode:true ">ftp 192.168.43.8
ls
get todo.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TYkbqWi-4QA/Xe0d1fWlBCI/AAAAAAAAh1Q/tqhDBg664qMDyed1jLnLl-k0li1hnxodQCEwYBhgL/s1600/3.png" border="0" data-original-height="423" data-original-width="722"/></span></p>
<p><span style="color: #000000;">After logging in anonymously, we can see that there is a file todo.txt. Download this file using the get command. The content of todo.txt file doesn’t seem to be useful. You can read the file by using cat command.</span></p>
<p><span style="color: #000000;">As FTP wasn’t useful to us, we can now browse the website to see if we can find some information. And for this, open the IP address in our browser.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-NX0rnqKNqGc/Xe0d2fi1jzI/AAAAAAAAh1I/OLfdxdAZu_Uh9MSYr17U7fBdmPtTqi_SQCEwYBhgL/s1600/4.png" border="0" data-original-height="364" data-original-width="807"/></p>
<p> </p>
<p><span style="color: #000000;">This is an Apache2 Ubuntu Default page but after exploring it carefully we can see a line hinting to “/var/www/html/index.htnl”. So, let’s explore this page.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ZBoFUZRX3SI/Xe0d2sty_uI/AAAAAAAAh1U/CIX3ox0eHB4oM-CQYyGrTtFRKvmM0Hl_QCEwYBhgL/s1600/5.png" border="0" data-original-height="548" data-original-width="863"/></p>
<p> </p>
<p><span style="color: #000000;">This page looks like a normal page but when we click anywhere on the page then it will lead us to the following new webpage :</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-72xwqqOFSp0/Xe0d2-ucatI/AAAAAAAAh1M/8gSpEIo91wA5oGYwk5IevyVuGJ-yPOuDQCEwYBhgL/s1600/6.png" border="0" data-original-height="143" data-original-width="689"/></p>
<p> </p>
<p><span style="color: #000000;">As we can see that this webpage lets you upload any image. So here we tried to upload the image and we succeed but when we try to upload a .php file the webpage give us an error. Upon exploring more, the URL of the webpage caught our attention and you can see that it looks like a hash so we copied it and tried to crack it by using the john.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ZA_Z8tlXlgA/Xe0d3dRftxI/AAAAAAAAh1M/9hgISdeloAwf9pBF0noH7RwL0ZRdGXEjwCEwYBhgL/s1600/7.png" border="0" data-original-height="347" data-original-width="599"/></p>
<p><span style="color: #000000;">It was <strong>“goodluck”</strong>. At this point, we were just being trolled.</span></p>
<p><span style="color: #000000;">We then tried to upload a simple .php file and when uploading a .php file we come across the following error :</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-41t2wGnhNHg/Xe0d3dgb0AI/AAAAAAAAh1Q/SqK-P8LO6Pc_LNp3BGdeSGJ9YOex29z_QCEwYBhgL/s1600/8.png" border="0" data-original-height="162" data-original-width="782"/></p>
<p><span style="color: #000000;">But this error leads us to a new page “upload.php”. Let’s check the source code of this page.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-sT-h9xniBm8/Xe0d3k4UjpI/AAAAAAAAh1Q/0FSP0vSSKowyn5nmlB7QaWUSJmlq3FjCACEwYBhgL/s1600/9.png" border="0" data-original-height="155" data-original-width="469"/></p>
<p><span style="color: #000000;">Yes! There is a comment at the end of the source code. And this is a base64 encoded text, so let’s try to decode it by using the following command :</span></p>
<pre class="lang:default decode:true">echo c28tZGV2LXdvcmRwcmVzcw== | base64 -d</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-kSRTBj9izhM/Xe0dtkf5dgI/AAAAAAAAh1A/ZmupdkyzdhsJ17_RVKfo6Wqpw_QDpRDnACEwYBhgL/s1600/10.png" border="0" data-original-height="52" data-original-width="635"/></p>
<p><span style="color: #000000;">When the text is decoded, it looks like a directory or a webpage. But before exploring it let’s see if there are more pages or not. Hence, use dirbuster.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-qfGsI0-lGtU/Xe0dtptsFrI/AAAAAAAAh1E/uhCqzSVnZLYNz5Wq7jA8w5mYuiZzSkilACEwYBhgL/s1600/11.png" border="0" data-original-height="508" data-original-width="676"/></p>
<p><span style="color: #000000;">There are many pages and as the result shows us that CMS is wordpress, therefore, we can use wpscan to plow through the two specified pages that mentions wordpress. And for that use the following command :</span></p>
<pre class="lang:default decode:true">wpcan --url "http://192.168.43.8/wordpress" --enumerate</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-79bUxxMV-DY/Xe0du5zliBI/AAAAAAAAh1U/1yACRnXyQWoU5Py74erIcUSXkzNm04IDwCEwYBhgL/s1600/12.png" border="0" data-original-height="214" data-original-width="765"/></p>
<p><span style="color: #000000;">Similarly, let’s enumerate the other page.</span></p>
<pre class="lang:default decode:true">wpcan --url "http://192.168.43.8/so-dev-wordpress" --enumerate</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NfmPDkBkb9E/Xe0duwBwcaI/AAAAAAAAh1M/cngjfO-TzZgeU7aAbnGvwUSpx4hnmc7vQCEwYBhgL/s1600/13.png" border="0" data-original-height="298" data-original-width="707"/></span></p>
<p><span style="color: #000000;">As you can see in the above image there are three users. And we have their usernames, we can simply use bruteforce to find their respective passwords and for that type :</span></p>
<pre class="lang:default decode:true">wpscan --url "http://192.168.43.8/wordpress" -U bossperson -P /usr/share/wordlists/dirb/common.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Nxo4QhKMsf0/Xe0du7SAQeI/AAAAAAAAh08/SP4roR10X0IDnRKyh9X-z7qxvLCjwhE8QCEwYBhgL/s1600/14.png" border="0" data-original-height="267" data-original-width="1187"/></p>
<p><span style="color: #000000;">Alas, we couldn’t find any password but not to worry as we can run the same command for the other page, let’s try it by typing :</span></p>
<pre class="lang:default decode:true">wpscan --url "http://192.168.43.8/so-dev-wordpress" -U admin,mike -P /usr/share/wordlists/dirb/common.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BGU3pbSngaw/Xe0idmPpGcI/AAAAAAAAh1s/FWI8kq-3euoov3VMVbX8xUq5pkbrMEvqQCLcBGAsYHQ/s1600/15.png" border="0" data-original-height="227" data-original-width="784"/></span></p>
<p><span style="color: #000000;">And so, we finally found the password for the user admin. So now, let’s try to upload a shell using msfconsole. And through Metasploit we will use <strong>exploit/unix/webapp/wp_admin_shell_upload</strong>.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-2BfMqwpo9yc/Xe0ieSH9IVI/AAAAAAAAh10/oWVM47tFdPMPJ-W8EBQ5_jOU8zjD5rCkwCLcBGAsYHQ/s1600/16.png" border="0" data-original-height="651" data-original-width="697"/></p>
<p><span style="color: #000000;">Once the exploit is initiated, type the set of following commands :</span></p>
<pre class="lang:default decode:true">set PASSWORD admin
set RHOST 192.168.43.8
set USERNAME admin
set TARGETURI /so-dev-wordpress
exploit</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-AWHHm4mVWMI/Xe0ieuZMIKI/AAAAAAAAh14/JAqDbdOigjIL_uq3G6igzZPB64gZdGMXACLcBGAsYHQ/s1600/17.png" border="0" data-original-height="538" data-original-width="891"/></p>
<p><span style="color: #000000;">As you can see, we are successful in getting our session, let’s move onto shell of the target system and for that type shell and hit enter. And the next thing you know is you are in the shell of the target system. Now to get a proper authenticated session of shell type the following command :</span></p>
<pre class="lang:default decode:true">python3 -c 'import pty;pty.spawn("/bin/sh")'</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-WZTNuoOCnms/Xe0ie_8uSQI/AAAAAAAAh18/9QvbubQUSWYZzmWnumSe5QJDkCGG_KajACLcBGAsYHQ/s1600/18.png" border="0" data-original-height="243" data-original-width="553"/></p>
<p><span style="color: #000000;">As we have managed to get a shell. So now, we will explore the system more to find some useful files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QtmPzku1_FU/Xe0ifYXLYMI/AAAAAAAAh2A/sEJQZVcnjvoYedIEZUIX6J1ulRmwybozwCLcBGAsYHQ/s1600/19.png" border="0" data-original-height="366" data-original-width="817"/>Upon changing the directory, we found wp-config.php. as it is a config file, there’s bound to be useful information. Thus, we will try to read it’s content using the cat command :</span></p>
<pre class="lang:default decode:true">cat wp-config.php</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-PYSpgvs99Ss/Xe0if7ljCYI/AAAAAAAAh2I/B1BYOlI1CcALJwb4OL4WJtE4tJ4nfHNCACLcBGAsYHQ/s1600/20.png" border="0" data-original-height="212" data-original-width="837"/><span style="color: #000000;">These credentials are of MySQL as you can see the prefix DB used which probably stands for the database. So, we can try to login into mysql using these credentials and therefore, use the following commands :</span></p>
<pre class="lang:default decode:true">bash
mysql -u sodevwp -p</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-wDRUFyH1ZkY/Xe0igfA1pcI/AAAAAAAAh2M/ix0MozKiRk0ho0r09MHXvFbWoHqgBTCfgCLcBGAsYHQ/s1600/21.png" border="0" data-original-height="402" data-original-width="817"/><span style="color: #000000;">Yes, we are in! Let’s try and explore it further.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-i3DwmJ_AXk8/Xe0ihDFKu8I/AAAAAAAAh2Q/hML-kBUPQkIeDBbQQQY5xAl9Ll0AScj-gCLcBGAsYHQ/s1600/22.png" border="0" data-original-height="356" data-original-width="886"/></p>
<p><span style="color: #000000;">We found a database “sodevwp” and hence, to change the database type :</span></p>
<pre class="lang:default decode:true">show databases;
use sodevwp
show tables;
select * from sodevwp_users;</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-MsCCPz-gIhs/Xe0ihblrwCI/AAAAAAAAh2U/ygjKeim6FAsy9PBoJnKumOIQ-q2GuzlqQCLcBGAsYHQ/s1600/23.png" border="0" data-original-height="591" data-original-width="601"/></p>
<p><span style="color: #000000;">Once the above commands are used successfully, you will find the following two hashes :</span></p>
<p><span style="color: #000000;"><strong>$P$BD/ZmfBIhgjHKtkLpPKfhr2t5EDgZA. (for user admin)</strong></span></p>
<p><span style="color: #000000;"><strong>$P$B3halPOgh4jqI1tDelkv5TGAHnaOC01 (for user mike)</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-4wCIuofw6qc/Xe0ihqgwe3I/AAAAAAAAh2Y/1pJm64pKPJoR2g2jkF-VPPQDyDrc8BcUACLcBGAsYHQ/s1600/24.png" border="0" data-original-height="363" data-original-width="998"/></p>
<p><span style="color: #000000;">We will now use john the riper with rockyou wordlist to crack these hashes and for that type :</span></p>
<pre class="lang:default decode:true">john cracker -wordlist=/usr/share/wordlists/rockyou.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-OQCqa5UzzF8/Xe0iiDdneXI/AAAAAAAAh2c/-QmRAifxV2wcJ9SDGKUon9kEU4HM5HRHgCLcBGAsYHQ/s1600/25.png" border="0" data-original-height="255" data-original-width="760"/></p>
<p><span style="color: #000000;">As you can see in the image above that we found our passwords to the two major users and those are :</span></p>
<p><span style="color: #000000;"><strong>admin:admin1</strong></span></p>
<p><span style="color: #000000;"><strong>mike: skuxdelux</strong></span></p>
<p><span style="color: #000000;">Now, try and switch the user to mike and you can observe in the image below that you can successfully do that; which means cracking the passwords was successful.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-R0Wvwx9MXDY/Xe0iiopWysI/AAAAAAAAh2g/CXg7CQIOfckf3a5b48LiCBk8hT3zD_ouwCLcBGAsYHQ/s1600/26.png" border="0" data-original-height="275" data-original-width="769"/></p>
<p><span style="color: #000000;">Let’s move on for privilege escalation. Now, when you change your directory to /home and there you found a new user <strong>“joe”</strong></span></p>
<p><span style="color: #000000;">And without wasting any time we traversed through <strong>etc/passwd</strong>.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-FTxBF-6w2sk/Xe0ii76pAII/AAAAAAAAh2k/Z2YVW8ZptjcJri00pJ00OhastlFtoKSEQCLcBGAsYHQ/s1600/27.png" border="0" data-original-height="270" data-original-width="746"/></p>
<p><span style="color: #000000;">With etc/passwd we found out that password to <strong>‘joe’</strong> is <strong>SmashMouthNoThanks</strong>. So now, let’s switch the user to joe with the foretold password.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-JsuG4GhQ5RE/Xe0ii_nf18I/AAAAAAAAh2o/wAk_MRBZnbg4ilEmXx-6mumqnLB6h677QCLcBGAsYHQ/s1600/28.png" border="0" data-original-height="195" data-original-width="572"/></p>
<p><span style="color: #000000;">And just like that, we have access to the user ‘joe’.</span></p>
<p><span style="color: #000000;">Now to move forward the only thing we have to do is to get the last flag of the target. And to get it we check for <strong>SUID</strong> using the command find. -perm /4000. Before executing this command, we will change our directory to “/” and after running the command we find the following useful binaries.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-6f-auDCboFc/Xe0ijuwDY7I/AAAAAAAAh2s/rp-8H_uDopIXkENUBtzSBxMrgYfsSdFwwCLcBGAsYHQ/s1600/29.png" border="0" data-original-height="495" data-original-width="534"/></p>
<p><span style="color: #000000;">And in <strong>/bwrap</strong> we found our last flag which you can observe from the image below :</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-DEH_iF05O50/Xe0ij5SZhFI/AAAAAAAAh20/gBFPeBDapREAwi3-10GzzY54j5_LSt5FgCLcBGAsYHQ/s1600/30.png" border="0" data-original-height="257" data-original-width="874"/></p>
<p><span style="color: #000000;">Read the flag using cat command as shown in the image below :</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-aMXwRFiKERg/Xe0ik4QrKfI/AAAAAAAAh24/8E9dR1aggBwx23NtLv-6QDGjAyqT4g1uQCLcBGAsYHQ/s1600/31.png" border="0" data-original-height="306" data-original-width="685"/></p>
<p><span style="color: #000000;">VOILA!! We have completed the challenge.</span></p>
<p><span style="color: #000000;"><strong>Author: Yash Saxena </strong>an undergraduate student pursuing B. Tech in Computer science and engineering with a specialization in cybersecurity and forensics from DIT University, Dehradun.</span><strong><span style="color: #000000;"> Contact</span> </strong><strong><a href="https://www.linkedin.com/in/yash-saxena-412349161/">here</a></strong>.</p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
