<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the DerpNStink VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-derpnstink-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2018-03-18T18:44:59+00:00">March 18, 2018</time><time class="updated" datetime="2025-06-10T20:29:53+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF challenge known as DerpNStink. The credit for making this vm machine goes to “Bryan Smith” and it is another capture the flag challenge in which our goal is to capture all the flags to complete the challenge. You can download this VM <a style="color: #000000;" href="https://www.vulnhub.com/entry/derpnstink-1,221/#download">here</a>.</span></p>
<p><span style="color: #000000;">Let’s Breach!!!</span></p>
<p><span style="color: #000000;">Let us start form getting to know the IP of VM (Here, I have it at 192.168.1.102 but you will have to find your own)</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-0UVBIfx1g9o/Wq6pL0IW7wI/AAAAAAAAVaU/4Lb1HoupTjA5HgGj4zzkg2V5P2inurGMwCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Use nmap for port enumeration</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.102 --open</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-HcJLKwmTWZs/Wq6pOqzZSkI/AAAAAAAAVaY/gV_D-b_vTtQ8ETwpqDDmX5Oadcxeo701wCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Nmap scan tells us port 21,22 and 80 are open. As port 80 is running http server we open the ip in our browser and run dirb scan.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.102/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-wQjYcLIUbO4/Wq6pQBpYhrI/AAAAAAAAVac/CgTIQiA0TxIWsJF-BGytAFPT_fSlfoIeACEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Dirb scan shows that the server has wordpress, and when we open /weblog/ directory. When we open /weblog/ directory we get redirected to derpnstink.local/weblog/</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-cPPV-mv9CSQ/Wq6pQbCsU_I/AAAAAAAAVaM/lkMICjI9XW0CHIurC2OlKdmDQ6WN4qzcwCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">So we add domain name in hosts file to get access to the site.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-UVx5NKWhs3U/Wq6pQjJgo_I/AAAAAAAAVaM/1Wr9NxBQbiMufDuH7TsHKEWIc3-vYwyoQCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We first open the site using the domain to check if something has changed in website, when we take look at the source code of the page we find our first flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-4qhydvc5nes/Wq6pRD9BUDI/AAAAAAAAVaM/i-jTmGyzvn8jlWyZo_g5Jgq4h7_MOFC5gCEwYBhgL/s1600/6.1.png"/></span></p>
<p><span style="color: #000000;">Now when we open http://derpnstink.local/weblog we find that it a wordpress site.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ZfPFwnGw7xA/Wq6pRWrHJaI/AAAAAAAAVaY/E0vmUrkXNUIDNWhxl4L9FwMwfB-5Xrg3QCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We use wpscan to enumerate the plugins and themes and users.</span></p>
<pre class="lang:default decode:true">wpscan –u http://192.168.1.102/weblog --enumerate at --enumerate ap –enumerate u</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-MaWEF8vT0Fc/Wq6pRa-C7zI/AAAAAAAAVaU/dGG9YvNW_90Q5BjOlROwnOaKFucrh19wQCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Wpscan shows us that a plugin is exploitable.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-6VJzryPjV38/Wq6pRl0fVII/AAAAAAAAVaQ/YhsWn3Bk-FUBGBzVckdP6jghAXIPVXjcACEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">We also find username and password to be admin for both.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-3akdC5pAEn4/Wq6pR20DbnI/AAAAAAAAVaY/cdqCDKa8puUEhPMSnH_KbwwawKvcT0IfACEwYBhgL/s1600/9.1.png"/></span></p>
<p><span style="color: #000000;">We use metasploit to exploit this vulnerability.</span></p>
<pre class="lang:default decode:true  ">msf &gt; use exploit/unix/webapp/wp_slideshowgallery_upload
msf exploit(unix/webapp/wp_slideshowgallery_upload) &gt; set rhost 192.168.1.102
msf exploit(unix/webapp/wp_slideshowgallery_upload) &gt; set targeturi /weblog
msf exploit(unix/webapp/wp_slideshowgallery_upload) &gt; set wp_user admin
msf exploit(unix/webapp/wp_slideshowgallery_upload) &gt; set wp_password admin
msf exploit(unix/webapp/wp_slideshowgallery_upload) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-o6rCy6EoyeI/Wq6pSPJrkrI/AAAAAAAAVaU/L3RTj_yt77QTxf9qQtkMcwgeBcrEZXONgCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">After getting reverse shell we open wp-config.php and find the name of the database and the user required to access the database.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-CIDF_5QB6Yo/Wq6pLuItOoI/AAAAAAAAVac/Eawx4DW_f6QkV9ozOCo0Dhn0S3CdsXICQCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">We find the username and password required through mysql.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ggx6zjkLNPI/Wq6pLphEfyI/AAAAAAAAVaM/s3Dia_q2Ky0BY0CSXqbnvgVxKXGa0xUEgCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">We also find two directories we cannot access that also hints us the username.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-F5mS0J0Eehk/Wq6pMSnS66I/AAAAAAAAVaM/m6j6LphF5fUuTOpjun_Tg7pshSyxIfwfwCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">We use the information we find in the wordpress configuration file to login through phpmyadmin.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gSIYjYyJH5c/Wq6pMYNdVMI/AAAAAAAAVaY/Jecj2g_8ZNIty08q2VAHckGGKE1HEkL9gCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">After logging through phpmyadmin, we find two hashes in wordpress database.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-B0WwaAl7HUo/Wq6pMi-kSOI/AAAAAAAAVaY/3TMCTofm288aD0FJBTJ5Q4kSJ_6mWzdTQCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">We use john the ripper to crack the hashes and find a password for stinky as wedgie57.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-mv5ggwBLr40/Wq6pM_xcybI/AAAAAAAAVaU/KIJl32dytGMvGaYSFLFLwYob5pYKhlbYQCEwYBhgL/s1600/15.0.png"/></span></p>
<p><span style="color: #000000;">When we login through wordpress using username stinky and password wedgie57, we find 2<sup>nd</sup> flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--edCaFUHtU0/Wq6pNMWgoHI/AAAAAAAAVaY/6-GTCp8LdKoh9-pq1IIKZjYfKAeUSQLeACEwYBhgL/s1600/15.1.png"/></span></p>
<p><span style="color: #000000;">We now login to the system through user stinky and password wedgie57. Now going through the system we find our 3<sup>rd</sup> flag. We also find a pcap file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-MnvRo9G_KTk/Wq6pNIHJAsI/AAAAAAAAVaQ/INXYJj4wnN8k2ESc-y822mTB78NugmiMQCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Enumerating through the system we find a file called derpissues.txt that we hints us to use the pcap file we found earlier.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-3IUXIbYS0sQ/Wq6pNjVOmkI/AAAAAAAAVaY/61wLIzs8DBsH7-u5oLS9tC996HHuzbZCQCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Going through the files we found a ssh key, but we were unable to login through ssh using this key.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Q5MxnqvqDWA/Wq6pN_FtO5I/AAAAAAAAVac/8LzkWJ-9Q1YDt9U6wAiUV1nOphnSZTtRwCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now we copy the pcap file into the ftp directory, to download the file into our system through ftp.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-O_QJ7A22-dQ/Wq6pN_9GE-I/AAAAAAAAVaU/5WqbZd2mUT8ItcswpdpBXnX_Hstdzq05ACEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">We connect to the target machine through ftp and download the pcap file into our system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ssMkRaXasDw/Wq6pOSxdGdI/AAAAAAAAVaM/Qvonxmt8KKcT_IFDMkmIgePV-L3P1Pf3wCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">After download the file into our system we open it in wireshark and find the password for the other user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-RUGwUHAygHg/Wq6pO9XxRLI/AAAAAAAAVaU/IAb2RAcKydkywTRReXgRJZ1HC8bOcI4PwCEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Now we login as mrderp and take a look at the sudoers file and find that we can run a file that starts with derpy as root in /home/mrderp/binaries/derpy*</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-eC-grqWEMwo/Wq6pPNt5SkI/AAAAAAAAVaY/hU4gHdwJ1IkwSdXSl68mXqxFesKSVbfdACEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">To run our file as root we create a directory called binaries in /home/mrderp/ directory</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-FtQ7SEOWNEU/Wq6pPMgMwDI/AAAAAAAAVaQ/-WDpEXgeFGU7Et-Wp74kDTPkZ4sL0GoWgCEwYBhgL/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Now we create a bash script to spawn to bash shell and save it as derpy.sh</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-V2UNiAun0QI/Wq6pPvwHSVI/AAAAAAAAVaQ/gNArOSYJ_mA5XnkO-g14XkrV_lkUJVJtgCEwYBhgL/s1600/23.png"/></span></p>
<p><span style="color: #000000;">After creating the file we give it read write executable permission and run the file. As soon as we run the file we get the root shell. Going through the files in /root/Desktop directory we find a file called flag.txt, when we open it we find our 4<sup>th</sup> flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-EYJsPjGIL2k/Wq6pQF1hzcI/AAAAAAAAVaM/tMcuB2mfgSo6FUrq71e4PVDpJl5c8nRwQCEwYBhgL/s1600/24.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
