<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/threat-hunting/" rel="category tag">Threat Hunting</a></span>            </div>
            <h1 class="post-title entry-title">AlienVault: OSSEC (IDS) Deployment</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/alienvault-ossec-ids-deployment/" rel="bookmark"><time class="entry-date published" datetime="2020-10-23T09:32:48+00:00">October 23, 2020</time><time class="updated" datetime="2025-05-13T08:00:20+00:00">May 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we will discuss of Deployment of OSSEC (IDS) agents to the AlienVault server.</span></p>
<p><span style="color: #000000;">OSSEC is an open-source, host-based intrusion detection system (commonly called IDS) that market itself as the world’s most widely used intrusion detection system that performs or helps us to Monitor: –</span></p>
<ul>
<li><span style="color: #000000;">Network Anomalies</span></li>
<li><span style="color: #000000;">Log analysis</span></li>
<li><span style="color: #000000;">Integrity Checking</span></li>
<li><span style="color: #000000;">Windows registry monitoring</span></li>
<li><span style="color: #000000;">Rootkit detection</span></li>
<li><span style="color: #000000;">Process monitoring</span></li>
<li><span style="color: #000000;">Real-time alerting</span></li>
<li><span style="color: #000000;">Active response</span></li>
<li><span style="color: #000000;">Policy monitoring</span></li>
</ul>
<p><span style="color: #000000;">Intrusion detection systems are customizable like a firewall and also, they can be configured to send alarm messages upon a rule’s instruction to automatically answer to the threat or warning as for your network or device.</span></p>
<p><span style="color: #000000;">OSSEC (IDS) can warn us against DDOS, brute force, exploits, data leak, and more external attacks. it monitors our network in real-time and interacts with us and with our system as we decide. It can be used to monitor one server or thousands of servers in a server/agent mode.</span></p>
<h3><span style="color: #800000;"><strong>Table of content</strong></span></h3>
<p><strong><span style="color: #000000;">For Linux</span></strong></p>
<ul>
<li><span style="color: #000000;">Prerequisites</span></li>
<li><span style="color: #000000;">Required dependencies</span></li>
<li><span style="color: #000000;">Download OSSEC source code</span></li>
<li><span style="color: #000000;">Extract &amp; install OSSEC agent from source code</span></li>
<li><span style="color: #000000;">Installation of OSSEC HIDS Agent</span></li>
<li><span style="color: #000000;">Deploying OSSEC Agent to OSSEC server</span></li>
<li><span style="color: #000000;">Running OSSEC Agent</span></li>
</ul>
<p><strong><span style="color: #000000;">For Windows</span></strong></p>
<ul>
<li><span style="color: #000000;">Download OSSEC agent for Windows</span></li>
<li><span style="color: #000000;">Install OSSEC agent</span></li>
<li><span style="color: #000000;">Generate OSSEC key for the agent</span></li>
<li><span style="color: #000000;">Run and verify OSSEC agent is connected or running</span></li>
</ul>
<h3><span style="color: #800000;">Prerequisites</span></h3>
<ul>
<li><span style="color: #000000;">Ubuntu 20.04.1</span></li>
<li><span style="color: #000000;">Windows 10</span></li>
<li><span style="color: #000000;">Root or Admin privileges</span></li>
</ul>
<p><span style="color: #000000;">For Ubuntu 20.04.1</span></p>
<h3><span style="color: #800000;">Required Dependencies</span></h3>
<p><span style="color: #000000;">To install OSSEC agent on Ubuntu 20.04.1 there are some requirement need to be installed before agent installation as listed below: –</span></p>
<ul>
<li><span style="color: #000000;">GCC</span></li>
<li><span style="color: #000000;">Make</span></li>
<li><span style="color: #000000;">Libevent-dev</span></li>
<li><span style="color: #000000;">Zlib-dev</span></li>
<li><span style="color: #000000;">Libssl-dev</span></li>
<li><span style="color: #000000;">Libpcre2-dev</span></li>
<li><span style="color: #000000;">Wget</span></li>
<li><span style="color: #000000;">Tar</span></li>
</ul>
<p><span style="color: #000000;">You can download this all requirement by simply running this command: –</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">apt install gcc make libevent-dev zlib1g-dev  libssl-dev libpcre2-dev wget tar</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-AL_PBpK_cZQ/X5KdG2DR50I/AAAAAAAApqU/_lZnUBZGHwANudG48BBxg1Ul6ibrsP4QgCLcBGAsYHQ/s16000/1.png"/></span></p>
<h3><span style="color: #800000;">Download OSSEC source code</span></h3>
<p><span style="color: #000000;">You can download the latest OSSEC source code from the Official<span style="color: #0000ff;"><strong> <a style="color: #0000ff;" href="https://github.com/ossec/ossec-hids/releases">release page</a> </strong></span>of GitHub or simply running this command: –</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget https://github.com/ossec/ossec-hids/archive/3.6.0.tar.gz -P /tmp</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-T7RoSIrwF94/X5KdOhuVCII/AAAAAAAApqY/c92fM60RFIoAMmx-VKEOFnU6l1FZwqg5wCLcBGAsYHQ/s16000/2.png"/></span></p>
<h3><span style="color: #800000;">Extract &amp; install OSSEC agent from source code</span></h3>
<p><span style="color: #000000;">Once the source download complete you can extract it by simply running this command</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp 
tar xzf 3.6.0.tar.gz</pre>
<p><span style="color: #000000;">In manner to install OSSEC agent navigate to the source code directory and run the installation script as shown below</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd ossec-hids-3.6.0/ 
./install.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QmKDSd01MA8/X5KdU6AqrDI/AAAAAAAApqc/Xzj2_UE0c40FSQH2zwPRHT9FPgCL42cfACLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">Further then select your installation language or press ENTER to choose default installation options and follow the steps as described below: –</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bmSaYXiaXwQ/X5KdewbDJsI/AAAAAAAApqo/geBdqsMYdhUDyUARWLUY345jVhJNa1BRwCLcBGAsYHQ/s16000/4.png"/></span></p>
<ul>
<li><span style="color: #000000;">Firstly, specify the type of installation. In our case, we install an OSSEC-HIDS agent, so we go with the option of the agent.</span></li>
<li><span style="color: #000000;">Next, choose the installation path. By default, we set it to /var/ossec, or we define the path as per our environment.</span></li>
<li><span style="color: #000000;">Then, enter the OSSEC-HIDS server IP or AlienVault server IP.</span></li>
<li><span style="color: #000000;">After that, enable the system integrity check.</span></li>
<li><span style="color: #000000;">Also, enable rootkit detection.</span></li>
<li><span style="color: #000000;">Depending on the need, enable or disable active directory response.</span></li>
<li><span style="color: #000000;">Once we finish defining the default options, we proceed to install the OSSEC agent by pressing ENTER.</span></li>
<li><span style="color: #000000;">Finally, we press ENTER to close the installer as shown below.</span></li>
</ul>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WzdtDuev3TM/X5KdjyM-g4I/AAAAAAAApqs/DDSa9yYfHvIKBGDH_wI5Mzk2yaF7DxVsACLcBGAsYHQ/s16000/5.png"/>v</span></p>
<h3><span style="color: #800000;">Deploying OSSEC agent to AlienVault server</span></h3>
<p><span style="color: #000000;">In a manner the agent to communicate with the server</span></p>
<ul>
<li><span style="color: #000000;">You need to first add it to the HIDS server or AlienVault server</span></li>
<li><span style="color: #000000;">After that extract, the agent authentication key from the AlienVault server</span></li>
</ul>
<p><span style="color: #000000;">To extract agent key from server, go to the AlienVault Web UI and then navigate to Environment &gt; Detection as shown below: –</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IA9VfXIadVk/X5KdolhpOhI/AAAAAAAApqw/EYtZX09UcrcvN6LmdVp1zRt9FeXrFzgWwCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Then select or add Agent where you installed OSSEC agent and then extract or copy the key as shown below</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0U5H5IXlr-U/X5Kdtaw8qjI/AAAAAAAApq0/ODI7RZC0syUhosrq4l6oD9Xr-fUbDIQ4QCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">Once you have extracted the key, Import the key on the agent simply by running the following command: –</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">/var/ossec/bin/manage_agents</pre>
<p><span style="color: #000000;"><strong>Enter I</strong>, paste the key that you copied from AlienVault Web UI and confirm adding the key then exit from the window by <strong>pressing Q</strong> as shown below</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BMeKIQO_lAw/X5Kdzk3IfGI/AAAAAAAApq8/_4-iRLJqe_kTn63M-jWTWs8D8alo6P3ugCLcBGAsYHQ/s16000/8.png"/></span></p>
<h3><span style="color: #800000;">Running OSSEC agent</span></h3>
<p><span style="color: #000000;">Once the installation completes starting the OSSEC agent simply by running the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">/var/ossec/bin/ossec-control start</pre>
<p><span style="color: #000000;">Or</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">systemctl start ossec</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yNORHrj8wPo/X5Kd4hpznNI/AAAAAAAAprA/qnbRfhuFTbAFy_1MnFmVNk_ba58zpzE3wCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">To stop the agent run the below command</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">/var/ossec/bin/ossec-control stop</pre>
<pre class="lang:default decode:true">Or</pre>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">systemctl stop ossec</pre>
<p><span style="color: #000000;">Other service control commands are described below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">/var/ossec/bin/ossec-control {start|stop|reload|restart|status}</pre>
<p><span style="color: #000000;">To check the status.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">/var/ossec/bin/ossec-control status</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-d9efM64QRmA/X5Kd-9N-v3I/AAAAAAAAprI/pulA97ZG1L0YNrD8r2jEIXjHpruLrTgAwCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">check the logs to see if the agent has connected to the server.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tail -f /var/ossec/logs/ossec.log</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NW-82kgUIQE/X5KeLlwa85I/AAAAAAAAprU/2_KHjCH8lvAwepdZjIdw3z1pWBsZSNHgQCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">As you can see the agent is successfully connected to the AlienVault server</span></p>
<p><span style="color: #000000;">Congratulations !!! you have successfully deployed your Ubuntu machine to the AlienVault server</span></p>
<h3><span style="color: #800000;"><strong>For Windows Machine</strong></span></h3>
<p><span style="color: #000000;">Download OSSEC agent for Windows</span></p>
<p><span style="color: #000000;">You can download the OSSEC agent for windows from the <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.ossec.net/ossec-downloads/">OSSEC official page</a></strong></span></span></p>
<p><span style="color: #000000;">Locate and select package Agent Windows ossec-agent-win-32-3.6.exe or the latest one as shown below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JqC8as7NPxw/X5KeQvunfdI/AAAAAAAAprc/JMR5gczsUYIVinoJX8ThNmcUQyuJsgG9gCLcBGAsYHQ/s16000/12.png"/></span></p>
<h3><span style="color: #800000;">Install OSSEC Agent</span></h3>
<p><span style="color: #000000;">Firstly, go to the Downloads and run the OSSEC agent installer and hit next as shown below </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_sKwIbb_FFI/X5KegiERsYI/AAAAAAAAprk/Dv6fuZTDpjcQHcXDhGFPFwJxmgpQd-k_wCLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">Then, choose the path where you want to install the OSSEC agent and hit install</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mTIneaDEoeQ/X5KelbL5gRI/AAAAAAAApro/2f7LhdEvNSsSyNbIPgwUBnT-se2S_4MNgCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Further, then wait for the setup completion and then hit next</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8AtSBQV4g-o/X5KequHXcvI/AAAAAAAAprs/vGo2Zx8vccgxWvqfr0bUH-AsihFF0ff5ACLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">Select finish and then exit from the installer.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kmN4wslLHWs/X5KexBsR6RI/AAAAAAAApr0/wWcuSx65GOYD2D451vTQL9moQjWgOSGZgCLcBGAsYHQ/s16000/16.png"/></span></p>
<h3><span style="color: #800000;">Generate OSSEC key for the agent</span></h3>
<h5><span style="color: #000000;"><strong>Follow the steps as described below:</strong></span></h5>
<ul>
<li><span style="color: #000000;">At the AlienVault Web UI, go to “Environment &gt; Detection &gt; HIDS.”</span></li>
<li><span style="color: #000000;">Next, go to Agents located in the top right corner.</span></li>
<li><span style="color: #000000;">Then, add a new agent.</span></li>
<li><span style="color: #000000;">Copy the key and use it on the agent as shown below.</span></li>
</ul>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-03KMzDXMMHo/X5Ke2wkPPJI/AAAAAAAApr8/vHODml3UhYgpwx189DuIWsQO1v67bDThwCLcBGAsYHQ/s16000/17.png"/></span></p>
<ul>
<li><span style="color: #000000;">Now, come back to the Windows machine.</span></li>
<li><span style="color: #000000;">Enter the AlienVault server IP and paste the key as shown below.</span></li>
</ul>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-H3-zi4kJQ8w/X5Ke8LDf8rI/AAAAAAAApsE/XmECrBBiQAoq4AGyuV8TivPgZLltQurfwCLcBGAsYHQ/s16000/18.png"/></span></p>
<ul>
<li><span style="color: #000000;">After that, confirm the agent deployment by pressing OK.</span></li>
</ul>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VRFL3O2OtFI/X5KfGUhgHjI/AAAAAAAApsM/Fix4nfb1YZQ4RJRVfJO7WTo_Vc8vNhzggCLcBGAsYHQ/s16000/19.png"/></span></p>
<ul>
<li data-start="373" data-end="600"><span style="color: #000000;">Run the OSSEC agent and verify it is connected or running.</span></li>
<li data-start="602" data-end="779"><span style="color: #000000;">After a successful deployment of the OSSEC agent, start the service by navigating to “Manage &gt; Start OSSEC,” as shown below.</span></li>
</ul>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QMo7cYFO4bw/X5KfLb80fII/AAAAAAAApsU/hadd09m5F6cn9pz29fTrxKuacNJqyqzdwCLcBGAsYHQ/s16000/20.png"/></span></p>
<ul>
<li data-start="602" data-end="779"><span style="color: #000000;">As you can see, the server started successfully.</span></li>
</ul>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_F40xFrBrRw/X5KfR9eYb-I/AAAAAAAApsc/wFJRcopWwswLkHgTuQrBKfHjlRk9LMHhwCLcBGAsYHQ/s16000/21.png"/></span></p>
<p><span style="color: #000000;">At this point, you can find a new Windows service in the OSSIM Web UI, as shown below.</span></p>
<h5 data-start="781" data-end="964"><strong><span style="color: #000000;">Congratulations! You have successfully deployed your Windows agent to the AlienVault server.</span></strong></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-R4STvOmn2_c/X5KfctCdpEI/AAAAAAAApso/kEYwzqgtjyYbGJBlglkKYfyOyLMLs1gFwCLcBGAsYHQ/s16000/22.png"/></span></p>
<p><span style="color: #000000;">Hmm…</span></p>
<p><span style="color: #000000;">Now, let’s verify it.</span></p>
<p><span style="color: #000000;">Check the logs of the Windows machine to ensure it is processing correctly.</span><br data-start="1065" data-end="1068"/><span style="color: #000000;">Do this by navigating to “Analysis &gt; Security Events (SIEM).”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3GqOSiUPjZg/X5KfkMhhVoI/AAAAAAAApsw/6iyuM6CXqEMmzKBxd93HPmm8a_0-qTAYgCLcBGAsYHQ/s16000/23.png"/></span></p>
<p><span style="color: #000000;">In this case, 192.168.1.7 is the IP address of the Windows machine.</span><br data-start="1200" data-end="1203"/><span style="color: #000000;">As we can see, the Windows machine started sending the processing logs.</span></p>
<p class="" data-start="1278" data-end="1311"><span style="color: #000000;">Hold tight! This is not enough…</span></p>
<p><span style="color: #000000;">Have patience …</span></p>
<p><span style="color: #000000;">In this article, we explained the Deployment of the OSSEC agent to AlienVault OSSIM.</span></p>
<p><span style="color: #000000;">In the next article, our focus will be on the <a href="https://www.hackingarticles.in/alienvault-threat-hunting-network-analysis/">Threat Hunting</a>, Malware analysis, network traffic monitoring, and <a href="https://www.hackingarticles.in/tag/alienvault/">much more</a>…</span></p>
<p><span style="color: #000000;"><strong>Author – </strong>Vijay is a Certified Ethical Hacker, Technical writer and Penetration Tester at Hacking Articles. Technology and Gadget freak. Contact <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/vijay-igcbr/">Here</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
