<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">DomDom: 1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/domdom-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-07-27T09:28:19+00:00">July 27, 2019</time><time class="updated" datetime="2025-06-10T20:11:28+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p>DomDom is another CTF challenge based on PHP mis-functionality and credit goes to Avraham Cohen for designing this VM. Here you need to identify bug to get reverse shell connection of the machine and try to access root shell. This VM can be downloaded from given below link and its level is set to easy for beginners.</p>
<p>Download Link: https://www.vulnhub.com/entry/domdom-1,328/</p>
<h3><span style="color: #800000;">Penetration<strong> Testing Methodology</strong></span></h3>
<p><b>Scanning</b></p>
<ul>
<li>Identify running service &amp; open Ports (Nmap)</li>
</ul>
<p><strong>Enumeration</strong></p>
<ul>
<li>Web Directories (DIRB)</li>
<li>Vulnerable to RCE (Burp Suite)</li>
</ul>
<p><strong>Exploit</strong></p>
<ul>
<li>Upload backdoor (PHP reverse shell)</li>
<li>Spawn shell (netcat session)</li>
</ul>
<p><strong>Privilege Escalation</strong></p>
<ul>
<li>Abusing Capability Permission</li>
<li>Spawn root shell</li>
</ul>
<p><strong><u>Walkthrough</u></strong></p>
<p><strong>Scanning </strong></p>
<p>Let’s start off with the scanning process. This target VM took the IP address of 192.168.1.135 automatically from our local Wi-Fi network.</p>
<p>Then we used Nmap for port enumeration. We found that port 80 is open for running http services.</p>
<pre class="lang:default decode:true">nmap -A 192.168.1.35</pre>
<p><img decoding="async" style="color: #000000;" src="https://1.bp.blogspot.com/-vmssrmblOMA/XTwULRK7-4I/AAAAAAAAfks/h1XHOAOrPzY4lkv03AEAk4iQEsfUi8JjACLcBGAs/s1600/1.png"/></p>
<p><span style="color: #000000;">Taking our manual penetrating approach ahead we navigate to a web browser and explore VM IP in the URL filed. It welcomed us with a login form as shown below in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0dC0uUa8w5I/XTwUNpH_PgI/AAAAAAAAflA/tz-lXjagH24qO7qsX7r-DkiwyU5kFJBywCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">So, we just simply type the following and then click on the execute tab:</span></p>
<p><span style="color: #000000;">Your Name: admin</span></p>
<p><span style="color: #000000;">Your Username: admin</span></p>
<p><span style="color: #000000;">Password: admin</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kIsad8SGswI/XTwUNhcrLvI/AAAAAAAAflE/xBr6MlElXAENVcch6Spkyj3cgLs7FaplACLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Since we didn’t find any clue to step ahead, therefore, we choose dirb for web directory enumeration. So, when I execute the below command, I found two URL with 200 OK code.</span></p>
<pre class="lang:default decode:true ">dirb http://192.168.1.35</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BJV9yBkvO3U/XTwUN7jTIgI/AAAAAAAAflI/YegO7Xb2hEA6nD5LGavBVITVEXIcOH9PACLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">So when we had explored /admin.php it gave me us a hint to dig more to identify the action being used here.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6YGIZ4oVZEU/XTwU64xyzaI/AAAAAAAAfmU/_tN9bnPhlQEIUVY3UxsRPquscDYq94R1QCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">So again I explore http://192.168.1.35 and intercept its data within the burp suite and then send the intercepted data into repeater to identify what action is being executed.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3wyWedtlKfI/XTwU6pLFJAI/AAAAAAAAfmY/XVPVvePjuN0MTkGg28TdA5aiw_3y8cBSACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">So, I forward the intercepted data into the repeater and at the initial phase, it captures the POST request for /index.php but inside repeater, we have changed the Post request from /index.php to /admin.php to identify the action.</span></p>
<p><span style="color: #000000;">Wow!! From its response, we found an in-built script which is executing the command.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-G9fhYHkrYKE/XTwU60vODhI/AAAAAAAAfmc/WvrEmkGHViwLmMdzc2XRDkhUojQ7wx1IACLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">To ensure the backend functionality, we try to send the request to execute “id” command and obtain the desired result as expected hence it is confirmed that it was vulnerable to Remote Code Execution.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DHWArB_r5lM/XTwU7r9ubQI/AAAAAAAAfmg/R44yyf0KL6Ia8JS28LL2l1NTBELuAI05ACLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Hence, I found the path where once can execute the malicious code or inject the malicious file inside the host machine to get the reverse connection machine.</span></p>
<p><span style="color: #000000;">Therefore, I grabbed a malicious file “php-reverse-shell” from inside /usr/share/webshells/php and modify the listening i.e. Kali Linux IP and named it backdoor.php.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yIsLLx-aEA4/XTwU8CJxF9I/AAAAAAAAfmk/oqZUDOk_VhwqZsNAFngLNdtaLGpoQAiRwCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Further, I try to inject our backdoor.php file inside the host machine and gave full permission to the malicious php file as shown in the image given below, further launch netcat listener in a new terminal to get the reverse connection.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UXQ6YJ4ZX1I/XTwU3s_h47I/AAAAAAAAfls/7_3uRkFtRGEbdwxhbID0C0NHAAiItzXsACLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now, once the file gets uploads successfully, we need to execute the malicious file as highlighted below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iqY02_TuLOw/XTwU4echWnI/AAAAAAAAfl4/vh8jvofwxnk9yrtp85TJ6yyGCHk63q9PACLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">As soon as you will execute the malicious file you get reverse shell through netcat. So, as you can observe that we have netcat session thus now we can step ahead for privilege escalation.</span></p>
<p><span style="color: #000000;">At this point, I was not sure what should be done to extract hidden flag, therefore, I thought to identify the binary capability files with the help of getcap and saw the fruitful result.</span></p>
<pre class="lang:default decode:true">nc -lvp 1234
whoami
getcap -r / 2&gt;/dev/null
</pre>
<p><span style="color: #000000;">On exploring further we found README.md from inside/home/domom/Desktop which is owned by root.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0P9plmuy3Uc/XTwU49f_-JI/AAAAAAAAfmA/UWlt2KVfPfgfSnAA852oUNztBEZ6-PM_wCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">As we have seen in the above image that “/bin/tar” has the capabilities to compress the file. It can manipulate its process UID and can be used on Linux as a backdoor to maintain elevated privileges with the CAP_SETUID capability set therefore I trigger the following command which will generate the .tar README.md inside /tmp directory</span></p>
<pre class="lang:default decode:true">cd /tmp
tar -cvf readme.tar /home/domom/Desktop/README.md</pre>
<p><span style="color: #000000;">when you will execute the above command, it will generate readme.tar file inside /tmp directory which could be extracted further to read README.md file.</span></p>
<pre class="lang:default decode:true">tar -xvf readme.tar
cat tar /home/domom/Desktop/README.md</pre>
<p><span style="color: #000000;">Great!! From inside this file, we have obtained the password for user “root” thus switch into root account with the help of password found and access the root shell.</span></p>
<pre class="lang:default decode:true">su root</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0kkTu5rVHUc/XTwU47GJF7I/AAAAAAAAfmE/tLYgTqrwBkoYsc_09IskqEl91OVPeOKEwCLcBGAs/s1600/15.png"/></span></p>
<p><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
