<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Post Exploitation on Saved Password with LaZagne</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/post-exploitation-on-saved-password-with-lazagne/" rel="bookmark"><time class="entry-date published updated" datetime="2019-02-26T16:24:34+00:00">February 26, 2019</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This article will be focused on The LaZagne project and its usage in Post Exploitation.</span></p>
<h3><span style="color: #800000;"><strong>Table of Content:</strong></span></h3>
<ul>
<li><span style="color: #000000;">Introduction of LaZagne Project</span></li>
<li><span style="color: #000000;">Syntax and Parameters</span></li>
<li><span style="color: #000000;">Achieve Meterpreter and Upload LaZagne</span></li>
<li><span style="color: #000000;">Help Screen</span></li>
<li><span style="color: #000000;">Mails Argument</span></li>
<li><span style="color: #000000;">Windows Argument</span></li>
<li><span style="color: #000000;">Browsers Argument</span></li>
<li><span style="color: #000000;">Databases Argument</span></li>
<li><span style="color: #000000;">Wi-Fi Argument</span></li>
<li><span style="color: #000000;">All Argument</span></li>
<li><span style="color: #000000;">oN Parameter</span></li>
<li><span style="color: #000000;">Verbose Mode Parameter</span></li>
<li><span style="color: #000000;">Quiet Parameter</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Introduction of LaZagne Project</strong></span></h3>
<p><span style="color: #000000;">The </span>LaZagne<span style="color: #000000;"> is an open source application. It retrieves stored passwords on a System. It directly injects the Python code in the memory without writing anything on disk. This makes it difficult to trace. Usually, when we get a session on a target system, our main aim is to gather credentials. When an attacker attacks a target, there are two ways through it can compromise the target. If the attacker gets the meterpreter session, then all it does is compromise the device security.</span></p>
<p><span style="color: #000000;">But using some scripts and post exploitation modules, the target can compromise every nook of security of the victim. This includes Email Passwords, Social Networking Passwords, SSH Passwords, Banking Information, etc. Usually, this extracting of passwords is a noisy and clumsy task but with LaZagne it is very simple and stealthy.</span></p>
<p><span style="color: #000000;">Without LaZagne, Attackers normally run a bunch of different scripts targeting different applications that are installed on the Target System. But </span>LaZagne<span style="color: #000000;"> does this automatically, it first checks which application is installed on the target system and then it runs that specific script targeting the password for that particular application.</span></p>
<h3><span style="color: #800000;"><strong>Famous Scripts Included in LaZagne</strong></span></h3>
<ul>
<li><span style="color: #000000;">KeeThief</span></li>
<li>mimipy</li>
<li><span style="color: #000000;">mimikatz</span></li>
<li>pypykatz</li>
<li>creddump</li>
<li>chainbreaker</li>
<li>pyaes</li>
<li><span style="color: #000000;">pyDes</span></li>
<li>secretstorage<span style="color: #000000;"> and many more.</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Target Software</strong></span></h3>
<ul>
<li><span style="color: #000000;">Firefox</span></li>
<li><span style="color: #000000;">Google Chrome</span></li>
<li><span style="color: #000000;">Opera</span></li>
<li><span style="color: #000000;">Skype</span></li>
<li><span style="color: #000000;">Postgresql</span></li>
<li><span style="color: #000000;">Thunderbird</span></li>
<li><span style="color: #000000;">Keepass</span></li>
<li><span style="color: #000000;">CoreFTP</span></li>
<li><span style="color: #000000;">FileZilla and many more.</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Syntax and Parameters</strong></span></h3>
<p><span style="color: #000000;">On Linux Systems, LaZagne will be executed as a Python file. But when out target is Windows then we will have to use executable(exe) file. We can download more executable</span>s from<span style="color: #000000;"> <a style="color: #000000;" href="https://github.com/AlessandroZ/LaZagne/releases/">here</a>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-XH-nlyqrnWY/XHVmWhCUUII/AAAAAAAAdFI/wIirAckn_7w4CBeOCO8lh6qHYE5sWI3RQCLcBGAs/s1600/0.png"/></span></p>
<p>LaZagne<span style="color: #000000;"> has a lot of other parameters and conditions, but here we have used only certain parameters and targets due to technological limitations.</span></p>
<h3><span style="color: #800000;"><strong>Achieve Meterpreter and Upload LaZagne</strong></span></h3>
<p><span style="color: #000000;">Open Kali Linux terminal and type msfconsole in order to load Metasploit framework. Now we need to compromise victim’s machine one to achieve any type of session either meterpreter or shell and to do so we can read our previous article from <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/msfvenom-tutorials-beginners/">here</a></span></strong>.</span></p>
<p><span style="color: #000000;">After getting meterpreter on the remote system, we need to upload the executable file to the target machine to extract credentials. We will use upload command for this.</span></p>
<pre class="lang:default decode:true">upload lazagne.exe .</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-5KqgEK-MXG4/XHVk2XdSV5I/AAAAAAAAdEA/7wKSviEfnEsVDGfT7ge2JGzxMemLGiE8gCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Now that we have the </span>LaZagne<span style="color: #000000;"> on the target system, it’s time to enumerate passwords.</span></p>
<p><span style="color: #000000;">Use shell command on the meterpreter shell to get to the command line on the target system.</span></p>
<h3><span style="color: #800000;"><strong>Help Screen</strong></span></h3>
<p><span style="color: #000000;">To get details about the </span>LaZagne<span style="color: #000000;"> we will use the -h parameter. This will print the list of parameters and arguments with the working examples on our screen. This is an informative banner as it not only gives us various methods that we can use but it also tells us how to use those parameters.</span></p>
<pre class="lang:default decode:true">lazagne.exe -h</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-2SMH0hH8zIc/XHVk3WCXJAI/AAAAAAAAdEM/qmUFAjIJarM557TKRHG8ljTaCLr0A_imwCLcBGAs/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Mails Argument</strong></span></h3>
<p><span style="color: #000000;">This argument targets mail clients like Mozilla Thunderbird and Microsoft Outlook. When this argument is selected, a script runs in the background which extracts the Login Credentials that are stored by these email clients. As we can see in the given image that it has successfully extracted the credentials that were stored in the Email Clients.</span></p>
<pre class="lang:default decode:true">lazagne.exe mails</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-m8yTkXKtuIs/XHVk4DrHXdI/AAAAAAAAdEQ/rNZc1R2Bh4wbb9WfDwGuddzDwVsc3brmACLcBGAs/s1600/3.png"/></span></p>
<h3><span style="color: #800000;"><strong>Windows Argument</strong></span></h3>
<p><span style="color: #000000;">This argument targets Windows Security on all fronts. When this argument is selected, a script runs in the background which includes </span>autologon<span style="color: #000000;">, </span>cachedump<span style="color: #000000;">, </span>credman<span style="color: #000000;">, </span>hashdump<span style="color: #000000;">, lsa_secrets, and others. This compromises all of the Windows defenses and gives the attacker the credentials, he is craving for. As we can see in the given image that it has successfully extracted the credentials.</span></p>
<pre class="lang:default decode:true">lazagne.exe windows</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-3BdAWPmz9RA/XHVk4V_sZLI/AAAAAAAAdEU/4wdfvlfsa9AWaVXMCHGciZzU9rs7TfOnQCLcBGAs/s1600/4.png"/></span></p>
<h3><span style="color: #800000;"><strong>Browsers Argument</strong></span></h3>
<p><span style="color: #000000;">This argument targets Browsers like Mozilla Firefox, Google Chrome, Opera, UC Browser, Microsoft Edge and much more. When this argument is selected, a script runs in the background which extracts the Login Credentials that are stored inside the browsers. Browsers hide the passwords and show them only after verifying the windows credentials. So, in order to extract the Credentials stored inside the browser, LaZagne attacks the SAM and gets the Windows password and then use it to extract the rest passwords. As we can see in the given image that it has successfully extracted the credentials that were stored in Firefox and Chrome.</span></p>
<pre class="lang:default decode:true">lazagne.exe browsers</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-zw_qYsSXYMw/XHVk4vS-Y8I/AAAAAAAAdEY/hX0qLvqBVdkMT-PkYCr7bfk0PnkApFBpwCLcBGAs/s1600/5.png"/></span></p>
<h3><span style="color: #800000;"><strong>Databases Argument</strong></span></h3>
<p><span style="color: #000000;">This argument targets database clients like Postgresql. When this argument is selected, a script runs in the background which extracts the Login Credentials that are stored by any database client. As we can see in the given image that it has successfully extracted the credentials that were stored in the Postgresql Client.</span></p>
<pre class="lang:default decode:true">lazagne.exe databases</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-6mJt-wA4dQI/XHVk44OqLFI/AAAAAAAAdEc/Y0r8ki2wyE4FQa2UdGCwRgnvWhBnWWTogCLcBGAs/s1600/6.png"/></span></p>
<h3><span style="color: #800000;"><strong>Wi-Fi Argument</strong></span></h3>
<p><span style="color: #000000;">This argument targets the stored Wi-Fi Credentials. When this argument is selected, a script runs in the background which extracts the Wi-Fi Credentials. All the Wi-Fi Network that the user had connected and opted for saving the password. As we can see in the given image that it has successfully extracted the Wi-Fi credentials.</span></p>
<pre class="lang:default decode:true">lazagne.exe wifi</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9jehFiJACdM/XHVk5HpvtzI/AAAAAAAAdEg/EJOsm0VqKM4iDKZYytOpbaOXv3v7CuyqQCLcBGAs/s1600/7.png"/></span></p>
<h3><span style="color: #800000;"><strong>All Argument</strong></span></h3>
<p><span style="color: #000000;">This argument runs all the module in the LaZagne. When this argument is selected, a script runs in the background which extracts all the Login Credentials that are stored on the Target System. As we can see in the given image that it has successfully extracted all the possible credentials from the target.</span></p>
<pre class="lang:default decode:true">lazagne.exe all</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Ijy1yhlDZ5c/XHVk5cbes4I/AAAAAAAAdEk/ZxQKuQw0UZ4olWjlnuaYCQUjh3wgVEFegCLcBGAs/s1600/8.png"/></span></p>
<h3><span style="color: #800000;"><strong>oN Parameter</strong></span></h3>
<p><span style="color: #000000;">This parameter should be run with some argument otherwise, it will give an error (We are using all argument here). This parameter is optional to run. This parameter not only prints the output on the terminal screen but also creates a file in the Directory it was run and writes it with the output of the Script.</span></p>
<pre class="lang:default decode:true">lazagne.exe all -oN</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-OZti1k8aybs/XHVk5rXQQXI/AAAAAAAAdEo/ip6bGZsWlaUjlpgTdn6UZsE9V_z4ey_BwCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Let’s check if the file was created.  As we can see in the given image that a file named credentials is created and on opening it using the cat command it shows the same result that we saw on the terminal.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-TWAyr2dtfHE/XHVk2QcKKEI/AAAAAAAAdD8/azH6L5M8YYMBMirwCBT3DNoMdB_s23BYgCLcBGAs/s1600/10.png"/></span></p>
<h3><span style="color: #800000;"><strong>Verbose Mode Parameter</strong></span></h3>
<p><span style="color: #000000;">This parameter should be run with some argument otherwise, it will give an error (We are using all argument here). This parameter is optional to run. In </span>LaZagne<span style="color: #000000;"> by default, we have 2 levels of verbosity. They are Level 0 and Level 1. If no parameter is given Level 0 is selected automatically. But when we give –</span>vv<span style="color: #000000;"> parameter, it increases the verbosity of the extraction. The output also changes. Now LaZagne forcefully runs each and every script in its arsenal and try to extract more and more credentials.</span></p>
<pre class="lang:default decode:true">lazagne.exe all -vv</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZzgaoYM-mOw/XHVk3cDi6zI/AAAAAAAAdEE/XP4PwielFXE8GpkWDkfd3iepTKBwSyzgACLcBGAs/s1600/11.png"/></span></p>
<h3><span style="color: #800000;"><strong>Quiet Parameter</strong></span></h3>
<p><span style="color: #000000;">This parameter should be run with some argument otherwise, it will give an error (We are using all argument here). This parameter is optional to run. This parameter doesn’t print any output on the terminal screen. Scripts do run in the background but there is no visibility of the passwords extracted so we use the parameter with the oN parameter we discussed earlier as it creates a file in the Directory it was run and writes it with the output of the Script.</span></p>
<pre class="lang:default decode:true">lazagne.exe all -quiet -oN</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-2MUsd-Hrqu0/XHVk3UKclMI/AAAAAAAAdEI/nJdcgMcsDCAQuAtB17KM6ujl48fD9sfvwCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/pavandeep-singh-6b1074132" target="_blank" rel="noopener noreferrer" data-saferedirecturl="https://www.google.com/url?q=https://www.linkedin.com/in/pavandeep-singh-6b1074132&amp;source=gmail&amp;ust=1542651210170000&amp;usg=AFQjCNEYOzlThg6B1HzKcEZNou4HowCJ2Q">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
