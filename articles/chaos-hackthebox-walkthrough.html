<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Chaos HackTheBox Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/chaos-hackthebox-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-02-19T14:06:13+00:00">February 19, 2021</time><time class="updated" datetime="2025-06-22T12:49:00+00:00">June 22, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we’re going to solve another boot2root challenge called “<strong>Chaos</strong>“. It’s available at HackTheBox for penetration testing practice. This laboratory is of a medium level, but with adequate basic knowledge to break the laboratories and if we pay attention to all the details we find during the examination it will not be complicated. The credit for making this lab goes to <span style="color: #0000ff;"><strong>felamos</strong></span>. Let’s get started and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;">Level: <strong>Medium</strong></span></p>
<p><span style="color: #000000;">Since these labs are available on the <strong>HackTheBox</strong> website.</span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumerate</strong></span></p>
<ul>
<li><span style="color: #000000;">Information relevant in SSL certificate</span></li>
<li><span style="color: #000000;">Dirsearch</span></li>
<li><span style="color: #000000;">WPScan</span></li>
<li><span style="color: #000000;">Gobuster</span></li>
<li><span style="color: #000000;">Nikto</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Information disclosure in drafts mail</span></li>
<li><span style="color: #000000;">Use of encryption and weak password</span></li>
<li><span style="color: #000000;">Read and command execute in LaTeX software</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Cracking to passwords stored in Firefox</span></li>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<h3><span style="color: #800000;">Walkthrough</span></h3>
<h3><span style="color: #800000;">Reconnaissance</span></h3>
<p><span style="color: #000000;">We will use the following commando to perform a scan to all ports with scripts and versions.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A -p- 10.129.98.125</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oPBxHezVz4g/YC_AXUTrD2I/AAAAAAAAt6A/0wh_N0PBtvs_mI0e1_UrdjteyQ7tbtQ2QCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">We access web service on <strong>port 80</strong> and the server we are not allowed the connection with direct IP.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2dcJUCcBiE8/YC_AkIeHFtI/AAAAAAAAt6E/oy6dFrHEzbE7I1hmsY0Wa_VMa7RWOe1swCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Then, we access other web service on <strong>port 10000</strong>, here we enumerate a <strong>Webmin panel</strong>. We tested typical passwords (admin:admin, admin:1234, etc…) but not work.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oIa8SPnRyhg/YC_Ao_hrKMI/AAAAAAAAt6I/NKVN9cyVJTctqiU4foT1hkIkKCtdd7XvwCLcBGAsYHQ/s16000/3.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">We ever have to <strong>review an SSL certificate</strong>, here we enumerate an email corporate and domain name.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-x37Eyfhpg9g/YC_Au9xGMlI/AAAAAAAAt6M/cNzkhsKegYcYjOG0LRWRkt9FX-jjn6TuQCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Then, we insert name domains “<strong>chaos</strong>” and “<strong>chaos.htb</strong>” in the <em>“/etc/hosts</em>” file. We do this because it is very likely that they use virtual hosting on the machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LslQtCGS2ow/YC_Ay6PD9NI/AAAAAAAAt6Q/WbO8IzX8EIUQnBa9-UudrCLbZs8DGSfwACLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">Then, we revise the web site in “<strong>chaos.htb</strong>“, but not found the information relevant. So we use the <strong>dirsearch</strong> tool with IP address. Is very import to perform scans in both targets (IP and Host), is possible that virtual hosting uses and we obtains different results.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ob08pkOSUmU/YC_A28_uw8I/AAAAAAAAt6Y/cE7IFxZb4zgiA6QD3jeR_gCIgYXJnyHSACLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">We enumerate a WordPress directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TulpJnOJKac/YC_A9gne41I/AAAAAAAAt6g/OuslgzF_liIL3dtrxpv6RoDyzrjDvIZQgCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">Then, we found a post published but we need the password unlocked.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-t4dA2-ltVVs/YC_BCl5m5oI/AAAAAAAAt6o/GSAZXhCNIm0gBTJkID5MYHlTiIAHs5MGwCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">We use the <strong>WPScan</strong> tool and we enumerate a username.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-67ufKt76ksQ/YC_BH2eSNwI/AAAAAAAAt6s/sxUffDFpvBwl37lIAOU5qw9HY1AHbngkwCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">Then, we use the <em>username as a password</em> and “Voilà!”, we have credentials for webmail… But? Where is webmail?</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-t_VOAv_rMso/YC_BMZgPvXI/AAAAAAAAt6w/SJkcTSdsuVAdSpwqIy1-7F2o34d0NQtfgCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">We use <strong>gobuster</strong> tool with a subdomains wordlist and we found a subdomain “<em>webmail.chaos.htb</em>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HGGTBNRem54/YC_BUEcVNWI/AAAAAAAAt68/zhRBMVLFmm4FcmJDO2vhrNrZlvbQ-UG-gCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">Correct! We found webmail!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-z4fKiMHMn2I/YC_BaW9tqwI/AAAAAAAAt7A/4Xp1Tm5o3nMk3BpNbSH580pM1ruSnYxwQCLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">We use the credentials found in WordPress and we reading the mail which is in the “<em>Drafts folder</em>“.</span></p>
<p><span style="color: #000000;">Here we found <em>a Python script</em> and a <em>message encrypted</em>, also view a message from <strong>Ayush</strong> user telling us that the password is “<strong>sahay</strong>“</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-C9Y1QPSwhgs/YC_BfF0uOdI/AAAAAAAAt7I/63Zbe9QePM8gUwZPJHs3nwizy5FOlBCbgCLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">Firstly, we download both files and we read the content, we have a file cipher and a python script not finished.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xr4oYP42X04/YC_BkYPh41I/AAAAAAAAt7Q/O54x5JKyUpYfpju7RN_WhzjsCeiw77ScgCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Here, we found the function “<strong>encrypt</strong>” in google and we found the complete python script.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iSqiUSGsoi8/YC_BodPQAoI/AAAAAAAAt7U/MxvxqGWkjSQlmK34dcMQzES1k2_QNWEsACLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">We copy libraries and function “<em>decrypt</em>“, we add a line with “<strong>sahay</strong>” password and filename for decrypt.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hVQ7Jp5MYzg/YC_Bur96kuI/AAAAAAAAt7Y/YUEfc3PeQHo5pPdKT9eQSp2Nqd5OFWTmACLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">Then, we execute the python script, we read the “<strong>t</strong>” file, we found a string in “<strong>base64</strong>” coding, we decoding the file and we found a URL.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ObeTcO0xEcA/YC_BzSvGYSI/AAAAAAAAt7c/LG-WmABBbkUPdkmpLwHkIqNOMiFRIGVDACLcBGAsYHQ/s16000/17.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">We visit the website, we found a form for <strong>creating PDF files</strong>. This leads us to believe that there may also be directories containing PDF files with confidential information.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-k_nmWyGYUtc/YC_B4-napUI/AAAAAAAAt7o/N72vOb5F0WsFUCFtHmflD_o8jIMYT4-0ACLcBGAsYHQ/s16000/18.png"/></span></p>
<p><span style="color: #000000;">So we use <strong>nikto</strong> tool and we enumerate the directory interesting.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Vnq_Dkbow3c/YC_B_CczLnI/AAAAAAAAt7s/y3B_HYVyfmoWxj1sDXi4M0D1keKdbaP3ACLcBGAsYHQ/s16000/19.png"/></span></p>
<p><span style="color: #000000;">We enumerate files with information disclosure, software name and version.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0qEXya2t9JE/YC_CE79pU3I/AAAAAAAAt70/k3ky_XqGjVUVVcasfG--Jj5BXHVzE6nzACLcBGAsYHQ/s16000/20.png"/></span></p>
<p><span style="color: #000000;">I search exploits/documentation in Google and I here found this <strong>article interesting</strong>.</span></p>
<p><span style="color: #000000;">We use <strong>Burp</strong>, we intercept request and we testing read “<strong>/etc/passwd</strong>” file as proof of concept.</span></p>
<p><span style="color: #000000;">But not work, it this server blacklist use with words forbidden.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UfEb5VMeuT8/YC_CLo5m9HI/AAAAAAAAt78/trEZdJQQVkQg2_Yyn7Y08CcO1Cu35INTQCLcBGAsYHQ/s16000/21.png"/></span></p>
<p><span style="color: #000000;">We use the following code for protection bypass and read <strong>“/etc/passwd</strong>” file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">\newread\file
\openin\file=/etc/passwd
\read\file to\line
\text{\line}
\closein\file</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZKMbLIUwpak/YC_CXVLzqVI/AAAAAAAAt8A/fMVOG1vn7ewUjewtUFaOp8WPn116r1OiwCLcBGAsYHQ/s16000/22.png"/></span></p>
<p><span style="color: #000000;">Yeah! We now read a PDF file on web browser</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Z0Y7BDjb_eA/YC_CdT_s0PI/AAAAAAAAt8I/i5qsjaXh2mQ_SX4XZmSizwNFWZEMRPvQACLcBGAsYHQ/s16000/23.png"/></span></p>
<p><span style="color: #000000;">So, we now <strong>command execute</strong> to obtain a reverse shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-eQ-cCwOtaFc/YC_CiF5R1eI/AAAAAAAAt8M/YBe6mAVnMqMXQerJFL3pPuHDNbpiqerrgCLcBGAsYHQ/s16000/24.png"/></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OncaMxl6Clk/YC_Cr69eM2I/AAAAAAAAt8U/65xg8QOZhmgIe7AEpbm2Mwpd-_8fIlpNgCLcBGAsYHQ/s16000/25.png"/></span></p>
<p><span style="color: #000000;">We have problems with the path system, so we use route absolute for binary call and we read the “<em>user.txt</em>” file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jCXLtfS6Sm8/YC_Cxg1GnUI/AAAAAAAAt8c/aKNya5gaV3Qk4XRV4-u8w7LpT_nWHqZvQCLcBGAsYHQ/s16000/26.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation (root)</span></h3>
<p><span style="color: #000000;">We found a “.mozilla” folder hidden, this is an uncommon folder.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6I9hD8_thl8/YC_C4eHLJ5I/AAAAAAAAt8k/Yr0PZZv7MIgOTlt8ywyG6WcqmMzARg93QCLcBGAsYHQ/s16000/27.png"/></span></p>
<p><span style="color: #000000;">We compress the “<strong>firefox</strong>” folder and transfer it to our computer with <strong>netcat</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NZpBOnrgoCA/YC_C-shOLxI/AAAAAAAAt8s/UNXLzdtwFE8bxPJAfTDYkt7ke64wWJf-ACLcBGAsYHQ/s16000/28.png"/></span></p>
<p><span style="color: #000000;">Unzip the folder, download the “<span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/unode/firefox_decrypt">firefox_decrypt</a></strong></span>” tool and use it. We will be asked for the “<em>master password</em>” we will use the one found in WordPress.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EFNxBZo6NFU/YC_DC5ODr1I/AAAAAAAAt8w/LGBF6k5-rhgDuHA_huKiDRqE6r5TPq3RACLcBGAsYHQ/s16000/29.png"/></span></p>
<p><span style="color: #000000;">This will return us some credentials for the “<strong>Webmin</strong>” service, but we can reuse the password with the system user “<strong>root</strong>” and read the flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--I_fMd4JLVE/YC_DHsMxf1I/AAAAAAAAt80/ZEeeG2-T3P4MVkF73Khm9qlHTYAaxStLgCLcBGAsYHQ/s16000/30.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. I hope you have enjoyed and learned something new today. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>David Utón</strong> is Penetration Tester and security auditor for Web applications, perimeter networks, internal and industrial corporate infrastructures, and wireless networks. Contacted on <strong>LinkedIn</strong>  and <strong>Twitter</strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
