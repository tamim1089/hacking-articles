<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">EvilOSX-RAT for MacOS/OSX</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/evilosx-rat-for-macos-osx/" rel="bookmark"><time class="entry-date published updated" datetime="2019-07-21T16:24:38+00:00">July 21, 2019</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we will learn to use EvilOSX tool which is a Remote Administrator tool (RAT ) for initializing foothold on MacOS/OSX like platform. It can dramatically increase access in a matter of seconds.</span></p>
<h3><span style="color: #993300;"><strong>Table of Content</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Introduction</strong></span></li>
<li><span style="color: #000000;"><strong>Installation</strong></span></li>
<li><span style="color: #000000;"><strong>Usage in Exploitation</strong></span></li>
<li><span style="color: #000000;"><strong>Usage in Post-Exploitation </strong></span>
<ul>
<li><span style="color: #000000;">System Info</span></li>
<li><span style="color: #000000;">Webcam</span></li>
<li><span style="color: #000000;">Retrieve iCloud auth tokens</span></li>
<li><span style="color: #000000;">Microphone</span></li>
<li><span style="color: #000000;">Clipboard</span></li>
</ul>
</li>
<li>Conclusion</li>
</ul>
<h3><span style="color: #993300;"><strong>Introduction</strong></span></h3>
<p><span style="color: #000000;">EvilOSX is an evil RAT (Remote Administrator Tool) designed to work upon macOS / OSX Platforms. It was developed by <a style="color: #000000;" href="https://github.com/Marten4n6">Marten4n6</a>. Its backbone is famous Empire Framework Project. This project can be modified to be used on Rubber Ducky. This toolkit is fully packed with features. It was designed on the module system that made the debugging, improvements and addition of other modules easy. Also being developed in python it provides easy to be run across different attacking platforms.</span></p>
<h3><span style="color: #993300;"><strong>Installation</strong></span></h3>
<p><span style="color: #000000;">The installation of the EvilOSX RAT on the Attacker machine, which in our case in Kali Linux is pretty simple. To begin with, we will visit the <a style="color: #000000;" href="https://github.com/Marten4n6/EvilOSX">EvilOSX GitHub Page</a>. After <strong>getting</strong> the git link, we are going to clone the EvilOSX to our attacker machine using the git clone command.</span></p>
<pre class="lang:default decode:true">git clone https://github.com/Marten4n6/EvilOSX.git</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-8Ik1whgqdVk/XTSJL4t5-1I/AAAAAAAAfXI/I9y1Epm9dqAL3NH5dMJCG69RuHa1GG4EwCEwYBhgL/s1600/1.png"/></p>
<p><span style="color: #000000;">After cloning the EvilOSX, we traversed in the newly created directory created with the name of EvilOSX. Now, the tool has some predefined requirements that are required in order to make the tool function properly. Being a python developed tool, we will use the “pip” to install those requirements. These requirements are given by the author in the form of a text file which we used to install them.</span></p>
<pre class="lang:default decode:true">pip install -r requirements.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-9-NKOwYLTv8/XTSJOEWsMWI/AAAAAAAAfXM/gEpvUPq7WYo3SbsMe_ZvVpDaZEaynmGKgCEwYBhgL/s1600/2.png"/></p>
<h3><span style="color: #993300;"><strong>Usage in Exploitation</strong></span></h3>
<p><span style="color: #000000;">Since we have successfully installed all the predefined requirements, it time to run this tool and gain control over some macOS devices. Now to exploit, we need a payload. To create this payload, we will use the start.py file with the builder parameter.</span></p>
<pre class="lang:default decode:true">python start.py --builder</pre>
<p><span style="color: #000000;">After running the script, it asked us to enter the following information:</span></p>
<ul>
<li><span style="color: #000000;">the Server host, here we entered our Attacker Machine IP Address (Kali Linux).</span></li>
<li><span style="color: #000000;">Next, it asked us for a port, this can be any random port.</span></li>
<li><span style="color: #000000;">After this, we are asked for the location of the payload.</span></li>
<li><span style="color: #000000;">Next, we have to choose if we want EvilOSX to work upon the rubber ducky or not. Enter 0 for otherwise.</span></li>
<li><span style="color: #000000;">Furthermore, we are asked to choose the loader, leave it default.</span></li>
<li><span style="color: #000000;">After that, we are asked to name the payload so as phish the user.</span></li>
</ul>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ABZ5-dIUMy8/XTSJOm6-U-I/AAAAAAAAfXI/4Y6p17UCNpQ3T_m4caXCxGvLDAmXUzjoACEwYBhgL/s1600/3.png"/></p>
<p><span style="color: #000000;">After all these choices, a launcher is created as shown in the image given below.</span></p>
<p><span style="color: #000000;">Now we can use any method to share this launcher or payload to the victim. In our case, we used a python HTTP server to get this file to the victim system. This file is downloaded on the victim system and then after providing the proper permissions the payload is executed as shown in the image given below.</span></p>
<pre class="lang:default decode:true">chmod 777 Launcher-39q1q9.py
./Launcher-39a1a9.py</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-ZtJrbgL4HZE/XTSJPGJlM_I/AAAAAAAAfXI/bOIJ13kWWAcVDgLKBIiUiwt8Sh1UwVE_gCEwYBhgL/s1600/4.png"/></strong></span></p>
<p><span style="color: #000000;">While we are executing the Launcher on the victim, we have to perform some actions on the attacker machine simultaneously. We are going execute the start.py again but this time in the CLI mode. Here we have to specify the port that we used while creating the launcher as the parameter as shown in the image.</span></p>
<pre class="lang:default decode:true">python start.py -cli --port 4545</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-3KB8HVjm3RA/XTSJPMX91lI/AAAAAAAAfXM/1fn4tmvYqQwGxT81r87J2B4iU7notwr0gCEwYBhgL/s1600/5.png"/></p>
<h3><span style="color: #993300;"><strong>Post-Exploitation </strong></span></h3>
<p><span style="color: #000000;">After running the start.py script in the previous steps simultaneously with the launcher on the victim machine, we have successfully infiltrated the Victim MacOS system. The terminal converts in a framework as shown in the image. We can configure a page to shown upon the running. Type in help to show a list of working commands. We can see the list of active bots by using the command bots. To establish a connection to a bot, use connect command followed by the number which in this case is 0. To see the list of available modules we use modules command.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-tRIOAC_vJoo/XTSJPk4RGNI/AAAAAAAAfXM/ga7YtZEFLn8YONCGbrQaqxC7FHFmjKS9wCEwYBhgL/s1600/6.png"/></p>
<p><span style="color: #000000;">To use a module, just type in “use” followed by the module name. As there are a bunch of available modules, we are demonstrating a bunch of them here for reference. You can try them all at your convenience.</span></p>
<h3><span style="color: #993300;"><strong>System Info</strong></span></h3>
<p><span style="color: #000000;">To get a brief summary of the system, we can use the get info module. This gives us the System Version, Model of the MacOS device. We also get the Battery status in case it is a Laptop. We have the name of the Wi-Fi network it is connected to. It also tells us the privileges the current account has as well as the status of the FileVault.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-39L71m9l90I/XTSJPvnTIMI/AAAAAAAAfXM/UBbp_0mibjslPfyV6Vt2fw7zs3ePn0Z5wCEwYBhgL/s1600/7.png"/></p>
<h3><span style="color: #993300;"><strong>Webcam </strong></span></h3>
<p><span style="color: #000000;">Now, we will try to grab a snap from the webcam of the MacOS device. To do this we will need to use the webcam module. It gives us a warning that there a green LED will show near the camera.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-crzBVhu58HQ/XTSJPxn3r6I/AAAAAAAAfXQ/2C45d66kyjMzjm9L4lHf2QSF7h9xPVoyQCEwYBhgL/s1600/8.png"/></p>
<p><span style="color: #000000;">We have successfully captured a snap from the victim’s webcam as shown in the given image.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-FWOHw-fnZjY/XTSJQ7Sl5hI/AAAAAAAAfXU/lvuPGHuEAXcARD-Q96_6T201yXC3_PZZwCEwYBhgL/s1600/9.png"/></p>
<h3><span style="color: #993300;"><strong>Retrieve iCloud auth tokens</strong></span></h3>
<p><span style="color: #000000;">We can extract the iCloud Authentication that contains information related to the AppleID linked to the device. However, this will first show a prompt on the victim system.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-3LhFmEbXfXs/XTSJL-jJDGI/AAAAAAAAfXE/N7xige8OEpYcnddCBVngbF2IpEiU-FD3wCEwYBhgL/s1600/10.png"/></p>
<p><span style="color: #000000;">After agreeing to continue, a prompt will pop us as shown in the image given below. This is masquerading as a genuine prompt that will spoof the victim and make him enter the password.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-HBEejthuPz8/XTSJL4ojYsI/AAAAAAAAfXI/J500LuvQWvMb3xf2O_DEDDX-y08PAPBOQCEwYBhgL/s1600/11.png"/></p>
<p><span style="color: #000000;">After the victim enters a password, we will successfully capture the mail ID liked to the device as well as the access tokens as shown in the image given below.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-tIfkIhVeKaI/XTSJNFVic8I/AAAAAAAAfXI/nlQTuZPn9DkJKFybMSUJ7yWeoEyIPHViQCEwYBhgL/s1600/12.png"/></p>
<h3><span style="color: #993300;"><strong>Microphone</strong></span></h3>
<p><span style="color: #000000;">We can also capture the audio from the victim device using the microphone module. After running the command use microphone, we are asked to enter the time in seconds to record the audio from the microphone of the victim device and also the name of the service that would show up in the verification prompt.  </span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-GSkq_fjzLC4/XTSJNYBnnWI/AAAAAAAAfXI/fN2LGCRWfmg7X8tH0t6VpSQPrZLHmwMOQCEwYBhgL/s1600/14.png"/></p>
<p><span style="color: #000000;">Here we entered 5 seconds, and we left the name of service to be blanked which made the RAT to take it as random string as shown in the given image. A permission prompt pops up on the victim system asking for permission to access the microphone.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-AqLE_Do2zBg/XTSJMzYoETI/AAAAAAAAfXM/-VoL5RCYRKI8dwr5vmy4_MvsIZpPKvdeQCEwYBhgL/s1600/13.png"/></p>
<p><span style="color: #000000;">After allowing we have the recorded audio in the mp3 format saved on out attacker machine in the tmp directory.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-tOCeTKTjAwA/XTSJNqkuO7I/AAAAAAAAfXM/IIYB3R11RVcBmkcIxzdmtK7sQ5eDFFTYACEwYBhgL/s1600/15.png"/></p>
<h3><span style="color: #993300;"><strong>Clipboard</strong></span></h3>
<p><span style="color: #000000;">We can also sniff the clipboard data from the victim machine. To do this we will have to use the clipboard. This will start the sniffer on the victim machine for the specified time in seconds. After starting the sniffer, any text that the victim will copy can be viewed as shown in the image given below.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-iClkbq42jcY/XTSJOOMgPfI/AAAAAAAAfXU/JXI4HoROFwAXHVpYYunXVn9aiIfrJEvegCEwYBhgL/s1600/16.png"/></p>
<h3><span style="color: #993300;"><strong>Conclusion</strong></span></h3>
<p><span style="color: #000000;"> EvilOSX has a lot of uses, and the attention to detail in automating certain exploits makes it a great dedicated tool for OSX. The ease with which it works and attacks is remarkable, we can launch a phishing attack to escalate privileges or trick a user into letting us deeper into the system. It’s a great tool and amazing to use as it traverses itself to connect apple devices.</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester Contact</span> <a href="https://www.linkedin.com/in/pavandeep-singh-6b1074132"><strong>here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
