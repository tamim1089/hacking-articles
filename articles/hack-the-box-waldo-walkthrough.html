<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">HacktheBox Waldo Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-waldo-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-12-23T16:22:05+00:00">December 23, 2018</time><time class="updated" datetime="2025-06-29T20:07:49+00:00">June 29, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another CTF challenge “waldo”. It is a retired vulnerable lab presented by Hack the Box for helping pentester’s to perform online penetration testing according to your experience level; they have a collection of vulnerable labs as challenges, from beginners to Expert level.</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Intermediate</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> To find user.txt and root.txt file</span></p>
<p><span style="color: #000000;">Note: Since these labs are online available therefore they have a static IP. The IP of waldo is 10.10.10.87</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;">Network scanning (Nmap)</span></li>
<li><span style="color: #000000;">Browsing IP address through HTTP</span></li>
<li><span style="color: #000000;">Exploiting LFI Vulnerability</span></li>
<li><span style="color: #000000;">Finding RSA private key through LFI</span></li>
<li><span style="color: #000000;">Login through SSH using RSA private key</span></li>
<li><span style="color: #000000;">Escaping restricted shell</span></li>
<li><span style="color: #000000;">Using Linux “Capabilities” to read the root flag</span></li>
</ul>
<p><span style="color: #000000;"><strong>Walkthrough</strong></span></p>
<p><span style="color: #000000;">Let’s start off with our basic nmap command to find out the open ports and services.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV -sC -T4 10.10.10.87</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-FyqZDacNICs/XB-z12Cfh7I/AAAAAAAAbys/665hvwbJsy88EOTaVFeGr0WV2CsRdj9cACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">The Nmap output shows us that there are 4 ports open: 22(SSH), 80(HTTP)</span></p>
<p><span style="color: #000000;">We find that port 80 is running http, so we open the IP in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-P54Tv8fyqoo/XB-z5Ey-1JI/AAAAAAAAbzQ/KFmoK5TwnKc0KhXi4Azg3YhNxFJfkjRKwCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">We find that we were redirected to <em>/list.html</em>. On the webpage, we find that it was an application for list manager. There we capture its request using burpsuite and find that it is listing the files in the current directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lPZf2w0FWB4/XB-z5BCxlqI/AAAAAAAAbzM/beAH_WbLgOAfG5KlM-jP5i34IIx0ab21wCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We try to find the application is vulnerable to LFI. We remove “list” to list the files in the current directory and find a file called “fileRead.php”. Enumerating the web application, we found that “dirRead.php” can only be used to read contents of a directory and they cannot be used to take read files. So as we the name suggests “fileRead.php” we use this page to read files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-zAJaq5LGE9U/XB-z5ERqm0I/AAAAAAAAbzU/oLk__k8D0U404namn-4I_cQQYIhNxW2iACLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We use “fileRead.php” to read /etc/passwd. We change the variable from “path” to “file” and use the following string to bypass the filter:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./….//….//….//….//etc//passwd</pre>
<p><span style="color: #000000;">When we check the /etc/passwd file we find a user with a distinctive UID and GID called “nobody”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FI-hl2RyTX0/XB-z5xGECWI/AAAAAAAAbzY/3Wp0T3rRCp0IikLxsTtZHPifZMabQSyJwCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Firstly, we check the home directory using “dirRead.php” and find a directory called “nobody”. We take a look inside “/home/nobody” and find the directory called “.ssh”. As “.ssh” might contain RSA private key for SSH login.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-VvuRZnCvaAg/XB-z6EaTlKI/AAAAAAAAbzg/jQOdfT_-QpEgJPRVVZIK8BhGWoMfvYNlgCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Then, we take a look inside “/home/nobody/.ssh/” and find a file called “.monitor”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Fk7RWEjmMH8/XB-z57FYtqI/AAAAAAAAbzc/EB20tFsSrtE_Ecczpm8_Fg6qsmJILdifgCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">We read the “.monitor” file inside “/home/nobody/.ssh” using “fileRead.php” and find RSA private key.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pQXsZYLY_Y8/XB-z664RyGI/AAAAAAAAbzo/SF8ASjoL5mUK8zf9Puywvb87eWkuR5cNwCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">The response is in JSON format with special characters in between the characters of RSA private key. So, we use this site here, to decode the JSON response into a string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6eazmfR29dg/XB-z7f507VI/AAAAAAAAbzk/U-S4bVFMvX0bo9abyNzJdXbYyNcv6BL5ACLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Then, we copy the RSA private key and save it in our system to login through SSH using this key.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rChzQUSUANo/XB-z2MS-AkI/AAAAAAAAbyw/QYsnCbv-YhIcTMj1xREXz0h7nUFBJsKxgCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">We change the permission for the key and login as user “nobody”, as we are unable to login as “monitor”.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chmod 600 id_rsa
ssh -i id_rsa nobody@10.10.10.87</pre>
<p><span style="color: #000000;">Then we take a look at the home directory and find a file called “user.txt”. We take a look at the content of the file and find the first flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-xKjCx-VpRx8/XB-z2C8ec-I/AAAAAAAAby0/fTRqt4adHMw9Nemy9whd0Y69v-cUWSzrQCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Enumerating the system we go into the “.ssh” directory and check the authorized_keys file to find monitor user is allowed to login. As we were unable to login as a monitor from the external system, we now try to login as user “monitor” internally using the RSA private key “.monitor”.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh -i .monitor monitor@localhost</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-abbVz-esmD0/XB-z2379PsI/AAAAAAAAby4/Kl56WDyuedQQ1-75WvZG-D6W8Xvz1Ib9ACLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">After logging in as user “monitor” we find that we have a restricted shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo $SHELL
echo $PATH</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aXjl18BZwMM/XB-z3FHnDVI/AAAAAAAAby8/UdUQudAvlpYWsMtuAv3x9UP4Iose2-06wCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">We are not able to change the PATH and SHELL variable, so we use the “-t” argument to spawn a TTY shell while logging through SSH. After spawning a TTY shell we are able to change the SHELL and PATH environment variables.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh -i .monitor monitor@localhost -t bash
export SHELL=/bin/bash
export PATH=/bin:/sbin:/usr/bin:/usr/sbin:$PATH</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-CmVThZNLimc/XB-z3IjCEXI/AAAAAAAAbzA/H7AvWaPlYRg_ZseV3UEd_l2ITE9Zmy6lgCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Then enumerating the system we don’t find anything in particular. Enumerating further we find that this machine contains “capabilities”. Now Linux “capabilities” are like suid that can give certain file special privileges.  We can find them using binary called “getcap”. Now we recursively search for files using getcap and find a binary called “tac” that can read files.  Now using “tac” we open root.txt inside root directory and find the final flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">getcap -r / 2&gt;/dev/null
tac /root/root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-6qb-T7kwAZ4/XB-z4GFJxjI/AAAAAAAAbzI/Rk5hTNEgVAYfAHt8WVlT34bWF20eWo66wCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cybersecurity enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
