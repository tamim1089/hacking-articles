<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Geisha:1: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/geisha1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-05-19T06:08:46+00:00">May 19, 2020</time><time class="updated" datetime="2025-06-10T20:10:36+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today, I am going to share a writeup for the boot2root challenge of the vulnhub machine ‚ÄúGEISHA‚Äù. It was actually an easy box based on the Linux machine and the goal is to get the root shell and then obtain flag under /root).</span></p>
<p><span style="color: #000000;">Download it from here:<strong> https://www.vulnhub.com/entry/geisha-1,481/</strong></span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<p><span style="color: #000000;"><strong>Recon</strong></span></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploitation</strong></span></p>
<ul>
<li><span style="color: #000000;">Hydra</span></li>
<li><span style="color: #000000;">SSH login</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Abusing SUID</span></li>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough </strong></span></h3>
<h3><span style="color: #800000;"><strong>Recon</strong></span></h3>
<p><span style="color: #000000;">Recon¬†is the act of¬†gathering¬†different kinds of¬†information¬†against the targeted victim or system.¬† We can use various tools, techniques, and websites for the recon. Such as (Nmap, Dirsearch, Dirb etc) let‚Äôs start with Nmap tool.</span></p>
<p><span style="color: #000000;">Let‚Äôs start off with scanning the network to find our target. We found our Targets IP Address 192.168.1.133.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;">Our next step is to scan our targets IP Address with nmap. We will start recon by using Nmap scan to find the open ports and the version of our target.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.133</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JR4nMJZxpV0/XsN1wqTwMzI/AAAAAAAAkIQ/F47jTHEun0AhlX5ka5z8yuPT9AKbgyeqgCLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Since port 80 is open, Let‚Äôs explore the domain or webpage on this target IP address.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wbBa5TulX6M/XsN1w905PPI/AAAAAAAAkIY/Jl03xuY1nf4l7HhEnDidqKTqmdbEYT7IQCLcBGAsYHQ/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">Here, I got a many ports open, like port number 22 in the nmap scan, Let‚Äôs give a try to find the username and password to connect via ssh port of the machine.</span></p>
<p><span style="color: #000000;">Let‚Äôs assume the username is <strong>geisha</strong> now by using hydra tool we can crack the password for this machine which has username geisha.</span></p>
<pre class="lang:default decode:true">hydra -l geisha -P /usr/share/wordlists/rockyou.txt 192.168.1.133 ssh</pre>
<p><span style="color: #000000;">Here, we got the password for the geisha user i.e <strong>letmein</strong>.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/--l2CO6JPwJE/XsN1wpWYETI/AAAAAAAAkIU/Xyy98fLOkHky_I5aTE7j9C2IPJ1BUVAOwCLcBGAsYHQ/s1600/3.png"/></strong></span></p>
<p><span style="color: #000000;">Since we cracked password for the username geisha in the recon part let‚Äôs try to login by the port 22 by ssh.</span></p>
<pre class="lang:default decode:true">ssh geisha@192.168.1.133</pre>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Privilege Escalation</span> </strong></span></h3>
<p><span style="color: #000000;">Yes, we are connected to a remote host and our current user is geisha. Now I need to escalate to root from this user.</span></p>
<p><span style="color: #000000;">Here the connection stabilized successfully.</span></p>
<p><span style="color: #000000;">Let‚Äôs start the enumeration of this machine. In the same present working directory first will enumerate and see what juicy data is there. Here we got some files with suid permissions. Using the below command, we can check the suid permissions in the machine.</span></p>
<pre class="lang:default decode:true">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-wEbkLrsO94E/XsN1xeMyKjI/AAAAAAAAkIc/rJyrfpeahxYjG-8NhdzNZ4ezLvYU9fQswCLcBGAsYHQ/s1600/4.png"/></strong></span></p>
<p><span style="color: #000000;">So here we got /usr/bin/base32 file which is having suid permissions. let us check privilege escalation by using the base32 file.</span></p>
<p><span style="color: #000000;">Now let‚Äôs check /etc/shadow file using /base32 command to read the restricted files.</span></p>
<pre class="lang:default decode:true">base32 "/etc/shadow" | base32 --decode</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-D_5XMf0Vivs/XsN1xXgUOAI/AAAAAAAAkIg/Y93P4qIvOWIKkQ_GOOtNtRJmB0ou1Hw1ACLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">So here got the hash password in the /etc/shadow file and tried cracking many times but this hash is non-crackable and failed to obtain the password for root.</span></p>
<p><span style="color: #000000;">Let‚Äôs try the root login also using ssh and for that, we need to copy the private key for the login using ssh. I got the private ssh key for the root, by using below commands.</span></p>
<pre class="lang:default decode:true">base32 "/root/.ssh/id_rsa" | base32 --decode</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-5wh03OxkEjY/XsN1xzoZUaI/AAAAAAAAkIk/0wX-VcQy5t4fqhwhIpzJzcQLI1umu2COwCLcBGAsYHQ/s1600/6.png"/></strong></span></p>
<p><span style="color: #000000;">Here we successfully retrieve the ssh key now save this key in your system.</span></p>
<p><span style="color: #000000;">We got root‚Äôs ssh private key. Using this private ssh key we will switch the user geisha to root.</span></p>
<pre class="lang:default decode:true">nano key
chmod 600 key
ssh -i key root@192.168.1.133</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-J37ymszV5C0/XsN1yRw0HYI/AAAAAAAAkIo/TSZQ2-yq3JYmmEIYiRkMAI41Muf6SjtCwCLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Another method to find the root flag is we can directly read the restricted file using /base32.</span></p>
<pre class="lang:default decode:true">base32 "/root/flag.txt" | base32 --decode</pre>
<p><span style="color: #000000;">Successfully rooted!!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6bMW5IEBJm4/XsN1yYqIp-I/AAAAAAAAkIs/DbyI-rDBIQU6PnwTYl2CSYm0T8BbW-sYwCLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Here we got our root flag‚Ä¶ That explains it all. So that‚Äôs for now. See you next time.</span></p>
<p><span style="color: #000000;">HAPPY HACKING!! üòä</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sushma Ahuja is a Technical Writer, Researcher, and Penetration Tester. Can be Contacted on¬†<span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/sushma-ahuja-284907157/"><strong>LinkedIn</strong></a></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
