<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/defense-evasion/" rel="category tag">Defense Evasion</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Defense Evasion: Windows Event Logging (T1562.002)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/defense-evasion-windows-event-logging-t1562-002/" rel="bookmark"><time class="entry-date published" datetime="2021-04-22T19:29:28+00:00">April 22, 2021</time><time class="updated" datetime="2025-06-16T11:50:31+00:00">June 16, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction" data-start="66" data-end="442"><span style="color: #000000;">In this post, we explore Windows Event Logging defense evasion techniques used by attackers to avoid detection. By disabling, bypassing, or tampering with event logs using tools and scripts, threat actors can cover their tracks and stay hidden from security teams. Understanding these techniques is crucial for defenders to strengthen monitoring and response capabilities.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;">Defense Evasion is a cyber kill chain attack strategy that includes strategies used by attackers to prevent detection during their violation.</span></p>
<ul>
<li class="ai-optimize-8"><strong><span style="color: #000000;">MITRE TACTIC: Defenses Evasion (TA0005)</span></strong></li>
<li class="ai-optimize-9"><strong><span style="color: #000000;">MITRE TECHNIQUE: Impair Defence (T1562)</span></strong></li>
</ul>
<p class="ai-optimize-10"><span style="color: #000000;">SUBTITLE: Disable Windows Event Logging (T1562.002)</span></p>
<h3 class="ai-optimize-11"><span style="color: #800000;">Table of Contents</span></h3>
<ul>
<li class="ai-optimize-12"><strong><span style="color: #000000;">Clear Event log using Wevtutil Command</span></strong></li>
<li class="ai-optimize-13"><strong><span style="color: #000000;">Clear Event log using Powershell</span></strong></li>
<li class="ai-optimize-14"><strong><span style="color: #000000;">Phantom</span></strong></li>
<li class="ai-optimize-15"><strong><span style="color: #000000;">Mimikatz</span></strong></li>
<li class="ai-optimize-16"><strong><span style="color: #000000;">MiniNT registry key</span></strong></li>
<li class="ai-optimize-17"><strong><span style="color: #000000;">Powershell Empire</span></strong></li>
<li class="ai-optimize-18"><strong><span style="color: #000000;">Metasploit</span></strong></li>
</ul>
<p class="ai-optimize-19"><span style="color: #000000;">To restrict the amount of data that can be used for detection and audits, an attacker can disable Windows event logging. Login attempts, process development, other user and device behaviour are all recorded in Windows event logs. Intelligence software and analysts use this information to identify the artifacts.</span></p>
<h3 class="ai-optimize-20"><span style="color: #800000;">Clear Event log using Wevtutil Command</span></h3>
<p class="ai-optimize-21"><span style="color: #000000;">Itâ€™s a system tool that lets you look up details on event logs and publishers. You can also use this command for installing and uninstalling event manifests, exporting, archiving, and clearing logs.</span></p>
<p class="ai-optimize-22"><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-Z9KXTUHyHQE/YIHIAmMJJNI/AAAAAAAAvcA/yY6NVSbCSA0xHA6depYOayn7Pd9LE09DACLcBGAsYHQ/s16000/1.png" alt="Windows Event Logging defense evasion" width="763" height="557"/></span></p>
<p class="ai-optimize-23"><span style="color: #000000;">Execute the following command with administrator right:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wevtutil cl security</pre>
<p class="ai-optimize-24"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bmqH6HWcG10/YIHIE_jaBFI/AAAAAAAAvcE/M49ejjrQPmsgB_ef0lMtpupFt1uHQLoaACLcBGAsYHQ/s16000/2.png"/></span></p>
<p class="ai-optimize-25"><span style="color: #000000;">ðŸ˜Š All logs are clear now, but one log will be generated with event ID 1102 for clearing logs</span></p>
<p class="ai-optimize-26"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gilrIG_H4iU/YIHIJ6nhDdI/AAAAAAAAvcI/DNnWVnUc1xAX84jDXcec6JmVEN7c_sw6ACLcBGAsYHQ/s16000/3.png"/></span></p>
<h3 class="ai-optimize-27"><span style="color: #800000;">Clear Event log using Powershell</span></h3>
<p class="ai-optimize-28"><span style="color: #000000;">Another method is to use PowerShell for clearing logs, as you can observe that the machine has a system &amp; security log.</span></p>
<p class="ai-optimize-29"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hR5diSkkIMQ/YIHIN2_rBPI/AAAAAAAAvcM/GyZVtUOKg7UVNf-vnRdzi-rSE5VgqCIDwCLcBGAsYHQ/s16000/4.1.png"/></span></p>
<p class="ai-optimize-30"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PcGtgQN7neA/YIHIU6Z1O-I/AAAAAAAAvcY/oTwQ08HVGPgXF1Q-BEklRzz5r04eL78RwCLcBGAsYHQ/s16000/4.png"/></span></p>
<p class="ai-optimize-31"><span style="color: #000000;">Run Powershell as administrator and execute the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Clear-Eventlog -LogName Security 
Clear-Eventlog -LogName System</pre>
<p class="ai-optimize-32"><span style="color: #000000;">The above command will clear all logs from inside System &amp; security.</span></p>
<p class="ai-optimize-33"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XcEoDz2233o/YIHIYhuaIgI/AAAAAAAAvcc/8uF0EYVw-2Q8To4NhyfB-c9P0qZ_yRlpACLcBGAsYHQ/s16000/5.1.png"/></span></p>
<h3 class="ai-optimize-34"><span style="color: #800000;">Phantom</span></h3>
<p class="ai-optimize-35"><span style="color: #000000;">This script walks thread stacks of the Event Log Service process (specific svchost.exe) and identifies Event Log Threads to kill Event Log Service Threads. So, the system will not be able to collect logs and at the same time, the Event Log Service will appear to be running. Download it from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/hlldz/Invoke-Phant0m">here</a></strong></span></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">powershell -ep bypass 
Import-Module .\Invoke-Phant0m.ps1
Invoke-Phantom</pre>
<p class="ai-optimize-36"><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-vtWcvamRcjM/YIHIcTNmKaI/AAAAAAAAvck/IqAgXIfZrmEZyyLSTsKb7TB6PzTHk_-owCLcBGAsYHQ/s16000/5.png" alt="Windows Event Logging defense evasion" width="534" height="431"/></span></p>
<h3 class="ai-optimize-37"><span style="color: #800000;">Mimikatz</span></h3>
<p class="ai-optimize-38"><span style="color: #000000;">How can we forget the mimikatz when it comes to the red teaming approach? Mimikatz is the most effective method, allowing you to not only steal the credential but also clear the log from within the event viewer.</span></p>
<p class="ai-optimize-39"><span style="color: #000000;">Run mimikatz as administrator and execute the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">privilege::debug 
event::
event::clear</pre>
<p class="ai-optimize-40"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dmEHYV4Fi7g/YIHIgU1673I/AAAAAAAAvcs/PU8kHhbIpjI1VqsBrQZ8BfmJP6f1TlZOwCLcBGAsYHQ/s16000/6.png"/></span></p>
<h3 class="ai-optimize-41"><span style="color: #800000;">MiniNT registry key</span></h3>
<p class="ai-optimize-42"><span style="color: #000000;">You can play with the registry, create a new registry key as mention below, and reboot the machine to reload the hive.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\MiniNt"</pre>
<p class="ai-optimize-43"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Y5E4sbPPlG0/YIHIkL7GDEI/AAAAAAAAvcw/CkUvZOsT0a4bAXhUZVoPLo9UqoYzgPZkwCLcBGAsYHQ/s16000/7.png"/></span></p>
<p class="ai-optimize-44"><span style="color: #000000;">This key disables the event viewer and thus restricts it from generating the logs.</span></p>
<p class="ai-optimize-45"><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-XLcZ9uQFR34/YIHInv_EEUI/AAAAAAAAvc4/bkE_8xWs1k8wICj_msEA9MdHFY_mXCh8QCLcBGAsYHQ/s16000/8.png" alt="Windows Event Logging defense evasion" width="691" height="466"/></span></p>
<h3 class="ai-optimize-46"><span style="color: #800000;">PowerShell Empire</span></h3>
<p class="ai-optimize-47"><span style="color: #000000;">The PowerShell Empire can also be used to clear logs, classify Event Log threads, and destroy Event Log Service threads.</span></p>
<p class="ai-optimize-48"><span style="color: #000000;">Use the following command to execute the module for respected agents:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usemodule management/phant0m 
execute</pre>
<p class="ai-optimize-49"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bsqbO8mOlDg/YIHIr6z-ePI/AAAAAAAAvc8/7L56yxZ8g7Ig1ajeDHTdw7Tc78PP74FFACLcBGAsYHQ/s16000/50.png"/></span></p>
<h3 class="ai-optimize-50"><span style="color: #800000;">Metasploit</span></h3>
<p class="ai-optimize-51"><span style="color: #000000;">Last but not least, we have the Metasploit framework to clean applications, security &amp; system logs from within the event viewer. In the meterperter session, you can execute the following command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">clearev</pre>
<p class="ai-optimize-52"><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-M_WAALaOFR0/YIHIvxXSWeI/AAAAAAAAvdA/sZm1qCehbjUpNH_xAlIXYjtfI0tHMCmkACLcBGAsYHQ/s16000/51.png" alt="Windows Event Logging defense evasion" width="486" height="96"/></span></p>
<p class="ai-optimize-53"><span style="color: #000000;">Disabling Windows Event Logging is a common defense evasion technique used by attackers. Understanding how this tactic works is crucial for defenders to detect and mitigate such stealthy attacks.</span></p>
<p class="ai-optimize-54"><span style="color: #000000;">For more MITRE ATT&amp;CK refer this</span>: <strong><a href="https://www.hackingarticles.in/tag/mitre-attack/">Link</a></strong></p>
<p class="ai-optimize-55"><span style="color: #000000;">Reference: <strong><a href="https://svch0st.medium.com/event-log-tampering-part-1-disrupting-the-eventlog-service-8d4b7d67335c">https://svch0st.medium.com/event-log-tampering-part-1-disrupting-the-eventlog-service-8d4b7d67335c</a></strong></span></p>
<p class="ai-optimize-56"><span style="color: #000000;"><strong>Author:Â Aarti Singh</strong> is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact</span><strong><a href="https://www.linkedin.com/in/aarti--singh/">Â <span style="color: #0000ff;">here</span></a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
