<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Bypass User Access Control using Empire</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/bypass-user-access-control-using-empire/" rel="bookmark"><time class="entry-date published" datetime="2019-03-09T09:59:54+00:00">March 9, 2019</time><time class="updated" datetime="2025-06-03T12:26:26+00:00">June 3, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">This is the fifth article in our empire series, for the basic guide to empire In this article, we will learn to bypass administrator privileges using various bypass UAC post-exploitation methods.</span></p>
<h3 class="ai-optimize-7"><span style="color: #800000;">Table of content</span></h3>
<ul>
<li class="ai-optimize-8"><span style="color: #000000;">Introduction</span></li>
<li class="ai-optimize-9"><span style="color: #000000;">Bypassuac_env</span></li>
<li class="ai-optimize-10"><span style="color: #000000;">Bypassuac_eventvwr</span></li>
<li class="ai-optimize-11"><span style="color: #000000;">Bypassuac_fodhelper</span></li>
<li class="ai-optimize-12"><span style="color: #000000;">Bypassuac_wscript</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">Bypassuac</span></li>
</ul>
<h3 class="ai-optimize-14"><span style="color: #800000;">Introduction</span></h3>
<p class="ai-optimize-15"><span style="color: #000000;">UAC stands for User Account Control, which means which user has how many rights to make changes in the system. The rights are given too a user depends on the integrity levels; which are :</span></p>
<ul>
<li class="ai-optimize-16"><span style="color: #000000;">High : Administrator rights</span></li>
<li class="ai-optimize-17"><span style="color: #000000;">Medium : Standard user rights</span></li>
<li class="ai-optimize-18"><span style="color: #000000;">Low : Extremely restricted</span></li>
</ul>
<p class="ai-optimize-19"><span style="color: #000000;">UAC works by adjusting the permission level of our user account, and on the bases of this permission, it decides whether to run a program or not. When changes are made to this permission level, it notifies us but these modules help us to bypass UAC. When we try and gain the highest integrity that is indicated by the number 1.</span></p>
<h3 class="ai-optimize-20"><span style="color: #800000;"><strong>Bypassuac_env</strong></span></h3>
<p class="ai-optimize-21"><span style="color: #000000;"> Let’s start with the first exploit i.e. bypassuac_env. Now, as you can see in the image, we already have an empire session with the integrity of 0, which means we do not have admin right. So type the following set of commands to get administrator privileges :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usemodule privsec/bypassuac_env
set Listener http
execute</pre>
<p class="ai-optimize-22"><span style="color: #000000;">Executing the above module will give you a new session. Upon accessing the said session you can see the integrity has to change to 1, which means no we have administrator rights, just as shown in the image below :</span></p>
<p class="ai-optimize-23"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-uQXMGQHrNeE/XIOMEASXg6I/AAAAAAAAdZ4/nJdMpP9M3kER8bm1P703wl09We_2xhtJgCLcBGAs/s1600/1.png"/></span></p>
<h3 class="ai-optimize-24"><span style="color: #800000;">bypassuac_eventvwr</span></h3>
<p class="ai-optimize-25"><span style="color: #000000;">Now, let’s try another exploit which is privsec/bypassuac_eventvwr. The function of this module is the same as before i.e. to get administrator rights so we can attack more effectively.  This module makes changes in the registry key and inserts a custom command which is then executed when windows event viewer is launched. This custom command will turn the UAC flag off. And, as you can see, we have the session with the integrity of 0 which indicates we have no admin rights yet. So, run the following commands :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usemodule privsec/bypassuac_eventvwr
set Listener http
execute</pre>
<p class="ai-optimize-26"><span style="color: #000000;">As you can see, we have a new session with the integrity of 1 which confirms that we now have admin rights.</span></p>
<p class="ai-optimize-27"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-YNzH06gNHBA/XIOMEACoGNI/AAAAAAAAdZ0/rrjVrp-yBSM_FPS0RpUDFYpK9K_nJGN3gCLcBGAs/s1600/2.png"/></span></p>
<h3 class="ai-optimize-28"><span style="color: #800000;"><strong>Bypassuac_fodhelper</strong></span></h3>
<p class="ai-optimize-29"><span style="color: #000000;">The next module we will use for the same purpose is privesc/bypassuac_fodhelper. This module will gain administrator rights by hijacking a special key in the registry and inserting custom command that will get invoked when windows fodhelper.exe application will be executed. It covers its tracks by getting rid of the key after the payload is invoked. Now, just like before use the following set of commands :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usemodule privesc/bypassuac_fodhelper
set Listener http execute</pre>
<p class="ai-optimize-30"><span style="color: #000000;">Once the module is executed, you will have the session with the integrity of 1, hence we are successful in attaining the admin rights.</span></p>
<p class="ai-optimize-31"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-zynR7_s0KUY/XIOMEIvdg0I/AAAAAAAAdZ8/Zu1eEkBUs84iI5s8mwd25P62TQIV3d0xwCLcBGAs/s1600/3.png"/></span></p>
<h3 class="ai-optimize-32"><span style="color: #800000;"><strong>bypassuac_wscript</strong></span></h3>
<p class="ai-optimize-33"><span style="color: #000000;">Next the bypassuac module we will use is privesc/bypassuac_wscript. When using wscript for UAC bypass, there is no need for you to send a dll to the target. As wscrpit.exe does not has embedded manifestation, it’s easy to abuse it. And similarly, to have administrator privileges use the following commands :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usemodule privesc/bypassuac_wscript
set Listener http
execute</pre>
<p class="ai-optimize-34"><span style="color: #000000;">As you can see in the image, the new session that we have gained is with admin rights.</span></p>
<p class="ai-optimize-35"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-yE4Del2g_8Q/XIOMFLDzDzI/AAAAAAAAdaA/NcNr9577sUsc7npPOvhV2hsmdOInHUx1QCLcBGAs/s1600/4.png"/></span></p>
<h3 class="ai-optimize-36"><span style="color: #800000;">bypassuac</span></h3>
<p class="ai-optimize-37"><span style="color: #000000;">The last module we will use for the same purpose is privesc/bypassuac, this is a trivial process. To execute the following commands :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usemodule privesc/bypassuac
set Listener http
execute</pre>
<p class="ai-optimize-38"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-emcoKevLvsM/XIOMFczhGjI/AAAAAAAAdaE/Z7HzkMqIOQk9O-wc9s0wh3x9GyiokhPdgCLcBGAs/s1600/5.png"/></span></p>
<p class="ai-optimize-39"><span style="color: #000000;">As you can see in the image above, the new session gained has the integrity of 1; hence, the system gains administrator rights.</span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To learn more about Red Teaming. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/red-teaming/">link.</a></strong></p>
<p class="ai-optimize-40"><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contact <strong><a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
