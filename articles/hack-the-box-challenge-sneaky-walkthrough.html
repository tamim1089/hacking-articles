<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Sneaky Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-sneaky-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-06-23T05:15:45+00:00">June 23, 2018</time><time class="updated" datetime="2025-07-05T17:42:03+00:00">July 5, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “Sneaky” which is available online for those who want to increase their skill in penetration testing and black box testing. Sneaky is retired vulnerable lab presented by <strong>Hack the Box</strong> for making online penetration practices according to your experience level; they have the collection of vulnerable labs as challenges from beginners to Expert level.</span></p>
<p><span style="color: #000000;"><strong>Level: </strong>Intermediate</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> find <strong>user.txt</strong> and <strong>root.txt</strong> file on victim’s machine.</span></p>
<p><span style="color: #000000;">Since these labs are online available therefore they have static IP and IP of sense is 1<strong>0.10.10.20</strong> so let’s begin with nmap port enumeration.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sT -sU 10.10.10.20</pre>
<p><span style="color: #000000;">From given below image, you can observe we found port 80 and 161 are open on target system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DaELfEi1rWQ/Wy3Ukw1hGXI/AAAAAAAAXeM/Tj8woxAy9LQU7H8N2i_V6gMreaoW7dl4wCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">As port 80 is running http we open it in our browser, the website shows that it’s under construction.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5DuCmRDIEL0/Wy3Uof44M-I/AAAAAAAAXeY/TO47wYc4VtQCVbMewNXyL5IrpuAHUVofACEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We initiate dirb to enumerate the directories hosted on the target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://10.10.10.20/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PQVi8L4OX3w/Wy3Un-DB6fI/AAAAAAAAXeU/iOA62rDOwdcSgbEh6fqC6QA4W805lvDvACEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">There, we find a directory called /dev/ we open it in our browser and find a login screen.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Vqxfcnr-RT4/Wy3UoSgETcI/AAAAAAAAXeU/ePwC7f4-Q9MMSoTZ4gicT6LjtXIhuuwlQCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Then, we find the login page is vulnerable to sql injection; we use this vulnerability to bypass the login page using query ‘or 1=1—in username and password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-kp1fFclOc5M/Wy3UoTBkoxI/AAAAAAAAXeQ/mc93ASUoGdItn-xCszGzvSoJnF1Oy85OACEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">After logging in we find a link on the webpage.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ezUaBWTjaMY/Wy3UpGFy8pI/AAAAAAAAXeY/er23RMXhh1IO5-3yLDQDDZ7vk1qKUZDJACEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We open the link and find a RSA private key. We download the key into our system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-eyY_mZoiHHU/Wy3Uo3pWTZI/AAAAAAAAXec/h5OGfulFFJgVqSno2v_qrjUGesH68q-vgCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now the target machine is not running any ssh service so that we can use this to login through ssh.</span></p>
<p><span style="color: #000000;">To investigate further we enumerate SNMP protocol to gain more information.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf &gt; use auxiliary/scanner/snmp/snmp_enum
msf auxiliary(scanner/snmp/snmp_enum) &gt; set rhosts 10.10.10.20
msf auxiliary(scanner/snmp/snmp_enum) &gt; set threads 5
msf auxiliary(scanner/snmp/snmp_enum) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Ej1BjagvG5c/Wy3Uks5SCXI/AAAAAAAAXeI/_lwVikdQqzwiYQ9xvwvTz-i5mn_wU4xvgCEwYBhgL/s1600/10.1.png"/></span></p>
<p><span style="color: #000000;">After enumerating the target machine we find that maybe ssh is running in ipv6.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ZUeyiBsykk8/Wy3UkkjE4TI/AAAAAAAAXeM/vvnJkocVs0IxcVtFj-tklccJog8dTsfuwCEwYBhgL/s1600/10.2.png"/></span></p>
<p><span style="color: #000000;">We use a python script called Enyx to find the ipv6 address of the target machine. You can get the script from this <a style="color: #000000;" href="https://github.com/trickster0/Enyx">link</a>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python enyx.py 2c public 10.10.10.20</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-gVCBk4gvL1k/Wy3UlgRvX3I/AAAAAAAAXec/3NaSOp4fDN44xahPw_YsY2xIuhXkDGZ_QCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">After finding the ipv6 address of the target machine we login through ssh using the username and RSA Private key that we find after we login on the /dev/ page.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh -i key thrasivoulos@dead:beef:0000:0000:0250:56ff:fe8f:d853</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-w0X6XuLjvlw/Wy3UlVYgspI/AAAAAAAAXec/2FZn1ErxkuQ_dImbP3oqMSgZlqQRBn0PgCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">After logging in through ssh we find a file called user.txt we open it and find our first flag. Now we try to find files with suid bit set.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">find / -perm -4000 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-bT05bJJhU9U/Wy3UlbmDBCI/AAAAAAAAXeY/WacDVQ5rc4kb2_Y-7EkZbxM9AB0q2ZahQCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">We find a binary file called chal in /usr/local/bin we open it in gdb and find there is a strcpy function.</span></p>
<p><span style="color: #000000;"><strong>(gdb) set disassembly-flavor intel</strong></span></p>
<p><span style="color: #000000;"><strong>(gdb) disas main</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pattern_create.rb -l 500</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-3UTTzmZNqFE/Wy3UmL_bZMI/AAAAAAAAXeE/tPWkNrY2_BUWsSjFJS54nfklaDhsL0ArwCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Now we try to check if we can overflow the memory through this strcpy function. First we create a 500 byte string using the patter create script in metasploit.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uLxnTBs6JXw/Wy3Um-5-UQI/AAAAAAAAXeE/4lq2kP4vRpMm80dwKJ9DGEG_hE07dAjtwCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">We run the file in gdb and find that the return address was overwritten with the characters in the string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Vm2uRqaI2l8/Wy3Um-81MeI/AAAAAAAAXeU/YQe7WWHmev0cMoJfKmT77FTk56ijsJVbACEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Then, we check the size required to completely overwrite the return address by checking the location of the string we created that became the return address inside the pattern. We use pattern offset tool to check the corresponding location.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">pattern_offset.rb -q 316d4130 -l 500</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-bgtpmxjrvFg/Wy3Um8D5lQI/AAAAAAAAXeE/g_vLxdqBlskyu9oNydMRkmafQx0HDJCKwCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">We find that after 362 bytes the return address gets overwritten. Then, we take a look at the stack to find a location for nop sled and shell code.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-cIMA5gdPZNc/Wy3UnWKKJTI/AAAAAAAAXeI/ymg6RmFe6TofXh-iX6eyxTnkVzC3pvh0ACEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">We picked the stack address 0xbffff510; you can change the stack pointer address and pick the shellcode according to your need.  We use python script to create our exploit and pass the output as argument for the file. When we run the command below, we get a tty shell as root user. We move to /root/ directory and find a file called root.txt; we open the file and find our final flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-vyrqo-xb9oY/Wy3UnqqDjfI/AAAAAAAAXeM/sbOLo2UM3hQTAmxNetVOZkaCZyovj1A-wCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
