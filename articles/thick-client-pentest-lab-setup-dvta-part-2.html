<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a>, <a href="https://www.hackingarticles.in/category/pentest-lab-setup/" rel="category tag">Pentest Lab Setup</a></span>            </div>
            <h1 class="post-title entry-title">Thick Client Pentest Lab Setup: DVTA (Part 2)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/thick-client-pentest-lab-setup-dvta-part-2/" rel="bookmark"><time class="entry-date published" datetime="2021-01-13T15:19:21+00:00">January 13, 2021</time><time class="updated" datetime="2025-06-08T15:54:33+00:00">June 8, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In the previous article, we have discussed the Lab setup of Thick Client: DVTA</span></p>
<p><span style="color: #000000;">You can simply take a walkthrough by visiting here: – <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/thick-client-pentest-lab-setup-dvta/">Thick Client Pentest Lab Setup: DVTA</a></strong></span></span></p>
<p><span style="color: #000000;">In this article, we are going to discuss how can we configure the DVTA application to connect to our server </span><span style="color: #000000;">For this, I’m going to use one single window 10 instances for the entire setup. That means both the DVTA client as well as the SQL server are going to run on the same machine. </span><span style="color: #000000;">You can configure the DVTA client and SQL server on Different Window 10 instances.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;">Prerequisites</span></li>
<li><span style="color: #000000;">Download Links &amp; Credentials</span></li>
<li><span style="color: #000000;">Download and install the DVTA application</span></li>
<li><span style="color: #000000;">Reversing and Modifying the original DVTA application</span></li>
<li><span style="color: #000000;">Configure &amp; log in to the Modified DVTA application</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Prerequisites</strong></span></h3>
<ul>
<li><span style="color: #000000;">Good knowledge of C# (C Sharp) programming knowledge.</span></li>
<li><span style="color: #000000;">A bit of Reverse Engineering knowledge.</span></li>
</ul>
<h3><span style="color: #800000;">Download Links &amp; Credentials</span></h3>
<p><span style="color: #000000;">DVTA application: – <strong>https://mega.nz/file/rPJQ0LTL#CuhQ9HBeEIKHa67jbITFQbt49FZalugWlRe5A33O6y4</strong></span></p>
<p><span style="color: #000000;">DnSpy application: – <strong><a style="color: #000000;" href="https://github.com/dnSpy/dnSpy/releases">https://github.com/dnSpy/dnSpy/releases</a></strong></span></p>
<p><span style="color: #000000;">Database users and password: –</span></p>
<p><strong><span style="color: #000000;">Credentials:</span></strong></p>
<pre class="lang:default decode:true">vijay:vijay
raj:raj
admin:admin123</pre>
<h3><span style="color: #800000;">Download and install the DVTA application</span></h3>
<p><span style="color: #000000;">You can directly download the DVTA application by using this link</span></p>
<pre class="lang:default decode:true">https://mega.nz/file/rPJQ0LTL#CuhQ9HBeEIKHa67jbITFQbt49FZalugWlRe5A33O6y4</pre>
<p><span style="color: #000000;">when the download completes extract it into a new folder which similarly looks like this as shown in the image below.</span></p>
<p><span style="color: #000000;">Alright, this is the Release File that we have gotten for the testing. If you see there are a couple of file inside of the Release folder and the main application here is the one with the Red icon named <strong>“DVTA.exe” </strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gMOtVkw-czM/X_8AnhuIX4I/AAAAAAAAs5A/yXGgcKQA6zYuSGEagRLO3onCgLT_rpBogCLcBGAsYHQ/s16000/56.png"/></span></p>
<p><span style="color: #000000;">So, let’s give a double click to the DVTA.exe and run it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UR1ybCRufCM/X_8As2YHAsI/AAAAAAAAs5E/cq-7O2lbY1k3DHm-CbhmY2gfdRKQ18eDgCLcBGAsYHQ/s16000/57.png"/></span></p>
<p><span style="color: #000000;">Once that done you should see a prompt window something like this. If you notice the bottom part of the prompt window, we can configure the server here.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5Fq_7gduVsE/X_8AxZSFduI/AAAAAAAAs5I/3M162SsnUuUBjXOBLnN9Rg7YBa_uDdT5ACLcBGAsYHQ/s16000/58.png"/></span></p>
<p><span style="color: #000000;">The original DVTA application doesn’t have this feature and the IP address is hardcoded. The problem with that is we need to have a server with the exact same IP that is hardcoded in the application. For this, all we need to compile the source code to modify the application somehow so that it points or redirects to our server.</span></p>
<p><span style="color: #000000;">Now, our main Task before configuring the server is to enable the <strong>“configure Server”</strong> button so that it can talk to our server.</span></p>
<p><span style="color: #000000;"><em>This requires a bit of Reversing knowledge…. And this going to be fun</em>.</span></p>
<h3><span style="color: #800000;">Reversing and Modifying the original DVTA application</span></h3>
<p><span style="color: #000000;">Now let’s see how we can enable the <strong>“configure server button”</strong>.</span></p>
<p><span style="color: #000000;"><em>Before we enable this button let’s think a while what are the situations where we came across this kind of disabled buttons in the client applications in the real world when we do pentesting. There are cases where a user logs In and some menus are disabled for him. For instance, he is the maker and he can’t have checker menus so some developers disable them in the client assuming that the user cannot enable them and these disabled menus can be easily enabled in C sharp.net applications.</em></span></p>
<p><span style="color: #000000;">Now let’s see how we can do that. First of all, simply take a copy of the Extracted DVTA Release folder for the case if we did something wrong or messed up with codes so simply, we can start from fresh without downloading it again. To enable the “configure server” button we’re going to use a tool called dnSpy. You can download it directly by following this link: – <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/dnSpy/dnSpy/releases">https://github.com/dnSpy/dnSpy/releases</a></strong></span></span></p>
<p><span style="color: #000000;">Download the latest version from the release section.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2BnKSPccYxA/X_8A2E1R0GI/AAAAAAAAs5M/Tc1NXSnZ8RU4Y-BhvrSsMBYr-JWE3G01QCLcBGAsYHQ/s16000/59.png"/></span></p>
<p><span style="color: #000000;">When the download is complete extract it into a new folder.</span></p>
<p><span style="color: #000000;">Once the extraction is complete you should see two versions of dnSpy one is 32-bit and the other one 64-bit. We are going to use the 32-bit version because our target application is 32-bit.</span></p>
<p><span style="color: #000000;">So, if you see in the below image the one which is having dnSpy-x86 is the 32-bit version and the other one that just says the dnSpy is the 64-bit version.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-K2K19WsPbjc/X_8A6ImZPAI/AAAAAAAAs5Q/zLseh05RMR8jmTSNWYjvsso-oiUtMqbUACLcBGAsYHQ/s16000/60.png"/></span></p>
<p><span style="color: #000000;">So, without wasting time Quickly open up <strong>“dnSpy-x86” </strong>by giving it a double click and simply run it</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ez4vVLrqBBA/X_8A90Y3h8I/AAAAAAAAs5Y/AWRLMT5mizMcjKr3DsyC_6VqB_uqQO5ngCLcBGAsYHQ/s16000/61.png"/></span></p>
<p><span style="color: #000000;">When the dnSpy application started open up the DVTA application by navigating to <strong>File &gt; open</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-b5Z06XOpiik/X_8BCHNgASI/AAAAAAAAs5g/-GKil8BLqR0DK2fuur0ldnbOAuy3rY_IACLcBGAsYHQ/s16000/62.png"/></span></p>
<p><span style="color: #000000;">And go to the Release folder of the DVTA application and choose DVTA.exe. </span><span style="color: #000000;">So, this is the main application that we’re going to modify.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7rvlrfS-6Ds/X_8BGuWvrOI/AAAAAAAAs5k/wAITrwUjql4L9KDWUzbLS6tIimPwXaXkQCLcBGAsYHQ/s16000/63.png"/></span></p>
<p><span style="color: #000000;">Now, our main task is to find out the exact location of the button which is disabled and then patch the binary in a way that it’s going to be enabled</span></p>
<p><span style="color: #000000;">On the left side menu, click on the DVTA and expand the DVTA.exe. Once it expanded select DVTA. Now, If you see, there seems to be a couple of here within the DVTA application. Basically, these are C sharp files in the source code. If you notice above when you open the DVTA application, it open’s up the <strong>login page of DVTA</strong> and on that page the bottom part has the <strong>“configure server”</strong> button. So, this is what we’re interested in.</span></p>
<p><span style="color: #000000;">Now, without wasting time click on Login and it will start automatically decompiling the source code for us.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ugs4OdZptW8/X_8BK15fkBI/AAAAAAAAs5s/E35FOzs78eA5UkUeKRU6Rriu3uOTyFzZACLcBGAsYHQ/s16000/64.png"/></span></p>
<p><span style="color: #000000;">Now, it seems very interesting and it’s pretty easy for us to understand the entire source code of what this application is doing here. When you scroll down to the source code you can find there is a condition that is looking for a method called <strong>“is a server configured” </strong>when you click on this it will see where the definition is and when you see the definition it is always returning <strong>“false” </strong>and what happens if its return the value True.</span></p>
<p><span style="color: #000000;">Let’s see…</span></p>
<p><span style="color: #000000;"><em>It is going to show the particular message <strong>“MessageBox.Show(“This application is usable only after configuring the server”) </strong></em>That means this block is never going to execute because it is always <strong>“returning false”</strong>. So what that means is “<strong>this.configserver.Enabled = False;</strong>” is the part which is going to get executed always as highlighted by the right arrow  In the below image</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YaY9L4H0ouk/X_8BPL6nC_I/AAAAAAAAs50/fnaZxZBg92cvY-cleUCASI9-hSL6Y04nwCLcBGAsYHQ/s16000/65.png"/></span></p>
<p><span style="color: #000000;">If you noticed that is all the source code is are in C sharp.</span></p>
<p><span style="color: #000000;">Let’s take a look at the IL version of this source code. IL is an intermediate language. This is similar to the old assembly language in the C programming world. You can convert the source code into the IL by navigating to a drop-down box nearby the start icon. If you compare the C sharp code or IL code basically, they are doing the same thing.</span></p>
<p><span style="color: #000000;">As we have seen earlier “config server” is a button that you can easily find here. It’s a button of <strong>“class [system.windows.Forms]System.Windows.Forms.Button “ </strong>after this particular line there seems to be a call to “<strong>System.Windows.Forms.Control</strong>” and set Enabled method is being called and this Set_Enabled method is taking a Boolean value which can be true or false. If you see there seems to be a value which is ldc.i4.0 and then if you hover over your mouse on Set_Enabled(bool) it pushes the integer value of 0 onto the evaluation stack as an int 32 and probably that’s the reason why the button is always disabled because this value is being pushed under the stack as an argument and set enable is always set to false.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XjSkdc7zxDo/X_8BUkLKCRI/AAAAAAAAs58/zwAjuaC_aZ0Kxg6VgSOA0ql-u8zicb5WgCLcBGAsYHQ/s16000/66.png"/></span></p>
<p><span style="color: #000000;">Now, give a right-click to the value of ldc.i4.0 and <strong>“Edit the IL instructions”</strong> as shown below</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tLYS_zpN6LA/X_8BZYPtPvI/AAAAAAAAs6E/_BAFDEjRC6wXpl-PI6zk20bP8E5gXr39gCLcBGAsYHQ/s16000/67.png"/></span></p>
<p><span style="color: #000000;">Now, it will open up another prompt and give a right-click to the value ldc.14.0 and further then select ldc.i4.1 instead of 0 and hit ok as shown below</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fFK80JmfUlg/X_8BeeQff9I/AAAAAAAAs6M/tbHuXeptxxQTpHWTTo_VSAODhYDijrSrgCLcBGAsYHQ/s16000/68.png"/></span></p>
<p><span style="color: #000000;">Now save the configuration by navigating to the <strong>File &gt; Save Module</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GyIwgCKjZzk/X_8Bji89zQI/AAAAAAAAs6Q/CLEo7LO-fl4_e_cVNtguRMzHUg_nHHjZACLcBGAsYHQ/s16000/69.png"/></span></p>
<p><span style="color: #000000;">Now save this file in the same place where your original DVTA exist so that it can replace the original DVTA.exe as shown below</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6Ud1vCqajNI/X_8BoyojFfI/AAAAAAAAs6U/L6oyuIaDpKo_TkyExYA3s7og-5n-vdiVACLcBGAsYHQ/s16000/70.png"/></span></p>
<p><span style="color: #000000;">Now we can close the dnSpy application and open up the Modified application DVTA.exe by going to the same directory.</span></p>
<h3><span style="color: #800000;">Configure &amp; log in to the Modified DVTA Application</span></h3>
<p><span style="color: #000000;">Hurray…as you can see the “configure server button is enabled</span></p>
<p><span style="color: #000000;">So, we’re all set to configure the server. As I told you earlier, we are going to use the same server as the database.</span></p>
<p><span style="color: #000000;">So, let’s enter <strong>“127.0.0.1”</strong> as our server and click on <strong>“configure server”.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-49gAmin1krc/X_8BtjCtm1I/AAAAAAAAs6c/UnRQ-DvPdkcAzZpmNkeniMCDN9ZTi3j0QCLcBGAsYHQ/s16000/71.png"/></span></p>
<p><span style="color: #000000;">As you can see our server is successfully configured.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mXgFU4DoSok/X_8Bxm0PCXI/AAAAAAAAs6k/2Mq59MLdnW4T5UNw53HUBbhC7gzLmZGOgCLcBGAsYHQ/s16000/72.png"/></span></p>
<p><span style="color: #000000;">Now, just to make sure everything is fine to come back to the directory of release folder of DVTA and give a double-tap to the DVTA.exe XML configuration file which is just below the DVTA application as shown below</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uFw-oe7M4pQ/X_8B3weTR9I/AAAAAAAAs6o/dGWwOLuglmQK3XUuEUJEULvjlZfMG1DeQCLcBGAsYHQ/s16000/73.png"/></span></p>
<p><span style="color: #000000;">This is basically a configuration file. Give it a double tap and open the configuration file.</span></p>
<p><span style="color: #000000;">When you see the application settings you can see that the <strong>Database server is “127.0.0.1/SQLExpress”</strong> and the “<strong>FTP server is also configured to 127.0.0.1</strong>”.</span></p>
<p><span style="color: #000000;">Awesome… now we’re good with the configuration.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NchdWz7qNPQ/X_8B9rGK8MI/AAAAAAAAs6w/M95nZoL7_PENLNaN4ohhlX2owV2b7CjEACLcBGAsYHQ/s16000/74.png"/></span></p>
<p><span style="color: #000000;">Now open the modified DVTA application and log in as the user <strong>“vijay”</strong> that we created previously on the SQL Server setup.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8TrLmdhGP64/X_8CBl2PpMI/AAAAAAAAs64/mrAVpwG3NWkUCQaoqrCCicmElK8E6TsQACLcBGAsYHQ/s16000/75.png"/></span></p>
<p><span style="color: #000000;">Great, as we can see we have successfully logged in to the application</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-q6ABg5FTv9Q/X_8CF0rVEUI/AAAAAAAAs68/t8ysMHpAEeMyeDzorDSwRCScBZmKhvwOgCLcBGAsYHQ/s16000/76.png"/></span></p>
<p><span style="color: #000000;">Let’s also verify another user, for example, admin and check which rights admin have</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kwgB9WbfmDA/X_8CJrV6VfI/AAAAAAAAs7A/GMkZ4nMbIf0-nRrsSaCKccDV5xQDqjMQQCLcBGAsYHQ/s16000/77.png"/></span></p>
<p><span style="color: #000000;">Great, as we can see everything works fine and we’re successfully logged in as user admin.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IBC8yRzWIAs/X_8CNcENKpI/AAAAAAAAs7I/h9npLLekCd8tFq3zNeYdpL7sCuEnz1zxgCLcBGAsYHQ/s16000/78.png"/></span></p>
<p><span style="color: #000000;">Congratulations.</span></p>
<p><span style="color: #000000;">Now if you have been done until here then you are all set with your Damn Vulnerable Thick Client Application setup.</span></p>
<p><span style="color: #000000;">From the next part, we are going to systematically pentesting this application for various issues.</span></p>
<p><span style="color: #000000;">One most important thing <strong>“you can use all these steps from here as a checklist for your real-world Thick Client Penetration Testing Engagements”.</strong></span></p>
<p><span style="color: #000000;"><strong>Author – </strong>Vijay is a Certified Ethical Hacker, Technical writer and Penetration Tester at Hacking Articles. Technology and Gadget freak. Contact <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/vijay-igcbr/">Here</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
