<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge Kotarak Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-kotarak-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-04-21T10:29:59+00:00">April 21, 2018</time><time class="updated" datetime="2025-07-26T07:54:21+00:00">July 26, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “Kotarak” which is available online for those who want to increase their skill in penetration testing and black box testing. Kotarak is retired vulnerable lab presented by <strong>Hack the Box</strong> for making online penetration practices according to your experience level; they have the collection of vulnerable labs as challenges from beginners to Expert level.</span></p>
<h5><span style="color: #000000;">Level: Hard</span></h5>
<p><span style="color: #000000;"><strong>Task:</strong> find <strong>user.txt</strong> and <strong>root.txt</strong> file on victim’s machine.</span></p>
<p><span style="color: #000000;">Since these labs are online available therefore they have static IP and IP of sense is <strong>10</strong>.<strong>10.10.55</strong> so let’s begin with nmap port enumeration.</span></p>
<pre class="lang:default decode:true ">nmap -p- -A 10.10.10.55 --open</pre>
<p><span style="color: #000000;">From given below image, you can observe we found port 22, 8009, 8080, 60000 are open in victim’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-WQAXXbWcqgE/WtsNvShnJvI/AAAAAAAAWZo/lMYOyPPty40zqN9ijnA6zXopV-PW_q6NgCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">As port 8080 and 60000 are running HTTP, we open the IP in our browser and access the page through port 8080. As soon as we open the ip in our browser we get a tomcat authentication prompt asking for username and password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-xY8Z7mWr6gE/WtsNytL4yHI/AAAAAAAAWag/MoBMuaTPRlAcbqAbC5oiH4S1-h2_O1pFgCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">When we access the target machine through port 60000, we find a page that is hosted on the machine can be used to access the internet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-LV7mnlA62CI/WtsNzlib0KI/AAAAAAAAWaw/mJWCe4-qsJ02AM7JauYD9qZUTlTMwTg8gCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Now we need to use the dirb tool to enumerate the directories of the target machine.</span></p>
<pre class="lang:default decode:true ">dirb http://10.10.10.55:60000/</pre>
<p><span style="color: #000000;">From given below image you can observe the highlighted directory that is put up by dirb in its output result.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-OT2YUDceQyQ/WtsNz_mzn0I/AAAAAAAAWa4/oHSAsPATaw40XMMSDX1WIcRj1dXbYYN2QCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We now try to check if the page is vulnerable to SSRF or not by trying to access a forbidden page on the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-pUt_ujkcs_0/WtsN0Z2S5xI/AAAAAAAAWa0/rRopeN_o1RcMfbXQz39JdzChOsJtSMoLQCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">when we open server-status through the vulnerable page, we are able to access the forbidden content. We then find that port 888 is listening locally on the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-QoIiDFbNGFE/WtsN01ugU1I/AAAAAAAAWa8/404wno5VHPA53HCcnRqO2oWgqnrJ49KPwCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Then we opened http://localhost:888 through URL and it contains a few links to different files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-QE4QqitKbIQ/WtsN1GS4QvI/AAAAAAAAWbA/747iBIfMe8kXxzdZh1CZAcyzvYTNVbDSgCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">We open <strong>backup</strong> and find that it was empty.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cwVuvzbtEhs/WtsN1CcKgVI/AAAAAAAAWbE/LLN4ZUqNcyQzX0-cZCqOxTsCRX54RDu6QCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">To gain further information we used curl to access the page and find that it is an XML file that contains a username and password.</span></p>
<pre class="lang:default decode:true">curl http://10.10.10.55:60000/url.php?path=localhost:888/?doc=backup
</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-86SYpc3NVzw/WtsNvUFAiwI/AAAAAAAAWZs/XXons13Q4Y87vn6GD84ndV9VyPmDwKPIQCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">We use the above credentials to login into tomcat manager application that is hosted on port 8080.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jpJwdOOgPVA/WtsNvbmy2vI/AAAAAAAAWZw/4CeMmHpO3xA9dcqcjpF4cfAz9_sJKYCiACEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">As we were able the right credentials for tomcat server, we found that it was vulnerable to this exploit <a style="color: #000000;" href="https://www.cvedetails.com/cve/cve-2009-3843" class="broken_link">here</a>. We used metasploit to exploit this vulnerability.</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/multi/http/tomcat_mgr_upload
msf exploit(multi/http/tomcat_mgr_upload) &gt; set rhost 10.10.10.55
msf exploit(multi/http/tomcat_mgr_upload) &gt; set rport 8080
msf exploit(multi/http/tomcat_mgr_upload) &gt; set httpusername admin
msf exploit(multi/http/tomcat_mgr_upload) &gt; set httppassword 3@g01PdhB!
msf exploit(multi/http/tomcat_mgr_upload) &gt; exploit</pre>
<p><span style="color: #000000;">Finally, we got the meterpreter session as shown in the below image</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-sF7wk1qHnbM/WtsNv9Zn5vI/AAAAAAAAWZ0/XIfP7AE_BTYNdso2AzUGqxa6ZabprsutgCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">After gaining the reverse shell we start enumerating the target system. In <strong>/home/tomcat/to_archive/pentest_data </strong>we find a few interesting files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-hSLTAjJdaUU/WtsNwFK6hMI/AAAAAAAAWZ4/1KzEJbm8DCcVoOezfVEXyW_vYI9kTENkgCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">In /home/tomcat/to_archive/Pentest_data we find a directory information tree file and binary file.</span></p>
<h5><span style="color: #000000;">We download both the files into our system</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-5PNKrkR26yY/WtsNwRgTf5I/AAAAAAAAWbI/pKNs2DlyQL8DGohmupeB6o6Txs4Vm0w6gCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">We used <strong>impacket-secretsdump</strong> to dump hashes inside the files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ApyV_lpe6xk/WtsNwisuZZI/AAAAAAAAWaA/ssdPbRvMDC4VBAw7QHmwSLWdbwnueJq_gCEwYBhgL/s1600/15.1.png"/></span></p>
<p><span style="color: #000000;">Now we are able to crack one of the hashes and find it to be<strong> f16tomcat!</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-EQeT21OK8-w/WtsNwmbCxQI/AAAAAAAAWaE/omAdRf041cY-xXmLMsz249xL3iNF20oRQCEwYBhgL/s1600/15.2.png"/></span></p>
<p><span style="color: #000000;">We use this to login as <strong>atanas</strong>, we then move into /root/ folder and find a file called flag.txt. When we open it we find that it was a dummy flag file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-lMX5lp7SvJY/WtsNw2NMPeI/AAAAAAAAWaI/4R_gVXXN1pEB3TMPspf9-Xt6e0t1Q3SagCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">In the root directory, we also find a log file; when we look at the content of the file, we discover that it contains logs that we created using wget. We also find that the <strong>wget version</strong> used is <strong>1.16</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-M-u_1EISqCM/WtsNxESOtHI/AAAAAAAAWaM/Tdf23VZbD1UEtcqBNTXhePab1V-atb1_wCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Searching on the Exploit-DB site we find that this version of wget was vulnerable to remote code execution.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-yYf30VYuuVI/WtsNxWozENI/AAAAAAAAWaU/Aq1LzNZa4-s7R7O8wPqTQ4BqFrEK7lR-QCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">We follow the instructions given on exploit-db.com about how to exploit this vulnerability.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-uV0muRFV5Uw/WtsNx55uRAI/AAAAAAAAWaQ/XHCfhGswfzcSFfyiaOaTm0q70_L2l7Q_gCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Then we had opened the wgetrc file through vim for changing the path of <strong>Post_file</strong> from /etc/shadow into <strong>/root/root.txt</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-2OwB0kCGx0w/WtsNyWa1lGI/AAAAAAAAWaY/oKz69KUgsqsCoivg-F6jtHNS15Duc17kQCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">We download the code of this exploit from exploit-db.com and upload it to the target machine through meterpreter.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-qIOGolnWLho/WtsNyqOS5bI/AAAAAAAAWac/oZZ6-xts2yscLOR75Km7xGy2J9Ufnie6ACEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">We then give read, write and execute permission to the file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6NNYaEr72KY/WtsNzOAOyxI/AAAAAAAAWak/pdBXZN5FYn8ujCfaEqTnWyoV3ueHkiiIQCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">Then , we then use <strong>authbind</strong> to run the file, as authbind allows a program to that would normally require super user privileges to access privileged network services to run as a non-privileged user.  As soon as we run the exploit we get the root flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-F-2wJtBUea0/WtsNzRXYWtI/AAAAAAAAWao/7ClOFVbQH3oeGwfRn-mK8eUYtSib583ewCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
