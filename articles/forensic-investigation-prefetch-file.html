<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/cyber-forensics-tricks/" rel="category tag">Cyber Forensics</a></span>            </div>
            <h1 class="post-title entry-title">Forensic Investigation : Prefetch File</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/forensic-investigation-prefetch-file/" rel="bookmark"><time class="entry-date published" datetime="2020-10-15T18:22:44+00:00">October 15, 2020</time><time class="updated" datetime="2025-05-17T19:24:25+00:00">May 17, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we are going to study an important artifact of Windows, i.e. prefetch files. Every time you do anything on your Windows system, a file is created. These files are called Prefetch files. Through this article, we will learn how these are important and why do we need them.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;">Introduction</span></li>
<li><span style="color: #000000;">Forensic Analysis of Prefetch Files</span>
<ul>
<li><span style="color: #000000;">WinPrefetch View</span></li>
<li><span style="color: #000000;">OS Forensic</span></li>
<li><span style="color: #000000;">PECmd</span></li>
<li><span style="color: #000000;">FTK Imager</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #800000;">Introduction</span></h3>
<p><span style="color: #000000;">A Prefetch file is a file that you create when you open an application on your Windows system. Windows creates a prefetch record when you run an application from a specific area for the absolute first time.</span></p>
<p><span style="color: #000000;">Windows introduced prefetch files in Windows XP. Developers designed prefetch files to accelerate the Windows boot process and applications’ start-up process. In Windows XP, Vista, and 7, the system limits the number of prefetch files to 128, whereas in Windows 8 and above, it allows up to 1024.</span></p>
<p><span style="color: #000000;">Program execution proof can significantly aid a forensic investigator, as they can demonstrate that a certain executable ran on the system to cover up the tracks. As a forensic examiner, check whether the prefetching process is enabled before you initiate the forensic analysis of the prefetch record.</span></p>
<p><span style="color: #000000;">To check the status of prefetching, open the following location in Registry editor:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management\PrefetchParameters</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-dJhrt_y_5zo/X4iRXgaXoUI/AAAAAAAApmk/Ki4l6D8TYl0QI2vSDh9sCAxvrg7yC3jMwCLcBGAsYHQ/s16000/0.png"/></strong></span></p>
<p><span style="color: #000000;">The system sets the value as 3 by default, as shown in the image above. You can change the following values according to your prefetching needs.</span></p>
<h4><span style="color: #000000;">Windows Prefetching Options</span></h4>
<p><span style="color: #000000;">We explain all the options that Windows provides to customize prefetching below:</span></p>
<ul>
<li><span style="color: #000000;">0:Prefetching Disabled</span></li>
<li><span style="color: #000000;">1:Application Prefetching Enabled</span></li>
<li><span style="color: #000000;">2: Boot Prefetching Enabled</span></li>
<li><span style="color: #000000;">3:Application and Boot both Enabled</span></li>
</ul>
<h4><span style="color: #000000;">Metadata Found in a Prefetch File</span></h4>
<p><span style="color: #000000;">The following metadata can be found in a single prefetch file:</span></p>
<ul>
<li><span style="color: #000000;">Executable’s name</span></li>
<li><span style="color: #000000;">Eight character hash of the executable path.</span></li>
<li><span style="color: #000000;">The path of the executable file</span></li>
<li><span style="color: #000000;">Creation, modified, and accessed timestamp of executable</span></li>
<li><span style="color: #000000;">Run count (Number of time the application has been executed)</span></li>
<li><span style="color: #000000;">Last run time</span></li>
<li><span style="color: #000000;">The timestamp for the last 8 run time (1 last run time and other 7 other last run times)</span></li>
<li><span style="color: #000000;">Volume information</span></li>
<li><span style="color: #000000;">File Referenced by the executable</span></li>
<li><span style="color: #000000;">Directories referenced by the executable</span></li>
</ul>
<p><span style="color: #000000;">Save the prefetch files under %SystemRoot%\Prefetch (C:\Windows\Prefetch).</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pF4xZ02nZI0/X4iRfCA4CJI/AAAAAAAApmo/mpE8UM846XQCAgfA96CZnG1lCy0etCtDACLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">You can open the prefetch files location you can directly search for “prefetch “in the run command.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-u_dAS02WcJs/X4iRkRgwHuI/AAAAAAAApms/06xUbd5rDpgh9dRVR3-CPWdlAN5TONLxACLcBGAsYHQ/s16000/2.png"/></strong></span></p>
<p><span style="color: #000000;">It can also be opened as a directory from the command prompt, which is a good news for all the command-line lovers.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3i0nViwi-nw/X4iRpr6MTtI/AAAAAAAApm0/VO4PLF3diFoZPuxctofEuH43qNj-st0EACLcBGAsYHQ/s16000/3.png"/></span></p>
<h3><span style="color: #800000;">Forensic Analysis of Prefetch Files</span></h3>
<h4><span style="color: #800000;">WinPrefetch View</span></h4>
<p><span style="color: #000000;">WinPrefetch View is a tool to read and examine the prefetch files stored in your system. The tool was developed by <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.nirsoft.net/">Nirsoft</a></strong></span>. This utility deals with any variant of Windows, beginning from Windows XP to Windows 10.</span></p>
<p><span style="color: #000000;">You can download the tool from <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.nirsoft.net/utils/win_prefetch_view.html">here</a></span></strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EhJI6RxegFY/X4iRvi-0uFI/AAAAAAAApm4/9sd-cd-6HWAEZGIZnOZfMTQDnN8JJlf8wCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">You can easily open the details of a particular prefetch file by simply clicking on it. Here, I have opened HFS.EXE-D3CAF0BF.pf for a detailed view. It shows details such as created time, modified time, file size, the path of process run count, last run time, missing process.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RoB_44Ogs_U/X4iR01_NjlI/AAAAAAAApm8/YA8lCmUF5zEmH_YHypuZn3AHatA5wJ42ACLcBGAsYHQ/s16000/5.png"/></span></p>
<h3><span style="color: #800000;">OS Forensics</span></h3>
<p><span style="color: #000000;">OS Forensic is a digital forensic tool, a complete package for forensic investigation by Passmark software. Users extract, analyze data, search files, recover deleted passwords, and recover deleted evidence, much more.</span></p>
<p><span style="color: #000000;">Download the tool from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.osforensics.com/download.html">here</a></strong></span>.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-_LGZXqI67YI/X4iR5zbJuWI/AAAAAAAApnE/WX_Tez0GkTQAVa-qOQIPAVHTl8TlE1iJQCLcBGAsYHQ/s16000/6.png"/></strong></span></p>
<h3><span style="color: #800000;">Prefetch Explorer Command Line (PECmd)</span></h3>
<p><span style="color: #000000;">PECmd is a command-line tool by Eric Zimmerman, used for bulk analysis of prefetch files.This tool can also export your prefetch artifacts to <strong>.csv</strong> and <strong>.css</strong>.</span></p>
<p><span style="color: #000000;">You can download the tool from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://ericzimmerman.github.io/#!index.md">here</a></strong></span>.</span></p>
<p><span style="color: #000000;">To begin with run the executable file. Let’s parse the prefetch file using this tool we will use the –d parameter to parse all the prefetch file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">PECmd.exe –d "C:\Windows\Prefetch"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4i2M8IlKp9o/X4iR_ZGJclI/AAAAAAAApnM/XfOLB9nkhe4_tIqhJZsKAjMeOqKdwQw_QCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">In the image below, the prefetch file for firefox.exe is visible. The tool has parsed all the metadata as the introduction explains.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-zLPYfRNI_14/X4iSEJmHjPI/AAAAAAAApnQ/PIRP1mOGHBgCY_01sqHNeuSK7M2tpgrDQCLcBGAsYHQ/s16000/8.png"/></strong></span></p>
<p><span style="color: #000000;">Similarly, through the following image, you can observe the prefetch file for </span><span style="color: #000000;">HFS.exe. Such files will be created for every application you access.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KvHkoRtNvCw/X4iSKTG4rRI/AAAAAAAApnY/U376-McZUYUHP3aoWkoz_RzYnOqFCxuRQCLcBGAsYHQ/s16000/9.png"/></span></p>
<h3><span style="color: #800000;">FTK Imager</span></h3>
<p><span style="color: #000000;">As a Forensic Investigator, you can always access the prefetch files to understand the case given to you. Because through these files, you can determine what users frequently used on the system that you are investigating. You can easily do this with FTK Imager. FTK imager allows one to view and analyze the prefetch file present in the drive. To access the prefetch file through FTK, just open the said tool and look for the <strong>Prefetch</strong> folder in the left panel as highlighted in the image below:</span></p>
<p><span style="color: #000000;">This is all on prefetch files. Now that we understand these files properly, we can customize it, access it, and use it as we need. The most important thing to know about prefetch files is that they are a boon for retracing malware as they log any .exe file that runs on the system. Therefore, if someone executes a malicious file, you can track it through this.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SN_-3jSYhlY/X4iSPFd-3MI/AAAAAAAApnc/tVgppW4HMkg7p9iUFmxWmpWqwG2V2Z6rgCLcBGAsYHQ/s16000/10.png"/></span></p>
<p>To learn more about Cyber Forensics. Follow this <strong><a href="https://www.hackingarticles.in/category/cyber-forensics-tricks/">Link</a></strong></p>
<p><span style="color: #000000;"><strong>Author: </strong>Vishva Vaghela is a Digital Forensics enthusiast and enjoys technical content writing. You can reach her on<strong><a style="color: #000000;" href="https://www.linkedin.com/in/vishva-vaghela-979446191/"> <span style="color: #0000ff;">Here</span></a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
