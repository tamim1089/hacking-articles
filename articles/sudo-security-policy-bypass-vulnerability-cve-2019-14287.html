<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">SUDO Security Policy Bypass Vulnerability – CVE-2019-14287</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/sudo-security-policy-bypass-vulnerability-cve-2019-14287/" rel="bookmark"><time class="entry-date published" datetime="2019-11-25T08:42:45+00:00">November 25, 2019</time><time class="updated" datetime="2025-06-07T10:38:57+00:00">June 7, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">After the detection of a major security vulnerability, Official released an immediate security fix to the ‘ sudo ‘ kit in the Ubuntu repositories. If you are not aware of sudo right’s power then read this post “<a style="color: #000000;" href="https://www.hackingarticles.in/linux-privilege-escalation-using-exploiting-sudo-rights/"><strong>Linux Privilege Escalation using Sudo Rights</strong></a>” that help you to understand more above “CVE-2019-14287” the latest vulnerability which we will discuss in this post.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;">In sudo before 1.8.28, the vulnerability CVE-2019-14287 is a security policy bypass issue in Linux/Ubuntu before 19.10 that offers a local user or a program the ability to carry out commands as root or superuser on a Linux system when the “sudoers configuration” clearly prohibits the root access.</span></p>
<p class="ai-optimize-8"><span style="color: #000000;">For example, this allows the bypass of “! Root” configuration, and USER= logging, for a “sudo -u \#$((0xffffffff))” command.</span></p>
<h3 class="ai-optimize-9"><span style="color: #800000;">Exploiting CVE-2019-14287</span></h3>
<p class="ai-optimize-10"><span style="color: #000000;">Victim’s Machine</span></p>
<p class="ai-optimize-11"><span style="color: #000000;">Let’s suppose the system admin has created a local user who is not allowed to perform high-privilege tasks such as “cat /etc/shadow” to read the saved password of the system.</span></p>
<p class="ai-optimize-12"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-38NbIKN4EsE/XduSeoFjjXI/AAAAAAAAhmw/tLyopn9kOiIcq3TG-oIYLyWk5xFBMgBYQCLcBGAsYHQ/s1600/1.png"/></span></p>
<p class="ai-optimize-13"><span style="color: #000000;">Similarly, we have created a user “demo” who is not able to run privileged tasks as a superuser.</span></p>
<p class="ai-optimize-14"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DPmPJMafbUI/XduSeg8-b_I/AAAAAAAAhms/3j47zmJbSIgXJHj_llIURoGa0cWsAy2_QCLcBGAsYHQ/s1600/2.png"/></span></p>
<p class="ai-optimize-15"><span style="color: #000000;">But if the admin makes the following configuration with the sudoers file:</span></p>
<p class="ai-optimize-16"><span style="color: #000000;">where admin has to assign sudo rights to the user “demo” to run programs or command as superuser other than root and clearly prohibits the root access using !root.</span></p>
<p class="ai-optimize-17"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UIje8ha_qlA/XduSfzmOPXI/AAAAAAAAhm4/YyejC3Y-NS4B18XFEjtyMBRe197I6CH6gCLcBGAsYHQ/s1600/3.png"/></span></p>
<p class="ai-optimize-18"><span style="color: #000000;">Or the system admin can use the following configuration too which stats the same permission as said above.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">demo ALL=(ALL,!#0) ALL</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-8cpVTWH1HgE/XduSf8F2UcI/AAAAAAAAhm8/tJuoN4fOFdkRflOgfqjv5wxSizRASXCXwCLcBGAsYHQ/s1600/4.1.png"/></p>
<p class="ai-optimize-19"><span style="color: #000000;">Let us understand once again what sudo is and what it defines as configured above by taking help of the following image:</span></p>
<h5 class="ai-optimize-20"><strong><span style="color: #000000;">Username: demo</span></strong></h5>
<p class="ai-optimize-21"><span style="color: #000000;">Host: ALL</span></p>
<p class="ai-optimize-22"><span style="color: #000000;">Runas (user): ALL,!root</span></p>
<p class="ai-optimize-23"><span style="color: #000000;">Runas(group): ALL,!root</span></p>
<p class="ai-optimize-24"><span style="color: #000000;">Tag: NOPASSWD</span></p>
<p class="ai-optimize-25"><span style="color: #000000;">Command to execute: ALL</span></p>
<p class="ai-optimize-26"><span style="color: #000000;">So basically, here the demo is defined to execute ALL commands. As ALL (User, Group) other than root (User, Group), and “ALL,!root” is a misconfiguration and causes security loopholes. Because the user demo is restricted to performing the task as root, but not as an admin. As a result, he can run a command as an administrator (user “root”).  </span></p>
<p class="ai-optimize-27"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6JwwhLiEYx4/XduSe-nl9OI/AAAAAAAAhm0/Zf9TC1YZK8Qu_YJ4KhA2QUCimMZu8FKrQCLcBGAsYHQ/s1600/3.1.png"/></span></p>
<p class="ai-optimize-28"><span style="color: #000000;">In other words, this fault gives the privilege of a local user (attacker) accessing the root shell as demonstrated. Assume the attacker has the host machine shell as a local user and he found the above-mentioned sudo rights. Then, the attacker can easily escalate the root privilege by using the privilege user’s ID i.e., u#-1</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -u#-1 /bin/bash</pre>
<p class="ai-optimize-29"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dSnUPzjTydM/XduSgXWJmyI/AAAAAAAAhnA/0gmm1UCOsy87qFkYkQGUjhuoUDuB5XueQCLcBGAsYHQ/s1600/4.png"/></span></p>
<p class="ai-optimize-30"><span style="color: #000000;"><strong>Author</strong>: Komal Singh is a Cyber Security Researcher and Technical Content Writer. She is a completely enthusiastic pentester and Security Analyst at Ignite Technologies. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/komal-rajput-26b783131/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
