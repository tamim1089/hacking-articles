<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Beginners Guide to TShark (Part 2)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/beginners-guide-to-tshark-part-2/" rel="bookmark"><time class="entry-date published" datetime="2020-02-19T16:11:19+00:00">February 19, 2020</time><time class="updated" datetime="2025-06-06T09:11:13+00:00">June 6, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In the previous article, we learned about the basic functionalities of this wonderful tool called TShark. If you haven’t read it until now. Click <a style="color: #000000;" href="https://www.hackingarticles.in/beginners-guide-to-tshark-part-1/">here</a>.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;"><strong>TL; DR</strong></span></p>
<p class="ai-optimize-8"><span style="color: #000000;">In this part, we will the Statistical Functionalities of TShark. We will understand different ways in which we can sort our traffic capture so that we can analyse it faster and effectively.</span></p>
<h3 class="ai-optimize-9"><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li class="ai-optimize-10"><span style="color: #000000;"><strong>Statistical Options</strong></span></li>
<li class="ai-optimize-11"><span style="color: #000000;"><strong>Protocol Hierarchy Statistics</strong></span></li>
<li class="ai-optimize-12"><span style="color: #000000;"><strong>Read Filter Analysis</strong></span></li>
<li class="ai-optimize-13"><span style="color: #000000;"><strong>Endpoints Analysis</strong></span></li>
<li class="ai-optimize-14"><span style="color: #000000;"><strong>Conversation Analysis</strong></span></li>
<li class="ai-optimize-15"><span style="color: #000000;"><strong>Expert Mode Analysis</strong></span></li>
<li class="ai-optimize-16"><span style="color: #000000;"><strong>Packet Distribution Tree</strong></span></li>
<li class="ai-optimize-17"><span style="color: #000000;"><strong>Packet Length Tree</strong></span></li>
<li class="ai-optimize-18"><span style="color: #000000;"><strong>Color Based Output Analysis</strong></span></li>
<li class="ai-optimize-19"><span style="color: #000000;"><strong>Ring Buffer Analysis</strong></span></li>
<li class="ai-optimize-20"><span style="color: #000000;"><strong>Auto-Stop</strong></span>
<ul>
<li class="ai-optimize-21"><span style="color: #000000;">Duration</span></li>
<li class="ai-optimize-22"><span style="color: #000000;">File Size</span></li>
</ul>
</li>
<li class="ai-optimize-23"><span style="color: #000000;"><strong>Data-Link Types</strong></span></li>
</ul>
<h3 class="ai-optimize-24"><span style="color: #000000;"><span style="color: #800000;">Statistical Options</span> </span></h3>
<p class="ai-optimize-25"><span style="color: #000000;">TShark collects different types of Statistics and displays their result after finishing the reading of the captured file. To accomplish this, we will be using the “-z” parameter with TShark. Initially, to learn about all the different options inside the “-z” parameter, we will be running the TShark with the “-z” parameter followed by the help keyword. This gives us an exhaustive list of various supported formats as shown in the image given below.</span></p>
<p class="ai-optimize-26"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LPtOowJsWvA/Xk1bmYg5qtI/AAAAAAAAixw/FZj4DEpwSBw1b8XZSU0m0zrdSFq_o1IDQCLcBGAsYHQ/s1600/1.png"/></span></p>
<h3 class="ai-optimize-27"><span style="color: #800000;">Protocol Hierarchy Statistics</span></h3>
<p class="ai-optimize-28"><span style="color: #000000;">Using the TShark we can create a Protocol based Hierarchy Statistics listing the number of packets and bytes using the “io,phs” option in the “-z” parameter. In the case where no filter is given after the “io,phs” option, the statistics will be calculated for all the packets in the scope. But if a specific filter is provided than the TShark will calculate statistics for those packets that match the filter provided by the user. For our demonstration, we first captured some traffic and wrote the contents on a pcap file using the techniques that we learned in part 1 of this article series. Then we will be taking the traffic from the file, and then sort the data into a Protocol Hierarchy.  Here we can observe that we have the frames count, size of packets in bytes and the Protocol used for the transmission.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tshark  -r wlan.pcap -z io,phs</pre>
<p class="ai-optimize-29"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QtdHH6RK9OY/Xk1bn7E-nnI/AAAAAAAAiyE/rSz67caRGN8oeghBxkoXOL_mPM346EWJQCLcBGAsYHQ/s1600/2.png"/></span></p>
<h3 class="ai-optimize-30"><span style="color: #800000;">Read Filter Analysis</span></h3>
<p class="ai-optimize-31"><span style="color: #000000;">During the first pass analysis of the packet, you must apply the specified filter (which uses the syntax of read/display filters, rather than that of capture filters). The analysis does not consider packets that do not match the filter for future passes. This parameter makes sense with multiple passes. Note that you cannot use forward-looking fields such as ‘response in frame ‘ with this filter since you will not have calculated them when you apply this filter. The “-2” parameter performs a two-pass analysis. This causes TShark to buffer output until the entire first pass is done, but allows it to fill in fields that require future knowledge; it also permits you to calculate reassembly frame dependencies correctly. Here we can see two different analysis one of them is first-pass analysis and the latter is the two-pass analysis.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tshark -r wlan.pcap -z io,phs,udp -q
tshark -r wlan.pcap -z io,phs -q -2 -R udp</pre>
<p class="ai-optimize-32"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Eu18hm9vXfQ/Xk1boDQcwAI/AAAAAAAAiyM/tqgaDzig4V4AOHiy--_Eljs9hAlxlfZAACLcBGAsYHQ/s1600/3.png"/></span></p>
<h3 class="ai-optimize-33"><span style="color: #800000;">Endpoints Analysis</span></h3>
<p class="ai-optimize-34"><span style="color: #000000;">Our next option which helps us with the statistics is the “endpoints”. It will create a table that will list all endpoints that could be seen in the capture. The type function which can be used with the endpoint option will specify the endpoint type for which we want to generate the statistics.</span></p>
<p class="ai-optimize-35"><span style="color: #000000;">The list of Endpoints that are supported by TShark is:</span></p>
<table>
<tbody>
<tr>
<td width="47"><span style="color: #000000;"><strong>Sno.</strong></span></td>
<td width="123"><span style="color: #000000;"><strong>Filter</strong></span></td>
<td width="246"><span style="color: #000000;"><strong>Description</strong></span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">1</span></td>
<td width="123"><span style="color: #000000;"><strong>“bluetooth”</strong></span></td>
<td width="246"><span style="color: #000000;">Bluetooth Addresses</span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">2</span></td>
<td width="123"><span style="color: #000000;"><strong>“eth”</strong></span></td>
<td width="246"><span style="color: #000000;">Ethernet Addresses</span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">3</span></td>
<td width="123"><span style="color: #000000;"><strong>“fc”</strong></span></td>
<td width="246"><span style="color: #000000;">Fiber Channel Addresses</span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">4</span></td>
<td width="123"><span style="color: #000000;"><strong>“fddi”</strong></span></td>
<td width="246"><span style="color: #000000;">FDDI Addresses</span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">5</span></td>
<td width="123"><span style="color: #000000;"><strong>“ip”</strong></span></td>
<td width="246"><span style="color: #000000;">IPv4 Addresses</span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">6</span></td>
<td width="123"><span style="color: #000000;"><strong>“ipv6”</strong></span></td>
<td width="246"><span style="color: #000000;">IPv6 Addresses</span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">7</span></td>
<td width="123"><span style="color: #000000;"><strong>“ipx”</strong></span></td>
<td width="246"><span style="color: #000000;">IPX Addresses</span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">8</span></td>
<td width="123"><span style="color: #000000;"><strong>“jxta”</strong></span></td>
<td width="246"><span style="color: #000000;">JXTS Addresses</span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">9</span></td>
<td width="123"><span style="color: #000000;"><strong>“ncp”</strong></span></td>
<td width="246"><span style="color: #000000;">NCP Addresses</span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">10</span></td>
<td width="123"><span style="color: #000000;"><strong>“rsvp”</strong></span></td>
<td width="246"><span style="color: #000000;">RSVP Addresses</span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">11</span></td>
<td width="123"><span style="color: #000000;"><strong>“sctp”</strong></span></td>
<td width="246"><span style="color: #000000;">SCTP Addresses</span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">12</span></td>
<td width="123"><span style="color: #000000;"><strong>“tcp”</strong></span></td>
<td width="246"><span style="color: #000000;">TCP/IP socket pairs Both IPv4 and IPv6 supported</span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">13</span></td>
<td width="123"><span style="color: #000000;"><strong>“tr”</strong></span></td>
<td width="246"><span style="color: #000000;">Token Ring Addresses</span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">14</span></td>
<td width="123"><span style="color: #000000;"><strong>“usb”</strong></span></td>
<td width="246"><span style="color: #000000;">USB Addresses</span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">15</span></td>
<td width="123"><span style="color: #000000;"><strong>“udp”</strong></span></td>
<td width="246"><span style="color: #000000;">UDP/IP socket pairs Both IPv4 and IPv6 supported</span></td>
</tr>
<tr>
<td width="47"><span style="color: #000000;">16</span></td>
<td width="123"><span style="color: #000000;"><strong>“wlan”</strong></span></td>
<td width="246"><span style="color: #000000;">IEEE 802.11 addresses</span></td>
</tr>
</tbody>
</table>
<p class="ai-optimize-36"><span style="color: #000000;">In case that we have specified the filter option then we perform the statistics calculations for that particular specified filter. The system generates a table like the one shown in the image below by picking up a single line from each conversation and displays it against the number of packets per byte in each direction as well as the total number of packets per byte. This table defaults to sorting according to the total number of frames.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tshark -r wlan.pcap -z endpoints,wlan -q | head</pre>
<p class="ai-optimize-37"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0pezSZwNkwM/Xk1boGacrOI/AAAAAAAAiyI/pvJ66wSA_lwftfvkyaBzw6HklcczR96ZgCLcBGAsYHQ/s1600/4.png"/></span></p>
<h3 class="ai-optimize-38"><span style="color: #800000;">Conversation Analysis</span></h3>
<p class="ai-optimize-39"><span style="color: #000000;">Let’s move on to the next option which is quite similar to the previous option. It helps us with the statistics is the “conversation”. It will create a table that will list all conversation that could be seen in the capture. The type function which can be used with the conversation option will specify the conversation type for which we want to generate the statistics.</span></p>
<p class="ai-optimize-40"><span style="color: #000000;">If we have specified the filter option then the statistics calculations are done for that particular specified filter. The table generated by picking up single line form each conversation and displayed against the number of packets per byte in each direction, the total number of packets per byte as well as the direction of the conversation travel. This table is by default sorted according to the total number of frames.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tshark -r wlan.pcap -z conv,wlan -q | head</pre>
<p class="ai-optimize-41"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Qoebslv7JVo/Xk1bof--LpI/AAAAAAAAiyQ/1XDzrhj0Im8Hz8q45NKP18Umru-MDC8SQCLcBGAsYHQ/s1600/5.png"/></span></p>
<h3 class="ai-optimize-42"><span style="color: #800000;">Expert Mode Analysis</span></h3>
<p class="ai-optimize-43"><span style="color: #000000;">The TShark Statistics Module have an Expert Mode. It collects a huge amount of data based on Expert Info and then prints this information in a specific order. All this data is grouped in the sets of severity like Errors, Warnings, etc., We can use the expert mode with a particular protocol as well. In that case, it will display all the expert items of that particular protocol.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tshark -r wlan.pcap -z expert -q | head</pre>
<p class="ai-optimize-44"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-31RoEBs4znw/Xk1bpMOMwNI/AAAAAAAAiyU/QbBJPUYMj20oWgGM4cwrSfo2WiQZoEe2wCLcBGAsYHQ/s1600/6.png"/></span></p>
<h3 class="ai-optimize-45"><span style="color: #800000;">Packet Distribution Tree</span></h3>
<p class="ai-optimize-46"><span style="color: #000000;">In this option, we take the traffic form a packet and then drive it through the “http,tree” option under the “-z” parameter to count the number of the HTTP requests, their mods as well as the status code. This is a rather modular approach that is very easy to understand and analyse. Here in our case, we took the packet that we captured earlier and then drove it through the tree option, which provided us with the information that we generated a total of 126 requests, out of which 14 returned the “200 OK.” This means that the rest either returned an error or were redirected to another server, which returned a 3XX series status code.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tshark -r wlan.pcap -z http,tree -q</pre>
<p class="ai-optimize-47"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GDFdA1RroEI/Xk1bpU5nyHI/AAAAAAAAiyY/DTS2v-z7wVYQk4F2L3BMdltGLlw_E01QACLcBGAsYHQ/s1600/7.png"/></span></p>
<h3 class="ai-optimize-48"><span style="color: #800000;">Packet Length Tree</span></h3>
<p class="ai-optimize-49"><span style="color: #000000;">As long as we are talking about the Tree option, let’s explore it a bit. We have a large variety of ways in which we can use the tree option in combination with other option. To demonstrate that, we decided to use the packet length option with the tree option. This will sort the data on the basis of the size of the packets and then generate a table with it. Now, this table will not only consist of the length of the packets, but it will also have the count of the packet. The minimum value of the length in the range of the size of the packets. It will also calculate the size as well as the Percentage of the packets inside the range of packet length</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tshark -r wlan.pcap -z plen,tree -q</pre>
<p class="ai-optimize-50"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lnoEJNt1Wh4/Xk1bphIQS3I/AAAAAAAAiyc/7whgsA6VM-MJ-gG0BoqSKjj1wCwSIBH4QCLcBGAsYHQ/s1600/8.png"/></span></p>
<h3 class="ai-optimize-51"><span style="color: #800000;">Color Based Output Analysis</span></h3>
<p class="ai-optimize-52"><span style="color: #000000;">Note: Your terminal must support color output in order for this option to work correctly.</span></p>
<p class="ai-optimize-53"><span style="color: #000000;">We can enable the coloring of packets according to standard Wireshark color filters. On Windows, colors are limited to the standard console character attribute colors. In this option, we can set up the colors according to the display filter. This helps in quickly locating a specific packet in the bunch of similar packets. It also helps in locating Handshakes in communication traffic. This can be enabled using the following command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tshark -r color.pcap --color</pre>
<p class="ai-optimize-54"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bllvZUTX-t4/Xk1bp6vZ9kI/AAAAAAAAiyg/ZTUHlXv5QVIEpGjd-Yb_xv1XV-gjb2ghwCLcBGAsYHQ/s1600/9.png"/></span></p>
<h3 class="ai-optimize-55"><span style="color: #800000;">Ring Buffer Analysis</span></h3>
<p class="ai-optimize-56"><span style="color: #000000;">By default, the TShark to runs in the “multiple files” mode. In this mode, the TShark writes into several capture files. When the first capture file fills up to a certain capacity, the TShark switches to the next file and so on. We can state the file names that we want to create using the -w parameter. The system will concatenate the number of files, creation data, and creation time with the name provided next to the -w parameter to form the complete name of the file.</span></p>
<p class="ai-optimize-57"><span style="color: #000000;">The files option will fill up new files until the number of files is specified. at that moment the TShark will discard data in the first file and start writing to that file and so on. If the files option is not set, new files filled up until one of the captures stops conditions matches or until the disk is full.</span></p>
<p class="ai-optimize-58"><span style="color: #000000;">There are a lot of criteria upon which the ring buffer works but, in our demonstration, we used 2 of them. Files and the Filesize.</span></p>
<p class="ai-optimize-59"><span style="color: #000000;">files: value begin again with the first file after value number of files were written (form a ring buffer). This value must be less than 100000.</span></p>
<p class="ai-optimize-60"><span style="color: #000000;">filesize: value switches to the next file after it reaches a size of value kB. Note that the file size is limited to a maximum value of 2 GiB.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tshark -I eth0 -w packetsbuffer.pcap -b filesize:1 -b file:3</pre>
<p class="ai-optimize-61"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-R_x1mhD3mRE/Xk1bmfnVRGI/AAAAAAAAix0/F_mGX2YlRjcJi033WqLHmH8dAlHlNSfFwCLcBGAsYHQ/s1600/10.png"/></span></p>
<h3 class="ai-optimize-62"><span style="color: #800000;">Auto-Stop</span></h3>
<p class="ai-optimize-63"><span style="color: #000000;">Under the huge array of the options, we have one option called auto-stop. As the name tells us that it will stop the traffic capture after the criteria are matched.</span></p>
<p class="ai-optimize-64"><span style="color: #000000;"><strong>Duration</strong></span></p>
<p class="ai-optimize-65"><span style="color: #000000;">We have a couple of options, in our demonstration, we used the duration criteria. We specified the duration to 10. This value is in seconds. So, the capture tells us that in the time of 10 seconds, we captured 9 packets.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tshark -i eth0 -a duration:10</pre>
<p class="ai-optimize-66"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PDmtD0OojGg/Xk1bmbFAS0I/AAAAAAAAix4/N0kg_DdZhng9zKKtgkphBQX4rNVx69XCgCLcBGAsYHQ/s1600/11.png"/></span></p>
<p class="ai-optimize-67"><span style="color: #000000;"><strong>File Size</strong></span></p>
<p class="ai-optimize-68"><span style="color: #000000;">Now another criterion for the auto-stop option is the file size. The TShark will stop writing to the specified capture file after it reaches a size provided by the user. In our demonstration, we set the filesize to 1. This value is in kB. We used the directory listing command to show that the capture was terminated as soon as the file reached the size of 1 kB.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tshark -i eth0 -w 1.pcap -a filesize:1</pre>
<p class="ai-optimize-69"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3UUJznDtgzo/Xk1bnFbNVcI/AAAAAAAAix8/eUJKASYAfc0db0ioY5TWLugHCUrkA0EuACLcBGAsYHQ/s1600/12.png"/></span></p>
<h3 class="ai-optimize-70"><span style="color: #800000;">Data-Link Types</span></h3>
<p class="ai-optimize-71"><span style="color: #000000;">At last, we can also modify the statistics of the captured traffic data based on the Data-Link Types. For that we will have to use an independent parameter, “-L”. In our demonstration, we used the “-L” parameter to show that we have data links like EN10MB specified for the Ethernet Traffic and others.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tshark -L</pre>
<p class="ai-optimize-72"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sauvkplLp_0/Xk1bnrFQNaI/AAAAAAAAiyA/Txnupf8cbCc9dz6l9B9hS9QtVq18WzBmACLcBGAsYHQ/s1600/13.png"/></span></p>
<p class="ai-optimize-55"><span style="color: #000000;">To learn more about Penteration Testing. Follow this</span> <a href="https://www.hackingarticles.in/category/penetration-testing/">Link.</a></p>
<p class="ai-optimize-73"><span style="color: #000000;"><strong>Author: </strong>Shubham Sharma is a Pentester, Cybersecurity Researcher and Enthusiast, contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/shubham-sharma-626964153/">here</a></strong>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
