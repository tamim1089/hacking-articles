<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Security Onion Configuration in VMware</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/security-onion-configuration-in-vmware/" rel="bookmark"><time class="entry-date published updated" datetime="2017-12-08T15:29:02+00:00">December 8, 2017</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Security Onion is a Linux distro for intrusion detection, network security monitoring, and log management. It’s based on Ubuntu and contains Snort, Suricata, Bro, OSSEC, Sguil, Squert, ELSA, Xplico, NetworkMiner, and many other security tools. The easy-to-use Setup wizard allows you to build an army of distributed sensors for your enterprise in minutes!</span></p>
<p><span style="color: #000000;">Security Onion effortlessly merges collectively two main roles i.e. complete packet capture another Network-based [NIDS] and host-based intrusion detection systems [HIDS].</span></p>
<p><span style="color: #000000;">There is some Analysis tool are available that also work as a real-time program by capturing network packets.</span></p>
<p><span style="color: #000000;"><strong>NIDS:</strong> Snort or Suricata and Bro as network intrusion detection for fingerprints and identifiers that contest identified malicious, abnormal otherwise suspicious traffic.</span></p>
<p><span style="color: #000000;"><strong>HIDS: </strong> Security Onion offers OSSEC for host-based intrusion detection.</span></p>
<p><span style="color: #000000;"><strong>Sguil:</strong> It is the crucial Security Onion tool for network security analysts. Sguil’s main component is an intuitive GUI that gives access to real-time events, session data, and raw packet captures.</span></p>
<p><span style="color: #000000;"><strong>Squert:</strong> It is a web application that is used to query and view event data stored in a Sguil database.</span></p>
<p><span style="color: #000000;"><strong>ELSA:</strong> Enterprise Log Search and Archive is a three-tier log receiver, archiver, indexer, and web frontend for incoming syslog. </span></p>
<p><span style="color: #000000;">For more details visit <a style="color: #000000;" href="https://github.com/Security-Onion-Solutions/security-onion/wiki/VMWare-Walkthrough"><strong>here</strong></a></span></p>
<p><span style="color: #000000;"><strong>Let’s start!!</strong></span></p>
<p><span style="color: #000000;"><strong>Create VM for Security Onion installation</strong></span></p>
<p><span style="color: #000000;">Open VMware, select option “creates new virtual machine”, now for install from wizard select second option:</span></p>
<p><span style="color: #000000;"><strong>Install the disc image file in</strong> order to browse the iso file of security onion.</span></p>
<p><span style="color: #000000;">Then click on next.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-eGwpDfLfNNQ/WiqjKnAAj8I/AAAAAAAASno/6zHF8EPErkEeRWT7jkVXN8r4DaVUXngFACEwYBhgL/s1600/1.PNG"/></span></p>
<p><span style="color: #000000;">Now select 2nd option “<strong>Linux</strong>” for the guest operating system and select version “<strong>Ubuntu</strong>”. Then click on next and next as per your requirements.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-1gxB801hLC0/WiqjN5RPhbI/AAAAAAAASno/8brobZq8I2oInKqhJBpRe24klS7E99brQCEwYBhgL/s1600/2.PNG"/></span></p>
<p><span style="color: #000000;">Explore custom hardware for making the following changes:</span></p>
<p><span style="color: #000000;">Select <strong>bridges connection</strong> and enable the checkbox for replicate connection for network adapter setting. Similarly, add one more network adapter and also select <strong>bridges connection</strong> for the 2<sup>nd</sup> adapter</span></p>
<p><span style="color: #000000;">Then click on <strong>finish</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-na9To1s_o1k/WiqjVAA9oLI/AAAAAAAASno/hNl5T_b4Blwd1m4cg9xF_wPot-XisQeOgCEwYBhgL/s1600/5.PNG"/></span></p>
<p><span style="color: #000000;"><strong>Installation </strong></span></p>
<p><span style="color: #000000;">It will start booting the VM automatically, now for SECURITY ONION</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-uzrQ-r_dBZ0/WiqjVqqYlnI/AAAAAAAASno/1P5Er0sJv8Y32dKwfssnyUnQFo6V-ndvgCEwYBhgL/s1600/6.PNG"/></span></p>
<p><span style="color: #000000;">At welcome screen; Select language and click “Continue”. Here we have chosen English as the preferred language.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-_FTDIOslL9Q/WiqjV6xgFZI/AAAAAAAASno/gPxRlgEC0AwLep21szJp42-t2Zd5pDa8ACEwYBhgL/s1600/7.PNG"/></span></p>
<p><span style="color: #000000;">Read the content and then click on “Continue”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Qb7vJxhaZZo/WiqjWaOQh1I/AAAAAAAASno/8c6fvmog2w4XjbtEZUxBNhFGcvu5rf93gCEwYBhgL/s1600/8.PNG"/></span></p>
<p><span style="color: #000000;">Choose the radio button for “Erase the disk and install Security Onion” to begin installation and click “Install Now”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-8ljePkoo63o/WiqjWuaZxUI/AAAAAAAASno/ag2FnQwa-AArkt-JCwAknULnhyR7iqR8ACEwYBhgL/s1600/9.PNG"/></span></p>
<p><span style="color: #000000;">Click on “Continue” then it will proceed for disk partitions.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-U2zMdYFkTuk/WiqjK97ZmWI/AAAAAAAASno/HWjl2qZyZfsBeOIBt5GccgDXfE-ISZP6wCEwYBhgL/s1600/10.PNG"/></span></p>
<p><span style="color: #000000;">Check your location, without holdup, select your time zone and then click on “Continue”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-kd867YKYz6U/WiqjKzFW2mI/AAAAAAAASno/y2xQXtZ-i2Q9YCZ6pVa2SL7ohcv3NW1AQCEwYBhgL/s1600/12.PNG"/></span></p>
<p><span style="color: #000000;">Choose keyboard layout “English (US)” and then click on “Continue”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-RyswXrXgzkM/WiqjLi7O4kI/AAAAAAAASno/79f9QrY6GNoZ-dPAiIJrHOjqlG4NEzawQCEwYBhgL/s1600/13.PNG"/></span></p>
<p><span style="color: #000000;">Now create your profile by giving your detail as given below:</span></p>
<ul>
<li><span style="color: #000000;"><strong>Enter your name:</strong> Ignite</span></li>
<li><span style="color: #000000;"><strong>Enter your computer’s name:</strong> Ignite-pc</span></li>
<li><span style="color: #000000;"><strong>Select a username:</strong> Ignite</span></li>
<li><span style="color: #000000;"><strong>Enter a password:</strong> 1234</span></li>
</ul>
<p><span style="color: #000000;">Click “Continue”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-KK3GqpSbo5c/WiqjL1k80eI/AAAAAAAASno/UU6peYYpReogS76S6CyvSvNJB69KU4R9wCEwYBhgL/s1600/14.PNG"/></span></p>
<p><span style="color: #000000;">Now it may take some time in installation, but after that when installation is complete. Click “Restart Now” for a new installation.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-hjbRdBeL1Qg/WiqjMFE0ETI/AAAAAAAASno/U1iPgLH-SQYhMaXrLo8PPKGGYIR9hdeewCEwYBhgL/s1600/15.PNG"/></span></p>
<p><span style="color: #000000;"><strong>Security onion configuration 1<sup>st</sup> part </strong></span></p>
<p><span style="color: #000000;">In order to configure security onion as a real-time system for NIDS and HIDS, we have divided configuration setting into two parts.</span></p>
<p><span style="color: #000000;">Now enter your username and password for login as shown in given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-KIRDsS4lR-E/WiqjMaq2ENI/AAAAAAAASno/kvRnOZYFjn462VERYZWh6ASvv7S8PUTIQCEwYBhgL/s1600/16.PNG"/></span></p>
<p><span style="color: #000000;">At Desktop screen you have can see setup icon; <strong>click</strong> on “<strong>setup</strong>” icon for configuration of the network interface.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5FMftzJDLUE/WiqjM2hrMBI/AAAAAAAASno/8ixaGu5PDE8NQS5jQXPCttwXwKnXTpfCwCEwYBhgL/s1600/17.1.png"/></span></p>
<p><span style="color: #000000;"><strong>Configure 1st network adapter for the management interface</strong></span></p>
<p><span style="color: #000000;">Click on “setup” icon present at the desktop to configure security onion on your system.</span></p>
<p><span style="color: #000000;">Click “Yes, Continue”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-7d8iv6bx_dk/WiqjM81R_yI/AAAAAAAASno/A5qJy0UIbSAWA6WWppOGOaIAlXa5iwpgwCEwYBhgL/s1600/17.PNG"/></span></p>
<p><span style="color: #000000;">Click “Yes” to configure /etc/network/interface now as shown in given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-6siDXhquMz0/WiqjNuskE3I/AAAAAAAASno/Vxk_l0GDq7IQrhKnkhJzvoYCMD2YrD1ygCEwYBhgL/s1600/18.PNG"/></span></p>
<p><span style="color: #000000;">Choose <strong>eth0</strong> as network interface should be the management interface as shown in given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-MPHR5-220GM/WiqjNqNINXI/AAAAAAAASno/uyHT62B75sE3BcUTMRszQmeUaYyZHjrbQCEwYBhgL/s1600/19.PNG"/></span></p>
<p><span style="color: #000000;">Choose Static addressing for eth0 utilization as shown in given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-oH9-Fq_AOrg/WiqjOjbFGrI/AAAAAAAASno/q_oGgpBwbgU-qCc1LiOiJS4EPk2X2r_uwCEwYBhgL/s1600/20.PNG"/></span></p>
<p><span style="color: #000000;">Enter a static IP for your management interface as shown in the given image.</span></p>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-oHzQjYg1FbA/WiqjO6TEuHI/AAAAAAAASno/_4BL18M7Q_EV1ngxIWddlUEl2Bc-KttvgCEwYBhgL/s1600/21.PNG"/></strong></span></p>
<p><span style="color: #000000;">Enter subnet mask of for static addressing as shown in given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-9fc2OVFKedY/WiqjPO3-jRI/AAAAAAAASno/-vNpmq7Xpv80xA4WOvvGhEPbBnKQH1gyACEwYBhgL/s1600/22.PNG"/></span></p>
<p><span style="color: #000000;">Enter gateway as shown in given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-VAh-fud-L7o/WiqjPf5v0LI/AAAAAAAASno/fA-g1KiUHaUjO3E5Mg74YQMqTZhzTlzywCEwYBhgL/s1600/23.PNG"/></span></p>
<p><span style="color: #000000;">Enter DNS server IP it can be 192.168.1.1 or 8.8.8.8 or can be both separated by spaces.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-eT4CSkm8ud4/WiqjQKZ3VyI/AAAAAAAASno/xRRzyQns0eQbXeVIx0pT_itAWqwJsm66wCEwYBhgL/s1600/25.PNG"/></span></p>
<p><span style="color: #000000;">Enter your local domain name as shown in given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-eT4CSkm8ud4/WiqjQKZ3VyI/AAAAAAAASno/xRRzyQns0eQbXeVIx0pT_itAWqwJsm66wCEwYBhgL/s1600/25.PNG"/></span></p>
<p><span style="color: #000000;"><strong>Configure 2<sup>nd</sup> network adapter for sniffing interface</strong></span></p>
<p><span style="color: #000000;">Click “Yes” to configure sniffing interfaces now as shown in given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ZUJ_AZbcsHs/WiqjQfHHuzI/AAAAAAAASno/DC7DMeDuYP8Cn6Btbju60o4N6Y8KkzIaQCEwYBhgL/s1600/26.PNG"/></span></p>
<p><span style="color: #000000;">Choose <strong>eth1</strong> as network interface should be used for sniffing interface.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-_wL6ptf5xCM/WiqjQty5eqI/AAAAAAAASno/SIdx6z1XUKkkyKh0BPjpQ2DNCuv3j8qNACEwYBhgL/s1600/27.PNG"/></span></p>
<p><span style="color: #000000;">Given below image is showing brief details of a network interface configuration. Click <strong>yes</strong> to proceed further step.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-tu7Bb5InEPg/WiqjQ0tnVjI/AAAAAAAASno/XTCrf_tKV0I1OENtQcBtq3ZUZlR-o725QCEwYBhgL/s1600/28.PNG"/></span></p>
<p><span style="color: #000000;">Network configuration is completed now click “Yes Reboot”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qYzJUQE81aU/WiqjRF2Y4bI/AAAAAAAASno/2j4NXowwDcQXJVmL8B4WrQdrlsxWT2AqwCEwYBhgL/s1600/29.PNG"/></span></p>
<p><span style="color: #000000;"><strong>Security onion configuration 2<sup>nd</sup> part </strong></span></p>
<p><span style="color: #000000;">Now once it restarts, again <strong>click</strong> on “<strong>setup</strong>” icon for further configuration of security onion setup as a real-time machine. Then click “yes, Continue”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RMPcd9sm5Js/WiqjRQB3QJI/AAAAAAAASno/n4G4DXGti5sfHHiV8ZCQKAjXyB4rTz59gCEwYBhgL/s1600/30.PNG"/></span></p>
<p><span style="color: #000000;">Since we had already configured the network interface, therefore, click on “yes, Skip network configuration”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-y0Z96PVVTbs/WiqjR43tFPI/AAAAAAAASno/tVgIXLjp9K4dge5ukk1H0Rlo41nKm2tDgCEwYBhgL/s1600/31.PNG"/></span></p>
<p><span style="color: #000000;">Select “Stable setup” which will configure ELSA; then Click OK.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Pt3iXjV_xcw/WiqjSTXOmYI/AAAAAAAASno/WFw4EGRu6vYKa_HSICwAQ6sxZWC7VGmwQCEwYBhgL/s1600/32.PNG"/></span></p>
<p><span style="color: #000000;">Select “Evaluation Mode” which configure Snort and Bro to monitor one network interface; then Click OK</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-wI3l17uc__g/WiqjSbRoiVI/AAAAAAAASno/i3ZLWD0QCM46Y4ENHAVdzYaj5HIaZ0RJACEwYBhgL/s1600/33.PNG"/></span></p>
<p><span style="color: #000000;">Select eth1 for the 2<sup>nd</sup> network interface that should be monitored as shown in the given image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EQXVhQLBvOc/WiqjShxeuAI/AAAAAAAASno/tnzJGiQnpicHTjyJ0vOb4MHERr6A2JW-QCEwYBhgL/s1600/34.PNG"/></span></p>
<p><span style="color: #000000;">Now add a username for Sguil, Squert, and ELSA a shown in given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-VpYrAD77kq4/WiqjTHdoVyI/AAAAAAAASno/qIk_0orEqtwQIahlQ-E7IBMmrwwBluMjwCEwYBhgL/s1600/35.PNG"/></span></p>
<p><span style="color: #000000;">Enter the password for username used while you want to login into Sguil, Squert and ELSA a shown in given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-tTAqpBEQPjw/WiqjTQZTBaI/AAAAAAAASno/2N9RgjilA5ABXBtOCsev3lDqs_H8wlJiACEwYBhgL/s1600/36.PNG"/></span></p>
<p><span style="color: #000000;">Now again next dialog box will display brief detain for configuration setting. Click on “yes, proceed with changes”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Iu2gyiKtZjk/WiqjThhHbUI/AAAAAAAASno/HuvHU082tp4QtuZarfqFrJfjfczbGu-IgCEwYBhgL/s1600/38.PNG"/></span></p>
<p><span style="color: #000000;">Here it will proceed for stopping all NSM services which manage all network services from creation to deletion.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4kwrkke_8XE/WiqjUK1ZcBI/AAAAAAAASno/EIf30ZQWb5weMmwA44MTCfiYLc5G6dP2wCEwYBhgL/s1600/39.PNG"/></span></p>
<p><span style="color: #000000;">Security Onion configuration is now completed. You will see it will launch icon for SGUIL, Squert, and ELSA. Now click on the squil icon and then enter the username and password to login into sguil.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-bX_o_9gBTRk/WiqjUCbM5iI/AAAAAAAASno/mm9ZhDEB1DEINvyC4N9DDG5U1rWSb12mQCEwYBhgL/s1600/45.PNG"/></span></p>
<p><span style="color: #000000;">Select network <strong>eth1</strong> to be the monitor as shown in given below image and click on “start SGUIL”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-KarlXxFeU9A/WiqjUkgE6WI/AAAAAAAASns/imU94r3SpJozzbdF-DyF63ZoJ1RyPOfHACEwYBhgL/s1600/46.PNG"/></span></p>
<p><span style="color: #000000;">It will work as a real-time system and start capturing traffic as shown in given below image.</span></p>
<p><span style="color: #000000;"><strong>Great!!</strong> Now analysis your network traffic will real-time machine</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vjXrYEGiMTE/WiqjVMyfYOI/AAAAAAAASno/Dy3avNt2DTc3OQ_CyiRYWB81OoM6O4J3ACEwYBhgL/s1600/47.PNG"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sanjeet Kumar is an Information Security Analyst | Pentester | Researcher  Contact <a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/sanjeet-kumar-27828058/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
