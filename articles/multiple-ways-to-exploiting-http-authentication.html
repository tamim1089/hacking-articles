<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Multiple Ways To Exploiting HTTP Authentication</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/multiple-ways-to-exploiting-http-authentication/" rel="bookmark"><time class="entry-date published" datetime="2018-12-21T17:04:56+00:00">December 21, 2018</time><time class="updated" datetime="2025-05-13T08:26:27+00:00">May 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we will learn about how to configure the password-protected Apache Web Server to restrict from online visitors without validation so that we can hide some essential and critical information to the unauthenticated users and how to penetrate it’s the weak configuration to break its security and exploit it.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<p><span style="color: #000000;"><strong>Introduction to HTTP Basic Authentication</strong></span></p>
<ul>
<li><span style="color: #000000;">Lab Set_up Requirement</span></li>
</ul>
<p><span style="color: #000000;"><strong>Setup Password Authentication </strong></span></p>
<ul>
<li><span style="color: #000000;">Installing the Apache utility Package</span></li>
<li><span style="color: #000000;">Creating the Password File</span></li>
<li><span style="color: #000000;">Configuring Access Control inside the Virtual Host Definition</span></li>
<li><span style="color: #000000;">Configuring Access Control with .htaccess Files</span></li>
<li><span style="color: #000000;">Confirm the Password Authentication</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting HTTP Authentication </strong></span></p>
<ul>
<li><span style="color: #000000;">xHydra</span></li>
<li><span style="color: #000000;">Hydra</span></li>
<li><span style="color: #000000;">Ncrack</span></li>
<li><span style="color: #000000;">Medusa</span></li>
<li><span style="color: #000000;">Metasploit</span></li>
<li><span style="color: #000000;">Burp Suite</span></li>
</ul>
<h3><span style="color: #800000;">Introduction to HTTP Basic Authentication</span></h3>
<p><span style="color: #000000;">In the context of an HTTP transaction, basic access authentication is a method for an HTTP user agent to provide a username and password when requesting.</span></p>
<p><span style="color: #000000;">HTTP Basic authentication (BA) implementation is the simplest technique for enforcing access controls to web resources because it doesn’t require cookies, session identifiers, or login pages; rather, HTTP Basic authentication uses standard fields in the HTTP header, obviating the need for handshakes.</span></p>
<p><span style="color: #000000;">The BA mechanism provides <strong>no confidentiality protection</strong> for the transmitted credentials. They are merely <strong>encoded with Base64</strong> in transit, but not encrypted or hashed in any way. HTTPS is, therefore, typically preferred used in conjunction with Basic Authentication.</span></p>
<p><span style="color: #000000;">For more details read from <strong>wikipedia.org</strong></span></p>
<p><span style="color: #000000;"><strong>Lab Setup Requirement</strong></span></p>
<p><span style="color: #000000;">Apache Server (Ubuntu 14.04)</span></p>
<p><span style="color: #000000;">Penetration Testing Machine (Kali Linux)</span></p>
<h3><span style="color: #800000;">Set Up Password Authentication</span></h3>
<p><strong><span style="color: #000000;">Installing the Apache utility Package</span></strong></p>
<p><span style="color: #000000;">Let’s start with the following command to install an Apache2 utility package called ‘htpasswd’. The htpasswd is used to create and update the flat-files used to store usernames and password for basic authentication of HTTP users.</span></p>
<pre class="lang:default decode:true">sudo apt-get install apache2 apache2-utils</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-AQuA1Egk3sU/XB0aFYUcqII/AAAAAAAAbws/-Apz_TOkaT4U4RUr0gyUw8U8EVN1WujMQCLcBGAs/s1600/1.png"/></span></p>
<p><strong><span style="color: #000000;">Creating the Password File</span></strong></p>
<p><span style="color: #000000;">Now use the htpasswd command to create a password file that Apache will use to authenticate users and use a hidden file “.htpasswd” in our /etc/apache2 configuration directory to store password.</span></p>
<pre class="lang:default decode:true">sudo htpasswd -c /etc/apache2/.htpasswd raj
cat /etc/apache2/.htpasswd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ESSLEV0B5r4/XB0aHjsJHnI/AAAAAAAAbxI/1JrcQx8bpUcFE7ZncVNhLE_qnKudwBUgwCLcBGAs/s1600/2.png"/></span></p>
<p><strong><span style="color: #000000;">Configuring Access Control inside the Virtual Host Definition</span></strong></p>
<p><span style="color: #000000;">Now save the following configuration in 000-default.conf file.</span></p>
<pre class="lang:default decode:true">gedit /etc/apache2/sites-enabled/000-default.conf</pre>
<pre class="lang:default decode:true ">&lt;Directory "/var/www/html"&gt;
        AuthType Basic
        AuthName "Restricted Content"
        AuthUserFile /etc/apache2/.htpasswd
        Require valid-user
    &lt;/Directory&gt;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ynpQE3Puc20/XB0aKdMTdPI/AAAAAAAAbxk/gclkRw46q7srRFqBKyLpC7IZCU4cTUyUwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;"><strong>Configuring Access Control with .htaccess Files</strong></span></p>
<p><span style="color: #000000;">Open the main Apache configuration file to enable password protection using .htaccess files and add the following line as highlighted.</span></p>
<pre class="lang:default decode:true">sudo gedit /etc/apache2/apache2.conf
ServerName localhost</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-zn0Tfpof__o/XB0aLdNn6WI/AAAAAAAAbxw/9BYLhp2DDWwnI40l9p5xIrZYfvdxeFtcACLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Enable .htaccess processing by changing the AllowOverride directive “<strong>None</strong>” to “<strong>All</strong>” in the block for the /var/www directory and then save the file and restart the apache service.</span></p>
<pre class="lang:default decode:true">&lt;Directory /var/www/&gt;
    Options Indexes FollowSymLinks
    AllowOverride All
    Require all granted
&lt;/Directory&gt;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-3VelJBh77BU/XB0aLY_4RsI/AAAAAAAAbx0/tFu9AHac51klaQYKtPfm4-bsf7C2ymoxACLcBGAs/s1600/5.png"/></span></p>
<p> </p>
<p><span style="color: #000000;">Next, you need to add an htaccess file to the directory you wish to restrict. Here, I want to restrict the entire website which is could be through /var/www/html, but you can place this file in any directory <strong>where you wish to restrict access:</strong></span></p>
<pre class="lang:default decode:true">AuthType Basic
AuthName "Restricted Content"
AuthUserFile /etc/apache2/.htpasswd
Require valid-user</pre>
<pre class="lang:default decode:true">sudo service apache2 restart</pre>
<p><span style="color: #000000;">While configuring .htaccess file we had added few options for the block directory. Let’s see what this configuration denotes.</span></p>
<p><span style="color: #000000;"><strong>AuthType Basic</strong>: This will set up a basic authentication for our site.</span></p>
<p><span style="color: #000000;"><strong>AuthName</strong> “Restricted Contents”: This will show the name of the authentication at the prompt.</span></p>
<p><span style="color: #000000;"><strong>AuthUserFile /etc/apache2/</strong>.htpasswd : This will show the location of the authentication file.</span></p>
<p><span style="color: #000000;"><strong>Require Valid-user:</strong> This will be used by one user who has confirmed their authentication who are permitted to access the website.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7myTDt7uqf0/XB0aL6NbfpI/AAAAAAAAbx4/DgAfqhw6mPswiSpAaVHEqD9O47VdwA77gCLcBGAs/s1600/6.png"/></span></p>
<h3><span style="color: #800000;">Confirm the Password Authentication</span></h3>
<p><span style="color: #000000;">Try to access your restricted content in a web browser to confirm that your content is protected. I will be accessible with a username and password prompt that looks like this:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uinHRnEOxdY/XB0aMfsJ5yI/AAAAAAAAbx8/KwB6AYfXlyQJxcB2gy1Z42lPLoAJy_pFACLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">If you will try to access the website without authentication or canceled the Required Authentication page then it will displace 401 error Unauthorized Access.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-8C68z14mCMk/XB0aMVtxq_I/AAAAAAAAbyA/QLF53GsSWyEGqSZj-dkwAUHEEFgaFV94ACLcBGAs/s1600/8.1.png"/></span></p>
<p><span style="color: #000000;">If you are valid users and try to access password protected website by using the valid credential, for example, we had created an account with raj: 123 to access apache HTTP service.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-U_nO_7O4cBY/XB0aM-jIi6I/AAAAAAAAbyE/243bjfb_rWw_70WsK8M2LID1r1qKfdbAQCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">As you can observe that, now we are able to access the content of the website.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ofFxA4gSSQc/XB0aNF0jjAI/AAAAAAAAbyI/9vUotW6pQpUd45tni42DcSuJVnfX9UtEQCLcBGAs/s1600/9.png"/></span></p>
<h3><span style="color: #000000;">Exploiting HTTP Authentication</span></h3>
<h3><span style="color: #800000;">xHydra</span></h3>
<p><span style="color: #000000;">This is the graphical version to apply dictionary attack via FTP port to hack a system. For this method to work:</span></p>
<p><span style="color: #000000;">Open <strong>xHydra</strong> in your Kali. And select <strong>Single Target option </strong>and there give the IP of your victim PC. And select <strong>HTTP </strong>in the box against <strong>Protocol option </strong>and give the port number<strong> 80</strong> against the <strong>port option</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-vv5EpECJR6I/XB0aFRsmGhI/AAAAAAAAbww/mg9O2hmamgwXJ_9vPYeJGpbl5LR_f2fFACLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now, go to <strong>Passwords tab </strong>and select <strong>Username List </strong>and give the path of your text file, which contains usernames, in the box adjacent to it.</span></p>
<p><span style="color: #000000;">Then select Password List and give the path of your text file, which contains all the passwords, in the box adjacent to it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NHVlrfNFeFc/XB0aFHrLSbI/AAAAAAAAbwo/DP0FdCzM9UwloPs5xbl6zGOiCVPnpL67wCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">After doing this, go to the Start tab and click on the <strong>Start </strong>button on the left.</span></p>
<p><span style="color: #000000;">Now, the process of dictionary attack will start. Thus, you will obtain the username and password of your victim.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-wqWTz9ZTLiU/XB0aGC9v4WI/AAAAAAAAbw0/ycO5NU87enYWoNoFpUX-IH-LsFaQ9TZrACLcBGAs/s1600/13.png"/></span></p>
<h3><span style="color: #800000;"><strong>Hydra</strong></span></h3>
<p><span style="color: #000000;">Hydra is often the tool of choice. It can perform rapid dictionary attacks against more than 50 protocols, including telnet, FTP, HTTP, https, SMB, several databases, and much more</span></p>
<p><span style="color: #000000;">Now, we need to choose wordlist. As with any dictionary attack, the wordlist is key. Kali has numerous wordlists built right in.</span></p>
<p><span style="color: #000000;">Run the following command</span></p>
<pre class="lang:default decode:true">hydra -L user.txt -P pass.txt 192.168.0.105 http-get</pre>
<p><span style="color: #000000;"><strong>-L:</strong> denotes the path for username list</span></p>
<p><span style="color: #000000;"><strong>-P:</strong>  denotes the path for the password list</span></p>
<p><span style="color: #000000;">Once the commands are executed it will start applying the dictionary attack and so you will have the right username and password in no time. As you can observe that we had successfully grabbed the HTTP username as raj and password as 123.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-NPs5XbkdCHo/XB0aGi3oOZI/AAAAAAAAbw4/ZFH3IWQgqOohNgZCkTydK0QuRsw5hcUFQCLcBGAs/s1600/14.png"/></span></p>
<h3><span style="color: #800000;">Ncrack</span></h3>
<p><span style="color: #000000;">Ncrack is a high-speed network authentication cracking tool. It was built to help companies secure their networks by proactively testing all their hosts and networking devices for poor passwords.</span></p>
<p><span style="color: #000000;">Run the following command</span></p>
<pre class="lang:default decode:true">ncrack -U user.txt -P pass.txt http://192.168.0.105</pre>
<p><span style="color: #000000;">Here</span></p>
<p><span style="color: #000000;"><strong>-U:</strong> denotes the path for username list</span></p>
<p><span style="color: #000000;"><strong>-P:</strong>  denotes the path for the password list</span></p>
<p><span style="color: #000000;">As you can observe that we had successfully grabbed the HTTP username as raj and password as 123.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-hbCco0GU9xc/XB0aGjpKiMI/AAAAAAAAbw8/R6LnDYIbaFogb9fpMKwGIm-XNyLnDAWYQCLcBGAs/s1600/15.png"/></span></p>
<h3><span style="color: #800000;">Medusa</span></h3>
<p><span style="color: #000000;">Medusa is intended to be a speedy, massively parallel, modular, login brute-forcer. It supports many protocols: AFP, CVS, FTP, HTTP, IMAP, rlogin, SSH, Subversion, and VNC to name a few</span></p>
<p><span style="color: #000000;">Run the following command</span></p>
<pre class="lang:default decode:true">medusa -h 192.168.0.105 -U user.txt -P pass.txt -M http -f</pre>
<p><span style="color: #000000;">Here</span></p>
<p><span style="color: #000000;"><strong>-U:</strong> denotes the path for username list</span></p>
<p><span style="color: #000000;"><strong>-P:</strong>  denotes the path for the password list</span></p>
<p><span style="color: #000000;">As you can observe that we had successfully grabbed the HTTP username as raj and password as 123.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Xouo65ZzKOw/XB0aHQlz1NI/AAAAAAAAbxA/lcTFTRllh9AGA21HFt4j2cW2I6UpRHMNgCLcBGAs/s1600/16.png"/></span></p>
<h3><span style="color: #800000;">Metasploit</span></h3>
<p><span style="color: #000000;">This module attempts to authenticate to an HTTP service. Open Kali terminal type<strong> msfconsole</strong> and then type:<strong> </strong></span></p>
<pre class="lang:default decode:true">use auxiliary/scanner/http/http_login
msf auxiliary(scanner/http/http_login) &gt; set user_file user.txt
msf auxiliary(scanner/http/http_login) &gt; set pass_file pass.txt
msf auxiliary(scanner/http/http_login) &gt; set rhosts 192.168.0.105
msf auxiliary(scanner/http/http_login) &gt;  set stop_on_success true
msf auxiliary(scanner/http/http_login) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BWodAnt3EaI/XB0aHlMJjXI/AAAAAAAAbxE/73Vo4pyWz-saqisvHVMU3mvE4Yvg3s-hQCLcBGAs/s1600/17.png"/></span></p>
<h3><span style="color: #800000;">Burp Suite</span></h3>
<p><span style="color: #000000;">Now here I had just typed the random value for authentication in order to fetch the request through Burp Suite. So before you sent the request to server <strong>turn on</strong> the <strong>burp suite</strong> and <strong>select proxy tab</strong> then, <strong>click</strong> on the <strong>intercept is on</strong> after then send the user authentication by clicking ok</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wDF3F26ZG_M/XB0aIcTU6LI/AAAAAAAAbxM/RRngvWlB6bMDiFmB_P5FBAWIz5osRTWYwCLcBGAs/s1600/24.png"/></span></p>
<p><span style="color: #000000;">Thus the sent request is captured by burp suite which you can see in the given below image. In the screenshot, I had highlighted some value in the last line. Here it says the type of authentication provided is basic and if you have read above theory of basic authentication I had described that it is encoded in base64.</span></p>
<p><span style="color: #000000;">Now time to generate the encoded value for authentication inside the burp suite. <strong>Click</strong> on <strong>action</strong> tab <strong>select send to intruder</strong> for HTTP Fuzzing attack.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-QhQqim0Lz-I/XB0aIukhX8I/AAAAAAAAbxU/jjpkqu8Co9wk59VNdGOLed4WnfsllKnwACLcBGAs/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Now open intruder frame and click on the position. Configure the position where payload will be inserted into the request. The attack type determines the way in which the payload is assigned to the payload position. Now <strong>select</strong> “the encoded value of authentication” for payload position and click to <strong>ADD</strong> button on the left side of the frame.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pjbCRlVgXoo/XB0aITm1zyI/AAAAAAAAbxQ/xi9kzpdrIt8Z5du63kfp7_O3wXhpQfKbgCLcBGAs/s1600/26.png"/></span></p>
<p><span style="color: #000000;">The base64 encoded value of Authentication is a combination of username and password now the scenario is to generate the same encoded value of authentication with the help of user password dictionary, Therefore, I have made a dictionary which contains both user password names in a text file.</span></p>
<p><span style="color: #000000;">In order to use the dictionary as payload click on <strong>payload tab</strong> under intruder<strong>; </strong>now <strong>load</strong> your dictionary which contains user password names from <strong>payload options</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-9LeWyi2qSMQ/XB0aJU5GPLI/AAAAAAAAbxY/wSN0idL9W-87-i3uPjSRqwYxDwEsULhJQCLcBGAs/s1600/27.png"/></span></p>
<p><span style="color: #000000;">But we want to send a request in the encoded value of our payload. To encode your payload click on <strong>ADD button</strong> available under payload processing.</span></p>
<p><span style="color: #000000;"><span style="color: #000000;"> A new dialog box will generate to select the rule to choose an encode option from the list; now select </span><span style="color: #000000;"><b>base64</b> from drag down the list of </span>URL<span style="color: #000000;"> encode key character for payload processing.</span></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-mARUwOcuPxc/XB0aJRrV-HI/AAAAAAAAbxg/_SjepXHLLrMZEZDR2llJ6BJqTLt2iLf6ACLcBGAs/s1600/28.png"/></span></p>
<p><span style="color: #000000;">This will start a brute force attack and try to match string for user authentication. In the screenshot, you can observe the status “200 OK” and length “11788” of the highlighted value is different from the rest of the values. This means we can use this encoded value to bypass the user authentication, which occurs from request number 5. Now check the username and password on the 5th line in the dictionary. In the dictionary I found raj: 123 have matching authentication.</span></p>
<p><span style="color: #000000;">Or you can also use this encoded Auth value to bypass the Apache HTTP authentication page via burp suite intercepted data.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-PDpGZ09LkVY/XB0aJsQM6jI/AAAAAAAAbxc/fgmuxeYaL2AincTrqfuYbNsfUBJz8pn6wCLcBGAs/s1600/29.png"/></span></p>
<p><span style="color: #000000;">Copy the above auth value and paste replace it with intercepted authorization a shown in below and forward the request to access restricted content.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-CBOQJ0jUkNM/XB0aKXFWfJI/AAAAAAAAbxo/NFtHQxWdwj49Ip9hzYfXlWgS3bCDphxKACLcBGAs/s1600/30.png"/></span></p>
<p><span style="color: #000000;">Booom!!! Here we have successfully access the content of the website.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3TENecJmk_M/XB0aK2q_0lI/AAAAAAAAbxs/ZI6aeJ34rCkj0Of-V9sDlqLbrzLbVi5MACLcBGAs/s1600/31.png"/></span></p>
<p><span style="color: #000000;">Hope you people have enjoyed this article and learned how weak configuration security can easily breach and the unauthorized person can access the restrict content of your website.</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
