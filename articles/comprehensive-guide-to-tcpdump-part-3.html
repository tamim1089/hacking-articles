<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Comprehensive Guide to tcpdump (Part 3)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/comprehensive-guide-to-tcpdump-part-3/" rel="bookmark"><time class="entry-date published" datetime="2020-03-24T18:22:08+00:00">March 24, 2020</time><time class="updated" datetime="2025-06-05T20:47:14+00:00">June 5, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">This is the third article in the Comprehensive Guide to tcpdump Series. Please find the first and second articles of the series below.</span></p>
<ul>
<li class="ai-optimize-7"><span style="color: #000000;"><a style="color: #000000;" href="https://www.hackingarticles.in/comprehensive-guide-to-tcpdump-part-1/">Comprehensive Guide to tcpdump (Part 1).</a></span></li>
<li class="ai-optimize-8"><span style="color: #000000;"><a style="color: #000000;" href="https://www.hackingarticles.in/comprehensive-guide-to-tcpdump-part-2/">Comprehensive Guide to tcpdump (Part 2).</a></span></li>
</ul>
<p class="ai-optimize-9"><span style="color: #000000;">In this part, we will cover some of the advance features which we were unable to cover in the previous parts of the series. So we can get more benefits from this tool.</span></p>
<h3 class="ai-optimize-10"><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li class="ai-optimize-11"><span style="color: #000000;"><strong>Version Information</strong></span></li>
<li class="ai-optimize-12"><span style="color: #000000;"><strong>Quick mode</strong></span></li>
<li class="ai-optimize-13"><span style="color: #000000;"><strong>Verbose mode</strong></span></li>
<li class="ai-optimize-14"><span style="color: #000000;"><strong>HTTP Requests</strong></span></li>
<li class="ai-optimize-15"><span style="color: #000000;"><strong>User Agent</strong></span></li>
<li class="ai-optimize-16"><span style="color: #000000;"><strong>Port Range</strong></span></li>
<li class="ai-optimize-17"><span style="color: #000000;"><strong>Destination</strong></span></li>
<li class="ai-optimize-18"><span style="color: #000000;"><strong>Source</strong></span></li>
<li class="ai-optimize-19"><span style="color: #000000;"><strong>Network</strong></span></li>
<li class="ai-optimize-20"><span style="color: #000000;"><strong>TCP Packets</strong></span></li>
<li class="ai-optimize-21"><span style="color: #000000;"><strong>Tcpdump to Wireshark</strong></span></li>
</ul>
<h3 class="ai-optimize-22"><span style="color: #800000;"><strong>Version Information</strong></span></h3>
<p class="ai-optimize-23"><span style="color: #000000;">Let’s begin with one of the simplest commands so that we can understand and relate all the practicals during the article. We can use this parameter to print the tcpdump, libpcap and OpenSSL version string.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump --version</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-lhjDghywb-s/XnpLhkS-lkI/AAAAAAAAjKw/jU56eXK3ZSIfr-ZsYzAC81ogZ_SMWl6EgCLcBGAsYHQ/s1600/1.png"/></p>
<h3 class="ai-optimize-24"><span style="color: #800000;">Quick Mode</span></h3>
<p class="ai-optimize-25"><span style="color: #000000;">Arguably if the network is very quite, performing any operation during that time will take more time than usual. The person who developed tcpdump thought of this conundrum and gave us the way to speed up the process by using the “-q” parameter. It will print less information about protocols and data packets to save time.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 -c 5
tcpdump -i eth0 -c 5 -q</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-fhUKk4Dh1ns/XnpLlIEmtYI/AAAAAAAAjLY/m3z3f9PlSzk6kOwqJ_z86HzT_JSymPDlgCLcBGAsYHQ/s1600/2.png"/></p>
<h3 class="ai-optimize-26"><span style="color: #800000;">Verbose Mode</span></h3>
<p class="ai-optimize-27"><span style="color: #000000;">The verbose mode is famous to provide extra information regarding operations. in TCPDump, verbose mode provides such the information too. For instance, time to live, identification, total length. It can also enable additional packet integrity checks such as verifying the IP and ICMP header checksum values.`</span></p>
<p class="ai-optimize-28"><span style="color: #000000;">TCPDump provides us with plenty of parameters that we move around this mode like -v, -vv, -vvv, where each parameter has its unique efficiency.</span></p>
<ul>
<li class="ai-optimize-29"><span style="color: #000000;"><strong>-v</strong> parameter is the traditional verbose mode.</span></li>
<li class="ai-optimize-30"><span style="color: #000000;"><strong>-vv</strong> parameter surpasses the traditional verbose mode, printing additional fields from NFS (Network File System) reply packets and fully decoding SMB packets.</span></li>
<li class="ai-optimize-31"><span style="color: #000000;"><strong>-vvv</strong> parameter has something more to provide like tenet options etc.</span></li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 -c 2
tcpdump -i eth0 -c 2 -v
tcpdump -i eth0 -c 2 -vv
tcpdump -i eth0 -c 2 -vvv</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-9GgX-lw0gkw/XnpLmHaLl_I/AAAAAAAAjLc/AbQ20F_4J340CrG4ok8L3p_dagpY8ButgCLcBGAsYHQ/s1600/3.png"/></p>
<h3 class="ai-optimize-32"><span style="color: #800000;">HTTP Requests</span></h3>
<p class="ai-optimize-33"><span style="color: #000000;">As we all know, HTTP Requests is an information message from the client to a server over the hypertext transfer protocol (HTTP). It has various methods to deliver this information. These methods are case-sensitive and always mentioned in the UPPERCASE. Through tcpdump, we can capture these request to analyze the traffic sent over the said protocol traffic.</span></p>
<p class="ai-optimize-34"><span style="color: #000000;">The method which we can capture through tcpdump are the following :</span></p>
<ul>
<li class="ai-optimize-35"><span style="color: #000000;"><strong>GET- </strong>This method is used to retrieve the information from the given server using a given URL. Requests using GET should only retrieve data and have no other effect on it. We can also capture this request with the help of tcpdump.</span></li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -s 0 -A -vv 'tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x47455420'</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-3pCQ6GfT0qY/XnpLmZh4D9I/AAAAAAAAjLg/TsIDoC6QQg8w8oOwl-yMMkbZThxr3f05gCLcBGAsYHQ/s1600/4.png"/></p>
<ul>
<li class="ai-optimize-36"><span style="color: #000000;"><strong>POST- </strong>This request is used to send data to the server. Like customer information, file upload, etc. using HTML forms. Traffic over this protocol can analyzed using the following command :</span></li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -s 0 -A -vv 'tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x504f5354'</pre>
<p class="ai-optimize-37"><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-BaPW5oLNB84/XnpLmQW6FZI/AAAAAAAAjLk/6CQdFSZmOoUbOJBREB0rXbbHBzrJB-wGwCLcBGAsYHQ/s1600/5.png"/></strong></span></p>
<ul>
<li class="ai-optimize-38"><span style="color: #000000;"><strong>Request-URL- </strong>It is a uniform resource identifier, which identifies the resource on which we need to apply requests. The most common form of this is used to identify a resource on a server. If a client wants to retrieve the data directly from the server, where it originated, then it would create a connection to port 80 of the host and send the request. These requests can be captured using the following commands:</span></li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -v -n -l | egrep -i "POST /|GET /|Host:"</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-r_Aiua4fXik/XnpLnGBL2bI/AAAAAAAAjLo/2SGkoeJMAdAvUxSfzn5yY14p41OJF5obACLcBGAsYHQ/s1600/6.png"/></p>
<h3 class="ai-optimize-39"><span style="color: #800000;">User Agent</span></h3>
<p class="ai-optimize-40"><span style="color: #000000;">With TCPDump, you can also see which traffic is generated from which application. We can also find the user agents in our data traffic by using the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -nn -A -s150 -l | grep "User-Agent:"</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-wqziyNYbj4g/XnpLnoiqxZI/AAAAAAAAjLs/xHD-O9QpKDw9ccTi8Q3DngyxEuq5-89XgCLcBGAsYHQ/s1600/7.png"/></p>
<h3 class="ai-optimize-41"><span style="color: #800000;">Port Range</span></h3>
<p class="ai-optimize-42"><span style="color: #000000;">Some ordinary port filters help us to analyze the traffic on a particular port. But in tcpdump, we give our scan a range of ports through which it can monitor the destination of TCP/UDP or other port-based network protocols.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 portrange 21-80</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-CL-fPNqybrM/XnpLoCjkKtI/AAAAAAAAjLw/fgRdjMJjDm8vHiFWjIQZZuwyqksDYfHxQCLcBGAsYHQ/s1600/8.png"/></p>
<h3 class="ai-optimize-43"><span style="color: #800000;">Destination</span></h3>
<p class="ai-optimize-44"><span style="color: #000000;">To check the flow of data in network traffic towards a particular destination, use the following command for this :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 dst google.com</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-QwlPoLaMY5I/XnpLoadwYLI/AAAAAAAAjL0/pOVZTIj-z8EvElRF9pv1EkJHrBb6kPVoQCLcBGAsYHQ/s1600/9.png"/></p>
<h3 class="ai-optimize-45"><span style="color: #000000;"><span style="color: #800000;">Source</span></span></h3>
<p class="ai-optimize-46"><span style="color: #000000;">To check the data traffic coming from a particular source, we can follow the command given below :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump -i eth0 src google.com</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-6w9CDxk2P44/XnpLh38acfI/AAAAAAAAjK0/_ZAsFN9cxvk6AFmRU1aCW3mPm9T_uXBVACLcBGAsYHQ/s1600/10.png"/></p>
<h3 class="ai-optimize-47"><span style="color: #800000;">Network</span></h3>
<p class="ai-optimize-48"><span style="color: #000000;">To find the packets going to or from in a particular network, we can use the following function to analyze this traffic:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump net 192.168.0.1 -c5</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Vryge2Bpi40/XnpLh9c2yOI/AAAAAAAAjK4/0ym-LZpVHIwMMqr10dm206Ak5GOwmR0XwCLcBGAsYHQ/s1600/11.png"/></p>
<h3 class="ai-optimize-49"><span style="color: #800000;">TCP Packets</span></h3>
<p class="ai-optimize-50"><span style="color: #000000;">TCP packet is the format consists of the fields such as source port and destination port field. Through these fields, we can identify the endpoints of the connections and can also capture these TCP packets in its various flag format. i.e. SYN, RST and ACK.</span></p>
<ul>
<li class="ai-optimize-51"><span style="color: #000000;"><strong>SYN- </strong>The SYN flag synchronizes sequence numbers to initiate a TCP connection. We can capture this particular packet from traffic with the help of tcpdump.</span></li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump 'tcp[tcpflags] == tcp-syn'</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-AUbdU6Ggaog/XnpLiRlMSrI/AAAAAAAAjK8/JEs-KW1lXMoOFAU96mCX-VPllLQCsCgJACLcBGAsYHQ/s1600/12.png"/></p>
<ul>
<li class="ai-optimize-52"><span style="color: #000000;"><strong>RST- </strong>The system knows the RST flag as the reset flag. If a packet is sent to a particular host that expects it, the receiver sends this flag to the sender. The system uses the RST flag to re-establish a TCP end-to-end connection. We can capture this flag from our data traffic with the help of tcpdump.</span></li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump 'tcp[tcpflags] == tcp-rst'</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-p1afA8s-9sc/XnpLjWdNtZI/AAAAAAAAjLA/Pdf7VwvrGk0Nhktm38UyuzCJ8Ksmt9CGwCLcBGAsYHQ/s1600/13.png"/></p>
<ul>
<li class="ai-optimize-53"><span style="color: #000000;"><strong>ACK- </strong>The Acknowledgement flag refers to the ACK flag. We use this flag to acknowledge that our data packet has been successfully received. We can capture these flags with tcpdump to study our data traffic.</span></li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tcpdump 'tcp[tcpflags] == tcp-ack' -c5</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-O2d94ZGj6lY/XnpLjiqDBwI/AAAAAAAAjLE/frgCIBLnf3MYySfbzHI0OmwdBSDiFD4UgCLcBGAsYHQ/s1600/14.png"/></p>
<h3 class="ai-optimize-54"><span style="color: #800000;"><strong>Tcpdump to Wireshark</strong></span></h3>
<p class="ai-optimize-55"><span style="color: #000000;">The only difference between the Wireshark and TCPDump is that Wireshark is GUI while tcpdump is a command-line tool. But with the help of a few sources, we use a command on tcpdump and view our data traffic results in Wireshark which, we find is the best way to analyze our traffic. This can be done using the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh root@remotesystem 'tcpdump -c20 -nn -w - not port 22' | wireshark -k -i –</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-vGAC0aF2S_M/XnpLjo6GFoI/AAAAAAAAjLI/8VsnkkkNxGkSRyyiCJjVaPeYavHfcVBvwCLcBGAsYHQ/s1600/15.png"/></p>
<p class="ai-optimize-56"><span style="color: #000000;">After running this command it will immediately open the Wireshark and will ask a few questions about our scan. Press <strong>OK</strong> to move further.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-A-7PiY33fLQ/XnpLkDnzFnI/AAAAAAAAjLM/BOLWlUrSd58KjeNibQglQQtHZUc5zYZ7QCLcBGAsYHQ/s1600/16.png"/></p>
<p class="ai-optimize-57"><span style="color: #000000;">After this, it will ask you which network interface we want to capture the data packets. In our case it will be eth0, so we are selecting that network interface.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-MN5zKH60a30/XnpLkmZA4PI/AAAAAAAAjLQ/AhGSTwvk_ksk_S3ZjEFIRYaDUonkCBYrACLcBGAsYHQ/s1600/17.png"/></p>
<p class="ai-optimize-58"><span style="color: #000000;">After completing all the formalities our live data capture screen will appear with our captured data packets.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-AvLF93cODYQ/XnpLkxKY6cI/AAAAAAAAjLU/q1Sy3uud_rcDJC6FyKCCih7IVNzBcMiQQCLcBGAsYHQ/s1600/18.png"/></p>
<p class="ai-optimize-59"><span style="color: #000000;">By following these steps we can run a command for tcpdump and capture its results in Wireshark.</span></p>
<p class="ai-optimize-60"><span style="color: #000000;"><strong>Author: </strong>Shubham Sharma is a Pentester, Cybersecurity Researcher, Contact <a style="color: #000000;" href="https://www.linkedin.com/in/shubham-sharma-626964153/">Linkedin</a> and <a style="color: #000000;" href="https://twitter.com/Shubham_pen">twitter</a>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
