<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Mango HackTheBox Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/mango-hackthebox-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-01-12T13:23:37+00:00">January 12, 2021</time><time class="updated" datetime="2025-06-23T16:32:14+00:00">June 23, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we’re going to solve another boot2root challenge called “<strong>Mango</strong>“. It’s available at HackTheBox for penetration testing practice. This laboratory is of an easy level, but with adequate basic knowledge to break the laboratories and if we pay attention to all the details we find during the examination it will not be complicated. The credit for making this lab goes to <strong>MrR3boot</strong>. Let’s get started and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;">Level: <strong>Medium</strong></span></p>
<p><span style="color: #000000;">Since these labs are available on the <strong>HackTheBox</strong> website.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Burp Suite</span></li>
<li><span style="color: #000000;">Lse.sh</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">NoSQL Injection with python script</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Abuse of SUID “jjs” binary</span></li>
</ul>
<ul>
<li><span style="color: #000000;"><strong>Capture the flag</strong></span></li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Reconnaissance</strong></span></h3>
<p><span style="color: #000000;">We execute nmap tool with all ports, versions and scripts.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A -p- mango.htb</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Cr_m6TCGBdk/X_2f0J39ghI/AAAAAAAAs1g/duzfQv6lbdE2gxMHXVzWDEX1hqWchI_gACLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">We see web services for 443 port, this has an SSL certificate and we enumerate a <strong>subdomain</strong>.</span></p>
<p><span style="color: #000000;">Then, we insert subdomain in “<strong>/etc/hosts</strong>”:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yxyfpkUig_Y/X_2gCIdNC8I/AAAAAAAAs1k/DMjDi-2X_v8QOTBWGV2v9RIBwMI5D-nNQCLcBGAsYHQ/s16000/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">We access this web resource and we see that we do not have access.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IhxDgONx2Kg/X_2gHUleEpI/AAAAAAAAs1s/AFlaZFgyydc9bkr9D72k5lTiHJOkENW7wCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">Then, we access the <strong>subdomain found</strong>, we have an authentication panel that we must violate.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FPVrPNhGWEU/X_2gPUA3RdI/AAAAAAAAs1w/FkCqvl65TN4CEHIzxB-Y004zLJVCv8zagCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">There, we use <strong>Burp</strong> for testing the differents payloads SQL injection on the website. We found that the site is vulnerable to <strong>NoSQL Injection</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oof1tkrfYgM/X_2gUpchSXI/AAAAAAAAs10/zPM2iHAJfdAEntLkEK9CRhYkkZHSoK57gCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">We visit the website using the payload and see that we manage to <strong>bypass</strong> the authentication system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kzQtH2rEjpc/X_2gvKfoA5I/AAAAAAAAs2E/UtHUZDO6NDAS_O0RnRhEL6JaahRvxFC5wCLcBGAsYHQ/s16000/6.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">We use the following script, we get <strong>two credentials</strong>. <em>Remember that in OSCP certification, the use of SQLMap or NoSQLMap is not allowed</em>.</span></p>
<p><span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/m3n0sd0n4ld/Miscellaneous/blob/main/NoSQL.py">Download: Script NoSQL.py</a></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5Aho2vPjAPE/X_2g1MRa4kI/AAAAAAAAs2I/J-jBlwDYXuQwaSDf4KgHQHgeZnXn7mvlgCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">We use the credentials of user “<strong>mango</strong>” with the <strong>SSH</strong> service.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Bn7hnllKBZs/X_2g5psxuUI/AAAAAAAAs2M/zoGSj43i-NIXB32mP88Bs4h2mcPbcjv-QCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">We don’t access the “<strong>user.txt</strong>” file, we authentication with “<strong>admin</strong>” user and we read the “<strong>user.txt</strong>” flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZaNx-LGZbGI/X_2g_kYc5GI/AAAAAAAAs2U/usckTDLX5TIvcr51CBKZrTA2KbrxO7tgQCLcBGAsYHQ/s16000/9.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation (root)</strong></span></h3>
<p><span style="color: #000000;">We use the <strong>lse.sh</strong> script, we enumerate two uncommon suid binaries, we will use “<strong>jjs</strong>” for privilege escalation.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GHKYlP4a4Vg/X_2hFzfVJ8I/AAAAAAAAs2c/k2G2_DPpNVwHCFP3PiOprx4l76A-EIu3ACLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">If we do not want to complicate it, we will read directly the root.txt file, but this is not valid in OSCP and besides, it loses the essence of the boot2root.</span></p>
<p><span style="color: #000000;">Code to read “<strong>root.txt</strong>”:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo 'var BufferedReader = Java.type("java.io.BufferedReader");
var FileReader = Java.type("java.io.FileReader");
var br = new BufferedReader(new FileReader("/root/root.txt"));
while ((line = br.readLine()) != null) { print(line); }' | jjs</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2jA8nb_6D3Y/X_2hN9UsgmI/AAAAAAAAs2g/cRjWGfT3DWkECW71ZYrek6zWawS6vK8sgCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">How can we escalate to root? There are several ways, I didn’t get complicated and I did it by adding my public key to the “<strong>authority_keys</strong>” file of the <strong>root</strong> user.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo 'var FileWriter = Java.type("java.io.FileWriter");
var fw=new FileWriter("/root/.ssh/authorized_keys");
fw.write("ssh-rsa AAAAB3NzaC1yc2………
fw.close();' | jjs</pre>
<p><span style="color: #000000;">Then, once done, we read the “<strong>authorized_keys</strong>” file of the <strong>root</strong> user and check that our public key is already there.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KZI497idynA/X_2hVK58GPI/AAAAAAAAs2o/hIoncQGrZwAWjTb5Q_BGVv4I27SYaElUACLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">We connect to <strong>SSH</strong> service with <strong>root</strong> user and we use RSA private key.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HwTfx_b8TV8/X_2ha3OiiUI/AAAAAAAAs2s/oYfVp-Zhsi8mk7Tvy5dL2mbnAIxL-aYMQCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>David Utón</strong> is Penetration Tester and security auditor for Web applications, perimeter networks, internal and industrial corporate infrastructures, and wireless networks. Contacted on <span style="color: #0000ff;"><strong>LinkedIn </strong></span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://twitter.com/David_Uton">Twitter</a></strong></span>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
