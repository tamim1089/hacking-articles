<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/threat-hunting/" rel="category tag">Threat Hunting</a></span>            </div>
            <h1 class="post-title entry-title">Threat Hunting: Velociraptor for Endpoint Monitoring (Part 2)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/threat-hunting-velociraptor-for-endpoint-monitoring-part-2/" rel="bookmark"><time class="entry-date published" datetime="2020-09-26T09:08:29+00:00">September 26, 2020</time><time class="updated" datetime="2025-05-13T08:00:21+00:00">May 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="MsoNoSpacing"><span lang="EN-IN" style="color: #000000;">In our previous article, we have covered with Velociraptor master server setup with a brief demonstration of Velociraptor installation, GUI interface set up with some of the forensics Artifacts.</span></p>
<p class="MsoNoSpacing"><span lang="EN-IN" style="color: #000000;">If you didn’t read that then don’t worry you can visit that article from <strong><a href="https://www.hackingarticles.in/threat-hunting-velociraptor-for-endpoint-monitoring/"><span class="MsoHyperlink"><span style="text-decoration: none; text-underline: none;">here</span></span></a></strong>.</span></p>
<p class="MsoNoSpacing"><span style="color: #000000;">This post continues our deep dive into <strong data-start="506" data-end="561">Threat Hunting Velociraptor for Endpoint Monitoring</strong>. </span></p>
<p class="" data-start="467" data-end="562"><span style="color: #000000;">Once the server setup is complete, we need to focus on how to add hosts or clients in our network environment for quick incident response, forensics, malware analysis, and threat hunting. In this blog, we are going to focus our attention only on those machines that show potential signs of compromise.</span></p>
<p class="" data-start="867" data-end="955"><span style="color: #000000;">Now we’ll see how to add a client to the Velociraptor server for further investigations.</span></p>
<p class="MsoNoSpacing"><span lang="EN-IN" style="color: #000000;"> <img fetchpriority="high" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-gol_7xMiZVA/X2718H61XuI/AAAAAAAAo24/jOSUa2okX00dAQv3mcQm2cRdeQrEjP_zgCLcBGAsYHQ/s16000/0.1.png" alt="Velociraptor for Endpoint Monitoring" width="1024" height="768"/></span></p>
<h3 class="MsoNoSpacing"><span style="color: #800000;"><span lang="EN-IN" style="font-size: 14.5pt; font-family: Calibri, sans-serif;">Table of Contents</span></span></h3>
<ul>
<li><strong><span style="color: #000000;">Prerequisites</span></strong></li>
<li><strong><span style="color: #000000;">Agent or Client Environment</span></strong></li>
<li><strong><span style="color: #000000;">Agent installation</span></strong>
<ul>
<li><span style="color: #000000;">For Linux Systems</span></li>
<li><span style="color: #000000;">For Windows server or windows 10</span></li>
</ul>
</li>
<li><strong><span style="color: #000000;">Configure Agent to send Data to Velociraptor Server</span></strong></li>
<li><strong><span style="color: #000000;">Forensics investigation / Threat Hunting</span></strong></li>
</ul>
<h3 class="MsoNoSpacing"><span style="color: #000000;"><span style="color: #800000;"><span lang="EN-IN" style="font-size: 14.5pt; line-height: 107%; font-family: Calibri, sans-serif;">Prerequisites</span></span></span></h3>
<p class="MsoNoSpacing"><span lang="EN-IN" style="color: #000000;">To configure <b>Velociraptor Agent</b> on your client-server, there are some prerequisites required for installation or pen-testing.</span></p>
<ul>
<li><span style="color: #000000;">Windows, Linux systems, or cloud servers with admin access.</span></li>
<li><span style="color: #000000;">Velociraptor Agents</span></li>
<li><span style="color: #000000;">Attacker: Kali Linux </span></li>
</ul>
<h3 class="MsoNoSpacing"><span style="color: #800000;"><span lang="EN-IN" style="font-size: 14.5pt; font-family: Calibri, sans-serif;">Agent or Client Environment.</span></span></h3>
<p class="MsoNoSpacing"><span style="color: #000000;"><span lang="EN-IN" style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-theme-font: minor-latin;">In this article, we will target to install Velociraptor Agents on a Windows server and Linux environments. You can download Velociraptor Agents by following the below link.</span></span></p>
<p class="lang:default decode:true"><strong><a href="https://github.com/Velocidex/velociraptor/releases">Github</a></strong></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><span lang="EN-IN" style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-theme-font: minor-latin;">C</span><span lang="EN-IN" style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-theme-font: minor-latin;">hoose your installation package</span><span lang="EN-IN" style="font-size: 14.5pt; font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-theme-font: minor-latin;"> </span></span></p>
<p class="MsoNoSpacing" style="margin-left: .5in; text-indent: -.25in; mso-list: l1 level1 lfo3;"><span style="color: #000000;"><!-- [if !supportLists]--><span lang="EN-IN" style="font-family: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol; font-weight: normal;"><span style="mso-list: Ignore;">·<span style="font: 7.0pt 'Times New Roman';">         </span></span></span><!--[endif]--><span lang="EN-IN" style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-theme-font: minor-latin;">Go to the official GitHub page of Velociraptor by following the above Link </span></span></p>
<p class="MsoNoSpacing" style="margin-left: .5in; text-indent: -.25in; mso-list: l1 level1 lfo3;"><span style="color: #000000;"><!-- [if !supportLists]--><span lang="EN-IN" style="font-family: Symbol; mso-fareast-font-family: Symbol; mso-bidi-font-family: Symbol; font-weight: normal;"><span style="mso-list: Ignore;">·<span style="font: 7.0pt 'Times New Roman';">         </span></span></span><!--[endif]--><span lang="EN-IN" style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-theme-font: minor-latin;">Select and install Velociraptor Agents as per your client system </span></span></p>
<p class="MsoNoSpacing"><span style="color: #000000;"><strong><span lang="EN-IN" style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-theme-font: minor-latin; font-weight: normal;"><img decoding="async" src="https://1.bp.blogspot.com/-E848x4lcRlE/X272EkGx6LI/AAAAAAAAo3A/eESEWaLCHA8_5-S4UUhhT40hj-a02YU_ACLcBGAsYHQ/s16000/0.2.png"/> </span></strong></span></p>
<h3 class="MsoNoSpacing"><span style="color: #800000;"><span lang="EN-IN" style="font-size: 14.5pt; font-family: Calibri, sans-serif;">Agent installation</span></span></h3>
<h4 class="MsoNoSpacing"><span style="color: #000000;"><span lang="EN-IN" style="font-size: 12pt; font-family: Calibri, sans-serif;"><span style="mso-spacerun: yes;"> </span></span><span lang="EN-IN" style="font-size: 12.0pt; font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-theme-font: minor-latin;">For Linux Systems !!</span><span lang="EN-IN" style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-theme-font: minor-latin; font-weight: normal;"> </span></span></h4>
<p class="MsoNoSpacing"><span style="color: #000000;"><span lang="EN-IN" style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-theme-font: minor-latin;">To install Velociraptor Agent into your Linux systems, follow the steps as described below: </span></span><span style="color: #000000;"><span lang="EN-IN" style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-theme-font: minor-latin;">Visit to the official GitHub page of Velociraptor locate and select Velociraptor-Linux-amd64 Package</span></span></p>
<p class="MsoNoSpacing" style="text-align: justify;"><span style="color: #000000;"><span lang="EN-IN" style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-theme-font: minor-latin;">I prefer to download this package via terminal with wget. To download Agent issue the following command into the terminal.</span></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget https://github.com/Velocidex/velociraptor/releases/download/v0.4.9/velociraptor-v0.4.9-1-linux-amd64</pre>
<p class="MsoNoSpacing"><span style="color: #000000;"><strong><span lang="EN-IN" style="font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-theme-font: minor-latin; font-weight: normal;"> <img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-DVYHoftIhxA/X272MFWn2WI/AAAAAAAAo3I/mJBsiLRvIFoUI-5B5e1IzuS6omZYR5BYgCLcBGAsYHQ/s16000/1.png" alt="Velociraptor for Endpoint Monitoring" width="1154" height="225"/></span></strong></span></p>
<p><span style="color: #000000;">After downloading it, return to your Velociraptor Master Server and issue the following command to install a client service into the server so that it becomes active to accept connections from the client.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd C:\Program Files\Velociraptor 
Velociraptor.exe --config server.config.yaml service install 
services.msc</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_B8DzrzbRYU/X272UX97fjI/AAAAAAAAo3Q/G1D4ItU8cPwP269c9sUmuADZ1zuMRSCVQCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Also, you can verify whether the service is running or not by issuing command <strong>services.msc</strong> it will open a prompt on your screen as shown below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SlzXuhHloXU/X272ayuFQmI/AAAAAAAAo3U/f06fUx6lVJMjfhW1zI3ZbZ2F7a7oTI1UQCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">Nice! As we can see service is enabled or running.</span></p>
<p><span style="color: #000000;">Next, come to the Directory where the Velociraptor server installed and copy the configuration of the client.config </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4d6U9zWVxBI/X272hGRRSmI/AAAAAAAAo3Y/RC5WvNPMd5EUfWzgQl0gQPEGMsu6uU0TQCLcBGAsYHQ/s16000/5.png"/></span></p>
<h3><span style="color: #800000;">Configure Agent to send data to Velociraptor server</span></h3>
<p><span style="color: #000000;">Return to Linux machine and create a client.config.yaml file and paste the configuration of the client.config file which we have copied above inside a <strong>client.config.yaml</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-CxggqNxWQGA/X272nbndGaI/AAAAAAAAo3g/cAXAtUsD2DscovZ5b8T0yQk6hHIC-E5DACLcBGAsYHQ/s16000/6.png" alt="Velociraptor for Endpoint Monitoring" width="642" height="538"/></span></p>
<p><span style="color: #000000;">This client configuration file contains a CA certificate that is used for authentication between the client’s machine to the Velociraptor Master server.  </span><span style="color: #000000;">After that change permission of the Downloaded Velociraptor Agent to make it executable and then deploy the client to Velociraptor by executing the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chmod +x velociraptor -v0.4.9-1-Linux-amd64
./velociraptor-v0.4.9-1-Linux-amd64 –config client.config.yaml client -v</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-s3M6vKRwnfU/X272vLU2rWI/AAAAAAAAo3o/ezEzpDNU_A4lKXy1-V8Pv-iOgb0WN9rAgCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">Hmm:) !! As you can see service is started sending logs to the Velociraptor server. </span><span style="color: #000000;">You can ensure the integration of the client (Ubuntu) machine with the server inside the Velociraptor Master Server which will generate logs for the client connectivity as shown in the image.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-aAi2ordpclc/X2723f41ieI/AAAAAAAAo30/FeTxVWacA9wIxtkdUWtiJ4RyE7PjhiqvgCLcBGAsYHQ/s16000/8.png" alt="Velociraptor for Endpoint Monitoring" width="892" height="148"/></span></p>
<p><span style="color: #000000;">Let’s navigate to<span style="color: #0000ff;"><strong> http://localhost:8889</strong></span> to access the GUI interface and verify whether the client is reflected on the interface or not by simply running a query in the search bar </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">host:ubuntu</pre>
<p><span style="color: #000000;">where Ubuntu is my client’s system name </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-m__C8oCiykY/X272_2g62hI/AAAAAAAAo38/P9tqTRuyt5YJGrfzBCe49Ez3zaafowfgACLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">Ok 😃 !! you have successfully added the Linux system as a client </span></p>
<h4><span style="color: #000000;">For Windows Systems !!</span></h4>
<p><span style="color: #000000;">As described above you can download Velociraptor Agent for your windows system by official GitHub page of a velociraptor </span></p>
<p><span style="color: #000000;">In my case, I will target to install Velociraptor agent in Windows server 2016.   </span></p>
<p><span style="color: #000000;">Let’s begin the installation !!</span></p>
<p><span style="color: #000000;">Download package <strong>velociraptor-v0.4.9-windows-amd6464.msi</strong>, It will download a ZIP file into Your downloads open it install into the system.</span></p>
<p><span style="color: #000000;"><strong> <img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-JbtYmOP08Xc/X273JzRLWrI/AAAAAAAAo4E/lvSr1T-L9voXJbf-qV9QZxydN2dnmja7ACLcBGAsYHQ/s16000/10.png" alt="Threat Hunting" width="691" height="488"/></strong></span></p>
<h5 data-start="665" data-end="704"><strong><span style="color: #000000;">Configuring and Deploying the Agent</span></strong></h5>
<p><span style="color: #000000;">Configure Agent to send data to Velociraptor server </span><span style="color: #000000;">Open the command prompt with administrator privilege and navigate to velociraptor folder.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd C:\Program Files\Velociraptor</pre>
<p><span style="color: #000000;">So now what we need to do is to generate the configuration. To generate the configuration execute the following command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">velociraptor.exe config generate -i</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mfUk807nXQ8/X273Qoj3cFI/AAAAAAAAo4M/d4rnaf97bXgVcS2-rf5vOJZrH3znF3i7QCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">Hmm great !! as we can see the agent is installed successfully. </span><span style="color: #000000;">Now, since we have this part done </span></p>
<p><span style="color: #000000;">Return to the Velociraptor master server and go to the directory where it is installed and what we need to do is to copy the client.config.yaml file.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-ehVV0KIcLJM/X273Ym8ahnI/AAAAAAAAo4Q/P8zyO2W8ydoiZ79A_2cVchMjOwHraceCgCLcBGAsYHQ/s16000/12.png" alt="Velociraptor for Endpoint Monitoring" width="650" height="352"/></span></p>
<p><span style="color: #000000;">Then come back to the windows machine open the directory where Agent is installed and replace the client.config,yaml by simply pasting the file into that directory</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jW00qWQjtzI/X273e8Oo7_I/AAAAAAAAo4Y/Y-LTh1XCn8w8N-pwIyK0l5bBvvbMKZuvQCLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">Come back to CMD prompt and deploy your client to the Velociraptor server by issuing the following command </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Velociraptor.exe --config client.config.yaml client -v</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-j7uq2IiTF_c/X273lS_y_fI/AAAAAAAAo4c/ckal_SqouowzxW8nbL2us5G16jT0SRrawCLcBGAsYHQ/s16000/14.png" alt="Velociraptor for Endpoint Monitoring" width="855" height="515"/></span></p>
<h5><strong><span style="color: #000000;">Verifying Client Integration</span></strong></h5>
<p><span style="color: #000000;">Nice 😀  !! You can ensure the integration of the client (Windows) machine with the server inside the Velociraptor Master Server which will generate logs for the client connectivity as shown in the image.</span></p>
<p><span style="color: #000000;">Come back to the Velociraptor server and verify, whether the client is reflected on the GUI interface or not by simply running a query in the search box</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">host:dc1</pre>
<p><span style="color: #000000;">where dc:1 is my client’s system name </span><span style="color: #000000;">Hmm 😃 !! you have successfully added the Windows system as a client. </span><span style="color: #000000;">Now, We have successfully added both Machines that will be monitored by Velociraptor server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-K04vWaSUuNg/X273u_SzoTI/AAAAAAAAo4o/iCMLnMhUZJQedfGpV2C9TdLBQVvf3-LjQCLcBGAsYHQ/s16000/15.png"/></span></p>
<h3><span style="color: #800000;">Forensic Investigation / Threat Hunting </span></h3>
<p><span style="color: #000000;">Let’s begin some forensics investigation or Threat Hunting</span></p>
<p><span style="color: #000000;">Now if you go back to the homepage you could be able to see your host by searching in the filter box </span></p>
<p><span style="color: #000000;">As we have 2 clients connected to velociraptor </span></p>
<h5><span style="color: #000000;"><strong>Let’s start an investigation with Machine-1 (Ubuntu) !!</strong></span></h5>
<p><span style="color: #000000;">So now we have Hunt Manager you can easily find it on your Dashboard</span></p>
<p><span style="color: #000000;">Hunt manager allows you to hunt for the specific events that happened to your client and also you can view specific artifacts and server events.</span></p>
<p><span style="color: #000000;">we need to create a hunt with specific artifacts to do this move your cursor to the <strong>“+”</strong> button and select it as shown below.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-9L3N6Ndq7yc/X2731F_dbXI/AAAAAAAAo4s/87Q2njDbNBkEdfd0Fi7vweP3N0nT4IQggCLcBGAsYHQ/s16000/16.png" alt="Velociraptor for Endpoint Monitoring" width="660" height="377"/></span></p>
<p><span style="color: #000000;">To create a new hunt in the search window start typing Linux then select the artifacts that you want to hunt and add then select <strong>“Next”</strong>,</span></p>
<p><span style="color: #000000;">Some prebuilt Artifacts can be used for forensics of Linux systems Available on Velociraptor as listed below</span></p>
<pre class="lang:default decode:true">Linux.Applications.Chrome.Extensions
Linux.Applications.Chrome.Extensions.Upload
Linux.Applications.Docker.Info
Linux.Applications.Docker.Version
Linux.Debian.AptSources
Linux.Debian.Packages
Linux.Mounts
Linux.OSQuery.Generic
Linux.Proc.Arp
Linux.Proc.Modules
Linux.Search.FileFinder
Linux.Ssh.AuthorizedKeys
Linux.Ssh.KnownHosts
Linux.Ssh.PrivateKeys
Linux.Sys.ACPITables
Linux.Sys.BashShell
Linux.Sys.CPUTime
Linux.Sys.Crontab
Linux.Sys.LastUserLogin
Linux.Sys.Maps
Linux.Sys.Pslist
Linux.Sys.SUID
Linux.Sys.Users
Linux.Syslog.SSHLogin</pre>
<p><span style="color: #000000;">In my case, I’m selecting Linux.Sys.SUID, Linux.Syslog.SSHLogin you can select as much you want.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FeeGWIGufmE/X273_ucFuUI/AAAAAAAAo44/mfAJ2OtCChQrDmfztQmuRnJeJwlyA7sDACLcBGAsYHQ/s16000/17.png"/></span></p>
<p><span style="color: #000000;">After selecting next, it will redirect to next prompt where you need to give Hunt Description and then select <strong>“Next”</strong></span></p>
<p><span style="color: #000000;">Hunt conditions should be in “<strong>operating system” </strong>select it in the drop-down menu of Include Condition then select Target OS <strong>“Linux” </strong>and then hit <strong>“Next”</strong></span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-17y0com3zA8/X274HmTDfCI/AAAAAAAAo5A/tQdLM_oVfLUO0-1EiPIb1QFghlsOMKEgwCLcBGAsYHQ/s16000/18.png" alt="Velociraptor for Endpoint Monitoring" width="701" height="349"/></span></p>
<p><span style="color: #000000;">At the next screen, you have your hunt Description or Artifact review, now a select the option <strong>“Create Hunt”</strong></span></p>
<p><span style="color: #000000;">Now we have created a new Hunt Named Linux Hunt it reflects on our Hunts panel And We would like to run this hunt by pressing the play button to see what’s next in the result…</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0VNhnjT3AdY/X274Qd8YPoI/AAAAAAAAo5I/AsDaZI1dln4RLJltKRMwial3NCkaAJQBwCLcBGAsYHQ/s16000/19.png"/></span></p>
<p><span style="color: #000000;">Wow 🙄 !! As we can see here is the list of Linux system SUID</span></p>
<h5><strong><span style="color: #000000;">Simulating and Detecting SSH Brute-Force Attack</span></strong></h5>
<p><span style="color: #000000;">Wait this is not enough… Let’s Dig it more Deeper </span></p>
<p><span style="color: #000000;">Let’s take SSH of Linux client from Putty and perform a Brute-force attack from Attacker machine Kali Linux </span></p>
<p><span style="color: #000000;">Exited? let’s do it 😉 !! </span></p>
<p><span style="color: #000000;">open Putty and enter the IP and port no. of the client and open the session </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iAGjWnpgBAs/X274ckDqKeI/AAAAAAAAo5Q/Vb7_Hghbi5E6-QcJ7NiQG_ql8_J03YVWwCLcBGAsYHQ/s16000/20.png"/></span></p>
<p><span style="color: #000000;">After the opening of the SSH shell login to the Client machine</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-ERvaLOiKHP8/X274lK7yhdI/AAAAAAAAo5Y/IRBUEYZcxXAfEtlePO18bO-a0kmiQQBBgCLcBGAsYHQ/s16000/21.png" alt="Velociraptor for Endpoint Monitoring" width="645" height="413"/></span></p>
<p><span style="color: #000000;">Nice !! we have successfully logged in to the client machine  </span><span style="color: #000000;">Let’s perform a Brute-force attack to check is Velociraptor able to detect the attack or not. </span><span style="color: #000000;">Fire up the Attacker machine Kali Linux and run the following command </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hydra -l raj -P pass.txt 192.168.0.196 ssh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xJ5aX81JOj8/X274tnrf6hI/AAAAAAAAo5g/iQM6Tz8_utYlV3IN94vUlXcUbPsp2-1fgCLcBGAsYHQ/s16000/22.png"/></span></p>
<p><span style="color: #000000;">Let’s check what happened to the GUI interface of Velociraptor.</span></p>
<p><span style="color: #000000;">Hold tight !!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fDtOj0YaKRA/X2741WB0eRI/AAAAAAAAo5k/oDUubV9N6nUixcDVIrCguk-BKHIxyjfrACLcBGAsYHQ/s16000/23.png"/></span></p>
<p><span style="color: #000000;">wow !! As we can see it detects and shows 2 successful logins of different machines and 5 failed login attempts just because of Brute force Attack. </span><span style="color: #000000;">Let’s check some more artifacts that show the Arp requests and Linux system users.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kT1fSauSjXo/X274-7uR2-I/AAAAAAAAo5s/CtAiLdl3U6UHAyXYgQsWFeaJj-bpAeDJwCLcBGAsYHQ/s16000/24.png"/></span></p>
<p><span style="color: #000000;">After creating the Hunt go to the result section and check what happens there…</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KNlqY-_G0qw/X275JQIVIaI/AAAAAAAAo50/cfGayFKwzqIi5EF83p227F4ZiS-idAJJACLcBGAsYHQ/s16000/25.png"/></span></p>
<p><span style="color: #000000;">As we can see it shows All Linux system users with their “UID” and a small description of the role of users.</span></p>
<p><span style="color: #000000;">Let’s check the “ARP” requests on the client </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uFKJlv2mIlM/X275RjW_-bI/AAAAAAAAo58/Hcs4r21wp1gSyRwqFJD1rL8Mp8pnDPUyQCLcBGAsYHQ/s16000/26.png"/></span></p>
<p><span style="color: #000000;">Wow 😱 !! it contains quite enough useful information.</span></p>
<p><span style="color: #000000;">Based on these artifacts you can investigate the scene or your client by creating Hunt as per your requirements also you can create your artifacts if you have good knowledge of VQL.</span></p>
<h5><strong><span style="color: #000000;">Creating and Running Windows Hunt</span></strong></h5>
<p><span style="color: #000000;">Let’s investigate our Windows client !! 🙂</span></p>
<p><span style="color: #000000;">Form Dashboard set the host to windows or whatever the client’s computer name.</span></p>
<p><span style="color: #000000;">Then create a Hunt </span></p>
<p><span style="color: #000000;">I’m going to use Artifact “<strong>Windows.Sys.FirewallRules</strong>”</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-ZhPVyfFmooo/X275dmHXwHI/AAAAAAAAo6E/CZa07KWga7QzwbcCtbe7fj_mbDgrYonoACLcBGAsYHQ/s16000/27.png" alt="Velociraptor for Endpoint Monitoring" width="849" height="489"/></span></p>
<p><span style="color: #000000;">After selecting next it redirects you to next prompt when you need to Hunt Description and then select <strong>“Next”</strong></span></p>
<p><span style="color: #000000;">Hunt conditions should be in “<strong>operating system” </strong>select it in the drop-down menu of Include Condition then select Target OS <strong>“Windows” </strong>and then hit <strong>“Next”</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZhPVyfFmooo/X275dmHXwHI/AAAAAAAAo6E/CZa07KWga7QzwbcCtbe7fj_mbDgrYonoACLcBGAsYHQ/s16000/27.png"/></span></p>
<p><span style="color: #000000;">Now we have created a new Hunt Named Windows Hunt it reflects your Hunts panel And We would like to run this hunt by pressing the play button to see what’s next in the result…</span></p>
<p><span style="color: #000000;">Let’s check the result. </span><span style="color: #000000;">Hold tight !!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lgJPC-T9mZY/X2758OuJOLI/AAAAAAAAo6c/xYuZQdWcgCIOsSGZRWS8Ma057rYLKHy8ACLcBGAsYHQ/s16000/29.png"/></span></p>
<p><span style="color: #000000;">Let’s check the result. </span><span style="color: #000000;">Hold tight !!</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-mX9PFhz24_o/X276IbxWQZI/AAAAAAAAo6k/QOrk_PiPTRcwZGdXKL33k4HoKrwZHR8TQCLcBGAsYHQ/s16000/30.png" alt="Velociraptor for Endpoint Monitoring" width="892" height="669"/></span></p>
<p><span style="color: #000000;">Nice !! Here is the list of implemented Firewall Rule on the Client’s machine.</span></p>
<p><span style="color: #000000;"> Let’s check out some more artifacts to dig it deeper.</span></p>
<p><span style="color: #000000;">Create a new hunt and add many artifacts as you want. Here I’m going to use “Windows.Collectors.File”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Cjurq72vyow/X276S7gOPTI/AAAAAAAAo6s/OyF1CCNmcV41UYhVBRkb2xi0EP1nPe17QCLcBGAsYHQ/s16000/31.png"/></span></p>
<p><span style="color: #000000;">Let’s check what comes in result…..</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oJU9If0ouyQ/X276coZAkkI/AAAAAAAAo60/IYkNB1eSJaoA3-ZKChWT_d4bEUIBbMYGwCLcBGAsYHQ/s16000/32.png"/></span></p>
<p><span style="color: #000000;">Wow!! As we can see it listed the All matches Metadata of windows.collectors</span></p>
<p><span style="color: #000000;">Similarly, you can Dig it much Deeper by adding as many artifacts as you need</span></p>
<p><span style="color: #000000;">Hang tight this is not enough!</span></p>
<p><span style="color: #000000;">More will be discussed in part3.</span></p>
<p><span style="color: #000000;"><strong>Author – </strong>Vijay is a Certified Ethical Hacker, Technical writer and Penetration Tester at Hacking Articles. Technology and Gadget freak. Contact <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/vijay-igcbr/">Here</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
