<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/command-and-control/" rel="category tag">Command and Control</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Command &amp; Control: WebDav C2</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/command-control-webdav-c2/" rel="bookmark"><time class="entry-date published" datetime="2019-04-14T07:55:05+00:00">April 14, 2019</time><time class="updated" datetime="2025-05-12T17:58:06+00:00">May 12, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This article explores using WebDAV for covert Command and Control (C2) channels, enabling attackers to maintain persistent access.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;">Introduction</span></li>
<li><span style="color: #000000;">Installation</span></li>
<li><span style="color: #000000;">Exploiting Target</span></li>
<li><span style="color: #000000;">Command Execution</span></li>
</ul>
<h3><span style="color: #000000;"><span style="color: #800000;">Introduction  </span></span></h3>
<p><span style="color: #000000;">WebDavC2 uses the WebDAV protocol with PROPFIND only requests to serve as a C2 communication channel between an agent, running on the target system, and a controller acting as the actual C2 server. This tool is developed using python. The credit for developing this tool goes to <a style="color: #000000;" href="https://twitter.com/Arno0x0x">Arno0x0x</a>.</span></p>
<p><span style="color: #000000;">The controller that makes up <strong data-start="29" data-end="41">WebDavC2</strong> functions as the <strong data-start="59" data-end="65">C2</strong> server. Additionally, it includes an agent developed in <strong data-start="122" data-end="128">C#</strong> or <strong data-start="132" data-end="140">.NET</strong> that runs on the target system. Several initial stagers deliver the agent to the target system. Moreover, the system includes various types of initial stagers, which the controller creates when it starts up and uses for the initial compromise of the target system.</span></p>
<p><span style="color: #000000;">For this particular demonstration,</span></p>
<p><span style="color: #000000;"><strong>Attacker:</strong> Kali Linux</span></p>
<p><span style="color: #000000;"><strong>Target:</strong> Windows 10</span></p>
<h3><span style="color: #800000;">Installation</span></h3>
<p><span style="color: #000000;">To begin, first we need the tool on our Attacker Machine. To do this, we will clone the tool directly from the GitHub.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/Arno0x/WebDavC2</pre>
<p><img decoding="async" src="https://2.bp.blogspot.com/-43m_z-edtRM/XLLlZejnpcI/AAAAAAAAeA0/MCkdClhT_-QWe1Ve4KTT4w2id-v6teyfgCLcBGAs/s1600/1.png"/></p>
<p><span style="color: #000000;">After running the above command, we would have a directory created by the name of WSC2. Now, we will traverse inside that directory using the cd command. Let’s see the contents of the directory that we just cloned using the ls command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd WebDavC2/
ls
chmod +x webdavC2.py</pre>
<p><img decoding="async" class="alignnone" src="https://3.bp.blogspot.com/-FehtpKlr0Ek/XLLlZKDB_iI/AAAAAAAAeAs/OW69asvIEdMiTngSz25KElWZ-1BispxZQCLcBGAs/s1600/2.png" alt="WebDAV Command and Control" width="576" height="74"/></p>
<h4><span style="color: #000000;">Exploiting Target</span></h4>
<p><span style="color: #000000;">As we run the tool, we are greeted with a cool looking banner as shown in the given below. Followed by some details about the Author and Version and tool. After this it will create multiple stagers in Batch, Macro and Jscript as shown in the figure below. It also starts an WebDav Server at the IP provided at port 80.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python webdavC2.py</pre>
<p><img decoding="async" src="https://2.bp.blogspot.com/-LiBqQwk7uVc/XLLlZB7ELLI/AAAAAAAAeAw/MXgjo2GdKFYMWZ5Ch-Xzz6tFLAtE6OAAQCLcBGAs/s1600/3.png"/></p>
<p><span style="color: #000000;">Now we have to send the files to the target. For this we will open a new terminal and traverse inside the stagers directory. Here as we can see that we have multiple stagers. Let’s try to open the batch file, here we see that the PowerShell batch file in encrypted. Now we will sent these stagers to the target using the python server.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd stagers/
ls
cat stager.bat
python -m SimpleHTTPServer 80</pre>
<p><img fetchpriority="high" decoding="async" class="alignnone" src="https://4.bp.blogspot.com/-SdNGSQaCd54/XLLlaMjfI_I/AAAAAAAAeA8/UJMLeBUf4Dw82DP6fVIDmSXV9H0xavsdgCLcBGAs/s1600/4.png" alt="WebDAV Command and Control" width="744" height="363"/></p>
<h3><span style="color: #800000;">Command Execution</span></h3>
<p><span style="color: #000000;">After the stager is executed, we are provided with a prompt to run commands. Here we run the command systeminfo. And we have the system information of the target as shown in the given image.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">systeminfo</pre>
<p><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-DtUF17vCrEA/XLLlaOkBa4I/AAAAAAAAeBA/-ZjIaJ9wOx0cZ-J1jqXwmIOUxrvJQxsOwCLcBGAs/s1600/5.png" alt="WebDAV Command and Control" width="608" height="291"/></p>
<p><span style="color: #000000;">To learn more about <strong>Command and Control</strong>. Follow this <strong><a href="https://www.hackingarticles.in/category/red-teaming/command-and-control/">Link.</a></strong></span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester Contact</span> <strong><a href="https://www.linkedin.com/in/pavandeep-singh-6b1074132" target="_blank" rel="noopener noreferrer" data-saferedirecturl="https://www.google.com/url?q=https://www.linkedin.com/in/pavandeep-singh-6b1074132&amp;source=gmail&amp;ust=1542651210170000&amp;usg=AFQjCNEYOzlThg6B1HzKcEZNou4HowCJ2Q">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
