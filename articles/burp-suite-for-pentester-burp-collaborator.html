<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/website-hacking/burp-suite/" rel="category tag">Burp Suite</a>, <a href="https://www.hackingarticles.in/category/website-hacking/" rel="category tag">Website Hacking</a></span>            </div>
            <h1 class="post-title entry-title">Burp Suite for Pentester: Burp Collaborator</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/burp-suite-for-pentester-burp-collaborator/" rel="bookmark"><time class="entry-date published" datetime="2020-12-23T15:34:30+00:00">December 23, 2020</time><time class="updated" datetime="2025-06-13T11:06:15+00:00">June 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;"><em>A number of vulnerabilities exist on the web, but the majority of them are not triggered directly. This is because they do not produce any specific output or error. However, is the output or error the only way to determine whether the vulnerability exists or not?</em></span></p>
<p class="ai-optimize-7"><span style="color: #000000;">So, today in this article of the series of Burp Suite for Pentester, you’ll learn how to detect out-of-band or blind vulnerabilities using one of the most amazing features of Burp Suite, i.e., Burp Collaborator.</span></p>
<h3 class="ai-optimize-8"><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li class="ai-optimize-9"><strong><span style="color: #000000;">Introduction to Burp Collaborator</span></strong></li>
<li class="ai-optimize-10"><strong><span style="color: #000000;">Detecting vulnerabilities with Collaborator Client</span></strong>
<ul>
<li class="ai-optimize-11"><span style="color: #000000;">Blind Remote Command Execution</span></li>
<li class="ai-optimize-12"><span style="color: #000000;">Cross-Site Scripting Detection</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">Blind XXE</span></li>
<li class="ai-optimize-14"><span style="color: #000000;">Server-Side Request Forgery</span></li>
<li class="ai-optimize-15"><span style="color: #000000;">Fuzzing for SSRF Detection</span></li>
</ul>
</li>
</ul>
<h3 class="ai-optimize-16"><span style="color: #800000;">Introduction to Burp Collaborator</span></h3>
<p class="ai-optimize-17"><span style="color: #000000;">Burp Suite’s Professional edition offers one of its best features: “Burp Collaborator.” This feature helps users determine or detect vulnerabilities that interact with external services but do not cause any noticeable difference in the content of the application’s responses when they inject specific payloads.</span></p>
<p class="ai-optimize-18"><span style="color: #000000;">In simpler terms, this collaborator essentially serves as a network service that Burp Suite uses to detect out-of-band vulnerabilities. It works by injecting payloads into the application and then waits for the response to analyze any unusual behaviors.</span></p>
<p class="ai-optimize-19"><span style="color: #000000;">Being a network service, Burp Collaborator operates seamlessly with both a server and a client to fetch the hidden responses made by the application. So, let’s take a deep dive with what these server and clients are, and where we can find them.</span></p>
<h5 class="ai-optimize-20"><strong><span style="color: #000000;">Burp Collaborator Server </span></strong></h5>
<p class="ai-optimize-21"><span style="color: #000000;">Burp Suite uses the Burp collaborator server as a service while auditing or testing vulnerable web applications to find sections that interact with an external system. However, this Burp server only responds to the interactions it receives from the other systems by continuously polling its client to determine whether any of its payloads have triggered interactions or not.</span></p>
<p class="ai-optimize-22"><span style="color: #000000;">By default, Burp uses the <strong><em>public Collaborator Server</em></strong> provided by PortSwigger, but it even offers the feature to host or <strong><em>deploy a private Collaborator Server</em></strong> too. Thereby, in order to modify the server configuration, simply head to the <strong>Project option</strong> and then switch to the <strong>Misc tab</strong> there.</span></p>
<p class="ai-optimize-23"><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-7_oZ0DQEGCY/X-NaHvJRBcI/AAAAAAAAr-E/yNyYI9Acf6w2PXu4WAnQcNQonLNzqZUzwCLcBGAsYHQ/s16000/1.png" alt="Burp Suite Burp Collaborator" width="602" height="405"/></span></p>
<p class="ai-optimize-24"><span style="color: #000000;">However, for this section, we’ll be using the default collaborator server. But before following up further, let’s do a <strong>health check </strong>by hitting the <strong>Run heath check</strong> button in order to be sure that our collaborator is working properly.</span></p>
<p class="ai-optimize-25"><span style="color: #000000;">Great from the below image we can see that our collaborator server has passed all the tests.</span></p>
<p class="ai-optimize-26"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qYtRfPea0pw/X-NaQikHAqI/AAAAAAAAr-I/bL1YmSgg-DcCwr2gUXPFQIPU4DZg4DlzQCLcBGAsYHQ/s16000/2.png"/></span></p>
<h5 class="ai-optimize-27"><span style="color: #000000;"><strong>Burp Collaborator Client</strong></span></h5>
<p class="ai-optimize-28"><span style="color: #000000;">Burp Collaborator Client is a tool to make use of the Collaborator server during manual testing. This collaborator client helps us to generate payloads such that we can use them over at the injection points in the vulnerable applications with Burp’s Intruder or Repeater.</span></p>
<p class="ai-optimize-29"><span style="color: #000000;">However, with this client, we can even poll the collaborator server when there seems to be a network interaction with the injected payload.</span></p>
<p class="ai-optimize-30"><span style="color: #000000;">The Burp Collaborator Client resides within the <strong>Burp tab</strong> at the top left section, as shown in the image.</span></p>
<p class="ai-optimize-31"><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-XZVtZSieQcg/X-NaVpvqK-I/AAAAAAAAr-M/m35TMRDkOUwwxLqtGL_qLXCq37xtVv1NQCLcBGAsYHQ/s16000/3.png" alt="Burp Suite Burp Collaborator" width="614" height="423"/></span></p>
<p class="ai-optimize-32"><span style="color: #000000;">As we move forward by hitting the Client option, we will be redirected to a new window. This window is the <strong>Collaborator client</strong>. Dropping several options within it, there are two important ones – Copy to clipboard; &amp; Poll.</span></p>
<p class="ai-optimize-33"><span style="color: #000000;"><em>As the name suggests, the “<strong>Copy to Clipboard</strong>” option simply copies the generated payload(s), allowing us to paste them wherever needed. On the other hand, the “<strong>Poll Now</strong>” option enables us to poll the server immediately, rather than waiting for the default time of <strong>60</strong>.</em></span></p>
<p class="ai-optimize-34"><span style="color: #000000;">Nevertheless, the “Number to Generate” and “Poll Every” options are also important. In the “Number to Generate” section, we can modify the number of payloads to be generated, ranging between 1-10. This helps when performing fuzzing. On the other hand, if performance is not a concern, we can reduce the time (in seconds) in the “Poll Every” option. This will automatically poll at a quicker interval.</span></p>
<p class="ai-optimize-35"><span style="color: #000000;"><em> <img decoding="async" src="https://1.bp.blogspot.com/-_ccEmcqqs08/X-NalEn1hiI/AAAAAAAAr-Y/jUKenZtEfKANLmvb-ap9k42dWvAtjWHpgCLcBGAsYHQ/s16000/4.png"/></em></span></p>
<h3 class="ai-optimize-36"><span style="color: #800000;"><strong>Detecting vulnerabilities with Collaborator Client</strong></span></h3>
<p class="ai-optimize-37"><span style="color: #000000;">Up till now, you might have had a clear vision about what Burp Collaborator is and its client, and where to find them. So, let’s use this amazing feature to have some practical exposure by detecting and finding the most crucial out-of-band vulnerabilities.</span></p>
<h4 class="ai-optimize-38"><span style="color: #000000;">Blind Remote Command Injection</span></h4>
<p class="ai-optimize-39"><span style="color: #000000;">Remote Command Injection, or OS Injection, is a vulnerability in which the attacker tries to perform system-level commands directly through a vulnerable application to retrieve information from the web server.</span></p>
<p class="ai-optimize-40"><span style="color: #000000;"><em>But there are times when the results of the injected commands are not displayed back at the application, and even the error messages are not returned. So, does the command injection exist in such a situation?</em></span></p>
<p class="ai-optimize-41"><span style="color: #000000;">Let’s find out!!</span></p>
<h5 class="ai-optimize-42"><strong><span style="color: #000000;">Setting Up the Target</span></strong></h5>
<p class="ai-optimize-43"><span style="color: #000000;">Head to the bWAPP vulnerable application and opt <span style="box-sizing: border-box; margin: 0px; padding: 0px;">for <strong>OS Command Injection—Blind</strong></span> by setting the security level to low.</span></p>
<p class="ai-optimize-44"><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-q6szesdXdEE/X-Naxoh91TI/AAAAAAAAr-c/j-_zhYDMYMch6PAbjiHBlYd-zj3WhEYJQCLcBGAsYHQ/s16000/26.png" alt="Burp Suite Burp Collaborator" width="761" height="432"/></span></p>
<p> </p>
<p class="ai-optimize-45"><span style="color: #000000;">Over there, as we tried to ping our local machine with <strong>“127.0.0.1”</strong>, we didn’t get any output neither any error, just we got a message <strong>“Did you captured our GOLDEN packet?”.</strong> </span></p>
<p class="ai-optimize-46"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Eyqh3buiPKQ/X-Na3cNm68I/AAAAAAAAr-k/Anw93ILje54H8rbFLrhgcVcBm1N1w2PVgCLcBGAsYHQ/s16000/27.png"/></span></p>
<p class="ai-optimize-47"><span style="color: #000000;">So, with this output, we can’t determine whether the application is suffering from OS command Injection or not.</span></p>
<p class="ai-optimize-48"><span style="color: #000000;">Thereby, in order to confirm this, we’ll be using the Burp collaborator, which will pop out the response if the application somewhere or the other tries to interact with any other external service(DNS; HTTP; SMTP).</span></p>
<p class="ai-optimize-49"><span style="color: #000000;">Let’s <strong>copy the collaborator payload</strong> by navigating to Burp at the dashboard and then opting for Burp Collaborator Client.</span></p>
<p class="ai-optimize-50"><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-ooDwnCuTHHA/X-Na9R8EDxI/AAAAAAAAr-o/bOI6uDdmYlMiblbYcakNyzLnxw1Sug-hACLcBGAsYHQ/s16000/28.png" alt="Burp Suite Burp Collaborator" width="696" height="423"/></span></p>
<h5 class="ai-optimize-51"><strong><span style="color: #000000;">Testing with Burp Collaborator</span></strong></h5>
<p class="ai-optimize-52"><span style="color: #000000;">Now this time we’ll modify the input value, i.e., along with the IP we’ll inject the collaborator payload too, and will hit the <strong>“Ping” </strong>button</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">127.0.0.1|nslookup &lt;Burp Collaborator copied payload&gt;</pre>
<p class="ai-optimize-53"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4bdkyA71L8Q/X-NbIjz3eDI/AAAAAAAAr-0/rzlLpCzMxk4zhGZPe7Uy4BDWXwQRhh6qQCLcBGAsYHQ/s16000/29.png"/></span></p>
<p class="ai-optimize-54"><span style="color: #000000;">As soon as the page reloads, we still see the same output, but over at the Burp Collaborator Client’s window, new entries fill in as we hit <span style="box-sizing: border-box; margin: 0px; padding: 0px;">the <strong>Poll</strong></span><strong> now </strong>button. Let’s check them out.</span></p>
<p class="ai-optimize-55"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EUaipbubykY/X-NbOBrdobI/AAAAAAAAr-8/JjYRlnpbgM8DNlDEw25d3EpgeLUZqS9NACLcBGAsYHQ/s16000/30.png"/></span></p>
<p class="ai-optimize-56"><span style="color: #000000;">With the first response, we could notice that the application used the <strong>DNS service</strong> as the payload was bound with the <strong>nslookup </strong>command. Thereby this confirms that the web-page is vulnerable to OS Command Injection.</span></p>
<p class="ai-optimize-57"><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-erjc4dnq1qc/X-NbZMuyFyI/AAAAAAAAr_E/Uq_uhXpT88oNjQD-NmJKRAzwhENjA6YrQCLcBGAsYHQ/s16000/31.png" alt="Burp Suite Burp Collaborator" width="701" height="274"/></span></p>
<h4 class="ai-optimize-58"><span style="color: #000000;">Cross-Site Scripting Detection</span></h4>
<p class="ai-optimize-59"><span style="color: #000000;">Malicious scripts inject themselves into trusted websites in a client-side code injection attack known as Cross-Site Scripting, and these scripts trigger when the user visits the specific suffering web page.</span></p>
<p class="ai-optimize-60"><span style="color: #000000;"><em>But many times, we never know where our injected payload will end up or when it will be executed. </em></span></p>
<p class="ai-optimize-61"><span style="color: #000000;">To determine whether our payload executes or an external service triggers it, we’ll use Burp Collaborator, which dumps the responses in the client window as soon as it gets hit.</span></p>
<h5 class="ai-optimize-62"><strong><span style="color: #000000;">Setting Up the Target</span></strong></h5>
<p class="ai-optimize-63">By initiating back into the bWAPP application and opting for the XSS – Stored (User-Agent), we’ll thus see that our user-agent value stores itself into the database.</p>
<p class="ai-optimize-64"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-T2v8eoVxquw/X-NbgJyIL1I/AAAAAAAAr_M/ZXsk3wtIhi0fUnsqqkCcjUeWDQw97FooACLcBGAsYHQ/s16000/45.png"/></span></p>
<p> </p>
<p class="ai-optimize-65"><span style="color: #000000;">Now, turn ON the browser’s poxy and head to the Burpsuite’s Proxy tab, and capture the ongoing HTTP Request.</span></p>
<p class="ai-optimize-66"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3fH0A0923Xg/X-NbmJzmgpI/AAAAAAAAr_Q/fFw0AyQ3aOcxAmQpN09_zeRBfCsMQE2wQCLcBGAsYHQ/s16000/46.png"/></span></p>
<p class="ai-optimize-67"><span style="color: #000000;">So, in order to manipulate this User-Agent, let’s first copy the Collaborator payload by moving the Collaborator Client window.</span></p>
<p class="ai-optimize-68"><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-GccHq5gY1Nk/X-NbsVllI4I/AAAAAAAAr_U/fUPziWNasfQEZZBtZ36Tq4t_sZnQXnZVACLcBGAsYHQ/s16000/47.png" alt="Burp Suite Burp Collaborator" width="649" height="398"/></span></p>
<p class="ai-optimize-69"><span style="color: #000000;">Back into the proxy tab &amp; <strong>modify the User-Agent</strong> with the image tag and hit the <strong>forward button.</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;img src="http://copied_payload_value"&gt;</pre>
<p class="ai-optimize-70"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--_olIWCef4M/X-Nb3rzqVeI/AAAAAAAAr_c/k61XSV-QbOQV5GEyzU-hMSWLQFBN_bBewCLcBGAsYHQ/s16000/48.png"/></span></p>
<h5 class="ai-optimize-71"><span style="color: #000000;">Confirming the XSS Vulnerability</span></h5>
<p class="ai-optimize-72"><span style="color: #000000;">As soon as we do so, we got the alteration in our Client window, the burp payload has been triggered by an external service, which thus confirms that there is a Cross-Site Scripting exists up.</span></p>
<p class="ai-optimize-73"><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-7cqr88RZMUU/X-Nb-kJkJHI/AAAAAAAAr_k/ZIRiESe_kn4LD-QPLkFtKGV9BPpfxVH6wCLcBGAsYHQ/s16000/49.png" alt="Burp Suite Burp Collaborator" width="663" height="451"/></span></p>
<p class="ai-optimize-74"><span style="color: #000000;"><strong>NOTE –</strong></span></p>
<p class="ai-optimize-75"><span style="color: #000000;"><em>However, this is a basic demonstration since the vulnerable application has been hosted locally. In real-life scenarios, it takes more time for the administrator or developer to execute the attack, as many applications store user-agent information in their databases. In order to explore more about Blind XSS exploitation, visit our previous article from <strong><a style="color: #000000;" href="https://www.hackingarticles.in/cross-site-scripting-exploitation/">here</a></strong>.</em></span></p>
<h4 class="ai-optimize-76"><span style="color: #000000;">Blind XXE</span></h4>
<p class="ai-optimize-77"><span style="color: #000000;">XML External Entity (XXE) attacks are becoming increasingly common today, as nearly every application handles and parses XML inputs. However, most of these attacks are blind, as the improperly configured XML parser processes the malicious content without rendering it directly on the visitor’s screen.</span></p>
<p class="ai-optimize-78"><span style="color: #000000;"><em>But these Blind XXE vulnerabilities can be encountered with some great tools, I hope you’re getting me. Yes, Burp Collaborator, it can even detect the blind XXE triggered.</em> Let’s check it out how.</span></p>
<h5 class="ai-optimize-79"><span style="color: #000000;"><strong>Step 1: Access the Lab</strong></span></h5>
<p class="ai-optimize-80"><span style="color: #000000;">Login into the <strong>PortSwigger academy</strong> and drop down till <strong>XML external entity (XXE) injection </strong>and further choose the lab as “<strong>Blind XXE with out-of-band interaction” </strong>and hit <strong>“Ac</strong></span>cess the lab” button.</p>
<p class="ai-optimize-81"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-znCHjJvKsaM/X-NcHwM78HI/AAAAAAAAr_s/f5Bs84qrJMMoKrSZigpJi86XR1eskFsKgCLcBGAsYHQ/s16000/100.png"/></span></p>
<h5 class="ai-optimize-82"><strong><span style="color: #000000;">Step 2: Exploring the E-commerce Webpage</span></strong></h5>
<p class="ai-optimize-83"><span class="">There as we do so, we’ll be redirected to an e-commerce web-page; let’s check out the details of the <strong>“V</strong>intage Neck defender”.</span></p>
<p class="ai-optimize-84"><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-RLwxPx0i8L4/X-NcNnr-vZI/AAAAAAAAr_w/A73qR5kK0uI6sFOeNWqFj34f9t_4Dgc_wCLcBGAsYHQ/s16000/101.png" alt="Burp Suite Burp Collaborator" width="669" height="548"/></span></p>
<h5 class="ai-optimize-85"><strong><span style="color: #000000;">Step 3: Capturing HTTP Request in Burp Suite</span></strong></h5>
<p class="ai-optimize-86"><span style="color: #000000;">Over in the details of the item, as we scroll down to the bottom, we got something like <strong>“Check Stock”. </strong>Seems to be suspicious, let’s turn ON our burpsuite monitor and capture the on-going HTTP Request for the Stock values.</span></p>
<p class="ai-optimize-87"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pkB_l5WUUq4/X-NcS3KWGqI/AAAAAAAAr_0/YGhxVJ1VW-wjD5msX8xYjsDe_1jucY8_wCLcBGAsYHQ/s16000/102.png"/></span></p>
<p class="ai-optimize-88"><span style="color: #000000;">And there we go; We got the XML queries that are dumping the data out of this.</span></p>
<p class="ai-optimize-89"><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-s77fWYJ1fcU/X-Ncchu3djI/AAAAAAAAr_4/bnVtn3HtSHkGwS6crihF8K2ctNj0gCtLACLcBGAsYHQ/s16000/103.png" alt="Burp Suite Burp Collaborator" width="600" height="486"/></span></p>
<h5 class="ai-optimize-90"><span style="color: #000000;">Step 4: Injecting Payload for XXE Detection</span></h5>
<p class="ai-optimize-91"><span style="color: #000000;">Time to modify the content and check for an XXE vulnerability, to detect let’s co</span>py the Collaborator payload value!!</p>
<p class="ai-optimize-93"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sEqNXkTSA6Y/X-Ncme1BVEI/AAAAAAAAsAE/otQKunJdTlAPb55CEyd4XSwwgSmpD2uOgCLcBGAsYHQ/s16000/104.png"/></span></p>
<h5 class="ai-optimize-94"><span style="color: #000000;">Step 5: Modifying the Request in the Repeater Tab</span></h5>
<p class="ai-optimize-95"><span style="color: #000000;">Now, let’s first share the request to the Repeater tab and then we’ll inject the copied payload into the XML data and call up the value within the productID</span> as shown in the below image  –</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;!DOCTYPE stockCheck [ &lt;!ENTITY xxe SYSTEM "http://payload_value_.burpcollaborator.net"&gt; ]&gt;</pre>
<p class="ai-optimize-96"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mZfO_s9dDhA/X-Ncxg7d5oI/AAAAAAAAsAI/5kAyIi_tyMwJaT1wQExA3pxJhMha4YnYwCLcBGAsYHQ/s16000/107.png"/></span></p>
<h5 class="ai-optimize-97"><span style="color: #000000;"><strong>Step 6: Sending the Request and Checking for Responses</strong></span></h5>
<p class="ai-optimize-98"><span style="color: #000000;">Now, as soon as we hit the <strong>“Send” </strong>button we got the response in the Repeater tab.</span></p>
<p class="ai-optimize-99"><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-aOR-T5M4bNs/X-Nc3J04uhI/AAAAAAAAsAQ/8mO8gKJcHBYhn2Z_s8TWr39Wkhk4xAtsQCLcBGAsYHQ/s16000/108.png" alt="Burp Suite Burp Collaborator" width="868" height="481"/></span></p>
<p class="ai-optimize-100"><span style="color: #000000;"><em>But wait, it’s an error an <strong>“Invalid Product ID”</strong>!! Now what?</em></span></p>
<p class="ai-optimize-101"><span style="color: #000000;">Let’s check out the collaborator, did the request hit at the background or not. And there it is, this time, not only the DNS but also an HTTP service has also been triggered.</span></p>
<p class="ai-optimize-102"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CuNDtgLHA9U/X-NdC30XpgI/AAAAAAAAsAY/NKlURQ17hO8xUSJNOrU_qmxXG4tShk9kQCLcBGAsYHQ/s16000/109.png"/></span></p>
<h5 class="ai-optimize-103"><strong><span style="color: #000000;">Step 7: Checking the HTTP Response</span></strong></h5>
<p class="ai-optimize-104"><span style="color: #000000;">Let’s take a look at the HTTP response. There it offers us a Request and a Response from the collaborator.</span></p>
<p class="ai-optimize-105"><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-HQLPS7g9-ig/X-NdeOdVS1I/AAAAAAAAsAs/ecNkbQdqRxMgpgonz3lZGk2-cjzgZqIeACLcBGAsYHQ/s16000/110.png" alt="Burp Suite Burp Collaborator" width="555" height="398"/></span></p>
<p class="ai-optimize-106"><span style="color: #000000;">Over in the request tab as the host has been modified, thereby over in the response, we got the section injected into the HTML which confirms the detection and exp</span>loitation of the XXE vulnerability.</p>
<p class="ai-optimize-107"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YSGcpQ2arwE/X-NdmfDP_wI/AAAAAAAAsAw/8CYLA16977E7buSlVGDkOHqpjtLtvzfagCLcBGAsYHQ/s16000/111.png"/></span></p>
<h4 class="ai-optimize-108"><span style="color: #000000;">Server-Side Request Forgery</span></h4>
<p class="ai-optimize-109"><span style="color: #000000;"><strong>SSRF</strong> or <strong>S</strong>erver-<strong>S</strong>ide <strong>R</strong>equest <strong>F</strong>orgery is the most crucial web-application vulnerability where the attacker can use the vulnerable application to send a <strong>crafted HTTP Request</strong> to a third-party server or application to <strong>fetch internal </strong>information, banners, or open ports. However, most of the time, the response from the application comes in the form of an error. But there are instances where a possible SSRF occurs without any error, i.e., in a Blind scenario. In such cases, we can rely on our helpful tool, “Burp Collaborator.”</span></p>
<p class="ai-optimize-110"><span style="color: #000000;">Let’s start.</span></p>
<h5 class="ai-optimize-111"><strong><span style="color: #000000;">Accessing the Lab</span></strong></h5>
<p class="ai-optimize-112"><span style="color: #000000;">Back into the PortSwigger Academy, switch to Blind SSRF with out-of-band detection and hit the <strong>Access the lab</strong> button.</span></p>
<p class="ai-optimize-113"><span style="color: #000000;"><img decoding="async" class="yoast-text-mark" src="https://1.bp.blogspot.com/-2R3Yuj-tDeA/X-NdsDRUPaI/AAAAAAAAsA0/mSqtm8AuSfADHUFFbms10PnUArbJyOghgCLcBGAsYHQ/s16000/150.png"/></span></p>
<p class="ai-optimize-114"><span style="color: #000000;">As soon as we do so, we’ll be redirected back into the shop page, but this time content is somewhat different. Let’s check the second item within it.</span></p>
<p class="ai-optimize-115"><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-7ln-hcC9A0o/X-Ndzpt9kYI/AAAAAAAAsA8/soPP1FkUMfMJAPqP0F2qCNVqh7f_eQP3gCLcBGAsYHQ/s16000/151.png" alt="Burp Suite Burp Collaborator"/></span></p>
<p class="ai-optimize-116"><span style="color: #000000;">But before accessing the item, let’s turn our Burp monitor and capture the ongoing HTTP Requests for it, and as it captures them, we’ll throw it directly to the repeater.</span></p>
<p class="ai-optimize-117"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vuEV_Gb68IA/X-Nd-Azp_kI/AAAAAAAAsBE/Js7RhMDFXCgWtFOgAsIpg9tC3G3zPauEQCLcBGAsYHQ/s16000/152.png"/></span></p>
<h5 class="ai-optimize-118"><strong><span style="color: #000000;">Manipulating the Request</span></strong></h5>
<p class="ai-optimize-119"><span style="color: #000000;">Over in the request section, the referer value seems to be injectable let’s manipulate it.</span></p>
<p class="ai-optimize-120"><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-BGAZAMWNm2s/X-NeHsp4ffI/AAAAAAAAsBM/jWnQYCfboJgtsDnfOCCyaCWQnL4SqxaUACLcBGAsYHQ/s16000/153.png" alt="Burp Suite Burp Collaborator" width="709" height="468"/></span></p>
<p class="ai-optimize-121"><span style="color: #000000;">Back with the collaborator client window, copy the payload, and modify the referer with it.</span></p>
<p class="ai-optimize-122"><span style="color: #000000;"><img decoding="async" class="yoast-text-mark" src="https://1.bp.blogspot.com/-FIqM3QpHxAo/X-NeM2awtLI/AAAAAAAAsBQ/gvV7jn2i-PMdPWoiKpy5JGo5mn-gPJFRQCLcBGAsYHQ/s16000/154.png"/></span></p>
<p class="ai-optimize-123"><span style="color: #000000;">And there we go, as we hit the “Send” button, we received the 200 OK, but where is the output, is it vulnerable or did our payload trigger??</span></p>
<p class="ai-optimize-124"><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-a-bwP9qYn5M/X-Nebt1roOI/AAAAAAAAsBc/E2WUs39g2JsyLNgIwuujUhjq-lEWpya0wCLcBGAsYHQ/s16000/155.png" alt="&quot;&amp;gt;&lt;/span"/></span></p>
<p class="ai-optimize-125"><span style="color: #000000;">Back in the Collaborator client window, when we hit the “Poll Now” button, our responses appeared in front of us. This confirms that a possible SSRF vulnerability exists.</span></p>
<p class="ai-optimize-126"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jQHTTYJzi6w/X-NegXKvKHI/AAAAAAAAsBk/-N9-DsACn7c-1GbywejLCv2aD8_ZC13fwCLcBGAsYHQ/s16000/156.png"/></span></p>
<p class="ai-optimize-127"><span style="color: #000000;">Let’s open the browser again. Cool, the lab is cleared.</span></p>
<p class="ai-optimize-128"><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-zQ9ewmaffjM/X-NepZP3qiI/AAAAAAAAsBo/mbg9ZUAKAr8n7QbKLtlpRX0izEAiZOA4ACLcBGAsYHQ/s16000/157.png" alt="Burp Suite Burp Collaborator" width="750" height="349"/></span></p>
<h4 class="ai-optimize-129"><span style="color: #000000;">Fuzzing for SSRF Detection</span></h4>
<p class="ai-optimize-130"><span style="color: #000000;">Over in the previous section of PortSwigger’s lab, we’ve encountered the Blind SSRF with a single payload. <em>But what if the payload didn’t work ??</em></span></p>
<p class="ai-optimize-131"><span style="color: #000000;">Thereby, for such situations, we can fuzz the injection points in order to determine the SSRF’s crucial hit.</span></p>
<h5 class="ai-optimize-132"><span style="color: #000000;"><strong>Navigating to the Mutillidae Application</strong></span></h5>
<p class="ai-optimize-133"><span style="color: #000000;">Let’s move to the Mutillidae application and then we’ll navigate to <strong>OWASP 2017 | A1 – Injection</strong></span></p>
<p class="ai-optimize-134"><span style="color: #000000;"><strong>(Other) | Application Log Injection | DNS Lookup.</strong></span></p>
<p class="ai-optimize-135"><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-8n5SYYZxJdA/X-NevNa0PNI/AAAAAAAAsBw/6LPDEzVSdyI6nitYg_y5TkdDMgQEiiqbgCLcBGAsYHQ/s16000/300.png"/></strong></span></p>
<p class="ai-optimize-136"><span style="color: #000000;">As soon as we reach there, we got an input field to enter the IP Address, let’s enter the localhost IP.</span></p>
<p class="ai-optimize-137"><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-kA9nqNTtDoM/X-Ne0nxJMrI/AAAAAAAAsB0/1YLcuiKWJyo7BTQRU1aOpFHBtDJudE-oACLcBGAsYHQ/s16000/301.png" alt="Burp Suite Burp Collaborator" width="709" height="310"/></span></p>
<h5 class="ai-optimize-138"><strong><span style="color: #000000;">Configuring Burp Suite and Fuzzing</span></strong></h5>
<p class="ai-optimize-139"><span style="color: #000000;">Before hitting the “Lookup DNS” button, let’s first configure our Burp monitor to intercept the passing HTTP request. Once it captures the request, we can then share it with the <strong>Intruder tab</strong> for further exploitation.</span></p>
<p class="ai-optimize-140"><span style="color: #000000;"><img decoding="async" class="yoast-text-mark" src="https://1.bp.blogspot.com/-MHHHKK89qzY/X-Ne68NLMWI/AAAAAAAAsB8/fQtbmao2twAhpJzF6TM-HRdelAHg3XRGACLcBGAsYHQ/s16000/303.png"/></span></p>
<p class="ai-optimize-141"><span style="color: #000000;">Over in the intruder tab, we’ll modify the injection point and set the payload position at the IP address we’ve entered.</span></p>
<p class="ai-optimize-142"><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-SPa9ic20Gb4/X-NfAJxuulI/AAAAAAAAsCE/JeanFmCPOswDBTC5VVgp4qzjPYcnuYf_gCLcBGAsYHQ/s16000/304.png" alt="Burp Suite Burp Collaborator" width="744" height="409"/></span></p>
<p class="ai-optimize-143"><span style="color: #000000;">Now time to take help. Back into the collaborator client window, set the <strong>number to generate to 10,</strong> and hit the copy to clipboard button.</span></p>
<p class="ai-optimize-144"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JzVtrisASOM/X-NfFAmCwdI/AAAAAAAAsCM/uSubYkTAp9wFW9nVktV2a763Es2RwsWWACLcBGAsYHQ/s16000/305.png"/></span></p>
<p class="ai-optimize-145"><span style="color: #000000;">In the payload section, simply click the “Paste” button to transfer all the copied payloads into the empty box. Then, click the “Attack” button to initiate the fuzzer and begin the process.</span></p>
<p class="ai-optimize-146"><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-hecydztZO30/X-NfKjOEpmI/AAAAAAAAsCU/EQBs3cc1mjYTKEI_QBGt24M-QCvYU0yfQCLcBGAsYHQ/s16000/306.png" alt="Burp Suite Burp Collaborator" width="739" height="463"/></span></p>
<p class="ai-optimize-147"><span style="color: #000000;">And there we go, every payload has the same length. Let’s check whether the collaborator does offer something or not.</span></p>
<p class="ai-optimize-148"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BaRd5YpRJU8/X-NfTe2dV7I/AAAAAAAAsCY/7MHB85wrGkUE6Qbtc2DZYTrN-L8IpwdfwCLcBGAsYHQ/s16000/307.png"/></span></p>
<p class="ai-optimize-149"><span style="color: #000000;">Great !! From the image below, we can see that the application triggers a large amount of DNS service.</span></p>
<p class="ai-optimize-150"><span style="color: #000000;">Confirming the presence of an SSRF vulnerability.</span></p>
<p class="ai-optimize-151"><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-IvHdV4kYT4Y/X-NfZcIT-DI/AAAAAAAAsCc/3K1-dBPGLM0wfKB26hXwjwzAyt5wCk3YgCLcBGAsYHQ/s16000/308.png" alt="Burp Suite Burp Collaborator" width="725" height="488"/></span></p>
<p class="ai-optimize-152"><span style="color: #000000;">To learn more about <strong>Burp Suite for Pentesters</strong>. Follow this <a href="https://www.hackingarticles.in/category/website-hacking/burp-suite/"><strong>Link.</strong></a></span></p>
<p class="ai-optimize-153"><span style="color: #000000;"><b>Author</b>: Geet Madan is a Certified Ethical Hacker, Researcher, and Technical Writer at Hacking Articles on Information Security<b>. </b>Contact <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/geet-madan/"><b>here</b></a></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
