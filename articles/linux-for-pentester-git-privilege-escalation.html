<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux for Pentester: git Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-for-pentester-git-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2019-07-07T03:48:43+00:00">July 7, 2019</time><time class="updated" datetime="2025-06-07T13:59:01+00:00">June 7, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In this article, we will understand a very dominant command i.e “git” which is use in version control of software development for controlling source code and helps the software developer. Here I’m using the basic commands that a git can perform to learn its advantage in our mission of privilege escalation. So by knowing this fact, we will examine how we can take this benefit in our Privilege Escalation.</span></p>
<p class="ai-optimize-7"><strong><em>NOTE: “The main objective of publishing the series of “Linux for pentester” is to introduce the circumstances and any kind of hurdles that can be faced by any pentester while solving CTF challenges or OSCP labs which are based on Linux privilege escalations. Here we do not criticizing any kind of misconfiguration that a network or system administrator does for providing higher permissions on any programs/binaries/files &amp; etc.”  </em></strong></p>
<h3 class="ai-optimize-8"><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<p class="ai-optimize-9"><span style="color: #000000;"><strong>Introduction to git                                         </strong></span></p>
<ul>
<li class="ai-optimize-10"><span style="color: #000000;">Major Operation performed using git</span></li>
</ul>
<p class="ai-optimize-11"><span style="color: #000000;"><strong>Exploiting git</strong></span></p>
<ul>
<li class="ai-optimize-12"><span style="color: #000000;">SUDO Lab setups for privilege Escalation</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">Exploiting SUDO rights</span></li>
</ul>
<h3 class="ai-optimize-14"><span style="color: #800000;"><strong>Introduction to git</strong></span></h3>
<p class="ai-optimize-15"><span style="color: #000000;">Git is a software source code Change Management system for cooperative improvement. It maintains a history of file versions. Unlike typical client-server CM systems which “check-out” the latest version of the files, Git is a scattered CM system where the user has a local copy of the entire repository which includes the entire history of all files.  Git is better than SVN for speed, data reliability and also upkeep non-linear workflows. The user working with files in their local project work area which relates with the local clone source can add, edit and delete files and finally committing their changes. The user can then share these changes to the local repository with a “push” or “pull” to other Git repositories.</span></p>
<p class="ai-optimize-16"><span style="color: #000000;">To know more about git command use its help page by the command as below:</span></p>
<pre class="lang:default decode:true">git --help</pre>
<p class="ai-optimize-17"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Gy3KmEL73Cg/XSFoEqGSrdI/AAAAAAAAfBY/ztDNp9EFrGQgQggE5rjfREweaFoSs0BlQCLcBGAs/s1600/0.png"/></span></p>
<p class="ai-optimize-18"><span style="color: #000000;"><strong>Generate user’s Integrity</strong>: The very first step to gain git’s utility is to create self-identity in git repository. For this user needs to mention his name and email address with git.  This is very important as every Git commits you made uses this information. Use below command for framing the same as shown in below image:</span></p>
<pre class="lang:default decode:true">git config --global user.name "Komal Singh"
git config --global user.email komalrajput1515@gmail.com</pre>
<p class="ai-optimize-19"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lOUHeYi2Uro/XSFoEnbw16I/AAAAAAAAfBc/Oj_LVAbAuAgTIqaWNMAO0rU_4dvfsdgTgCLcBGAs/s1600/1.png"/></span></p>
<p class="ai-optimize-20"><span style="color: #000000;"><strong>Cloning a git repository</strong>: After creating the identity we need to clone the git repository for our project to start with and only then you we can commit our changes. Git clone is used to point an existing repo and make a copy of that repo in a new directory, at another location. The original repository can be located on the local filesystem. This automatically produces a remote connection pointing back to the original repository which makes it very easy to interact with a central repository.</span></p>
<pre class="lang:default decode:true">git clone https://github.com/alexxy/netdiscover.git</pre>
<p class="ai-optimize-21"><span style="color: #000000;"><strong>Initialize a new git repository: </strong>If someone desire to start to own git repository server for his codebase then we can take advantage of option “init” for this purpose which helps the user to initiate a new git repository and the machine can be now used as a git repository server for that particular codebase.</span></p>
<pre class="lang:default decode:true">git init</pre>
<p class="ai-optimize-22"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JjORF9sEFlE/XSFoFx7NNAI/AAAAAAAAfBs/7tRcQ7Wojn0ilMGL1iihWHevBD6i17L-QCLcBGAs/s1600/2.png"/></span></p>
<p class="ai-optimize-23"><span style="color: #000000;"><strong>Checking git status</strong>:  To check the status of files that possess in the index versus the working directory for your git repository use option “status” as shown in below image.</span></p>
<pre class="lang:default decode:true">git status</pre>
<p class="ai-optimize-24"><span style="color: #000000;">Initially, I haven’t created any file or made any kind of commitments to my git repository so it will show it as blank.</span></p>
<p class="ai-optimize-25"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wMRoSR2YUow/XSFoF-ohixI/AAAAAAAAfBo/W7WKtffqFhU8aHZW2TOF87Oee4EkXAxpgCLcBGAs/s1600/3.png"/></span></p>
<p class="ai-optimize-26"><span style="color: #000000;"><strong>Add a new file in repository</strong>:  Now I will add a file to my new git repo for this first I will create a file that will act as source code for performing this task. In the below image I have created a file “ignite.txt’ which holds some content. Now I want to add this file to my git repo for this I will use the option “add”.</span></p>
<pre class="lang:default decode:true">cat &gt; Ignite.txt
git add Ignite.txt</pre>
<p class="ai-optimize-27"><span style="color: #000000;"><strong>Git commit</strong>: At every step while adding any file to git repo we need to make its confirmation and for doing same we make commit to our git repo. As I have created a fresh file so will refer it as my “first commit”.</span></p>
<pre class="lang:default decode:true">git commit -m 'first commit'</pre>
<p class="ai-optimize-28"><span style="color: #000000;">On framing the above command, it will add the file “Ignite.txt” with its file content with a comment “first commit” so that you can search it later.</span></p>
<p class="ai-optimize-29"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_ChXB9s9CiU/XSFoGUNjUvI/AAAAAAAAfBw/FPy9pZBnlsogLh47Ba_M_K3fo_SqvUPYQCLcBGAs/s1600/4.png"/></span></p>
<p class="ai-optimize-30"><span style="color: #000000;">Now in the below screenshot I have added some more lines to my file “Ignite.txt” in the same way as above and will make another commit by mentioning it “second commit” to modify these changes to the git repo.</span></p>
<pre class="lang:default decode:true">git commit -m "second commit"</pre>
<p class="ai-optimize-31"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-opVkN8AcP_Q/XSFoG4n2ZyI/AAAAAAAAfB0/ryxYQhbSTAU6JUlKqFKT7fxuenaUNjEeQCLcBGAs/s1600/5.png"/></span></p>
<p class="ai-optimize-32"><span style="color: #000000;"><strong>Git log</strong>: Now when I have completed my task of making all commit the to git repo probably I would like to look back to see what has happened so this can be simply achieved by the most basic and powerful tool i.e. “git log” command. This can also be done for if you have cloned a repository with an existing commit history.</span></p>
<pre class="lang:default decode:true">git log</pre>
<p class="ai-optimize-33"><span style="color: #000000;">As from the below image it can easily understand that after using the “git log” option it reflects two commits which I have made above.</span></p>
<p class="ai-optimize-34"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0ASnwuH072w/XSFoG6ginhI/AAAAAAAAfB4/yav_puJtAycS_2fD2_A2Zws6kxsfJ7CwQCLcBGAs/s1600/6.png"/></span></p>
<p class="ai-optimize-35"><span style="color: #000000;">It can be used to break out from restricted environments by spawning an interactive system shell or available for executing an arbitrary system command.</span></p>
<pre class="lang:default decode:true">PAGER='sh -c "exec ifconfig0&lt;&amp;1"' git -p help</pre>
<p class="ai-optimize-36"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_8Ig2b5FmSI/XSFoHHEe1nI/AAAAAAAAfB8/XktVgiukV_IU9xS2Q6c8uVI8n8-7hOWagCLcBGAs/s1600/7.png"/></span></p>
<h3 class="ai-optimize-37"><span style="color: #800000;"><strong>Exploiting git</strong></span></h3>
<h3 class="ai-optimize-38"><span style="color: #800000;"><strong>Sudo Rights Lab setups for Privilege Escalation</strong></span></h3>
<p class="ai-optimize-39"><span style="color: #000000;">Now we will set up our lab of git command with higher privileges. As in my previous article, I have explained that the behaviour of many commands get changed after getting higher privileges correspondingly, we will check for the git command that what influence it has after receiving sudo rights and how we can use it further for privilege escalation.</span></p>
<p class="ai-optimize-40"><span style="color: #000000;">It can be clearly understood by the below image in which I have created a local user (test) who possess all sudo rights as root and can perform all task as admin.</span></p>
<p class="ai-optimize-41"><span style="color: #000000;">To add sudo right open etc/sudoers file and type following as user Privilege specification.</span></p>
<pre class="lang:default decode:true">test All=(root) NOPASSWD: /usr/bin/git</pre>
<p class="ai-optimize-42"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6oj2mb7qKsM/XSFoH4-gG7I/AAAAAAAAfCA/g685Yu0_GPwgLWdwb_CsGZijB6so07gSACLcBGAs/s1600/8.png"/></span></p>
<h3 class="ai-optimize-43"><span style="color: #800000;"><strong>Exploiting Sudo rights</strong></span></h3>
<p class="ai-optimize-44"><span style="color: #000000;">Now we will start exploiting git service by taking the privilege of sudoer’s permission. Suppose we got the sessions of victim’s machine that tend us to have local user access of the targeted system through which we can escalate the root user rights.</span></p>
<p class="ai-optimize-45"><span style="color: #000000;">Very first we will connect to the target machine with ssh, therefore, type following command to get access through local user login.</span></p>
<pre class="lang:default decode:true">ssh test@192.168.0.15</pre>
<p class="ai-optimize-46"><span style="color: #000000;">Then we look for sudo right of “test” user (if given) and found that user “test” can execute the git command as “root” without a password.</span></p>
<p class="ai-optimize-47"><span style="color: #000000;">Therefore, type the below command to spawn bash shell:</span></p>
<pre class="lang:default decode:true">sudo git help config</pre>
<p class="ai-optimize-48"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ylNJ1Bz_T9s/XSFoIgIbFaI/AAAAAAAAfCE/n05LqGjj7XEDmna5w1x4wnEH8I8QcJIkQCLcBGAs/s1600/9.png"/></span></p>
<p class="ai-optimize-49"><span style="color: #000000;">This will invoke the default pager to read the config like as man and here we can inject “!/bin/sh” and press enter to execute bash shell for us.</span></p>
<p class="ai-optimize-50"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_khRrkpV_wo/XSFoEmral5I/AAAAAAAAfBg/hOzKfNAAAU8I2x4NksnIR2CaRbp7sOp8gCLcBGAs/s1600/10.png"/></span></p>
<p class="ai-optimize-51"><span style="color: #000000;">You get “<strong>#</strong>” shell which means we have successfully escalated the root shell, as shown in the following picture.</span></p>
<p class="ai-optimize-52"><span style="color: #000000;"><strong>Conclusion:</strong> Hence you can notice from the given below image we have escalated the root privilege by abusing SUDO permission on git. Similarly, we can exploit the SUID permission assign on the git program.</span></p>
<p class="ai-optimize-53"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--CnKTln9io8/XSFoFat-ZaI/AAAAAAAAfBk/LOSP_4YICGEVuXYoOOJZjDKm4SN6PJUugCLcBGAs/s1600/11.png"/></span></p>
<p class="ai-optimize-54"><strong><span style="color: #000000;">References:</span></strong></p>
<p class="ai-optimize-55"><span style="color: #000000;">https://gtfobins.github.io/</span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To Learn more about Privilege Escalation. Follow this</span> <a href="https://www.hackingarticles.in/category/privilege-escalation/">Link.</a></p>
<p class="ai-optimize-56"><span style="color: #000000;"><strong>Author</strong>: Komal Singh is a Cyber Security Researcher and Technical Content Writer, she is completely enthusiastic pentester and Security Analyst at Ignite Technologies. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/komal-rajput-26b783131/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
