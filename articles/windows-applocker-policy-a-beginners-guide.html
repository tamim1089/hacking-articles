<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Windows Applocker Policy – A Beginner’s Guide</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/windows-applocker-policy-a-beginners-guide/" rel="bookmark"><time class="entry-date published" datetime="2019-01-13T15:59:35+00:00">January 13, 2019</time><time class="updated" datetime="2025-06-03T13:29:23+00:00">June 3, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">This Post is based on “Microsoft Windows – Applocker Policy” and this topic for System Administrator, defines the AppLocker rules for your application control policies and how to work with them.</span></p>
<h3 class="ai-optimize-7"><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li class="ai-optimize-8"><span style="color: #000000;"><strong>Introduction to Applocker </strong></span></li>
<li class="ai-optimize-148" style="list-style-type: none;">
<ul>
<li class="ai-optimize-9"><span style="color: #000000;">What is applocker Policy?</span></li>
<li class="ai-optimize-10"><span style="color: #000000;">Who Should Use AppLocker?</span></li>
<li class="ai-optimize-11"><span style="color: #000000;">What can your rules be based upon?</span></li>
</ul>
</li>
<li class="ai-optimize-12"><span style="color: #000000;"><strong>Configure the Applocker to Allow/Deny Execution of an App</strong></span>
<ul>
<li class="ai-optimize-13"><span style="color: #000000;">Configure Enforcement rule</span></li>
<li class="ai-optimize-14"><span style="color: #000000;">Create Default Rules</span></li>
</ul>
</li>
<li class="ai-optimize-15"><span style="color: #000000;"><strong>Modify Executable Default Rules to Allow an App</strong></span>
<ul>
<li class="ai-optimize-16"><span style="color: #000000;"><strong>Rule conditions</strong></span>
<ul>
<li class="ai-optimize-17"><span style="color: #000000;">Publisher</span></li>
<li class="ai-optimize-18"><span style="color: #000000;">Path</span></li>
<li class="ai-optimize-19"><span style="color: #000000;">File Hash</span></li>
</ul>
</li>
</ul>
</li>
<li class="ai-optimize-20"><span style="color: #000000;"><strong>Modify Windows Installer Default Rules to Allow an App</strong></span></li>
<li class="ai-optimize-21"><span style="color: #000000;"><strong>Modify Script Default Rules to Allow an App</strong></span></li>
<li class="ai-optimize-22"><span style="color: #000000;"><strong>Creating New Rules to Block an APP</strong></span></li>
</ul>
<h3 class="ai-optimize-23"><span style="color: #800000;">Introduction to Applocker</span></h3>
<h4 class="ai-optimize-24"><span style="color: #000000;">What is applocker Policy?</span></h4>
<p class="ai-optimize-25"><span style="color: #000000;">Windows introduced AppLocker in Windows 7 and Windows Server 2008 R2 as a method to restrict the usage of unwanted programs. AppLocker lets administrators control which executable files they deny or allow to run. With this policy, administrators are able to generate rules based on file names, publishers or file locations on unique identities of files and specify which users or groups can execute those applications.</span></p>
<h4 class="ai-optimize-26"><span style="color: #000000;">What can your rules be based upon?</span></h4>
<p class="ai-optimize-27"><span style="color: #000000;">The rule collections organize the AppLocker console, which includes executable files, scripts, Windows Installer files, packaged apps, packaged app installers, and DLL files. These collections allow you to easily distinguish rules for different types of applications. The following table lists the file formats included in each rule collection.</span></p>
<p class="ai-optimize-28"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-3E4ar2tgu-U/XDtPjPTHnMI/AAAAAAAAcEE/kskZhmIYuPgPpcZCFxQKe_Qe0bdHFJPAACLcBGAs/s1600/0.png"/></span></p>
<h4 class="ai-optimize-29"><span style="color: #000000;">Who Should Use AppLocker?</span></h4>
<p class="ai-optimize-30"><span style="color: #000000;">AppLocker is worthy for organizations that have to accomplish any of the following tasks:</span></p>
<ul>
<li class="ai-optimize-31"><span style="color: #000000;">Check which applications are allowed to run inside the company network.</span></li>
<li class="ai-optimize-32"><span style="color: #000000;">Check which users are allowed to use the licensed program.</span></li>
<li class="ai-optimize-33"><span style="color: #000000;">Offer an audit log of what kind of applications clients were running.</span></li>
<li class="ai-optimize-34"><span style="color: #000000;">Prevent trendy users from installing software per user.</span></li>
</ul>
<h3 class="ai-optimize-35"><span style="color: #800000;">Configure the Applocker to Allow/Deny Execution of an App</span></h3>
<p class="ai-optimize-36"><span style="color: #000000;">In the Group Policy Object Editor at <strong><em>Computer Configuration &gt; Windows Settings &gt; Security Settings &gt; Application Control Policies &gt; AppLocker</em></strong>, the Windows AppLocker settings exist.</span></p>
<p class="ai-optimize-37"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-XwsO8CicXuI/XDtPjLYmI8I/AAAAAAAAcEI/pLb-oij8piM8KUzG1PEzMzvYdQO4p9B-wCLcBGAs/s1600/1.png"/></span></p>
<h4 class="ai-optimize-38"><span style="color: #000000;">Configure Enforcement Rule</span></h4>
<p class="ai-optimize-39"><span style="color: #000000;">Use the enforcement setting for each collection to configure it to enforce rules; the system enforces rules for the rule collection, and it audits all events.</span></p>
<p class="ai-optimize-40"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-lIoJWvn3hG0/XDtPmDGCo4I/AAAAAAAAcEs/YYMpjig250QM-aE8GgCRU65J7O5U-dTcQCLcBGAs/s1600/2.png"/></span></p>
<ol>
<li class="ai-optimize-41"><span style="color: #000000;">Select the Configured check box for the rule collection you are editing, and then verify that you have selected Enforce rules.</span></li>
<li class="ai-optimize-42"><span style="color: #000000;">Click OK.</span></li>
</ol>
<p class="ai-optimize-43"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-aX7gvynvEyQ/XDtPoIq6rdI/AAAAAAAAcFE/lwtwEA0fLOw1dG3eS06n4Nfn32ubdo5QACLcBGAs/s1600/3.png"/></span></p>
<p class="ai-optimize-44"><span style="color: #000000;">Open the <strong>Advanced</strong> tab and enable the DLL rule collection.</span></p>
<p class="ai-optimize-45"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-xMZM_WsuhFU/XDtPof_C5XI/AAAAAAAAcFI/rYKZao8VrqU6tVCYDFiTcmteknxAqvMQgCLcBGAs/s1600/4.png"/></span></p>
<h4 class="ai-optimize-46"><span style="color: #000000;">Create Default Rules</span></h4>
<p class="ai-optimize-47"><span style="color: #000000;">AppLocker includes default rules for each rule collection. These rules intend to help ensure that an AppLocker rule collection allows the files required for Windows to operate properly.</span></p>
<ul>
<li class="ai-optimize-48"><span style="color: #000000;">Open the AppLocker console.</span></li>
<li class="ai-optimize-49"><span style="color: #000000;">Right-click the appropriate rule type for which you want to generate default rules automatically. You can automatically create executable rules, Windows Installer rules, script rules, and packaged application rules.</span></li>
<li class="ai-optimize-50"><span style="color: #000000;">Click Create Default Rules.</span></li>
</ul>
<h5 class="ai-optimize-51"><span style="color: #000000;"><strong>Executable Default Rule Types Include:</strong></span></h5>
<ul>
<li class="ai-optimize-52"><span style="color: #000000;">Allow members of the local <strong>Administrators </strong>group to run all apps.</span></li>
<li class="ai-optimize-53"><span style="color: #000000;">Allow members of the <strong>Everyone </strong>group to run apps that are located in the Windows folder.</span></li>
<li class="ai-optimize-54"><span style="color: #000000;">Allow members of the <strong>Everyone </strong>group to run apps that are located in the Program Files folder.</span></li>
</ul>
<p class="ai-optimize-55"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-0bksszSHJEg/XDtPo2guPdI/AAAAAAAAcFM/8t9lJ8BTTEMNhxJm4i0U7Ldl8nYK9KKGQCLcBGAs/s1600/5.png"/></span></p>
<h3 class="ai-optimize-56"><span style="color: #800000;">Modify Executable Default Rules to Allow an App</span></h3>
<p class="ai-optimize-57"><span style="color: #000000;">A rule can be configured to use allow or deny actions:</span></p>
<ul>
<li class="ai-optimize-58"><span style="color: #000000;"><strong>ALLOW:</strong> You can specify which files are allowed to run in your environment, and for which users or groups of users.</span></li>
<li class="ai-optimize-59"><span style="color: #000000;"><strong>DENY:</strong> You can specify which files are <em>not</em> allowed to run in your environment, and for which users or groups of users.</span></li>
</ul>
<p class="ai-optimize-60"><span style="color: #000000;">Once you have configured default rules as done above, then you can modify it as per your requirement. For example, if you want to modify rule: “<em>Allow members of the <strong>Everyone</strong> group to run apps that are located in the Program Files folder</em>” for a specific user or group to allow a specific program file execution, then go its property by making right click on that rule and follow below steps.</span></p>
<p class="ai-optimize-61"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-fX9hrGBWgOE/XDtPo-OKyyI/AAAAAAAAcFQ/iMerCh8iESc6Z9IMW_bArMmE8q-C6Ce0ACLcBGAs/s1600/6.png"/></span></p>
<p class="ai-optimize-62"><span style="color: #000000;">Select the file or folder path that this rule should affect. The asterisk (*) can be used as a wildcard in the rules of the path. For example, %ProgramFiles% \* indicates that all files and subfolders within that path.</span></p>
<p class="ai-optimize-63"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-VyIsdCCeuoQ/XDtPp3QX52I/AAAAAAAAcFY/PPy2OtWLWKI3s1P7aHBsK86jymox31cPACLcBGAs/s1600/7.png"/></span></p>
<h3 class="ai-optimize-64"><span style="color: #800000;">Rule conditions</span></h3>
<p class="ai-optimize-65"><span style="color: #000000;">Conditions of rules are criteria for AppLocker to identify the applications to which the rule applies. The three main rules are the publisher, path, and hash of the file.</span></p>
<h4 class="ai-optimize-66"><span style="color: #000000;">Publisher</span></h4>
<p class="ai-optimize-67"><span style="color: #000000;">Identifies a digital signature- based application. The digital signature encloses information about the company (the publisher) who created the application.</span></p>
<p class="ai-optimize-68"><span style="color: #000000;">Wildcard characters can be used as values in the publisher rule fields according to the following specifications:</span></p>
<h5 class="ai-optimize-69"><span style="color: #000000;"><strong>Advantage:</strong></span></h5>
<ul>
<li class="ai-optimize-70"><span style="color: #000000;">Frequent updating is not required.</span></li>
<li class="ai-optimize-71"><span style="color: #000000;">You can apply different values within a certificate.</span></li>
<li class="ai-optimize-72"><span style="color: #000000;">You can use a single rule to allow a complete product suite.</span></li>
<li class="ai-optimize-73"><span style="color: #000000;">Within the publisher rule, you can use the asterisk (*) wildcard character to specify that any value should match.</span></li>
</ul>
<h5 class="ai-optimize-74"><span style="color: #000000;"><span style="color: #000000;"><b>Disadvantage</b></span><strong style="color: #000000;">:</strong></span></h5>
<ul>
<li class="ai-optimize-75"><span style="color: #000000;">While a single rule can be used to allow a complete product suite, all files in the suite must be uniformly signed.</span></li>
</ul>
<h4 class="ai-optimize-76"><span style="color: #000000;">Path</span></h4>
<p class="ai-optimize-77"><span style="color: #000000;">Identify an app in the computer file system or on the network by its location. For well-known paths such as Program Files and Windows, AppLocker uses custom path variables.</span></p>
<h5 class="ai-optimize-78"><span style="color: #000000;"><span style="color: #000000;"><b>Advantages</b></span><strong style="color: #000000;">:</strong></span></h5>
<ul>
<li class="ai-optimize-79"><span style="color: #000000;">Many folders or a single file can be easily controlled.</span></li>
<li class="ai-optimize-80"><span style="color: #000000;">The asterisk (*) can be used as a wildcard in the rules of the path. For example, %ProgramFiles%\Microsoft Office\* indicates that all files and subfolders within the Microsoft Office folder will be affected by the rule.</span></li>
</ul>
<h5 class="ai-optimize-81"><span style="color: #000000;"><strong>Disadvantage:</strong></span></h5>
<ul>
<li class="ai-optimize-82"><span style="color: #000000;">It could be at risk if a rule that is organized to use a folder path holds subfolders that are writable by the local user.</span></li>
</ul>
<h4 class="ai-optimize-83"><span style="color: #000000;">File Hash</span></h4>
<p class="ai-optimize-84"><span style="color: #000000;">Represents the calculated cryptographic hash system of the identified file. For non-digitally signed files, file hash rules are safer than path rules.</span></p>
<h5 class="ai-optimize-85"><span style="color: #000000;"><span style="color: #000000;"><b>Advantage</b></span><strong style="color: #000000;">:</strong></span></h5>
<ul>
<li class="ai-optimize-86"><span style="color: #000000;">Since each file has a unique hash, a file hash condition only applies to one file.</span></li>
</ul>
<h5 class="ai-optimize-87"><span style="color: #000000;"><strong>Disadvantage:</strong></span></h5>
<ul>
<li class="ai-optimize-88"><span style="color: #000000;">Whenever the file is updated (such as security updates or upgrades), the hash of the file changes. Consequently, you have to manually update the rules for file hash.</span></li>
</ul>
<p class="ai-optimize-89"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-MJj9Z8uMyQU/XDtPpljX19I/AAAAAAAAcFU/c7pyLicMwBgVyni-2zhYXfiAp2cCbRZ8gCLcBGAs/s1600/8.png"/></span></p>
<h3 class="ai-optimize-90"><span style="color: #800000;">Modify Windows Installer Default Rules to Allow an App</span></h3>
<h4 class="ai-optimize-91"><span style="color: #000000;">Windows Installer Default Rule Types Include:</span></h4>
<ul>
<li class="ai-optimize-92"><span style="color: #000000;">Allow members of the local <strong>Administrators </strong>group to run all Windows Installer files.</span></li>
<li class="ai-optimize-93"><span style="color: #000000;">Allow members of the <strong>Everyone </strong>group to run all digitally signed Windows Installer files.</span></li>
<li class="ai-optimize-94"><span style="color: #000000;">Allow members of the <strong>Everyone </strong>group to run all Windows Installer files that are located in the Windows\Installer folder.</span></li>
</ul>
<p class="ai-optimize-95"><span style="color: #000000;">Similarly, if you want to modify Windows Install default rules, then repeat above steps.</span></p>
<p class="ai-optimize-96"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-XgYbwVErD_s/XDtPp6NRWyI/AAAAAAAAcFc/nOH6_WQLjQYjs05Om4Y9JO9vx3Fyn6zfgCLcBGAs/s1600/9.png"/></span></p>
<p class="ai-optimize-97"><span style="color: #000000;">You can use wildcard characters as values in the publisher rule fields according to the following specifications:</span></p>
<p class="ai-optimize-98"><span style="color: #000000;"><strong>Publisher</strong>: The asterisk (*) character used by itself represents any publisher.</span></p>
<p class="ai-optimize-99"><span style="color: #000000;"><strong>Product name</strong>: The asterisk (*) character used by itself represents any product name.</span></p>
<p class="ai-optimize-100"><span style="color: #000000;"><strong>File name</strong>: Either the asterisk (*) or question mark (?) characters used by themselves represent any and all file names.</span></p>
<p class="ai-optimize-101"><span style="color: #000000;"><strong>File version</strong>: The asterisk (*) character used by itself represents any file version. If you want to limit the file version to a specific version or as a starting point, you can state the file version and then use the following options to apply limits:</span></p>
<ul>
<li class="ai-optimize-102"><span style="color: #000000;"><strong>Exactly</strong>. The rule applies only to this version of the app</span></li>
<li class="ai-optimize-103"><span style="color: #000000;"><strong>And above</strong>. The rule applies to this version and all later versions.</span></li>
<li class="ai-optimize-104"><span style="color: #000000;"><strong>And Below</strong>. The rule applies to this version and all earlier versions.</span></li>
</ul>
<p class="ai-optimize-105"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-vARYgkjFPHk/XDtPjFYG1rI/AAAAAAAAcEA/-AOIg5XbBjo9XYMEMvmLTagO8Iitu3M-gCLcBGAs/s1600/10.png"/></span></p>
<p class="ai-optimize-106"><span style="color: #000000;">Open Exceptions and then again select Publisher.</span></p>
<p class="ai-optimize-107"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-oMBkW5FlR6o/XDtPjkdcoPI/AAAAAAAAcEM/Qm7NH-OI_ecVo7RvLWtnyE3JujOZY-NVgCLcBGAs/s1600/11.png"/></span></p>
<h3 class="ai-optimize-108"><span style="color: #800000;">Modify Script Default Rules to Allow an App</span></h3>
<h4 class="ai-optimize-109"><span style="color: #000000;">Script Default Rule Types Include:</span></h4>
<ul>
<li class="ai-optimize-110"><span style="color: #000000;">Allow members of the local <strong>Administrators </strong>group to run all scripts.</span></li>
<li class="ai-optimize-111"><span style="color: #000000;">Allow members of the <strong>Everyone </strong>group to run scripts that are located in the Program Files folder.</span></li>
<li class="ai-optimize-112"><span style="color: #000000;">Allow members of the <strong>Everyone </strong>group to run scripts that are located in the Windows folder.</span></li>
</ul>
<p class="ai-optimize-113"><span style="color: #000000;">Similarly, if you want to modify Script default rules, then repeat above steps.</span></p>
<p class="ai-optimize-114"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-kNMrGBTDcqs/XDtPkL-6GjI/AAAAAAAAcEQ/gGfAfoD071EAiEOwFEPuC_PCfExnhXIjACLcBGAs/s1600/12.png"/></span></p>
<p class="ai-optimize-115"><span style="color: #000000;">Select the file or folder path that this rule should affect.</span></p>
<p class="ai-optimize-116"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-hwAKGiORjdM/XDtPkMBW1gI/AAAAAAAAcEU/uF4KkDQJxeEqsAgtY45IHHmvPsU0fvd0ACLcBGAs/s1600/13.png"/></span></p>
<p class="ai-optimize-117"><span style="color: #000000;">Open Exceptions and then again select Publisher.</span></p>
<p class="ai-optimize-118"><span style="color: #000000;">In this way, you can implement Default rules and modify them for Executable file, Script rules or Windows Installer files according to your situation.</span></p>
<p class="ai-optimize-119"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-_fnAF1KrjQI/XDtPkg8YYFI/AAAAAAAAcEY/g1VZ5je6chgdxce5XXI3UWW_99d61ud6wCLcBGAs/s1600/14.png"/></span></p>
<h3 class="ai-optimize-120"><span style="color: #800000;">Creating New Rules to Block an APP</span></h3>
<p class="ai-optimize-121"><span style="color: #000000;">If you want to make your own rule in order to allow or deny an action for any application, you can choose the options ” Create New Rule” below. Let’s say, I want to create a new Executable file rule to restrict command prompt execution for everyone.</span></p>
<p class="ai-optimize-122"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-Lm-qMvvOuG8/XDtPlCRq79I/AAAAAAAAcEc/QhHdoqU0eyQMLdLfo1t5PcfAbApyXMo8ACLcBGAs/s1600/16.png"/></span></p>
<p class="ai-optimize-123"><span style="color: #000000;">Then, you will get a wizard that helps you to create an Applocker rule, which will truly be based on the file attribute such as the file path and digital signature.</span></p>
<p class="ai-optimize-124"><em><span style="color: #000000;"><strong>NOTE:</strong> Install the applications you want to create the rules for on this computer.</span></em></p>
<p class="ai-optimize-125"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-MiSx_IsLZzE/XDtPlO2k3eI/AAAAAAAAcEg/Y3wimMleAdUDS-Rz5ysr_moeGL373Y2AwCLcBGAs/s1600/17.png"/></span></p>
<p class="ai-optimize-126"><span style="color: #000000;">Now the action to use and the user or group that this rule should apply to. A <strong>deny</strong> action prevent affected file from running.</span></p>
<p class="ai-optimize-127"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-mRWAU0K_Ssg/XDtPlqr7cxI/AAAAAAAAcEk/F0_19x6ZiH8GeVYkZAAIrR_NmPlg_lqRwCLcBGAs/s1600/18.png"/></span></p>
<p class="ai-optimize-128"><span style="color: #000000;">Select the type of primary condition that you would like to create. Here we have chosen “<strong>Publisher</strong>” options.</span></p>
<p class="ai-optimize-129"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-yd63R4j4Yq8/XDtPmDwKNcI/AAAAAAAAcEo/EfYJkgQ2EtAIJ-hlMu-p6esKqy0Kq4PegCLcBGAs/s1600/19.png"/></span></p>
<p class="ai-optimize-130"><span style="color: #000000;">Browse for a signed file to use as a reference for the rule. Here we have browsed the <strong>cmd.exe</strong> and then click on next.</span></p>
<p class="ai-optimize-131"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-j70SXTWIPkw/XDtPmu2WXpI/AAAAAAAAcEw/cqYo4w0l77E49rr1XUrowWtbkFEKd7S4wCLcBGAs/s1600/20.png"/></span></p>
<p class="ai-optimize-132"><span style="color: #000000;">Choose the Publisher as an exception and then click Next.</span></p>
<p class="ai-optimize-133"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-HNquGhtAWFw/XDtPnIYqDeI/AAAAAAAAcE0/7YmTBFPqhKkstvSkXQVE5QazKpdJiIvwgCLcBGAs/s1600/21.png"/></span></p>
<p class="ai-optimize-134">And finally, this will add your rule to restrict the cmd.exe.</p>
<p class="ai-optimize-135"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-3HXzOWtUbIQ/XDtPnJsvZDI/AAAAAAAAcE4/AlK6j01st9EpzRFCROqVvmSc6_d7V89UgCLcBGAs/s1600/23.png"/></span></p>
<h4 class="ai-optimize-136"><span style="color: #000000;">Set Application identity to Automatic mode:</span></h4>
<p class="ai-optimize-137"><span style="color: #000000;">Then navigate to “Application identity Property” through <em><strong>Computer Configuration &gt; Policies &gt; Windows Settings &gt; Security Settings &gt; System Services &gt; Application identity</strong>.</em></span></p>
<p class="ai-optimize-138"><span style="color: #000000;">Then enable the “<strong>Automatic</strong>” option as the service startup mode.</span></p>
<p class="ai-optimize-139"><span style="color: #000000;">Now, update the Group policy with the help of <strong>gpupdate command</strong>.</span></p>
<p class="ai-optimize-140"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-3W2BDaxPIsc/XDtPnh9NeZI/AAAAAAAAcE8/Hc85t4WOATUwB1yoHjneMRxtMIX-QRubACLcBGAs/s1600/24.png"/></span></p>
<p class="ai-optimize-141"><span style="color: #000000;">Now when you will try to open command prompt “cmd.exe” then you will get services restriction prompt as shown.</span></p>
<p class="ai-optimize-142"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-6di2xbNl4Lo/XDtPoFVtFfI/AAAAAAAAcFA/5GjCEuBskYck649snixj3VRmZqXaYWefgCLcBGAs/s1600/25.png"/></span></p>
<p class="ai-optimize-143"><span style="color: #000000;"><strong>Note:</strong> If you are configuring these rule on a single machine then it will take some time to impose the rule over the machine.</span></p>
<p class="ai-optimize-144"><span style="color: #000000;"><strong>Reference:</strong><span style="color: #3366ff;"> //docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/applocker/working-with-applocker-rules</span></span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To learn more about Red Teaming. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/red-teaming/">link.</a></strong></p>
<p class="ai-optimize-145"><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
