<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Bounty Hunter HackTheBox Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/bounty-hunter-hackthebox-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-12-29T13:03:09+00:00">December 29, 2021</time><time class="updated" datetime="2025-06-20T16:02:17+00:00">June 20, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Bounty hunter is a CTF Linux machine with an Easy difficulty rating on the Hack the Box platform. So let’s get started and take a deep dive into disassembling this machine utilizing the methods outlined below.</span></p>
<h3><span style="color: #800000;">Pentesting Methodology</span></h3>
<p><span style="color: #000000;"><strong>Port Scanning and Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">nmap</span></li>
<li><span style="color: #000000;">abusing http</span></li>
<li><span style="color: #000000;">dirb</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploitation</strong></span></p>
<ul>
<li><span style="color: #000000;">burp suite</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">ssh</span></li>
<li><span style="color: #000000;">user flag</span></li>
<li><span style="color: #000000;">ticket validator</span></li>
<li><span style="color: #000000;">root flag</span></li>
</ul>
<p><span style="color: #000000;"><strong>Level: Easy</strong></span></p>
<h3><span style="color: #800000;">Port Scanning and Enumeration</span></h3>
<p><span style="color: #000000;"><strong> </strong>To begin, we’ll perform nmap scan to look for open ports. As can be seen, two ports are open:</span></p>
<ul>
<li><span style="color: #000000;">Running the ssh service on port <strong>22</strong>.</span></li>
<li><span style="color: #000000;">Port <strong>80 </strong>is used to run the http service.</span></li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sC -sV 10.129.95.166</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEith68kLW358XBWg8QjhKOraOLIH2tCQ6rFJ1gsgkC6k3K5JoPp1nJ5f3vlOYq91hnrOquofbHcH5fybdBQ7G1bFaikcEt8m2nqgC8_qSiz3wjz9ndxEqfA42hGRkTO8cWMi72lZFzYSLxn0rqdCTBEHuU5UDSna5yIQ9FYWAaa4iqzHW6PJA14Bcqqyg=s16000"/></span></p>
<p><span style="color: #000000;">Let’s take a look at the IP address in a browser. Nothing appears to be of interest on the main page. As a result, we examined its subdirectory “<strong>portal</strong>.”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEjm2btimJULuEreB7LIBz6bMYUGNUuTFiw6Xsx9fMXGVSE5_iMrr_5CYow45I5dboQm11pjIn-1EyilBVwwotLISIaehs72ZfHvOOCyLZNwbVruW-rfxs8wvJh55Z8JbJFLy1ApjFjQ234iRxF3_12MMfGvhgEH0QXaSqtGYGiiP4vgaoYAEUmP-gMMFQ=s16000"/></span></p>
<p><span style="color: #000000;">When we examined the portal subdirectory. It notes that it is still in the development phase and provides a URL to test this lab environment.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgbmQSQgFHFRKNtS1hXSZa3vyCA-gX7p8TJOl8eqO_d4Y5XO4BiyeqM6RElUzs5pwBvqj8Pe60ufB8b--zOffmR0JhiwvnGElssWGqQ023GDdfT9vHxgUbHkWVZ-6rcZv3Ro-uKotwVJ72aJzoJl_POXtpiu_4QgAV_mdtL0RpaMRZf98wfzWhxcYcMhw=s16000"/></span></p>
<p><span style="color: #000000;">It is still in development, which means there is a good chance it will be <strong>vulnerable</strong>.</span></p>
<p><span style="color: #000000;">We discovered a form where we may enter a value and the data will be saved elsewhere. However, it eventually appears to be a beta version report submission system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhZDfsf8MmoMdTaBcxVolcYfHSvBc4MbZRHwC7_A7yXhtp15i2UpASZ4o5JuzCnFBJd-_WZAVC0dGOrhfExiPsocXezUwEXZq_lLpXjrIOdXXHbrARyAGPVxAlqwwOdhX0XDUnaRSV4mTGUbWtMKfudtL39kdS5zOgn8L8mS7ZQuBhTZnUOs6HwpkiSvg=s16000"/></span></p>
<p><span style="color: #000000;">Except for the bounty logs in javascript, it appears to be a standard html page script. So, in order to progress in this machine, we verified this page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEjNcQtVzAXX6EJypXl2ItAGR-jhWLlhJv9eGwrCko-jzZE9jwFAHq1f6CSPb-591-H3b-7o4wrJxdsRlFNo8ch9p9P3eMdbsZ-mS7YPxO3qJ0bjRuCiY0KUrfN8A4dwDCcPwqkd0bRK0qvZ2QUDL32RBDUGzM2hRZ3lWRSuMMZeV9fC9DCLme5xVaMLtA=s16000"/></span></p>
<p><span style="color: #000000;">We discovered a form where we may enter a value and the data will be saved elsewhere. When we look at the page source, we can see that the website is built with XML.</span></p>
<p><span style="color: #000000;">As a result, we may conclude that this webpage is susceptible to XXE (XML external entity).</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEiZg0EBklHzIROgvDbJSFZY27q2eYWHvjpJYao8mQSWyLo0syHPhV30OvCS3OvSlmuK7IeOC5jSxwl8w9qOL_OV3JXCKI-zhI1uYad-4ko6864-AoKe63T49N7Gd2MvvR48BvC8bCLk07a322PPdE-q95iTUOvKKXcxRWLD0fVSeDhU7FB7te59WEc7qQ=s16000"/></span></p>
<p><span style="color: #000000;">So we used dirb, a directory brute force, to find out more information about this system. Except for the db.php file, nothing intruding was discovered.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://10.129.95.166 -X .php</pre>
<p><span style="color: #000000;">It signifies that there is a database file available in which all of the data will be stored.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEg-gmEtQuaEZR55c22e8F75YsuEUed03lPxvsDZ5_EBzFiFlmer50JWn5JZFR1YVnWRG_55XGdrtY8ZUhAx8WOB8HLaKIKyirtqOUwqbaffQGNK8lxaA6yH0MF_J8w-lPTwRW9wbyMdQDeQJC1Ky5BoeC5NvHdL_tn7Yjqai2TTANHIdPC9VZA6WE9d7g=s16000"/></span></p>
<h3><span style="color: #800000;">Exploitation</span></h3>
<p><span style="color: #000000;">We will now begin our exploitation procedure with the burp suite. Try to capture its data by submitting a request for a more in-depth investigation. As a result, we used similar strategies on the beta version of the Bounty Report submission page.</span></p>
<p><span style="color: #000000;">I noted in the request that our recorded data appears to be encoded.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhZYBHoY41EteCZZxKvkZHnmLiaXfshEAJdJo9rJGooTvUs-0GmHFIPWhIKJMkHlwNiueDK46FK4I6nfXd8WK_INmiscYh-VOFSEy1xqoeB-GxqrKWhsI9G9butpH-H9CzD57bYnNcyy7QvmQy6uH2eq4ErxYQA4S-d5j5eGNW5Tls328kGxXboyw5VvQ=s16000"/></span></p>
<p><span style="color: #000000;">To check the encoded technique, we switch the tab to decoder for cracking this encryption. We learned here that it is encoded in base64.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhtC7ZKt6S6oEdc1WaUghb1rHDQ8swXi2JDoTsy424wAIVFDc25fICisAnndIcz0LNX4WxB5gQ40du_-0fwLOonF3NLb5yw0aSYuwNSC49JUt9qDghiefgKIBYbC8yk6Lc42ii63xu9E8XxuEiGxiwRiGQT2EBnOwKzKRR6xD0h-w-Tvxuve3codPRkkw=s16000"/></span></p>
<p><span style="color: #000000;">We have now transformed this string into a browser-readable format. Then we dropped that request in order to acquire a response from the destination. As you can see, we received an encoded answer from the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEghQf_nK2sZl-r4Nqeb9bMoy6cMtqHXk-5zmd26sruFacyfzZCF6Ty0mFLvYhR_wwFdI97Gdh08urq6NFEXiJJ01Jjn1zyELsjeiHZQaeT2t16DkG6hKHVjWrV8VaNBQ8So0pbSORxqpR7OxFxYEhKSIkrw8p4ATzeCEICLK0gmJrEkfAgFy_HOrFwvPg=s16000"/></span></p>
<p><span style="color: #000000;">Again we switched tab to decoder to analyze the response from the target machine. Thankfully we got some valuable information about the database.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dbserver = "localhost"
dbname = "bounty"
dbusername = "admin"
dbpassword = "m19RoAU0hP41A1sTsq6K"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEjInj-7vYOrJo1AqARhb4NB2EjGu-RT4Mno6bkmTSo1YhHe-CReG5sbFI9tmWTxzWFmcy1Pv01pSHzY1KLunoXzeBVoXePHxAyYndd1bWur52vFbE9EL0AFq72QpRcZ2MhgiDiME9eDhSCtC7oBxQ_NtNeeXfoPEbiibjkDkc0-SdYNZ23awnus3YOB8g=s16000"/></span></p>
<p><span style="color: #000000;">This information was then utilised to log into the system. kaboom!! We successfully logged into the system. Then we proceed to the decoder tab and attempt to request the <strong>/etc/passwd</strong> file using this mechanism must obtain its encoded value in order to request this file from the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEj0kHojm2Yp96h6MeS28F0gjAJ_7qxl21CKISOsRDUYGuLdyXYgYpfTk5LKmb0nLxdQhzhXFx_JwqM0Mq6qZ-s6xBx7cRb5VHspPwI5WQJlKYyKBjBRtsurfWfvsNDhPkvpvNIMWGaxjNX0kb0E6OC1o1as5rCAzT-_LTUwaY2wMLqf6jhVve4q84GfKg=s16000"/></span></p>
<p><span style="color: #000000;">We received a response from the destination machine after forwarding this request. Obviously, it is encoded, thus we must decode it in order to understand it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEi-ltymTzeA2kPNTkNuC1FEQqZdR3HfVMzX4m4pptU_dWEuR5DS-uH6d6hLXmFPsvV0ycl4_rQCcuz1DsFlt1Rjffr1OifYXWqpims27I-paCKBd2YStQzO14NRwiumnugp4cNKB4F7OG03v8uaBvNI3j26LIh9IxA11Ub6Mpi3DKlKbGNd6dyguw4vNg=s16000"/></span></p>
<p><span style="color: #000000;">We immediately attempt to decode it and received the desired results from that request. After examining, we discovered that we had username: <strong>development.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgbcujIbjusir0FNo7z-5o8uOXo1ZnUgEq_9rNG1VguAVNdS8i6FFNfNaBpMjIVsBURrfoh7TiCy-m23hkwDzGn8KmsPU9zgSho232Y3BPBpK7zNv-1nAT8A-Pss2IvEDLVGCs_duYdztfx9glQwc6Ox0abCbpT76k4SKfBWs1xaCahWFK84bWDXg9hbg=s16000"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<p><span style="color: #000000;">We have credentials, and we know that ssh is operating on port 22. Now is the optimal moment to begin the privilege escalation process using an ssh login with the password which we got <strong>earlier</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh development@10.129.95.166</pre>
<p><span style="color: #000000;">We successfully logged into the <strong>development </strong>and immediately we checked its id to verify its details. Searching for a little bit we found the <strong>user flag</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat user.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEi12-lTXyxuz4WFFLIhTt9ZPfyyzDQLT7BjxotbJWcwMckNLR8heq7wSAKK4p5kiZLrzsGvqdE9xQUI3dvEjAre9NNDf0DtcRNgo6dswePFu_2hnngGLlo9W2TgIUGnHK2TfeGxhGeJIvoiSNN-0Mn2G5mI9vz1-eUFbauEmohKC7lylYQrlwxQ9hllaQ=s16000"/></span></p>
<p><span style="color: #000000;">Following that, we double-checked this user’s permissions. Then, we discovered that we could root this machine by abusing the ticketvalidater.py file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p><span style="color: #000000;">So, we reviewed this file to analyse it, and we got some points, but nothing exciting came out of it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgd4-oS2Hq_JHuXotuftreCRXA73n-bVUmG9lN5hyD0Qp3WD0HJ4KlBesil_guB72FqjBJFXbmAsEnZu_twB57CR6yE-RRNoMizMckjmUSdXnkhoBvyrrLiwo0es2PgOWURWxXrBetJrauM-9B5RPm-R2Rguyf_ICSBeCXEx9vAwTPHqQsZcul5TqDTUA=s16000"/></span></p>
<p><span style="color: #000000;">We got some aid from <u><a style="color: #000000;" href="https://sm1l3z.github.io/hackthebox/2021/11/20/bountyhunter/">here </a></u>after analysing it for a while. We stressed that we highlight the key to root this machine upwards.</span></p>
<p><span style="color: #000000;">That helped us understand that the script first calls the load file, which we had already defined. This simply checks to see if the file ends with .md and exits if it does not. Next, the script calls evaluate, which has many checks. Essentially, it goes over it line by line, with a new check for each one.</span></p>
<p><span style="color: #000000;">We created our ticket code using that information and put it in a file (<strong>file.md</strong>).</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat file.md</pre>
<h5>Run Ticker Validator</h5>
<p><span style="color: #000000;">After that, we use sudo to run the ticket validator file, passing it the location to the ticket file (<strong>file.md</strong>).</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py
/home/develpment/file.md</pre>
<p><span style="color: #000000;">Yippee!! We found the <strong>root</strong>. We immediately went to the root directory and received our well-deserved <strong>root flag</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEg4-57qknNZOHwiy9jXjdgBD7xWsuWgO7ssnmiYcA72WalkuqTjgCv0Zwv-0yPLmMZn8kKB3VifCDEEnWFaOwUnkPLYf-LswWECGoKTTWtn5W6c30QXicn4D9GDSl7OszAv8iAvRePkiTZc6pYeXOgJf2DBNHG3f0pwraISYrQtZ9sSavtIT4G_ejsiTQ=s16000"/></span></p>
<p><span style="color: #000000;">There are a few things we should take note of. If you’re familiar with XXE Injection, this is a simple level box to complete, Privilege Escalation was a breeze, and Burp Suite is a true Swiss army knife tool. This box will be very useful to understand these concepts.</span></p>
<p><span style="color: #000000;">If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong></p>
<p><span style="color: #000000;"><strong>Author</strong>: Shubham Sharma is a passionate Cybersecurity Researcher, contact <span style="color: #0000ff;"><strong><u><a style="color: #0000ff;" href="https://www.linkedin.com/in/shubham-sharma-626964153/">LinkedIn</a></u></strong> </span>and <span style="color: #0000ff;"><strong><u><a style="color: #0000ff;" href="https://twitter.com/Shubham_pen">Twitter</a></u></strong></span>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
<!-- YARPP Thumbnails -->
<h3>Related posts:</h3>
<div class="yarpp-thumbnails-horizontal">
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/cap-hackthebox-walkthrough/" title="CAP HacktheBox Walkthrough">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">CAP HacktheBox Walkthrough</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/paper-hackthebox-walkthrough/" title="Paper HackTheBox Walkthrough">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">Paper HackTheBox Walkthrough</span></a>
</div>
</div>
            </div><!-- .entry-content -->
            <footer class="post-footer entry-footer">
                                                
            </footer><!-- .entry-footer -->
            
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://www.hackingarticles.in/empire-lupinone-vulnhub-walkthrough/" rel="prev">Empire: LupinOne Vulnhub Walkthrough</a></div><div class="nav-next"><a href="https://www.hackingarticles.in/windows-privilege-escalation-kernel-exploit/" rel="next">Windows Privilege Escalation: Kernel Exploit</a></div></div>
	</nav>        </div>
