<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Sahu: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/sahu-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-03-20T10:07:21+00:00">March 20, 2020</time><time class="updated" datetime="2025-06-10T20:10:40+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to complete a boot2root challenge of the lab Sahu. The lab is developed by Vivek Gautam and can be downloaded from <a style="color: #000000;" href="https://www.vulnhub.com/entry/sahu-11,421/">here</a>. Lab us fairly for the beginners and helps to get familiar with the concept of CTF challenges. It also helps to develop your enumeration skills as it solely focuses on enumeration.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Netdiscover scan</span></li>
<li><span style="color: #000000;">Nmap scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration </strong></span>
<ul>
<li><span style="color: #000000;">Browsing HTTP service at port 80</span></li>
<li><span style="color: #000000;">Directory Bruteforce using dirb</span></li>
<li><span style="color: #000000;">Enumerating Source Code</span></li>
<li><span style="color: #000000;">Directory Generation using Crunch</span></li>
<li><span style="color: #000000;">Bruteforce Zip Password using fcrackzip</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Connecting to Target using SMB</span></li>
<li><span style="color: #000000;">Enumerating SMB</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Post Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Running LinEnum script</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Writable /etc/password file</span></li>
<li><span style="color: #000000;">Generating Password Hash using Openssl</span></li>
<li><span style="color: #000000;">Appending hash to /etc/passwd</span></li>
<li><span style="color: #000000;">Getting Root Privileges</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Reading Root Flag</strong></span></li>
</ul>
<p><span style="color: #000000;">The first stage in starting the challenge is knowing your target and for that following command will be used :</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xPsjSipjVoA/XnSTKyRIdOI/AAAAAAAAjGc/3gINZ3ZQxc4A53oKZuBUnftdLsp9dIFMQCLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">After that we will start active reconnaissance by scanning our target IP using nmap with the following command :</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.105</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-90TKdmlLEZI/XnSTNnMCVnI/AAAAAAAAjG8/M5kb04A_jV4fEenuCDl0jgbrtaylUcC8gCLcBGAsYHQ/s1600/2.png"/></span></p>
<p><span style="color: #000000;">With nmap, as it can be seen in the image above, open ports are shown. These ports are 21, 22, 80, 139, 445 with the services of FTP, SSH, HTTP, NetBIOS-ssn samba. Because of banner grabbing, it was observed that anonymous login was enabled in FTP. Therefore, try to log in from FTP with the following commands :</span></p>
<pre class="lang:default decode:true">ftp 192.168.1.105</pre>
<p><span style="color: #000000;">Here, enter the password <strong>anonymous</strong>. Once you are logged in from FTP use the ls command to check the contents it has. The single zip file was found here, namely ftp.zip.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Qv9IHU6n4I0/XnSTN3i_FVI/AAAAAAAAjHA/_6cpftG07V4S4DuFVnYNVEDUCpxG6woMwCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">When opened, it asked for a password but as the password is not known we moved further. Open the IP address in the browser and the can he webpage as shown in the following :</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-I4pB1fM4lkI/XnSTOnNhjVI/AAAAAAAAjHI/oCmziZ7eGSkB9rm2UYlaerOOmsCK4JJlQCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Now we enumerated the directories with directory buster using the command :</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.105</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JE-ex9HO_Oc/XnSTOpQWGTI/AAAAAAAAjHE/4OLYpTjvQvA30YBkkOJtJyfni-c9v7gRgCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">As a result, we found a directory /H/A/R/, if you remembered that the image on the web-page was of Haryana so we can correctly assume that the full directory will be /H/A/R/Y/A/N/A/ and when opened in the browser you can see the following :</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FB9SyLh2Zws/XnSTPG_SRnI/AAAAAAAAjHM/_EMg05GfMgsu9uWx_Jrbsmu035jjLgpKgCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">In the source code, there will be a phrase saying <strong>“try to extract with hurry”</strong>. Now, this is something useful.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DZt5oybifXQ/XnSTPdlnf-I/AAAAAAAAjHQ/tRvhbwfixuUzYmMhUxLYNB9hSMQ1G1kvwCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">We had found an image on a web page and we have the hint in the source code. So we will use steghide to extract any metadata and to do so, use the following command :</span></p>
<pre class="lang:default decode:true">steghide extract -sf Haryana-1-1.jpg</pre>
<p><span style="color: #000000;">And when asked to enter the word hurry and as you can see in the image below we found a file and then read it said, “<strong>I have found the password for a zip file but I have forgot the last part of it, can you find out. 5AHU**”</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mWAWVb_aLrI/XnSTP_1b0AI/AAAAAAAAjHU/bpYPXtPQgo4mi3b8EaSTdiuYIpwywE0XACLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now, according to the hint, it means that the first four characters of the password are 5AHU and password is of six characters in length and we must find last two characters in order to get the password. We can easily do this using crunch and construct a dictionary to fuzz up the password. The last to characters could be of any combination i.e. it can be alpha-numeric or special character and so on, therefore, use the following set of command to make a dictionary using a crunch of every possible combination:</span></p>
<pre class="lang:default decode:true">crunch 6 6 -t 5AHU@, &gt; dict.txt
crunch 6 6 -t 5AHU@% &gt;&gt; dict.txt
crunch 6 6 -t 5AHU@^ &gt;&gt; dict.txt
crunch 6 6 -t 5AHU,% &gt;&gt; dict.txt
crunch 6 6 -t 5AHU%^ &gt;&gt; dict.txt
crunch 6 6 -t 5AHU^@ &gt;&gt; dict.txt
crunch 6 6 -t 5AHU^% &gt;&gt; dict.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-finZ1SzU7ZU/XnSTQPZFQ0I/AAAAAAAAjHY/GoiNX4GTmZEkl-ir7ACoNdkT7Tm6c-RUgCLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Once our wordlist for dictionary attack is created we can commence our attack using fcrackzip and for that use the following command :</span></p>
<pre class="lang:default decode:true">fcrackzip -u -D -p dict.txt ftp.zip</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-05ql91yAlBk/XnSTKx4DdgI/AAAAAAAAjGk/ZGlo4Ssa6oc6fti0k5pmRiuKKScPDp1IwCLcBGAsYHQ/s1600/10.png"/></span></p>
<p><span style="color: #000000;">The password has been cracked using the above method and retrieved an <a style="color: #000000;" href="ftp://ftp.txt">ftp.txt</a> file in which a username and password is found. As from the nmap port scan it was clear that the SMB port(139) was open. We ran the Enum4Linux to enumerate the SMB service<br/>
</span></p>
<pre class="lang:default decode:true ">enum4linux -a 192.168.1.105</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YBco9L22GYA/XnSTK745WLI/AAAAAAAAjGg/AlZwh1b7U5Mz2_FTFbLOuKNL2ZzmlQNqgCLcBGAsYHQ/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Thus, it is clear that a connection through sambashare can be made using smbclient and so to do the same, following command will be used :</span></p>
<pre class="lang:default decode:true">smbclient //192.168.1.105/sambashare -U sahu</pre>
<p><span style="color: #000000;">and when asked provide the password which was retrieved from <a style="color: #000000;" href="ftp://ftp.txt">ftp.txt</a>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Obuapl3KKOE/XnSTMLY0EsI/AAAAAAAAjGo/gsvBodAOrRYU8SRJgSe8QgPMBNuB7-keQCLcBGAsYHQ/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Now, connecting through smbclient gave us an opportunity to traverse around which lead us to find ssh.txt. upon reading ssh.txt file revealed a username and password. As the username and password are found in ssh.txt it can safely be assumed that these are the credentials for SSH login. Let’s try to login through SSH, using the following command :</span></p>
<pre class="lang:default decode:true">ssh haryana@192.168.1.105</pre>
<p><span style="color: #000000;">Further, provide the password when asked and log in through SSH will be successful. After logging in the machine, we decided to use the wget command to transfer the LinEnum script to the Target Machine. Followed by the transfer, we gave the proper permissions to the script and then run it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pV-JGQ18vm4/XnSTMfGP51I/AAAAAAAAjGs/iW5Z1EWtUYQZ_rCgixCJ6dP3TNek1xpagCLcBGAsYHQ/s1600/14.png"/></span></p>
<p><span style="color: #000000;">As a result, we found that /etc/passwd file is writable which allows us to make a new user and alter its permissions as per our desires.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VkSIEaJHFSI/XnSTMkKxxhI/AAAAAAAAjGw/5-lFgTcDjdw-HeEOimZsF8PWtFZJVseogCLcBGAsYHQ/s1600/15.png"/></span></p>
<p><span style="color: #000000;">To make a new user, use the following command :</span></p>
<pre class="lang:default decode:true ">openssl passwd -1 -salt raj pass123</pre>
<p><span style="color: #000000;">Now we have the hash, all we need is to append this user hash in the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QOj2zYJ1ZXo/XnSTM4DFEEI/AAAAAAAAjG0/P7lzGW5xiuEHmgFITIPSmQ0zFzg16aa1gCLcBGAsYHQ/s1600/16.png"/></span></p>
<p><span style="color: #000000;">On the target machine, we use the echo command to add this user into the /etc/passwd file. We can verify that the user has successfully been added by taking a look at the /etc/passwd using the tail command. Now that we have added user, let’s login to that user using the su command. As the user we created had root privileges so we own the root on this machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vgDJp85PCug/XnSTNJC82LI/AAAAAAAAjG4/WTmcwu7gbnAbIXqcHd2C8yzmK4VRiUPPACLcBGAsYHQ/s1600/17.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contact <strong><a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
