<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/cyber-forensics-tricks/" rel="category tag">Cyber Forensics</a></span>            </div>
            <h1 class="post-title entry-title">Forensic Data Carving using Foremost</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/forensic-data-carving-using-foremost/" rel="bookmark"><time class="entry-date published" datetime="2018-01-13T17:15:45+00:00">January 13, 2018</time><time class="updated" datetime="2025-05-21T09:54:58+00:00">May 21, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Foremost carves data from disk image files; it serves as an extremely useful tool and is very easy to use.</span></p>
<p><span style="color: #000000;">For the purpose of this article, we used an Ubuntu disk image file, and we repeated the process twice. The purpose of doing so was to see if Foremost can carve data out of incomplete disk images as well. We have used Kali Linux but if you want you can install Foremost on pretty much any distro of Linux.</span></p>
<h3><span style="color: #800000;">Starting Foremost in Kali Linux</span></h3>
<p><span style="color: #000000;">Here’s how it was done:</span></p>
<p><span style="color: #000000;">Navigate to the A<strong>pplications</strong> menu in Kali, <strong>Forensics </strong>is option 11. The fifth option from top in the <strong>Forensics </strong>menu is <strong>Foremost. </strong>Click on it and let’s get to carving some data!!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-3CnIRow-eSs/WloiNRGoScI/AAAAAAAATQY/qau7Q6t-7BoDrqftgeQWzenQeaYZu6gmACLcBGAs/s1600/1.PNG"/></span></p>
<p><span style="color: #000000;">Foremost starts and shows you the options you have at your disposal.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-YNpeiQbnIVA/WloiRXeFjCI/AAAAAAAATRA/H78Xp5ywNmYiWHaq6v7rmkfEtJKM2ZLpACLcBGAs/s1600/2.PNG"/></span></p>
<p><span style="color: #000000;">In order to keep things simple, you first want to navigate to the <strong>Desktop </strong>using <strong>“cd Desktop”</strong>.</span></p>
<p><span style="color: #000000;">Next, make a folder on the desktop by the name of <strong>“recov”. </strong>This isn’t a mandatory step; it just makes things easier to access by creating a new folder to store the carved data.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-vUp_Ff8QEX4/WloiRURsXEI/AAAAAAAATQ8/5lsHzyVm5P0axypOnyPapVjcKJknf3NVgCLcBGAs/s1600/3.PNG"/></span></p>
<h3><span style="color: #800000;">Creating the Disk Image</span></h3>
<p><span style="color: #000000;">We will be dealing with the disk image of a flash drive partition, so let’s make one using the <strong>“dd” </strong>command<strong>. </strong>The <strong>dd</strong> command can be used to copy files and with the option of converting the data format in the process.</span></p>
<p><span style="color: #000000;">In the interest of thoroughness we have copied .docx, .jpeg, .png, .zip, .pdf and .avi files onto the partition from which we will be making our disk image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vJGAW_KCZiA/WloiRrZVspI/AAAAAAAATRE/nE8ZV7pGcOcuuO1AEcSqVpWTJ-_wwYHMQCLcBGAs/s1600/4.PNG"/></span></p>
<p><span style="color: #000000;">Now let’s make a disk image.</span></p>
<p><span style="color: #000000;">In a new terminal window, type the following <strong>“fdisk –l | grep /dev/”</strong>. This command will show you the disk partitions available to you without any clutter.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-n1ez7YFQbto/WloiSM6R-dI/AAAAAAAATRI/H8dQNuSJbzEUojrDRAi9CRG04oYi6bqXgCLcBGAs/s1600/5.PNG"/></span></p>
<p><span style="color: #000000;">The partition we are concerned with is <strong>/dev/sbd2.</strong> The system specially allocated <strong>10 MB</strong> of space so that the imaging process is quick.</span></p>
<p><span style="color: #000000;">The command to create the disk image is <strong>“dd if=/dev/sdb2 of=disk.img”</strong>. Here, <strong>“dd”</strong> is the utility we are using, <strong>“if=” </strong>is to denote the input destination and <strong>“of=” </strong>is to denote the output destination and name of the image file we are creating.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-GdcAypsxdew/WloiS2Nxj9I/AAAAAAAATRM/UWbOp2YXO5Ax5m1tMqhbkp94ExDT1GiggCLcBGAs/s1600/6.PNG"/></span></p>
<p><span style="color: #000000;">We have not specified any output destination, but, just the name for the image file. The image file will be created in the <strong>Home</strong> directory by default. Copy the disk image file from here and place it on the desktop.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-_6FAev-ad_Y/WloiS177WCI/AAAAAAAATRU/GFA7FIB-EvYX2FfaDbBBVSmN0n_NwjQgwCLcBGAs/s1600/7.PNG"/></span></p>
<h3><span style="color: #800000;">Carving Files with Foremost</span></h3>
<p><span style="color: #000000;">Let’s navigate back to the terminal where we have <strong>Foremost </strong>running and start the file carving process.</span></p>
<p><span style="color: #000000;">This disk image file will be carved for .<strong>jpeg, </strong>.<strong>png, .zip, .pdf and .avi </strong> file formats. We will not be instructing <strong>Foremost</strong> to carve the <strong>.docx</strong> but, since one exists in the <strong>.zip </strong>we have placed inside the disk image, it will do so automatically.</span></p>
<p><span style="color: #000000;">Type the following <strong>“foremost -t jpeg,png,zip,pdf,avi -i disk.img -o recov –v”</strong>.</span></p>
<p><span style="color: #000000;">To break this down <strong>“-t” </strong>is setting the file types we want to carve out of the disk image, here those are .jpeg and .png.</span></p>
<ul>
<li><span style="color: #000000;">The “-i” option specifies the input file, the “disk.img” that resides on the desktop.</span></li>
<li><span style="color: #000000;">The “-o” option instructs Foremost where we want to store the carved files; we created the “recov” folder on the desktop for that purpose.</span></li>
<li><span style="color: #000000;">The “-v” option instructs Foremost to log all the messages that appear on screen as the file carves into a text file in the output folder (recov) as an audit report.</span></li>
</ul>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ehA3zHKFd80/WloiSxq5GdI/AAAAAAAATRQ/Ymhak9IImjsMePvB34uFQi01ZoLsCoFRgCLcBGAs/s1600/8.PNG"/></span></p>
<h3><span style="color: #800000;">Analyzing the Carving Output</span></h3>
<p><span style="color: #000000;">That’s all it takes for Foremost to start digging into the disk image. The process looks like this.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WafWMSidF-M/WloiTWkI6GI/AAAAAAAATRY/-OFylXugET4IdzYrjDknTVLzW12Mh6mmACLcBGAs/s1600/9.PNG"/></span></p>
<p><span style="color: #000000;">Once Foremost finishes carving the disk image, it shows you the result: that is, how many of which file types it carved. All it took was a second to get the job done.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-IgLd47aAaSs/WloiNUNqWDI/AAAAAAAATQQ/6jomjgRbnAcxE4DMJEWWW5CyJy9JyfHYQCLcBGAs/s1600/10.PNG"/></span></p>
<p><span style="color: #000000;">Now open the output (recov) folder, and you will see an audit report and six folders named by the file types we invoked Foremost to carve for us.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qDq_3mm37FU/WloiNX8s5nI/AAAAAAAATQU/gqmidQiIUKsXn5X7rOEL9X47fMeobI8oQCLcBGAs/s1600/11.PNG"/></span></p>
<p><span style="color: #000000;">First, the audit report. It provides us with the particulars of the scan, which file types it carved, from which image file, the size of the image file, where it located the image file, where it located the output folder, etc.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-F2L0EFOlvbg/WloiO2TZJvI/AAAAAAAATQg/PMbvUoteYw8nroiM9-B9vKwCN9lvRgd8QCLcBGAs/s1600/12.PNG"/></span></p>
<p><span style="color: #000000;">The end of the report contains shows the total files extracted with more particulars.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-cbQ-IIa8J3o/WloiPcNc6BI/AAAAAAAATQc/QOpDCTVBn2cZaw3MFjm2B4Nz67w9o81oQCLcBGAs/s1600/13.PNG"/></span></p>
<p><span style="color: #000000;">We will open one file from the <strong>jpg </strong>folder to see what we have.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-odOwlV4lN_I/WloiP3zF-EI/AAAAAAAATQk/LCFRPCLMvQMy3yRSdiRkYYmbh78yrVlIwCLcBGAs/s1600/14.PNG"/></span></p>
<p><span style="color: #000000;">One from the <strong>png</strong> folder.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-zX-V8KC1P74/WloiPyVTKuI/AAAAAAAATQo/e3u5dr0W6UI5T9LEqpt6RtvZJ_yXRuFeACLcBGAs/s1600/15.PNG"/></span></p>
<p><span style="color: #000000;">Inside the <strong>docx</strong> folder.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-yMob2NJ5PEk/WloiQEKcr_I/AAAAAAAATQs/o55y7K2dlZgr3BEGUK89O_QLvnqrzxuIwCLcBGAs/s1600/16.PNG"/></span></p>
<p><span style="color: #000000;">Inside the <strong>pdf</strong> folder.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-tE8Ap-hyQSU/WloiQU9xs4I/AAAAAAAATQw/lM8jNtOZNg0QyAxq36n1O2XzK8KwnPOJQCLcBGAs/s1600/17.PNG"/></span></p>
<p><span style="color: #000000;">Now the <strong>avi </strong>folder</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NLzbc3GxvlM/WloiQrs-sgI/AAAAAAAATQ0/2Q0NV1qfBSUV2HKfbwRgeiwrTrK9o6NEgCLcBGAs/s1600/18.PNG"/></span></p>
<p><span style="color: #000000;">And finally the <strong>zip </strong>folder.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-GDd3hYWzYaE/WloiQ8J2RrI/AAAAAAAATQ4/u03s2bz2vEg-qXDtYtQHdGNJOy4GUA0MgCLcBGAs/s1600/19.PNG"/></span></p>
<h3><span style="color: #800000;">Conclusion</span></h3>
<p><span style="color: #000000;">As you can see, Foremost was successfully able to carve files out of the disk image file and give us the results. Let’s put it to the test.</span></p>
<p><span style="color: #000000;">This a very interesting tool and its simplicity is what makes it stand out.</span></p>
<p><span style="color: #000000;">The only issue I could see with this is that the system does not recover the file names, which can make the search process very tedious unless you provide the option of automation and a frame of reference.</span></p>
<p><span style="color: #000000;">That being said, in forensics, just recovering the files without opening or extracting the disk image itself provides you a huge advantage. I say this because if you extract or open the disk image, you never know what might be waiting for you inside, which grants you more control over the entire investigation process. Enjoy using this tool.</span></p>
<p><span style="color: #000000;">Have fun and stay ethical.</span></p>
<p><span style="color: #000000;">To learn more about Cyber Forensics. Follow this <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/category/cyber-forensics-tricks/">Link</a></strong></span></span></p>
<p><span style="color: #000000;"><strong>Author: </strong></span><span style="color: #000000;">Abhimanyu Dev is a Certified Ethical Hacker, penetration tester, information security analyst and researcher. Connect with him <strong><a style="color: #000000;" href="http://www.linkedin.com/in/abhimanyudev">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
