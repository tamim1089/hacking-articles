<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">ICMP Penetration Testing</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/icmp-penetration-testing/" rel="bookmark"><time class="entry-date published" datetime="2018-01-03T17:41:47+00:00">January 3, 2018</time><time class="updated" datetime="2024-08-19T18:18:40+00:00">August 19, 2024</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In our previous article, we had discussed “<a style="color: #000000;" href="http://www.hackingarticles.in/understanding-guide-icmp-protocol-wireshark/"><strong>ICMP protocol with Wireshark</strong></a>” where we had seen how an ICMP protocol work at layer 3 according to the OSI model and study its result using Wireshark. Today we are going discuss to ICMP penetration testing by crafting ICMP packet to test our IDS “Snort” against all ICMP message Types using Cat Karat tool, you can download it from <a style="color: #000000;" href="https://www.colasoft.com/packet_builder/"><strong>http://packetbuilder.net</strong></a> link.</span></p>
<p><span style="color: #000000;">For configuring Snort as IDS read our previous article “<a style="color: #000000;" href="https://www.hackingarticles.in/comprehensive-guide-on-snort-part-1/"><strong>Configure snort in Ubuntu</strong></a>” it will automatically install snort in your system with a predefined set of rules that will help in packet capturing of your network.</span></p>
<p><span style="color: #000000;"><strong>Let’s start!!</strong></span></p>
<p><span style="color: #000000;"><strong> </strong>Basically, we will perform this practical in three phases as described below:</span></p>
<p><span style="color: #000000;"><strong>Packet crafting:</strong> In this phase, we will craft each ICMP packet with a different type of ICMP message using Cat Karat. For more detail about Packet crafting process read our previous <a style="color: #000000;" href="http://www.hackingarticles.in/packet-crafting-colasoft-packet-builder/"><strong>article</strong></a>.</span></p>
<p><span style="color: #000000;"><strong>Packet Capturing:</strong> In this phase, we will capture the ICMP packet and receive an alert when it will enter into the target’s network using snort as IDS.</span></p>
<p><span style="color: #000000;"><strong>Packet Analysis:</strong> In this phase, we will investigate the captured packet using Wireshark.</span></p>
<h3><span style="color: #800000;"><strong>Brief Introduction on ICMP Protocol</strong></span></h3>
<p><span style="color: #000000;">ICMP message contains two types of codes i.e. query and error.</span></p>
<p><span style="color: #000000;"><strong>Query:</strong> The query messages are the information we get from a router or another destination host.</span></p>
<p><span style="color: #000000;">For example, given below message types are some ICMP query codes:</span></p>
<ul>
<li><span style="color: #000000;">Type 0 = Echo Reply</span></li>
<li><span style="color: #000000;">Type 8 = Echo Request</span></li>
<li><span style="color: #000000;">Type 9 = Router Advertisement</span></li>
<li><span style="color: #000000;">Type 10 = Router Solicitation</span></li>
<li><span style="color: #000000;">Type 13 = Timestamp Request</span></li>
<li><span style="color: #000000;">Type 14 = Timestamp Reply</span></li>
</ul>
<p><span style="color: #000000;"><strong>Error:</strong> The error statement messages reports problem which a router or a destination host may generate.</span></p>
<p><span style="color: #000000;">For example: given below message types are some of the ICMP error codes:</span></p>
<ul>
<li><span style="color: #000000;">Type 3 = Destination Unreachable</span></li>
<li><span style="color: #000000;">Type 4 = Source Quench</span></li>
<li><span style="color: #000000;">Type 5 = Redirect</span></li>
<li><span style="color: #000000;">Type 11 = Time Exceeded</span></li>
<li><span style="color: #000000;">Type 12 = Parameter Problems</span></li>
</ul>
<p><span style="color: #000000;">Now when you will run the installed application “Cat KARAT” you will observe three important sections “Interfaces”, “Packet flow” and Packet view which in their default state as shown in given below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NKHYA2r1xRk/Wkz8dmcgnlI/AAAAAAAATHU/2Rlu_J7uBvwbzEr8dsgWd0g3EVBwliSDACEwYBhgL/s1600/1.png"/></span></p>
<h3><span style="color: #800000;"><strong>Message TYPE 0 ICMP Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">So as we know in <strong>Packet Crafting</strong> Operation “<strong>Packet Assembly”</strong> is the 1st phase where we need to decide protocol for crafting any packet, which is quite easy to select with this tool. Only enable the radio button for selecting protocol and direction flow of packet. Here I had enabled radio buttons for “IPv4” and “ICMP” without disturbing remaining default packet flow as shown given below image.</span></p>
<p><span style="color: #000000;">Next, we need to select the “interface” which you can select from the Interfaces by double-Click on it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DcKZG_XZJ24/Wkz8g-o5L_I/AAAAAAAATHU/h9qRp0yBRHEe-mOJAy5LhjXsDKy5cokoQCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Now next is “<strong>packet Editing”</strong> phase where you need to specify the source IP address such as <strong>192.168.1.2</strong> from which packet will be sent and Destination IP address such as <strong>192.168.1.107</strong> on which packet is received. Moreover, you can also make some changes in your packet such as Time to live (TTL), Data length and also can go with packet fragmentation.</span></p>
<p><span style="color: #000000;">From given below image you can observe I had added source and destination IP in the packet under the third section <strong>protocol view -&gt; Ipv4</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-VRHKfeamr7Y/Wkz8mOVp5KI/AAAAAAAATEo/VfZ0dq0zGxo7uLaVTbrz1rrEBQ7JsuD2ACEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Under the 3<sup>rd</sup> section protocol view in catKarat explore <strong>ICMP tab</strong> and select “0-Echo Response” option which generates type 0 ICMP message. Once everything is edited then your packet is ready to send on the target network. <strong>Click</strong> on <strong>play</strong> button given in menu bar for sending the packet on target’s network which known as “packet playing” phase of packet Crafting operation. This ICMP message type also uses to test the strength of IDS and Firewall against ICMP smurf Dos Attack.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LpP8wDxd_Ag/Wkz8pLxxgBI/AAAAAAAATGE/vDvheOsMzqcFsxGobSsMLYD1yFiW1eMMQCEwYBhgL/s1600/5.png"/></span></p>
<h3><span style="color: #800000;"><strong>Capturing ICMP-Type0 packet through IDS</strong></span></h3>
<p><span style="color: #000000;">The advantage of install snort through apt respiratory is that it is quick and easy to install in your system as well as it contains a predefined set of rule files related to every type of network traffic either TCP/UDP or ICMP.</span></p>
<p><span style="color: #000000;">From given below image you can observe that inside the file “icmp-info rules” an alert rule is already implemented for capturing the traffic of <strong>ICMP echo Reply </strong>packet is found in the network. This rule also works against Smurf Dos attack in which ICMP echo reply/response traffic is received on the target’s network without sending genuine ICMP request packet from the target’s network to another network.</span></p>
<p><span style="color: #000000;">Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-5IoVH__Zpiw/Wkz8rDhiYrI/AAAAAAAATG4/orRA7p2fYVERutySsKSYj-IcBMTiUM5zgCEwYBhgL/s1600/6.jpg"/></span></p>
<p><span style="color: #000000;">So when IDS received any matching packets defined in a file of rules then generate an alert for the captured packet. From given below image you can observe that an alert is generated by snort for “ICMP Echo Reply” packets from source address 192.168.1.1.2 to destination 192.168.1.107.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-vusmuTvVQ78/Wkz8ry6elkI/AAAAAAAATHE/WXC5Cav1iSQTzLgZa4B9IlxQ0zUW0zDLACEwYBhgL/s1600/7.jpg"/></span></p>
<h3><span style="color: #800000;"><strong>Analysis ICMP-Type0 packet through Wireshark</strong></span></h3>
<p><span style="color: #000000;">Now the Last phase is <strong>Packet Analysis</strong> which is also the last mode of operation of packet crafting process where the received packet is analysis using packet analysis tool. Here we had to use Wireshark for capturing incoming traffic. From given below image you can observe that Wireshark has captured exactly same information which we had a bind in the packet during packet Assembly and packet Editing mode such as ICMP protocol, ICMP message type packet, and other information.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-BYKRLuhazG4/Wkz8r71DBoI/AAAAAAAATHM/RyUHeiqOhQ8BSYzzIznI8DQRfWZXP-FTACEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">When the tester will click on <strong>Stop button</strong> given in the menu bar of Cat Karat tool he will receive the status of the sent packet either as successful or as failed.</span></p>
<p><span style="color: #000000;">From given below image you can perceive that our ICMP Type 0 is successfully sent on the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-csdw7Sx67aM/Wk0EhF58jkI/AAAAAAAATHo/RaenwUXmIW8qQSrevwcU-i-nADmx7n0swCEwYBhgL/s1600/9.png"/></span></p>
<h3><span style="color: #800000;"><strong>Message TYPE 1 ICMP Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">So the Packet Assembly phase and Packet Editing phase for ICMP packet crafting are almost the same as above only the difference is made in change ICMP message through which connection will be established with the target network.</span></p>
<p><span style="color: #000000;">Since we want to send traffic through message type 1 packets for establishing a connection with target network therefore select <strong>Type -1 Reserved </strong>from the given list<strong>.</strong></span></p>
<p><span style="color: #000000;">Once everything is edited then your packet is ready to send on the target network. <strong>Click</strong> on <strong>play</strong> button given in menu bar for sending the packet on target’s network which known as “packet playing” phase of packet Crafting operation.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-IBLcC2FQ5xA/Wkz8dwAKXtI/AAAAAAAATHc/EZJ7E84oEgkLFRAwE8RXjWxrhuE3p2RywCEwYBhgL/s1600/10.png"/></span></p>
<h3><span style="color: #800000;"><strong>Capturing ICMP-Type1 packet through IDS</strong></span></h3>
<p><span style="color: #000000;">From given below image you can observe that inside the file “icmp-info rules” an alert rule is already implemented for capturing the traffic of <strong>ICMP unassigned type 1 </strong>packet is found in the network.</span></p>
<p><span style="color: #000000;">Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wWwn5gDnUe8/Wkz8eUclvlI/AAAAAAAATHg/-YBkr5rG9JMv61UiwCM598b-DFkeNxeMQCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">So when IDS received any matching packets defined in a file of rules then generate an alert for the captured packet. From given below image you can observe that an alert is generated by snort for “ICMP unassigned type 1” packets from source address 192.168.1.1.2 to destination 192.168.1.107.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-n1SGWlgEFP4/Wkz8e0v_sJI/AAAAAAAATHk/RK0F1v6esDoNcYe_TSOeC0j-oEDj15lRQCEwYBhgL/s1600/12.jpg"/></span></p>
<h3><span style="color: #800000;"><strong>Analysis ICMP-Type1 packet through Wireshark</strong></span></h3>
<p><span style="color: #000000;">From given below image you can observe that Wireshark has captured exactly same information which we had a bind in the packet during packet Assembly and packet Editing mode such as ICMP protocol, ICMP message type “Reserved”  packets and other information.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-_LHsRYNFiIM/Wkz8e4iHYAI/AAAAAAAATHU/uar0FmObjNcrsbLp2kXkWGLjkPIV5FwwACEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">When the tester will click on the<strong> Stop button,</strong> he will receive the status of the sent packet either as successful or as failed.</span></p>
<p><span style="color: #000000;">From given below image you can perceive that our ICMP Type 1 is successfully sent on the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YxG8P-olY0E/Wkz8ezrG-wI/AAAAAAAATHU/dLAGZG6acw8eTvEbtrW8FjiexzcvGuSXgCEwYBhgL/s1600/14.png"/></span></p>
<h3><span style="color: #800000;"><strong>Message TYPE 2 ICMP Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">Again the Packet Assembly phase and Packet Editing phase for ICMP packet crafting are almost the same as above only the difference is made in change ICMP message through which connection will be established with target network.</span></p>
<p><span style="color: #000000;">Since we want to send traffic through only message type 2 packets for establishing a connection with target network therefore select <strong>Type 2 Reserved </strong>from the given list<strong>.</strong></span></p>
<p><span style="color: #000000;">Once everything is edited then your packet is ready to send on the target network. <strong>Click</strong> on <strong>play</strong> button for sending the packet on target’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-8GrRJo5pYIc/Wkz8ffk1jOI/AAAAAAAATHg/W8KEN_tBPLEx-HVTIKSLfgHsb0dX0g6-wCEwYBhgL/s1600/15.png"/></span></p>
<h3><span style="color: #800000;"><strong>Capturing ICMP-Type2 packet through IDS</strong></span></h3>
<p><span style="color: #000000;">From given below image you can observe that inside the file “icmp-info rules” an alert rule is already implemented for capturing the traffic of <strong>ICMP unassigned type 2 </strong>packet is found in the network.</span></p>
<p><span style="color: #000000;">Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Jtg8-xEEyjg/Wkz8fvO2u7I/AAAAAAAATHU/DMZu8Tq7s-MtJBYnDaA-jISNKoNp5IeyQCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">So when again our IDS received any matching packets defined in its file of rules then generate an alert for the captured packet. From given below image you can observe that an alert is generated by snort for “ICMP unassigned type 2” packets from source address 192.168.1.1.2 to destination 192.168.1.107.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-RCSoirYHNeU/Wkz8gGFeFCI/AAAAAAAATHU/uAPjT8bMf-oVOJ7oHPrUAc7F1ehtFjk3ACEwYBhgL/s1600/17.jpg"/></span></p>
<h3><span style="color: #800000;"><strong>Analysis ICMP-Type2 packet through Wireshark</strong></span></h3>
<p><span style="color: #000000;">Here also the Wireshark has captured exactly same information as per our prediction and fetch same details which we had a bind in the packet during packet Assembly and packet Editing mode such as ICMP protocol, ICMP message “Reserved” packet and other information.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-j4OeOXWCEPI/Wkz8gZY7PPI/AAAAAAAATHU/xSTX7F541h4HveO6yKZ9p8wUlrabgyIzgCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Again when the tester will click on the<strong> Stop button,</strong> he will receive the status of the sent packet either as successful or as failed.</span></p>
<p><span style="color: #000000;">From given below image you can perceive that our ICMP Type 2 is successfully sent on the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-p8dgw444TZo/Wkz8gRTT0VI/AAAAAAAATHg/aKC2xP6zoPkXkznZS1DUwfiT8PSERgUWgCEwYBhgL/s1600/19.png"/></span></p>
<h3><span style="color: #800000;"><strong>Message TYPE 3 ICMP Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">Now we want to send traffic through message type 3 packets for establishing a connection with the target network, therefore, select <strong>Type 3 Destination Unreachable </strong>from the given list<strong>.</strong></span></p>
<p><span style="color: #000000;">Once everything is edited then your packet is ready to send on the target network. <strong>Click</strong> on <strong>play</strong> button given in menu bar for sending the packet on target’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-MPUbVf7LjD8/Wkz8g2I24oI/AAAAAAAATCc/vunakk868fwaMwwrSDo0Hj6jdr8Xz0LaACEwYBhgL/s1600/20.png"/></span></p>
<h3><span style="color: #800000;"><strong>Capturing ICMP-Type3 packet through IDS</strong></span></h3>
<p><span style="color: #000000;">From given below image you can observe that inside the file “icmp-info rules” an alert rule is already implemented for capturing the traffic of <strong>ICMP Destination Unreachable  Network Unreachable </strong>packet when found in the network.</span></p>
<p><span style="color: #000000;">Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-FJaN0Aekx0c/Wkz8hZJ4DGI/AAAAAAAATHk/39_jJNbWXywsSWWKWEyV8m_NnnPBwR9bQCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">As said above so when IDS received any matching packets defined in a file of rules then generate an alert for the captured packet. From given below image you can observe that an alert is generated by snort for “ICMP Destination Unreachable Network Unreachable” packets from source address 192.168.1.1.2 to destination 192.168.1.107.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-oCarJxQTWVY/Wkz8htWVZAI/AAAAAAAATCs/PcineSaBRLsrGRoQNNmp6w4CBDtt-LJEACEwYBhgL/s1600/22.jpg"/></span></p>
<h3><span style="color: #800000;"><strong>Analysis ICMP-Type3 packet through Wireshark</strong></span></h3>
<p><span style="color: #000000;">From given below image you can observe that Wireshark has captured exactly same information which we had a bind in the packet during packet Assembly and packet Editing mode such as ICMP protocol, ICMP message type “Destination Unreachable” (Network Unreachable) packet and other information.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ZuCaaHC-2ug/Wkz8hrY0dpI/AAAAAAAATHk/3WlcLfteYPc9JOU2SIJMI-x48Mid0SY-gCEwYBhgL/s1600/23.png"/></span></p>
<p><span style="color: #000000;">Again when the tester will click on the<strong> Stop button,</strong> he will receive the status of the sent packet either as successful or as failed.</span></p>
<p><span style="color: #000000;">From given below image you can perceive that our ICMP Type 3 is successfully sent on the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-i7Ijio9Qwuc/Wkz8hzmm6xI/AAAAAAAATCw/ZBO0rGueLp8HYGoPoLgbmzADFrv7p7ihQCEwYBhgL/s1600/24.png"/></span></p>
<h3><span style="color: #800000;"><strong>Message TYPE 4 ICMP Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">So the Packet Assembly phase and Packet Editing phase for ICMP packet crafting are almost the same as above only the difference is made in change ICMP message through which connection will be established with the target network.</span></p>
<p><span style="color: #000000;">Since we want to send traffic through message type 4 packets for establishing a connection with target network therefore select <strong>Type 4 Source Quench </strong>from the given list<strong>.</strong></span></p>
<p><span style="color: #000000;">Once everything is edited then your packet is ready to send on the target network. <strong>Click</strong> on <strong>play</strong> button given in menu bar for sending the packet on target’s network which known as “packet playing” phase of packet Crafting operation.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-X2P_F2JgUwM/Wkz8idjZ5aI/AAAAAAAATC0/lr8mDHKCKKAJdiCdaBYwo9cY4JVGsrUDwCEwYBhgL/s1600/25.png"/></span></p>
<h3><span style="color: #800000;"><strong>Capturing ICMP-Type4 packet through IDS</strong></span></h3>
<p><span style="color: #000000;">From given below image you can observe that inside the file “icmp-info rules” an alert rule is already implemented for capturing the traffic of <strong>ICMP Source Quench </strong>packet when found in the network.</span></p>
<p><span style="color: #000000;">Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-9KRas38v9Qo/Wkz8il69ErI/AAAAAAAATC8/kLQesL4fpsA0l7C2GXT3bgZpSAI__l5VQCEwYBhgL/s1600/26.png"/></span></p>
<p><span style="color: #000000;">So when IDS received any matching packets defined in a file of rules then generate an alert for the captured packet. From given below image you can observe that an alert is generated by snort for “ICMP Source Quench” packets from source address 192.168.1.1.2 to destination 192.168.1.107.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-xBmSGh4BJZQ/Wkz8i3FIJwI/AAAAAAAATHc/79CiRtGlbh4_pnA24_am0CGwulklnDHWgCEwYBhgL/s1600/27.jpg"/></span></p>
<h3><span style="color: #800000;"><strong>Analysis ICMP-Type4 packet through Wireshark</strong></span></h3>
<p><span style="color: #000000;">Here also the Wireshark has captured exactly same information as per our prediction and fetch same details which we had a bind in the packet during packet Assembly and packet Editing modes such as ICMP protocol, ICMP message type “Source quench” packet and other information.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5H2oJdz-bg4/Wkz8jHuJPlI/AAAAAAAATDI/OFDr7b_s-eUNKMgeDwUq4w8BtAO341QkgCEwYBhgL/s1600/28.png"/></span></p>
<p><span style="color: #000000;">Again when the tester will click on the<strong> Stop button,</strong> he will receive the status of the sent packet either as successful or as failed.</span></p>
<p><span style="color: #000000;">From given below image you can perceive that our ICMP Type 4 is successfully sent on the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-0DNsmz4hnxw/Wkz8jM3eCVI/AAAAAAAATDE/WUbc4cLbKgYmVcUGaaWr7sD1PZ73ekQMwCEwYBhgL/s1600/29.png"/></span></p>
<h3><span style="color: #800000;"><strong>Message TYPE 5 ICMP Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">We want to send traffic through message type 5 packets for establishing a connection with the target network, therefore, select <strong>Type 5 Redirect </strong>from the given list<strong>.</strong></span></p>
<p><span style="color: #000000;">Once everything is edited then your packet is ready to send on the target network. <strong>Click</strong> on <strong>play</strong> button given in menu bar for sending the packet on target’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-yK1G5m3MRj8/Wkz8jYsdqII/AAAAAAAATDQ/iTqn3B1PlnMAWGxEfCAqQX9CATadRuXqQCEwYBhgL/s1600/30.png"/></span></p>
<h3><span style="color: #800000;"><strong>Capturing ICMP-Type5 packet through IDS</strong></span></h3>
<p><span style="color: #000000;">As given in below image you can observe that inside the file “icmp-info rules” an alert rule is already implemented for capturing the traffic of <strong>ICMP redirect net </strong>packet when found in the network.</span></p>
<p><span style="color: #000000;">Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-rUskARGGwHs/Wkz8j5yJnwI/AAAAAAAATDg/B-YiJQGHR_gJAEbOuQuZXwOow0PrA9C3wCEwYBhgL/s1600/31.png"/></span></p>
<p><span style="color: #000000;">So when IDS received any matching packets defined in a file of rules then generate an alert for the captured packet. From given below image you can observe that an alert is generated by snort for “ICMP Redirect net” packets from source address 192.168.1.1.2 to destination 192.168.1.107.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-R5eWue4OJ3I/Wkz8jyTGu5I/AAAAAAAATDk/82ykDBv1yIM1pRa3NoUAnnqj2fA_4dWowCEwYBhgL/s1600/32.jpg"/></span></p>
<h3><span style="color: #800000;"><strong>Analysis ICMP-Type5 packet through Wireshark</strong></span></h3>
<p><span style="color: #000000;">Again as per our prediction, Wireshark has captured exactly same information which we had a bind in the packet during packet Assembly and packet Editing mode such as ICMP protocol, ICMP message type “redirect” packet and other information.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JzOUSjJEmBc/Wkz8karQhwI/AAAAAAAATDs/38lc-tHLRlQrhA9FZFWbXL0A6TDzNG0kwCEwYBhgL/s1600/33.png"/></span></p>
<p><span style="color: #000000;">Again when the tester will click on the<strong> Stop button,</strong> he will receive the status of the sent packet either as successful or as failed.</span></p>
<p><span style="color: #000000;">From given below image you can perceive that our ICMP Type 5 is successfully sent on the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-hlRINRC_TMM/Wkz8kTXtPII/AAAAAAAATD0/CUZbpyd2esU-GoxEALvm257a2OitPT2EACEwYBhgL/s1600/34.png"/></span></p>
<h3><span style="color: #800000;"><strong>Message TYPE 6 ICMP Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">So the Packet Assembly phase and Packet Editing phase for ICMP packet crafting are almost the same as above only the difference is made in change ICMP message through which connection will be established with the target network.</span></p>
<p><span style="color: #000000;">Here now next we want to send traffic through message type 6 packets for establishing a connection with target network, therefore, select <strong>Type 6 </strong>for Alternate Host Address from the given list<strong>.</strong></span></p>
<p><span style="color: #000000;">Once everything is edited then your packet is ready to send on the target network. <strong>Click</strong> on <strong>play</strong> button given in menu bar for sending the packet on target’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-2asngdaLCzE/Wkz8kVxzlnI/AAAAAAAATD8/CzFaWp7SnAw0Z9oL0LRNRj1_9X5kYwH1wCEwYBhgL/s1600/35.png"/></span></p>
<h3><span style="color: #800000;"><strong>Capturing ICMP-Type6 packet through IDS</strong></span></h3>
<p><span style="color: #000000;">From given below image you can observe that inside the file “icmp-info rules” an alert rule is already implemented for capturing the traffic of <strong>ICMP Alternate Host Address </strong>packet is found in the network.</span></p>
<p><span style="color: #000000;">Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-WYzCg-o0LC0/Wkz8lW9LfPI/AAAAAAAATEU/88cqNbxBaMU0m3BKoD1JAUWfIiLVoAi6QCEwYBhgL/s1600/36.png"/></span></p>
<p><span style="color: #000000;">So when IDS received any matching packets defined in a file of rules then generate an alert for the captured packet. From given below image you can observe that an alert is generated by snort for “<strong>ICMP Alternate Host Address</strong>” packets from source address 192.168.1.1.2 to destination 192.168.1.107.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-wrK-teMPlvI/Wkz8lJ0w99I/AAAAAAAATEM/Yx6gCP5qdbIJ--ghVqObU4RasPMASIhaQCEwYBhgL/s1600/37.jpg"/></span></p>
<h3><span style="color: #800000;"><strong>Analysis ICMP-Type6 packet through Wireshark</strong></span></h3>
<p><span style="color: #000000;">From given below image you can observe that Wireshark has captured exactly same information which we had a bind in the packet during packet Assembly and packet Editing mode such as ICMP protocol, ICMP message type “Alternate Host Address” packet and other information.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-JSY3nNfL9gc/Wkz8lQI94PI/AAAAAAAATEc/PketBmJgiiEvVuSIDCSvrsLYMFypTxI3gCEwYBhgL/s1600/38.png"/></span></p>
<p><span style="color: #000000;">Again when the tester will click on the <strong>Stop button,</strong> he will receive the status of the sent packet either as successful or as failed.</span></p>
<p><span style="color: #000000;">From given below image you can perceive that our ICMP Type 6 is successfully sent on the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-enU8IerVsO0/Wkz8lxmJN8I/AAAAAAAATEg/0231YnPpy94Xn5clBvgnfmPn--YBuijDwCEwYBhgL/s1600/39.png"/></span></p>
<h3><span style="color: #800000;"><strong>Message TYPE 7 ICMP Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">Again Repeat the same and send traffic through message type 7 packets for establishing a connection with the target network, therefore, select <strong>Type 7 </strong>for <strong>Unassigned</strong> from the given list<strong>.</strong></span></p>
<p><span style="color: #000000;">Once everything is edited then your packet is ready to send on the target network. <strong>Click</strong> on <strong>play</strong> button given in menu bar for sending the packet on target’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ycdOz1BHuDc/Wkz8mADbN4I/AAAAAAAATEw/5sCltgS4VyUEpuOtn_Zo-Qy4v58Sr6azgCEwYBhgL/s1600/40.png"/></span></p>
<h3><span style="color: #800000;"><strong>Capturing ICMP-Type7 packet through IDS</strong></span></h3>
<p><span style="color: #000000;">From given below image you can observe that inside the file “icmp-info rules” an alert rule is already implemented for capturing the traffic of <strong>ICMP Alternate Host Address </strong>packet is found in the network.</span></p>
<p><span style="color: #000000;">Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-gBga0Makf3E/Wkz8m3n33nI/AAAAAAAATHg/d5liSUkBuxggShWQqqnAYuuqtP-FFXsLACEwYBhgL/s1600/41.png"/></span></p>
<p><span style="color: #000000;">Therefore when IDS received any matching packets described in the file of rules then it will generate an alert for the captured packet. From given below image you can observe that an alert is generated by snort for “ICMP unassigned type 7” packets from source address 192.168.1.1.2 to destination 192.168.1.107.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-mDpf4pVQg8o/Wkz8nerhSpI/AAAAAAAATHc/gCcyR1Q0scweIlsP-beU6NQFtZuXsBPjwCEwYBhgL/s1600/42.jpg"/></span></p>
<h3><span style="color: #800000;"><strong>Analysis ICMP-Type7 packet through Wireshark</strong></span></h3>
<p><span style="color: #000000;">Wireshark has captured exactly the same information which we had a bind in the packet during packet Assembly and packet Editing mode such as ICMP protocol, ICMP unknown message type “obsolete or malformed” packet and other information.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-tAxWN3-0KUw/Wkz8nsWXjTI/AAAAAAAATFI/p0iMIjljE-QFrJYXmB97qlewvpC6SE2qACEwYBhgL/s1600/43.png"/></span></p>
<p><span style="color: #000000;">Again when the tester will click on the<strong> Stop button,</strong> he will receive the status of the sent packet either as successful or as failed.</span></p>
<p><span style="color: #000000;">From given below image you can perceive that our ICMP Type 7 is successfully sent on the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CoLXu2UhVhU/Wkz8n7PyZpI/AAAAAAAATFY/ybVk7ud2Ce02mCr7KkIs33tW9WhPhJsNgCEwYBhgL/s1600/44.png"/></span></p>
<h3><span style="color: #800000;"><strong>Message TYPE 8 ICMP Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">Since we want to send traffic through message type 8 packets for establishing a connection with the target network, therefore, select <strong>Type 8 </strong>for <strong>ICMP echo Request</strong> from the given list<strong>.</strong></span></p>
<p><span style="color: #000000;">This step is very useful because it will craft a packet will send ICMP Request packet on the target’s network to test the strength of IDS and Firewall.</span></p>
<p><span style="color: #000000;">Infinite packet ICMP Request packet is considered as ICMP Flood or Ping of Death Attack when sent the only network, therefore, we can check our IDS and Firewall Strength against such DOS attack through this packet crafting.   </span></p>
<p><span style="color: #000000;">Once everything is edited then your packet is ready to send on the target network. <strong>Click</strong> on <strong>play</strong> button given in menu bar for sending the packet on target’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-89jO2FY2YnU/Wkz8n1m9cAI/AAAAAAAATHk/E59-bT_E3CsbmgbRlL2xdCJtoFrHLKiYQCEwYBhgL/s1600/45.png"/></span></p>
<h3><span style="color: #800000;"><strong>Capturing ICMP-Type8 packet through IDS</strong></span></h3>
<p><span style="color: #000000;">From given below image you can observe that inside the file “icmp-info rules” an alert rule is already implemented for capturing the traffic of <strong>ICMP Ping </strong>packet is found in the network. As we know ICMP Echo Request packet is considered as Ping request packet which sends a request to a network IP for establishing a connection with it.</span></p>
<p><span style="color: #000000;">Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-auP3iko16J8/Wkz8oVTyv0I/AAAAAAAATFg/bICHuZCqu78ilsvQI6rWQtgf4xtjbV3dACEwYBhgL/s1600/46.png"/></span></p>
<p><span style="color: #000000;">So when IDS received any matching packets defined in a file of rules then generates an alert for the captured packet. From given below image you can observe that an alert is generated by snort for “ICMP Ping ” packets from source address 192.168.1.1.2 to destination 192.168.1.107.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-mgumpVrdwcc/Wkz8or3-pCI/AAAAAAAATFw/Mp37p78Svj8fnuMWkYXS9DMzVXq_8lEsACEwYBhgL/s1600/47.jpg"/></span></p>
<h3><span style="color: #800000;"><strong>Analysis ICMP-Type8 packet through Wireshark</strong></span></h3>
<p><span style="color: #000000;">From given below image you can observe that Wireshark has captured Ping packet for ICMP Echo request as described above, exactly same information which we had a bind in packets such as ICMP protocol, ICMP Ping request message packet, and other information.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Y7xAZ6AitMg/Wkz8o4VHO7I/AAAAAAAATHc/r5XWI9b-kQE6v9C0so_TkMjgxjjizXIOQCEwYBhgL/s1600/48.png"/></span></p>
<p><span style="color: #000000;">Again when the tester will click on the<strong> Stop button,</strong> he will receive the status of the sent packet either as successful or as failed.</span></p>
<p><span style="color: #000000;">From given below image you can perceive that our ICMP Type 8 is successfully sent on the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-pvaWLOjV7rA/Wkz8owB3r6I/AAAAAAAATHk/A7Vaks44gUsC47wSLJJgERpfPSza7gqHgCEwYBhgL/s1600/49.png"/></span></p>
<h3><span style="color: #800000;"><strong>Message TYPE 9 ICMP Packet Crafting</strong></span></h3>
<p><span style="color: #000000;">Now, at last, we want to send traffic through message type 9 packets for establishing a connection with the target network, therefore, select <strong>Type 9 </strong>for <strong>Router Advertisement </strong>from the given list<strong>.</strong></span></p>
<p><span style="color: #000000;">Once everything is edited then your packet is ready to send on the target network. <strong>Click</strong> on <strong>play</strong> button given in menu bar for sending the packet on target’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-JJMGL9jvGfU/Wkz8pbbmjAI/AAAAAAAATHg/azZ5IPFsbcQfxTstnxAmlkJd75S0E8X_wCEwYBhgL/s1600/50.png"/></span></p>
<h3><span style="color: #800000;"><strong>Capturing ICMP-Type9 packet through IDS</strong></span></h3>
<p><span style="color: #000000;">From given below image you can observe that inside the file “icmp-info rules” an alert rule is already implemented for capturing the traffic of <strong>ICMP</strong> <strong>Router Advertisement </strong>packet is found in the network.</span></p>
<p><span style="color: #000000;">Now turn on IDS mode of snort by executing given below command in terminal:</span></p>
<pre class="lang:default decode:true ">sudo snort -A console -q -u snort -g snort -c /etc/snort/snort.conf -i eth0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BnC4Et7hB3w/Wkz8q23nuoI/AAAAAAAATGo/UkkhK_i7CVcqcnnERWPOSkIXhqck5lwZwCEwYBhgL/s1600/51.png"/></span></p>
<p><span style="color: #000000;">So when IDS received any matching packets defined in a file of rules then generate an alert for the captured packet. From given below image you can observe that an alert is generated by snort for “ICMP Router Advertisement” packets from source address 192.168.1.1.2 to destination 192.168.1.107.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-4VupOLkukHY/Wkz8qBotxdI/AAAAAAAATGc/xl3JJKvh7Jcf6tN4k_iAMWLcxwTcTziowCEwYBhgL/s1600/52.jpg"/></span></p>
<h3><span style="color: #800000;"><strong>Analysis ICMP-Type9 packet through Wireshark</strong></span></h3>
<p><span style="color: #000000;">From given below image you can observe that Wireshark has captured exactly same information which we had a bind in the packet during packet Assembly and packet Editing mode such as ICMP protocol, ICMP P ICMP Router Advertisement message packet and other information.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-TFscPVlX6_Y/Wkz8quW0lSI/AAAAAAAATGk/ajrUWfsF6WQARH6VS5XWd2250aiwLHPuwCEwYBhgL/s1600/53.png"/></span></p>
<p><span style="color: #000000;">Again when the tester will click on the<strong> Stop button,</strong> he will receive the status of the sent packet either as successful or as failed.</span></p>
<p><span style="color: #000000;">From given below image you can perceive that our ICMP Type 9 is successfully sent on the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-WeNbF0EMiCw/Wkz8qxsHGlI/AAAAAAAATHc/mp90f-2AprEH6aF9WkI_Y-ozsgModZdFwCEwYBhgL/s1600/54.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Rahul Virmani</strong> is a Certified Ethical Hacker and the researcher in the field of network Penetration Testing (CYBERSECURITY).    Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/rahul-virmani-4280666a/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
