<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Red Team/Blue Team Practice on Wdigest</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/red-team-blue-team-practice-on-wdigest/" rel="bookmark"><time class="entry-date published" datetime="2019-02-14T17:17:51+00:00">February 14, 2019</time><time class="updated" datetime="2025-06-03T13:01:17+00:00">June 3, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In this </span>article<span style="color: #000000;">, we will show you the methods of protecting your system against MIMIKATZ that fetches password in clear text from </span>wdigest<span style="color: #000000;">. As you know the Pen-tester and </span>the red<span style="color: #000000;"> team </span>uses<span style="color: #000000;"> mimikatz for testing password capacity. For the complete </span>information<span style="color: #000000;"> on how mimikatz works visit this link:</span></p>
<p class="ai-optimize-7"><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/understanding-guide-mimikatz/">https://www.hackingarticles.in/understanding-guide-mimikatz/</a></span></p>
<h3 class="ai-optimize-8"><span style="color: #800000;">Table of Contents</span></h3>
<ul>
<li class="ai-optimize-9"><span style="color: #000000;"><strong>Introduction</strong></span>
<ul>
<li class="ai-optimize-10"><span style="color: #000000;">System impacted</span></li>
</ul>
</li>
<li class="ai-optimize-11"><span style="color: #000000;"><strong>Demonstration on Windows 7</strong></span>
<ul>
<li class="ai-optimize-12"><span style="color: #000000;">Disable WDigest (defending against mimikatz)</span></li>
</ul>
</li>
<li class="ai-optimize-13"><span style="color: #000000;"><strong>Demonstration on Windows 10</strong></span>
<ul>
<li class="ai-optimize-14"><span style="color: #000000;">Enable WDigest in Windows 10</span></li>
<li class="ai-optimize-15"><span style="color: #000000;">Enable </span>WDigest<span style="color: #000000;"> via </span>the registry<span style="color: #000000;"> key</span></li>
</ul>
</li>
</ul>
<h3 class="ai-optimize-16"><span style="color: #800000;">Introduction of WDigest</span></h3>
<p class="ai-optimize-17"><span style="color: #000000;">Microsoft introduced WDigest.dll in the Windows XP operating system. In Windows XP, Microsoft added support for a protocol known as WDigest. The WDigest protocol allows clients to send clear-text credentials to Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) applications based on RFC 2617 and 2831. When the WDigest authentication protocol is enabled, it stores the clear text password, where it can be at risk of theft.</span></p>
<h5 class="ai-optimize-18"><span style="color: #000000;"><strong>System Impacted</strong></span></h5>
<p class="ai-optimize-19"><span style="color: #000000;">The problem with WDigest is that it stores passwords in memory in clear-text, and attackers can extract them by using MIMIKATZ. The following OSâ€™s are impacted: Windows 7, Windows 8, Windows 8.1, Windows Server 2008, Windows Server 2008R2, and Windows Server 2012.</span></p>
<h3 class="ai-optimize-20"><span style="color: #800000;">Demonstration on Windows 7</span></h3>
<p class="ai-optimize-21"><span style="color: #000000;">An attacker with administrator privileges can steal credentials from damaged system memory<strong data-start="104" data-end="199">.</strong> Since memory credentials are stored in plain text and in various hash formats, they can be extracted easily. First, we will demonstrate how we can see the password of Windows 7 using the MIMIKATZ tool, as shown in the image below, where it has revealed the password in clear text. For this, we will use the following commands in the MIMIKATZ tool.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">privilege::debug
sekurlsa::wdigest</pre>
<p class="ai-optimize-22"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-sE4_yzI9VUc/XGWdktezWrI/AAAAAAAAcmI/cuPEb408p28tU2W53b6-6IGt_sTU9aRXwCLcBGAs/s1600/1.png"/></span></p>
<p class="ai-optimize-23"><span style="color: #000000;">Now as you can observe that is has shown you the password in clear text. We can also do this by taking the Meterpreter of the target system and then using MIMIKATZ in Kali. Here you will see that it has also shown us the password of the compromised system.</span></p>
<p class="ai-optimize-24"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-Gnbea-gtBj8/XGWdl9ojlEI/AAAAAAAAcmY/v36cIafhSYYg7r4kwpGG-jx5ZrQME2_EACLcBGAs/s1600/2.png"/></span></p>
<p class="ai-optimize-25"><span style="color: #000000;"><strong>Disable WDigest (Defending against Mimikatz)</strong></span></p>
<p class="ai-optimize-26"><span style="color: #000000;">Now as we know that it is a security threat; so now we will discover how we can remove this from our system, and for this, we need to make a registry change to hide our password. For </span>this<span style="color: #000000;">, we will first open the </span>regedit<span style="color: #000000;"> and then go to WDigest option using the following path</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurityProviders\WDigest</pre>
<p class="ai-optimize-27"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-FNkm4UO6yhI/XGWdmem99MI/AAAAAAAAcmc/hnX1zBFgabkxP2fTe5xytUp4nrAUOTCLwCLcBGAs/s1600/3.png"/></span></p>
<p class="ai-optimize-28"><span style="color: #000000;">Here you need to open the security packages and you will see WDigest with the other options as shown in </span>the image<span style="color: #000000;"> below</span></p>
<p class="ai-optimize-29"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-DcB6Cge9EwA/XGWdmRykRxI/AAAAAAAAcmg/KMiQZS-KK4gCNp8hC5vTqULYbRX_Md0mgCLcBGAs/s1600/4.png"/></span></p>
<p class="ai-optimize-30"><span style="color: #000000;">Great! You have found that. Now simply you need to remove <strong>Wdigest</strong> from here so that nobody can see the password using MIMIKATZ tool.</span></p>
<p class="ai-optimize-31"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-4N4RAnlsW8g/XGWdmvwrBRI/AAAAAAAAcmk/MAJ4JtlHQjweziHxhmDfIX4wpraxDwA5ACLcBGAs/s1600/5.png"/></span></p>
<p class="ai-optimize-32"><span style="color: #000000;">Then, after making these </span>changes<span style="color: #000000;">, we need to update the group policy and reboot the system. After doing so we will again use <strong>MIMIKATZ </strong>tool to see the change now. So we will use the same commands which we have used earlier to get the password and this time it will show us the password <strong>NULL</strong> as </span>shown<span style="color: #000000;"> in the image.</span></p>
<p class="ai-optimize-33"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-_2llDO6Ck9g/XGWdnc6lMdI/AAAAAAAAcmo/x-rm7BuwdRMSotFqEATcgIudTNhlzNAbACLcBGAs/s1600/6.png"/></span></p>
<p class="ai-optimize-34"><span style="color: #000000;">Great! We have successfully hidden the password. </span>Now<span style="color: #000000;">, if somebody has taken the meterpreter of the Windows 7 and if the attacker tries this in kali using <strong>MIMIKATZ</strong> tool there. Even </span>then<span style="color: #000000;"> the attacker is not able to get the password of the compromised system as shown in the image below</span></p>
<p class="ai-optimize-35"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-TjjPP_hGP_w/XGWdns6MO7I/AAAAAAAAcms/io9sXWaHM9kzc7tkkM9iXB5tZ3NMI-YhgCLcBGAs/s1600/7.png"/></span></p>
<h3 class="ai-optimize-36"><span style="color: #800000;"><strong>Demonstration on Windows 10</strong></span></h3>
<p class="ai-optimize-37"><span style="color: #000000;">In the same </span>way<span style="color: #000000;">, we will try this method in <strong>Windows 10</strong> and as we know that in <strong>Windows 10</strong> it is disabled by default. We can verify this by using the <strong>MIMIKATZ</strong> tool there.</span></p>
<p class="ai-optimize-38"><span style="color: #000000;"><strong>Â <img decoding="async" src="//3.bp.blogspot.com/-XDBLlqaYu1Q/XGWdoIRBavI/AAAAAAAAcmw/lpIoy_VJj2wGzk7urHNXL3qthXgjGh5MQCLcBGAs/s1600/8.png"/></strong></span></p>
<p class="ai-optimize-39"><span style="color: #000000;"><strong>Enable WDigest in Windows 10 </strong></span></p>
<p class="ai-optimize-40"><span style="color: #000000;">Yes; as we have verified that the <strong>Wdigest</strong> option is disabled by default. Now we will learn how we can enable <strong>Wdigest</strong> in Windows 10. For this </span>first<span style="color: #000000;">, we need to take meterpreter of the target system and then we need to take the admin access of the system and then we need to use the exploit to enable <strong>Wdigest</strong> in the target system with the help of </span>the following<span style="color: #000000;"> module.</span></p>
<p class="ai-optimize-41"><span style="color: #000000;">On Windows 8/2012 or higher, the Digest Security Provider (</span>WDIGEST<span style="color: #000000;">) is disabled by default. This module enables/disables credential caching by adding/changing the value of the UseLogonCredential DWORD under the </span>WDIGEST<span style="color: #000000;"> providerâ€™s Registry key. Any subsequent logins will allow mimikatz to recover the plain text passwords from the systemâ€™s memory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use post/windows/manage/wdigest_caching
msf post(windows/manage/wdigest_caching) &gt; set session 2
msf post(windows/manage/wdigest_caching) &gt; exploit</pre>
<p class="ai-optimize-42"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-sNgeMG036AM/XGWdoN2cy5I/AAAAAAAAcm0/qfT7CObdpfgGMlFLa0Pmm07j0fCkZyQEQCLcBGAs/s1600/9.png"/></span></p>
<p class="ai-optimize-43"><span style="color: #000000;">After making the changes, we will check if the system enables the Wdigest option. For </span>this<span style="color: #000000;">, we will again use <strong>MIMIKATZ</strong> tool here and we will observe that we have found the password of the victimâ€™s P.C</span></p>
<p class="ai-optimize-44"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-iqRGO86-DK0/XGWdk5wY1RI/AAAAAAAAcmM/YQf5S-g_6hwangDPRYEAi53v7Vw_YTAywCLcBGAs/s1600/10.png"/></span></p>
<p class="ai-optimize-45"><span style="color: #000000;">We can do this too by taking the meterpreter of the system using <strong>MIMIKATZ</strong> tool there.</span></p>
<p class="ai-optimize-46"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-b7IJPjyLqYs/XGWdkjTi3bI/AAAAAAAAcmE/FWAmOKmTdRQvZLdgY9TTJtbZEx-NPj8pwCLcBGAs/s1600/11.png"/></span></p>
<p class="ai-optimize-47"><span style="color: #000000;"><strong>Enable Wdigest via a registry key</strong></span></p>
<p class="ai-optimize-48"><span style="color: #000000;">Additionally, there is one more way to see the password. <strong data-start="125" data-end="150" data-is-only-node="">In this second method</strong>, we enable WDigest by taking the shell of the compromised system. <strong data-start="217" data-end="225">Then</strong>, run the following command to enable WDigest</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1</pre>
<p class="ai-optimize-49"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-_jS_AiN6LAQ/XGWdlehqHDI/AAAAAAAAcmQ/0wtT6J2ecVUfhxrf8JXpJFbZlREs6KTjQCLcBGAs/s1600/12.png"/></span></p>
<p class="ai-optimize-50"><span style="color: #000000;">After you get the shell. Then, run the Mimikatz tool here, and we will use the same commands to see the password. And you will observe that we have got the password.</span></p>
<p class="ai-optimize-51"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-JohcUJItv8Y/XGWdlmyx1II/AAAAAAAAcmU/IrqIRCzY2owg4aBTcGRYA03VlWV0DWzPgCLcBGAs/s1600/13.png"/></span></p>
<p class="ai-optimize-52"><span style="color: #000000;">Excellent we have finally done this with this method also. And we know that how to see the password in <strong>Windows 10</strong> and how to enable and disable that.</span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To learn more about Red Teaming. Follow this</span>Â <strong><a href="https://www.hackingarticles.in/category/red-teaming/">link.</a></strong></p>
<p class="ai-optimize-53"><span style="color: #000000;"><b>Author</b>:Â Geet Madan is a CertifiedÂ Ethical Hacker, Researcher and Technical Writer at Hacking Articles on Information Security<b>. </b>Contact <a href="https://www.linkedin.com/in/geet-madan/"><b>here</b></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
