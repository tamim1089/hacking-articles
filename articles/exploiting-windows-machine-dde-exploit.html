<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Exploiting Windows Machine with DDE Exploit</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/exploiting-windows-machine-dde-exploit/" rel="bookmark"><time class="entry-date published" datetime="2017-11-13T05:05:49+00:00">November 13, 2017</time><time class="updated" datetime="2025-05-27T12:03:27+00:00">May 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">DDE stands for “Dynamic Data Exchange”, this is a method used by windows to facilitate one program being able to subscribe to an item made using another program. This exploit uses that functionality to exploit a victim endpoint. Once the victim clicks on the word file, an HTA payload is retrieved via HTTP and session is achieved.</span></p>
<p><span style="color: #000000;">Here is a step-by-step description of how it happens:</span></p>
<p><span style="color: #000000;">The code for the exploit has to be copied into Leafpad and saved with a “<strong>.rb</strong>” extension, you can name it anything you like, to avoid any confusion, ours is named “<strong>dde_delivery.rb</strong>”. This file has to now be moved into the windows section of the exploit folder in Metasploit, you can find the path and exploit URL below.</span></p>
<p><span style="color: #000000;"><strong>Exploit URL</strong> – <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/fileformat/office_dde_delivery.rb">https://raw.githubusercontent.com/realoriginal/metasploit-framework/fb3410c4f2e47a003fd9910ce78f0fc72e513674/modules/exploits/windows/script/dde_delivery.rb</a></span></p>
<p><span style="color: #000000;"><strong>Path of windows folder in Kali</strong> – usr &gt; share &gt; Metasploit-framework &gt; modules &gt; exploits &gt; windows</span></p>
<p><span style="color: #000000;">Here is what the exploit being pasted into the “<strong>windows</strong>” folder will look like.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-4djZS8kAbck/WgkmGMII_bI/AAAAAAAASTA/QbYmXjwm5RIU5crRH76sM2lfISob8FPRwCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Now open a terminal and start Metasploit, once it starts, type “<strong>use exploit/windows/dde_delivery</strong>” and the exploit will load. Once that is done, all you need to do is set srvhost, this is the host IP. Once the exploit loads, type “<strong>set srvhost</strong>” followed by your IP, you can see what that would look like in the screenshot given below.</span></p>
<p><span style="color: #000000;">Press enter and you’re all set.</span></p>
<p><span style="color: #000000;">Type “<strong>exploit</strong>” and press Enter.</span></p>
<p><span style="color: #000000;">You will see the code generated, it has been highlighted in the screenshot given below. Copy this code.</span></p>
<p><span style="color: #000000;">NOTE: Do not close the terminal, it must remain active throughout.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-qg4_eGkfZj0/WgkmGWiDWUI/AAAAAAAASTE/0aSOQQJufNgT7o9V3NCco_CWcr1suR7IQCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Open Microsoft Word, navigate to the “<strong>Insert</strong>” tab, under the “<strong>Text</strong>” section you will find “<strong>Quick Parts</strong>”, click on it and in the drop menu you will see “<strong>Field…</strong>”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-CTTIl_lvUVo/WgkmGvqg1zI/AAAAAAAASTI/r1eF5o1txG0pppb3SPVApTMPs00qT9jvwCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Click on “<strong>Field…</strong>”, another window will appear, by default, it will look like the screenshot pasted below, click OK</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-iEf4hi8y6ZY/WgkmHIYqkxI/AAAAAAAASTM/LFt8oFPVVIERs_6xC6KqwDexL8lAlfzKgCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Once you click on OK, a text will appear “<strong>! Unexpected End of Formula</strong>”, select this text and right click on it, in the menu choose the option “<strong>Toggle Field Codes</strong>”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-RNU963_IFz4/WgkmHRwpt_I/AAAAAAAASTQ/7c2To5hGdy02FGPQXzIPnb69VLYSZLV5QCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Once this is done, the text will change to <strong>“{  =\* MERGEFORMAT } “</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-kUO6-VgJRNs/WgkmHtzcJiI/AAAAAAAASTU/9gcZFE4hIwojTCqoNGNOx0s_wpl6RRxNACEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Paste the code you copied from Metasploit within the “<strong>{ }</strong>”, as seen below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Pzocn0W0Ccg/WgkmH6mpt5I/AAAAAAAASTY/ebgJOt0bYWIoIyyD-KyfvQpF_q6ok3XpgCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Save the file in a “<strong>.docx</strong>” format, you can name it anything you like and close Microsoft Word.</span></p>
<p><span style="color: #000000;">You now have a handy word file that can be opened on a Windows 10 machine to achieve session.</span></p>
<p><span style="color: #000000;">Here is what it looks like when the word file is opened:</span></p>
<p><span style="color: #000000;">Once the word file is opened, you will see the following message, click “<strong><u>Y</u>es”</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pHhhyXM6C20/WgkmIQRsVHI/AAAAAAAASTg/EH9ukq8MCKsfh2cxN5HDFltP36DP2CidQCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Next, this message will appear. Again, click “<strong>Yes”</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-3b7AQ6Idmeo/WgkmFE-nSDI/AAAAAAAASTg/74irW9rDwyUKUZJw0gM4Liy5YPneB_DTgCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Finally, this message will appear, click “<strong>OK</strong>”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-QAp3-tejiHQ/WgkmFG2UJDI/AAAAAAAASTg/cp50AR2fDpQVSwQBJJSQwhuTi9NBD0pPwCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now go back to the terminal in kali for the good part.</span></p>
<p><span style="color: #000000;">You will see that the moment OK is clicked in the image above, Meterpreter will come online and you will have achieved session just like that!!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-B0qRHHXr564/WgkmFfWp9rI/AAAAAAAASTg/-mSwtxfHEsYhVp9-eX5I4vgjHy8UL1S2wCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">If in case you were wondering why at the beginning we made you manually copy the code into Leafpad and save it into Metasploit, it’s because this is a new exploit and has not been updated into the Metasploit database.</span></p>
<p><span style="color: #000000;">Have fun and stay ethical.</span></p>
<p><strong><span style="color: #000000;">About The Author</span></strong></p>
<p><span style="color: #000000;">Abhimanyu Dev is a Certified Ethical Hacker, penetration tester, information security analyst and researcher. Connect with him <strong><a href="http://www.linkedin.com/in/abhimanyudev">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
