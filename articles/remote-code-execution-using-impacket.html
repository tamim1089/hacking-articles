<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Remote Code Execution Using Impacket</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/remote-code-execution-using-impacket/" rel="bookmark"><time class="entry-date published" datetime="2020-06-20T11:04:58+00:00">June 20, 2020</time><time class="updated" datetime="2025-05-31T09:50:46+00:00">May 31, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In this post, we are going to discuss how we can connect to Victims machine remotely using Python libraries “Impacket” which you can download from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://github.com/SecureAuthCorp/impacket.git">here</a></strong></span>.</span></p>
<h3 class="ai-optimize-7"><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li class="ai-optimize-8"><span style="color: #000000;"><strong>About Impacket</strong></span></li>
<li class="ai-optimize-9"><span style="color: #000000;"><strong>atexec.py</strong></span></li>
<li class="ai-optimize-10"><span style="color: #000000;"><strong>psexec.py</strong></span></li>
<li class="ai-optimize-11"><span style="color: #000000;"><strong>smbexec.py</strong></span></li>
<li class="ai-optimize-12"><span style="color: #000000;"><strong>wmiexec.py</strong></span></li>
</ul>
<h3 class="ai-optimize-13"><span style="color: #000000;"><span style="color: #800000;">About Impacket</span> </span></h3>
<p class="ai-optimize-14"><span style="color: #000000;">Impacket is a collection of Python classes for working with network protocols. Impacket is focused on providing low-level programmatic access to the packets and for some protocols (e.g. SMB1-3 and MSRPC) the protocol implementation itself.</span></p>
<p class="ai-optimize-15"><span style="color: #000000;">Furthermore, you can construct packets from scratch and parse them from raw data, and the object-oriented API simplifies working with deep hierarchies of protocols. The library offers a set of tools as examples of what you can do within the context of this library.</span></p>
<h3 class="ai-optimize-16"><span style="color: #800000;">Atexec.py</span></h3>
<p class="ai-optimize-17"><span style="color: #000000;">Atexec.py: Impacket has a python library that helps an attacker to access the victim host machine remotely through DCE/RPC based protocol used by CIFS hosts to access/control the AT-Scheduler Service and execute the arbitrary system command.</span></p>
<p class="ai-optimize-18"><span style="color: #000000;"><strong>Syntax: Python atexec.py domain/username:password@hostIP command</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python atexec.py ignite/administrator:Ignite@987@192.168.1.105 systeminfo</pre>
<p class="ai-optimize-19"><span style="color: #000000;">Consequently, as you can see, we have obtained the system information with the help of the above command.</span></p>
<p class="ai-optimize-20"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LIBJ_3FyAm4/Xu3rh3QqN3I/AAAAAAAAk9s/d3P--JFaK2YuKQSJrwZC-SsY35A8E5tQACLcBGAsYHQ/s1600/1.png"/></span></p>
<h3 class="ai-optimize-21"><span style="color: #800000;">PsExec.py</span></h3>
<p class="ai-optimize-22"><span style="color: #000000;">PSEXEC like functionality example using RemComSvc, with the help of python script we can use this module for connecting host machine remotely thus you need to execute following command.</span></p>
<p class="ai-optimize-23"><span style="color: #000000;"><strong>Syntax: Python psexec.py domain/username:password@hostIP</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python psexec.py ignite/administrator:Ignite@987@192.168.1.105</pre>
<p class="ai-optimize-24"><span style="color: #000000;">As you can see we have obtained the system shell with the help of the above command.</span></p>
<p class="ai-optimize-25"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mDaHELJnHyk/Xu3rly0R3fI/AAAAAAAAk9w/1h2Cmd28rTMeU1IFHdRjRgWSI_aTTcePQCLcBGAsYHQ/s1600/2.png"/></span></p>
<h3 class="ai-optimize-26"><span style="color: #800000;">Smbexec.py</span></h3>
<p class="ai-optimize-27"><span style="color: #000000;">Smbexec.py uses a similar approach to psexec w/o using RemComSvc. This script works in two ways:</span></p>
<ul>
<li class="ai-optimize-28"><span style="color: #000000;"><strong>share mode:</strong> you specify a share, and everything is done through that share.</span></li>
<li class="ai-optimize-29"><span style="color: #000000;"><strong>server mode:</strong> if for any reason there’s no share available, this script will launch a local SMB server, so the output of the commands executed is sent back by the target machine into a locally shared folder. Keep in mind you would need root access to bind to port 445 in the local machine.</span></li>
</ul>
<p class="ai-optimize-30"><span style="color: #000000;"><strong>Syntax: Python smbexec.py domain/username:password@hostIP</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python smbexec.py ignite/administrator:Ignite@987@192.168.1.105</pre>
<p class="ai-optimize-31"><span style="color: #000000;">As you can see we have obtained the system shell with the help of the above command.</span></p>
<p class="ai-optimize-32"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-f-pgEmFsbHs/Xu3rqJGb3dI/AAAAAAAAk-A/kbtyNu7ZYdc96Tcx0eMU_fPo5UddcsK9wCLcBGAsYHQ/s1600/3.png"/></span></p>
<h3 class="ai-optimize-33"><span style="color: #800000;">wmiexec.py</span></h3>
<p class="ai-optimize-34"><span style="color: #000000;">A similar approach to smbexec but executing commands through WMI. The main advantage here is it runs under the user (has to be Admin) account, not SYSTEM, plus, it doesn’t generate noisy messages in the event log that smbexec.py does when creating a service. The drawback is it needs DCOM, hence, I have to be able to access DCOM ports at the target machine.</span></p>
<p class="ai-optimize-35"><span style="color: #000000;"><strong>Syntax: Python wmiexec.py domain/username:password@hostIP</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python wmiexec.py ignite/administrator:Ignite@987@192.168.1.105 dir</pre>
<p class="ai-optimize-36"><span style="color: #000000;">As you can see we have obtained the system information with the help of the above command.</span></p>
<p class="ai-optimize-37"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sYCwhVyQqgs/Xu3rtYeNFRI/AAAAAAAAk-E/lgUU8AaSAw0LRCPalnLl9RO_D-zrZTAWQCLcBGAsYHQ/s1600/4.png"/></span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To learn more about Red Teaming. Follow this <strong><a href="https://www.hackingarticles.in/category/red-teaming/">link.</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
