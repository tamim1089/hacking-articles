<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/password-cracking/" rel="category tag">Password Cracking</a></span>            </div>
            <h1 class="post-title entry-title">Password Cracking: SSH</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/ssh-password-cracking/" rel="bookmark"><time class="entry-date published" datetime="2016-02-23T05:12:38+00:00">February 23, 2016</time><time class="updated" datetime="2025-05-28T11:30:25+00:00">May 28, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-52 ai-optimize-introduction"><span style="color: #000000;"><strong>SSH brute-force attacks</strong> remain one of the most prevalent initial access vectors in modern penetration testing engagements. Unlike legacy protocols, SSH’s encrypted channel presents unique challenges and opportunities for credential based attacks. This guide explores advanced techniques for exploiting SSH authentication mechanisms across diverse network environments.</span></p>
<p class="ai-optimize-53"><span style="color: #000000;"><strong>MITRE ATT&amp;CK Techniques:</strong></span></p>
<ul>
<li class="ai-optimize-54"><span style="color: #000000;"><strong>T1110.001 – </strong>Brute Force: Password Guessing</span></li>
<li class="ai-optimize-55"><span style="color: #000000;"><strong>T1046 – </strong>Network Service Scanning</span></li>
<li class="ai-optimize-56"><span style="color: #000000;"><strong>T1078 – </strong>Valid Accounts</span></li>
</ul>
<h3 class="ai-optimize-57"><span style="color: #800000;">Table of Contents</span></h3>
<p class="ai-optimize-58"><span style="color: #000000;"><strong>Introduction</strong></span></p>
<p class="ai-optimize-59"><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li class="ai-optimize-60"><span style="color: #000000;">Scan for Open SSH Port with Nmap</span></li>
</ul>
<p class="ai-optimize-61"><span style="color: #000000;"><strong>Brute-Force Techniques</strong></span></p>
<ul>
<li class="ai-optimize-62"><span style="color: #000000;">Hydra</span></li>
<li class="ai-optimize-63"><span style="color: #000000;">Metasploit</span></li>
<li class="ai-optimize-64"><span style="color: #000000;">Medusa</span></li>
<li class="ai-optimize-65"><span style="color: #000000;">NetExec (nxc)</span></li>
<li class="ai-optimize-66"><span style="color: #000000;">Ncrack</span></li>
<li class="ai-optimize-67"><span style="color: #000000;">Patator</span></li>
<li class="ai-optimize-68"><span style="color: #000000;">Nmap NSE Script (ssh-brute.nse)</span></li>
<li class="ai-optimize-69"><span style="color: #000000;">BruteSpray</span></li>
</ul>
<h2 class="ai-optimize-70"><span style="color: #800000;">Introduction</span></h2>
<p class="ai-optimize-72"><span style="color: #000000;"><strong>SSH (Secure Shell)</strong> is a cryptographic network protocol used to securely access and manage remote computers over an unsecured network such as the internet. It operates primarily on <strong>port 22</strong> and provides encrypted communication channels between clients and servers.</span></p>
<h2 class="ai-optimize-73"><span style="color: #800000;">Enumeration</span></h2>
<h3 class="ai-optimize-74"><span style="color: #800000;">Nmap Scan</span></h3>
<p class="ai-optimize-75"><span style="color: #000000;"><strong>MITRE Technique</strong> : T1046</span></p>
<p class="ai-optimize-76"><span style="color: #000000;">Firstly, to start the enumeration process, we perform a simple Nmap scan on the target IP address to check for an open <strong>SSH</strong> port and identify the service version:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p 22 -sV 192.168.1.111</pre>
<p class="ai-optimize-78"><span style="color: #000000;"><strong>Explanation:</strong></span></p>
<ul>
<li class="ai-optimize-79"><span style="color: #000000;"><strong>-p 22</strong>: Scans for SSH service on port 22.</span></li>
<li class="ai-optimize-80"><span style="color: #000000;"><strong>-sV</strong>: Enables version detection to gather more information about the running SSH service.</span></li>
</ul>
<p class="ai-optimize-81"><span style="color: #000000;">Then, once Nmap identifies that <strong>port 22</strong> is open and an <strong>SSH service</strong> is active, we can proceed to the next phase: <strong>brute force attacks</strong> to test for weak or default credentials.</span></p>
<h4><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhxQOqdGz9YIN_BvJgVoyn61-x8rXUUe5AAgaq8oeMxDzPYJHwcWlM8pQULqKIINROmFEV0e79RZZ7k0lu2XZoytJjYy2Gzwi3mM2bl-vw_FI2hzYiUDhU0YDFIjiSiHiVJQVhyphenhyphen-x_aNj0f72naKpYJDVjuLIOUEZjTqB-wq7r2HYwMKb1afWnG5QijzgHG/s16000/1.png"/></h4>
<h4 class="ai-optimize-82"><span style="color: #000000;">Defensive Strategy:</span></h4>
<p class="ai-optimize-83"><span style="color: #000000;">Deploy NIDS/NIPS (e.g., Zeek or Suricata) to detect scans against port 22, and configure Fail2Ban or SSHGuard to block IPs after repeated failures. Limit SSH exposure to known IP ranges using iptables or firewalls.</span></p>
<h2 class="ai-optimize-84"><span style="color: #800000;">Brute-Force Techniques</span></h2>
<h3 class="ai-optimize-85"><span style="color: #800000;">Tools Quick Reference</span></h3>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiAqHJwSnHYKIS-i2nbgteDwRxfN3U4isUWEDh_2ZHsnUTjPiIajHLfJCS8mhRZgkalfxETS2mE0Wd3dAoGJOOQBr9Bb_CuLCm7AnpVp1BGcoCoHUZ9UpemcS2-l4nWdDrL6KuOe-6Y2Sr152JXqOmgcE_TB7PXmU1cvry41vHmRWL9nbYZYu91SB3buKCR/s16000/ssh%20tool%20quick%20reference.png"/></p>
<h3 class="ai-optimize-113"><span style="color: #800000;">Hydra</span></h3>
<p class="ai-optimize-114"><span style="color: #000000;"><strong>Hydra</strong> is a widely adopted brute forcing tool supporting numerous protocols, including SSH. It’s known for its speed, reliability, and ease of use. It leverages username and password lists to attempt logins in parallel, optionally supporting proxies and time delays to evade detection.</span></p>
<p class="ai-optimize-115"><span style="color: #000000;">Kali Linux includes several built-in wordlists (for example rockyou.txt), but you can also create custom ones—such as <strong>user.txt</strong> and <strong>pass.txt</strong>—based on credential harvesting or common password patterns.</span></p>
<h4 class="ai-optimize-116"><span style="color: #000000;">Step To Reproduce</span></h4>
<p class="ai-optimize-117"><span style="color: #000000;">To perform a brute force attack against an SSH service, use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hydra -L user.txt -P pass.txt 192.168.1.111 ssh</pre>
<p class="ai-optimize-119"><span style="color: #000000;"><strong>Explanation:</strong></span></p>
<ul>
<li class="ai-optimize-120"><span style="color: #000000;"><strong>-L user.txt</strong>: Specifies the path to the username list.</span></li>
<li class="ai-optimize-121"><span style="color: #000000;"><strong>-P pass.txt</strong>: Specifies the path to the password list.</span></li>
<li class="ai-optimize-122"><span style="color: #000000;"><strong>192.168.1.111</strong>: Target IP address.</span></li>
<li class="ai-optimize-123"><span style="color: #000000;"><strong>ssh</strong>: Protocol to attack.</span></li>
</ul>
<p class="ai-optimize-124"><span style="color: #000000;">Hydra will systematically test each username-password pair against the SSH service on the specified host. If valid credentials are found, Hydra will clearly report the success.</span></p>
<p class="ai-optimize-6"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhTPOoxTLMaMZFaDLMCNmyRrPN6U1_F9tBJXQxlopXnmUv8xb7uVldEZSUZ_6HDLvTxjxFs78rgKtlMvDpb51UOqtrhtQLxaYyRTOR_NYp-iUk-riLt09FBOa83dsz-NuFps0DPlSiVfovarHi52MveVpTyxYH5XT_1RzQOlG3LNtVHUY7Zb6KthuKxz9y4/s16000/2.png"/></span></p>
<h4 class="ai-optimize-125"><span style="color: #000000;">Detection Strategy:</span></h4>
<p class="ai-optimize-126"><span style="color: #000000;">To strengthen defenses, detect spikes in SSH login failures from a single source IP using /var/log/auth.log, and deploy Fail2Ban to throttle brute force attempts in real time.</span></p>
<h3 class="ai-optimize-127"><span style="color: #800000;">Metasploit</span></h3>
<p class="ai-optimize-128"><span style="color: #000000;">The ssh_login module is quite versatile in that it can not only test a set of credentials across a range of IP addresses, but it can also perform brute force login attempts. We will pass a file to the module containing usernames and passwords separated by a space as shown below.</span></p>
<p class="ai-optimize-129"><span style="color: #000000;">In this case, we can effectively automate login attempts to find weak or default credentials on target systems by utilizing our dictionaries, <strong>user.txt</strong> and <strong>pass.txt</strong>.</span></p>
<h4 class="ai-optimize-130"><span style="color: #000000;">Step To Reproduce</span></h4>
<p class="ai-optimize-131"><span style="color: #000000;">On kali terminal type msfconsole then run following commands:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf6 &gt; use auxiliary/scanner/ssh/ssh_login 
set rhosts 192.168.1.111 
set user_file user.txt 
set pass_file pass.txt 
set verbose false 
run</pre>
<p class="ai-optimize-138"><span style="color: #000000;"><strong>Explanation</strong>:</span></p>
<ul>
<li class="ai-optimize-139"><span style="color: #000000;"><strong>use auxiliary/scanner/ssh/ssh_login</strong>: Selects the Metasploit module designed for brute forcing SSH login credentials.</span></li>
<li class="ai-optimize-140"><span style="color: #000000;"><strong>set rhosts 192.168.1.111</strong>: Specifies the target machine’s IP address for the scan.</span></li>
<li class="ai-optimize-141"><span style="color: #000000;"><strong>set user_file user.txt</strong>: Defines a file containing potential usernames to try during the brute force attack.</span></li>
<li class="ai-optimize-142"><span style="color: #000000;"><strong>set pass_file pass.txt</strong>: Defines a file containing potential passwords to pair with each username.</span></li>
<li class="ai-optimize-143"><span style="color: #000000;"><strong>set verbose false</strong>: Disables verbose output, reducing on-screen clutter during the attack but if you are interested in knowledge failed attempt or all tried combination then you can reset as true.</span></li>
</ul>
<h4 class="ai-optimize-7"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgxDLActlCZj4oqvMyaySzEwH6qgZ_WCiNzFfb0XD2P3o2lNACw0YKx0NbFOyrdpfEQkHTdE7Im4VATjslrlsA2coYj4FUu8YLsPjCtKgz7ZCtnZcl7T4QX7xo7UShcA997ErBPfh96EP2qbInFYYbmipV2fx00BlfiSGLwhfnABIQskfMaHlBrtsoGQfSh/s16000/3.png"/></span></h4>
<h4 class="ai-optimize-144"><span style="color: #000000;">Defensive Control:</span></h4>
<p class="ai-optimize-145"><span style="color: #000000;">Enable SSH account lockouts or rate limiting for repeated failures; for example, monitor /var/log/auth.log (or Event ID 4625 in Windows) for high-frequency login attempts from a single host. Correlate these attempts with scanning activity typical of Metasploit modules to proactively detect brute force behavior.</span></p>
<h3 class="ai-optimize-146"><span style="color: #800000;">Medusa</span></h3>
<p class="ai-optimize-147"><span style="color: #000000;"><strong>Medusa</strong> is a parallel, modular login brute forcer offering high performance and broad protocol support. It supports multiple protocols; more specifically, it allows testers to perform dictionary based attacks against services like <strong>SSH, FTP, HTTP, AFP, CVS, IMAP, rlogin, Subversion, VNC</strong>, and more.</span></p>
<h4 class="ai-optimize-148"><span style="color: #000000;">Step To Reproduce</span></h4>
<p class="ai-optimize-149"><span style="color: #000000;">Below we have successfully grabbed credentials using following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">medusa -h 192.168.1.111 -U user.txt -P pass.txt -M ssh | grep "ACCOUNT FOUND"</pre>
<p class="ai-optimize-151"><span style="color: #000000;"><strong>Explanation</strong>:</span></p>
<ul>
<li class="ai-optimize-152"><span style="color: #000000;"><strong>medusa</strong>: Invokes the Medusa brute force tool.</span></li>
<li class="ai-optimize-153"><span style="color: #000000;"><strong>-h 192.169.1.111</strong>: Specifies the IP address of the target machine.</span></li>
<li class="ai-optimize-154"><span style="color: #000000;"><strong>-U</strong>: Points to a file containing a list of usernames to try.</span></li>
<li class="ai-optimize-155"><span style="color: #000000;"><strong>-P</strong>: Points to a file containing a list of passwords.</span></li>
<li class="ai-optimize-156"><span style="color: #000000;"><strong>-M ssh</strong>: Indicates that the SSH module should be used for this attack.</span></li>
<li class="ai-optimize-157"><span style="color: #000000;"><strong>| grep “ACCOUNT FOUND”</strong>: Filters the command output to display only successful login attempts, making it easier to identify valid credentials.</span></li>
</ul>
<h4 class="ai-optimize-8"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEigBJFC9RZI3IkSSBo4kzBdT23VxeMxM4vWUwPx2lESdKbkLhDvXZaJ0lSryOcYV3eM3-Kn_GLT3jTo5EfuiNbAfjMR1MRcGGYVFhOjLZFXnaF3klnv5yo_P7IbBIwWXXXbHCO57_9l1g4TWLHsWbvvFuOjvmhBSkfYOMy1znANYpJxSzMERMkAvCFlPFOt/s16000/4.png"/></span></h4>
<h4 class="ai-optimize-158"><span style="color: #000000;">Defensive Strategy:</span></h4>
<p class="ai-optimize-159"><span style="color: #000000;">Additionally, detect high-rate parallel SSH login attempts by monitoring for simultaneous failures across multiple usernames in /var/log/auth.log and implement Fail2Ban or rate limiting to block aggressive sources.</span></p>
<h3 class="ai-optimize-160"><span style="color: #800000;">Netexec (aka nxc)</span></h3>
<p class="ai-optimize-161"><span style="color: #000000;">NetExec can perform brute force attacks on SSH services using specified username and password lists. It is particularly useful for mass validation of credential pairs obtained during recon or OSINT phases.</span></p>
<h4 class="ai-optimize-162"><span style="color: #000000;">Step To Reproduce</span></h4>
<p class="ai-optimize-163"><span style="color: #000000;">Firstly, to initiate a brute force attack against an SSH service using NetExec, run the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nxc ssh 192.168.1.111 -u user.txt -p pass.txt | grep [+]</pre>
<p class="ai-optimize-165"><span style="color: #000000;"><strong>Explanation:</strong></span></p>
<ul>
<li class="ai-optimize-166"><span style="color: #000000;"><strong>nxc</strong>: Invokes the NetExec burte force tool</span></li>
<li class="ai-optimize-167"><span style="color: #000000;"><strong>ssh</strong>: Specifies the protocol to target.</span></li>
<li class="ai-optimize-168"><span style="color: #000000;"><strong>192.168.1.111</strong>: The IP address of the target host.</span></li>
<li class="ai-optimize-169"><span style="color: #000000;"><strong>-u user.txt</strong>: Path to the file containing a list of usernames.</span></li>
<li class="ai-optimize-170"><span style="color: #000000;"><strong>-p pass.txt</strong>: Path to the file containing a list of passwords.</span></li>
<li class="ai-optimize-171"><span style="color: #000000;"><strong>| grep [+]</strong>: Filters the command output to display only successful login attempts, making it easier to identify valid credentials.</span></li>
</ul>
<h4 class="ai-optimize-9"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgedVYQWGuDdWx2QPQZtKEBoGrjLqpovPXGNu9jVgtfAuLkeRU2t9f558WaKNKoNgbw3P76iV4yPIvcyUQahyphenhyphen6QD7kGVKOTDy0HBKiKaEhuq5YTX-ZKnqeUoaQmtt6wcbg_f9q0pazCiGXKJ9GWeS0aoiBnmdAT5RJuHhyphenhyphen6RlF_c0PFjsrNe4gGxg6GK-By/s16000/6.png"/></span></h4>
<h4 class="ai-optimize-172"><span style="color: #000000;">Defensive Statergy:</span></h4>
<p class="ai-optimize-173"><span style="color: #000000;">Segment internal assets. Restrict SSH access through jump hosts and enforce MFA to prevent lateral movement even after brute force success.</span></p>
<h3 class="ai-optimize-174"><span style="color: #800000;">Ncrack</span></h3>
<p class="ai-optimize-175"><span style="color: #000000;">Developed by the Nmap creators, <strong>Ncrack</strong> is designed for high speed password auditing against network services including SSH. It supports a modular configuration, making it ideal for larger assessments where performance and reliability are critical.</span></p>
<h4 class="ai-optimize-176"><span style="color: #000000;">Step To Reproduce</span></h4>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ncrack -U user.txt -P pass.txt 192.168.1.111 -p 22</pre>
<p class="ai-optimize-178"><span style="color: #000000;"><strong>Explanation:</strong></span></p>
<ul>
<li class="ai-optimize-179"><span style="color: #000000;"><strong>ncrack</strong>: Launches the Ncrack password cracking tool.</span></li>
<li class="ai-optimize-180"><span style="color: #000000;"><strong>-U user.txt</strong>: Indicates the file containing a list of potential usernames.</span></li>
<li class="ai-optimize-181"><span style="color: #000000;"><strong>-P pass.txt</strong>: Indicates the file containing a list of potential passwords.</span></li>
<li class="ai-optimize-182"><span style="color: #000000;"><strong>-p 22</strong>: Specifies the target SSH service</span></li>
</ul>
<h4 class="ai-optimize-10"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhYq7LCCgXxiGF3pZ3h3kfzx27ZWovdF04mslApSPsgn6Kl4Hol6Pqwr1lnwr96Ku6WAySNmVqd-A-zNOXUK1V3Q9prdm5F3w5cWBK1j8Bour0ubCogQs1d4nlU1l2Gmkqz66de7xE8Lb6XEbbo8ctPgh9THwH30yJCbt7q0QE71AJFgA7ZOHxS0unUAIvB/s16000/7.png"/></span></h4>
<h4 class="ai-optimize-183"><span style="color: #000000;">Defensive Strategy:</span></h4>
<p class="ai-optimize-184"><span style="color: #000000;">Integrate SSH login anomaly detection into your SIEM to alert on rapid, repeated authentication attempts; apply connection rate limits to throttle brute force tools like Ncrack.</span></p>
<h3 class="ai-optimize-185"><span style="color: #800000;">Patator</span></h3>
<p class="ai-optimize-186"><span style="color: #000000;">Patator is a versatile, multi threaded brute forcing tool capable of attacking a wide range of protocols including <strong>SSH, FTP, HTTP</strong> and more.</span></p>
<h4 class="ai-optimize-187"><span style="color: #000000;">Step To Reproduce</span></h4>
<p class="ai-optimize-188"><span style="color: #000000;">Patator can be used to perform SSH brute force attacks by iterating through supplied username and password lists which in this case will be user.txt and pass.txt.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">patator ssh_login host=192.168.1.111 user=FILE0 0=user.txt password=FILE1 1=pass.txt</pre>
<p class="ai-optimize-190"><span style="color: #000000;"><strong>Explanation</strong>:</span></p>
<ul>
<li class="ai-optimize-191"><span style="color: #000000;"><strong>patator</strong>: Launches the Patator brute force tool.</span></li>
</ul>
<ul>
<li class="ai-optimize-192"><span style="color: #000000;"><strong>ssh_login</strong>: Specifies the module for brute forcing SSH credentials.</span></li>
<li class="ai-optimize-193"><span style="color: #000000;"><strong>host=192.168.1.111</strong>: Indicates the target machine’s IP address.</span></li>
<li class="ai-optimize-194"><span style="color: #000000;"><strong>user=FILE0 0=user.txt</strong>: Assigns FILE0 as a placeholder for usernames, pulling values from user.txt.</span></li>
<li class="ai-optimize-195"><span style="color: #000000;"><strong>password=FILE1 1=pass.txt</strong>: Assigns FILE1 as a placeholder for passwords, pulling values from pass.txt.</span></li>
</ul>
<p class="ai-optimize-11"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgY8iL-7rS8Kpt6baax9Dr7QwS-nY4E7SjDFYr7Wk2IejOepJmC9r_ahfLEg-uduALt5Xmdak8d1Cpy-_Fdj85W2pxxIc1LHyTo4IH7Y9la-LqLlmjFhb4CRfAvrTMAbu_byVUhfTGuS5hCsHBRHI_ne4AExsI5xxj_TxN0fjQ5hUBUgO1T1iGQWwpWqCnP/s16000/8.png"/></span></p>
<p class="ai-optimize-196"><span style="color: #000000;"><strong><em>Note</em></strong><em>: You can add | grep ‘200 OK’ or -x ignore:code=530 for success filtering or to skip known failed responses based on Patator’s output codes.</em></span></p>
<h4 class="ai-optimize-197"><span style="color: #000000;">Defensive Suggestion:</span></h4>
<p class="ai-optimize-198"><span style="color: #000000;">Moreover, throttle SSH connection attempts per IP and detect repeated login failures with low time gaps to identify Patator-style brute force behavior.</span></p>
<h3 class="ai-optimize-199"><span style="color: #800000;">NMAP NSE Script</span></h3>
<p class="ai-optimize-200"><span style="color: #000000;">Nmap script, <strong>ssh-brute.nse</strong>, enables brute force login attempts on SSH servers using custom username and password lists. Although not as fast as dedicated brute force tools, it offers a convenient, built in option for quick password audits during reconnaissance.</span></p>
<h4 class="ai-optimize-201"><span style="color: #000000;">Step To Reproduce</span></h4>
<p class="ai-optimize-202"><span style="color: #000000;">Firstly, to perform a brute force attack against an SSH service using Nmap, run the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p22 --script ssh-brute.nse --script-args userdb=user.txt,passdb=pass.txt 192.168.1.111</pre>
<p class="ai-optimize-12"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgTFWd-dOD4N_D3kq2-ncQYPm9lz1gLCO8aVVJ379iwCbRrmOOGFQRLhT9ADVCNLI4YE7jGVYPZ48MXsGUgvqPRMps-D4DEkUZYJEmn7hRFpqK5IxYkX3yzWkVn4GRIWAcdxp9H4Ppw0DG6MzeAMjaWSXeW_yzU3pGXThx7XNdQ9MEPaBo7OMWpoojbz4dE/s16000/9.png"/></span></p>
<p class="ai-optimize-13"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh1uMszygvEQv5P3EfZkzhIArBm1Nsv1RkVJV_ludHowHvBpJPRlvIIGKba5CMz3gdFKMEx_Fm7qocLZ9RNwotluyGRAHqrztspQMCUbhLQ_dvEezy10SlK6NiUDVllPOGaIrM7vlnLAxdGjTdhQhRAXs5GplgkvVO2H_ragBIw4oCDymGGYhobOr5BvPh9/s16000/10.png"/></span></p>
<p class="ai-optimize-204"><span style="color: #000000;"><strong>Explanation:</strong></span></p>
<ul>
<li class="ai-optimize-205"><span style="color: #000000;">–<strong>p22</strong>: Scans port 22 (SSH).</span></li>
<li class="ai-optimize-206"><span style="color: #000000;"><strong>–script ssh-brute.nse</strong>: Specifies the use of the SSH brute force NSE script.</span></li>
<li class="ai-optimize-207"><span style="color: #000000;"><strong>–script-args userdb</strong>=user.txt,passdb=pass.txt: Provides the script with your custom username and password lists.</span></li>
</ul>
<p class="ai-optimize-208"><span style="color: #000000;">This method is especially useful during early stage reconnaissance to identify weak or default SSH credentials on a target system.</span></p>
<h4 class="ai-optimize-209"><span style="color: #000000;">Defensive Strategy:</span></h4>
<p class="ai-optimize-210"><span style="color: #000000;">Additionally, whitelist approved scanning hosts and flag brute force attempts from unknown sources. Detect login attempts from unexpected origins and flag NSE-style brute force behavior by correlating with prior port scans in SIEM or IDS tools.</span></p>
<h3 class="ai-optimize-211"><span style="color: #800000;">BruteSpray</span></h3>
<p class="ai-optimize-212"><span style="color: #000000;">BruteSpray integrates seamlessly with Nmap’s output formats (grepable or XML), allowing you to quickly move from service discovery to targeted brute force attacks in streamlined workflow.</span></p>
<h4 class="ai-optimize-213"><span style="color: #000000;">Step 1: Scan for SSH Services with Nmap</span></h4>
<p class="ai-optimize-214"><span style="color: #000000;">Firstly, run an Nmap scan to identify open SSH ports and save the output in grepable format:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p 22 192.168.1.111 -oG ssh_scan.txt</pre>
<p class="ai-optimize-216"><span style="color: #000000;"><strong>Explanation:</strong></span></p>
<ul>
<li class="ai-optimize-217"><span style="color: #000000;"><strong>-p 22</strong>: Scans for SSH service on port 22.</span></li>
<li class="ai-optimize-218"><span style="color: #000000;"><strong>-oG ssh_scan.txt</strong>: Outputs the results in grepable format, which BruteSpray can parse.</span></li>
</ul>
<p class="ai-optimize-14"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjRZVBa_1O254RcUyFPlL4Ihvn8JIf_diPDyFG1TuxOsVtcW5-Br9ZgseF0pwElvYjiCeiPgECgLCWg8AKP-KGtFsHCMJbccVsokQJdD1M8_JPAHwiCYcUp8-x7UMrqdgG4TsHnmMv2Q0glAFynckam5Mb-3tCVcBpePdRetjkYFf7j-FiUzVhojForXeYG/s16000/11.png"/></span></p>
<h4 class="ai-optimize-219"><span style="color: #000000;">Step 2: Brute-Force SSH Logins with BruteSpray</span></h4>
<p class="ai-optimize-220"><span style="color: #000000;">Then, once the scan is complete, use BruteSpray to attempt logins against the identified SSH services using a username and password list:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">brutespray -f ssh_scan.txt -u user.txt -p pass.txt</pre>
<p class="ai-optimize-222"><span style="color: #000000;"><strong>Explanation:</strong></span></p>
<ul>
<li class="ai-optimize-223"><span style="color: #000000;"><strong>-f ssh_scan.txt</strong>: Specifies the Nmap output file to use.</span></li>
<li class="ai-optimize-224"><span style="color: #000000;"><strong>-u user.txt</strong>: Path to the list of usernames.</span></li>
<li class="ai-optimize-225"><span style="color: #000000;"><strong>-p pass.txt</strong>: Path to the list of passwords.</span></li>
</ul>
<p class="ai-optimize-226"><span style="color: #000000;">This workflow is particularly effective because it is ideal for automating brute force attempts immediately after service discovery, thereby streamlining the reconnaissance and exploitation phases of an engagement.</span></p>
<p class="ai-optimize-15"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhXlGBi0Rxm_YNNX6PbC7cf99FSKk5rkb3pi7tcvKdE_W9nxuU4gBCLXfCXw6Ju6ifddscKEjJbO4rJMRboNXuey05fKj4uARpmSvQqz7oDZF2sV7gTQBXnXFud_LlxSFeuq-TVQsDZKJn7Uvb6cKOwXyDbdQB0CyT3bZUk8veW_mOwAuWyL7jaXBVcMMY6/s16000/12.png"/></span></p>
<p class="ai-optimize-16"><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgGkHYOAnV_mS3BH0AVXwFSmNxLZzrdd1y2GBwpS0-4Dvofo7rpvGabVDROVSl5qzbreBIprp4DUVQ3RT9hkY_7COPAfT3vvq97TZrnPk-66ivXoojlkEThfg107ZabxGJVd4rhyphenhyphenOUG6w9vv8QDwLQAxVo7X3DQvAAxLPM-1yJaykjzJD9BToILJX7ChOkt/s16000/13.png"/></span></p>
<h4 class="ai-optimize-227"><span style="color: #000000;">Defensive Strategy:</span></h4>
<p class="ai-optimize-228"><span style="color: #000000;">Flag and block IPs conducting SSH scans followed by mass login attempts across multiple hosts; for example, apply tarpitting techniques to delay SSH responses. This slows down brute force tools like BruteSpray and increases the attacker’s cost. Combine this with real time alerts from SIEM and implement connection throttling for enhanced defense.</span></p>
<h3 class="ai-optimize-229"> <span style="color: #800000;">SSH Brute-Force – Offense, Defence &amp; MITRE Mapping</span></h3>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEibuaph4iEtS_MmNgOejjvvIDB5-Nx2GxSrlcNxTdyBYQw9VsJCP0saN280bmLsgfLOn6jAjmC5aVfvw5hE7ohtii_Qc8yzvzCNh3cAw2OgDnq6o70KKEVp0qyfjWQvjV5iAfC6LNNnt7B0axjO0RhdJFL4TagHNoKtwfsS-MRe_k14XMyMyLjLvYNX2wc1/s16000/ssh%20mitre%20table.png"/></p>
<h3 class="ai-optimize-276"><span style="color: #800000;">Defence-in-Depth Summary</span></h3>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguq1PJ3Nfn94XKPnY9AK3bnlMtE_Xhv3NVw0gJoM5li5bgGBdvCrq4ux4q3in8iAVNQtSxaHeVX-siOCC9nTzFgxRHUfJkBkzuJyp-Itk4J3wHlF96LML3BMQQInHp8BnsdLe-GAXJgSOibU4eram2GHLj9GRgKYMX6gBLSZPl23iLJ711DnT8rZVCbnHX/s16000/ssh%20defence%20in%20depth%20table.png"/></p>
<p class="ai-optimize-231"><span style="color: #000000;">To learn more about Password Cracking. Follow this</span> <a href="https://www.hackingarticles.in/category/password-cracking/"><span style="color: #0000ff;"><strong>Link</strong></span>.</a></p>
<p class="ai-optimize-291"><span style="color: #000000;"><strong>Author: </strong></span></p>
<p class="ai-optimize-292"><span style="color: #000000;"><strong>Kinjal Patel </strong>is seasoned penetration tester and technical content writer. Contact at </span><a href="https://www.linkedin.com/in/kinjalpatel-pt/">LinkedIn</a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
