<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/" rel="category tag">TryHackME</a></span>            </div>
            <h1 class="post-title entry-title">UltraTech TryHackMe Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/ultratech-tryhackme-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-05-24T10:51:52+00:00">May 24, 2021</time><time class="updated" datetime="2025-06-24T12:21:29+00:00">June 24, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today it is time to solve another challenge called “UltraTech”. It is available at TryHackMe for penetration testing practice. The challenge is of medium difficulty if you have the right basic knowledge and are attentive to little details that are required in the enumeration process. The credit for making this machine goes to <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://tryhackme.com/p/lp1">lp1</a></strong></span>. The breakdown of the Machine with the redacted flags is as follow:</span></p>
<p><span style="color: #000000;"><strong>Level: Medium</strong></span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning </strong></span>
<ul>
<li><span style="color: #000000;">Nmap Scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating REST API</span></li>
<li><span style="color: #000000;">Enumerating Web Application</span></li>
<li><span style="color: #000000;">Directory Bruteforce using dirb</span></li>
<li><span style="color: #000000;">Detecting Remote Code Execution</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation </strong></span>
<ul>
<li><span style="color: #000000;">Exploiting Remote Code Execution</span></li>
<li><span style="color: #000000;">Reading the User Hash from Database File</span></li>
<li><span style="color: #000000;">Decoding the Hash</span></li>
<li><span style="color: #000000;">Connecting using SSH</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Escaping Docker Environment</span></li>
<li><span style="color: #000000;">Getting Root Shell</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #800000;">Walkthrough</span></h3>
<p><span style="color: #000000;">After Booting up the target machine from the <strong><a style="color: #000000;" href="https://tryhackme.com/room/ultratech1">TryHackMe: UltraTech CTF Page</a></strong>, an IP will be assigned to the machine and will be visible on that page as well.</span></p>
<p><span style="color: #000000;"><strong>IP Address: 10.10.213.191</strong></span></p>
<p><span style="color: #000000;">You need to answer nine questions to complete this machine. You can find the questions as you discover the answers below.</span></p>
<h3><span style="color: #800000;">Network Scanning</span></h3>
<p><span style="color: #000000;">We will start a nmap scan with the -sC for Default Scripts and -sV for Scanning Versions as well as Ping Scan to detect any uncommon ports and services.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sC -sV -Pn -p- 10.10.213.191</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uxcfgoAlsDs/YKuBaJsCCBI/AAAAAAAAwFc/953YHk7l7-4tDQHuXI_2TKSjtzC8mbn_ACLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Nmap scan was able to detect 3 service running on the target machine. We have the FTP (21), SSH (22), HTTP (8081, 31331). Since we don’t have any credentials for the FTP service or SSH service, let’s start enumeration from HTTP Service.</span></p>
<p><span style="color: #000000;"><strong><em>Q.1. Which software is using the port 8081?</em></strong></span></p>
<p><span style="color: #000000;"><strong><em>Node.js</em></strong></span></p>
<p><span style="color: #000000;"><strong><em>Q.2. Which other non-standard port is used?</em></strong></span></p>
<p><span style="color: #000000;"><strong><em>31331</em></strong></span></p>
<p><span style="color: #000000;"><strong><em>Q.3. Which software using this port?</em></strong></span></p>
<p><span style="color: #000000;"><strong><em>Apache</em></strong></span></p>
<p><span style="color: #000000;"><strong><em>Q.4. Which GNU/Linux distribution seems to be used?</em></strong></span></p>
<p><span style="color: #000000;"><strong><em>Ubuntu</em></strong></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">Firstly, we began the enumeration of HTTP service from the Node.js Express framework HTTP service running on port 8081. It reveals that this is an API service. We have the name of the API as UltraTech API v0.1.3.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.213.191:8081/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qTdxCwLeF34/YKuBfHUKIeI/AAAAAAAAwFg/q6fN_Ixo6g43rkRnDc5ylk0B4jWn0W0NgCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Since this was an API, there must be a web application that is pulling data from this API. We open the second HTTP service running on the port 31331. We find our web application. It a stock web application with a bunch of pages.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.213.191:31331/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6GoWbsjSECw/YKuBjJPzp7I/AAAAAAAAwFk/OHvsWcO8WZEHPAo7JdlgsTeXcJplFSKLQCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">While we are enumerating the Web Application manually, let’s run a Directory Bruteforce on the API using dirb. After running for a while, it was able to extract two pages auth and ping.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://10.10.213.191:8081</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tE2BRgepKRE/YKuBoH_2R0I/AAAAAAAAwFo/G7GVTeJhzY0Q-7rtE2QHPJpAz5q__XKxwCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Upon accessing the ping, we see that there is a Handling Error as shown in the image below. Close inspection of the error suggests that there is some parameter or variable missing. Since we don’t have any documentations for the API, we will have to guess about that parameter.</span></p>
<p><span style="color: #000000;"><strong><em>Q.5. The software using the port 8080 is a REST api, how many of its routes are used by the web application?</em></strong></span></p>
<p><span style="color: #000000;"><strong><em>2</em></strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.213.191:8081/ping</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-X3RGpKEyRZM/YKuBtvRd1AI/AAAAAAAAwFs/vsIu8OReuMQFmVGjtvl07wU0PkaDuhTUQCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">Since it is a ping service, we decided to use the IP parameter with the loopback IP to check if it works. We were able to run the ping command on the target machine from API.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.213.191:8081/ping?ip=127.0.0.1</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NNzL0VHWcyQ/YKuBw1J-EfI/AAAAAAAAwF0/-a0rwseovSAfkv8v7TF0u4G1b1gqeYOEgCLcBGAsYHQ/s16000/6.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">After trying different variants to run another command through the ping command, we were able to run the ls command by inserting the command inside the quotes [“]. We are able to see that there is a SQL file inside the current directory.</span></p>
<p><span style="color: #000000;"><strong><em>Q.6. There is a database lying around, what is its filename?</em></strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">utech.db.sqlite
http://10.10.213.191:8081/ping?ip='ls -la'</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HVmdzqWh-kY/YKuB0t3ucqI/AAAAAAAAwF8/sb2MdMHqsR0cV7kImvTPmbr6_6bqFEBzwCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">We use the cat command inside the same quotes to read the contents of the SQL database file. Then, we were able to get credentials for a user by the name of r00t. The credentials were however encrypted. To be able to use those credentials, we need to decode them.</span></p>
<p><span style="color: #000000;"><strong><em>Q.7. What is the first user’s password hash?</em></strong></span></p>
<p><span style="color: #000000;"><strong><em>################################</em></strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.213.191:8081/ping?ip=`cat%20utech.db.sqlite`</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0CtjVR1homQ/YKuB8EDFZLI/AAAAAAAAwGE/F3XLE2TXFwkKbxtVQTD6DJKebQEq-GuAgCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">We take the credentials and try to decrypt using online decrypter tool. We were able to read the password for the user r00t.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kJK6riw86_Y/YKuCAXS_SOI/AAAAAAAAwGI/IqVFpfMLFrUoSh-zPck6NN8a56omsMqJACLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;"><strong><em>Q.8. What is the password associated with this hash?</em></strong></span></p>
<p><span style="color: #000000;"><strong><em>#######</em></strong></span></p>
<p><span style="color: #000000;">Now that we have the credentials for the r00t user, we use them to connect to the target machine using the SSH service. Then, after getting the shell we ran the id command to find that we are inside a docker instance.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh r00t@10.10.213.191
id</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FoTO1eEktXI/YKuCEFWDj3I/AAAAAAAAwGM/MG2-BiQOOmAdE9s1Yzkjsl4qoaYKpuw1QCLcBGAsYHQ/s16000/10.png"/></span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Privilege Escalation</span> </span></h3>
<p><span style="color: #000000;">We will use the <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://gtfobins.github.io/gtfobins/docker/">GTFOBIN</a> </strong></span>to elevate privileges on the target machine. It tells us that in order to get out of the restricted environment of docker, we need to spawn an interactive shell inside the docker.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-E7EfxyzyCnQ/YKuCPFOo4nI/AAAAAAAAwGY/ugA0H4TJ7yU-rZ9_mWe0fBx-JSllF2j_ACLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">We run the script directly from the GTFOBIN. However, it gave us an error stating that it was unable to find the alpine image. Therefore, we use the docker ps -a command to list the images available on this Docker instance. We observe that there is an image named bash. As a result, we replace the image name from alpine to bash in the command. After running the modified command again, we find that we are able to gain root access. Finally, we use the cat command to read the private key for the root user, as required to conclude this machine.</span></p>
<p><span style="color: #000000;"><strong><em>Q.9. What are the first 9 characters of the root user’s private SSH key?</em></strong></span></p>
<p><span style="color: #000000;"><strong><em>#########</em></strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">docker run -v /:/mnt --rm -it alpine chroot /mnt sh
docker ps -a
docker run -v /:/mnt --rm -it bash chroot /mnt sh
whoami
cat /root/.ssh/id_rsa</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-F6EXens0hFg/YKuCZC2F-eI/AAAAAAAAwGg/S1NU7n5bYUokxj4IDTWY_4aAE6Udv6aRQCLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">Hope you have enjoyed this TryHackMe Write-up. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/">Link</a> </strong><span style="color: #000000;">for more TryHackMe CTF’s.</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Contact on <strong>Twitter</strong> and <strong><a style="color: #000000;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
