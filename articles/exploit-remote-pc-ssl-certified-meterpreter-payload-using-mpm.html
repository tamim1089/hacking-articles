<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/collection-of-hacking-tools/" rel="category tag">Hacking Tools</a>, <a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Create SSL Certified Meterpreter Payload using MPM</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/exploit-remote-pc-ssl-certified-meterpreter-payload-using-mpm/" rel="bookmark"><time class="entry-date published" datetime="2017-05-20T04:42:48+00:00">May 20, 2017</time><time class="updated" datetime="2025-05-27T12:03:39+00:00">May 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Through this article, you can learn how an attacker would able to generate an SSL certificate for any exe or bat file payloads so that he might be able to establish a connection with the host through the meterpreter session.</span></p>
<p><span style="color: #000000;">The firewall spoof the network traffic and verifies trust certificates to establish connection itself as a trusted third party to the session between the client and the server. When the client begins with an SSL session with the server, the firewall captures the client SSL request and forwards the SSL request to the server. The server sends a certificate for the client that is captured by the firewall. If the server certificate is signed by a CA that the firewall trusts, the firewall generates a duplicate of the server certificate signed by the Forward Trust certificate and forward the certificate to the client to authenticate. </span></p>
<p><span style="color: #000000;">Meterpreter_Paranoid_Mode.sh allows users to secure your staged/stageless connection for Meterpreter by having it check the certificate of the handler it is connecting to.</span></p>
<p><span style="color: #000000;">Open the terminal in your Kali Linux and type following to download it.</span></p>
<pre class="lang:default decode:true">git clone https://github.com/r00t-3xp10it/Meterpreter_Paranoid_Mode-SSL.git</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-4yTOrRiVEVU/WR_GslBBg2I/AAAAAAAAQA4/m-57V7W4-okcQnK7pDaQqjdGLAefKrLLQCLcB/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Once it downloaded run the program file and follow the given below steps.</span></p>
<p><span style="color: #000000;"><strong>Press Enter to continue</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ENn3ybkWcVw/WR_GtjOPrQI/AAAAAAAAQBA/mSec65tJnLAbQASHfJf4GvWVjafZ5EQKQCEw/s1600/2.png"/></span></p>
<p><span style="color: #000000;">A prompt will open in which you have to choose the option for building certificate from the given screenshot you can read I had chosen to <strong>impersonate domain</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-tH3qbHeoiiw/WR_Gtgc5vaI/AAAAAAAAQBE/uypLiisBwU8-nzvmTiFrnEACqQWrRTvhwCEw/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We start by generating a certificate in PEM format, once the certs have been created we can create an HTTP or HTTPS or EXE payload for it and give it the path of PEM format certificate to be used to validate the connection.</span></p>
<p><span style="color: #000000;">After that again another prompt will open in which you would be asked to mention the domain name, here the SSL certificate will generate for <strong>www.hackingarticles.in</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-siEXzO_b1Ao/WR_GuUtWw_I/AAAAAAAAQBI/b3USxrXfYUoE4FSB1lvW9i5KNC2KECExQCEw/s1600/4.png"/></span></p>
<p><span style="color: #000000;">To have the connection validated we need to tell the payload what certificate the handler will be used by setting the path to the <strong>PEM certificate</strong> in the HANDLERSSLCERT option then we enable the checking of this certificate by setting stagerverifysslcert to true.</span></p>
<p><span style="color: #000000;"><strong>PEM</strong> is a widely used encoding format for security certificates. Syntax and content are defined by X.509 v3 standards for digital certificates, defined in IETF RFC 5280 specifications. The main <strong>file</strong> extensions are .<strong>pem</strong>, .crt, .ca-bundle. A <strong>PEM</strong> certificate is a base64 (ASCII) encoded block of data encapsulated between.</span></p>
<p><span style="color: #000000;">In the next prompt choose payload category for auto-building payload, from the given list I chose<strong> stagless (payload.exe)</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-DeeaoEdboGs/WR_Gvuz52cI/AAAAAAAAQBM/RwB951FoivgxvkJUQwJspSUgRB6BoK15wCEw/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Once that payload is created we need to create a handler to receive the connection and again we use the PEM certificate so the handler can use the SHA1 hash for validation. Just like with the Payload we set the parameters HANDLERSSLCERT with the path to the PEM file and stagerverifysslcert to true.</span></p>
<p><span style="color: #000000;"> We can see the stage doing the validation when we recite a session back.</span></p>
<p><span style="color: #000000;"><strong>Enter LHOST 192.168.0.108 (attacker’s IP)</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kb48h98dc9A/WR_GwZsZ3sI/AAAAAAAAQBQ/ZNgxJffyJ0YSI_-6l6JcdtuZ1_I3iSlvACEw/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Similarly given any random port for a reverse connection from the host system and click on <strong>ok</strong>.</span></p>
<p><span style="color: #000000;"><strong>Enter lport 8888</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-KH86JoulDsk/WR_Gw8ZxF-I/AAAAAAAAQBU/QuOY718Dy0UB3OFOvjj1BY209W6-pYwZACEw/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Again the list of payload will open from that prompt choose desire payload which will generate payload for the attack.</span></p>
<p><span style="color: #000000;"><strong>windows/meterpreter_reverse_https</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-iEaaajue4cg/WR_Gx9c04QI/AAAAAAAAQBg/bl2U8uhT230jybAwj9f6O3z5spiej5ApACEw/s1600/8.png"/></span></p>
<p><span style="color: #000000;">This will configure all setting and start multi handler by lunching Metasploit framework</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-FNtqxoYNcns/WR_Gxg9wkTI/AAAAAAAAQBg/SQdpKVbpxcEFPrA_jH8q5a2kvORz84s2gCEw/s1600/9.png"/></span></p>
<p><span style="color: #000000;">When you move inside output folder here you will get two files; first for <strong>exe payload</strong> another for <strong>.pem certificate</strong>. Now use your effort for sharing exe file with your victim and wait for session establishment through meterpreter.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mrvKgOOevGY/WR_GsEeiAOI/AAAAAAAAQBg/MybaJ7yIKE4I_Dh17NqzkPWbmEoIxaz-ACEw/s1600/10.png"/></span></p>
<p><span style="color: #000000;">On another hand you can compare .pem certificate from other original certificate signed by CA, if you will observe given below image you can read certification details for hackingarticles.in which as similar as CA-signed certificates.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Mlrh4S1-45U/WR_Gsa1B3eI/AAAAAAAAQBg/zxJHKbETQBUiJe6qJF__GHEmfJm71Io3gCEw/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Hence you can see I have successfully established the meterpreter session with the victim’s system.</span></p>
<p><span style="color: #000000;">Try it by yourself!!!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-duVHgbH01nY/WR_Gs-R6ijI/AAAAAAAAQBg/5M27D0mphh8yWWJjR0lguE1r1gxbQv6AgCEw/s1600/12.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"><strong> here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
