<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux For Pentester: tmux Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-for-pentester-tmux-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2019-08-09T05:50:39+00:00">August 9, 2019</time><time class="updated" datetime="2025-06-07T12:04:17+00:00">June 7, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction">In this article, we are going to describe “tmux” which is also known as a terminal multiplexer.  It allows multiple terminal sessions to be retrieved concurrently in a single window. It is useful for running more than one command-line program at the same time.</p>
<p class="ai-optimize-7"><strong><em>NOTE: “The main objective of publishing the series of ‘Linux for Pentesters’ is to introduce the circumstances and any kind of hurdles that can be faced by any pentester while solving CTF challenges or OSCP labs which are based on Linux privilege escalations. Here we do not criticize any kind of misconfiguration that a network or system administrator does for providing higher permissions on any programs/binaries/files &amp; etc.”  </em></strong></p>
<h3 class="ai-optimize-8"><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li class="ai-optimize-9">What is tmux</li>
<li class="ai-optimize-10">How to use tmux</li>
<li class="ai-optimize-11">tmux framework</li>
<li class="ai-optimize-12">tmux commands</li>
<li class="ai-optimize-13">Assigning Sudo rights</li>
<li class="ai-optimize-14">Exploiting Sudo rights</li>
</ul>
<h3 class="ai-optimize-15"><span style="color: #800000;">What is tmux?</span></h3>
<p class="ai-optimize-15">tmux is also known as a terminal multiplexer which creates a host <strong>server</strong> on your Linode and connects to it with a client window. If the client is disconnected, the server keeps running and as you reconnect to your Linode after rebooting your computer, you can reattach to the tmux session and the files you were working with will still be open.</p>
<p class="ai-optimize-16">In other words, we can also say that this is a tool by the help of which we can open multiple windows and split views (called <em>“panes”</em> in tmux lingo) within one terminal window.</p>
<h3 class="ai-optimize-17"><span style="color: #800000;">How to use tmux</span></h3>
<p class="ai-optimize-17">Like other tmux also supports many commands to perform its function. Now we will describe each of its major operations one by one.</p>
<p class="ai-optimize-18">It can be attained by entering a key combination called the<strong> prefix</strong> and then typing a <strong>letter</strong>. There are many letters that are assigned to tmux for performing its task.</p>
<h3 class="ai-optimize-19"><span style="color: #800000;">tmux framework</span></h3>
<p class="ai-optimize-19">The entire operations that a tmux does can be easily understood by its hierarchical structure as shown below.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-x2NQobU2xDQ/XUz_TtXkgrI/AAAAAAAAf6o/mp0FihBMKmofSFRo16f_ijb90h2sq68uQCLcBGAs/s1600/0.1.png"/></p>
<h3 class="ai-optimize-20"><span style="color: #800000;">tmux commands</span></h3>
<p class="ai-optimize-20">There are list of command that can help while working with tmux. Here in this article, we are running the major operation that can be performed by the help of tmux.</p>
<p class="ai-optimize-21">Firstly, we will start with its help command. For this, we need to write “–help” on our kali terminal as shown below.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tmux --help</pre>
<p class="ai-optimize-22">I have categorized the tmux operations into 3 selections, which I described above in its framework. So now we will start from the first step i.e, “sessions”</p>
<h4 class="ai-optimize-23"><span style="color: #800000;">Operate tmux Sessions</span></h4>
<p class="ai-optimize-23">Sometimes, even multiple windows and panes aren’t enough, and you need to separate the layouts logically by grouping them into separate sessions.</p>
<p class="ai-optimize-24">Sessions are useful for completely separating work environments.</p>
<p class="ai-optimize-25">Many operations exist for the session using tmux, as the image below shows, but I’m describing a few of them.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-h_xnqO4R2fU/XUz_TgM9vLI/AAAAAAAAf6k/RdXo1FqPoKIN31weBwNIWQhNHlVsJ6BAwCLcBGAs/s1600/0.2.png"/></p>
<ul>
<li class="ai-optimize-26"><strong><em>Create a new session</em></strong>: To create a new session, we will frame the command as shown in the below image.</li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tmux new -s Ignite</pre>
<p class="ai-optimize-27">In the above command, I use “-s” as an argument for a new session and name the new session “Ignite” that I want to create.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Oz1jai_hn08/XUz_T7VW51I/AAAAAAAAf6s/jsYBlNg6aNwq4gK3H6bNRPUStUqy81a1wCLcBGAs/s1600/1.png"/></p>
<p class="ai-optimize-28">On framing above command tmux will create a new session by the name of Ignite which will highlight at the bottom of terminal. Similarly, one can create multiple session by a different name as per need.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-L04UWeDEd20/XUz_W2zlYVI/AAAAAAAAf7E/U5K1wUWCYJwM9J4dAqYQLWxn0cTBow4TQCLcBGAs/s1600/2.png"/></p>
<ul>
<li class="ai-optimize-29"><strong><em>To list all created sessions</em></strong>: once we have done with creating all session as per desire then we can check it by command as:</li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tmux list-session</pre>
<p class="ai-optimize-30">This will list all sessions as output that have been created. In below image tmux has listed all session which I have created by following the same procedure as above.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-hbQNoHKydVs/XUz_XNDWULI/AAAAAAAAf7I/hkdKutV4EA4zLcxjvFY3iMf8_DZsnaXVQCLcBGAs/s1600/3.png"/></p>
<h4 class="ai-optimize-31"><span style="color: #800000;">Operate tmux Window:</span></h4>
<p class="ai-optimize-31">When a tmux session starts, the default setting fashions a single window, but tmux also supports a utility that allows users to attach multiple windows to the same session, and we can switch between them as needed. This can be supportive when you want to run numerous jobs in parallel.</p>
<p class="ai-optimize-32">Apart from creating multiple windows it also possesses many operations like renaming any window, switch between window and many others.</p>
<p class="ai-optimize-33">At the initial phase, it displays “0: bash” by default, in which 0 represents the index value of the window, bash is the window name that you can rename as per need, * denotes the working location, and when you create a new window, tmux highlights all windows at the bottom of the terminal.</p>
<p class="ai-optimize-34"><strong>Note</strong>: We know that working of tmux is done with joining a prefix with any letter as per requirement. Find the below table to understand it clearly.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-yhFyaP24rlA/XUz_XpBj1bI/AAAAAAAAf7M/dUQ36sQUlYU_rthGBP2L4G7YWpjLZ0tggCLcBGAs/s1600/4.1.png"/></p>
<p class="ai-optimize-35">In this article, I have created 5 windows as shown in the below image. We know that users work with tmux by joining the prefix with any letter as per the requirement.</p>
<ul>
<li class="ai-optimize-36"><strong><em>Create new window</em></strong>: For creating a new window we will use “-c” with the prefix (ctrl-b).</li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Prefix (ctrl-b) +c</pre>
<p class="ai-optimize-37">This will create a new window. You can use the same procedure for creating multiple windows as below image.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-MDsQDha-NuY/XUz_X0bjLuI/AAAAAAAAf7Q/3YdpJX6rdqkjAU5fCeA5oF8Q6aJ0vrelwCLcBGAs/s1600/4.png"/></p>
<ul>
<li class="ai-optimize-38"><strong><em>Rename window: </em></strong>by default, tmux mention the window name as “bash” but we can also change it as per our wish. Here I’m renaming my last window as shown below.</li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Prefix (ctrl-b) + ,</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-WZheapBN_h4/XUz_X6ZhrPI/AAAAAAAAf7U/MnmBcmactQQGZiYrvN1J9n9DoRnXIFS-wCLcBGAs/s1600/5.png"/></p>
<ul>
<li class="ai-optimize-39"><strong><em>To switch window</em></strong>: we can also switch within multiple windows that help to provide the platform of working parallel. It can be done in many ways.</li>
</ul>
<p><img decoding="async" src="https://1.bp.blogspot.com/-3LvnYSJNLLg/XUz_YKR1FZI/AAAAAAAAf7Y/sWOp_VtZf70S51sUaA8Bw4jBJzMlzZPkwCLcBGAs/s1600/6.png"/></p>
<ul>
<li class="ai-optimize-40"><strong><em>To display summary</em></strong>: To see the entire summary for whatever we have done till now we will use tmux option as:</li>
</ul>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Prefix (ctrl-b) + w</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-K7-AKBKZMyI/XUz_YbNsJyI/AAAAAAAAf7c/Q07Dajsa4YULaX4sNuTNGJ654TnQvgBIQCLcBGAs/s1600/7.png"/></p>
<h4 class="ai-optimize-41"><span style="color: #800000;">Operate tmux Panes:</span></h4>
<p class="ai-optimize-41">With the help of tmux, we can divide each window into multiple panes. This is useful when you want outputs from multiple processes visible within a single window.</p>
<p class="ai-optimize-42">In this, we have many options such as dividing the window into vertical, horizontal panes, rotating panes, and switching to different panes. Now we will check each of these one by one.</p>
<p class="ai-optimize-43"><strong>Note</strong>: Use the table below for your reference</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Wiud6izwyA0/XUz_YvbpVeI/AAAAAAAAf7g/cDpPHsnb_FwhRaFu4Q20eud9ZPqDwKkuwCLcBGAs/s1600/8.1.png"/></p>
<p class="ai-optimize-44">Here I have divided my window into 2 panes vertically by the command as:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Prefix (ctrl-b) + %</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-362whnOGocQ/XUz_ZAhtZZI/AAAAAAAAf7k/ja7NSf7d6gEMJBrqCiKO6eZV_eWrpqotACLcBGAs/s1600/8.png"/></p>
<p class="ai-optimize-45">In the below image, I have further sub-divide my window horizontally.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Prefix (ctrl-b) + "</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-J_Eog0j-ygY/XUz_ZLeIH2I/AAAAAAAAf7o/jG9imBJIFWs6uenCSV5dRg6a1M-X7KMDQCLcBGAs/s1600/9.png"/></p>
<p class="ai-optimize-46">Suppose we have multiple panes containing some of the information in each and we want to rotate our panes if we desire. Then will follow the step as:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Prefix (ctrl-b) + {</pre>
<p class="ai-optimize-47">On framing above command tmux will simply move the current pane to left.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-UoHjJ2Jh4bY/XUz_Uo1jH4I/AAAAAAAAf6w/KHZahS39r7o_rQoTMvuXXcj1cFhGYU2YACLcBGAs/s1600/10.png"/></p>
<h3 class="ai-optimize-48"><span style="color: #800000;">Assigning Sudo Rights</span></h3>
<p class="ai-optimize-49">Sudo right is a type of permission that allows users to execute a file with super user permissions. Now we will start to perform privilege escalation for “tmux”. For doing so we need to set up our lab of tmux command with administrative rights. After that, we will check for the “tmux command” and what effect it has after getting sudo rights.</p>
<p class="ai-optimize-50">After that, we will give Sudo permission on tmux so that a local user can take the privilege of tmux as the root user.</p>
<p class="ai-optimize-51">Hence, type the following for enabling Sudo:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">which tmux
visudo</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Ez2z-PfaqSQ/XUz_VBl6YLI/AAAAAAAAf60/I7Ct7rD2gK8YuTySzvAkWzYeqQuF_sy3ACLcBGAs/s1600/11.png"/></p>
<p class="ai-optimize-52">The image below clearly shows that I have created a local user (test). To add sudo rights, open the /sudoers file and type the following as user Privilege specification.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">test All=(root) NOPASSWD: /usr/bin/tmux</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-vzYXYH1Ix_Y/XUz_Vmc4XJI/AAAAAAAAf64/4r7hlPiKUUoLQaMnTPLovKNnQN5aXk_EQCLcBGAs/s1600/12.png"/></p>
<h3 class="ai-optimize-53"><span style="color: #800000;">Exploiting Sudo rights</span></h3>
<p class="ai-optimize-54">Now we will start exploiting the tmux service by taking the privilege of a sudoer’s permission. For this, we need sessions of the victim’s machine that will assist us to have local user access of the targeted system through which we can escalate the root user rights.</p>
<p class="ai-optimize-55">First, we will connect to the target machine with SSH, therefore, type the following command to get access through local user login.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh test@192.168.1.31</pre>
<p class="ai-optimize-56">Then we will look for sudo right of “test” user (if given) and find that user “test” can execute the tmux command as “root” without a password.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l</pre>
<p class="ai-optimize-57">Then, after knowing the fact that the test user attains sudo rights, taking this benefit here, we can use the tmux command to escalate the privileges of the test user.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo tmux</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-1L7zyzZ3_dE/XUz_WWF76vI/AAAAAAAAf68/CunEblWV0t4Mcnur2IlT_Lzj5bVWld8wwCLcBGAs/s1600/13.png"/></p>
<p class="ai-optimize-58"><span style="color: #000000;"><strong>Conclusion: </strong>This will launch a new terminal with a root privilege shell.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-xh7SRTvLrgI/XUz_Wj9YguI/AAAAAAAAf7A/HxEHRg_VEwEE4vE1tljwo7rMgx9g5Rq2wCLcBGAs/s1600/14.png"/></p>
<p class="ai-optimize-6"><span style="color: #000000;">To Learn more about Privilege Escalation. Follow this</span> <a href="https://www.hackingarticles.in/category/privilege-escalation/">Link.</a></p>
<p class="ai-optimize-59"><strong>Author</strong>: Komal Singh is a Cyber Security Researcher and Technical Content Writer, she is a completely enthusiastic pentester and Security Analyst at Ignite Technologies. Contact <a href="https://www.linkedin.com/in/komal-rajput-26b783131/"><strong>Here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
