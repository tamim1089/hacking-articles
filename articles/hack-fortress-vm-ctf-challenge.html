<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Fortress VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-fortress-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2016-12-29T08:36:32+00:00">December 29, 2016</time><time class="updated" datetime="2025-06-10T20:30:20+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">today we are going to solve another CTF challenge “FORTRESS” of the vulnhub labs. The level of this challenge is not so tough and its difficulty level is described as medium. Solving this lab will give you a good experience of web penetration testing.</span></p>
<p><span style="color: #000000;">You can download it from here: https://www.vulnhub.com/entry/dc416-2016,168/</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;">Network Scanning (Nmap, netdiscover)</span></li>
<li><span style="color: #000000;">Abusing HTTP service (Burp-suite)</span></li>
<li><span style="color: #000000;">Generating Dictionary (crunch)</span></li>
<li><span style="color: #000000;">Cracking Hash (john the ripper)</span></li>
<li><span style="color: #000000;">SSH login</span></li>
<li><span style="color: #000000;">Capture the 2<sup>nd</sup> flag and 3<sup>rd</sup> flag</span></li>
</ul>
<p><span style="color: #000000;"><strong>Let’s Begin!!</strong></span></p>
<p><span style="color: #000000;">Start with the netdiscover command to identify target IP in the local network, in my network 192.168.1.109 is my target IP, you will get yours.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-KQSBxxQij2Q/W2FPeidd_OI/AAAAAAAAY3Y/tF7MqsG-RC0CMzeAyHzMjRd-n0QsoSBtACEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Further, let’s enumerate open ports and protocols information of the target’s network with help of nmap following command:</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.109</pre>
<p><span style="color: #000000;">As shown in port 22, 80, 443 are open, let’s penetrate more. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Yt4rGSRaeiQ/W2FPgQjrGGI/AAAAAAAAY3c/D2Dc2pWx910_E0fqakmJjUTf24zmH4yKACEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">So we explore target IP in the web browser and welcomed by the following image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-45Rws7P_-Ks/W2FPhRw3i2I/AAAAAAAAY3k/O-xYfDOYSFYyiF-bsZbh5ra-AlpEvFBYQCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">After making lots of efforts I decided to use dirbuster for directory brute-force. <strong>Type dirbuster</strong> on the terminal and automatically OWASP dirbuster window gets open. Here browse your dictionary from <strong>/usr/share/dirbuster/wordlists </strong>and choose your appropriate wordlist as I select medium.txt, do not forget to address target URL in the top of the text field as<strong> http//192.168.0.109 </strong>and finally hit<strong> the start </strong>button<strong>.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-DIge0PVUu8c/W2FPhfRxJcI/AAAAAAAAY3w/k3nvYgqlleoMCA1raYYlXU_jj5TK99i4ACEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Luckily!!! I found something which is <strong>a scanner.php</strong> file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JI9scpG41EY/W2FPht-YbTI/AAAAAAAAY3c/Inw0LiGZy2I2GOEpNi0_N3OMfgL8qeMJQCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">So when I explored scanner.php in the web browser, it put-up the following web page in front of us.  So when I trigger the localhost IP we got the result of Nmap scan which you can perceive from below image. I also tried to breach it through some kind of command injection but hard luck! all seems to be wasted here.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-iv-tT0XzVy0/W2FPiLi9t4I/AAAAAAAAY3g/_CDwqEP1RAQMRJqi9xLZYv8s03frTQCmwCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Then I decide to capture the HTTP request in burp suite and send the intercepted request into <strong>the repeater</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-HF882re1H8I/W2FPiP2tHwI/AAAAAAAAY3o/xLiNdnZ4a6wxSFZdY46Nz6dT4XFkPUp1gCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Look over given below image here you will find two panels left and right for request and response respectively.</span></p>
<p><span style="color: #000000;">Type ls as request and click on go tab. This will generate a response to the request you made.</span></p>
<pre class="lang:default decode:true">Request: ls
Response: index.html
k1ngd0m_k3yz
logo.png
s1kr3t
scanner.php
styles.css</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-i98Wmz-nuww/W2FPifwdIdI/AAAAAAAAY3o/00KmD_OOUM0veJm9E4O1gYbcrQm-lLfYgCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">So among 4 directories enumerated above, we ran ls command again to check the list of /s1kr3t and found <strong>flag.txt</strong> as a response.</span></p>
<p><span style="color: #000000;"><strong>Request: </strong>ls</span></p>
<p><span style="color: #000000;"><strong>Response: </strong>flag.txt</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RlUJaG8d25A/W2FPizEByzI/AAAAAAAAY3w/tI4eQGv2pgsm1DFjxj1WbdokmLXgpy7QgCEwYBhgL/s1600/8_1.png"/></span></p>
<p><span style="color: #000000;">Now repeat the process till the last step of making a request and getting a response through the repeater. With help of cat command, we found the 1<sup>st</sup> flag.</span></p>
<p><span style="color: #000000;"><strong>Request: </strong>cat flag.txt</span></p>
<p><span style="color: #000000;"><strong>Response:</strong> <strong><em>FLAG{n0_one_br3aches_teh_f0rt}</em> </strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-xf1AidxvKWM/W2FPjHWQQ3I/AAAAAAAAY3k/adQsaKSZEJAy3mhS78VxvMnHzVQWNLFaACEwYBhgL/s1600/8_2.png"/></span></p>
<p><span style="color: #000000;">Then we try to a checklist of k1ngd0m_k3yz and found two files inside it.</span></p>
<p><span style="color: #000000;"><strong>Request:</strong> ls k1ngd0m_k3yz</span></p>
<p><span style="color: #000000;"><strong>Response</strong>: master and passwd</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-1H2vCns_0A4/W2FPjG2-kMI/AAAAAAAAY3o/TsLcFNdW1lEfJ8slXFnARbStBhVNIYYgwCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">So I open the master file and found a single entry of /etc/passwd file for user <strong>craven </strong>along with password hash.</span></p>
<p><span style="color: #000000;"><strong>Request:</strong> cat k1ngd0m_k3yz/master</span></p>
<p><span style="color: #000000;">Let’s copy the hash password in a text file and named it <strong>hash.txt</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5RQG1pcoRBs/W2FPjnpNAJI/AAAAAAAAY3s/E9GeaM4RRDsugk4xFpHtY89Fb0s8XHNawCEwYBhgL/s1600/9_1.png"/></span></p>
<p><span style="color: #000000;">Then I open /k1ngd0m_k3yz/passwd where I didn’t found any remarkable clue.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-50g0_EHypqQ/W2FPj8AZm3I/AAAAAAAAY3w/6sqHOT_i6IQUqPSDCx3wFSuFu3rp-jHzgCEwYBhgL/s1600/9_2.png"/></span></p>
<p> </p>
<p><span style="color: #000000;">Then I try to open /etc/passwd file and as you can observe, inside burp response, we got the passwd file and I found an entry for two local users: <strong>vulnhub &amp; Craven</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-RlVCE3PL2io/W2FPe5FOHgI/AAAAAAAAY3c/2540UDq0hRwwxgndCxbxbBa9rw0a8d0uACEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Then, I try to get into a/home/craven directory in order to view the present list with the following request.</span></p>
<p><span style="color: #000000;"><strong>Request:</strong> ls  /home/craven</span></p>
<p><span style="color: #000000;">Response: I got three files flag.txt, hint.txt, and remainder.txt.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-rZMcBGx4XnI/W2FPe_3KbBI/AAAAAAAAY3Y/0myHnq0eELkYWCvX5FwJnW3y7xkyTk2xwCEwYBhgL/s1600/11.png"/></span></p>
<p> </p>
<p> </p>
<p><span style="color: #000000;">First I try to flag.txt but fail to read it, then inside <strong>hint.txt </strong>we got some hint for the user password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YckkrLrNDh4/W2FPfXMVupI/AAAAAAAAY3s/PVDCr_Q0uHsRKWLd5Xtd59i2eEsG-faAQCEwYBhgL/s1600/12.png"/></span></p>
<p> </p>
<p><span style="color: #000000;">Then I open a reminder.txt file that gave me a list to buy.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Vlcp2GDBVRY/W2FPfmzRIQI/AAAAAAAAY3w/97LmEnVis54ybAsTJFEMbGrvbZED9A7lgCEwYBhgL/s1600/13.png"/></span></p>
<p> </p>
<p><span style="color: #000000;">Then with help of hint.txt and remainder.txt, we have generated a dictionary using crunch. Crunch is a wordlist generator where you can specify a standard character set or a character set you specify.</span></p>
<pre class="lang:default decode:true">crunch 10 10 -t %%%qwerty^ &gt; dict.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-AcMO3DLkHLE/W2FPf-4zF8I/AAAAAAAAY3s/4RS4alhTASYtPizHeRdHPZZEM_x7w70IQCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">If you remember we have already enumerated hash password for craven from inside k1ngd0m_k3yz/master. Use john the ripper to crack the password with help crunch dictionary generated above.</span></p>
<pre class="lang:default decode:true">cd Desktop
john --wordlist=dict.txt hash.txt</pre>
<p><span style="color: #000000;"><strong>931qwerty?</strong> is the password for craven as you can perceive from the given image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-VvR-07k-Z3I/W2FPgYXbUHI/AAAAAAAAY3c/yj5FqzgEYUA6sWvLzJP_wCXTXnb6aAUigCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">If you remember the result from nmap which shows port 22 is open now try to connect the target through SSH using above credential.</span></p>
<pre class="lang:default decode:true ">ssh craven@192.168.1.109</pre>
<p><span style="color: #000000;">Yesss!! We got login successfully, now when I checked the list of current directory, I found flag.txt.</span></p>
<pre class="lang:default decode:true">ls
cat flag.txt</pre>
<p><span style="color: #000000;">Luckily found 2<sup>nd</sup> <strong><em>FLAG {w0uld_u_lik3_som3_b33r_with_ur_r3d_PiLL}</em></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-KCO-MllPBcE/W2FPgWOtxsI/AAAAAAAAY3s/oY9MzyjCmz4Lv2jUTi2jsEzVbmin7gK4gCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">It was very tough to get the third flag.txt but with help of the following command, we reached to the final flag.</span></p>
<pre class="lang:default decode:true">cd /home
ls             
cd vulnhub
ls
cat flag.txt
./reader flag.txt</pre>
<p><span style="color: #000000;">For finding the 3<sup>rd</sup> flag we applied the symlink process and successfully grabbed the last flag also.</span></p>
<pre class="lang:default decode:true">cd /tmp
ln /home/vulnhub/flag.txt raj
cd /home/vulnhub
./reader /tmp/raj</pre>
<p><span style="color: #000000;">Finally, I found 3<sup>rd</sup> <strong><em>FLAG{its_A_ph0t0_ph1ni5h}</em></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5KNbkNPCIXc/W2FPhIygLhI/AAAAAAAAY3k/o-5QtaM_jBM1dAmUjiB-V2jiH9KN4ep2QCEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
