<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack The Toppo:1 VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-toppo1-vm-ctf-challenges/" rel="bookmark"><time class="entry-date published" datetime="2018-07-14T18:09:50+00:00">July 14, 2018</time><time class="updated" datetime="2025-06-10T20:29:47+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve the latest CTF challenge presented by vulnhub for penetration practice and design by Mr. Hadi Mene. This lab is the proposal for beginners and mode of difficulty level is easy. You can download it from this Link: <span style="color: #3366ff;">https://www.vulnhub.com/entry/toppo-1,245/</span></span></p>
<p><span style="color: #000000;"><strong>Penetration Methodologies</strong></span></p>
<ul>
<li><span style="color: #000000;">Network scanning</span></li>
<li><span style="color: #000000;">Directory brute-force attack</span></li>
<li><span style="color: #000000;">Abusing HTTP web directories</span></li>
<li><span style="color: #000000;">Compromise confidential</span></li>
<li><span style="color: #000000;">Spawn tty shell (ssh login)</span></li>
<li><span style="color: #000000;">SUID privilege escalation</span></li>
<li><span style="color: #000000;">Get root access and capture the flag</span></li>
</ul>
<p><span style="color: #000000;">Let’s Begin!!</span></p>
<p><span style="color: #000000;">You will get target VM machine IP at the time of boot-up so let’s start with nmap port enumeration and execute the following command in our terminal.</span></p>
<pre class="lang:default decode:true ">nmap -A 192.168.1.104</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7t_jm02A7hE/W0o7x9MtMvI/AAAAAAAAYGQ/IeY66m4HppYqWgydU6o5rDKmNqi0I6QQQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Since port 80 was opened; so I explored target IP in the web browser and welcomed by following the web page as shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-qfT_Uo83ZIg/W0o7yoIsKLI/AAAAAAAAYGc/aPfYd7_7m6sC--qkys61HpjisJ3pQRixgCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Unfortunately, I didn’t compute any remarkable hint from its web home page, therefore, I decided to launch directory brute-force attack through ‘dirb’ and run following command.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.104</pre>
<p><span style="color: #000000;">The minute you will execute the above command you will found so many web directories. Here <em>/admin</em> looks more interesting, let’s figure out it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QkZN_i9gvCY/W0o7xws_AcI/AAAAAAAAYGU/dX6odBAqINY69G0xMs8CXNfEhWqAkBfLwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">So when I explored the following URL, it put-up a <strong><em>notes.txt</em></strong> file which might be holding something important.</span></p>
<pre class="lang:default decode:true">http://192.168.1.104/admin</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Jhs63-Vmitk/W0o7yaNSawI/AAAAAAAAYGY/rlfc0FgIPo8uFUAjC-aauveLZ9Uy1Z5yACLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">So I looked into notes.txt and notice towards “<strong><em>12345ted123</em></strong>” which is a password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-S9LzFU0pPh8/W0o7y0LzEMI/AAAAAAAAYGg/w8ovulfUJbgmawTy2GEiuQy1eUV3OJrswCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Since port 22 was open so I can try ssh login and as we already have the password <em>12345ted123</em> but don’t know the username, therefore, I decided to use the hit-try method and use following credential for ssh login.</span></p>
<pre class="lang:default decode:true">Username: ted (predict from password)
Password: 12345ted123</pre>
<p><span style="color: #000000;">Wonderful!! We got login successfully, now move for post-exploitation and try to get root access. Then by using the following command, you can enumerate all binaries having SUID permission.</span></p>
<pre class="lang:default decode:true">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;">And it dumped all system binaries which have SUID permissions but <em>/usr/bin.mawk</em> and <em>/usr/bin/python2.7</em> are at my target point for escalating root privilege through them. So I had exploited this VM twice to root access.</span></p>
<p><span style="color: #000000;">Run the following command and get the root access directly.</span></p>
<pre class="lang:default decode:true ">mawk 'BEGIN {system("/bin/sh")}'
id
cd /root
ls
cat flag.txt</pre>
<p><span style="color: #000000;">This was the 1st technique for escalating root privilege through awk one-liner.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-FWSxh1ympxQ/W0o7zBMeeRI/AAAAAAAAYGk/3cQrChTqrcoJUzy_eHBfBF6MiYu7jLD5gCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Similarly, you can perform the same task by using python one-liner and can spawn the root shell.</span></p>
<pre class="lang:default decode:true">python2.7 -c 'import pty;pty.spawn("/bin/sh")'
whoami
cat /root/flag.txt</pre>
<p><span style="color: #000000;">B000MM!!! We have captured the flag and challenges is completed.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-olYXl5d3GkM/W0o7za9L0-I/AAAAAAAAYGo/AVSrpls8R7clDeMX4EeQu0o1pyuSzVDugCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
