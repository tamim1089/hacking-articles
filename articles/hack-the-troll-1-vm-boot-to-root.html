<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Troll-1 VM (Boot to Root)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-troll-1-vm-boot-to-root/" rel="bookmark"><time class="entry-date published" datetime="2016-07-27T10:51:46+00:00">July 27, 2016</time><time class="updated" datetime="2025-06-10T20:13:15+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another CTF challenge “Troll 1” of the vulnhub labs. The level of this challenge is not so tough and its difficulty level is described as beginner/intermediate. You can download it from here <strong><span style="color: #0000ff;">https://www.vulnhub.com/entry/tr0ll-1,100</span></strong></span></p>
<h3><span style="color: #800000;"><strong>Penetration Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;">Network Scanning (Nmap, netdiscover)</span></li>
<li><span style="color: #000000;">Anonymous FTP login</span></li>
<li><span style="color: #000000;">Abusing web browser</span></li>
<li><span style="color: #000000;">Brute-force attack (hydra)</span></li>
<li><span style="color: #000000;">SSH login</span></li>
<li><span style="color: #000000;">Privilege Escalation</span></li>
<li><span style="color: #000000;">Get root access</span></li>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<p><span style="color: #000000;">Let’s Begin!!</span></p>
<p><span style="color: #000000;">Start with the netdiscover command to identify target IP in the local network, in my network 192.168.1.102 is my target IP, you will get yours.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-X2HIyYSXZf4/W0iC12nRxpI/AAAAAAAAX38/ZvUOZeiqLMoXBwYr-ga6MtM86dYJd4aLwCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Further, let’s enumerate open and protocols information in the target’s network with help of nmap following command:</span></p>
<pre class="lang:default decode:true">nmap –A 192.168.1.102</pre>
<p><span style="color: #000000;">From its result, we found port 21 for FTP, 22 for SSH and 80 for HTTP are open. Moreover, FTP anonymous login is allowed.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-IZy_RmiwfgQ/W0iC3BuyQDI/AAAAAAAAX5M/4jUzo3bKX5IczrTzsHbPRVPZFRTubgx9QCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">So we explore target IP in the web browser and welcomed by the following image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-nM-Pj0S6Sv4/W0iC3VQczzI/AAAAAAAAX5A/T7kq3qdIV2EVzB2LBjfM8Sdn9vX7HDaowCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Since FTP anonymous login was allowed so we logged in as anonymous: anonymous and download a lol.pcap file</span></p>
<pre class="lang:default decode:true">ftp 192.168.1.102
ls -al
get lol.pcap</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FLESLs-HYjY/W0iC3o2tBJI/AAAAAAAAX5I/vqUGwG5bhJoUdOcZaWz5y-Rmw2p9jtU9ACEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">When we opened <em>the lol.pcap</em> file it was a Wireshark TCP packet and when we have opened 1<sup>st</sup> TCP stream it put up following image as shown.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-rq_gH2k0y4U/W0iC37u1YOI/AAAAAAAAX5A/yFeO3iKZRjIlUSz7JYpG5WHsvCVxhuCbwCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">While looking in TCP stream 2, I notice something suspicious “sup3rs3cr3tdirlol” it could any possible web directory. So let’s step up for further approach and figure out what this sup3rs3cr3tdirlol indicates.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-tXccOB3pQkE/W0iC4OgdURI/AAAAAAAAX5I/QCW14IfLGUUCytrG0sO2FPoNKKp7_piGACEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">So when I explore <strong>http://192.168.1.102/sup3rs3cr3tdirlol</strong> in the web browser, it put up following web page where we found a file <em>roflmao </em>and decide to download it.  </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Fjm5xKDX4_Q/W0iC4Hd-OqI/AAAAAAAAX5E/VIWATqKBOywOAJnPYzw8O2gLk_lUkCmfQCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Then with help of “string” a tool in Kali Linux, we explored the file <em>roflmao </em>and got a message ‘<strong>Find the address 0x0856BF to proceed</strong>’</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-3W9kmbkcQYE/W0iC4moyiYI/AAAAAAAAX5E/zls06hPa8-wLkpmz9ri9YOZzXhpcs-5nACEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Then again I explored /0x0856BF in the web browser considering a possible web directory and indeed it gives two sub-directories as shown in the below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-0aDVEB4gSt0/W0iC4-cpjJI/AAAAAAAAX5M/3pfM_kjV3rw0hSrxHsVecSRhGxWug6MTQCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">I opened both sub-directories and /<em>good-luck</em> looks interesting to me as it called a <strong>lol.txt</strong> file which contains a wordlist and might be this could be useful in conducting the brute force attack against ssh login. Also, the folder /<em>this_folder_contains_the_password</em> gave hint “<strong>Pass.txt</strong>” could be a possible password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-MjyIFymc7pI/W0iC12mNNXI/AAAAAAAAX44/UeXiGIfallECdIG_fJRzwzg2qxk7qY3GACEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Then we <strong>copied lol.txt</strong> wordlist into a text file and <strong>saved</strong> as <strong>dict.txt</strong> for <em>username</em> (remove 5<sup>th</sup> line while pasting the content of lol.txt into dict.txt). Since we have username dictionary file and also well aware from password let’s lunch brute-force attack for ssh login and for this you can use the following command.</span></p>
<pre class="lang:default decode:true">hydra -L /root/Desktop/dict.txt -p Pass.txt 192.168.1.102 ssh</pre>
<p><span style="color: #000000;">OOOooooh Great!! Here is our possible ssh login credential <strong>overflow:Pass.txt</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-c-8ouauL1g0/W0iC1zEF01I/AAAAAAAAX5I/Ul2uI9D20Wkifs43OT7Hp6xhD67T0XMagCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">With help of above-extracted credential, we have made successful SSH login and spawned tty shell victim’s machine. Now let’s finished task quickly and for that, we need to escalated root privileges……………. </span></p>
<pre class="lang:default decode:true">ssh overflow@192.168.1.102
find / -writable 2&lt;dev/null</pre>
<p><span style="color: #000000;">Then we have enumerated all writeable file with help of above command.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-PHEiolCNiNs/W0iC2cgrbYI/AAAAAAAAX5M/fxOWAHfkG5M8xLjsGHPx4H1MA2NxGWapwCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">We found a python file <strong>cleaner.py</strong> inside <em>/lib/log</em> and it is a small program. So here the following script was added by admin to clean up all junk file from inside <em>/tmp</em> and these type of files depends upon specific time interval for executions.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-S_WBdPdR_yA/W0iC2v0yHZI/AAAAAAAAX5A/eKgpI7iOh3UnRTkzeZjTUSCE-gRMmkyigCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">There so many methods to gain root access as in this method we copied /bin/sh inside /tmp and enabled SUID for /tmp/sh. It is quite simple, first, open the file through some editor for example nano sanitizer.py and replace<strong>“rm -r /tmp/*”</strong> from the following line as given below:</span></p>
<pre class="lang:default decode:true">os.system('cp /bin/sh /tmp/sh')
os.system('chmod u+s /tmp/sh')</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-7XDrXRrhTyQ/W0iC2z3Z6zI/AAAAAAAAX44/M1dSRDwvYbQl6KFyER7QO67w8Sn4UdPfQCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">After some time it will create a sh file inside /tmp directory having SUID permission and when you will run it you will give root access.</span></p>
<pre class="lang:default decode:true">cd /tmp
ls
./sh
cd /root
ls
cat proof.txt</pre>
<p><span style="color: #000000;">HURRAYYYYYYY!!! We hit the Goal……………………………….</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-M7e_f7HHXgI/W0iC3HWgRoI/AAAAAAAAX48/NxWwrYZI_nsNRbtrUxqKvKQ6rmlMuVOpgCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
