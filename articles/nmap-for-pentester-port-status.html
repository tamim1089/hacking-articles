<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/nmap/" rel="category tag">Nmap</a></span>            </div>
            <h1 class="post-title entry-title">Nmap for Pentester: Port Status</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/nmap-for-pentester-port-status/" rel="bookmark"><time class="entry-date published" datetime="2018-02-20T12:14:55+00:00">February 20, 2018</time><time class="updated" datetime="2025-06-24T13:20:43+00:00">June 24, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends, several times you might have used NMAP to performing Network scanning for enumerating active Port services of target machine but in some scenarios you don’t get simple message if a port open or close.</span></p>
<p><span style="color: #000000;"><strong>Let’s Begin</strong></span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Requirement</span> </span></h3>
<ul>
<li><span style="color: #000000;"><strong>Attacker’s IP:</strong>  192.168.1.109 [Kali Linux]</span></li>
<li><span style="color: #000000;"><strong>Target’s IP: </strong>192.168.1.119 [Ubuntu]</span></li>
</ul>
<p><span style="color: #000000;">The states of ports are not their essential properties; it depicts how nmap sees them. In nmap a port is divided into six states:</span></p>
<ol>
<li><span style="color: #000000;"><strong>Open:</strong>  This state means that an application on the target machine is listening for connections/packets on that port.</span></li>
<li><span style="color: #000000;"><strong>Closed:</strong> This state means ports have no application listening on them, though they could open up at any time.</span></li>
<li><span style="color: #000000;"><strong>Filtered:</strong> This state means that a firewall, filter, or other network obstacle is blocking the port so that Nmap cannot tell whether it is open or closed. </span></li>
<li><span style="color: #000000;"><strong>Unfiltered:</strong> ports are classified as unfiltered when they are responsive to Nmap’s probes, but Nmap cannot determine whether they are open or closed.</span></li>
<li><span style="color: #000000;"><strong>Open/Filtered:</strong> This indicates that the filtering or opening of the port occurred, but Nmap couldn’t establish the state.</span></li>
<li><span style="color: #000000;"><strong>Closed/Filtered</strong>: This indicates that the filtering or closing of the port occurred, but Nmap couldn’t establish the state.</span></li>
</ol>
<h3><span style="color: #800000;">Open Port</span></h3>
<p><span style="color: #000000;">In this case a service or application running on a port is actively accepting TCP, UDP connections. We transmit TCP packets to the target machine’s port 80. The port is discovered to be open.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p80 192.168.1.119</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KRFIsSDaoXs/WowMsJTX84I/AAAAAAAAUuk/dnxlwodtzjM_puPI0ZjaTxMNoAny9tO0gCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">We take a look at wireshark and find that 3 way-handshake occurs as given below.</span></p>
<ul>
<li><span style="color: #000000;">Nmap sends SYN packet on port 80</span></li>
<li><span style="color: #000000;">Nmap received SYN, ACK packet as response from port 80 which denotes port 80 is open.</span></li>
<li><span style="color: #000000;">Nmap sends RST packet</span></li>
</ul>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-pG59shUnuLw/WowMu-6kbsI/AAAAAAAAUug/VbnBsPIgQX0symwYaMe6YIYy3G-hOnxhgCEwYBhgL/s1600/2.png"/></span></p>
<h3><span style="color: #800000;">Closed Port</span></h3>
<p><span style="color: #000000;">In this case a service or application on a port is accessible but no application is running on it. When a port is in closed state it sends RST with ACK packet when it receives TCP SYN packet</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p80 192.168.1.119</pre>
<p><span style="color: #000000;">We have now discovered that the SYN scan sent TCP SYN packets on port 80, which indicates that the target machine is closed. That is because as soon as it receives TCP SYN packet it sends back TCP RST, ACK packet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-k-vXn4NK33g/WowMvDE8YZI/AAAAAAAAUuc/TPc0ns64A3Ypdmk1oPGEOBz4EwmUv0NUgCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We will check Wireshark to find more information; as expected, as soon as the target machine received the TCP SYN packet, it replied with TCP RST, and NMAP interpreted it as the port being closed.</span></p>
<ul>
<li><span style="color: #000000;">Nmap sends SYN packet on port 80</span></li>
<li><span style="color: #000000;">Nmap received RST, ACK packet as response from port 80 which denotes port 80 is closed.</span></li>
</ul>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-YIP6EWjkeuw/WowMvADXi8I/AAAAAAAAUuY/MydQbMdt350EJUCutkHnt0eP4RR-7KYmwCEwYBhgL/s1600/5.png"/></span></p>
<h3><span style="color: #800000;">Filtered Port</span></h3>
<p><span style="color: #000000;">In this case Nmap is unable to determine whether a port is open because packet filtering is preventing the packets from reaching the port. When a packet drops, Nmap retries several times just in case network congestion causes the probe to drop rather than filtering. This slows down the scan dramatically.</span></p>
<p><span style="color: #000000;">Let’s use iptables to drop TCP packets on the target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">iptables -I INPUT -p tcp -j DROP</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tGqi74naJX4/WowMvZ1f8RI/AAAAAAAAUuk/oMsT1ZZS5oI_w29NImx360Jns5dmXXKdgCEwYBhgL/s1600/6.PNG"/></span></p>
<p><span style="color: #000000;">Now when we scan the target machine, the packets will be dropped as soon as it receives TCP packets.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p80 192.168.1.119</pre>
<p><span style="color: #000000;">From given below image you can observe that it is now showing state “filtered” for port 80.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-x-BAhUUtNDc/WowMv-3ZkYI/AAAAAAAAUuk/dsbggfNDL90vfpYejizjCEU4_xV87LWJgCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Let’s take a look at wireshark we find that when Nmap send TCP SYN packet we get no reply from the target machine. This means that a packet filter or firewall is dropping our packets.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pc48x9olboo/WowMv8N4prI/AAAAAAAAUuo/oBITKhUvQ78RcYlPgJ1xWMJPaB2pq5m5wCEwYBhgL/s1600/8.png"/></span></p>
<h3><span style="color: #800000;">Unfiltered Port</span></h3>
<p><span style="color: #000000;">The unfiltered state means that a port is accessible, but Nmap is unable to determine whether it is open or closed. Only the ACK scan, which is used to map firewall rulesets, classifies ports into this state. Scanning unfiltered ports with other scan types such as Window scan, SYN scan, or FIN scan, may help resolve whether the port is open.</span></p>
<p><span style="color: #000000;">We use iptables to drop any TCP packet coming to port 80 in target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">iptables -I INPUT -p tcp --dport=80 -j DROP</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-zXEETNRGIO4/WowMskg5X_I/AAAAAAAAUuY/KWSAck6MCrMhVz1TPKxTW1uWf99bM6sOwCEwYBhgL/s1600/11.PNG"/></span></p>
<p><span style="color: #000000;">Now we use <strong>nmap ACK scan</strong> to scan the target machine to check if there is any firewall or not.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap –sA -p22,80 192.168.1.119</pre>
<p><span style="color: #000000;">As we can see in given below image the port without firewall shows unfiltered as Nmap is unable to determine if it is open or close.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-jMoLVNVvqUE/WowMsn7oYwI/AAAAAAAAUug/E3-LM8cJ0dszVek1VTCHSITLQk1SUUkQACEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Wireshark shows us that for port 22 we receive a RST packet, whereas in the case of port 80, the target machine drops the packet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-w6GodYw72m8/WowMtM3k_dI/AAAAAAAAUuY/TmckDMWjBCQhbzboQTVybxOfgoEeiKEHQCEwYBhgL/s1600/13.png"/></span></p>
<h3><span style="color: #800000;">Open|Filtered Port </span></h3>
<p><span style="color: #000000;">In this case nmap is unable to determine if a port is open or filtered. This occurs for scan types in which open ports give no response. The lack of response could also mean that a packet filter dropped the probe or any response it elicited. So Nmap does not know for sure whether the port is open or being filtered. The UDP, IP protocol, FIN, NULL, and Xmas scans classify ports this way.</span></p>
<p><span style="color: #000000;">Let’s use nmap Xmas scan to scan the target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sX -p80 192.168.1.119</pre>
<p><span style="color: #000000;">As we can see the nmap scan shows us the port to be open | filtered.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-7yZmZyNSINQ/WowMthqvL0I/AAAAAAAAUuY/ft_2qQAM_U06KPm7pXetpUeR1keyhHQSACEwYBhgL/s1600/14.1.png"/></span></p>
<p><span style="color: #000000;">We will check wireshark to analyze the packets sent by nmap and we can see we don’t get a reply even if the port is open.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-SMyuHmMK_wU/WowMtud6AgI/AAAAAAAAUuY/vo1qzlMYEMgzkWTv7Z2R61BO3y7hySNNACEwYBhgL/s1600/14.2.png"/></span></p>
<h3><span style="color: #800000;">Closed|Filtered Port</span></h3>
<p><span style="color: #000000;">Nmap uses this state when it cannot determine whether a port is closed or filtered. It only uses this state for the IP ID idle scan.</span></p>
<p><span style="color: #000000;">We use iptables on our target machine to drop incoming TCP packets on the target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">iptables -I INPUT -p tcp -j DROP</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fzgL_vbvKeY/WowMt2r3F-I/AAAAAAAAUuY/K9Cgs3v3Gm8_ALVcOe6JKsRCMRfMG4yXACEwYBhgL/s1600/14.3.PNG"/></span></p>
<p><span style="color: #000000;">We will do an IP ID idle scan on the target machine using 192.168.1.107 as our zombie.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p80 -sI 192.168.1.107 192.168.1.119</pre>
<p><span style="color: #000000;">As we can see in idle scan the zombie it is showing state closed|filtered for port 80.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ouOgFL9H9Qo/WowMubNKc8I/AAAAAAAAUug/W8B6Q8FV4_MZEKWfLDSK6Tqu_dG1MGisQCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">An idle scan repeats three steps for each port:</span></p>
<ol>
<li><span style="color: #000000;">Probe the zombie’s IP ID and record it.</span></li>
<li><span style="color: #000000;">Forge a SYN packet from the zombie and send it to the desired port on the target. Depending on the port state, the target may or may not cause the zombie’s IP ID to increment.</span></li>
<li><span style="color: #000000;">Probe the zombie’s IP ID again. Compare this new IP ID with the one recorded in step 1 to determine the target port state.</span></li>
</ol>
<p><span style="color: #000000;">We check Wireshark and find that find the entire process.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-cmoGConEIg0/WowMuiRLSeI/AAAAAAAAUuo/KgVzv_btQt8TSFb6JvBgPZ1hlhkPwnS0wCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">To learn more on Nmap. Follow this </span><strong><a href="https://www.hackingarticles.in/category/nmap/">Link.</a></strong></p>
<p><span style="color: #000000;"><strong>Source: https://nmap.org/book/man.html</strong></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
