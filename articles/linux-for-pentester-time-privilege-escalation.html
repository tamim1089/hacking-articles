<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux for Pentester: Time Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-for-pentester-time-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2019-06-20T14:51:54+00:00">June 20, 2019</time><time class="updated" datetime="2025-06-07T14:04:22+00:00">June 7, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In this article, we’ll talk about Time command which is a Linux utility and learn how helpful the time command is for Linux penetration testing and how we’ll progress time to scale the greater privilege shell.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;"><strong><em>Note: “The main objective of publishing the series of “Linux for pentester” is to introduce the circumstances and any kind of hurdles that can be faced by any pentester while solving CTF challenges or OSCP labs which are based on Linux privilege escalations. Here we do not criticizing any kind of misconfiguration that a network or system administrator does for providing higher permissions on any programs/binaries/files &amp; etc.”  </em></strong></span></p>
<h3 class="ai-optimize-8"><span style="color: #800000;"><strong>Table of Contents</strong></span></h3>
<p class="ai-optimize-9"><span style="color: #000000;">All About Linux Time Command</span></p>
<p class="ai-optimize-10"><span style="color: #000000;">Major Operation Perform by Time</span></p>
<p class="ai-optimize-11"><span style="color: #000000;">Abusing Time Utility</span></p>
<ul>
<li class="ai-optimize-12"><span style="color: #000000;">SUID Lab Setups for Privilege Escalation</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">Privilege Escalation</span></li>
<li class="ai-optimize-14"><span style="color: #000000;">Sudo Lab Setups for Privilege Escalation</span></li>
<li class="ai-optimize-15"><span style="color: #000000;">Privilege Escalation</span></li>
</ul>
<h3 class="ai-optimize-16"><span style="color: #000000;"><strong><span style="color: #800000;">All About Linux Time Command</span> </strong></span></h3>
<p class="ai-optimize-17"><span style="color: #000000;">The time command runs the specified program command with the given arguments.  When the command finishes, time writes a message to standard error giving timing statistics about this program run.</span></p>
<p class="ai-optimize-18"><span style="color: #000000;">These statistics consist of:</span></p>
<ul>
<li class="ai-optimize-19"><span style="color: #000000;">the elapsed real time between invocation and termination named as real.</span></li>
<li class="ai-optimize-20"><span style="color: #000000;">the user CPU time named as a user.</span></li>
<li class="ai-optimize-21"><span style="color: #000000;">the system CPU time named as sys.</span></li>
</ul>
<p class="ai-optimize-22"><span style="color: #000000;">Time may exist in most cases as a stand-alone program (such as GNU time) or as a shell (such as sh, bash, tcsh, or zsh).</span></p>
<p class="ai-optimize-23"><span style="color: #000000;">To identify all type of installed time program we run this:</span></p>
<pre class="lang:default decode:true">type -a time</pre>
<p class="ai-optimize-24"><span style="color: #000000;">Here “<em>time is a shell keyword</em>” which means it a built-in keyword exist to bash whereas “<em>time is /usr/bin/time</em>” denotes it’s a binary that exists to GNU.</span></p>
<p class="ai-optimize-25"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dbiKY7lV6ZI/XQua8Vlf0OI/AAAAAAAAe5I/KsYSipfeatEeR2DiqmgvUo6a6mpH4y-CACLcBGAs/s1600/1.png"/></span></p>
<h3 class="ai-optimize-26"><span style="color: #000000;"><strong><span style="color: #800000;">Major Operation Perform by Time</span> </strong></span></h3>
<p class="ai-optimize-27"><span style="color: #000000;">One can go with “help time” or “man time” commands to explore the summary to ensure why time command is used for?</span></p>
<p class="ai-optimize-28"><span style="color: #000000;"><strong>Run Command </strong></span></p>
<p class="ai-optimize-29"><span style="color: #000000;">As said above, time command computes the timing statistics for any program run (pipeline’s execution). For example: To compute the time taken by date command</span></p>
<pre class="lang:default decode:true">For Bash: time date
For GNU: /usr/bin/time date
/usr/bin/time -p date</pre>
<p class="ai-optimize-30"><span style="color: #000000;">As result, you will notice, first it has run the date command and dump the complete date with time zone and then disclosed the time taken by date command as real, user CPU, system CPU time in seconds. While the same information was dumped by using GNU with some extra information such as total INPUTS or OUTPUT.</span></p>
<p class="ai-optimize-31"><span style="color: #000000;">Use -p options with /usr/bin/time for obtaining output into bash time.</span></p>
<p class="ai-optimize-32"><span style="color: #000000;"><strong><em>Note:</em></strong><em> The real, user &amp; system time will be zero for any program which would execute continuously because next time that program will be recalled from the inside cache memory of the system.</em></span></p>
<p class="ai-optimize-33"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Z2QsW_PVWTw/XQua-M8wBkI/AAAAAAAAe5c/N31vPGeniww5kwj-Xz4yz8Jn_ZSXz2EZgCLcBGAs/s1600/2.png"/></span></p>
<h3 class="ai-optimize-34"><span style="color: #000000;"><strong><span style="color: #800000;">Save Output</span> </strong></span></h3>
<p class="ai-optimize-35"><span style="color: #000000;">By default, time command displays the timing statistics for the program being executed at the end of its execution in the terminal but if you want to store the obtained timing statistics inside a file then you can go with -o options.</span></p>
<p class="ai-optimize-36"><span style="color: #000000;"><strong>Syntax: /usr/bin/time -o [path of destination folder] command</strong></span></p>
<pre class="lang:default decode:true">/usr/bin/time -o /tm/ping ping google.com
cat /tmp/ping.txt</pre>
<p class="ai-optimize-37"><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-8K9hPQ1KWdE/XQua-SplQ0I/AAAAAAAAe5g/T5mAAsdtacoNbWTox2ZbGpdsa7jFZ7GrQCLcBGAs/s1600/3.png"/></strong></span></p>
<h3 class="ai-optimize-38"><span style="color: #800000;"><strong>Verbose Mode</strong></span></h3>
<p class="ai-optimize-39"><span style="color: #000000;">You can use -v option for verbose mode, here you can estimate the time acquired by the internal resources to produce an output of the given input.</span></p>
<p class="ai-optimize-40"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qsbj4vQpuGc/XQua-vapToI/AAAAAAAAe5k/OeMCVQbhrF4l7WoO9ST2dWttHj3-qqoggCLcBGAs/s1600/4.png"/></span></p>
<h3 class="ai-optimize-41"><span style="color: #000000;"><strong><span style="color: #800000;">Formatting String</span> </strong></span></h3>
<p class="ai-optimize-42"><span style="color: #000000;">The format string generally comprises of ‘ resource specifiers ‘ combined with plain text by using a percent sign (`%’) as given below.</span></p>
<pre class="lang:default decode:true">/usr/bin/time -f “Elaspsed Time = %E, Inputs %I, Outputs %O” head -4 /etc/passwd</pre>
<p class="ai-optimize-43"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zxTCxYr5Y5o/XQua-_0zXgI/AAAAAAAAe5o/v1ITQu3RpnAxBBdmDgEv6x_5spnZZ9atwCLcBGAs/s1600/5.png"/></span></p>
<p class="ai-optimize-44"><span style="color: #000000;">You can use \n for a new line to print the format string as shown the given screenshot.</span></p>
<pre class="lang:default decode:true">/usr/bin/time -f “Elaspsed Time = %E \n Inputs %I \n Outputs %O” tail -5 /etc/passwd</pre>
<p class="ai-optimize-45"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-8yGbc_n7dts/XQua-258VbI/AAAAAAAAe5s/xk8Ju5Z8GXsapXVH2DUK00LPCwTF1C2SQCLcBGAs/s1600/6.png"/></span></p>
<h3 class="ai-optimize-46"><span style="color: #800000;"><strong>Abusing Time Utility</strong></span></h3>
<h3 class="ai-optimize-47"><span style="color: #800000;"><strong>SUID Lab Setups for Privilege Escalation</strong></span></h3>
<p class="ai-optimize-48"><span style="color: #000000;">The SUID bit permission enables the user to perform any files as the ownership of existing file member. Now we are enabling SUID permission on time so that a local user can take the opportunity of time as the root user.</span></p>
<p class="ai-optimize-49"><span style="color: #000000;">Hence type following for enabling SUID bit:</span></p>
<pre class="lang:default decode:true">which time
chmod u+s /usr/bin/time
ls -la /usr/bin/time</pre>
<p class="ai-optimize-50"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-s2cJ5lEjlpc/XQua_Ph2DJI/AAAAAAAAe5w/G-fTaMHrq2UnsQ1XdA5calsumKmsMqAzwCLcBGAs/s1600/8.png"/></span></p>
<h3 class="ai-optimize-51"><span style="color: #000000;"><strong><span style="color: #800000;">Privilege Escalation</span> </strong></span></h3>
<p class="ai-optimize-52"><span style="color: #000000;">Now we will start exploiting time service by taking the privilege of SUID permission. For this, I’m creating a session of the victim’s machine which will permit us to develop the local user access of the targeted system.</span></p>
<p class="ai-optimize-53"><span style="color: #000000;">Now we need to connect with the target machine with ssh, so type the command:</span></p>
<pre class="lang:default decode:true">ssh test@192.168.1.103</pre>
<p class="ai-optimize-54"><span style="color: #000000;">As we know we have access to victim’s machine so we will use find command to identify binaries having SUID permission.</span></p>
<pre class="lang:default decode:true">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p class="ai-optimize-55"><span style="color: #000000;">Here we came to recognize that SUID bit is permitted for so many binary files, but are concerned is:   /usr/bin/time.</span></p>
<p class="ai-optimize-56"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ekWmyxkL8Tw/XQua_x_e-3I/AAAAAAAAe50/ZJIstuOLBAUJndW-6exVa41LbzxSmAqVgCLcBGAs/s1600/9.png"/></span></p>
<p class="ai-optimize-57"><span style="color: #000000;">Taking privilege of SUID permission on time we are going to grab the shadow’s file for extracting password hash file.</span></p>
<p class="ai-optimize-58"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qx7s2pXkRPs/XQua8PH3ZiI/AAAAAAAAe5E/s2qLi02pbdkKgOte0HILchlZ0j1Ao5dlACLcBGAs/s1600/10.png"/></span></p>
<p class="ai-optimize-59"><span style="color: #000000;">Now I have use john the ripper tool to crack the password hashes. By doing so we will get credential of the user as shown in below image.</span></p>
<pre class="lang:default decode:true">john hash</pre>
<p class="ai-optimize-60"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-s2hezMBDDik/XQua8doLJ3I/AAAAAAAAe5M/cxLTBZOpnncAlzbFvcwsIg4-u_iHZ_3CQCLcBGAs/s1600/11.png"/></span></p>
<p class="ai-optimize-61"><span style="color: #000000;">Once we get the user’s credential then we can switch user. Here first we check sudo rights for user: raj and noticed that user “raj” has ALL privileges.</span></p>
<pre class="lang:default decode:true">su raj
sudo -l
sudo su</pre>
<p class="ai-optimize-62"><span style="color: #000000;">Therefore, we switch to the root user account directly and access the root shell as shown in the image. Hence, we have successfully accomplished our task of using time utility for Privilege Escalation.</span></p>
<p class="ai-optimize-63"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_iDPhZhfjAo/XQua9OqealI/AAAAAAAAe5Q/QwMj5l6o1OsVJk-t3GzPssoJJZB4O8GmwCLcBGAs/s1600/12.png"/></span></p>
<h3 class="ai-optimize-64"><span style="color: #800000;"><strong>Sudo rights Lab setups for Privilege Escalation</strong></span></h3>
<p class="ai-optimize-65"><span style="color: #000000;">Now here our next step is to set up the lab of Sudo rights or in other words to provide Sudo privileges to a user for time executable. Here we are going to add a user by the name of the test in the sudoers files and here we have given permission to user test to run /usr/bin/time as the root user.</span></p>
<p class="ai-optimize-66"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4wy0lWBRxKE/XQua9KJ5IrI/AAAAAAAAe5U/J2JjD-TBmYYbW4snkhUYTcvaUt_icaGdQCLcBGAs/s1600/13.png"/></span></p>
<h3 class="ai-optimize-67"><span style="color: #000000;"><strong><span style="color: #800000;">Privilege Escalation</span> </strong></span></h3>
<p class="ai-optimize-68"><span style="color: #000000;">Now we will connect through ssh in kali and after that, we will run sudo -l which is sudo list and through which we can see that user test has the permission to run /usr/bin/time as the root user.</span></p>
<pre class="lang:default decode:true">sudo -l</pre>
<p class="ai-optimize-69"><span style="color: #000000;">As we have seen above, that time command computes the time when a program run, therefore, now taking advantage of time command.</span></p>
<pre class="lang:default decode:true">sudo time /bin/sh</pre>
<p class="ai-optimize-70"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wdX0xhsoyic/XQua9dJUDsI/AAAAAAAAe5Y/YKzPvro90nwsExbbVjENQVeN2DWGYur3gCLcBGAs/s1600/14.png"/></span></p>
<p class="ai-optimize-71"><span style="color: #000000;"><strong>Conclusion:</strong> In this post, we have talked on time command to demonstrate how an to intrude can escalate the privilege using time utility due to permissions allowed on it.</span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To Learn more about Privilege Escalation. Follow this</span> <a href="https://www.hackingarticles.in/category/privilege-escalation/">Link.</a></p>
<p class="ai-optimize-72"><span style="color: #000000;"><strong>Author</strong>: Komal Singh is a Cyber Security Researcher and Technical Content Writer, she is completely enthusiastic pentester and Security Analyst at Ignite Technologies. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/komal-rajput-26b783131/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
