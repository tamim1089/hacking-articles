<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Vulnhub: Kuya: 1 Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/vulnhub-kuya-1-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-03-01T09:46:50+00:00">March 1, 2019</time><time class="updated" datetime="2025-06-10T20:11:52+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another CTF challenge “Kuya”. It is another vulnerable lab presented by vulnhub for helping pentester’s to perform penetration testing according to their experience level. This vulnerable lab can be downloaded from <a href="https://www.vulnhub.com/entry/kuya-1,283/">here</a>.<br/>
</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Medium</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> To find three flags hidden in the whole application</span></p>
<h3><span style="color: #800000;"><strong><u>Penetrating Methodology</u></strong></span></h3>
<ul>
<li><span style="color: #000000;">Machine discovery and scanning(netdiscover, nmap)</span></li>
<li><span style="color: #000000;">Surfing HTTP service port(80)</span></li>
<li><span style="color: #000000;">Directory enumeration using dirbuster</span></li>
<li><span style="color: #000000;">Extract steganographic content using steghide</span></li>
<li><span style="color: #000000;">Extract file from a pcapng file using Wireshark</span></li>
<li><span style="color: #000000;">Extract and decrypt hashes using John the Ripper</span></li>
<li><span style="color: #000000;">Check contents of system-wide configuration files for credentials</span></li>
<li><span style="color: #000000;">Privilege escalation using tar</span></li>
</ul>
<p><span style="color: #000000;">Let’s start off with discovering the IP address of our VM</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-p5Q648Lre_w/XHel_RkYj0I/AAAAAAAAdG0/SHMKM6VQ8UEWactzkQclKoc-wYO9wyS9ACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Then we’ll continue with our basic Nmap command to find out the open ports and services. Here we’ll find port 22 and 80 open.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.0.16</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-bydi8vE5Myg/XHemCqyswfI/AAAAAAAAdHc/fddmG14a_6oZmqs5Tc5_aEE4Tgu6k9bxwCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Once we get the idea of the existence of a web application, we’ll browse it on a browser</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-earnhg29FP0/XHemC_cSDOI/AAAAAAAAdHg/nlqBPHmopQMMGFhouGlirTGzhyevJGkXgCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We’ll use dirbuster to brute force the directories of the web application.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-O4lcxkiYFT0/XHemDGZ1eHI/AAAAAAAAdHk/wu7atYLm64Q__IWweWYgbk__PF7B9_SlQCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We’ll browse the directories one-by-one only to find that “loot” is the only helpful directory</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-vjP3YbmUbYI/XHemDUbR72I/AAAAAAAAdHo/MkBxvIsHo6g3n-Odyb8KegPLZNK8KEwLQCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We’ll download all the images and use steghide to discover the hidden content beneath the images.</span></p>
<pre class="lang:default decode:true">steghide extract -sf 1.jpg
steghide extract -sf 2.jpg
steghide extract -sf 3.jpg
steghide extract -sf 4.jpg
steghide extract -sf image.jpeg</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ZaqaCc1XR1s/XHemD7sI07I/AAAAAAAAdHs/ezUzuo4kngsqz_Tt6Aefxg58_FtyfKUhgCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now, we’ll try to read the files, “secret.txt” there contained a base64 encoded string. Once decoded, it would give a string, not very useful.</span></p>
<pre class="lang:default decode:true">cat secret.txt</pre>
<p><span style="color: #000000;">We’ll check the emb.txt, we get the brainfuck encrypted text</span></p>
<pre class="lang:default decode:true">cat emb.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-oNQZYTjYP1s/XHemDwNNYjI/AAAAAAAAdHw/e1CoWLGEtlM9gZYelrSDt19GAZYvOgO4QCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Once decrypted, the brainfuck encryption gave us the result and our first flag</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ryR6OILXjqk/XHemEW7qU0I/AAAAAAAAdH0/fT-MXVe-XowFY44eo_0DnkFoFY1i_XGPQCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">We’ll open the “loot.pcapng” file with Wireshark to check the communication and there we found the record of GET and POST request for downloading a file along with the file byte in the 11<sup>th</sup> packet. Once selecting the packet we’ll go to <strong>File</strong> &gt; <strong>Export Objects</strong> &gt; <strong>HTTP</strong> and then save the 7z file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-I4KlZIrZDF4/XHel_eLWvbI/AAAAAAAAdG4/hcS5TN-V-YANDmAeBND0QRND9E4G_gw1ACLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">When we tried to open and extract the file contents, it asked for a password so we’ll use <strong>7z2john.pl</strong> to get the hash value from the 7z file and use john the ripper to crack it using the rockyou.txt wordlist. Here, we get the password “manchester” for the 7z file.</span></p>
<pre class="lang:default decode:true ">./7z2john.pl loot.7z &gt; 7zhash
john 7zhash --wordlist:/usr/share/wordlists/rockyou.txt</pre>
<p><img decoding="async" src="https://2.bp.blogspot.com/-tHTsl_mfrbE/XHemAI4YUjI/AAAAAAAAdHA/DiuzFBoR7z4zwXaq2WEEOBgOotAKA8tCgCLcBGAs/s1600/12.png" border="0" data-original-height="261" data-original-width="839"/></p>
<p><span style="color: #000000;">We’ll again try to extract the contents of the 7z file, providing the password we found out about the two key files found</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-2_QznORW6yY/XHel_fLX9cI/AAAAAAAAdG8/r-4Hx-u1veoLcgzxsTFm06pjpyNCQ_MlACLcBGAs/s1600/11.png" border="0" data-original-height="519" data-original-width="602"/></p>
<p> </p>
<p><span style="color: #000000;">Again, we move back to john the ripper, this time we’ll use <strong>ssh2john.py</strong> script to get the hash value from the id_rsa file, then we’ll use john to crack the hash using rockyou.txt as wordlist. The password decrypted as “hello”</span></p>
<pre class="lang:default decode:true">python ssh2john.py id_rsa &gt; id_rsa.hash
john id_rsa.hash --wordlist:/usr/share/wordlists/rockyou.txt</pre>
<p> </p>
<p> </p>
<p><span style="color: #000000;">Then we wanted to know the username so we head towards id_rsa.pub to check the contents and discover the username </span>in<span style="color: #000000;"> the end of the file. The username came out as “test”.</span></p>
<pre class="lang:default decode:true">cat id_rsa.pub</pre>
<p><span style="color: #000000;">Now we have the username and the private key along with the password, let’s try to connect to SSH</span></p>
<pre class="lang:default decode:true">ssh -i id_rsa test@192.168.0.16</pre>
<p> </p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-XKmGdsRUfP4/XHemAyQyqBI/AAAAAAAAdHE/OXtesHyqkSsoedb_fYONv6p1ILXz-txkACLcBGAs/s1600/13.png" border="0" data-original-height="573" data-original-width="1015"/></p>
<p><span style="color: #000000;">After getting a shell, first we’ll check the files, in the <strong>.ssh</strong> directory, we will find a <strong>sshscript.sh</strong> file having our second flag.</span></p>
<p><span style="color: #000000;">Then we’ll move to /var/www/html /</span>wordpress<span style="color: #000000;"> directory to look out for configuration files and we found a file <strong>wp-config-sample.php</strong></span></p>
<pre class="lang:default decode:true">cd .ssh
ls -la
cat sshscript.sh
cd /var/www/html/wordpress
ls –al</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-_-ff_gVRvUI/XHemBTW86lI/AAAAAAAAdHI/1QboyVkiwDAt90-c5qWoJEsxMewrgynVwCLcBGAs/s1600/14.png"/></strong></span></p>
<p><span style="color: #000000;">Use more command along with the cat command to display the complete contents of the config file.</span></p>
<pre class="lang:default decode:true">cat wp-config-sample.php |more</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-eSCZLxY-hr4/XHemBiIwaQI/AAAAAAAAdHM/lGaatM9m8-ofmx3SpbxDpnL_7VekrM55gCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Once we get the credentials, use su to switch to a new user, now we tried to find files with sudo permissions, but no luck so we switch to the home directory of the new user and check the files. Here we have a hidden file with bash history named <strong>.bash_history</strong> having some useful information. It provides us with details about the use of getcap and setcap commands.</span></p>
<pre class="lang:default decode:true">su kuya
find / -perm -4000 2&gt;/dev/null
cd
ls
cat who_dis.txt
cat .bash_history</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-PnVNlSwByrs/XHemBqf4SZI/AAAAAAAAdHQ/DUii1X1mgbAdvZptln3L-TJJcPnEszcVgCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">In </span>Linux<span style="color: #000000;">, files can be provided with a capability to access specific files majorly critical files with specific permissions only; like a script file can be provided with the capability to read ssh configuration files or /etc/shadow file which can be done using </span>getcap<span style="color: #000000;"> and </span>setcap<span style="color: #000000;"> commands. For more information about this, look here(<a style="color: #000000;" href="https://linux.die.net/man/7/capabilities">https://linux.die.net/man/7/capabilities</a>)</span></p>
<p><span style="color: #000000;">In </span>Linux<span style="color: #000000;">, tar has the specific permission to read all files so here we will create a tar file of /etc/shadow and then extract that tar file to display the contents of the newly extracted copy of the original shadow file.</span></p>
<pre class="lang:default decode:true">export PATH=/bin:/sbin:/usr/bin:/usr/sbin:$PATH
getcap -r / 2&gt;/dev/null
tar -cvf shadow.tar "/etc/shadow"
tar -xvf shadow.tar
cat etc/shadow</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://2.bp.blogspot.com/-dmYN2bHL56A/XHemCGPWriI/AAAAAAAAdHU/Pd2UTUvwMO0ewF95oHOMav0zmfvQK8GlQCLcBGAs/s1600/17.png"/></strong></span></p>
<p><span style="color: #000000;">As we can open extract and archive files that need root permission. We can use the “tar” command to archive the entire “/root” directory as shadow.tar inside user kuya’s home directory. We then extract “shadow.tar” using tar command and are able to get the root directory. We go to the extracted root directory and find a file called “M3m3L0rd.txt”. We open the file and find the final flag.</span></p>
<pre class="lang:default decode:true">tar cvf shadow.tar /root
tar xvf shadow.tar
cd root/
cat M3m3L0rd.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-sIwH9GXzFVU/XHemCUmkwZI/AAAAAAAAdHY/aqz2s5MwKnQxb73cpEoQ5q5BZXDNn3NQgCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>:  Deepanshu is a Certified Ethical Hacker and a budding Security researcher. Contact</span> <strong><a class="broken_link" href="https://www.linkedin.com/in/deepanshu-k-a4248b138/">here</a>.</strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
