<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Zorz VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-zorz-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2016-12-16T08:28:18+00:00">December 16, 2016</time><time class="updated" datetime="2025-06-10T20:30:21+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Zorz is another VM that will challenge your webapp skills. There are 3 separate challenges (web pages) on this machine. It should be pretty straight forward.  This machine will probably test your web app skills once again. There are 3 different pages that should be focused on(you will see). Your goal is to successfully upload a web-shell or malicious file to the server.</span></p>
<p><span style="color: #000000;">This machine (zorz) does not runs on vmware. So, in case you are using your Kali Linux in vmware(for attacking), you will probably need to run Zorz on a different system in Virtual Box and of course in the same network.</span></p>
<p><span style="color: #000000;">You can download this machine from here: https://www.vulnhub.com/?q=zorz&amp;sort=date-des&amp;type=vm</span></p>
<p><span style="color: #000000;"><strong>Penetration Methodolgies:</strong></span></p>
<ul>
<li><span style="color: #000000;">Network Scaning (Netdiscover, Nmap)</span></li>
<li><span style="color: #000000;">Exploting Each level of File Uploading vulnbility</span></li>
<li><span style="color: #000000;">Directory brute force attack (Dirb)</span></li>
<li><span style="color: #000000;">Obtain Netcat session for each level.</span></li>
</ul>
<p><span style="color: #000000;"><strong><u>Walkthrough </u></strong></span></p>
<p><span style="color: #000000;">Let’s start with our all time favourite netdiscover to get the victim machine’s IP.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-zo31kBPwy1c/W46mtgrjRZI/AAAAAAAAaFc/pZPAqLx460UZJvXgtV837IZpqJH7t0iggCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">So, our target is located on 192.168.1.8. Let’s quickly do an nmap scan to get an idea of open ports.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.129</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-8QcmaTGS2RA/W46mwGEBnyI/AAAAAAAAaGI/N09o-RbaVB42wDBaOhyjwR-GFQ4LpdFNwCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Ok, so we have port 22 and port 80 open. Let’s visit the IP on our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-atW6h4tlWrE/W46mwLCj88I/AAAAAAAAaGM/Oldg1HbdsesSQfv69b2twzmcKHR9HTBugCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">And it opened up like a beautiful treasure! As you can see, according this web page “contact Support” here we can attached our file and can discuss our problem.</span></p>
<p><span style="color: #000000;">So, here is what we did.</span></p>
<p><span style="color: #000000;">Traverse to the directory: <strong>/usr/share/webshells/php/php-reverse-shell.php</strong></span></p>
<p><span style="color: #000000;">Open it with text editor and add listening IP and port and save this file as <strong>php-reverse-shell.jpg</strong> and start netcat at listening port.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-rVz56_46VJo/W46mwXyko0I/AAAAAAAAaGQ/rWaghLV8c7kw_OuBwuSsPtX954Kiqx7HACLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Next we try to upload this file and our shell gets uploaded successfully.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Dxy6I7aw8Rs/W46mwlLUw1I/AAAAAAAAaGU/-E0wY7jdePEqZVQq0SHhEDp5ZGXPma0nACLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">But we have no idea as to where our file gets uploaded on the server. In order to get the location/directory of our shell, we run dirb using the dictionary /usr/share/dirb/wordlists/big.txt</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.129 /usr/share/dirb/wordlists/big.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-vDWrCl0rsIA/W46mxd3zRbI/AAAAAAAAaGY/QmjXUeu2XCwm7wAoreUlaZoRktO_G5SrACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">And we get to know of a directory named “<em>uploads2</em>”. Upon visiting this directory, we do not find our shell.php file there. Thus we try to manipulate the directory name and visit the directory”<strong><em>uploads1</em></strong>”. Click the php file to open it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ROpv4dp6Iok/W46mx7Xd7DI/AAAAAAAAaGc/-7l5-4__Li8XXTRv6lz2ogJXqt0xJYxEQCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">We have successfully exploited the level 1 security and we have a netcat session running right before us.</span></p>
<pre class="lang:default decode:true">nc -lvp 1234</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-IKEqOlFyzmc/W46mycMzHpI/AAAAAAAAaGg/VTxiIfjtyVIaUtrTSsGGNWDvQjbRbCmlACLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now let’s go for the second level (Zorz Image Uploader 2) and try uploading the same file there.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-iqLI9Gn6-vw/W46myzHKYYI/AAAAAAAAaGk/ew-DBkglCS8lVzNbmSa0T6jefG1MfMIkgCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">But this time we got error, here we can upload only image with .jpg, png and GIF extension.  </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WEiv2aSCqOk/W46mttTUdTI/AAAAAAAAaFg/SSPNQ-hbneAJ6Bzda7B02IY9Q_DdsU8UwCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Time for some more tricks. Let us open the <strong>php-reverse-shell.php</strong> file in a text editor and just before our script, add the string “GIF98” and rename the file as “php-reverse-shell.php.jpg” and try to upload it once again.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1SOIU0-0un0/W46mt0ZdEbI/AAAAAAAAaFk/oNW7TzEs8rQ13N8GB097bGvPGhMLHrVwQCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">And this time It got upload successfully !!!!!!!!!!!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-6imzBsdP4nk/W46mufmhkJI/AAAAAAAAaFs/WfdpILVGBuUmy61FyS0ba2W1TJKjkS2wgCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Time to execute the backdoor and this time the location of our file is “uploads2”. Let’s open it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Grbat7oxKxA/W46muQSLqBI/AAAAAAAAaFw/5rfN3e7KJXEohlbI0mD6P1_oWZxQhBgXQCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">As you can observe again we got new netcat session and compromised victim’s VM successfully.</span></p>
<pre class="lang:default decode:true  ">nc -lvp 1234</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ugzA3LVB9hI/W46musRhmjI/AAAAAAAAaF0/Pyfn7MpYjmkUADGSQ3AEFPxbVcWmjOEOwCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Now for our final task, we open the third level (Zorz Image Uploader 3) in order to upload backdoor but here clearly Note is given for the file type you will be uploading. The uploading file should be an image with .jpeg, jpg and png extension and less than 100kb.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YB9aTTyNjWM/W46mvO-2Y6I/AAAAAAAAaF4/APsibHTLZ_cjrm_WqfBlN5My2NxFYDBcgCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">And without any edits to our “<strong>php-reverse-shell.php</strong>” file, we try uploading it here. The file uploads successfully once again. And this time the directory it has been uploaded to is <strong>uploads3</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nj5_Vg8JYLs/W46mvDAIKpI/AAAAAAAAaF8/VqkD_XgVzfwo7UJVkzysAt-FMhVHv6V8QCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Let’s visit <strong>/uploads3</strong> directory to execute the uploaded backdoor and try to obtain netcat session once again.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-EARLR7DyzJk/W46mvcC1ZGI/AAAAAAAAaGA/hYMiixr63Zk2TF-F4W-NOwYHBL0j8WyQwCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">As you can observe again we got new netcat session and compromised victim’s VM successfully.</span></p>
<p><span style="color: #000000;"><strong>nc -lvp 1234</strong></span></p>
<p><span style="color: #000000;">Mission accomplished. We have successfully bypassed all the three levels of security on this machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-DhqaUgBzNv0/W46mv5WY7dI/AAAAAAAAaGE/bsJsoWcBDxAf_u-BgcWqlt8_9uLDOGxagCLcBGAs/s1600/19.png"/></span></p>
<p><span style="color: #000000;"><strong>Researcher and Author</strong>: <strong>Jitesh Khanna</strong> is a passionate Researcher and Technical Writer at Hacking Articles. He is a hacking enthusiast. contact <a style="color: #000000;" href="https://www.linkedin.com/in/jitesh-khanna-769b1911b?trk=nav_responsive_tab_profile">here</a><strong>.</strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
