<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ms-sql-penetration-testing/" rel="category tag">MS-SQL Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">MSSQL for Pentester: Hashing</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/mssql-for-pentester-hashing/" rel="bookmark"><time class="entry-date published" datetime="2021-09-20T20:44:16+00:00">September 20, 2021</time><time class="updated" datetime="2025-05-10T18:15:13+00:00">May 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we will learn about multiple ways to get hashes of MSSQL users. Every version of MSSQL has different hashes. We have performed our practical on SQL Server 2016 version. Once we find the hashes, we will use JohnTheRipper to crack them.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;">Introduction to Hashing in SQL server</span></li>
<li><span style="color: #000000;">CLI</span></li>
<li><span style="color: #000000;">Nmap</span></li>
<li><span style="color: #000000;">PowerUpSQL</span></li>
<li><span style="color: #000000;">JohnTheRipper</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Introduction to Hashing in SQL server</strong></span></h3>
<p><span style="color: #000000;">Hash is a specific type of algorithm that produces an output string of a fixed length. The hash code is always the same length, but it will vary in complexity depending on how it’s used and may produce different hashes for different input strings.</span></p>
<p><span style="color: #000000;">SQL Server uses hashing techniques instead of encryption as it offers a one-sided procedure to hash data. And because of hashing, there is less to zero chance for it to be reversed. From SQL server 2016, the only hashing algorithms used are SHA2_512 and SHA2_256. It creates hashes of 32 or 64 bit for the desired input. You can create a hash in the SQL server through the HashByte Function.</span></p>
<p><span style="color: #000000;">A hash produced in SQL server looks somewhat like the following:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9VAIKgPq3F8/YUjxZJl-QZI/AAAAAAAAyoc/5SJnLSkc0R8Uqq2BaaNSruBQX2yuV89AwCLcBGAsYHQ/s16000/0.png"/></span></p>
<h3><span style="color: #800000;"><strong>CLI</strong></span></h3>
<p><span style="color: #000000;">To get hashes of all the users, use the following query:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">SELECT * FROM sys.sql_logins</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CC0EgM5mS4c/YUjxc5g1J5I/AAAAAAAAyog/eto7hlxE3cMPqUG6xjx-6D18_aH6tsqoACLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">To the hashes of a particular user, use the following query:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">select name,password_hash from sys.sql_logins where name='sa'</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WyoAUuf-ojE/YUjxgxoyfVI/AAAAAAAAyok/8AcI_JpXCRsJjUQs1xFky1tDPfTdpmGoQCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">As you can see, both the above queries have given us the desired result.</span></p>
<h3><span style="color: #800000;"><strong>Nmap</strong></span></h3>
<p><span style="color: #000000;">We can also retrieve the hashes remotely using Nmap. And the command to do so is the following:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p1433 --script ms-sql-dump-hashes --script-args mssql.username=sa,mssql.password=Password@1 192.168.1.146</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-A1zOV0qHSkw/YUjxlaQ4nDI/AAAAAAAAyoo/X1VWfasgcQcZBHRq2GDW9Ep75tNtx7NFACLcBGAsYHQ/s16000/50.png"/></span></p>
<p><span style="color: #000000;">And as the result of the above command, we have our hash.</span></p>
<h3><span style="color: #800000;"><strong>PowerUpSQL</strong></span></h3>
<p><span style="color: #000000;">To the hashes remotely, PowerUpSQL provides a simple command which is as follows:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Import-Module .\PowerUpSQL.ps1
Get-SQLServerPasswordHash -username sa -Password Password@1  -instance WIN-P83OS778EQK\SQLEXPRESS -Verbose</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7JZGE0LNk7A/YUjxp0Hw3CI/AAAAAAAAyos/X4lcO7lZ4TASeq5ZFBbODldI5lU6Dx8wgCLcBGAsYHQ/s16000/51.png"/></span></p>
<p><span style="color: #000000;">These are the multiple ways to retrieve the hashes for the MSSQL server, both remotely and locally.</span></p>
<h3><span style="color: #800000;"><strong>JohnTheRipper</strong></span></h3>
<p><span style="color: #000000;">Now that we have acquired the hashes, all we have to do is crack them. For this, we will use the almighty password cracker tool, i.e., JohnTheRipper. And to de-hash the password hash, use the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john --format=mssql12 --wordlist=pass hash</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RsvxRUMflJg/YUjxtpu7MJI/AAAAAAAAyo0/3PnqJFLkw2QposMgD7oktNEmG1I8wrKRgCLcBGAsYHQ/s16000/52.png"/></span></p>
<p><span style="color: #000000;">And the result shows us that the password is Password@1 which is accurate. SO, this way, one can dump and then crack the MSSQL hashes.</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Yashika Dhir is a Cyber Security Researcher, Penetration Tester, Red Teamer, Purple Team enthusiast. Contact her on <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.linkedin.com/in/yashika-dhir/">Linkedin</a> </strong></span>and <span style="color: #0000ff;"><strong>Twitter</strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
