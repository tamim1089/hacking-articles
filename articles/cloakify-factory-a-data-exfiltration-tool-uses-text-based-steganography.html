<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/exfiltration/" rel="category tag">Exfiltration</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Cloakify-Factory: A Data Exfiltration Tool Uses Text-Based Steganography</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/cloakify-factory-a-data-exfiltration-tool-uses-text-based-steganography/" rel="bookmark"><time class="entry-date published" datetime="2019-06-12T15:53:30+00:00">June 12, 2019</time><time class="updated" datetime="2025-05-15T13:27:10+00:00">May 15, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In our previous post, we had already discussed on “<span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/data-exfiltration-using-powershell-empire/">Cloud Storage Uploads for data exfiltration</a></span>” and today we are going to discussed “Concealed Method for Data Exfiltration” to extract the unauthorized data with Cloakify Factory. Here you will learn how an intruder can exfiltrate data through steganography approach.</span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Table of Content</span> </span></h3>
<ul>
<li><strong><span style="color: #000000;">Overview</span></strong></li>
<li><strong><span style="color: #000000;">About Data Exfiltration</span></strong></li>
<li><strong><span style="color: #000000;">Cloakify Installation and Usage (for Linux)</span></strong></li>
<li><strong><span style="color: #000000;">Method -I</span></strong></li>
<li><strong><span style="color: #000000;">Method II</span></strong></li>
<li><strong><span style="color: #000000;">Cloakify Installation and Usage (for Windows)</span></strong></li>
</ul>
<h3><span style="color: #000000;"><span style="color: #800000;">Overview</span> </span></h3>
<p><span style="color: #000000;">We will perform red team practice, where we will attempt to collect the important files from the victim’s machine by inducing steganography with the help of concealed methods. When copying information from the destination machine, we will try to transform the data to befool the network monitors so that they can not identify the data packet travelling in the network.</span></p>
<p><span style="color: #000000;">All this could be performed by using a single tool named “Cloakify Factory”.</span></p>
<p><span style="color: #000000;"><strong>Cloakify Factory</strong> transforms any filetype (e.g .zip, .exe, .xls,etc.) into a list of harmless-looking string. This lets you hide the file in plain sight and transfer the file without triggering alerts. The fancy terms for this “text-based steganography”, hiding data by making it look like other data. Cloaked files defeat signature-based malware detection tools.</span></p>
<h3><span style="color: #800000;">About Data Exfiltration</span></h3>
<p><span style="color: #000000;">Data exfiltration occurs when malware and/or a malicious actor carries out an unauthorized data transfer from a computer. It is also commonly called data extrusion or data exportation. Data exfiltration is also considered a form of data theft. During the past couple of decades, a number of data exfiltration efforts severely damaged the consumer confidence, corporate valuation, and intellectual property of businesses and national security of governments across the world.</span></p>
<p><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-t9LB_yAbXJQ/XQEcMGMMMNI/AAAAAAAAewg/BebuQLp2sCYanbAs3fPpiM7SpYt6vW-iQCLcBGAs/s1600/0.png" alt="Cloakify Factory Data Exfiltration" width="892" height="195"/></span></p>
<h3><span style="color: #800000;">Methods of Data Exfiltration</span></h3>
<p><span style="color: #000000;"><strong>Open Methods:</strong></span></p>
<ul>
<li><span style="color: #000000;">HTTP/HTTPS Downloads &amp; Uploads</span></li>
<li><span style="color: #000000;">FTP</span></li>
<li><span style="color: #000000;">Email</span></li>
<li><span style="color: #000000;">Instant Messaging</span></li>
<li><span style="color: #000000;">P2P filesharing</span></li>
</ul>
<p><span style="color: #000000;"><strong>Concealed Methods:</strong></span></p>
<ul>
<li><span style="color: #000000;">SSH</span></li>
<li><span style="color: #000000;">VPN</span></li>
<li><span style="color: #000000;">Protocol Tunneling</span></li>
<li><span style="color: #000000;"><a style="color: #000000;" href="https://www.hackingarticles.in/data-exfiltration-using-powershell-empire/"><strong>Cloud Storage Uploads</strong></a></span></li>
<li><span style="color: #000000;"><strong>Steganography</strong></span></li>
<li><span style="color: #000000;">Timing channel</span></li>
</ul>
<p><span style="color: #000000;">(<a style="color: #000000;" href="https://en.wikipedia.org/wiki/Data_exfiltration">From Wikipedia</a>)</span></p>
<h3><span style="color: #800000;">Cloakify Installation &amp; Usage (for Linux)</span></h3>
<p><span style="color: #000000;"><strong>CloakifyFactory</strong> – Data Exfiltration &amp; Infiltration In Plain Sight; Convert any filetype into a list of everyday strings, using Text-Based Steganography; Evade DLP/MLS Devices, Defeat Data Whitelisting Controls, Social Engineering of Analysts, Evade AV Detection.</span></p>
<p><span style="color: #000000;">You only need to type the following to download Cloakify from GitHub on the target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/TryCatchHCF/Cloakify.git
cd Cloakify.py
chmod -R 777 noiseTools</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PTxgzpHaRgw/XQEcMKTVCBI/AAAAAAAAewo/2tjpyr-Rz3Qzv6czKxhX618AiTQUM4saACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Let’s run the python script to lunch cloakifyfactory.py</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python cloakifyFactory.py</pre>
<p><span style="color: #000000;">CloakifyFactory is a menu-driven tool that leverages Cloakify Toolset scripts. When you choose to Cloakify a file, the scripts first Base64-encode the payload, then apply a cipher to generate a list of strings that encodes the Base64 payload. You then transfer the file however you wish to its desired destination. Once exfiltrated, choose Decloakify with the same cipher to decode the payload.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-j25FX5TWnWU/XQEcPYXLvoI/AAAAAAAAexQ/CRbMUDhn_iofQEgWtTo-_ycWjAA8ynhRQCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Let’s take an example now that we want to copy a text file “pwd.txt” from within the target system containing the login credentials of different machines in the network.</span></p>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-ub4HDP4wbQk/XQEcQAyp7XI/AAAAAAAAexY/9_PN53Czav4JCIk6ggz5I3TkXdjkyANTgCLcBGAs/s1600/3.png" alt="Cloakify Factory Data Exfiltration" width="439" height="341"/></span></p>
<h3><span style="color: #800000;">Method -I</span></h3>
<p><span style="color: #000000;">It may be dangerous to copy the text file directly, so we will transform the input file data into another file as output. To do so follow the below steps:</span></p>
<ol>
<li><span style="color: #000000;">Run the python script to launch cloakifyfactory.py</span></li>
<li><span style="color: #000000;"><strong>Press 1</strong> to select cloakify a file option</span></li>
<li><span style="color: #000000;">Enter the path of the source file that you want to transform an the input file.</span></li>
<li><span style="color: #000000;">Enter the path of the destination file to where you want to save the output.</span></li>
</ol>
<p><span style="color: #000000;">  <img decoding="async" src="https://1.bp.blogspot.com/-k3skI-ilw6M/XQEcQRSTbPI/AAAAAAAAexc/fD3wWu3VM_ou8UJsJPKFDm5F01qnVXoIgCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Further, you will get a list of ciphers, choose the desired option for encrypting the file. Suppose I want the whole content to get changed into facial emojis.</span></p>
<ol>
<li><span style="color: #000000;"><strong>Press 3</strong> for emoji cipher</span></li>
<li><span style="color: #000000;">Allow to add noise to the cloaked file by <strong>pressing Y</strong> for yes.</span></li>
<li><span style="color: #000000;">Then <strong>press 1</strong> to select prependemoji.py as a noise generator.</span></li>
</ol>
<p><span style="color: #000000;">This will save the output result inside the raj.txt file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-svev0YWoP4w/XQEcQaARLOI/AAAAAAAAexg/CIYZdVR_-OsGsOlmVlW6ioMn_C1GNuiTQCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">As result, you will get the output content something like shown in the image below.</span></p>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-zsI1RVYEf1I/XQEcQ6yVigI/AAAAAAAAexk/c9jXhFaQwh8yGR1U0ec42S8M5fhNKhv_wCLcBGAs/s1600/6.png" alt="Cloakify Factory Data Exfiltration" width="525" height="668"/></span></p>
<p><span style="color: #000000;">Now if you want to obtain the output result in its original format, then you can go with the decloakify option which will revert the transformation into its original existence, but before that, you have to give all permissions to removeNoise.py</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chmod 777 removeNoise.py</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-R942Ewlp6Co/XQEcRYgfCKI/AAAAAAAAexo/a_8ymuQhwggpCYOlrTgnbMG8DQWHTOglwCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">To do so, follow the steps below:</span></p>
<ol>
<li><span style="color: #000000;">Run the Python script to launch cloakifyfactory.py</span></li>
<li><span style="color: #000000;"><strong>Press 2</strong> to select the decloakify a file option</span></li>
<li><span style="color: #000000;">Enter the path of the file that you want to restore back into its original format.</span></li>
<li><span style="color: #000000;">Enter the path of the file to where you want to save the output.</span></li>
</ol>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-b2zlgH2wrFk/XQEcRmPdRuI/AAAAAAAAexs/oEd9NSKvffgc6pBXR1nFfX4akcXkGWlDACLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;"><strong>Press Y</strong> to answer yes because we have added noise to cloaked file and select noise generator.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-IqFIQUxtNaY/XQEcR7rMNJI/AAAAAAAAexw/bP5BHjEBK1MCRsM8318eJrtUfbbcSGZPACLcBGAs/s1600/9.png" alt="Cloakify Factory Data Exfiltration" width="644" height="818"/></span></p>
<h3><span style="color: #800000;">Method II</span></h3>
<p><span style="color: #000000;">Again, we have a similar file that we want to cloaked into another format directly without operating the cloakifyfactory console.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-957AezT2Olc/XQEcMPuLBZI/AAAAAAAAewk/coAWGfvSreQcofpuQnp4xpEfZTVV9MQEQCLcBGAs/s1600/10.png"/></p>
<p><span style="color: #000000;">This time you can use a single command to cloak the file by adding specify the type of cipher as given below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JvvBH8agtiE/XQEcM2qXCGI/AAAAAAAAews/pTk7U3bncTEHbjbCmtHoQAPKD5oIA22FQCLcBGAs/s1600/11.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python cloakify.py /root/Desktop/pwd.txt ciphers/starTrek</pre>
<p><span style="color: #000000;">After executing the above command, we can observe that the output result would be something like this, as shown in the image below.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-JvvBH8agtiE/XQEcM2qXCGI/AAAAAAAAews/pTk7U3bncTEHbjbCmtHoQAPKD5oIA22FQCLcBGAs/s1600/11.png" alt="Cloakify Factory Data Exfiltration" width="755" height="823"/></span></p>
<p><span style="color: #000000;">So we have used the file.txt file as destination file to save the transformed information inside it without printing the output result on the screen. Moreover, further, we have used decloak command to revert the transformed file back into its original state.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python cloakify.py /root/Desktop/pwd.txt ciphers/starTrek &gt; /root/Desktop/file.txt
python decloakify.py /root/Desktop/pwd.txt ciphers/starTrek</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fgSz0L83S9U/XQEcNFqVhxI/AAAAAAAAeww/MXq8o2Quxh0jJ6kPyiUXF5mreuuFq9N0wCLcBGAs/s1600/12.png"/></span></p>
<h3><span style="color: #800000;">Cloakify Installation and Usage (For Windows)</span></h3>
<p><span style="color: #000000;">As we all know, this is an exfiltration tool, and data could be exfiltrated from any platform, either from a Linux or Windows-based OS. Therefore, cloakifyfactory has built the application for both platforms. In the 1<sup>st</sup> phase, we have used a Python-based application for a Linux machine, and now, remotely, we are going to deploy the cloakify factory inside a Windows machine using the MSI package of Python for our Python-based application.</span></p>
<p><span style="color: #000000;">Thus, we downloaded the MSI package on our local machine (Kali Linux):</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget https://www.python.org/ftp/python/2.7/python-2.7.msi</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-rLlDazgSWDw/XQEcNf6HZBI/AAAAAAAAew0/m9lAKZIj5yI1dgW21prxjuSjvD7SYGsVQCLcBGAs/s1600/13.png" alt="Cloakify Factory Data Exfiltration" width="695" height="221"/></span></p>
<p><span style="color: #000000;">Now our purpose is to show how an intruder can remotely exfiltrate the data using the cloakify factory. So, we had compromised the system first and got the meterpreter session and then uploaded the MSI package inside the victim’s machine to install the dependency required for Python.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">upload python-2.7.msi .
shell
msiexec /i python-2.7.msi /qn</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-m99COLDKzFk/XQEcNuf-YFI/AAAAAAAAew4/rVXISXhOq18qO5OU6JaxNLD8-4we6a6HwCLcBGAs/s1600/14.png"/></span></p>
<h5><span style="color: #000000;">Download and Install Cloakify Factory</span></h5>
<p><span style="color: #000000;">Now, download the zip file for cloakifyfactory from GitHub on your local machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-d5_OSY9wFQo/XQEcN5AZXiI/AAAAAAAAew8/K5vQQpUBBRUZtthzM8u0PRpsmD-SI6lnQCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">We also need to download 7-zip exe program for extracting the cloakify-master.zip.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-xkd8EZukUIY/XQEcOccwdfI/AAAAAAAAexA/FzWl1kFX3Z0Z43J0RCYkmpAUHo87LWUYQCLcBGAs/s1600/16.png" alt="Cloakify Factory Data Exfiltration" width="608" height="426"/></span></p>
<p><span style="color: #000000;">Now extract the 7za920.zip  and you will get the 7za.exe file that we have to inject in the victim’s machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2XjJ-qVBvSg/XQEcOVh0rlI/AAAAAAAAexE/7_2U_JeJ_tUCLpEi6QDjEB18a6JVMKDLwCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now let’s upload 7za.exe and cloakfy-master.zip in the remote system. And further, use the 7za.exe program to unzip the cloakify-master.zip.</span></p>
<p><span style="color: #000000;">Therefore, execute the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">upload /root/Downloads/Cloakify-master.zip .
upload /root/Downloads/7za.exe
shell
7za.exe x cloakify-master.zip</pre>
<p><span style="color: #000000;"><strong> <img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-f331_4VtDXc/XQEcOiDxeEI/AAAAAAAAexI/_Dsk-w6D090-Zz3KZM8uEa_FBOjV23gpgCLcBGAs/s1600/18.png" alt="Cloakify Factory Data Exfiltration" width="797" height="524"/></strong></span></p>
<p><span style="color: #000000;">Now we want to transfer the secret.txt file of the compromised machine but directly copying the file might generate an alert, therefore, we will transform the data as done above.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-arWbP1lKeWk/XQEcPATD0nI/AAAAAAAAexM/HR9XWu_hReo-6ABlRPlBXhQcErK9MafkQCLcBGAs/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Now again, we try to convert the content of the secret.txt file by hiding it behind the cloaked file. And it is very simple as performed earlier with little modification. So now we can run the cloakify.py file with the help of Python.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">C:\Python27\python.exe cloakify.py C:\Users\raj\Desktop\secret.txt ciphers\pokemonGo &gt; dump.txt
type dump.txt</pre>
<p><span style="color: #000000;">Thus, we can observe that with the help of cloakify, we have transformed the file type cannot be detected easily.</span></p>
<p><span style="color: #000000;"><strong>Conclusion:</strong> cloakify-factory could be very useful for exfiltrating data internally, as we saw it has many cipher scripts that are used on the data file, and hence it is a very effective tool for performing text-based steganography.</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-U_S9eascyrU/XQEcPgq2VsI/AAAAAAAAexU/bwsfcejglYkfPcTJBGK-jyyzQtKKd_yewCLcBGAs/s1600/20.png" alt="Cloakify Factory Data Exfiltration" width="1221" height="591"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Komal Singh is a Cyber Security Researcher and Technical Content Writer. She is a completely enthusiastic pentester and Security Analyst at Ignite Technologies. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/komal-rajput-26b783131/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
