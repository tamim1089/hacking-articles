<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">View2aKill: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/view2akill-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-02-01T14:15:51+00:00">February 1, 2020</time><time class="updated" datetime="2025-06-10T20:10:45+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we’ll be sharing another CTF challenge walkthrough. This lab is highly inspired by the James Bond movie- “A View to a Kill.” The lab is made by creosote and hosted on Vulnhub.</span></p>
<p><span style="color: #000000;">You can download the lab <a style="color: #000000;" href="https://www.vulnhub.com/entry/view2akill-1,387/">here</a></span></p>
<p><span style="color: #000000;">According to the Author:</span></p>
<p><span style="color: #000000;">Mission: Millionaire psychopath Max Zorin is a mastermind behind a scheme to destroy Silicon Valley in order to gain control over the international microchip market. Get root and stop this madman from achieving his goal!</span></p>
<ul>
<li><span style="color: #000000;">Difficulty: <strong>Intermediate</strong></span></li>
<li><span style="color: #000000;">Flag is /root/flag/flag.sh</span></li>
<li><span style="color: #000000;">Use in VMware. DHCP enabled.</span></li>
<li><span style="color: #000000;">Learning Objectives: Web Application Security, Scripting, Linux enumeration and more.</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodologies</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">netdiscover</span></li>
<li><span style="color: #000000;">Nmap scan</span></li>
<li><span style="color: #000000;">Finding ports</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating directories</span></li>
<li><span style="color: #000000;">Finding backup archive</span></li>
<li><span style="color: #000000;">Enumerating username and finding the password</span></li>
<li><span style="color: #000000;">Finding /sentrifugo</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Exploiting file upload vulnerability in sentrifugo</span></li>
<li><span style="color: #000000;">Gaining shell</span></li>
<li><span style="color: #000000;">Enumerating users and their home directories</span></li>
<li><span style="color: #000000;">Logging in Jenny</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Post Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Finding aView.py script with Jenny’s group permissions</span></li>
<li><span style="color: #000000;">Reading note.txt using this script</span></li>
<li><span style="color: #000000;">Discovering algorithm for secret directories and finding directories by creating a custom script</span></li>
<li><span style="color: #000000;">Finding remote</span></li>
<li><span style="color: #000000;">Gaining root shell</span></li>
</ul>
</li>
</ul>
<p><span style="color: #000000;">Let’s begin then,</span></p>
<p><span style="color: #000000;">On netdiscover scan, we found the IP address of the machine to be 192.168.238.161</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FnKwCvsJrgY/XjV4qInfc3I/AAAAAAAAiiU/ln8XXywAuuwvLnQA-lklGMnb2wONGi4LACLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">On running a nmap scan, we found 4 ports to be open. There was a webpage as well and nmap had also enumerated 4 disallowed entries in robots.txt</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-EsUxdu6Xfww/XjV4tFLqpgI/AAAAAAAAijA/h62dLXspk6Q2gtu8Je1_yzUD0kBLErgPwCLcBGAsYHQ/s1600/2.png"/></p>
<p><span style="color: #000000;">We opened these 4 directories one by one and saw HR acquisition portal on &lt;ip&gt;</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/--c_cpZbmny4/XjV4xGYaEgI/AAAAAAAAijs/eGaoZ_TbgmgceHiahx1sWjVG1n3sse4bQCLcBGAsYHQ/s1600/3.png"/></p>
<p><span style="color: #000000;">On &lt;ip&gt;/dev there was an index listing of multiple files. There were PDFs on some kind of RFID device, text file, images and most importantly we saw a backup archive. We downloaded it.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-BSfPsb4DCpM/XjV4zLJhRzI/AAAAAAAAikA/VT4WjG624x4_Yl7VqQA5MhkjhicAY8lmwCLcBGAsYHQ/s1600/4.png"/></p>
<p><span style="color: #000000;">Inside that archive were 4 text files among which, one important text file caught our eye which had info about a new employee chuck.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-eDY2pkJWa6I/XjV4zct_t6I/AAAAAAAAikI/6ccU7QT80L0y9DsVukfaTZBIn29KrDsgACLcBGAsYHQ/s1600/5.png"/></p>
<p><span style="color: #000000;">Now, in &lt;ip&gt;/dev directory the PDFs were starting to make sense! The password=secret word in a video+transmid freq of HID reader</span></p>
<p><span style="color: #000000;">In one of the PDFs, we saw a manual on HID proxcard reader and found the frequency to be <strong>125Hz</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-1g4gkYaoQ8s/XjV4z9WbdBI/AAAAAAAAikM/k-y-kV0579sjK2iGjZDj9mPEypYhsUSSwCLcBGAsYHQ/s1600/6.png"/></p>
<p><span style="color: #000000;">I didn’t see any video in /dev but there was a gif file which had a detonator in it. It said the word <strong>helicopter</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-qMeNF17RhtM/XjV40cNLkkI/AAAAAAAAikQ/-wXUg7FFNHccEeWE5JHaezhtTSqvVBrYACLcBGAsYHQ/s1600/7.png"/></p>
<p><span style="color: #000000;">So, the valid credentials were: <a style="color: #000000;" href="mailto:chuck@localhost.com">chuck@localhost.com</a> and pass: helicopter125</span></p>
<p><span style="color: #000000;">We tried to log it in the HR portal on &lt;ip&gt;/zorin</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-xeKFmJYXZws/XjV40RR-yJI/AAAAAAAAikU/ghaShoqBfgEQVOt-FvOuWZRvyWkeE2KEACLcBGAsYHQ/s1600/8.png" border="0" data-original-height="577" data-original-width="839"/></p>
<p> </p>
<p><span style="color: #000000;">It said that /sentrifugo was where temporarily HR portal had moved. We moved there to find a login screen</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-2w9YnKfthZk/XjV40kSEIPI/AAAAAAAAikY/FkG6MK_d6ZoOEfrmC0_zes_7l9weAMi3ACLcBGAsYHQ/s1600/9.png"/></p>
<p><span style="color: #000000;">It successfully logged us in with the found credentials! Now it was certain that exploitation had to begin from here. We tried to find any kind of vulnerability in sentrifugo platform and luckily we found one on exploit-db</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-RQ9ymdCZdfU/XjV4qRWWP3I/AAAAAAAAiic/VRdAVeCIeoUTHnv94nhC0si1wq9IjZiVwCLcBGAsYHQ/s1600/11.png" border="0" data-original-height="597" data-original-width="1032"/></p>
<p> </p>
<p><span style="color: #000000;">We went on to the portal&gt;expenses&gt;add&gt;receipts and added our php-reverse-shell with double extension methodology</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-bK8Z2ndg_KY/XjV4qYSCWgI/AAAAAAAAiiY/AB_M25FR30wslQz6NEHIY-3G2TUhX5zpQCLcBGAsYHQ/s1600/10.png"/></p>
<p><span style="color: #000000;">It’s the webshell available in /usr/share/webshells. Just change the code to your own IP and make it double extension to .php.doc</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Rohtf1VLD8Y/XjV4q0R_cKI/AAAAAAAAiig/fa5UTCKp3rI0eVVLT0qBAhIGjp5a2zUjgCLcBGAsYHQ/s1600/12.png"/></p>
<p><span style="color: #000000;">Now we intercepted the upload using burpsuite and passed it on as php and it successfully accepted it!</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-t2HHcdWbzxI/XjV4rU-BWNI/AAAAAAAAiik/VVTjAsGeopc8UatuNhzRvd9CsebQbWGzwCLcBGAsYHQ/s1600/13.png"/></p>
<p><span style="color: #000000;">We changed the extension from .php.doc to simply PHP and changed our IP from burpsuite only.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-_b_If0Sd8sw/XjV4reiVdvI/AAAAAAAAiio/Ea0TnkE4wKca5dn4MZzNtL6A67DTL34LwCLcBGAsYHQ/s1600/14.png" border="0" data-original-height="624" data-original-width="774"/></p>
<p><span style="color: #000000;">Once our shell was uploaded we started a reverse netcat listener on port 1234 and accepted the connection! We got our connection simply by viewing the shell that got uploaded.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-_-5H0_hvqRk/XjV4sCtWUAI/AAAAAAAAii0/dYUNZ66BgZw9ToMhhHlfMJQLP998vLZsgCLcBGAsYHQ/s1600/15.png"/></p>
<p><span style="color: #000000;">First things first, we imported a pseudo teletype using python one-liner.</span></p>
<pre class="lang:default decode:true">python -c 'import pty;pty.spawn("/bin/bash")'</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-v4zqTsV8FHI/XjV4sJ9p3EI/AAAAAAAAiiw/04UkC14vbQsoRl2MRjLYeVH48AhFxJtBACLcBGAsYHQ/s1600/16.png"/></p>
<p><span style="color: #000000;">Next, we traversed to the home directory and found there were 4 user directories there. In /home/jenny there was an archive named <strong>dsktp_backup.zip </strong>which seemed interesting so we unzipped it and found two text files. One had jenny’s password in it and other had some instructions among which there was a mention of a script called <strong>aView.py</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-m16_qbSgg38/XjV4s7RqJGI/AAAAAAAAii4/CsCucHgA2vcV5kGwG5XhPNwkrhk83euvQCLcBGAsYHQ/s1600/17.png" border="0" data-original-height="741" data-original-width="793"/></p>
<p><span style="color: #000000;">We logged into jenny with a password <strong>!!!sfbay!!!</strong> and traversed to /home/max to find that python script. Viewed the source code and found that it was simply printed out some text.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-2qCoufFnfCM/XjV4tLbK9PI/AAAAAAAAii8/N6_MpVePyikLSxeG_9nCX7BrmKAazdRaACLcBGAsYHQ/s1600/19.png"/></p>
<p><span style="color: #000000;">But the interesting thing to note was that it was running commands as max. And there was a note.txt in the same directory which jenny couldn’t read. So we added some code into the preexisting python script that would simply stdout the note.txt file in hope that it will be useful for privilege escalation. I wrote a script av.py that had the same content as existing script plus command to print out note.txt</span></p>
<p>You can clone this script from our GitHub Repo by clicking <a href="https://github.com/Ignitetechnologies/view2akill/blob/master/av.py">here</a>.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-S6l-9h5FYIw/XjV4t_e_BgI/AAAAAAAAijE/8ntZZRteIsEZ9GIiU_psTbqcODCDUA4pwCLcBGAsYHQ/s1600/20.png"/></p>
<p><span style="color: #000000;">On the victim’s /tmp directory I downloaded this script using wget command. Then I traversed back in /home/max to simply stdout av.py and redirect it’s output in aView.py so that when jenny runs it, it also displays note.txt</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-f46yDwFERuE/XjV4uXh0_II/AAAAAAAAijI/28yXg2fvg2UNwJ0uEDnKgHOXsLFqUzoigCLcBGAsYHQ/s1600/21.png"/></p>
<p><span style="color: #000000;">Now, in note, scarpine wrote that a secret directory exists which is hashed using the algorithm:</span></p>
<pre class="lang:default decode:true">sha1(lower_alpha+”view”+digit+digit)</pre>
<p><span style="color: #000000;">This directory existed on port 8191 and had to be found out. I used a tool called mp64 to create this list using given algorithm in clear text and then coded a python script to covert this list into its respective SHA1 hashes.</span></p>
<pre class="lang:default decode:true">mp64 ?lview?d?d &gt; fuzz.txt
python fuzzing.py &gt; new_fuzz.txt</pre>
<p><span style="color: #000000;">We can then use a simple python/c script to convert the strings into sha1 hashes or use one of the online tools such as <a style="color: #000000;" href="http://www.sha1-online.com/">http://www.sha1-online.com/</a></span></p>
<p><span style="color: #000000;">This could also be done by this following code which isn’t that complicated. </span></p>
<p>You can clone this script from our GitHub from our Repo by clicking <a href="https://github.com/Ignitetechnologies/view2akill/blob/master/new.py">here</a>.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-VQp5bCtdUuk/XjV4vB5OlxI/AAAAAAAAijU/X789YsdyCvQwLjcN7NbcdlYIVA2bb3ouACLcBGAsYHQ/s1600/24.png"/></p>
<p><span style="color: #000000;">By using the second method, we saved the hashes in directories.txt file and ran dirb scan using this list</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-G3MP4MgKoXc/XjV4vUb_YCI/AAAAAAAAijY/YmO-Otzxs2YoXF5FryvBd9ixi2Dghoj6QCLcBGAsYHQ/s1600/25.png"/></p>
<p><span style="color: #000000;">Wow. A bunch of files were found. We tried to open the first directory and looks like the author got us here!</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-z6mUVYSGh7Y/XjV4vaoFbWI/AAAAAAAAijc/fTGlGmu2CHYWcszOFX3w1JHB7jGtZ8JvgCLcBGAsYHQ/s1600/26.png" border="0" data-original-height="365" data-original-width="553"/></p>
<p><span style="color: #000000;">But wait, there was a directory that had unusual length as compared to other directories. Maybe this had something</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-wq72GAfRtDE/XjV4wNc5CSI/AAAAAAAAijk/qXhqyiwtt_sHh8bKdJ6sH12UiInjyUlZQCLcBGAsYHQ/s1600/28.png"/></p>
<p><span style="color: #000000;">Looks like we found the remote! We executed this using the button and a script called <strong>run.php </strong>seemed to run.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-9zuil13o-NI/XjV4wWetAcI/AAAAAAAAijo/eUZKGviabUE7j6Y7wNeKFjCV2Z40JXwTgCLcBGAsYHQ/s1600/29.png"/></p>
<p><span style="color: #000000;">Hey! This text seems familiar. You remember <strong>aView.py </strong>file? It seems like this run.php file was taking the stdout from aView.php file and displaying it. Now when I remember, the comment in aView.py also said: “executed from php app…”</span></p>
<p><span style="color: #000000;">So we decided to replace some of the code in aView.py by pentestmonkey’s python one-liner reverse shell!</span></p>
<p><span style="color: #000000;">We SSHed in jenny first and used nano to display contents of aView.py</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-U7vb19uJNC4/XjV4xRtdmOI/AAAAAAAAijw/xjIZXvUVUuwu0--_7v8cL15V1Sa666iXQCLcBGAsYHQ/s1600/30.png" border="0" data-original-height="764" data-original-width="739"/></p>
<p><span style="color: #000000;">We replaced aView.py with this code, which can be cloned from our GitHub Repo by clicking <a href="https://github.com/Ignitetechnologies/view2akill/blob/master/aView.py">here</a>. </span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-XiEIIiVRpXc/XjV4yMxTU7I/AAAAAAAAij4/lOvoFn9wGlQjiuIj2a-HZ7aSb-ceOWKAwCLcBGAsYHQ/s1600/32.png"/></p>
<p><span style="color: #000000;">We set up a reverse listener on port 1234 and waited for shell and voila! Seems like run.php had root permissions since we got a root shell! We traversed to /root to read the flag</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-l4KvtDG65Kc/XjV4yRGssHI/AAAAAAAAij8/2fivb7bQvpsPKYZHS_FqyxdOQkVOwAWnQCLcBGAsYHQ/s1600/33.png"/></p>
<p><span style="color: #000000;">Lets open &lt;ip&gt;:8007 on our browser and read congratulatory flag!</span></p>
<p> </p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-fcVaT7cYufw/XjV4zC6jTHI/AAAAAAAAikE/-8E9Dk8OI4so_i-Jjpb0zbVLJpynv88yACLcBGAsYHQ/s1600/34.png" border="0" data-original-height="672" data-original-width="648"/></p>
<p><span style="color: #000000;">So, this was how we solved this lab. In my opinion, if you know some things like a bit of python scripting and knowledge of basic Linux permissions and tools, lab won’t feel hard. It was certainly lengthy though due to the requirement of scripting but I thoroughly enjoyed the lab. Thanks to creosote for this!</span></p>
<p><span style="color: #000000;"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and left and right brain thinker. Contact<strong> <a class="broken_link" style="color: #000000;" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
