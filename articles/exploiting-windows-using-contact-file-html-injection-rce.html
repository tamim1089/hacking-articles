<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Exploiting Windows using Contact File HTML Injection/RCE</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/exploiting-windows-using-contact-file-html-injection-rce/" rel="bookmark"><time class="entry-date published" datetime="2019-02-01T07:02:34+00:00">February 1, 2019</time><time class="updated" datetime="2025-06-06T21:36:04+00:00">June 6, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">After the 0 day exploit on malicious VCF file in windows, cybersecurity researcher John Page deserves another round of applause for bringing this vulnerability onto exploit-db’s eye on 23<sup>rd</sup> January 2019. This vulnerability further exploits the RCE vulnerability present in VCF with HTML injections. To read the previous article follow the link <a style="color: #000000;" href="https://www.hackingarticles.in/exploiting-windows-pc-using-malicious-contact-vcf-file/">here</a>.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;"><strong>Introduction: </strong>The idea here is to include a malicious VBScript file into the email section of the VCF file so as to locally execute a script instead of opening the email via mailto. We’ll be using the anchor tag (&lt;a&gt;) of HTML to achieve the aforementioned task. This vulnerability is classified by John under “<em>Mailto: HTML Link Injection Remote Code Execution</em>”. To read more about the discovery and origin, follow the link <u><a style="color: #000000;" href="https://www.exploit-db.com/exploits/46222">here</a></u>.</span></p>
<h3 class="ai-optimize-8"><span style="color: #800000;">Methodology</span></h3>
<ul>
<li class="ai-optimize-9"><span style="color: #000000;">Making an msfvenom payload of a .vbs format.</span></li>
<li class="ai-optimize-10"><span style="color: #000000;">Sending the VBS file to the victim.</span></li>
<li class="ai-optimize-11"><span style="color: #000000;">Creating a VCF file in the parent folder.</span></li>
<li class="ai-optimize-12"><span style="color: #000000;">Adding an email into the contact with HTML injection parameters.</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">Running multi/handler in a separate window.</span></li>
<li class="ai-optimize-14"><span style="color: #000000;">Opening email in the VCF file.</span></li>
<li class="ai-optimize-15"><span style="color: #000000;">Spawning meterpreter.</span></li>
</ul>
<p class="ai-optimize-16"><span style="color: #000000;">So, without any further ado, let’s dive right into it.</span></p>
<h3 class="ai-optimize-17"><span style="color: #800000;">Proof of Concept</span></h3>
<p class="ai-optimize-18"><span style="color: #000000;">The first step would be to make a payload with a VBS extension. For this purpose, we are using msfvenom’s windows payload but any other payload should work just fine.</span></p>
<p class="ai-optimize-19"><span style="color: #000000;">In my case, the local IP address is <strong>192.168.1.109</strong></span></p>
<p class="ai-optimize-20"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-2m1gMJ9alvw/XFPrPlc3zsI/AAAAAAAAchU/a4zvV4IqeI01ARAMoBMHwDJisqAL9OkkgCLcBGAs/s1600/1.png"/></span></p>
<p class="ai-optimize-21"><span style="color: #000000;">Once the payload is made, transfer the .vbs file into the victim’s PC. </span></p>
<p class="ai-optimize-22"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-FUz7-1jY3n0/XFPrP1cBeaI/AAAAAAAAchc/577AJxiFPyAIgxP0sW-oyPzDPmhJROskACLcBGAs/s1600/2.png"/></span></p>
<h4 class="ai-optimize-35"><span style="color: #800000;">Crafting the Malicious VCF File</span></h4>
<p class="ai-optimize-23"><span style="color: #000000;">Next and the most important step is to make a contact VCF file. You can download a sample VCF too and add a website but we made a new contact file. The system we are using is Windows 10 so the version of VCF file may differ from yours but it would work just the same. Once the contact file is made, under the e-mail tab, add the HTML injection like:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;a href="raj\shell.vbs"&gt;raj@gmail.com&lt;/a&gt;</pre>
<p class="ai-optimize-24"><span style="color: #000000;">Mind here that our parent folder’s name is “Raj” and the malicious VBS file is “shell.vbs”.</span></p>
<p class="ai-optimize-25"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4hD7iSMOKpU/XFPrPnU7nyI/AAAAAAAAchY/fypLvjVrwoUMwprFA5MRe54arYULE3ewgCLcBGAs/s1600/3.png"/></span></p>
<p class="ai-optimize-26"><span style="color: #000000;">Then you’ll have to add this email address by clicking on the add button. As you can see it would look something like this:</span></p>
<p class="ai-optimize-27"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-jT4iz1g8qgI/XFPrQaFNLFI/AAAAAAAAchg/FYK-FSisuI4IkKiNPIoSOloDkmIfV3e2ACLcBGAs/s1600/4.png"/></span></p>
<p class="ai-optimize-28"><span style="color: #000000;">Once the email address gets added, you’ll have to save the contact file. The final VCF file is going to look something like this:</span></p>
<p class="ai-optimize-29"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-LPtHdReSRhA/XFPrQ-7MFwI/AAAAAAAAchk/Pc6yOsfgqa8UtOWRouseHEKwcMUGgaxxACLcBGAs/s1600/5.png"/></span></p>
<p class="ai-optimize-30"><span style="color: #000000;">By the aforementioned HTML injection tag, we are prompting a local inclusion instead of a mail prompt. This will run the malicious code and thereby, theoretically would spawn meterpreter. So, as soon as we add the mail in the VCF file, Windows will prompt you like “The e-mail address you have entered is not a valid internet e-mail address. Do you still want to add this address?” Click yes.</span></p>
<p class="ai-optimize-31"><span style="color: #000000;">When you click on the mail in the final processed VCF file, you’d probably have opened a new meterpreter session.</span></p>
<p class="ai-optimize-32"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Td1HboYgB4g/XFPrQxVqtkI/AAAAAAAAcho/RkRTbxzYla03iKdhvCFBgoAw3l-s8BFGACLcBGAs/s1600/7.png"/></span></p>
<p class="ai-optimize-33"><span style="color: #000000;">Conclusion: John Page discovered this amazing vulnerability, and it affects all the working versions of Windows that support contact VCF files. As you can see, we spawned a Windows 10 shell here; it is safe to say that lower versions are affected too. To read more about the discovery, follow the link to John Page’s website here. Thanks for reading.</span></p>
<p class="ai-optimize-34"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and a left and right brain thinker. contact<strong> <a class="broken_link" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
