<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/database-hacking/" rel="category tag">Database Hacking</a>, <a href="https://www.hackingarticles.in/category/nmap/" rel="category tag">Nmap</a>, <a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Exploiting Sql Injection with Nmap and Sqlmap</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/exploiting-sql-injection-nmap-sqlmap/" rel="bookmark"><time class="entry-date published" datetime="2017-01-17T12:56:19+00:00">January 17, 2017</time><time class="updated" datetime="2025-05-24T15:13:04+00:00">May 24, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This article is about how to scan any target for SQL injection using NMAP and then exploit the target with sqlmap if NMAP finds the target is vulnerable to SQL injection. Now go with this tutorial for more details.</span></p>
<h3><span style="color: #800000;">Introduction: Scanning for SQL Injection Using Nmap</span></h3>
<p><span style="color: #000000;">Firstly Type <span style="color: #0000ff;"><a style="color: #0000ff;" href="http://testphp.vulnweb.com/"><strong>www.vulnweb.com</strong></a></span> in URL to browse acunetix web application. Then <strong>Click</strong> the <strong>link</strong> given for the URL of <strong>Acuart</strong> as shown in the screenshot.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-2g3WMuhQfLk/WH4SDrtE1GI/AAAAAAAAO-M/Zarcr81gink2ccychDskbUZqOMmLeoJBgCLcB/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Here the required web page will get opened; <strong>testphp.vulnweb.com</strong> is our targeted host and now scans this target using nmap to identifying the possibilities of SQL injection.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Nmi-bPsidnM/WH4SDUV1QuI/AAAAAAAAO-I/SVZBh3OQHU04W0MCuj3gBu7qo25ZXy1dACLcB/s1600/2.png"/></span></p>
<h3><span style="color: #800000;">Using Nmap to Detect SQL Injection</span></h3>
<p><span style="color: #000000;"><strong>NMAP</strong> has <strong>NSE Script</strong> for <strong>http SQL injection</strong> vulnerabilities and scans the web application for SQL injection.</span></p>
<p><span style="color: #000000;">Spiders an HTTP server looking for URLs containing queries vulnerable to an SQL injection attack. It also extracts forms from found websites and tries to identify fields that are vulnerable.</span></p>
<p><span style="color: #000000;">The script spiders an HTTP server looking for URLs containing queries. It then proceeds to combine crafted SQL commands with susceptible URLs in order to obtain errors. The errors are analyzed to see if the URL is vulnerable to attack. This uses the most basic form of SQL injection but anything more complicated is better suited to a standalone tool.</span></p>
<p><span style="color: #000000;">We may not have access to the target web server’s true hostname, which can prevent access to virtually hosted sites.</span></p>
<p><span style="color: #000000;">Now type the following command to scan the target for SQL injection possibilities.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV --script=http-sql-injection www.testphp.vulnweb.com –p 80</pre>
<p><span style="color: #000000;">From the screenshot, you can perceive that it has dumped the possible SQL injection for queries. Now let’s explore this query in the browser.</span></p>
<p><span style="color: #000000;"><strong>Note:</strong> please remove http:// from resultant queries while browsing.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-pSgKANBMa_c/WH4SDrw37HI/AAAAAAAAO-Q/jJjfIfmw-58lhLlLhBCnil4KcFKwKGOLgCLcB/s1600/3.png"/></span></p>
<p><span style="color: #000000;">This page contains some message or warning related to some kind of error in the database query.  Now let’s try to apply SQL injection using above resultant sqli query of NMAP inside sqlmap and try to figure out whether the result from nmap is correct for SQL injection vulnerability or not.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-TQtDX9F_tS0/WH4SEM1CJgI/AAAAAAAAO-U/CJl7ykopIbcf7Z23A-4FTe7ohs2kx4wBQCLcB/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Open the terminal in Kali Linux and type the following command for sqlmap</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -u "http://testphp.vulnweb.com/search.php?test=query%27%200R%20sqlspider" --dbs --batch</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ypKIVMV1VOw/WH4SEPpLMXI/AAAAAAAAO-c/MpU_lS6fucYqs97U_a_V32s-C63ySJKBQCLcB/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We have got database name from the above resultant sqli query of NMAP inside sqlmap. You can read the database name <strong>acuart</strong> from the given screenshot.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-hq3_HDdU3A0/WH4SEDHbidI/AAAAAAAAO-Y/G10iG1HV9vEULgGc3rAANDc1YckEs6yuACLcB/s1600/6.png"/></span></p>
<h3><span style="color: #800000;">Dumping Full Database Contents</span></h3>
<p><span style="color: #000000;">Now try to find out entire data under this URL by typing following command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sqlmap -u "http://testphp.vulnweb.com/search.php?test=query%27%200R%20sqlspider" -D acuart --dump-all</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-q7HQp7uGDs4/WH4SEg6vYhI/AAAAAAAAO-g/V7OzExlXi3crSWbCicdDseCU9OerFhUdgCLcB/s1600/7.png"/></span></p>
<p><span style="color: #000000;">This will dump all available information inside the database. Now try it by yourself.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-JVVdmGILxv8/WH4SEwTX7-I/AAAAAAAAO-k/ZANj_YYVyGQQYQE_AG-cwoA2JDhi6F8GgCLcB/s1600/8.png"/></span></p>
<p>To learn more about Database Hacking. Follow this <strong><a href="https://www.hackingarticles.in/category/database-hacking/">Link.</a></strong></p>
<p><span style="color: #000000;"><strong>Author</strong>: Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"><strong> here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
