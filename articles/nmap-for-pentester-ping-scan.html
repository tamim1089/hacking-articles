<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/nmap/" rel="category tag">Nmap</a></span>            </div>
            <h1 class="post-title entry-title">Nmap for Pentester: Ping Scan</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/nmap-for-pentester-ping-scan/" rel="bookmark"><time class="entry-date published" datetime="2018-02-25T15:53:17+00:00">February 25, 2018</time><time class="updated" datetime="2025-05-28T11:49:46+00:00">May 28, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In this article we are going to scan the target machine with different Nmap ping scans and the response packets of different scans can be confirmed by analysis of Nmap traffic through Wireshark.</span></p>
<p class="ai-optimize-7"><span style="color: #000000;">Ping scan in nmap is done to check if the target host is alive or not. As we know that ping by default send the ICMP echo request and gets an ICMP echo reply if the system is alive. Ping scan by default send an ARP packet and gets a response to check if the host is up.</span></p>
<p class="ai-optimize-8"><span style="color: #000000;">Nmap scans changes their behavior according to the network they are scanning.</span></p>
<ul>
<li class="ai-optimize-9"><span style="color: #000000;">Scanning Local Network with Nmap where nmap sends an ARP packet with every scan</span></li>
<li class="ai-optimize-10"><span style="color: #000000;">If an external network is to be scanned; Nmap sends following request packets:</span></li>
</ul>
<ol>
<li class="ai-optimize-11"><span style="color: #000000;">ICMP echo request</span></li>
<li class="ai-optimize-12"><span style="color: #000000;">ICMP timestamp request</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">TCP SYN to port 443</span></li>
<li class="ai-optimize-14"><span style="color: #000000;">TCP ACK to port 80</span></li>
</ol>
<p class="ai-optimize-15"><span style="color: #000000;">In this article we are using —<strong>disable-arp-ping</strong> attribute for changing the behavior of nmap scans to treat a local network as a public network.</span></p>
<p class="ai-optimize-16"><span style="color: #000000;"><strong>Let’s Start!!</strong></span></p>
<h3 class="ai-optimize-17"><span style="color: #800000;">Ping Sweep </span></h3>
<p class="ai-optimize-18"><span style="color: #000000;">In order to identify live host without using ARP request packet Nmap utilize –<strong>sP option</strong> which is known as Ping Sweep Scan. We can use –<strong>sn flag</strong> which means no port scan also known as <strong>ping scan</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sP 192.168.1.104 --disable-arp-ping
or
nmap -sn 192.168.1.104 --disable-arp-ping</pre>
<p class="ai-optimize-19"><span style="color: #000000;">From given below image you can observe it found <strong>1 Host is up</strong>. Since we have disabled Arp request packet for local network scans by using parameter –disable-arp-ping therefore here it will treat it as an external network and behave accordingly that as discussed above.</span></p>
<p class="ai-optimize-20"><span style="color: #000000;"><strong><img decoding="async" src="https://3.bp.blogspot.com/-e4vrhQ4UfOw/WpLNMNXhKiI/AAAAAAAAU1I/GO3T_QIzYHA9xR5zlyosA6BYxCxc3xeSQCEwYBhgL/s1600/1.png"/></strong></span></p>
<p class="ai-optimize-21"><span style="color: #000000;"><strong>Demonstrating working of Ping Sweep using Wireshark</strong></span></p>
<p class="ai-optimize-22"><span style="color: #000000;">From given below image you can observer following packet of request and reply between both network IP</span></p>
<ol>
<li class="ai-optimize-23"><span style="color: #000000;">ICMP echo request</span></li>
<li class="ai-optimize-24"><span style="color: #000000;">TCP SYN to port 443</span></li>
<li class="ai-optimize-25"><span style="color: #000000;">TCP ACK to port 80</span></li>
<li class="ai-optimize-26"><span style="color: #000000;">ICMP timestamp request</span></li>
<li class="ai-optimize-27"><span style="color: #000000;">ICMP echo reply</span></li>
<li class="ai-optimize-28"><span style="color: #000000;">TCP RST, ACK to port 443</span></li>
<li class="ai-optimize-29"><span style="color: #000000;">TCP RST to port 80</span></li>
<li class="ai-optimize-30"><span style="color: #000000;">ICMP Timestamp Reply</span></li>
</ol>
<p class="ai-optimize-31"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-AYSx7g69kBM/WpLNRSlA5kI/AAAAAAAAU1Y/MHSyOo930B0R3qcnAHtSrx0iGAXj_EsnwCEwYBhgL/s1600/2.png"/></span></p>
<h3 class="ai-optimize-32"><span style="color: #800000;">Block Ping Sweep Scan</span></h3>
<p class="ai-optimize-33"><span style="color: #000000;">Now let’s put some firewall rules in IPTABLES to drop ICMP packets, TCP SYN packets on port 443 and TCP ACK on port 80 which will block Ping Sweep scan</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo iptables -I INPUT -p ICMP -j DROP
sudo iptables -I INPUT -p tcp --tcp-flags ALL ACK --dport 80 -j DROP
sudo iptables -I INPUT -p tcp --tcp-flags ALL SYN --dport 443 -j DROP</pre>
<p class="ai-optimize-34"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/--hDTfYkrq5s/WpLNS6RjLSI/AAAAAAAAU1Y/_e64o3-Fnvw_20vs-ssHC0LwdN8zMiKlACEwYBhgL/s1600/3.png"/></span></p>
<p class="ai-optimize-35"><span style="color: #000000;">Now repeat again ping sweep scan for identifying the state of the live host. From given below image you can observe this time it shows that <strong>0 host is up</strong> which means the firewall has blocked packets send by this scan.</span></p>
<p class="ai-optimize-36"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-0MauX5EF47M/WpLNS4vYKHI/AAAAAAAAU1M/vVa5tasIYZk-t81nrN0t91S-cMoMDs64gCEwYBhgL/s1600/4.png"/></span></p>
<p class="ai-optimize-37"><span style="color: #000000;">Again demonstrating request packets of Ping Sweep scan with Wireshark and if you notice given below image then you will found that this time it has not received any reply packet.</span></p>
<p class="ai-optimize-38"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2x_UltfyP30/WpLNTHrLpHI/AAAAAAAAU1U/L_wr8pdqSWsAYJYlIQ0spnHYZSXIiwShQCEwYBhgL/s1600/5.png"/></span></p>
<h3 class="ai-optimize-39"><span style="color: #800000;">Bypass Ping Sweep Filter using TCP SYN Ping</span></h3>
<p class="ai-optimize-40"><span style="color: #000000;">Now, we’ll try to bypass the firewall rules by using ping scan with <strong>TCP SYN packets</strong>. For that we’ll use<strong> –PS attribute</strong>. –PS sends TCP SYN packet on port 80 by default. We can change it by specifying the ports with it, like -PS443.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sP -PS 192.168.1.104 --disable-arp-ping</pre>
<p class="ai-optimize-41"><span style="color: #000000;">From given below image you can observe that observe it found <strong>1 Host is up</strong>.</span></p>
<p class="ai-optimize-42"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0DGXP_nXIAs/WpLNTgBDCaI/AAAAAAAAU1U/9MHBld5-5aURfJrkme2fujtqmS6vlKL2wCEwYBhgL/s1600/6.png"/></span></p>
<p class="ai-optimize-43"><span style="color: #000000;">From given below image you can observe that it is showing the result which similar to NMAP stealth scan. Here it is following TCP Half connection mechanism where SYN packet is sent on port 80 and received SYN, ACK from port 80 and then RST packet for reset connection</span></p>
<p class="ai-optimize-44"><span style="color: #000000;">The difference between –sP packet on port 80 and –PS packet on port 80 is as following:</span></p>
<ul>
<li class="ai-optimize-45"><span style="color: #000000;">Ping sweep scan [-sP] send TCP ACK packet on port 80 and hex value of ACK flag is 10, as the reply from host machine it receives RST packet whose hex value is 4.</span></li>
<li class="ai-optimize-46"><span style="color: #000000;">TCP SYN Ping scan send TCP SYN packet on port 80 and its hex value is 2, as a reply it received SYN, ACK packet whose value is some of their hex value i.e. <strong>2 + 10 = 12</strong> and able to bypass above firewall rule applied on port 80 for TCK ACK packet.</span></li>
</ul>
<p class="ai-optimize-47"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-xUuCn9WUy6w/WpLNTvaWGjI/AAAAAAAAU1I/iE2BmyDAsOQGkHId5dq9uwBNZExLZDGggCEwYBhgL/s1600/7.png"/></span></p>
<h3 class="ai-optimize-48"><span style="color: #800000;">Block TCP SYN Ping Scan</span></h3>
<p class="ai-optimize-49"><span style="color: #000000;">Sometimes network admin applies the filter as given below using Iptables on TCP SYN packet to drop all SYN packet to initiate TCP connection with all TCP Port in their network.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo iptables -I INPUT -p tcp --tcp-flags ALL SYN -j DROP</pre>
<p class="ai-optimize-50"><span style="color: #000000;">As result, it blocks the NMAP TCP SYN Ping probes so that it could not identify the state of the live host.</span></p>
<p class="ai-optimize-51"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-LGrMLmdf-YM/WpLNT9E_2cI/AAAAAAAAU1Q/yCaPHHYtDRoT_QDjoAiMOcdfvhnfwoEtgCEwYBhgL/s1600/8.png"/></span></p>
<p class="ai-optimize-52"><span style="color: #000000;">Now repeat again TCP SYN Ping for identifying the state of the live host. From given below image you can observe this time it shows that <strong>0 host is up</strong> which means the firewall has blocked packets send by this scan.</span></p>
<p class="ai-optimize-53"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-IEl8XFdWJEI/WpLNUdoXqVI/AAAAAAAAU1Y/axv9Cusx2d8FTic4CDb38bB6Ga2Zn85MQCEwYBhgL/s1600/9.png"/></span></p>
<h3 class="ai-optimize-54"><span style="color: #800000;">Bypass TCP SYN Ping using TCP ACK Ping</span></h3>
<p class="ai-optimize-55"><span style="color: #000000;">In order to bypass this, we’ll use ping scan using TCP ACK packets, for that we’ll use <strong>–PA </strong>attribute. –PA sends TCP ACK packet on port 80 by default, we can change it by specifying the ports with it, like -PA443</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sP -PA 192.168.1.104 --disable-arp-ping</pre>
<p class="ai-optimize-56"><span style="color: #000000;">From given below image you can observe that it has found <strong>1 Host is up</strong>.</span></p>
<p class="ai-optimize-57"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-S76izA12M20/WpLNMVDD38I/AAAAAAAAU1U/fIvsBovCaeIPR9YwIp2hz3Sao5spRM8RgCEwYBhgL/s1600/11.png"/></span></p>
<p class="ai-optimize-58"><span style="color: #000000;">When you will notice given below packets captured by Wireshark you will found that here ACK packet is sent on port 80 as reply received RST packet from port 80.</span></p>
<p class="ai-optimize-59"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-B6XwEOUu0pQ/WpLNMONEVVI/AAAAAAAAU1M/rRIoeDWyY0Aa_hEWeOkysnbv5M3JBwb_QCEwYBhgL/s1600/12.png"/></span></p>
<h3 class="ai-optimize-60"><span style="color: #800000;">Block TCP ACK Ping Scan</span></h3>
<p class="ai-optimize-61"><span style="color: #000000;">Sometimes network admin applies the filter as given below using iptables on TCP ACK packet to drop all ACK packet to established TCP connection with all TCP Port in their network.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo iptables -I INPUT -p tcp --tcp-flags ALL ACK -j DROP</pre>
<p class="ai-optimize-62"><span style="color: #000000;">As result, it blocks the NMAP TCP ACK Ping probes so that it could not identify the state of the live host.</span></p>
<p class="ai-optimize-63"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-RYnv0y2sKwU/WpLNNFB8x-I/AAAAAAAAU1Q/8xu785xENTMhpUiCYINEu9X-YMtNLZW0wCEwYBhgL/s1600/13.png"/></span></p>
<p class="ai-optimize-64"><span style="color: #000000;">Now repeat again TCP ACK Ping for identifying the state of the live host. From given below image you can observe this time it shows that <strong>0 host is up</strong> which means the firewall has blocked packets send by this scan.</span></p>
<p class="ai-optimize-65"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/--icA_MpOV-U/WpLNNQUjpMI/AAAAAAAAU1Q/VSbubADOPvYoE4Q3Dw2VYy1yJKTb8-OdQCEwYBhgL/s1600/14.0.png"/></span></p>
<h3 class="ai-optimize-66"><span style="color: #800000;">Bypass TCP ACK Ping using ICMP Echo</span></h3>
<p class="ai-optimize-67"><span style="color: #000000;">In some scenarios network, admin apply firewall filter on TCP flag to resist unwanted TCP communication in the network, here let’s consider that network admin had blocked TCP communication by applying the filter on SYN as well on ACK flag.</span></p>
<p class="ai-optimize-68"><span style="color: #000000;">In order to bypass this rule, we’ll use ping scan with ICMP packets, for that we’ll use <strong>–PE </strong>attribute. –PE sends<strong> ICMP</strong> <strong>echo request</strong> packet [ICMP type 8] and received<strong> ICMP</strong> <strong>echo reply</strong> packet [ICMP type 0].</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sP -PE 192.168.1.104 --disable-arp-ping</pre>
<p class="ai-optimize-69"><span style="color: #000000;">From given below image you can observe that observe it found <strong>1 Host is up</strong>.</span></p>
<p class="ai-optimize-70"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-i3WfbNF_VqY/WpLNNQwsyyI/AAAAAAAAU1Y/gLnx1-uojpIgUEDNQeATMov3n1po-IxmACEwYBhgL/s1600/14.1.png"/></span></p>
<h3 class="ai-optimize-71"><span style="color: #800000;">Block ICMP Echo Ping Scan</span></h3>
<p class="ai-optimize-72"><span style="color: #000000;">Usually, most of the network admin apply ICMP filter on their network so that other system or network cannot able to Ping their network.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo iptables -A INPUT -p icmp --icmp-type echo-request -j DROP</pre>
<p class="ai-optimize-73"><span style="color: #000000;">As result, it blocks the NMAP ICMP echo Ping probes so that it could not identify the state of the live host.</span></p>
<p class="ai-optimize-74"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ABiOi1xV2bA/WpLNNxiGbgI/AAAAAAAAU1Q/RDxaJo_sywo3lDKb4U8bJ6e7G9CuHef-wCEwYBhgL/s1600/14.2.png"/></span></p>
<p class="ai-optimize-75"><span style="color: #000000;">Now repeat again TCP ICMP Ping for identifying the state of the live host. From given below image you can observe this time it shows that <strong>0 host is up</strong> which means the firewall has blocked packets send by this scan.</span></p>
<p class="ai-optimize-76"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-xrDTEI4aQD8/WpLNOIpkCEI/AAAAAAAAU1M/2YsOBJAfjVITov2E3wzpTky3drL-Cde_QCEwYBhgL/s1600/14.3.png"/></span></p>
<p class="ai-optimize-77"><span style="color: #000000;">Demonstrating NMAP ICMP echo Ping with Wireshark shows only ICMP request packet in the network and didn’t receive any reply packet from the host network as shown in the given below image.</span></p>
<p class="ai-optimize-78"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-M2CJiiJS5GU/WpLNOLTKC0I/AAAAAAAAU1I/im096QX51zwMHLsOSJsLsU9TwTcroTKnACEwYBhgL/s1600/14.4.png"/></span></p>
<h3 class="ai-optimize-79"><span style="color: #800000;">Bypass ICMP Echo Ping using ICMP Timestamp Ping</span></h3>
<p class="ai-optimize-80"><span style="color: #000000;">In order to bypass this rule, we’ll use ping scan with ICMP packets, for that we’ll use <strong>–PP </strong>attribute. –PP sends<strong> ICMP</strong> <strong>timestamp request</strong> packet [ICMP type 13] and received<strong> ICMP</strong> <strong>timestamp reply</strong> packet [ICMP type 14].</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sP -PP 192.168.1.104 --disable-arp-ping</pre>
<p class="ai-optimize-81"><span style="color: #000000;">From given below image you can observe that observe it found <strong>1 Host is up</strong>.</span></p>
<p class="ai-optimize-82"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-46xbGmgitWk/WpLNOrK1JcI/AAAAAAAAU1Q/lUEJ4M2cVtAlJ45gS6LhXxYe7hiZSQaVACEwYBhgL/s1600/14.5.png"/></span></p>
<p class="ai-optimize-83"><span style="color: #000000;">Demonstrating NMAP ICMP timestamp Ping with Wireshark shows ICMP <strong>timestamp request</strong> packet send in the network and received any <strong>timestamp reply</strong> packet from host network as shown in given below image.</span></p>
<p class="ai-optimize-84"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-d73FXUgOK6M/WpLNO-TFGMI/AAAAAAAAU1U/RMfjnNQakaMY1dlHZ5vRp5zupPyKfradwCEwYBhgL/s1600/14.6.png"/></span></p>
<h3 class="ai-optimize-85"><span style="color: #800000;">Block ICMP Ping Scan</span></h3>
<p class="ai-optimize-86"><span style="color: #000000;">It might be possible that network admin had block entire types ICMP message by dropping all ICMP packets using following iptables filter.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo iptables -I INPUT -p ICMP -j DROP</pre>
<p class="ai-optimize-87"><span style="color: #000000;">As result, it blocks the NMAP ICMP Ping probes so that it could not identify the state of the live host.</span></p>
<p class="ai-optimize-88"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-JpGtFsibADQ/WpLNPAMSlNI/AAAAAAAAU1U/lf6F-uXOjBkHiffEmhDzrrRq1csCEQfAQCEwYBhgL/s1600/14.7.png"/></span></p>
<p class="ai-optimize-89"><span style="color: #000000;">Now repeat again ICMP Ping either –PP or PE for identifying the state of the live host. From given below image you can observe this time it shows that <strong>0 host is up</strong> which means the firewall has blocked packets send by this scan.</span></p>
<p class="ai-optimize-90"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-96wzgefnv4I/WpLNPQocCPI/AAAAAAAAU1U/2BjziqhR8NgAGnqeh3pLpsJ0fEm8KL0-QCEwYBhgL/s1600/15.1.png"/></span></p>
<h3 class="ai-optimize-91"><span style="color: #800000;">Bypass ICMP Ping Scan using UDP Ping</span></h3>
<p class="ai-optimize-92"><span style="color: #000000;">We have seen multiple ways to check if the system is live. Now, you can determine whether a system is up or not whether it is on the local network or public network.</span></p>
<p class="ai-optimize-93"><span style="color: #000000;">We had observed that ping scan with ICMP ping is not working or even if TCP packet filter is also enabled in host network then it becomes difficult to identify the live host, now to bypass such types of rules we’ll use ping scan with <strong>UDP packets</strong>, for that we’ll use <strong>–PU </strong>attribute.</span></p>
<p class="ai-optimize-94"><span style="color: #000000;"> –PU sends UDP packet when no ports are specified, the default is 40125, a reply received ICMP message such as “ICMP destination unreachable” which means the host is live.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sP -PU 192.168.1.104 --disable-arp-ping</pre>
<p class="ai-optimize-95"><span style="color: #000000;">From given below image you can observe that observe it found <strong>1 Host is up</strong>.</span></p>
<p class="ai-optimize-96"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-rfeuC0soKb4/WpLNPiaTC2I/AAAAAAAAU1I/lfUR5YAiuJcn2TQ-k5slcS2K4drd2hFvACEwYBhgL/s1600/15.2.png"/></span></p>
<p class="ai-optimize-97"><span style="color: #000000;">Demonstrating NMAP UDP Ping with Wireshark shows UDP <strong>request packet</strong> sent on<strong> 40125</strong> in the network and received<strong> ICMP destination unreachable</strong> as reply packet from host network as shown in given below image.</span></p>
<p class="ai-optimize-98"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-dJ_u34zz6w0/WpLNP653M7I/AAAAAAAAU1Y/pJNBOOYMMeMdHk6wKIqCNE0WurES9UvkQCEwYBhgL/s1600/15.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Block UDP and Ping Sweep</pre>
<p class="ai-optimize-100"><span style="color: #000000;">Now let’s put some firewall rules in IPTABLES to drop ICMP packets, TCP SYN packets on port 443 and TCP ACK on port 80 which will block Ping Sweep scan as well as Drop UDP packet. Might be network admin had blocked entire TCP packet.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo iptables -I INPUT -p ICMP -j DROP
sudo iptables -I INPUT -p tcp --tcp-flags ALL ACK --dport 80 -j DROP
sudo iptables -I INPUT -p tcp --tcp-flags ALL SYN --dport 443 -j DROP
sudo iptables -I INPUT -p UDP -j DROP</pre>
<p class="ai-optimize-101"><span style="color: #000000;">As result, it will resist NMAP for making TCP Ping, ICMP Ping, and UDP ping so that it could not identify the state of the live host.</span></p>
<p class="ai-optimize-102"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cOfdq0Ln6w4/WpLNQXhAo9I/AAAAAAAAU1I/jksAE8hnh6MFNdnhTtemTCvybWlAVDotQCEwYBhgL/s1600/16.png"/></span></p>
<p class="ai-optimize-103"><span style="color: #000000;">Now repeat again UDP Ping for identifying the state of the live host. From given below image you can observe this time it shows that <strong>0 host is up</strong> which means the firewall has blocked packets send by this scan.</span></p>
<p class="ai-optimize-104"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-GWesPxwPBcA/WpLNQm9dAdI/AAAAAAAAU1M/e4op11Ujy3UJFBqWbVtKemnu9vI8CR7KwCEwYBhgL/s1600/17.png"/></span></p>
<h3 class="ai-optimize-105"><span style="color: #800000;">Bypass UDP and Ping Sweep using Protocol Scan</span></h3>
<p class="ai-optimize-106"><span style="color: #000000;">Using Protocol Ping scan we can identify live host when ICMP, TCP, and UDP has been blocked, for that we’ll use <strong>–PO attribute</strong>. –PO sends IP packet with the particular protocol number place in their IP header, If no protocols are precise, the default is to send multiple IP packets for ICMP (protocol 1), IGMP (protocol 2), and IP-in-IP (protocol 4).</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sP -PO 192.168.1.104 --disable-arp-ping</pre>
<p class="ai-optimize-107"><span style="color: #000000;">From given below image you can observe that observe it found <strong>1 Host is up</strong>.</span></p>
<p class="ai-optimize-108"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NMeVUSGPehA/WpLNRM8V6fI/AAAAAAAAU1M/jMrd60PBMicBjh5vtYB3wZX1MTPW_rNqgCEwYBhgL/s1600/19.png"/></span></p>
<p class="ai-optimize-109"><span style="color: #000000;">From given below image of Wireshark we can observe the following mechanism followed by Protocol ping scan.</span></p>
<ul>
<li class="ai-optimize-110"><span style="color: #000000;">Send ICMP Echo to host network</span></li>
<li class="ai-optimize-111"><span style="color: #000000;">Send IGMP query to host network</span></li>
<li class="ai-optimize-112"><span style="color: #000000;">Send IPv4 (IP-in-IP) to host network</span></li>
<li class="ai-optimize-113"><span style="color: #000000;">Received ICMP Destination unreachable as the reply from Host</span></li>
</ul>
<p class="ai-optimize-114"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-AqlE8pAKzjw/WpLNRlBGMwI/AAAAAAAAU1M/I27KFW8z44UPR_S5xnTukDIlNZSpzIAIgCEwYBhgL/s1600/20.png"/></span></p>
<h3 class="ai-optimize-115"><span style="color: #800000;"><strong>Block IP Protocol Ping Scan</strong></span></h3>
<p class="ai-optimize-116"><span style="color: #000000;">Now let’s put some firewall rules in iptables to drop ICMP packets, TCP SYN packets on port 443 and TCP ACK on port 80 which will block Ping Sweep scan as well as Drop UDP packet and IP protocol too in the network to prevent the network from any kind of Ping scan. Might be network admin had blocked entire TCP packet.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo iptables -I INPUT -p ICMP -j DROP
sudo iptables -I INPUT -p tcp --tcp-flags ALL ACK --dport 80 -j DROP
sudo iptables -I INPUT -p tcp --tcp-flags ALL SYN --dport 443 -j DROP
sudo iptables -I INPUT -p UDP -j DROP
sudo iptables -I INPUT -p IP -j DROP</pre>
<p class="ai-optimize-117"><span style="color: #000000;">As result, it will resist NMAP for making TCP Ping, ICMP Ping, UDP ping and Protocol ping so that it could not identify the state of the live host.</span></p>
<p class="ai-optimize-118"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-wRjGMGe0SLA/WpLNR0eD6JI/AAAAAAAAU1Q/OeVAricj_CoFl0Cq6HihCLDWzHZ0tWuXgCEwYBhgL/s1600/21.png"/></span></p>
<p class="ai-optimize-119"><span style="color: #000000;">Now repeat again Protocol Ping for identifying the state of the live host. From given below image you can observe this time it shows that <strong>0 host is up</strong> which means the firewall has blocked packets send by this scan.</span></p>
<p class="ai-optimize-120"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-lQO22NUMwFw/WpLNSGeFHaI/AAAAAAAAU1Y/dS9Gv7F7jasTA4ghkUPSEps3_ma7Zec6gCEwYBhgL/s1600/22.png"/></span></p>
<h3 class="ai-optimize-121"><span style="color: #800000;">Bypass IP protocol Ping using No Ping Scan</span></h3>
<p class="ai-optimize-122"><span style="color: #000000;">Now when the Ping scan fails to identify whether the Host is up or down, we choose the last and best option “No Ping” as we use –PN/-P0/-Pn and perform a TCP port scan for the top 1000 ports.</span></p>
<p class="ai-optimize-123"><span style="color: #000000;"> If you want to prevent Port scan and ping scan use sweep ping with no ping as given below to identify the state of the host is up or down.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sP -PN 192.168.1.104 --disable-arp-ping</pre>
<p class="ai-optimize-124"><span style="color: #000000;">From given below image you can observe that observe it found <strong>1 Host is up</strong>.</span></p>
<p class="ai-optimize-125"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-BE7ZqLe9DeA/WpLNSQ5O45I/AAAAAAAAU1U/2SH6M-DmYlckwPUsr9Av3p7ybbSfy7-EgCEwYBhgL/s1600/23.png"/></span></p>
<p class="ai-optimize-42"><span style="color: #000000;">To learn more on Nmap. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/nmap/">Link.</a></strong></p>
<p class="ai-optimize-126"><span style="color: #000000;"><strong>Author</strong>:  Deepanshu is a Certified Ethical Hacker and a budding Security researcher. Contact <strong><a href="https://www.linkedin.com/in/deepanshu-k-a4248b138/">here</a>.</strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
