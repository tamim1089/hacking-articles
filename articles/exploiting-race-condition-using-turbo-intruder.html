<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/website-hacking/burp-suite/" rel="category tag">Burp Suite</a>, <a href="https://www.hackingarticles.in/category/website-hacking/" rel="category tag">Website Hacking</a></span>            </div>
            <h1 class="post-title entry-title">Exploiting Race Condition using Turbo Intruder</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/exploiting-race-condition-using-turbo-intruder/" rel="bookmark"><time class="entry-date published" datetime="2024-05-09T11:10:21+00:00">May 9, 2024</time><time class="updated" datetime="2025-06-19T13:23:21+00:00">June 19, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000"><strong data-start="505" data-end="555">Exploiting Race Condition using Turbo Intruder</strong> is a critical technique in web application security. A race condition occurs when multiple threads or processes access shared resources concurrently, leading to unpredictable outcomes. In this blog, we demonstrate how to exploit this vulnerability using the Turbo Intruder extension in Burp Suite.</span></p>
<h3><span style="color: #800000">Table of Contents</span></h3>
<ul>
<li><span style="color: #000000">Key features</span></li>
<li><span style="color: #000000">Testing on a vulnerable application</span></li>
<li><span style="color: #000000">Application’s intended behaviour</span></li>
<li><span style="color: #000000">Application’s unintended behaviour</span></li>
<li><span style="color: #000000">About the vulnerability</span></li>
<li><span style="color: #000000">Conclusion</span></li>
</ul>
<h3><span style="color: #800000">Key features</span></h3>
<p><span style="color: #000000">Following are the key features of the Race Condition:</span></p>
<ul>
<li><span style="color: #000000"><strong>Concurrent Access: </strong>Race conditions occur when multiple processes or threads access shared resources simultaneously in a web application. These shared resources could include database records, files, or variables stored in memory, among other crucial components.</span></li>
<li><span style="color: #000000"><strong>Unpredictable Behaviour</strong>: Because of the asynchronous and parallel nature of web applications, the timing and sequence of concurrent operations can differ. As a result, unpredictable behavior can occur, where factors such as request timing, system load, or network latency affect the outcome of an operation.</span></li>
</ul>
<h3><span style="color: #800000">Testing on a vulnerable application</span></h3>
<p><span style="color: #000000">To demonstrate the Race Condition, we will be using a vulnerable application and try to perform the intended application logic without any concurrent requests and then will try to perform the unintended action using multiple concurrent requests. The vulnerable application can be downloaded from here: <a style="color: #000000" href="https://github.com/projectdiscovery/php-app-race-condition">https://github.com/projectdiscovery/php-app-race-condition</a></span></p>
<h3><span style="color: #800000">Application’s intended behaviour </span></h3>
<p><span style="color: #000000">The application’s intended logic is that the user can withdraw money from the account and the balance amount will be shown to the user. Initially the total amount is $10,000.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgAuB5ntJo3JfUvB7egH5BA58kjzT4gy6v2SMf2XYadSF-Vhnn17IMoxehKvcWiOtmQc5T5YG39GFz1io79jh52mh6qFnRcnruevRvD5-yBjWHbbLpFKQqS2IKWWabT4xO3DHmFT47wowCuK5gPpu_2Br7oThp1ZSzq7l_GLa5ylhgvTZYYGxFnXKDaoXRm/s16000/1.png"/></p>
<p><span style="color: #000000">As per the application logic if a user withdraws $10, 80 times the leftover amount in the account should be <strong>$10,000 – ($10*80) = $9200</strong>.</span></p>
<p><span style="color: #000000">This process can also be seen through the outcome of <strong>Burp Intruder</strong> by setting the concurrent requests to 1 and withdrawing the amount 80 times.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiw53UrPooNY5feXMbgx-rlb4r1QwKYgwJZszStxIBerkzv-oWFSqkM6DwAftliNynbnQt3mrXNbAreTNTK25eiAtA2az4tUgsaAhs9M3NbyOiqT-snkX0NrMX2X-II1z8YktHw3Kwvl6ITYJiMRbnxHKhKmiIfc5VSbG2nbHyxxVzcsPiAKoSQi3Y6ytP4/s16000/2.png"/></p>
<h3><span style="color: #800000">Application’s unintended behaviour</span></h3>
<p><span style="color: #000000">The application’s <strong data-start="257" data-end="281">unintended behaviour</strong> becomes evident after users send multiple <strong data-start="324" data-end="347">concurrent requests</strong> using the <strong data-start="358" data-end="386">Turbo Intruder extension</strong>. You can download the Turbo Intruder extension inside <strong data-start="441" data-end="455">Burp Suite</strong> from the <strong data-start="465" data-end="479">Bapp Store</strong>.</span></p>
<p><span style="color: #000000">Once you install the extension, you can forward the <strong data-start="534" data-end="552">target request</strong> to the <strong data-start="560" data-end="578">Turbo Intruder</strong> extension.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhGwzmZIZ_U72QCmMc_ygUQAKXZvhZFwQWxPB2WeV3jjRw72EeRJbl2gIgDbF7wgCQHnpcTiFme8uCilPJZdmB76zGG9UQY21fZBBpa3VVsqTc7lMGdBr5rd6PBz65PrtUpZl_ALVAoJApd4qSTF9hLnDjyzjanYN9wOPWdtXr8Cq6cVEufZXIRCUkF3i26/s16000/3.png"/></p>
<p><span style="color: #000000">Inside Turbo Intruder, we use the <code data-start="624" data-end="654">race-single-packet-attack.py</code> default script; however, we modify the configuration according to our needs. We perform the same action of <strong data-start="762" data-end="781">withdrawing $10</strong> eighty times, but this time we set the <strong data-start="821" data-end="844">concurrent requests</strong> to 15 and configure the engine as <code data-start="879" data-end="892">Engine.BURP</code>.</span></p>
<p><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi0-LXl8OvLMqduyvAHh0V5ekJVAktpfPdXI0Hw9s_OVaTFCWymvebTpS8eC9z0QNrd9ouzqajQDk0Y9sC-37O0iXobniWr1V3YEgofiNWrmECTfCeT28uuGWZHqEBG2CpunKiiShHE6Y8mp5hsPgXAaLYLu0X04nnqbijT6s_RzYTUYIFqxfWHRJDtPTmi/s16000/4.png"/></p>
<p><span style="color: #000000">After configuration is complete, click on Attack to start the attack. Observe that after 80 requests the amount which is left in the account is <strong>$9600</strong> which is more than the desired amount.</span></p>
<h3><span style="color: #800000">About the vulnerability</span></h3>
<p><span style="color: #000000">At first glance, it might seem unexpected that a web application developed in <strong data-start="973" data-end="980">PHP</strong>, a language without native <strong data-start="1008" data-end="1035">multi-threading support</strong>, could be vulnerable to <strong data-start="1060" data-end="1086">race condition attacks</strong>. Nevertheless, these attacks can indeed occur. This <strong data-start="1139" data-end="1150">exploit</strong> becomes feasible because web servers like <strong data-start="1193" data-end="1203">Apache</strong> handle queries <strong data-start="1219" data-end="1237">asynchronously</strong>. In such cases, if two requests arrive almost simultaneously, the server may execute them <strong data-start="1328" data-end="1344">concurrently</strong> on a multi-core CPU or interleave them using the operating system’s <strong data-start="1413" data-end="1433">CPU time-sharing</strong> mechanism. Consequently, instead of the expected <strong data-start="1483" data-end="1500">$9980 balance</strong> after processing both requests, the balance changes to <strong data-start="1556" data-end="1565">$9990</strong>. This <strong data-start="1572" data-end="1587">discrepancy</strong> arises because the server processes the second request while the first one is still underway. Although both <strong data-start="1696" data-end="1711">withdrawals</strong> function correctly and result in a total deduction of <strong data-start="1766" data-end="1773">$20</strong>, the system subtracts only <strong data-start="1801" data-end="1808">$10</strong> from the balance.</span></p>
<p><span style="color: #000000"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEji9NaYE70-V1qRdNdOSxLAavWVqULvx7PLgEqiwuK3GspBGzu3HijBpudOvZ6g8VVpYvCTrbIL2cMuGQ33jxxcvLVcS-zcAEz6hVD3Gn0UOYn5JIOulkE8gsSGPhfGWpi9AI0TYP6bhWVkRRXP2mYLDfIEc5onT0nSSHSQ-v12xXcctdlB1uijqrrh8K2L/s16000/5.png"/></strong></span></p>
<h3><span style="color: #800000">Conclusion</span></h3>
<p><span style="color: #000000">In conclusion, race conditions pose a significant risk to the security and reliability of web applications. Hence, comprehensive testing and robust coding practices are imperative for effectively mitigating these vulnerabilities. The Burp Intruder shows the above scenario while keeping the concurrent requests as 1, since the application is of small size and lesser functionalities. In real life testing, <strong data-start="601" data-end="651">Exploiting Race Condition using Turbo Intruder</strong> can prove to be a very valuable approach, as the extension provides flexibility in configuring and launching race condition attacks effectively.</span></p>
<p><strong><span style="color: #000000">Author</span>: </strong><span style="color: #000000">Vinayak Chauhan is an InfoSec researcher and Security Consultant. Contact</span> <strong><a href="https://www.linkedin.com/in/vinayak--chauhan/">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
