<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/others/" rel="category tag">Others</a>, <a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Comprehensive Guide on Sniffing</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/comprehensive-guide-on-sniffing/" rel="bookmark"><time class="entry-date published" datetime="2017-10-26T16:22:07+00:00">October 26, 2017</time><time class="updated" datetime="2025-06-06T08:40:05+00:00">June 6, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-7 ai-optimize-introduction"><span style="color: #000000;">The Address Resolution Protocol (ARP) is a communication protocol. It is used for discovering the link layer address associated with a given Internet layer address, a critical function in the Internet protocol suite. ARP was defined by RFC 826 in 1982 and is Internet Standard STD 37. It is also the name of the program for manipulating these addresses in most operating systems.</span></p>
<p class="ai-optimize-8"><span style="color: #000000;">ARP is used for mapping a network address (e.g. an IPv4 address) to a physical address like a MAC address. For more details visit <a href="https://en.wikipedia.org/wiki/Address_Resolution_Protocol">here</a>. </span></p>
<h3 class="ai-optimize-9"><span style="color: #800000;">Requirement</span></h3>
<ol>
<li class="ai-optimize-10"><span style="color: #000000;">Kali Linux Machine</span></li>
<li class="ai-optimize-11"><span style="color: #000000;">Windows Machine</span></li>
<li class="ai-optimize-12"><span style="color: #000000;">Local Area Network</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">EtterCap tool</span></li>
<li class="ai-optimize-14"><span style="color: #000000;">VM running Metasploitable</span></li>
<li class="ai-optimize-15"><span style="color: #000000;">Wireshark (Protocol Analyzer)</span></li>
<li class="ai-optimize-16"><span style="color: #000000;">XArp tool</span></li>
<li class="ai-optimize-17"><span style="color: #000000;">FTP Client</span></li>
<li class="ai-optimize-18"><span style="color: #000000;">Putty Client</span></li>
</ol>
<h3 class="ai-optimize-19"><span style="color: #800000;">ARP Protocol Process</span></h3>
<p class="ai-optimize-20"><span style="color: #000000;">Address Resolution Protocol is in many ways similar to a domain name service (DNS). As DNS resolves known domain names to an unknown IP address, similarly an ARP resolves known IP addresses to unknown MAC addresses. As shown below in the given image</span></p>
<p class="ai-optimize-21"><span style="color: #000000;">If we observe by the above image; IP address 192.168.1.102, wants to communicate to IP address 192.168.101, but does not know its physical (MAC) address. An <strong>ARP request is broadcasted</strong> to all systems within that network, including IP X.X.X.100, X.X.X.101, and X.X.X.103. When IP address X.X.X.101 receives the message, it replies back via <strong>uni-cast </strong>with an<strong> ARP reply</strong>. This response contains the physical (MAC) address of BB-BB-BB-BB-BB-BB as shown above, this ARP reply information is then placed in the ARP cache and held there for a short duration, to reduce the amount of ARP traffic on the network, The ARP cache stores the IP, MAC, and a timer for each entry. The timer’s duration may vary depending upon the Operating system in use, i.e., Windows operating system may store the ARP cache information for 2 minutes compared to a Linux machine which may retain it for 15 minutes or so.</span></p>
<p class="ai-optimize-22"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oebdJfiQNdY/WfH6ycdr21I/AAAAAAAASLk/UPv48yrjkIw-7Yie1M4BgbO90dz02wreQCEwYBhgL/s1600/0.1.png"/></span></p>
<p class="ai-optimize-23"><span style="color: #000000;">Let us now begin with exploiting the ARP protocol to our advantage!!!</span></p>
<p class="ai-optimize-24"><span style="color: #000000;"><strong>Scenario:</strong> Let us take the below scenario, where we will use 2 windows host machines Representing Host A and Host B as Victim and Kali Linux Host C used to target the victims. In the following image, you can see attacker has lunch arp poisoning attack which has poisoned the arp table by adding attacker Mac address with both Host’s IP: A &amp; B.</span></p>
<p class="ai-optimize-25"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1-bLuO3MJrM/WfH6ycn8gtI/AAAAAAAASLk/ZEFkq_jDBLU5hU2vq9KE8YP4UEUmGekUgCEwYBhgL/s1600/0.2.png"/></span></p>
<h3 class="ai-optimize-26"><span style="color: #800000;">Let’s Begin the ARP Poisoning Attack</span></h3>
<p class="ai-optimize-27"><span style="color: #000000;">The First step is to clear the ARP Cache of both the host by typing following command in command prompt <strong>arp -d</strong> for Host A. Then Ping the Host A for the reply. Now type command arp -a, this will show you the physical (MAC) address of the Host A Machine.</span></p>
<p class="ai-optimize-28"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-XmPXQa7PaXY/WfH6xipleDI/AAAAAAAASLk/JtwnDlstYuAWuXkx3FAsBAP-EznOryWhwCEwYBhgL/s1600/1.png"/></span></p>
<p class="ai-optimize-29"><span style="color: #000000;">Similarly, let us do the same activity on the other systems which is Host B</span></p>
<p class="ai-optimize-30"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6MoQCFBpl5w/WfH62QdN9cI/AAAAAAAASLk/9-Soj4vQracQBodNVf-20M8xXOTdsn9EQCEwYBhgL/s1600/2.png"/></span></p>
<h3 class="ai-optimize-31"><span style="color: #800000;">Start Sniffing with Ettercap</span></h3>
<p class="ai-optimize-32"><span style="color: #000000;">Let us now start to exploit both Host A and Host B, from Host C machine, which is our Kali Linux, start sniffing with Ettercap tool as shown in the below image on Kali.</span></p>
<p class="ai-optimize-33"><span style="color: #000000;">Go to Sniff and select Unified sniffing</span></p>
<p class="ai-optimize-34"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-zVMYAwo5Yw8/WfH65eLiR-I/AAAAAAAASLk/3J6AjEEsMFEdnYwCx35qVKEptXmneAS-QCEwYBhgL/s1600/3.png"/></span></p>
<p class="ai-optimize-35"><span style="color: #000000;">Select the Network interface as appropriate, in this case, it is eth0, click on <strong>OK</strong></span></p>
<p class="ai-optimize-36"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-oPr0GTwa4z8/WfH68pAKIkI/AAAAAAAASLk/ggdittFybhk-nKyOODOczxOLmxPV3jjKQCEwYBhgL/s1600/4.png"/></span></p>
<p class="ai-optimize-37"><span style="color: #000000;">Now go to the Hosts Tab and Select <strong>Scan for Hosts</strong> as shown below to scan the connected system in a local network.</span></p>
<p class="ai-optimize-38"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-eLDg6B7tRHs/WfH69tdQwlI/AAAAAAAASLk/LevaOqqF9toLWbT5Nkb88cVyIyatA2Y-QCEwYBhgL/s1600/5.png"/></span></p>
<p class="ai-optimize-39"><span style="color: #000000;">You will get the host list of all the scan hosts as shown below. Let us now select our Targets from the host list X.X.X.101 and X.X.X.102. Now add both the targets one by one by clicking on the tab Add to Target 1 and 2 respectively. From the given image we can see that both the targets are now added to our list.</span></p>
<p class="ai-optimize-40"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-dnONjTEPEgo/WfH69s_MwrI/AAAAAAAASLk/yQSbimI0v3Q1sYZt4WgUiWbzrSXLqoPKgCEwYBhgL/s1600/6.png"/></span></p>
<p class="ai-optimize-41"><span style="color: #000000;">Now go to MitM (Man in the middle) and select ARP Poisoning. A Dialog box will appear for optional parameters.</span></p>
<p class="ai-optimize-42"><span style="color: #000000;">Check the box “Sniff remote connection” and click OK</span></p>
<p class="ai-optimize-43"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-2a5QmAzJiL8/WfH6-N8RWJI/AAAAAAAASLk/AnEaRaXt2DwhWLQFes5uFgDMnADPmL5FgCEwYBhgL/s1600/7.png"/></span></p>
<p class="ai-optimize-44"><span style="color: #000000;">Go to start tab and click on start sniffing to target the Host A and B added.</span></p>
<p class="ai-optimize-45"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-PsOuRcBYc9A/WfH6-XUe1BI/AAAAAAAASLk/XIfFfgwWCA4Vi6cUXz2in2uBZYzR96FXQCEwYBhgL/s1600/8.png"/></span></p>
<p class="ai-optimize-46"><span style="color: #000000;">Then, let’s go to our Kali machine and open the terminal. Let us now type command <strong>ifconfig</strong> to determine our IP address and physical (MAC) address. In our case it is <strong>00:0c:29:5b:8e:18</strong> as highlighted in the given image</span></p>
<p class="ai-optimize-47"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-I_m5N1Icd1Q/WfH6_3UbisI/AAAAAAAASLk/chSHqMNnoGE0YS88CtvHQ3O8xTzL_TcdACEwYBhgL/s1600/9.png"/></span></p>
<p class="ai-optimize-48"><span style="color: #000000;">Since we have started the arp poisoning attack on both the victim machine X.X.X.101 and 102 from our Kali machine, if we go to any host and type arp -a on the command prompt, you will clearly see that the physical (MAC) address of the victim machine has changed to the physical (MAC) address of the Kali machine, as shown above, Physical (MAC) address of both the IP X.X.X.102 and X.X.X.107 are same, which means that all the traffic from host X.X.X.102 is passing through Kali machine X.X.X.107</span></p>
<p class="ai-optimize-49"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--yFuCruHqS4/WfH6yh6kinI/AAAAAAAASLk/Y82qC5yb2os8RYK_jgwVVKGYXSBjr34dQCEwYBhgL/s1600/10.png"/></span></p>
<h3 class="ai-optimize-50"><span style="color: #800000;">Demonstrate MITM with Wireshark </span></h3>
<p class="ai-optimize-51"><span style="color: #000000;">Let us now Open Wireshark on our Kali machine and analyze the packets. Let us filter the packets by typing the following command <strong>ICMP &amp;&amp; (eth.sec = = 00:0c:29:5b:8e:18 || eth.dst == 00:0c:29:5b:8e:18</strong>). Here in the command eth.sec means (Ethernet source) and eth.dst means (Ethernet destination). The MAC address are common in both source and destination which is the physical MAC address of our Kali machine. What we see is the source IP X.X.X.102 and destination X.X.X.101 are getting captured by the Kali machine which has a Physical (MAC) address <strong>00:0c:29:5b:8e:18. </strong>Hence proving  successful sniffing of the victim machine.</span></p>
<p class="ai-optimize-52"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-pQHdYREmptE/WfH6z0I3M2I/AAAAAAAASLk/C8k3N93CBtE5l7n2CiH6CdVUJ1N9XjmQgCEwYBhgL/s1600/11.png"/></span></p>
<h3 class="ai-optimize-53"><span style="color: #800000;">Combining DNS Spoofing with sniffing</span></h3>
<p class="ai-optimize-54"><span style="color: #000000;">Let us now exploit both of our victim machines with DNS Spoofing attack</span></p>
<p class="ai-optimize-55"><span style="color: #000000;">From your Kali machine go to the path<strong>: /root/etc/ettercap/etter.dns</strong>. Open the file and remove any content if available. Then type the value <strong>* A (your Kali Linux IP address)</strong> as shown below and save the file.</span></p>
<p class="ai-optimize-56"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gViX8BKTDvs/WfH6zkbIANI/AAAAAAAASLk/6Kh9obgrwnImopfrx1Ukh95Ji-hEOFtYACEwYBhgL/s1600/12.png"/></span></p>
<p class="ai-optimize-57"><span style="color: #000000;">Next step is to go to the ettercap tool and select plugins and click on manage the plugins as shown below:</span></p>
<p class="ai-optimize-58"><span style="color: #000000;">Then, select dns_spoof plug-in, once selected you will see (*) sign on the said plug-in.</span></p>
<p class="ai-optimize-59"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-m9H4EPZ24rQ/WfH6zx2FcRI/AAAAAAAASLk/zTmZG2MrMEs_guxO20NHZG7XDqngGQRdwCEwYBhgL/s1600/13.png"/></span></p>
<p class="ai-optimize-60"><span style="color: #000000;">Now if from the victim machine we type the command <strong>ping www.google.com</strong>. You will observe that the reply is getting received from IP X.X.X.107 which is the IP for our Kali machine. This means that the Kali machine has become the DNS server for the victim machine.</span></p>
<p class="ai-optimize-61"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Yw_BD6c6JsE/WfH60kDKypI/AAAAAAAASLk/g7eSu1YUOsYUcy-VR3GqefcKwnBmYFU4gCEwYBhgL/s1600/15.png"/></span></p>
<p class="ai-optimize-62"><span style="color: #000000;">Let us now add one more plug-in the same way we added dns_spoofing plug-in, this time we will use remote browser plug-in as shown in the image below. Once this plug-in gets added, you can capture all the browser activity performed by the victim on his browser including <strong>user name</strong> and <strong>passwords.</strong></span></p>
<p class="ai-optimize-63"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-LQqJMut18MY/WfH609f4KdI/AAAAAAAASLk/jLXLm2S8sCIA-90LAbfs2LtV10WmcFJoACEwYBhgL/s1600/16.png"/></span></p>
<h3 class="ai-optimize-64"><span style="color: #800000;">Capturing NTLM passwords </span></h3>
<p class="ai-optimize-65"><span style="color: #000000;">Open Kali terminal and type msfconsole, once the console starts to type: search http_ntlm, now type: use auxiliary/server/capture/http_ntlm as shown in the below image:</span></p>
<p class="ai-optimize-66"><span style="color: #000000;">This module attempts to quietly catch NTLM/LM Challenge hashes.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use auxiliary/server/capture/http_ntlm
msf auxiliary(http_ntlm) &gt; set srvhost 192.168.0.107
msf auxiliary(http_ntlm) &gt; set srvport 80
msf auxiliary(http_ntlm) &gt; set uripath /
msf auxiliary(http_ntlm) &gt; set johnpwfile /root/Desktop/
msf auxiliary(http_ntlm) &gt; exploit</pre>
<p class="ai-optimize-67"><span style="color: #000000;">Now according to the above trap set for the victim, this module will capture NTLM password of victim’s system. When he will open any http web site on his browser which will redirect that web site on attacker’s IP.</span></p>
<p class="ai-optimize-68"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EmciymoLi4c/WfH61AML0iI/AAAAAAAASLk/wJpsX_AvvmAl5ViipetxVrJIuMEz2ZPCgCEwYBhgL/s1600/17.png"/></span></p>
<p class="ai-optimize-69"><span style="color: #000000;">From given below image you can notice victim is trying to browse “IMDb.com” on his web browser but it requires authentication which is requesting for his username and password. Then if he tries to open something else, let says google.com. There also it will ask username and password for authentication. Until the victim will not submit his username and password he cannot browse anything on his web browser.</span></p>
<p class="ai-optimize-70"><span style="color: #000000;">As the victim enter username and password, the attacker at background will capture NTLM hash on his system.</span></p>
<p class="ai-optimize-71"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-xDBmLcYhSrQ/WfH61ngaq0I/AAAAAAAASLk/qHTKYiLqdvYwy9DGh5JyNcpOJcSKnqe2wCEwYBhgL/s1600/18.png"/></span></p>
<p class="ai-optimize-72"><span style="color: #000000;"><strong>Great!!</strong> The attacker had captured NTMLv2 hash; now let count detail apart from the hash value that the attacker has captured.</span></p>
<p class="ai-optimize-73"><span style="color: #000000;">From the given image you can see that the attacker has captured two things more:</span></p>
<ul>
<li class="ai-optimize-74"><span style="color: #000000;"><strong>Username:</strong> raj</span></li>
<li class="ai-optimize-75"><span style="color: #000000;"><strong>Machine name:</strong> WIN-1GKSSJ7D2AE</span></li>
</ul>
<p class="ai-optimize-76"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-YfEBcMO4wgg/WfH62CuKNdI/AAAAAAAASLk/zzFbBC5lIEMgx6LOghpgt9J6vDFo2QGxQCEwYBhgL/s1600/19.png"/></span></p>
<p class="ai-optimize-77"><span style="color: #000000;">Now use john the ripper to crack the ntlmv2 hash by executing given below command</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john _netntlmv2</pre>
<p class="ai-optimize-78"><span style="color: #000000;">From given below image you can confirm, we have successfully decoded the captured hashes with the user name as <strong>raj</strong> and password as <strong>123.</strong></span></p>
<p class="ai-optimize-79"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-HT_tJWEgrOA/WfH62g26ruI/AAAAAAAASLk/NLaickVc-AY9N9Iv8DcrVc3RTYsWebz8gCEwYBhgL/s1600/20.png"/></span></p>
<h3 class="ai-optimize-80"><span style="color: #800000;">Combining DHCP Spoofing with sniffing</span></h3>
<p class="ai-optimize-81"><span style="color: #000000;"><strong>DHCP spoofing:</strong> A fake DHCP server is set up by an attacker in a local network. It broadcast a large number Request message of false IP configuration to genuine Client.</span></p>
<p class="ai-optimize-82"><span style="color: #000000;">Go to ettercap and click on MitM, select DHCP spoofing</span></p>
<p class="ai-optimize-83"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zfwA54_jOzc/WfH621cjneI/AAAAAAAASLk/qoXKkvW6CpkzE4_YgESHd3U-VHy4XpY2ACEwYBhgL/s1600/21.png"/></span></p>
<p class="ai-optimize-84"><span style="color: #000000;">Form the below image, provide the necessary information</span></p>
<ul>
<li class="ai-optimize-85"><span style="color: #000000;">IP Pool – <strong>168.0.200-210</strong> (put an IP range to issue IP to the system connected to the network, this will work as DHCP server)</span></li>
<li class="ai-optimize-86"><span style="color: #000000;">Net-mask <strong>255.255.0</strong> (as per the IP Class)</span></li>
<li class="ai-optimize-87"><span style="color: #000000;">DNS Server IP <strong>168.0.1</strong> (as per the IP Class)</span></li>
</ul>
<p class="ai-optimize-88"><span style="color: #000000;">Click OK and Start sniffing</span></p>
<p class="ai-optimize-89"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Ty9eFuWxE0E/WfH63XifpDI/AAAAAAAASLk/8E_v4pbOrQ4AR2wxfMkl_Su49vzK3DQhgCEwYBhgL/s1600/22.png"/></span></p>
<p class="ai-optimize-90"><span style="color: #000000;">Here I have turned on the “metasploitable server” given below image shows <strong>the IP 192.168.0.202</strong> which is from the pool of IP range we provided on ettercap DHCP.</span></p>
<p class="ai-optimize-91"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-g7LZP5tZXOA/WfH63olvGTI/AAAAAAAASLk/Loyb8l2cwcITTDJK-ClAjfm4pPtUfX7fwCEwYBhgL/s1600/24.png"/></span></p>
<p class="ai-optimize-92"><span style="color: #000000;">Let us now go to the client machine and try to connect the metasploitable server with <strong>FTP (File Transfer Protocol)</strong> client as shown in the below image</span></p>
<p class="ai-optimize-93"><span style="color: #000000;">Provide the hostname (IP), user name and password to connect to the FTP server.</span></p>
<p class="ai-optimize-94"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-2f8xE2CMTtU/WfH633CLR-I/AAAAAAAASLk/x7zH4iv2o2YaVGOUzSuDo0WIA-RdSvyUQCEwYBhgL/s1600/25.png"/></span></p>
<p class="ai-optimize-95"><span style="color: #000000;">Next, from the given below image, we can see that, the information such as username and password for FTP is getting captured by ettercap provided by the host machine. In our case it is User:<strong>msfadmin</strong>, PASS:<strong>msfadmin</strong></span></p>
<p class="ai-optimize-96"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-PVvJcfaknPk/WfH64qmj7CI/AAAAAAAASLk/b8okEjUEWykbVFe0nxADKU8YpQ2FLwltQCEwYBhgL/s1600/26.png"/></span></p>
<p class="ai-optimize-97"><span style="color: #000000;">Then, from given below image you can perceive that now we are trying to connect with metasploitable server (192.168.0.202) through telnet via port 23 using putty. it will prompt you for the user name and password, provide the necessary information.</span></p>
<p class="ai-optimize-98"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-f80Wu6nGFOY/WfH64nz_F-I/AAAAAAAASLk/pJ9xpJs_ZlMsaAPKSGpaffOFnkKIeN_YQCEwYBhgL/s1600/27.png"/></span></p>
<p class="ai-optimize-99"><span style="color: #000000;">Them, the above image, we can clearly see that ettercap has captured the credential information been provided by the user in our case it is User:<strong>msfadmin</strong> Pass: <strong>msfadmin </strong>for telnet service.</span></p>
<p class="ai-optimize-100"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-uHXFX3AUSKY/WfH65JZgzJI/AAAAAAAASLk/fd691r5oSFw50_sTsQC7fWNrxKeHJfL-ACEwYBhgL/s1600/28.png"/></span></p>
<h3 class="ai-optimize-101"><span style="color: #800000;">HTTP Password Sniffing</span></h3>
<p class="ai-optimize-102"><span style="color: #000000;">Let us now do the same through <strong>HTTP (Hypertext Transfer Protocol)</strong></span></p>
<p class="ai-optimize-103"><span style="color: #000000;">From the below image, we can see DVWA service is running in our metasploitable server, through the client browser let us type <strong>192.168.0.202/dvwa/login.php</strong>, it will prompt for <strong>username</strong> and <strong>password</strong>, let’s provide the credentials.</span></p>
<p class="ai-optimize-104"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-9xuGL0wbLPw/WfH65T3CtfI/AAAAAAAASLk/BxGP4LYTCJku4lDPfo4bYKAxB8-tyiGzwCEwYBhgL/s1600/29.png"/></span></p>
<p class="ai-optimize-105"><span style="color: #000000;">We could see from the below image, ettercap has once again captured the username and password been provided by the user from the browser. In our case, it is username: <strong>admin </strong>and PASS: <strong>password </strong>for HTTP service.</span></p>
<p class="ai-optimize-106"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-zKS8_BkqB08/WfH652XcYfI/AAAAAAAASLk/PCsdWIKCn4YhJ81-hvaKclTrFHa69ExcACEwYBhgL/s1600/30.png"/></span></p>
<h3 class="ai-optimize-107"><span style="color: #800000;">SMTP Password Sniffing </span></h3>
<p class="ai-optimize-108"><span style="color: #000000;">Lastly, let us now try this with SMTP (Simple Mail Transport Protocol) Sniffing.</span></p>
<p class="ai-optimize-109"><span style="color: #000000;">The first step is to configure SMTP Server in your environment please click <a href="https://www.hackingarticles.in/smtp-pentest-lab-setup-ubuntu/">Here</a> as to how we can configure an SMTP server in windows machine.</span></p>
<p class="ai-optimize-110"><span style="color: #000000;">Once the Server is configured, and we have set up email clients on the target machines,</span></p>
<p class="ai-optimize-111"><span style="color: #000000;">Let us open Ettercap and add both our Targets X.X.X.102 and X.X.X.104 and select ARP poisoning</span></p>
<p class="ai-optimize-112"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-o7aCekvqcH0/WfH66XNf8yI/AAAAAAAASLk/Wdlhs-q_daER6tSmSMQ3-XYIQ0rlUwrEQCEwYBhgL/s1600/32.png"/></span></p>
<p class="ai-optimize-113"><span style="color: #000000;">Now let us send an email from Target A to Target B as shown below</span></p>
<p class="ai-optimize-114"><span style="color: #000000;">Here target A: <strong>raj@pentestlab.local</strong> is sender who is sending the message to target B: <a href="mailto:aarti@pentestlab.local"><strong>aarti@pentestlab.local</strong></a>  and hence port 25 for SMTP service will get in action.</span></p>
<p class="ai-optimize-115"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-r3L9L4Wa9nA/WfH66WGrcvI/AAAAAAAASLk/rhddFTc1en8rPdtAMP6B1XzSxBb5UTf3QCEwYBhgL/s1600/33.png"/></span></p>
<p class="ai-optimize-116"><span style="color: #000000;">Given below image has confirmed that Aarti has received raj’s mail successfully. While at background attacker is sniffing all the traffic passes through the router.</span></p>
<p class="ai-optimize-117"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/--sNwmOvUqQE/WfH6697ZTeI/AAAAAAAASLk/wli5ioyuDMIRnDr6Mv5jcXEkPeLJsab9ACEwYBhgL/s1600/34.png"/></span></p>
<p class="ai-optimize-118"><span style="color: #000000;">If we now go to Ettercap console, we can clearly see that it has successfully sniffed the traffic between Target A and Target B. And also captured the credential of Target A (Raj) as shown in above image.</span></p>
<p class="ai-optimize-119"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-RjNF8kIV25M/WfH67D2SsvI/AAAAAAAASLk/OQX-Aa0Tq4UVN5CMeRqfK5ocS1RlAoOmgCEwYBhgL/s1600/35.png"/></span></p>
<h3 class="ai-optimize-120"><span style="color: #000000;"><span style="color: #800000;">Capture Email of SMTP server with Wireshark</span> </span></h3>
<p class="ai-optimize-121"><span style="color: #000000;">Go to wire shark are put the filter<strong> smtp &amp;&amp; (eth.src == 00:0c:29:4a:47:75 || eth.dst == 00:0c:29:4a:47:75)</strong> the MAC address filter is for our kali machine, you will observe it has captured packets from both our target Machines.</span></p>
<p class="ai-optimize-122"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QgnNGDRSR44/WfH67tj5S3I/AAAAAAAASLk/PZxc6j8iqfMqV93vFS9jLEkz_pA9os1RwCEwYBhgL/s1600/36.png"/></span></p>
<p class="ai-optimize-123"><span style="color: #000000;">As you can see, it has sniffed all SMTP packets and recorded the sender and recipient email addresses of messages sent to Target B. <strong data-start="265" data-end="279">Hi friends</strong>, today we’re performing SMTP sniffing, which clearly demonstrates that our assault on the chosen targets was effective, as illustrated in the picture below.</span></p>
<p class="ai-optimize-124"><span style="color: #000000;">Throughout this article, we discussed various ways and techniques to successfully exploit the ARP protocol. Now, to conclude, let us briefly discuss the technique used to detect an ARP attack.  </span></p>
<p class="ai-optimize-125"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9B_thX1fICA/WfH672Et6DI/AAAAAAAASLk/GDDFpuO9qH4bxPx4gl5tWvzz9AnWhpObwCEwYBhgL/s1600/37.png"/></span></p>
<h3 class="ai-optimize-126"><span style="color: #000000;"><span style="color: #800000;">ARP Attack Detection </span>                </span></h3>
<p class="ai-optimize-127"><span style="color: #000000;">There are various tools available to detect the arp attack, one of the most common tools is <strong>XArp tool,</strong> which we will be using for this article.</span></p>
<p class="ai-optimize-128"><span style="color: #000000;">We can run this tool in any host machine in the network to detect the arp attack. Above image shows the affected systems on the network highlighted in red (X). We can disconnect these host from the network and decide upon next course of action to mitigate these risk by implementing the following controls:</span></p>
<ol>
<li class="ai-optimize-129"><span style="color: #000000;"><strong>Dynamic address inspection</strong></span></li>
<li class="ai-optimize-130"><span style="color: #000000;"><strong>DHCP snooping</strong></span></li>
<li class="ai-optimize-131"><span style="color: #000000;"><strong>VLAN hopping prevention</strong></span></li>
</ol>
<p class="ai-optimize-132"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wq0PJzRNw7E/WfH685c5FXI/AAAAAAAASLk/7Wqb0feqHicBhfQiUiwTtHe5V_PFEoS7gCEwYBhgL/s1600/41.png"/></span></p>
<p class="ai-optimize-55"><span style="color: #000000;">To learn more about Penteration Testing. Follow this</span> <a href="https://www.hackingarticles.in/category/penetration-testing/">Link.</a></p>
<p class="ai-optimize-133"><span style="color: #000000;"><strong>Author</strong><strong>: Krishnan Sharma</strong> is a technology professional having the passion for information security and related fields. He loves technical writing and contributes to our hacking article team; you can contact him <strong><a href="https://in.linkedin.com/in/krishnan-sharma-0287115">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
