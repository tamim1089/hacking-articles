<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a>, <a href="https://www.hackingarticles.in/category/pentest-lab-setup/" rel="category tag">Pentest Lab Setup</a></span>            </div>
            <h1 class="post-title entry-title">IDS, IPS Penetration Testing Lab Setup with Snort (Manually)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/ids-ips-penetration-testing-lab-setup-snort/" rel="bookmark"><time class="entry-date published" datetime="2017-11-29T16:04:03+00:00">November 29, 2017</time><time class="updated" datetime="2025-05-13T09:00:56+00:00">May 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! As you people must be aware of various types of security issues facing by IT sector originations daily. There are so many types of firewall and IDS or third-party software available to shoot out major different types of security issues in the network.</span></p>
<p><span style="color: #000000;">In this article, you will learn how to configure the famous “SNORT as IDS” of IT sector originations which work as a real-time machine.</span></p>
<p><span style="color: #000000;"><strong>Snort</strong> is software created by Martin Roesch, which is widely used as Intrusion Prevention System [IPS] and Intrusion Detection System [IDS] in the network. It is separated into the five most important mechanisms for instance: Detection engine, Logging, and alerting system, a Packet decoder, Preprocessor, and Output modules.</span></p>
<p><span style="color: #000000;">The program is quite famous to carry out real-time traffic analysis, also used to detect query or attacks, packet logging on Internet Protocol networks, to detect malicious activity, denial of service attacks and port scans by monitoring network traffic, buffer overflows, server message block probes, and stealth port scans.</span></p>
<p><span style="color: #000000;">Snort can be configured in three main modes:</span></p>
<ul>
<li><span style="color: #000000;">Sniffer mode: it will observe network packets and present them on the console.</span></li>
<li><span style="color: #000000;">Packet logger mode: it will record packets to the disk.</span></li>
<li><span style="color: #000000;">Intrusion detection mode: the program will monitor network traffic and analyze it against a rule set defined by the user.</span></li>
</ul>
<p><span style="color: #000000;">After that, the application will execute a precise action depend upon what has been identified.</span></p>
<p><span style="color: #000000;"><strong>Let’s Begin!!</strong></span></p>
<h3><span style="color: #800000;"><strong>Snort Installation </strong></span></h3>
<p><span style="color: #000000;">We had chosen <strong>the ubuntu 14.04</strong> operating system for installation and configuration of snort. Earlier than installing snort in your machine, you should need to install the necessary dependencies of ubuntu. Therefore open the terminal and type given below command to install pre-requisites:</span></p>
<pre class="lang:default decode:true">sudo apt-get install -y build-essential libpcap-dev libpcre3-dev libdumbnet-dev bison flex zlib1g-dev</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-sbCLn1cJoRI/Wh7OUM5GoAI/AAAAAAAAShw/H5ZAIl__HeEQ5drGwpmbSeBq3t92-HUtwCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Now create a folder to download snort and its dependencies package inside. Type given below commands to create a folder “snort-src” and move inside it to download DAQ-2.0.6</span></p>
<pre class="lang:default decode:true">mkdir ~/snort_src &amp;&amp; cd ~/snort_src</pre>
<pre class="lang:default decode:true">wget https://snort.org/downloads/snort/daq-2.0.6.tar.gz</pre>
<p><span style="color: #000000;">Snort need to set up the DAQ, or <strong>Data Acquisition library</strong>, for packet I/O.  The DAQ change direct calls into lib pcap functions with an abstraction layer that facilitates operation on a variety of hardware and software interfaces without requiring changes to Snort.  It is possible to select the DAQ type and mode when invoking Snort to perform pcap read back or inline operation, etc.  The DAQ library may be useful for other packet processing applications and the modular nature allows you to build new modules for other platforms.</span></p>
<p><span style="color: #000000;">From given below image you can confirm that we had successfully downloaded daq-2.0.6 tar file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-BF36fRKwg3g/Wh7OXoMEgtI/AAAAAAAAShw/m84gd8-1P5cEp9SaKeSAYIEbPhjJWejmQCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Now execute given below command to extract tar file.</span></p>
<pre class="lang:default decode:true">tar xvfz daq-2.0.6.tar.gz</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Nu7JGy_tBOs/Wh7OaPm-QAI/AAAAAAAAShw/IJYw6zJuKhYfm_69MG5Et_x097tY3r4CgCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Move inside the daq-2.0.6 folder by executing given below the first command and then execute the second command for automatic installation and configuration.</span></p>
<pre class="lang:default decode:true">cd daq-2.0.6
./configure &amp;&amp; make &amp;&amp; sudo make install</pre>
<p><span style="color: #000000;">Till here you had learned how to install daq-2.0.6 for snort.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-R7ROoxHGMRU/Wh7OaJt_pqI/AAAAAAAAShw/faecm9U25z8Xtm7h54vNUEIhDUTBMFG1QCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Now again move into snort-src folder and type given below command to download the latest version of snort-2.9.11</span></p>
<pre class="lang:default decode:true">wget https://snort.org/downloads/snort/snort-2.9.11.tar.gz</pre>
<p><span style="color: #000000;">From given below image you can confirm that we had successfully downloaded snort-2.9.11 tar file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ohaEu5C7vbY/Wh7OaZWAqTI/AAAAAAAAShw/UfI2ecI7q0sSTEio074qzlTxvz6KywBGwCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Now execute given below command to extract tar file.</span></p>
<pre class="lang:default decode:true">tar xvfz snort-2.9.11.tar.gz</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-m0-Zjftq8oM/Wh7ObXSc7SI/AAAAAAAAShw/0LW8dJO2c2wP421V5xiaA1iLC9cA9j_ogCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Move inside the snort-2.9.11 folder by executing given below the first command and then execute the second command for automatic installation and configuration.</span></p>
<pre class="lang:default decode:true">cd snort-2.9.11
./configure --enable-sourcefire &amp;&amp; make &amp;&amp; sudo make install</pre>
<p><img decoding="async" style="color: #000000;" src="https://3.bp.blogspot.com/-rXTg899IBIk/Wh7Obp1gPqI/AAAAAAAAShw/EMaL45K1BWExEsErCGoeYWhFr4lShASjACEwYBhgL/s1600/7.png"/></p>
<p><span style="color: #000000;">Run the following command to manage and install shared libraries</span></p>
<pre class="lang:default decode:true">sudo ldconfig</pre>
<p><span style="color: #000000;">Type given below command for generating a symbolic link</span></p>
<pre class="lang:default decode:true">sudo ln -s /usr/local/bin/snort /usr/sbin/snort</pre>
<p><span style="color: #000000;">A symbolic link also known as a soft link is a file system entry that points to the file name and location. Deleting the symbolic link does not remove the original file. If, on the other hand, the file to which the soft link point is removed, the soft link stops working, it is broken.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ovjZr6vMVeM/Wh7Ob-W22EI/AAAAAAAAShw/mNOSiKKoTcIzIOrJ55AWViiV_njzftNCgCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now execute given below command that snort to verify itself by testing its installation and configuration.</span></p>
<pre class="lang:default decode:true">snort -V</pre>
<p><span style="color: #000000;">The first part of snort installation finished here</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-GVB08aLuQO0/Wh7OcSkOZjI/AAAAAAAAShw/YwWNaVgtFJ07Quv-nbZFAWvkF8td88yXwCEwYBhgL/s1600/9.png"/></span></p>
<h3><span style="color: #800000;"><strong>Configure Snort to in IDS Mode in Network</strong></span></h3>
<p><span style="color: #000000;">Execute given below command to create the snort user and group, where snort will run as an unprivileged user.</span></p>
<pre class="lang:default decode:true">sudo groupadd snort
sudo useradd snort -r -s /sbin/nologin -c SNORT_IDS -g snort</pre>
<p><span style="color: #000000;">Above command will create a group as “snort” and add a member “snort” into it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-pvuOtaa1iXo/Wh7OUN6fqJI/AAAAAAAAShw/DNPpo8q8CZEdoDeRHELxO-aj69-wEFwMwCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now further we need to make some directories which Snort suppose at the timing of running in IDS mode in the network. Snort stores configuration files in /etc/snort; rules in /etc/snort/rules; store compile rules in  /usr/local/lib/snort_dynamicrules, and stores its logs in /var/log/snort:</span></p>
<p><span style="color: #000000;">Type given below command to create the Snort directories:</span></p>
<pre class="lang:default decode:true">sudo mkdir /etc/snort
sudo mkdir /etc/snort/rules
sudo mkdir /etc/snort/rules/iplists
sudo mkdir /etc/snort/preproc_rules
sudo mkdir /usr/local/lib/snort_dynamicrules
sudo mkdir /etc/snort/so_rules</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-7tRNqzkVb6M/Wh7OUMHHSdI/AAAAAAAAShw/7clSmMCHjdc1C6tpEFYAACkvkkEhqwoagCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Type given below command to create some files that stores rules and ip lists</span></p>
<pre class="lang:default decode:true">sudo touch /etc/snort/rules/iplists/black_list.rules
sudo touch /etc/snort/rules/iplists/white_list.rules
sudo touch /etc/snort/rules/local.rules
sudo touch /etc/snort/sid-msg.map</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1VWYg8X3LdY/Wh7OVBywJ7I/AAAAAAAAShw/vwz-M4j4Dz4BEZW99ijhZ62kELrR63GBACEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Type given below command to create our logging directories:</span></p>
<pre class="lang:default decode:true">sudo mkdir /var/log/snort
sudo mkdir /var/log/snort/archived_logs</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zwQc_SjeO2A/Wh7OVCV6J4I/AAAAAAAAShw/R1C9z8zAcPA_zhvojCPbFxA3A2acffW2wCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Type given below command to adjust permissions:</span></p>
<pre class="lang:default decode:true">sudo chmod -R 5775 /etc/snort
sudo chmod -R 5775 /var/log/snort
sudo chmod -R 5775 /var/log/snort/archived_logs
sudo chmod -R 5775 /etc/snort/so_rules
sudo chmod -R 5775 /usr/local/lib/snort_dynamicrules</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-SDiNMQ5GvOo/Wh7OVE5QAWI/AAAAAAAAShw/zZhNLov5zZo7xC7K_ixqnxHI5kdV-bZ9gCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Snort required some configuration files and the dynamic preprocessors to be copied from the Snort source folder into the /etc/snort folder, therefore, execute given below command for that.</span></p>
<pre class="lang:default decode:true">cd snort_src/snort-2.9.11/etc/
sudo cp *.conf* /etc/snort
sudo cp *.map /etc/snort
sudo cp *.dtd /etc/snort</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-lCQW6pnbAHk/Wh7OWGcs9NI/AAAAAAAAShw/416pn3aMT1I6U4b73WHWHerg8xETv0d3ACEwYBhgL/s1600/15.png"/></span></p>
<pre class="lang:default decode:true">cd snort_src/snort-2.9.11/src/dynamic-preprocessors/build/usr/local/lib/snort_dynamicpreprocessor/
sudo cp * /usr/local/lib/snort_dynamicpreprocessor/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-6W_38YysS6w/Wh7OWR65ZqI/AAAAAAAAShw/7kV0-eqgkBIAMZqQGe8MzYOvU2-Jc4FmwCEwYBhgL/s1600/16.png"/></span></p>
<h3><span style="color: #800000;"><strong>Editing snort configuration file</strong></span></h3>
<p><span style="color: #000000;">Now we need to comment out all rulesets with the following command:</span></p>
<pre class="lang:default decode:true">sudo sed -i "s/include \$RULE\_PATH/#include \$RULE\_PATH/" /etc/snort/snort.conf</pre>
<p><span style="color: #000000;">After then open the configuration file using gedit for making some changes inside.</span></p>
<pre class="lang:default decode:true">sudo gedit /etc/snort/snort.conf</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-GRWu37E8j7M/Wh7OWRULIyI/AAAAAAAAShw/gpAbf5Qbs9QOBlVzXCxwMxD6zRloOnMfwCEwYBhgL/s1600/17.png"/></strong></span></p>
<p><span style="color: #000000;">Scroll down the text file near line number 45 to specify your network for protection as shown in the given image.</span></p>
<p><span style="color: #000000;">#Setup the network addresses you are protecting</span></p>
<pre class="lang:default decode:true">ipvar HOME_NET 192.168.1.1/24</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-SeRz6I6exds/Wh7OYf82IZI/AAAAAAAAShw/p3koShWU2gcgQoLsvcl5khg1b2K3-R5rgCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Now again scroll down near line number 108 to set the path of your rule file which you had created above for storing snort rules, as shown in given below image.</span></p>
<pre class="lang:default decode:true">var RULE_PATH /etc/snort/rules
var SO_RULE_PATH /etc/snort/so_rules
var PREPROC_RULE_PATH /etc/snort/preproc_rules
var WHITE_LIST_PATH /etc/snort/rules/iplists
var BLACK_LIST_PATH /etc/snort/rules/iplists</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-SHN-KtVUUBU/Wh7OXdwYVEI/AAAAAAAAShw/pdIBY8eWqiAFmSLb98p4NmbJ6oW9vpxpQCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">One more time scroll down the text near line number 546 to uncomment highlighted text.</span></p>
<p><span style="color: #000000;"><strong>include $RULE_PATH/local.rules    </strong></span></p>
<p><span style="color: #000000;">Save the file and close it once all the editing is done in the snort configuration file. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-EDmvMIRyTcI/Wh7OYPE_40I/AAAAAAAAShw/HVsvlS19aQYLZfsJvD0iLyp0d08_rONTACEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Now once again we need to verify its configuration setting, therefore, execute the following command to test it.</span></p>
<pre class="lang:default decode:true ">sudo snort -T -i eth0 -c /etc/snort/snort.conf</pre>
<p><span style="color: #000000;">Now it will compile the complete file and test the configuration setting automatically as shown in given below image:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-nctsdSYAO1k/Wh7OYhG8hfI/AAAAAAAAShw/J0cjDy9bjJMSkSKK0uwDny92xL0G73lGwCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;"><strong>Great!!</strong> We had successfully configured snort as IDS for protecting our network.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-fol7dYa-QZM/Wh7OZIdrlEI/AAAAAAAAShw/Yd1C0KcTXxQL3WiDlCN0d_oqT7w2KPqggCEwYBhgL/s1600/22.png"/></span></p>
<p><span style="color: #000000;"><strong>Reference </strong><a style="color: #000000;" href="https://s3.amazonaws.com/snort-org-site/production/document_files/files/000/000/069/original/Snort-IPS-Tutorial.pdf"><strong>link</strong></a></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
