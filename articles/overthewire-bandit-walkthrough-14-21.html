<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">OverTheWire – Bandit Walkthrough (14-21)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/overthewire-bandit-walkthrough-14-21/" rel="bookmark"><time class="entry-date published" datetime="2018-07-28T06:36:12+00:00">July 28, 2018</time><time class="updated" datetime="2025-06-10T20:35:57+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today, we will continue to play the war-game called <strong>Bandit</strong>. <span style="color: #0000ff;"><a style="color: #0000ff;" href="http://overthewire.org">OverTheWire</a></span> Organization hosts this war-game. To play this war-game, go to the Bandit website by clicking <span style="color: #0000ff;"><a style="color: #0000ff;" href="http://overthewire.org/wargames/bandit/">here</a></span>.</span></p>
<p><span style="color: #000000;">Get the solutions of other levels from below.</span></p>
<p><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/overthewire-bandit-walkthrough-1-14/">OverTheWire – Bandit Walkthrough (1-14)</a></span></p>
<p><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/overthewire-bandit-walkthrough-21-34/">Overthewire – Bandit Walkthrough (21-34)</a></span></p>
<h3><span style="color: #800000;"><strong>Objective </strong></span></h3>
<p><span style="color: #000000;">Find the password file. It will give us access to the next level.</span></p>
<h3><span style="color: #800000;"><strong>Table of Content:</strong></span></h3>
<ul>
<li><span style="color: #000000;">Level 14-15</span></li>
<li><span style="color: #000000;">Level 15-16</span></li>
<li><span style="color: #000000;">Level 16-17</span></li>
<li><span style="color: #000000;">Level 17-18</span></li>
<li><span style="color: #000000;">Level 18-19</span></li>
<li><span style="color: #000000;">Level 19-20</span></li>
<li><span style="color: #000000;">Level 20-21</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Level 14-15</strong></span></h3>
<p><span style="color: #000000;">In the previous article, we got the password for level 14 and have successfully connected as user bandit14. We are informed that the password for the next level can be retrieved by submitting the password of the current level to port 30000 on localhost. First, we retrieve the password for the current level. We used the cat command to print the password as shown in the given image. To connect to port 30000, we are using telnet. After connecting we enter the current password it is checked and upon matching the password for the next level is printed on the screen. We will use this password to get an SSH connection as bandit15</span></p>
<pre class="lang:default decode:true">cat /etc/bandit_pass/bandit14
telnet localhost 30000
ssh bandit15@localhost</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XP_WxNW5C0Y/XHzrUlNcaKI/AAAAAAAAdRU/aAFi0niIyUQMoZCfmM74UonABQF1F-PYQCLcBGAs/s1600/1.png"/></span></p>
<h3><span style="color: #800000;">Level 15-16</span></h3>
<p><span style="color: #000000;">On this level, we are informed that the password for the next level is retrieved by submitting the password of the current level to port 30001 on localhost using SSL encryption. We use the openssl command with parameters like s_client that implements that we are the connecting as the client using the hostname localhost at port 30001. We use -ign_eof to inhibit shutting the connection when the end of file is reached in the input.</span></p>
<pre class="lang:default decode:true">openssl s_client -connect localhost:30001 -ign_eof</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-oLZ_mMy37HU/XHzrWWMN2oI/AAAAAAAAdR0/VQ9ewgiwTNcB2Mf_2WMOzdHg1sr3u5SHwCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">After establishing the connection, we provide it with the password for the bandit15. It is verified and after verification, the password for the next level is provided. We will use this password to get an SSH connection as bandit16.</span></p>
<pre class="lang:default decode:true">ssh bandit16@localhost</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-msh_CsTeLjE/XHzrWtsq5JI/AAAAAAAAdR4/cg6KgjeRwHQGZBphpVyh-Vj5JKys3xCMACLcBGAs/s1600/3.png"/></span></p>
<h3><span style="color: #800000;">Level 16-17</span></h3>
<p><span style="color: #000000;">Initially, we are informed that the credentials for the next level can be retrieved by connecting to a port within the range of 31000 to 32000 and submitting the password of bandit16. We use Nmap to scan the ports to get the exact port from the range. As we can see in the output of the Nmap scan that on port 31790 there is a message that hints that we need to enter the password on that port.</span></p>
<pre class="lang:default decode:true">nmap -A localhost -p 31000-32000</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-6DsYilBkuYk/XHzrXGxo9NI/AAAAAAAAdR8/YpLnyaGavCAfHfkD2woeWIcFY6_a7-XswCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Now we will connect to this port using openssl as localhost.</span></p>
<pre class="lang:default decode:true">openssl s_client -connect localhost:31790</pre>
<p> </p>
<p><span style="color: #000000;">After connecting to the port, we will have to enter the password of bandit16. This password goes under verification. Upon a successful match, we are provided with an RSA key.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-zUWJfleCBLg/XHzrXfO9KCI/AAAAAAAAdSA/ChALJWgadMIZ4dfoM9uAB-HzXMZv92MqACLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Now to use this RSA key, we need to create a private key. But we can’t do this inside the home directory as we lack necessary permissions. So, we create a directory in /tmp directory using mkdir command. On traversing to that newly created directory, we will create a private key. We can name it anything we want. Here we are using the nano editor to create the private key.</span></p>
<pre class="lang:default decode:true">mkdir /tmp/pavan_ssh
cd /tmp/pavan_ssh
nano pavan.private</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-plcsYRetvMY/XHzrXpSrZlI/AAAAAAAAdSE/w2XzH-jhgbMwvsUtfWp7klksUgZ74hy0ACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">After running the nano command, we will be prompted to press the Enter key to continue. On doing that the private key will be opened to edit using nano. Now we will paste the RSA key we found earlier. Now to exit we will press Ctrl and x keys simultaneously. There would be a prompt asking us to save the updates. We will press ‘y’ followed by this, nano will ask us if we want to rename the file. After this, we would have successfully created a private key using the RSA we were provided before.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-C8qzB3A5ljA/XHzrYLGf2AI/AAAAAAAAdSQ/j_076lHhuAI-gN3t4GPry956jpwvNjrjACLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">SSH won’t allow any private key with such open permissions. So, we will have to change the permissions. We will use the chmod command to apply the permissions equivalent to 600. This means that only the owner can read and write the file. We will use this private key to get an SSH connection as bandit17.</span></p>
<pre class="lang:default decode:true">chmod 600 pavan.private
ssh bandit17@localhost -i pavan.private</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-SFJEtSHT5g4/XHzrYCMiJ3I/AAAAAAAAdSM/FHFL4D3rJWwTMVblsIFaMAe57gwEleFigCLcBGAs/s1600/9.png"/></span></p>
<h3><span style="color: #800000;">Level 17-18</span></h3>
<p><span style="color: #000000;">Upon logging in as bandit17, we run the ls command to look for any files. We see that we have two files, password.new and password.old. Now we have informed that password for the next level the only line that has been changed between both files. We will use the diff command to find that password. And the diff command gives us the required password. We will use this password to get an SSH connection as bandit18.</span></p>
<pre class="lang:default decode:true">ls
diff passwords.old passwords.new
ssh bandit18@localhost</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-D54-tdnxNB4/XHzrUtlzFfI/AAAAAAAAdRc/Wgd-5r6pz8cfrsYc7CW_Q-1BisaXzjD3gCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Now on providing with the correct password our connection was closed. This is because the authors of this level have modified the .bashrc file to log us out of ssh. We will use the -t parameter to disable the pseudo -tty allocation. As this is making our session vulnerable to get closed. Let’s connect ssh again as shown in the given image.</span></p>
<pre class="lang:default decode:true">ssh -T bandit18@localhost</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FFNeyPu3xN0/XHzrUn4BoaI/AAAAAAAAdRY/fG-iPzUs7joSv3nlw30wsOeNP5m_vpXeQCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">This time we got a shell, it may be not visible but it is there. We can run commands here. First, let’s try the ls command. This gives us the readme file. Upon reading that file, we get what seems like credentials for the next level. We will use this password to get an SSH connection as bandit19.</span></p>
<pre class="lang:default decode:true">ls
cat readme
ssh bandit19@localhost</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-g0KBauFwGcA/XHzrVQiDOwI/AAAAAAAAdRg/LWYzD5tQPDwW6UmvtYhCjiNHuOMK1Ag7gCLcBGAs/s1600/13.png"/></span></p>
<h3><span style="color: #800000;">Level 19-20</span></h3>
<p><span style="color: #000000;">After successfully getting the ssh to user bandit19, we start with ls command to see what we got this time. We have a file that seems like a script. We tried to run to see the working of the script. We are shown that the script runs a command as another user. Now we were informed that the password is stored at /etc/bandit_pass/. So, we run the script with the cat command to read the password for the next level. We will use this password to get an SSH connection as bandit20.</span></p>
<pre class="lang:default decode:true">ls
./bandit20-do
./bandit20-do cat /etc/bandit_pass/bandit20
ssh bandit20@localhost</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hoOxq0orKds/XHzrVvgQsyI/AAAAAAAAdRk/wOmHOlRuE-88PGiXcuSHWYjITrUOBUUNQCLcBGAs/s1600/14.png"/></span></p>
<h3><span style="color: #800000;">Level 20-21</span></h3>
<p><span style="color: #000000;">We are informed that there is a setuid binary in this level whose job is to make a connection to localhost on a port and read the password used to login as bandit20 and then send the password for the next level. First, let’s see the files we have using the command ls. We have a script suconnect. On running this command without any parameters, we see that it requires a port to connect to. Now here is the part where it gets tricky. The image given below is one instance of the shell. We will execute to the point where we run suconnect without parameters and create other instance of the same shell. Run a netcat listener over another instance on the same port we are planning to suconnect. But we need to start listener before running the suconnect. On running the suconnect. Netcat will grab a session. Now we enter the password that we used to login as user bandit20. As we can see that the password, we entered is read by the suconnect and when the password is verified. Password for the next level is sent to the listener.</span></p>
<pre class="lang:default decode:true">ls
./suconnect
./suconnect 4444</pre>
<p><span style="color: #000000;">Image shown below is the execution of the first instance.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-32a17wwSmFQ/XHzrVxQH0HI/AAAAAAAAdRo/4jIYmIBTjB8DRyuvunZ5nEIfjpB306VzwCLcBGAs/s1600/15.png"/></span></p>
<pre class="lang:default decode:true">nc -lvp 4444</pre>
<p><span style="color: #000000;">Image shown below is the execution of the second instance.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-ZY_bnEb3yE4/XHzrV6Cgw8I/AAAAAAAAdRs/j2z_pZGX0VcNz0K2BC-F4d2fl2WHHBOywCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Now that we have the password for the next level, we move back to our first instance and used the password to login as user bandit21 using SSH.</span></p>
<pre class="lang:default decode:true">ssh bandit21@localhost</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/--QW4M_2UQFY/XHzrWCOFgCI/AAAAAAAAdRw/DNMrwgjBAFQnA3a-zetKCFQiBr0ONRONQCLcBGAs/s1600/17.png"/></span></p>
<p><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester Contact <strong><a href="https://www.linkedin.com/in/pavandeep-singh-6b1074132" rel="noopener noreferrer" data-saferedirecturl="https://www.google.com/url?q=https://www.linkedin.com/in/pavandeep-singh-6b1074132&amp;source=gmail&amp;ust=1542651210170000&amp;usg=AFQjCNEYOzlThg6B1HzKcEZNou4HowCJ2Q">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
