<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">HacktheBox Poison Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-poison-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-09-08T17:53:04+00:00">September 8, 2018</time><time class="updated" datetime="2025-07-05T15:26:28+00:00">July 5, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello everyone and welcome to yet another CTF challenge from Hack the Box, called ‘Poison,’ which is available online for those who want to increase their skills in penetration testing and black box testing. Poison is a retired vulnerable lab presented by Hack the Box for making online penetration testing practice suitable to your experience level; they have a large collection of vulnerable labs as challenges ranging from beginner to expert level.</span></p>
<p><span style="color: #000000;"><strong>Level: </strong>Easy</span></p>
<p><span style="color: #000000;"><strong>Task: </strong>Find user.txt and root.txt in the victim’s machine</span></p>
<h3><span style="color: #800000;">Methodology</span></h3>
<ol>
<li><span style="color: #000000;">Port scanning</span></li>
<li><span style="color: #000000;">Using LFI to find the username</span></li>
<li><span style="color: #000000;">Gaining encrypted password file using LFI</span></li>
<li><span style="color: #000000;">Decrypting password file</span></li>
<li><span style="color: #000000;">Logging in to SSH using a decrypted password</span></li>
<li><span style="color: #000000;">Transferring ZIP file and extracting to find a secret file</span></li>
<li><span style="color: #000000;">Discovery of VNC on the machine</span></li>
<li><span style="color: #000000;">VNC tunneling over SSH to get a root shell</span></li>
<li><span style="color: #000000;">Grabbing flag</span></li>
</ol>
<p><span style="color: #000000;">Let’s get started then!</span></p>
<p><span style="color: #000000;">Since these labs have a static IP, the IP address for poison is <strong>10.10.10.84. </strong>Firstly<strong>, </strong>Let us scan the VM with the most popular port scanning tool, <strong>nmap.</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 10.10.10.84</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-HTJoUo0_wsk/W5QI3HGkOLI/AAAAAAAAaKI/0LkjsJ5WHQQiwXrlqbKDS1i379mrnLmDACEwYBhgL/s1600/1.png"/></strong></span></p>
<p><span style="color: #000000;">From the result above we found two working ports on the VM, <strong>port 22 and 80 </strong>which are universal default ports for SSH and HTTP.</span></p>
<p><span style="color: #000000;">We immediately headed over to the web page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-f_EWGI2zc_A/W5QI5Tf0dPI/AAAAAAAAaKk/eUrHTThaqKAgEmnTRaYi70qZPXiYG5w0gCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">It was crystal clear only by reading that there was an LFI vulnerability involved. So, we tested it by inputting <strong>/etc/passwd </strong>in the script name section.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-w9e0or2f_UI/W5QI5gzaEDI/AAAAAAAAaKo/lzwZckSk4joHA1kqpmlBmHhKna9k83lMQCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Which led us to the following output</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-jreCi41jVCY/W5QI6DG9qQI/AAAAAAAAaKw/x3ZmeiFdJO89yNu1VRjirESW4btM5C1wACEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">From here we found that the username was “<strong>charix.” </strong>But before moving on to that part we tried all the script names one by one given in the previous web page.</span></p>
<p><span style="color: #000000;">It was going all monotonous until we found an interesting text file in the “<strong>listfiles.php</strong>” script.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NmTvKW0mKLs/W5QI55ZRC-I/AAAAAAAAaLQ/io3Brf2ENpkDIFWUg1PYD--aYLV2zd83gCEwYBhgL/s1600/5.png"/></span></p>
<p> </p>
<p> </p>
<p><span style="color: #000000;">The listfiles.php was a script that enumerated an array of the files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-szS8-TfVMCQ/W5QI6ocRwDI/AAAAAAAAaLU/kfYq1e8vRoosZJexvHmkAUYVrItFMsIYwCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Here, we found an interesting file called <strong>pwdbackup.txt. </strong>On opening it by the same process we found an encrypted password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Bm9L2fHHK1A/W5QI7X5-fiI/AAAAAAAAaLY/SisOZY7BCvIFVXLrl0oqz7jM44gs2cZEACEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">But it wasn’t normal encryption, the password was <strong>encrypted 13 times</strong>. Just by looking we could tell that it was base64 encoding. So, we copied the password in a notepad file and removed the spaces between the password’s lines (present by default) and wrote the following command to decrypt it:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat decode | base64 -d| base64 -d| base64 -d| base64 -d| base64 -d| base64 -d| base64 -d| base64 -d| base64 -d| base64 -d| base64 -d| base64 -d| base64 –d</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://4.bp.blogspot.com/-BnXWVE6Q3lI/W5QI7VcW4EI/AAAAAAAAaLY/IP05ec4UF1Mrz5q7BXkRxH_53DWSfX7FQCEwYBhgL/s1600/8.png"/></strong></span></p>
<h5><span style="color: #000000;">Voila! The password is <strong>Charix!2#4%6&amp;8(0</strong></span></h5>
<p><span style="color: #000000;">A complete logical shot in the dark was that it was the password to secure shell of the victim. So, we tried logging in to SSH.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh charix@10.10.10.84
ls</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://4.bp.blogspot.com/-0P7yDby5N5g/W5QI7RR5nOI/AAAAAAAAaLU/gMlr3yL0mRUjnw_1hbPscw31A6cCqJdtQCEwYBhgL/s1600/9.png"/></strong></span></p>
<p><span style="color: #000000;">And just like that, we were logged in! We found the first flag <strong>(user.txt)</strong> and another file called <strong>secret.zip</strong></span></p>
<p><span style="color: #000000;">We tried unzipping it on the spot but it didn’t work. So, instead, we transferred the file to our system using <strong>scp</strong> (read how to transfer using SCP <a style="color: #000000;" href="https://www.hackingarticles.in/file-transfer-cheatsheet-windows-and-linux/">here</a>)</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">scp charix@10.10.10.84:secret.zip /root/Desktop/
cd Desktop
unzip secret.zip</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://2.bp.blogspot.com/-uYaA4j9zYX0/W5QI3K10s3I/AAAAAAAAaLE/0MQTMaOLkGYkBXIbB99H0dYQMN6uu9wMwCEwYBhgL/s1600/10.png"/></strong></span></p>
<p><span style="color: #000000;">We got a file “secret” which could be the password of another service.</span></p>
<p><span style="color: #000000;">We were far from convinced that no other service was running so we scanned the victim using socat. (To read more: https://packages.debian.org/sid/sockstat)</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sockstat -4 -l</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BljkGNAbdkQ/W5QI4LstcuI/AAAAAAAAaLQ/Bd3xeXp3FzY4pK-sRoMdZJciLkyuR2qFQCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Port number 5901 and 5908 were open which clearly are the port numbers for VNC! This could be our way in.</span></p>
<p><span style="color: #000000;">Then, we followed the SSH tunneling methodology (refer <a style="color: #000000;" href="http://www.hackingarticles.in/comprehensive-guide-to-ssh-tunnelling/">here</a>)</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh -L 5901:127.0.0.1:5901 charix@10.10.10.84</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://2.bp.blogspot.com/-Cc0zkjhygPY/W5QI4WIpU7I/AAAAAAAAaLI/81esUzLyLcUgDNKVVzbmeLGYpIVC5BO8gCEwYBhgL/s1600/12.png"/></strong></span></p>
<p><span style="color: #000000;">IT will open up a shell. In a new terminal write:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">vncviewer -passwd secret 127.0.0.1:5901</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-O7TVy_KQRoU/W5QI4g8tOdI/AAAAAAAAaLM/U7JkbBCnnBQr8dnq0VNb3XR9mNltikC7QCEwYBhgL/s1600/13.png"/></strong></span></p>
<p><span style="color: #000000;"><strong>We saw an authentication successful tag!</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ls
cat root.txt</pre>
<p><span style="color: #000000;">And this is how we owned the poison VM. Hope you enjoyed because we sure did!</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-qUxjjSWk8Lk/W5QI5CVMoWI/AAAAAAAAaLQ/qUmB3wxgzFgrA4xiB8FFVLWzqXcTJuvQgCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: Harshit Rajpal </strong>is an InfoSec researcher and a left and right brain thinker. Contact<strong> <a class="broken_link" style="color: #000000;" href="https://in.linkedin.com/in/harshit-rajpal-79bb43103">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
