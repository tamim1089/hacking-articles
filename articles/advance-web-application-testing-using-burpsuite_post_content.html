<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Advance Web Application Testing using Burpsuite</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/advance-web-application-testing-using-burpsuite/" rel="bookmark"><time class="entry-date published updated" datetime="2018-02-27T06:57:07+00:00">February 27, 2018</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to discuss the advance option of Burp Suite pro for web penetration testing; here we had used Bwapp lab which you can install from <a style="color: #000000;" href="https://www.hackingarticles.in/web-application-lab-setup-on-windows/">here</a> and acunetix vulnerable web application which is available online for making web application penetration practices.</span></p>
<p><span style="color: #000000;"><strong>Burp suite Advanced Usage</strong></span></p>
<ul>
<li><span style="color: #000000;">Burp Infiltrator</span></li>
<li><span style="color: #000000;">Macros</span></li>
<li><span style="color: #000000;">Burp Clickbandit</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Burp Infiltrator</strong></span></h3>
<p><span style="color: #000000;"><strong>Burp Infiltrator</strong> is a tool used to target web applications in order to test them using <strong>Burp Scanner</strong>. Burp Infiltrator is used to targeting application so that Burp can detect cases where its input can pass unsafe APIs on the server-side.</span></p>
<p><span style="color: #000000;">Burp Infiltrator supports applications which are written in:</span></p>
<ul>
<li><span style="color: #000000;">Java, Groovy, Scala, or other JVM languages (JRE versions 1.4 – 1.8)</span></li>
<li><span style="color: #000000;">C#, VB, or other .NET languages (.NET versions 2.0 and later)</span></li>
</ul>
<p><span style="color: #000000;">Let’s start!!</span></p>
<p><span style="color: #000000;">First, we need to enable the <strong>Burp Infiltrator </strong>from the <strong>Burp tab</strong> in burpsuite where we have to select the <strong>Burp Infiltrator option. </strong>Then we will see a Burp Infiltrator box will appear where you have to select the type of application you want to instrument as you shown in the image</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kZb2Wywg-cM/WpT4G9bq5VI/AAAAAAAAU4k/9K-WK3g1oHEsBZrJzS6GWiiFUHzzgyEagCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;"> After that, we need to select the folder where we want the Infiltrator file to be saved so that we can enable it later using the terminal.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-sKodoMFg8sQ/WpT4JmqYO5I/AAAAAAAAU5I/ajD8VQDji4cYFIdLeNNKaCL9MFae8rwDwCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Next, we will give the path of the folder where the infiltrator file will be saved as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-dM3CQmXEaC0/WpT4MKNKK5I/AAAAAAAAU6U/9rrdYnVVyCU19IALoJgvHA3ViKouf4ZVwCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Than the Burp Infiltrator file will be saved as <strong>burp_infiltrator_java.jar. </strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/--VpC3v6DtL0/WpT4MX3NZpI/AAAAAAAAU6I/nEXdFvlz9iE_XHvX0auIhImBGoezdi8XQCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Now to enable the burp infiltrator file we will go to the path of the file using the terminal, then to execute it we need to give the command <strong>java –jar burp_infiltrator_java.jar –non-interactive</strong>. Then Press<strong> Enter </strong>the file will be executed.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TtmzyKukCV0/WpT4MhCseqI/AAAAAAAAU6Q/HingZATWVswUXLiTyPO-Aam29Lgyj7BvQCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We have used <strong>–non-interactive</strong> in our command so that it will automatically configure the default settings else we have to manually configure all the settings. Now we can <strong>intercept</strong> the request of any <strong>website or application</strong> based on the supported parameters as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-T-Zc6W6ALwE/WpT4M8mWiiI/AAAAAAAAU6M/nQCRRcB2Mr0mEZfVpCvIzAGqRo-aVG6NwCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;"><strong>Turn off the Intercept Tab. </strong>Select the <strong>Target Tab </strong>where we can see a SubTab in it as <strong>Site Map </strong>as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-5snMclys4X8/WpT4NPIkVwI/AAAAAAAAU6Q/T8hLOra46HQsYSy9_RqhMImrzQkx8RDSACEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Then select the <strong>Url </strong>you want to scan using burp infiltrator, just <strong>Right click</strong> on the Url then select option <strong>Actively scan this host </strong>this will give all the issues related to the Website or application we want to scan. All the Issues related to the <strong>Url scanned </strong>can be seen in the <strong>Issue box </strong>as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-DpdlzwXwNCY/WpT4NGyWwLI/AAAAAAAAU6Q/FihaC_D7KM86e6iGkd4jPUuMup0CCiLQACEwYBhgL/s1600/8.png"/></span></p>
<h3><span style="color: #800000;"><strong>Macros</strong></span></h3>
<p><span style="color: #000000;">Burp suite has a new session handling ability which can be used to run macros, according to session handling rules. A macro can be said as a predefined sequence of one or more than one request. The cases in Macros may include:</span></p>
<ul>
<li><span style="color: #000000;">Fetching a page such as a user’s home page just to check whether the current session is still valid or not.</span></li>
<li><span style="color: #000000;">By performing a login operation to obtain a new valid session.</span></li>
<li><span style="color: #000000;">A token or nonce obtained can be used as a parameter in another request.</span></li>
</ul>
<p><span style="color: #000000;">The Macros can be recorded using your browser. When defining a macro, Burp suite displays the Proxy history, from which you can select the requests to be used for the macro. You can select from previously made requests, or record a fresh macro and select the new items from the history. When you have recorded the macro, the macro editor shows the details of the items in the macro, which you can review and configure as per requirement.</span></p>
<p><span style="color: #000000;">Let’s start!!</span></p>
<p><span style="color: #000000;">First, we have intercepted the login request of <strong>Bwapp Lab</strong> where we have given the default username and password as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-5ckS1Ric9bM/WpT4NgB0XQI/AAAAAAAAU6U/CFMz9q9_MREsEJqZMCf6LQT_apHX4JvMgCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">The request is captured in the <strong>Intercept Tab </strong>then Right Click anywhere around the captured request, next we need to select the option <strong>Do Intercept</strong> which has a sub-option <strong>Response to this request. </strong>Click on it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-uBi3UMfZFYk/WpT4GmFdTrI/AAAAAAAAU6Q/k-6WCsMiLEwi1OTueQ5hdhyb_m3a5RG6QCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Then we have forward the captured request until we are successfully logged into the <strong>Bwapp Lab. </strong></span></p>
<p><span style="color: #000000;">After that go to Project options Tab where we need to select the Sessions Tab as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-y9Bc-Siu7bc/WpT4G5GnOoI/AAAAAAAAU6I/O-ZHPSK1zz47O5bcXxThvHuPwqjm9ZGSgCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Click on <strong>Add Button </strong>under the <strong>Session Handling Rules </strong>which will open a <strong>Session handling rule editor window </strong>where we have given a name to the Rule under the <strong>Rule description </strong>as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-q-eeRobG-Bw/WpT4H1FqgEI/AAAAAAAAU6M/ZX2C50Gavxo9i1HKbae_pOgAR5GciGuHACEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Click on <strong>Add Button </strong>under <strong>Rule Action</strong> then select <strong>Check session is valid</strong> option which will open a window for <strong>Session handling action editor </strong>then give an expression you want the burp suite to look up in the <strong>Url </strong>like we have given <strong>login.php </strong>and <strong>Tick</strong> the option <strong>If session is invalid, perform the action below</strong> as shown in the image. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-y5b9Zhn7kl0/WpT4H4g2xKI/AAAAAAAAU6E/eqlYkZ2wr3wFHObBYz-s5LAfeRESEoMdACEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Click on <strong>Add Button </strong>under Select <strong>Macro</strong> which opens a window of <strong>Macro Recorder</strong> where we will select the item from the proxy history that we want to include in the Macro as shown in the image, Click Ok.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hn351wDi5Bs/WpT4IIKOGlI/AAAAAAAAU6Q/1xx_cg54RFoo8OsaMH0GiQhoRcHvylN9ACEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Next, the <strong>Macro Editor</strong> window will open where we will give a name to the macro in the <strong>Macro description field</strong> as shown in the image. Click Ok.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-tJmfLfO0OOk/WpT4Iv-5tMI/AAAAAAAAU6I/XQ0xmNk5Qjs8s14hEPdD5VkBffcE2wkvwCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">After this we will get back to <strong>Session handling rule editor</strong> where we will click on the <strong>Scope tab </strong>then we need to tick the options <strong>Extender</strong>, <strong>Proxy</strong> under <strong>Tools Scope</strong> and <strong>Include all URL’s</strong> under <strong>URL Scope</strong>, Click Ok now the macro will be running in the background.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-lapn4Yugo8I/WpT4Itl9i0I/AAAAAAAAU6I/oNV7fAkhQ3IwQ5zwtgaIeEoX2EA20G0IQCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">As you can see in the image we are on the login page of the Bwapp Lab where we have not given any login details.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-OSF3Gt1gLD0/WpT4I65E5fI/AAAAAAAAU6M/Tf0r1BflEe4QHqkA76tkyx8ovtcGo5UfACEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">We made a simple change in the <strong>URL</strong> we replaced <strong>login.php</strong> with <strong>portal.php</strong> as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-GzQ350mk98U/WpT4JM35ClI/AAAAAAAAU6I/bAV-jYbVbuczQozNcbk_mwFQuHZUUFbAACEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">This has successfully logged us into <strong>Bwapp</strong> Lab without giving any login details.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-gFhtd4nNaQA/WpT4JZkdzII/AAAAAAAAU6E/4JSYpacVwIQDiGExtcLrXFFQKgK9llU9gCEwYBhgL/s1600/20.png"/></span></p>
<h3><span style="color: #800000;"><strong>Burp Clickbandit</strong></span></h3>
<p><span style="color: #000000;">Burp Clickbandit option in burp suite is a tool used for generating <strong>clickjacking attacks</strong>. When you know a web page that is vulnerable to clickjacking, we can use Burp Clickbandit to create an attack and to confirm the vulnerability can be successfully exploited. When running Burp Clickbandit on untrusted websites. Malicious JavaScript from the target site can take the authority of the HTML output that is generated by Burp Clickbandit. There are two modes in Burp Clickbandit as follows:</span></p>
<p><span style="color: #000000;"><strong>Record Mode</strong></span></p>
<p><span style="color: #000000;">Burp Clickbandit first opens in record mode. Then we need to perform one or more mouse clicks to record your clickjacking attack, as this will involve performing the mouse clicks that the victim user needs to perform for making some desired action. We can also use the “disable click actions” checkbox to record clicks without the target page handling them. When you have finished recording, click the “Finish” button to enter review mode.</span></p>
<p><span style="color: #000000;"><strong>Review Mode</strong></span></p>
<p><span style="color: #000000;">When you have finished recording your clickjacking attack, Burp Clickbandit enters into review mode. This lets you review the generated attack, with the attack user interface over the original page UI. You can click the buttons on the attack UI to verify that the attack works.</span></p>
<p><span style="color: #000000;">List of commands that are available in review mode:</span></p>
<ul>
<li><span style="color: #000000;">+ And – buttons are used to zoom in and out.</span></li>
<li><span style="color: #000000;">The “toggle transparency” button allows you to show or hide the original page UI.</span></li>
<li><span style="color: #000000;">The “reset” button restores the generated attack, as it was before any further clicks were made.</span></li>
<li><span style="color: #000000;">The “save” button is used to save an HTML file containing the attack. This can be used as a real-world exploit as clickjacking vulnerability.</span></li>
<li><span style="color: #000000;">You can use the keyboard arrow keys to reposition the attack UI over the original page UI, if not correctly aligned with the original page UI.</span></li>
</ul>
<p><span style="color: #000000;">Let’s start!!</span></p>
<p><span style="color: #000000;">Burp Clickbandit runs on the browser using JavaScript. It can work on all latest browsers except for Microsoft IE and Edge.</span></p>
<p><span style="color: #000000;">To run Clickbandit, go to the Burp menu and select “Burp Clickbandit”.</span></p>
<p><span style="color: #000000;">Click the “Copy Clickbandit to clipboard” button. This will copy the Clickbandit script to your clipboard.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-iIpJhjhKxyg/WpT4Jqd7aVI/AAAAAAAAU6I/ikS-PGIyE9YS-tVW5e-3Kw8A7Wh3frrlACEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">In your browser, visit the web page that you want to test, in the same way, we regularly do. Then in your browser, open the web developer console. This might also be called “developer tools” or “JavaScript console”. Paste the Clickbandit script by <strong>editing allow pasting</strong> before pasting copied code into the web developer console, and press enter.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Lnib0XoueJg/WpT4KBmgnTI/AAAAAAAAU6M/VXHgW-s41zAMNI5A_7lPkzYX0zmYczEQwCEwYBhgL/s1600/22.png"/></span></p>
<p><span style="color: #000000;">The Burp Clickbandit Logo will appear at the top of the browser window and the original page will be loaded within the frame which readies for the attack to be performed, this is said to be the record mode of burp clickbandit. Then we need to perform one or more mouse clicks to record your clickjacking attack, as this will involve performing the mouse clicks that the victim user needs to perform for making some desired action. We can also use the “disable click actions” checkbox to record clicks without the target page handling them. When you have finished recording, click the “Finish” button to enter review mode.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UvG3EcVGaSM/WpT4Km27QrI/AAAAAAAAU6Q/968zXcp7X3c--GvA2eCduXPZttmxy4amgCEwYBhgL/s1600/23.png"/></span></p>
<p><span style="color: #000000;">When you have finished recording your clickjacking attack, Burp Clickbandit enters into review mode. This lets you review the generated attack, with the attack user interface over the original page UI.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-GYj-I6aa_Ok/WpT4KzuJocI/AAAAAAAAU6U/FAVFM1ryxNYMSKOTIKoJzG0qI8UGKUYBQCEwYBhgL/s1600/24.png"/></span><span style="color: #000000;">Click on <strong>Save Button</strong>, allows you to save an html file containing the attack. This can be used as a real-world exploit as clickjacking vulnerability.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ysxXid1d95c/WpT4KiPvHeI/AAAAAAAAU6U/TyyqknNv8f4yrtKC-zqSM1vCEQHRlZvvwCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">We have opened the saved html file which shows a transparent UI we have created over the original UI with a click button in the red box appearing on the page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-qslfmcpFCd0/WpT4LgpsiXI/AAAAAAAAU6E/z-rhd03SadQhwagr0dGf2OOOkkCS6mPFgCEwYBhgL/s1600/26.png"/></span></p>
<p><span style="color: #000000;">We can click the buttons on the attack UI to verify that the attack works. A message will appear the, you’ve been clickjacked as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ug5zP7oS83c/WpT4MLs3DqI/AAAAAAAAU6I/bAvl7O5Dt885G4cJSlXmWXfoOVZ-5iQGwCEwYBhgL/s1600/27.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Ashray Gupta is a Researcher and Technical Writer at Hacking Articles<strong>. </strong>He is a certified ethical hacker, web penetration tester and a researcher in nanotechnology. Contact</span> <a href="https://www.linkedin.com/in/ashray-gupta-b77221b6/"><strong>Here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
<!-- YARPP Thumbnails -->
<h3>Related posts:</h3>
<div class="yarpp-thumbnails-horizontal">
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/burpsuite-for-pentester-logger/" title="Burp Suite for Pentester: Logger++">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">Burp Suite for Pentester: Logger++</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.hackingarticles.in/burpsuite-for-pentester-autorize/" title="Burp Suite for Pentester: Autorize">
<span class="yarpp-thumbnail-default"><img src="https://www.hackingarticles.in/wp-content/plugins/yet-another-related-posts-plugin/images/default.png" alt="Default Thumbnail" data-pin-nopin="true"/></span><span class="yarpp-thumbnail-title">Burp Suite for Pentester: Autorize</span></a>
</div>
</div>
            </div><!-- .entry-content -->
            <footer class="post-footer entry-footer">
                                                
            </footer><!-- .entry-footer -->
            
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://www.hackingarticles.in/nmap-for-pentester-timing-scan/" rel="prev">Nmap for Pentester: Timing Scan</a></div><div class="nav-next"><a href="https://www.hackingarticles.in/understanding-guide-mimikatz/" rel="next">Understanding Guide to Mimikatz</a></div></div>
	</nav>        </div>
