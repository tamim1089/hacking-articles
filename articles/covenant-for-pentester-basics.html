<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Covenant for Pentester: Basics</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/covenant-for-pentester-basics/" rel="bookmark"><time class="entry-date published" datetime="2021-06-29T09:26:51+00:00">June 29, 2021</time><time class="updated" datetime="2025-05-10T20:52:45+00:00">May 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="" data-start="287" data-end="508"><span style="color: #000000;">This article will showcase the installation, process for compromising a Windows Machine. Additionally, it will demonstrate the various attacks and tasks that users can perform on that compromised machine through Covenant.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Introduction</strong></span></li>
<li><span style="color: #000000;"><strong>Installation</strong></span></li>
<li><span style="color: #000000;"><strong>Creating Listener</strong></span></li>
<li><span style="color: #000000;"><strong>Creating Launcher</strong></span></li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span></li>
<li><span style="color: #000000;"><strong>Post-Exploitation</strong></span>
<ul>
<li><span style="color: #000000;"><strong>Task: Screenshot</strong></span></li>
<li><span style="color: #000000;"><strong>Task: Process-List</strong></span></li>
<li><span style="color: #000000;"><strong>Task: Mimikatz: SAM Dump</strong></span></li>
<li><span style="color: #000000;"><strong>Task: Key Logger</strong></span></li>
<li><span style="color: #000000;"><strong>Task: Shell Commands</strong></span></li>
<li><span style="color: #000000;"><strong>Task: Port Scan</strong></span></li>
<li><span style="color: #000000;"><strong>Task: Directory Listing</strong></span></li>
<li><span style="color: #000000;"><strong>Task: Download Files</strong></span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Taskings</strong></span></li>
<li><span style="color: #000000;"><strong>Data: Credentials</strong></span></li>
<li><span style="color: #000000;"><strong>Creating Users</strong></span></li>
<li><span style="color: #000000;"><strong>Conclusion</strong></span></li>
</ul>
<h3><span style="color: #800000;">Introduction</span></h3>
<p class="" data-start="510" data-end="972"><span style="color: #000000;">Covenant is a .NET Command and Control Framework that the creators designed to target the invade the .NET surface and provide the ability to go offensive. Moreover, it provides a collaborative C2 platform for performing Red Team Assessments. The developers built Covenant in ASP.NET Core. As a result, it provides a cross-platform application that also has an interactive interface. This interface handles multiple users and users can access it on a Web Browser.</span></p>
<p><span style="color: #000000;">In our Red Teaming articles, we have covered a huge array of Command-and-Control Frameworks. There is no shortage of these frameworks, but we always seem to be getting back to some of our reliable frameworks. Hence, when we used and tested Covenant, it felt that this is one of the frameworks that can be a default choice to many users. The things that we admired about the Covenant are:</span></p>
<p><span style="color: #000000;">Multi-User Support: The ability to provide a platform for collaborating data from multiple users is a key to a successful Red Team Assessment.</span></p>
<p><span style="color: #000000;">Interface: The ease and the clean interface that it provides is not only easy to learn and master but provide the data required at demand. The ability to operate the Server from a Web-Based interface has made it easier to use as well as provide independence to the Red Teams to be platform-independent.</span></p>
<p><span style="color: #000000;">Profiles: The ability to make the listeners into profiles provides control to the attacker between various implants and listeners.</span></p>
<h3><span style="color: #800000;">Installation</span></h3>
<p><span style="color: #000000;">We will begin the installation of Covenant by first cloning all the files from the official Covenant GitHub.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone --recurse-submodules https://github.com/cobbr/Covenant</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-uVwnkxcQuNo/YNripWTD52I/AAAAAAAAw-4/dF422L1MiS8m4Ugyu3YQtRk5tifcHhPqQCLcBGAsYHQ/s16000/1.png"/></p>
<p><span style="color: #000000;">We cloned the repository into a directory named Covenant. Moving into it there are multiple methods to install. We will use the docker methodology as it requires very few configurations from our end. We will build the application on docker as demonstrated below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd Covenant/Covenant
docker build -t covenant .</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-UuSWisSOsJQ/YNritUSQE3I/AAAAAAAAw-8/90wHB83ml48GrhUbVyHwuSR_7stydFrdwCLcBGAsYHQ/s16000/2.png"/></p>
<p><span style="color: #000000;">After building Covenant, we now have to run the container. Here, we will specify the local ports that the container should use to run the application. Here we need to provide the absolute path to the Covenant on your machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">docker run -it -p 7443:7443 -p 80:80 -p 443:443 --name covenant -v /root/Covenant/Covenant/Data:/app/Data covenant</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-L12kCTklbaQ/YNrixQUl4jI/AAAAAAAAw_A/S4idLsTmpMk0sW89CZ0MD0tioCU9fJi8ACLcBGAsYHQ/s16000/3.png"/></p>
<p><span style="color: #000000;">Since our docker container is up and running we can access the Covenant Framework using the web browser. It starts on port 7433 since we mentioned this port while running docker in the previous stage. Upon the first try, it will ask the user to create an account with a username and password.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-EyBkXUzpxrI/YNri1IT_MxI/AAAAAAAAw_E/21PmLzWeVZIs-fjRD7DeZpSD6rSo33HswCLcBGAsYHQ/s16000/5.png"/></p>
<h3><span style="color: #800000;">Creating Listener</span></h3>
<p class="" data-start="229" data-end="452"><span style="color: #000000;">After creating the user and logging in to the said user, we see that the framework is neatly categorized between sections and menus. It includes a left-hand side menu. This is where we are first introduced to the Listeners.</span></p>
<p class="" data-start="454" data-end="681"><span style="color: #000000;">Creating a Listener is not at all difficult. According to its default configurations, the HTTP listeners listen to the interfaces on the machine. To begin creating one, we just need to click on the Create button as shown below.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ash6Xp9moKg/YNri5YmBYRI/AAAAAAAAw_I/OECTLxGUkLwfFlGBsJSAbkun9SLT5T7igCLcBGAsYHQ/s16000/6.png"/></p>
<p><span style="color: #000000;">As discussed, the Listeners listen to the HTTP protocol and the attacker can name them as per their wish. We are going to create one by the name of Ignite for now. We choose the Bind Address as 0.0.0.0 as it is the default. The Bind Port is also left default i.e., 80.  The Connection port has been set to 80. We need to provide a ConnectAddress, it is important while performing a Red Team Assessment since you would require to set up the C2 environment. There is an option to set the HTTPProfile. This can administer how the network requests will interact with the Covenant. After filling in all the details, click on the Create button.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-QEIuuwDP_ms/YNri9Wd_fxI/AAAAAAAAw_M/HbagH8n1pH0BtAnwm2N66WwuUSgJEWXkwCLcBGAsYHQ/s16000/7.png"/></p>
<p><span style="color: #000000;">Now the Listener Section should reveal the listener that we just created. The Name can be clicked on to access the details of the listener.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Jfu8O28jz5E/YNrjC2Gu7WI/AAAAAAAAw_U/_KfE7eikTMwctgzOpUrlpsVqo6x5WvaKQCLcBGAsYHQ/s16000/8.png"/></p>
<h3><span style="color: #800000;">Creating Launcher</span></h3>
<p><span style="color: #000000;">Next, we require Launcher. The launcher is the payload that will execute and connect to the target while hosting the stager to establish the connection with the target machine. The available Launchers are wide-ranging from MSBuild to CScript. To perform a simple demonstration in our native environment, we ill are using a Binary Launcher.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-mDSg7qKP4oc/YNrjHgtt8xI/AAAAAAAAw_Y/urFh8VDjQz8W3JBsNeTVw2GV1YwZVtxdwCLcBGAsYHQ/s16000/9.png"/></p>
<p><span style="color: #000000;">As soon as we click on Binary Link in the previous stage we are provided with the form where we can configure the Launcher as per our requirement. We provide the Listener from the drop-down menu that we created.  Toggling the Dot Net Version is available for the attacker. There are other options if the attacker wants to use Certificate Pinning and the amount of delay should be accepted by the launcher with the Jitter Percentage. There is also the option to schedule a Kill Date for the launcher which could come in handy.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-R1UWM__ImMA/YNrjQS-hDrI/AAAAAAAAw_k/glI3Us8oUooofJN5YgywlRiZygsGEnZmACLcBGAsYHQ/s16000/10.png"/></p>
<p><span style="color: #000000;">We provide all the required options and click on the Generate Button and Download button to download the Launcher to our local machine. As we can see that we have an executable created by the Name of GruntHTTP.exe. We can rename it before downloading as per our requirement.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-VNHdInEGe2E/YNrjUst_EYI/AAAAAAAAw_s/XEW2kDSTeNQvh0OuY-lItaQsM6IA8BPEACLcBGAsYHQ/s16000/11.png"/></p>
<h3><span style="color: #800000;">Exploitation</span></h3>
<p><span style="color: #000000;">We download the executable to our Local machine so that we can transfer the launcher to the target machine and execute it to get a session back to our Covenant Session.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-8yXDKKoYwuY/YNrjb4w_I_I/AAAAAAAAw_w/tR-rI3VfpU0mL2BlNXWkce7sfiJpqM2eACLcBGAsYHQ/s16000/12.png"/></p>
<p><span style="color: #000000;">We are not covering the method to use for transferring the launcher to the target and execution since there are endless methods to do so and you can choose your preferred method to do so. But as soon as the launcher is executed, we have what the Covenant calls Grunts and we call agents in PowerShell Empire or Session in simpler terms. The Grunt section will have the Name, Hostname, User, and other information regarding the particular grunt.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-yH5caIR2P8Y/YNrj14JPFXI/AAAAAAAAw_8/4IYDuPXzAsQxIg-sL6vSrKBIOavXGLrnwCLcBGAsYHQ/s16000/14.png"/></p>
<p><span style="color: #000000;">Upon clicking the Grunt Name from the Grunt Section, we have detailed information about the target and among other things, we have some activities that we can perform. The Info tab shows the information about the target, then the Interact Tab provides the ability to interact with a grunt. Then we have the Task tab to perform various predefined tasks on the target machine and at the list, we have the Taskings that have a detail about the various tasks performed on the target.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-y1HUOyQfliw/YNrj5xCTdxI/AAAAAAAAxAA/Q4yPz8A4VCMdHCo8n2UTW8DZ4NpCzCA5ACLcBGAsYHQ/s16000/16.png"/></p>
<h3><span style="color: #800000;">Post-Exploitation</span></h3>
<p><span style="color: #000000;">We click on the Interact Tab to find a CLI interface that can be used to interact with the target with a set of predefined commands. We find the list of commands to learn using the help command.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-egOmZz0p1OY/YNrj95TG5KI/AAAAAAAAxAE/tgO6PMfN4KU282wtUgLZQ75YOXL-hcteACLcBGAsYHQ/s16000/18.png"/></p>
<p><span style="color: #000000;">Among the various command that we can perform on the target, we decide to perform the Screenshot first. As soon as we run the command, we see the screenshot image captured and shown in the CLI itself as demonstrated.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-bmVjSKVKUP0/YNrkDKt6ZrI/AAAAAAAAxAI/BK0V1uNxWOcMqjnxhmZzw-LftY0m1uYugCLcBGAsYHQ/s16000/19.png"/></p>
<p><span style="color: #000000;">The next command on our list was to check out all the various tasks that are supposedly running on the target machine at the moment. We use the ProcessList command for extracting this information. We see that we have the details of various tasks such as the Process ID, Name, Session ID, and Owner of the process.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-wkJEQv9kGwA/YNrkHJhHq0I/AAAAAAAAxAM/32xgyy20G9Y6a-jRkaJ22A6eIiIoml_eACLcBGAsYHQ/s16000/20.png"/></p>
<p><span style="color: #000000;">The Covenant is integrated with Mimikatz. This means that we have all the functionality of Mimikatz without the hassle that comes with it. To demonstrate the ability, we use the SamDump command to activate Mimikatz and gather credentials from the SAM. We can see that we have the hash for the Administrator user on the target machine.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-DIA1Dd-MnIQ/YNrkLGvKi_I/AAAAAAAAxAU/ahB_HaskTGkmHX0nix25ROS94o3OqeojACLcBGAsYHQ/s16000/21.png"/></p>
<h4 data-start="1373" data-end="1430"><span style="color: #000000;">Executing Tasks and Downloading Files from the Target</span></h4>
<p><span style="color: #000000;">Next, we will be tracking the keystrokes on our target machine. We will use the Keylogger command for this task. It requires the time in seconds in which the keylogger will be recorded. We used the 120-second interval for the demonstration. As we can see that that the target user visits a website and enters their credentials which are logged and displayed to us.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-nKFPtkfOrns/YNrkaeotRPI/AAAAAAAAxAk/VhxQTYXNEk0C0j8pnwBziX7N5achLRiMgCLcBGAsYHQ/s16000/22.png"/></p>
<p><span style="color: #000000;">We are not limited by the command that is visible when we ran the help command. Run all the shell command on the target machine. To do this we will need to precede the command with the shellcmd command. Run the ipconfig command on the target machine as shown in the image</span>.</p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-ImWmvyZHyZ4/YNrkeq1N8VI/AAAAAAAAxAs/w4kIeOmwd7Yrjy4mcHzm5ToVaLuZkdjIQCLcBGAsYHQ/s16000/23.png"/></p>
<h4 data-start="2000" data-end="2044"><span style="color: #000000;">Performing Port Scans and File Transfers</span></h4>
<p><span style="color: #000000;">We move to the Tasks tab to see what are the various tasks that we can perform on the target machine. We see the list of various tasks in the drop-down menu labeled GruntTask. Select PortScan. Then, provide the Ports or range of Ports to test. We can disable Ping as well. After filling in all details, click on the Task button.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-g4aKHpWD35A/YNrkj8o3YoI/AAAAAAAAxAw/q0BEph4mx8cUAjnvvpO5Myqfb-iuVqJRwCLcBGAsYHQ/s16000/24.png"/></p>
<p><span style="color: #000000;">We get back to the Interact tab to see that a PortScan has been performed on the target machine. We see that there are two ports open on the machine: 445 and 3389.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-F8uwHqqnBrU/YNrkoTuwRfI/AAAAAAAAxA0/-9aaRwEhK3QEOyUXIRgGkKS9kJNCbHSfwCLcBGAsYHQ/s16000/25.png"/></p>
<h4 data-start="2533" data-end="2591"><span style="color: #000000;">Accessing and Extracting Files from the Target Machine</span></h4>
<p><span style="color: #000000;">The next task we can perform is List Directory.  It will list the content of the requested directory. It defaults to the current directory if no path is provided. We clicked on the Task button to perform the task on the target machine.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-gw2wcdrQ7WM/YNrkuYup6jI/AAAAAAAAxA4/Ygn6pGj7-Rc_N5KyKaircu5q645GURnRwCLcBGAsYHQ/s16000/26.png"/></p>
<p><span style="color: #000000;">As we can see that the current directory turned out to be the Downloads directory for the user Raj. We see the Size of files, Creation Time, and Last Accessed Time for various files and directories inside the selected directory.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-qEv0i1bbnFM/YNrkyWqWjZI/AAAAAAAAxBA/ZUtq_Yl-gR0k1p1SZ-K_H46UZlpzeMRMQCLcBGAsYHQ/s16000/27.png"/></p>
<p><span style="color: #000000;">After listing the contents, we found a particular file that we need to extract from the target machine. We can use the Download task to get that file transferred to our local machine. It requires the name of the file that we need to download. In our demonstration, we are downloading the Sysmon.zip file from the current directory.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-G1OhIH-lJv8/YNrk60KRrFI/AAAAAAAAxBM/4fHJI6k3KSQ-Znx5sYrE8xlFqTqA9AkeACLcBGAsYHQ/s16000/28.png"/></p>
<p><span style="color: #000000;">To access the file that we downloading, we need to move to the Data section of the Covenant Menu. Here we see the Downloads section under the Downloads Tab. We see the file name and size of the file that we requested. We have the Download button that will get the file to our local machine.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Me_v5BBanzM/YNrk_9jv6RI/AAAAAAAAxBQ/Z1hJjujjHMIaVpUFP2sHg1s1vCZLqS32ACLcBGAsYHQ/s16000/30.png"/></p>
<h3><span style="color: #800000;">Taskings</span></h3>
<p><span style="color: #000000;">Next, we move back to the Grunt from the menu and select the active grunt. Here we click on the Tasking tab to see the wide list of the tasks that we performed on the target machine. The various information includes the Name of the task, Name of the Grunt it was performed, Status of Task, Username for the task, and Command that was used to perform the task.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-COTizoTvJnk/YNrlFciMBoI/AAAAAAAAxBY/8R6eOwDkVvIYSk1jpwV_FDfCLYb8njwZwCLcBGAsYHQ/s16000/31.png"/></p>
<h3><span style="color: #800000;">Data: Credentials</span></h3>
<p><span style="color: #000000;">As we move onto the various data that is collected based on the commands that we run on the target machine. As we demonstrated earlier, we performed the SamDump task on the target. It grabs the credentials for various users on the machine. The data section collects all that information for the red teams to note.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-EVgXwncSIa8/YNrlKsfyfeI/AAAAAAAAxBc/3ygNPjn0v1sPe5z0a46w99rT5vhqlbh0ACLcBGAsYHQ/s16000/32.png"/></p>
<h3><span style="color: #800000;">Creating Users</span></h3>
<p><span style="color: #000000;">As we discussed in the Introduction, that we can create and manage multiple users on Covenant. This helps in management across various members of the team and collaboration in an effective way. We need to click on the Users Section from the Left-hand side menu. This opens up a form where we provide a username and password that we can use to log in.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-0OAMYWpFZ_4/YNrlP_fymUI/AAAAAAAAxBk/vi_Y68yuApE_99VbrnrS3oDHb0aV_x2vACLcBGAsYHQ/s16000/33.png"/></p>
<p><span style="color: #000000;">After filling up the information and clicking the Create button we see that there are two users now that can access the Covenant Framework. Those users are raj and aarti with raj users having administrative access.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-x0NNQYJsL3o/YNrlVzJvjmI/AAAAAAAAxBs/MF5dz4EbW9wgCnMnpudSBpXsVv6CesbyQCLcBGAsYHQ/s16000/34.png"/></p>
<h3><span style="color: #800000;">Conclusion</span></h3>
<p><span style="color: #000000;">As we saw that setting up Covenant or installing it is a very simple task of running a few commands and providing a docker instance. We also saw the process to create a listener and a Launcher. We performed a large array of tasks on grunt. This covers the basics of using this framework.</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Can be Contacted on</span> <strong>Twitter</strong> and <strong><a href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
