<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Moonraker:1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/moonraker1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-12-07T16:28:05+00:00">December 7, 2018</time><time class="updated" datetime="2025-06-10T20:11:54+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hack into the Moonraker system and discover who’s behind these menacing plans once and for all. Find and destroy the Villain before it’s too late. You’ve received intelligence of a new Villain investing heavily into Space and Laser Technologies. Although the Villain is unknown we know the motives are ominous and apocalyptic. The challenge is to get root on the Targeted Virtual Machine and read the flag.txt within that directory.</span></p>
<p><span style="color: #000000;">Download it from here: https://www.vulnhub.com/entry/moonraker-1,264/</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodology:</strong></span></h3>
<ul>
<li><span style="color: #000000;">Network Scanning (Netdiscover &amp; Nmap)</span></li>
<li><span style="color: #000000;">Web directory enumeration (Dirb)</span></li>
<li><span style="color: #000000;">Tail off apache2 access logs.</span></li>
<li><span style="color: #000000;">Browsing through discovered directories.</span></li>
<li><span style="color: #000000;">Finding Login Credentials for CouchDB’s Login.</span></li>
<li><span style="color: #000000;">Fauxton Login Page Link.</span></li>
<li><span style="color: #000000;">Checking Various Directories over the browser.</span></li>
<li><span style="color: #000000;">Finding Login Credentials.</span></li>
<li><span style="color: #000000;">Logging into Node.js express framework.</span></li>
<li><span style="color: #000000;">Capturing Cookie using Burpsuite.</span></li>
<li><span style="color: #000000;">Using Node.js deserialization exploit for RCE.</span></li>
<li><span style="color: #000000;">Converting Decimal value to ASCII text.</span></li>
<li><span style="color: #000000;">Using a script to Convert ASCII text to Decimal value.</span></li>
<li><span style="color: #000000;">Base64 encoding using echo.</span></li>
<li><span style="color: #000000;">Getting reverse shell over netcat listener.</span></li>
<li><span style="color: #000000;">Converting Hash string using John the Ripper tool</span></li>
<li><span style="color: #000000;">Getting root access.</span></li>
</ul>
<ul>
<li><span style="color: #000000;">Reading the flag.</span></li>
</ul>
<p><span style="color: #000000;"><strong>Let’s Begin with the Walkthrough!!</strong></span></p>
<p><span style="color: #000000;">Let’s start off with scanning the network to find our targets IP.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-4ATFmWD7swc/XAqNTYmkQVI/AAAAAAAAbno/XptSBZg-srEyL4KqGIhCCgiU_ONH17BegCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">We found our target IP –&gt; <strong>192.168.1.110</strong></span></p>
<p><span style="color: #000000;">Our next motive is to scan the target IP with nmap.</span></p>
<pre class="lang:default decode:true">nmap -p- -A 192.168.1.110 --open</pre>
<p><span style="color: #000000;">The NMAP scan output shows various open ports: 22(ssh), 80(http), 110(pop3), 3000(http), 4369(epmd), 5984(couchdb).</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-72inhJAjX9Y/XAqNVaE3eNI/AAAAAAAAboE/VKHiYCjqkjEZqYW1AoVLzUa81hrFIfxlACLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">From the Nmap Scan output, we saw port 80 is open. Therefore we navigate to port 80 in the web browser. But it was not much of a help to move ahead.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-3sfdip7ZDWI/XAqNYJMsAXI/AAAAAAAAbo0/CC2SWSb6SKo_-AHX32xbOSTnno4nZd7nwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Now we thought of enumerating for accessible directories on the Target Machine with the help of the following command.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.110/</pre>
<p><span style="color: #000000;">After recursively enumerating, we found a useful directory <strong>/services </strong>as highlighted.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-2lsgZ-iRX3Y/XAqNZfCg9VI/AAAAAAAAbpI/PAJG_31wrD8l8pYWKuHTBlA5Q-0u5nYZwCLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Let’s just browse the found directory<strong> <em>/services</em></strong> in the browser where at bottom of the webpage we saw a <strong>SEND AN INQUIRY Hyperlink</strong>. Let’s find out where it will lead us by clicking on it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Z6gerUs76GA/XAqNZmyBvgI/AAAAAAAAbpM/0JTU7YpH6_ICMgY2VHF8lRVHf5E8LkM9gCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">So it opened a SERVICES INFORMATION REQUEST FORM as shown in the image. We noticed that someone will check our <strong>web-based enquiry</strong> and will contact us in under <strong>5minutes</strong>. This strikes us that some kind of logs will be made. But the question is where?</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-pEmA9qJi6LE/XAqNZ0PnzII/AAAAAAAAbpQ/xKyc9gAIP4w2BGWXAUr7jSWUtCa-P7PKwCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We have filled the enquiry form using the html code with an image tag as shown in the image.</span></p>
<pre class="lang:default decode:true  ">&lt;img src="http://192.168.1.109/1.txt"&gt;&lt;/img&gt;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-Nd3o9u8knMQ/XAqNaQQWOmI/AAAAAAAAbpY/E6mlf19Tk2wkBnoFKSkP4vHReuO5vrnfgCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">Before <strong>Clicking Submit to Sales Rep! </strong>We have restarted apache2 service because if any logs will be made, we can easily see them by accessing apache2 access.log. After clicking <strong>Submit, </strong>it has displayed thanks for your inquiry message as shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xPosgOizul0/XAqNaGTuXHI/AAAAAAAAbpU/mkp0g3N86voCxlGhcUFiMuGnnUgzWDorwCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">We have just tail off the access log of apache2 by using the command.</span></p>
<pre class="lang:default decode:true">tail -f /var/log/apache2/access.log</pre>
<p><span style="color: #000000;">The log formed exposed a new webpage as highlighted in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-LQOXvxViupg/XAqNaomPluI/AAAAAAAAbpc/A_kdWAaNJFQH7VwsPmO-7mekJovOes9VwCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Let’s just find out where the webpage is going to redirect us. For that, we opened it in the browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-dg7vEuCtVkg/XAqNTT9PLgI/AAAAAAAAbnk/mGgCYmF1TSIagEyMVPOX1U-WRunHLE3wQCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">So it leads us to <strong>the Sales Admin Interface</strong>. This looks interesting and might be holding some great clues.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-9wV6BP7y8lM/XAqNTSGMdsI/AAAAAAAAbns/LHAhP8xK4Mgmj4vYOuTSS5YkeeQ2TmgvwCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Next thing we opened <strong>CouchDB</strong> Notes and got some hints about Login Credentials for CouchDB Login that is Username: jaws and Password: jaws girlfriend name + x99. Here we Google for <strong>jaws girlfriends name</strong> which came out to be <strong>dolly</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-JKg0ULnRCmQ/XAqNT-R4J1I/AAAAAAAAbnw/lJGD7Y77drIUHY6-VBNUA5ZZdFOuScudQCLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">We will be requiring these found <strong>Credentials</strong> to log into <strong>Fauxton</strong> which is included in <strong>Apache CouchDB</strong>. To know more about <strong>Fauxton and CouchDB</strong> we have searched about them on google and find out a hint on how to open a CouchDB Login Page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-58RmFlGTVsI/XAqNULYiZ-I/AAAAAAAAbn0/THhTkjwzQpwIJ_dlqqdinR36UQbl3ekzACLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;"> Since port <strong>5984</strong> is open. We are able to open the <strong>CouchDB Login Page</strong>.</span></p>
<pre class="lang:default decode:true">192.168.1.110:5984/_utils/</pre>
<p><span style="color: #000000;"> Here we have used Login Credentials as follows:</span></p>
<pre class="lang:default decode:true">Username: jaws
Password: dollyx99</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-xXDMB0im8nE/XAqNUWRdO7I/AAAAAAAAbn4/qr9nxod_5eEoFDXacIBPIjlOIWxJ1QS2wCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;"><strong>Booyeah!!</strong> We have successfully logged in. Now let’s check out the docs inside these 3 databases.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-K7laHRwDS3U/XAqNUmy1GcI/AAAAAAAAbn8/d0p3gb8WNwA4ypl9Fqww2ic204HYO3tbwCLcBGAs/s1600/17.png"/></span></p>
<p><span style="color: #000000;">The <strong>link database</strong> came out to be useful. Looking through the documents inside the link database, since every document contains a directory <strong>link </strong>but the <strong>highlighted one</strong> might give us clue for our next step.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-QdZemvhTr0E/XAqNVDjrsyI/AAAAAAAAboA/bbLavMcT5qYifVbBUd776IZ2GXsvERZAwCLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">So the <strong>link</strong> we have found in the <strong>highlighted document</strong> is shown in the image. Let’s copy and open this link in the browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-V9Cb1nlFIaM/XAqNVYK_4cI/AAAAAAAAboI/MmJ1TDWb2IwH1sy5r_l3afwIJgcCCOyOwCLcBGAs/s1600/19.png"/></span></p>
<p><span style="color: #000000;">So the above link opened an <strong>OFFER LETTER ARCHIVE BACKUP WEBPAGE. </strong>This is interesting, let’s check out what’s hiding in these offer letters.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-8xh3sybqSsg/XAqNVesoWPI/AAAAAAAAboM/b6Qyy_B9cWc3kdA89JpLZ6fTbXlmQmWTwCLcBGAs/s1600/20.png"/></span></p>
<p><span style="color: #000000;">Woah!! All the <strong>offer letters</strong> contain a <strong>Username and Password</strong>. But the one we have used is shown in the image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-A0KvvOdSfTI/XAqNV7Osh5I/AAAAAAAAboQ/3lioW5ce-LMT37F4RLqJp82MzaNSY_qVwCLcBGAs/s1600/21.png"/></span></p>
<p><span style="color: #000000;">From the NMAP Scan output, we knew <strong>port 3000</strong> holds a <strong>Node.js framework</strong>. So we browse the Target IP on port 3000 on the browser and encountered a login portal. <strong>Credentials use to log in are as follows:</strong></span></p>
<pre class="lang:default decode:true">Username: hugo
Password: TempleLasersL2K</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-sWl0p_jvn4Y/XAqNWJkO4OI/AAAAAAAAboU/nVR5_Qu_7540sjoA1XZgIbut5aZJem9QgCLcBGAs/s1600/22.png"/></span></p>
<p><span style="color: #000000;">After successfully logging in, we have displayed a message shown in the image. This page seems of no use but after spending time figuring out what to do next it became very interesting.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-GduPMpbdPTk/XAqNWAhIm3I/AAAAAAAAboY/_GV1EzL2_vgzIkUJ4Bn4fr_Gz8PReo-TgCLcBGAs/s1600/23.png"/></span></p>
<p><span style="color: #000000;">Time to Launch <strong>Burp Suite</strong> and intercept the request of this page. After intercepting we saw a base64 encoded line in Cookie: profile as you can see in the image. Here we will be inserting node.js deserialization exploit in base64 encoded form. Let’s begin with the process.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-h7E0M9sWvEI/XAqNWbT0W0I/AAAAAAAAboc/J0E84JJ5u9QkFsRgfckN8dKB1r1qO7dlACLcBGAs/s1600/24.png"/></span></p>
<p><span style="color: #000000;">From the image, you can figure out that we will copy <strong>Node.js deserialization</strong> exploit for <strong>Remote Code Execution. </strong></span></p>
<p><span style="color: #000000;"><a style="color: #000000;" href="https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/">https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/</a></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-wJceTpZZPqo/XAqNWtkPA0I/AAAAAAAAbog/2UN99pDMbG89ao_yqpzvo8KjCL8gI5vlACLcBGAs/s1600/25.png"/></span></p>
<p><span style="color: #000000;">After copying it, let’s convert the Decimal value into ASCII text using a converter available online. And don’t forget to copy the ASCII text.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-S4FNq_avp94/XAqNXMLgO_I/AAAAAAAAbok/ccG5706GfRs-Q8B49vWfy2CjxybCd7t7wCLcBGAs/s1600/26.png"/></span></p>
<p><span style="color: #000000;">Using <strong>nano</strong>, we have created a file and pasted the <strong>ASCII text copied</strong>. Here we have given our <strong>Kali</strong> <strong>Linux</strong> <strong>IP</strong> in the host and set the <strong>port</strong> to <strong>1337</strong> just save it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-3mdI1lYx80w/XAqNXG8g5FI/AAAAAAAAboo/8Hg6m41P14Qjd-vvdDS50woejpNQBY5ZQCLcBGAs/s1600/27.png"/></span></p>
<p><span style="color: #000000;">So we have created a script <strong>exploit.py</strong> which will convert the ASCII text to Decimal value and it will also put <strong>COMMA i</strong>n between every Decimal value converted. Whereas we are using <strong>echo</strong> command to convert the <strong>Decimal value</strong> into <strong>Base64 encoded</strong> string. And copy the whole base64 string.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-KjaGQGtyXc0/XAqNXkaxjVI/AAAAAAAAbos/b-J6Z0aij6AHr8vAt5z2PC0ccFfYlZ72wCLcBGAs/s1600/28.png"/></span></p>
<p><span style="color: #000000;"><strong>Set</strong> the <strong>Copied base64</strong> <strong>string</strong> into <strong>Cookie: profile</strong> whose <strong>request is intercepted</strong> in the <strong>Burp suite</strong> and before forwarding the request just execute a netcat listener over port 1337.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-N6fmAoOwG9U/XAqNXtSMizI/AAAAAAAAbow/4Yv7kH4zCp4F-yeL3Zp3tKcPppKJPGixACLcBGAs/s1600/29.png"/></span></p>
<p><span style="color: #000000;">Therefore we got a reverse shell on our netcat listener. To spawn the shell we have used python bin bash shell.<strong> </strong></span></p>
<pre class="lang:default decode:true">python -c 'import pty; pty.spawn("/bin/bash")'</pre>
<p><span style="color: #000000;">After recursively enumerating we found four mailboxes in /var/mail but the problem is they lack of permissions. After knowing about CouchDB’s Configuration, we came across that CouchDB’s default installation directory is <strong>/opt/CouchDB </strong>and it reads the configuration file from this directory <strong>etc/local.ini.</strong></span></p>
<p><span style="color: #000000;">Let’s tail off the contents in local.ini.</span></p>
<pre class="lang:default decode:true">tail /opt/couchdb/etc/local.ini</pre>
<p><span style="color: #000000;">After running this command, it displayed another <strong>Login Credential</strong> as shown in the image.</span></p>
<pre class="lang:default decode:true">Username: hugo
Password: 321Blast0ff!!</pre>
<p><span style="color: #000000;">Then with the following command, we switch the user and logged in as user hugo.</span></p>
<pre class="lang:default decode:true">su hugo
password: 321Blast0ff!!</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/--UKFyX3ynUY/XAqNYtxvzCI/AAAAAAAAbo8/wr5jmPUSNeY4dYky977GxKaWEE_dfLFdwCLcBGAs/s1600/30.png"/></span></p>
<p><span style="color: #000000;">Reading the emails of Hugo, we were brought to notice that <strong>Message 2</strong> is interesting as it contains <strong>the password to root in the hash</strong> and also tells us to <strong>ADD ‘VR00M’</strong> after roots password. Time to crack the password, to do that we have copied the password and pasted inside a file named <strong>hash</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wHP2EDH0Kbo/XAqNYQdFTrI/AAAAAAAAbo4/sUAssaY2qj8DzWDki4OD6L28VJPunirDACLcBGAs/s1600/31.png"/></span></p>
<p><span style="color: #000000;">Therefore, John the Ripper tool cracked the hash password for root i.e</span></p>
<pre class="lang:default decode:true">Username: root
Password: cyber</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-5iothmZU_3U/XAqNY4ziz-I/AAAAAAAAbpA/0N6eyNp7vDwtTQzQAcSjjaS3goL_0aODACLcBGAs/s1600/32.png"/></span></p>
<p><span style="color: #000000;">Let’s again switch user and Login as root.</span></p>
<pre class="lang:default decode:true ">su root
Password: cyberVR00M</pre>
<p><span style="color: #000000;"><strong>Booyeah!!</strong> We have successfully logged in as root and while checking through its mail directory, we have found our <strong>flag.txt</strong> file. We take a look at the content of the file and greeted with a congratulatory message.  </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-Yaaijy4V4dQ/XAqNZCVnySI/AAAAAAAAbpE/tMTxaNI6fPAxGyJZC6m3nmoim0_mbMiawCLcBGAs/s1600/33.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Ashray Gupta is a Security Researcher and Technical Writer at Hacking Articles. Contributing his 2 years in the field of security as a Penetration Tester and Forensic Computer Analyst. Contact <strong><u><a style="color: #000000;" href="https://www.linkedin.com/in/ashray-gupta-b77221b6/">Here</a></u></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
