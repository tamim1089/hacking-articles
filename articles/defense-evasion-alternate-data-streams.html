<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/defense-evasion/" rel="category tag">Defense Evasion</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Defense Evasion: Alternate Data Streams</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/defense-evasion-alternate-data-streams/" rel="bookmark"><time class="entry-date published" datetime="2020-08-26T17:42:29+00:00">August 26, 2020</time><time class="updated" datetime="2025-05-13T07:48:04+00:00">May 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Alternate Data Stream is an artifact of New Technology File system (NTFS) which was introduced by Windows. It was traditionally introduced so that it could provide compatibility for file sharing with the older Hierarchical File system (HFS) of Macintosh systems where the data could be forked into different resources and to store additional data of a file which is called as metadata.</span></p>
<p><span style="color: #000000;">It was introduced for a legitimate purpose but the attackers have found a method to exploit this feature by hiding payloads, malware, keyloggers, etc in any type of file like text-file, audio -file, videos-video, images execute them without the knowledge of the users.</span></p>
<p><span style="color: #000000;">Many users still are unaware of this feature where there could be hidden files and could have malicious intent as these files are nearly impossible to be detected.</span></p>
<h3><span style="color: #800000;">Table of Contents</span></h3>
<ul>
<li><span style="color: #000000;"><strong>NTFS</strong></span></li>
<li><span style="color: #000000;"><strong>Alternate Data Stream</strong></span></li>
<li><span style="color: #000000;"><strong>Key Notes on Alternate Data Stream</strong></span></li>
<li><span style="color: #000000;"><strong>Hiding a file</strong></span></li>
<li><span style="color: #000000;"><strong>ADS with PowerShell </strong></span></li>
<li><span style="color: #000000;"><strong>NTFS to FAT</strong></span></li>
<li><span style="color: #000000;"><strong>Hiding an image in a text file</strong></span></li>
<li><span style="color: #000000;"><strong>Hiding Audio in a text file</strong></span></li>
</ul>
<h3><span style="color: #800000;">New Technology File System (NTFS)</span></h3>
<p><span style="color: #000000;">In the NTFS, all the allocated sectors in a volume are associated with a file. A file is composed of all the data within a file and that file’s metadata. The metadata usually comprises of items like file name, attribute type, attribute name, file security information etc. The file metadata and file data are considered as a combined set. The Master File Table contains the base file record for every file and directory within an NTFS volume apart from the other file details.</span></p>
<p><span style="color: #000000;">The name of the file and its timestamp is kept as resident attributes. If the attributes for a file cannot accommodate in the MFT file record, those file attributes are termed as a non-resident. These non-resident attributes are allocated to one or more clusters in the disk.  These clusters hence become the alternate data streams within the NTFS volume.</span></p>
<p><span style="color: #000000;">The default stream is unnamed and the default stream type in NTFS is $DATA.</span></p>
<p><span style="color: #000000;">NTFS stores file in the following format.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mDdj-NcUPiw/X0aYv0j5YjI/AAAAAAAAnvc/DucPeUFNuXgj1sthN4itVC8_H6L6K5JeACLcBGAsYHQ/s1600/0.1.png"/></span></p>
<h3><span style="color: #800000;">Alternate Data Stream</span></h3>
<p><span style="color: #000000;">Within NTFS, a file comprises of the various data stream. The primary data stream is an unnamed stream which actually contains the data of the file that is visible when we open this stream and hence it is called as the default stream. The second stream is usually the alternate data stream. A file can have more than one Alternate Data Streams for the various purpose which hold the metadata about the file. Any of the ADS files can have any malicious content within it which can be appended with the default stream. When you append an ADS file with a default stream file, there will be no change made to the size or the function of that file.</span></p>
<p><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-8mE4GoLv6Eo/X0aZuUgyIBI/AAAAAAAAnvk/_ovdPkl2Ef8MJdQTPHfGqZU-QP-12cBPgCLcBGAsYHQ/s1600/0.2.png" alt="Alternate Data Streams for Defense Evasion" width="831" height="347"/></span></p>
<p><span style="color: #000000;">Alternate data streams usually deal with file integrity within the server. A user will never be able to recognise an ADS file by just looking at it and if it comprises of any extra executable or text element within it. Alternate data streams generally deal with maintaining the confidentiality of the file that is being sent or are at rest on the system.</span></p>
<p><span style="color: #000000;">ADS can be used by the attacker to evade any defences such as static indicator scanning tools and anti-virus software that are implemented by the victim. It is a quite popular method used by attackers to cover their tracks on Windows systems with the use of ADS.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-59v9cVLaxSc/X0aZ37DF0TI/AAAAAAAAnvo/OsZuQ-Y8DI02E3rMXJw3TqZM1Rxqf09HQCLcBGAsYHQ/s1600/0.3.png"/></span></p>
<h3><span style="color: #800000;">Hiding a file</span></h3>
<p><span style="color: #000000;">So, here we are going to learn to make use of Alternate Datastream to hide a file using ‘command-prompt’ in your windows PC. To get you started, let’s start the windows system, and run command prompt as <strong>administrator</strong> so that these tasks can be performed.</span></p>
<p><span style="color: #000000;">Create a folder to locate your in-use files quickly. Here we have created a folder named <strong>jeenali</strong>.</span></p>
<p><span style="color: #000000;">Now make use of <strong>cd</strong> command to lead you to the path of your folder</span></p>
<p><span style="color: #000000;">Here, we are making use of .txt file as our primary stream to demonstrate ADS, you can use any file of your preference.</span></p>
<p><span style="color: #000000;">A .txt file is created and to add content in the file we can used the command;</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo Welcome to ignite Technologies &gt; jeenali.txt</pre>
<p><span style="color: #000000;">To display the contents of your .txt file, you can use;</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">type jeenali.txt</pre>
<p><span style="color: #000000;">To display the contents in the folder including Alternate Datastream, we use</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dir /r</pre>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-FtAwH3Kstxw/X0aaADh63oI/AAAAAAAAnvw/uhjBbIv3IyEMtyB-na5yg_nZRuIBdxXkACLcBGAsYHQ/s1600/1.png" alt="Alternate Data Streams for Defense Evasion" width="668" height="300"/></span></p>
<p><span style="color: #000000;">In the above image, you can see that there is no hidden file displayed.  On directly visiting the GUI of the folder, you see that there is only one file. So now we will move to adding a hidden file in the folder.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rmkD0KQPNTM/X0aaNZxlptI/AAAAAAAAnv0/30gOUIY2pkI75ZBfNVVWmEJ3aftOPnoIACLcBGAsYHQ/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Here we will proceed with creating a hidden file. A .txt file is created with hidden ADS and to add content in the file we can used the command;</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo Join Our Training Programs &gt; jeenali.txt:hidden</pre>
<p><span style="color: #000000;">To display the contents of your newly created .txt file, you can use;</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">type jeenali.txt: hidden</pre>
<p><span style="color: #000000;">Here you see that the filename is not recognised, therefore, to see hidden file content, you can type;</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">more &lt; jeenali.txt:hidden</pre>
<p><span style="color: #000000;">To display the contents in the folder including Alternate Datastream, we use;</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dir /r</pre>
<p><span style="color: #000000;">Here we see that the ads are seen is also displayed.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6slVuR7qulo/X0aaUjlP5uI/AAAAAAAAnv8/42dPvuCQI7A2QvmRFskiC3ATZK-qVduKQCLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">To open the file and see the contents of the hidden file you can use</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">notepad .\jeenali.txt:hidden</pre>
<p><span style="color: #000000;">here see can notice a notepad file prompts open and the contents are displayed.</span></p>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-9ix4rUxbG0M/X0aaeIn8d-I/AAAAAAAAnwE/uHyUmwbVpL8t07qmXGl2lLcSXX59qq6aACLcBGAsYHQ/s1600/4.png" alt="Alternate Data Streams for Defense Evasion" width="561" height="179"/></span></p>
<h3><span style="color: #800000;">ADS with PowerShell </span></h3>
<p><span style="color: #000000;">Let’s begin running PowerShell as an <strong>administrator</strong></span></p>
<p><span style="color: #000000;">A .txt file is created with hidden ADS and to add content in the file we can used the command;</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo Welcome to Hacking Articles! &gt; raj.txt</pre>
<p><span style="color: #000000;">Now to create an ADS file, add content and hide it you can use;</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Set-Content .\raj.txt -stream text
Hello World</pre>
<p><span style="color: #000000;">We can see the hidden ADS content using</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Get-Content .\raj.txt -stream text</pre>
<p><span style="color: #000000;">But when you use the dir command, you cannot see your hidden file</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dir</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-E8QQKrgyV4o/X0aalnS5hYI/AAAAAAAAnwM/-x3L4fhUr0Y4XbE2nULQPEYaVJeEWto4QCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">To see all the files in the directory you can use</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Get-Item -path .\raj.txt -stream *</pre>
<p><span style="color: #000000;">Here you can see the primary .txt as well as the newly created ADS .txt .</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-5Ztxa8RMz8g/X0aat1AZ_DI/AAAAAAAAnwQ/Pl0Sl9B6eG0ekLKvd2tPJVjsB7DeLLS3gCLcBGAsYHQ/s1600/8.png" alt="Alternate Data Streams for Defense Evasion" width="799" height="440"/></span></p>
<h3><span style="color: #800000;">NTFS to FAT</span></h3>
<p><span style="color: #000000;">If you transfer an ADS file from NTFS to FAT32 you will be automatically destroying the Alternative Data Stream.</span></p>
<p><span style="color: #000000;">Here, an ADS file was created in an NTFS system but as soon as it is transferred to a FAT32 flash drive, you see the below prompt which won’t allow you to copy the file with ADS. This is because the ADS feature was introduced in NTFS and FAT32 does not support it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-eJD7zvsAKkc/X0aa05yrbzI/AAAAAAAAnwY/HVVK7gqdI4MlDEaL9szjB_4GqzYUNpmVQCLcBGAsYHQ/s1600/9.png"/></span></p>
<h3><span style="color: #800000;">Hiding an image in a text file</span></h3>
<p><span style="color: #000000;">So, let us start a command prompt as an administrator and change our directory to the folder in which we have our files. To check the contents of the file, type</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">C:\Users\raj\Desktop\ads&gt; dir</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FIuh193D3bE/X0aa9U79oHI/AAAAAAAAnwg/bc2WlAqJWFAK7zLh7i7kSKUBooTQk1gQwCLcBGAsYHQ/s1600/10.png"/></span></p>
<p><span style="color: #000000;">You see that there are two files (one is a text-primary stream and other is an image file). So Now we will append the image file to the text file using;</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">type panda.jpg &gt; jeeni.txt:panda.jpg</pre>
<p><span style="color: #000000;">After we are done with appending the primary stream file, we will delete the image file from the folder.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">del panda.jpg</pre>
<p><span style="color: #000000;">Now, you will see that the image file is gone but a new ADS is created and you can check it using</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dir /r</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-zJLMgzsvTPs/X0abEYJxY5I/AAAAAAAAnwo/4B1ldPi2lv0Y8EK6YJnrmlTAqOVh6PwdACLcBGAsYHQ/s1600/11.png" alt="Alternate Data Streams for Defense Evasion" width="539" height="311"/></span></p>
<p><span style="color: #000000;">Change the directory to system 32, and you can see that your image file is executed when you open the text file which has ADS appended.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">C:\Windows\system32&gt;
mspaint.exe C:\Users\raj\Desktop\ads\jeeni.txt:panda.jpg</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-F_0ctmKcwrc/X0abN4oA_0I/AAAAAAAAnw0/djwXJCDmk_coqU8qWhJREKiOQLikiiEDgCLcBGAsYHQ/s1600/12.png"/></span></p>
<h3><span style="color: #800000;">Hiding Audio in a text file</span></h3>
<p><span style="color: #000000;">Now, we can start a command prompt as an administrator and change our directory to the folder in which we have our files. To check the contents of the file, type</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">C:\Users\raj\Desktop\ads&gt; dir</pre>
<p><span style="color: #000000;">You see that there only a text file and an audio file.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KtpmjAt5wKI/X0abVYsmRkI/AAAAAAAAnw8/5sItRh9o6g8R3JhrvjFX3Em0M5nRwp0agCLcBGAsYHQ/s1600/20.png"/></span></p>
<p><span style="color: #000000;">So Now we will append the audio file to the text file using;</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">type ignite.mp3 &gt; jeeni.txt:ignite.mp3</pre>
<p><span style="color: #000000;">After we are done with appending the primary stream file, we will delete the audio file from the folder.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">del ignite.mp3</pre>
<p><span style="color: #000000;">Now, you will see that the audio file is gone but a new ADS is created and you can check it using</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">dir /r</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-x7q-lBZ3wu8/X0abfQ5FykI/AAAAAAAAnxE/WXUjZ3nCt6gGdzA5R-98Hu1RjeCILpBigCLcBGAsYHQ/s1600/21.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">C:\Program Files (x86)\Windows Media Player
wmplayer.exe C:\Users\raj\Desktop\ads\jeeni.txt:ignite.mp3</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-4ajdOeznCVU/X0abkPhf1mI/AAAAAAAAnxI/6q_ZTFSjBLAYUrlOFQxqOSllrfgqD2SawCLcBGAsYHQ/s1600/22.png" alt="Alternate Data Streams for Defense Evasion" width="868" height="394"/></span></p>
<h3><span style="color: #800000;">Conclusion </span></h3>
<p><span style="color: #000000;">We hope this article has given you a better understanding of alternate data streams. There are many more methods with which Alternate Data Streams can be performed.</span></p>
<p>To learn more on Defensive Evasion. Follow this <a href="https://www.hackingarticles.in/tag/defense-evasion/"><strong>Link</strong>.</a></p>
<p><span style="color: #000000;"><strong>Author: </strong>Jeenali Kothari is a Digital Forensics enthusiast and enjoys technical content writing. You can reach her on</span><strong><a href="https://www.linkedin.com/in/jeenali-kothari"> Here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
