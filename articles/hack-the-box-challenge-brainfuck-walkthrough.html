<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Hack the Box Challenge: Brainfuck Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-challenge-brainfuck-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-04-14T10:36:20+00:00">April 14, 2018</time><time class="updated" datetime="2025-07-05T18:40:58+00:00">July 5, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we are going to solve another CTF challenge “Brainfuck” which is retired vulnerable lab presented by Hack the Box for making online penetration testing practices according to your experience level. Although in this challenge you can test your expertise by WordPress penetration testing and how much knowledge you have in cryptography by decrypting any encryption that you will get in this lab.</span></p>
<h5><span style="color: #000000;">Level: Hard</span></h5>
<p><span style="color: #000000;"><strong>Task:</strong> find <strong>user.txt</strong> and <strong>root.txt</strong> file in the victim’s machine.</span></p>
<h3><span style="color: #800000;">Initial Reconnaissance with Nmap</span></h3>
<p><span style="color: #000000;">Since these labs are online available therefore they have static IP and IP of sense is <strong>10.10.10.17</strong> so let’s begin with nmap port enumeration.</span></p>
<pre class="lang:default decode:true">nmap -A 10.10.10.17</pre>
<p><span style="color: #000000;">From given below image, you can observe that we have found so many ports which are open such as 22,25 and so on in victim’s network and moreover I got three domain names as highlighted in below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-VluDQUt2BAQ/WtHOwiOSIQI/AAAAAAAAWSE/6CM7LN-XsEUr-CDbj2Xcs3NElhVBW82XACLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Now the next option was to <strong>add target IP</strong> inside <strong>/etc/host </strong>file since port 443 was open containing three domain names obtained from scanning result; thus I edit <strong>sup3rs3cr3t.brainfuck.htb www.brainfuck.htb  brainfuck.htb </strong>as hostname.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-bMpte6Js9F4/WtHOz_npUqI/AAAAAAAAWSo/WlcqTMqauB4sWKyTdunTSGAuti_uSVN1gCLcBGAs/s1600/2.png"/></span></p>
<h3><span style="color: #800000;">Exploiting WordPress Vulnerabilities</span></h3>
<p><span style="color: #000000;">Then I  explored all three domain names one by one in the web browser but when I explored <strong>https://brainfuck.htb</strong> found following webpage page which was indicating that it is a WordPress site and pointing toward SMTP mail Id <strong>orestis@brainfuck.htb</strong> as highlighted in below image.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rrIeugNYSyQ/WtHO3rL2drI/AAAAAAAAWTU/AEBlGzS5chgz1DDzR5u-dGKYj_oLsJuiwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Now we decided to use wpscan on the target URL, that we have entered in the browser. To check if there are any kind of vulnerable themes, plugins, username and etc.</span></p>
<pre class="lang:default decode:true">wpscan -u https://brainfuck.htb/ --disable-tls-checks --enumerate p --enumerate t --enumerate u</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZdWi5hA0c0w/WtHO5BxtxzI/AAAAAAAAWTo/sIICo_T0VZY2bVf9iLGuwRCVAlH0QGrSACLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">From the wpscan result, I grabbed the vulnerability in WordPress plug-in “support plus responsive ticket system” for Remote code execution as highlighted below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-3Maz3qMWN2U/WtHO5aShE2I/AAAAAAAAWTs/3zWWwiWoE30Efb5GCsAwU_IN5kMPXNa-wCLcBGAs/s1600/6.png"/></span></p>
<h5><span style="color: #000000;">Moreover, it dumped two login usernames “<strong>admin &amp; administrator</strong>”</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-xwuGeRh8f3Q/WtHO5s1EXkI/AAAAAAAAWT0/rtiqCqm1Lcs27EZpHlfpRQQ_1vYXLjtqgCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">With the help of Google, I search associated exploit for compromising victim’s credential and found <strong>exploit 41006</strong> as shown below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-BkVOiCGViUM/WtHO5ul-mYI/AAAAAAAAWTw/HAzZaqO-83c0BwbEyTn-YphTYDzyYoHXACLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Inside this, I saw HTML form code for remote code execution, now copy it and paste it into a text document.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-djqOLKXnJYQ/WtHO6KDPIoI/AAAAAAAAWT4/zRwwttoTgPkKofpmc48KZ0-E2g8WmZLGgCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Here please notice the changes I had made by adding “value”. </span></p>
<p><span style="color: #000000;">Save <strong>admin</strong> as username and <strong>orestis@brainfuck</strong> as email and target URL in action <strong>https://brainfuck</strong>” and saved it as wp.html on the desktop.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-RxxkKdHCXEI/WtHOwlEw11I/AAAAAAAAWSA/gs-PItsSjL0y9Zo7vQJ-6B9duKkeYoaFwCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">Then I run Python script for file transfer via port 80.</span></p>
<pre class="lang:default decode:true">python -m SimpleHTTPServer 80</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-MYOY5qhQaiM/WtHOweawDqI/AAAAAAAAWR8/XCTPJB1UiiU8ueBwpzVUN_aPRdDWsOO5wCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Then explore the wp.html file in localhost server as shown below and click on the <strong>login tab</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-vX2bFlYmGQM/WtHOxqNM6lI/AAAAAAAAWSI/AOpEPYLw7uo_tIMG2LEV_E3iSEPewgRqQCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">By doing so you can login as anyone without knowing password because of incorrect usage of wp_set_auth_cookie(). Then you can go to the admin panel by visiting <strong>https://brainfuck </strong>once again.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-g2wqCRxdIj0/WtHOx9GeGbI/AAAAAAAAWSM/DBcFlxI6hIcnUzmAhOtAPpBvzdEL6_7_gCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">You will get admin panel of WordPress and start penetrating it for getting a clue.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-YKjcB2aTAQ8/WtHOx4FywwI/AAAAAAAAWSQ/kONGgw5yIdAP7qQg-ElCD7C0fiNRccTfACLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Inside the admin dashboard, I looked at the plugin for the further step where I found SMTP plug-in.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-oB_NKVDCQQk/WtHOykj8arI/AAAAAAAAWSU/GOF_ZRM8qaggPEzCEBaHtuqmRrOiHXyzQCLcBGAs/s1600/15.png"/></span></p>
<p><span style="color: #000000;">It was a terrific moment when I saw user <strong>authentication login are filled</strong> in the text field. So I read username “<strong>orestis</strong>” but the password was in bold character, which I need to convert in plain text using <strong>inspect element</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-754NgowJhY0/WtHOy43L1vI/AAAAAAAAWSY/dWZUiuNembYUqV09u2yRNyxlVoa-GklKwCLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">Wonderful!! Here is orestis plain text password value as shown below in highlighted text, let’s use them for SMTP login.</span></p>
<p> </p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-eUOYY1YnIrU/WtHQfgGIuRI/AAAAAAAAWU8/EhCgCRuKVwI-j8BmzK9oZP3bkhc2jdARgCEwYBhgL/s1600/17.png"/></span></p>
<p><span style="color: #000000;">Through telnet <strong>command: telnet 10.10.10.17 110</strong> we established a connection with the SMTP server and login into orestis account. Now for reading orestis inbox messages I <strong>retr 1</strong> command but didn’t get any useful message and move to another message by running <strong>retr 2.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-qvUdEet3ht8/WtHQf3BFisI/AAAAAAAAWVA/ujwjxeaotH0uDMKM38E_2cQCRcO_QY6OQCEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Here I found something very crucial that there is username and password for any “Secret” forum for login and after a very deep thought. I realized this credential could be connected to <strong>sup3rs3cr3t.brainfuck.htb</strong> which I had explored in web browser.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-WIdPxfGOqHo/WtHQgAYWHnI/AAAAAAAAWVE/KmlOOv8Jq_8BVgm8d48mmt6h0wfLx8v1ACEwYBhgL/s1600/19.png"/></span></p>
<h5><span style="color: #000000;">Again I explore <strong>https:\\sup3rs3cr3t.brainfuck.htb</strong> </span></h5>
<p><span style="color: #000000;">Then submit above found credentials and got successful login.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-K1qjP9mrVdM/WtHQgXxBKRI/AAAAAAAAWVM/1vF0rcPljLM-7qn93V7mGahSaML9g9_pgCEwYBhgL/s1600/20.png"/></span></p>
<p><span style="color: #000000;">It showing super-secret forum which is pointing towards any secret discussion chat inside “Key” and “SSH Access”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-DtsBBj7ZQOM/WtHQgzRg_LI/AAAAAAAAWVQ/woknlXnlEmoEsXo4D7SExtyj0OX6dMNMgCEwYBhgL/s1600/21.png"/></span></p>
<p><span style="color: #000000;">Inside “Key” I notice chatting between admin and orestis which was going beyond my sense. Might be orestis and admin are sharing some confidential information in this secret chat but in the last reply of admin. It looked like he is secretly sharing any <strong>encrypted URL</strong>.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-eP0uu1wZYlI/WtHQhDtdk0I/AAAAAAAAWVU/IDAi9kXpf1Ymukvim_cP8QcJZfjzK9yPQCEwYBhgL/s1600/22.png"/></span></p>
<p><span style="color: #000000;">Then I open “ssh access” Ahhhh!!! It was an English conversation where the admin is giving suggestion to use Key for login instead of a simple password. And by reading all conversation I concluded that orestis has lost SSH login key. He is asking an admin to send the key in an encrypted chat that we saw above “Key” (secret discussion).</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-V67MVDq7Hy4/WtHQhGb7Z4I/AAAAAAAAWVY/AT_bCASXrxY3UaiX4NKQkz_SqqcfCsHfACEwYBhgL/s1600/23.png"/></span></p>
<h3><span style="color: #800000;">Decrypting SSH Key &amp; Gaining Access</span></h3>
<p><span style="color: #000000;">Time to decrypt their conversation for getting ssh login key but we don’t know from where to start. After spending so much time and efforts at last I <strong>successfully decrypted</strong> and found ssh login key.</span></p>
<p><span style="color: #000000;">Now your question is- How it became possible?</span></p>
<p><span style="color: #000000;">And my answer is: observe the given below step carefully:</span></p>
<p><span style="color: #000000;">From both chats “Key” and “ssh access”. I copied the following text into a text file respectively and removed the space provided between the word as shown in below.</span></p>
<pre class="lang:default decode:true">Pieagnm - Jkoijeg nbw zwx mle grwsnn (message in cipher text)
Orestis - Hacking for fun and profit (decrypt key in plain text)</pre>
<p><span style="color: #000000;">Considering ciphertext is encrypted information and plaintext as decrypting key.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Fep-15R8Jp4/WtHQhSDLLbI/AAAAAAAAWVc/-CLuByWnhjAj8rRZybHRS15I5IZZP9t5ACEwYBhgL/s1600/24.1.png"/></span></p>
<p><span style="color: #000000;">With the help of online decipher I had pasted above ciphertext inside encipher textbox. And decryption key inside decipher textbox and received <strong>decipher message</strong> “BrainfuCkmybrainfuckmybrainfu”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Qomi6gyBYXk/WtHQhtbd58I/AAAAAAAAWVg/7uDqcFzCOmsBDSPhx3gN9bJom2MG17-KgCEwYBhgL/s1600/24.png"/></span></p>
<p><span style="color: #000000;">If you remember we had obtained encrypted URL from inside “Key” discussion. Go for its decryption using above decipher message “fuckmybrain” as decrypting key. It took much time to identify proper encryption algorithm used for encrypting URL. We have successfully decrypted it with the <strong>help of Vigerner cipher</strong>. It gave a plaintext URL for downloading id_rsa for ssh login as orestis.</span></p>
<p><span style="color: #000000;">From the given below image, you can observe that I have added encrypted URL in the encrypted text field and used “fuckmybrain” as a decrypting key and obtain Plain text URL.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-rI14Y8qhq4c/WtHQhqL1FuI/AAAAAAAAWVk/H0qZcthPlFUXPHlSc4hFWSG6CELN_eFjwCEwYBhgL/s1600/25.png"/></span></p>
<p><span style="color: #000000;">After downloading id_rsa when I tried to open this file, then found that it required a password to view its content.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-dMP3c952jUM/WtHQhyMevEI/AAAAAAAAWVo/VJzpqR1t9docaKNQYdk5JDO6K0AXiyjfgCEwYBhgL/s1600/26.png"/></span></p>
<p><span style="color: #000000;">Formerly I downloaded a python script from <a style="color: #000000;" href="https://github.com/ph4r05/boinc/blob/master/gijohn/src/ssh2john.c"><span style="color: #0000ff;">here</span></a> for cracking the password of this file. Then I ran following command and got desired output.</span></p>
<pre class="lang:default decode:true">python sshng2john.py id_rsa &gt; ssh_login</pre>
<p><span style="color: #000000;">Then we used John the ripper for cracking this ssh_login file.</span></p>
<pre class="lang:default decode:true">john ssh_login --wordlist=/usr/share/wordlists/rockyou.txt</pre>
<h5><span style="color: #000000;">“<strong>3poulakia!</strong>” we got a result from executing the above command.</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-tPHIsg6w2lA/WtHQiIYhcfI/AAAAAAAAWVs/wJTuuedVXdQYSqUzIM89F4NnOcIntAA4ACEwYBhgL/s1600/27.png"/></span></p>
<p><span style="color: #000000;">And without wasting time; I executed the following command for login into SSH using <strong>3poulakia!</strong> as password.</span></p>
<pre class="lang:default decode:true">ssh -i id_rsa orestis@10.10.10.17</pre>
<p><span style="color: #000000;"><strong>Great!! </strong> I logged in successfully, now let’s finish the task by grabbing user.txt and root.txt file. First I have checked for available files in the current directory which are inside it. Good to see user.txt in the present location and then I open it using cat.</span></p>
<h5><span style="color: #000000;">cat user.txt</span></h5>
<h3><span style="color: #800000;">Cracking the Root Flag Encryption</span></h3>
<p><span style="color: #000000;">Apart from user.txt, I found three more files in this directory. When I opened these file I got the hint for Root Flag! Now follow the below steps if you are also looking for root flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-2WnsR1eSfdU/WtHQic1Z0nI/AAAAAAAAWVw/HiAx32WUiRw08VesAuJRE5Sp_a2b84-KACEwYBhgL/s1600/28.png"/></span></p>
<p><span style="color: #000000;">When I read the content of encrypt.sage, it was pointing towards encrypted password within debug.txt and output.txt</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wvU9WrDv3Nc/WtHQiwpufWI/AAAAAAAAWV4/IzouHgwCkgUVdG4fNpjcCLvdqx_8VIOxQCEwYBhgL/s1600/30.1.png"/></span></p>
<p><span style="color: #000000;">When I open debug.txt and output.txt. I saw encrypted information. Then again I chased towards Google for any help in such type of encryption and luckily found a <strong>decrypting script</strong> from this link: </span></p>
<h5><span style="color: #0000ff;">http://dann.com.br/alexctf2k17-crypto150-what_is_this_encryption/ </span></h5>
<p><span style="color: #000000;">Then that copied entire script into a text file for decryption.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-9wq3yGbGHCw/WtHQi8P3HZI/AAAAAAAAWV8/MGMLWjhhMUM7Pim8phkp1r8tMUCaWcUIwCEwYBhgL/s1600/30.png"/></span></p>
<p><span style="color: #000000;">As described in crypto150 algorithm I placed <strong>1<sup>st</sup>, 2<sup>nd</sup> &amp; 3<sup>rd</sup></strong> line of debug.txt equal to <strong>p, q, e</strong> respectively. <strong>Ct</strong> is equal to the content of <strong>output.txt </strong>as shown below and saved it as <strong>decrypt.py</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-KwGh9wybsls/WtHQjGHcY2I/AAAAAAAAWWA/47J8vAvS_JIJBko3McpOHU6b3NrYznP8wCEwYBhgL/s1600/31.png"/></span></p>
<p><span style="color: #000000;">Then run our <strong>decrypt.py</strong> through python and capture the root flag!!</span></p>
<pre class="lang:default decode:true">python decrypt.py</pre>
<p><span style="color: #000000;">Huhhhhh!!!!!! Such a hectic Lab it was, but we have completed the challenge successfully. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-7X7AWJ20968/WtHQjbNdN5I/AAAAAAAAWWE/WLB9UidmR9stSnu-t_50DGqyrEiQgKnIQCEwYBhgL/s1600/32.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
