<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Penetration Testing on Memcached Server</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/penetration-testing-on-memcached-server/" rel="bookmark"><time class="entry-date published" datetime="2019-02-22T14:52:12+00:00">February 22, 2019</time><time class="updated" datetime="2025-06-04T16:11:06+00:00">June 4, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In our <a href="https://www.hackingarticles.in/pentest-lab-setup-on-memcached/">previous</a> article, we learned how to configure Memcached Server in Ubuntu 18.04 system to design our own pentest lab. Today we will learn multiple ways to exploit Memcached Server.</span></p>
<h3 class="ai-optimize-7"><span style="color: #800000;">Table of Contents</span></h3>
<ul>
<li class="ai-optimize-8"><span style="color: #000000;">Dumping data from the Memcached server manually.</span></li>
<li class="ai-optimize-9"><span style="color: #000000;">Dumping data using libmemcached-tools.</span></li>
<li class="ai-optimize-10"><span style="color: #000000;">Dumping data using Metasploit.</span></li>
<li class="ai-optimize-11"><span style="color: #000000;">Monitoring using Watchers.</span></li>
</ul>
<h3 class="ai-optimize-12"><span style="color: #800000;">Requirements</span></h3>
<p class="ai-optimize-13"><span style="color: #000000;"><strong>Target: </strong>Memcached Server running in Ubuntu 18.04 system</span></p>
<p class="ai-optimize-14"><span style="color: #000000;"><strong>Attacker: </strong>Kali Linux</span></p>
<p class="ai-optimize-15"><span style="color: #000000;"><strong>Let’s Begin!!</strong></span></p>
<h3 class="ai-optimize-16"><span style="color: #800000;">Dumping data from Memcached server manually</span></h3>
<p class="ai-optimize-17"><span style="color: #000000;">Boot up your Kali Linux machine and do a simple nmap scan first to check whether the target machine is running Memcached Server or not.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV -p- 192.168.1.32</pre>
<p class="ai-optimize-18"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-rnSAxbHTRcs/XHAI_Z7JPII/AAAAAAAAc6I/A9HLiqkzY_87uwBCMf1jMMIdG6Ewq9ONgCLcBGAs/s1600/1.png"/></span></p>
<p class="ai-optimize-19"><span style="color: #000000;">As you can see in the above image, Memcached is running in the target machine and the port 11211 is open.</span></p>
<h4 class="ai-optimize-83"><span style="color: #800000;">Initial Reconnaissance and Server Connection</span></h4>
<p class="ai-optimize-20"><span style="color: #000000;">Then, let’s do a little advanced search using nmap script command by typing the following command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p11211 --script=memcached-info 192.168.1.32</pre>
<p class="ai-optimize-21"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-gnPKPJGUGXc/XHAJCd0bOaI/AAAAAAAAc60/8yvxEGK3JVkuWMgcsctbSvVsnqmqLIPbgCLcBGAs/s1600/2.png"/></span></p>
<p class="ai-optimize-22"><span style="color: #000000;">As you can see in the above image, nmap script command fetched us some crucial information about the Memcached server such as process ID, Uptime, Architecture, MAC Address etc.</span></p>
<p class="ai-optimize-23"><span style="color: #000000;">Then, let’s try to connect the Memcached server using telnet by typing in the commands given below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">telnet 192.168.1.32 11211</pre>
<p class="ai-optimize-24"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-ppSb5nbuUJE/XHAJCsSPJgI/AAAAAAAAc64/7jpNdJbeZ38proeneRB3wsyoUoh5YvjBQCLcBGAs/s1600/3.png"/></span></p>
<p class="ai-optimize-25"><span style="color: #000000;">As you can see in the above image, we are able to connect the Memcached Server through telnet. In such cases, the server is unprotected, hence, an attacker can gain access to the server without any obstacle because the server is not configured with SASL or any kind of firewall. Let’s go ahead and begin exploitation of the Memcached Server of which we gained access previously.</span></p>
<h4 class="ai-optimize-84"><span style="color: #800000;">Server Information Gathering</span></h4>
<p class="ai-optimize-26"><span style="color: #000000;">Type in a command <strong>version</strong> to do a version scan of the Memcached Server.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">version</pre>
<p class="ai-optimize-27"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vOrJnKC1YRw/XHAJDSsuPNI/AAAAAAAAc68/o00ahRMqulI9cSg7tqEFeJ_7jTzkC44ZgCLcBGAs/s1600/4.png"/></span></p>
<p class="ai-optimize-28"><span style="color: #000000;">The above data represents that the version of Memcached is 1.5.6 and it is running in a Ubuntu machine.</span></p>
<p class="ai-optimize-29"><span style="color: #000000;">Then, let’s get straight to fetch the valuable data stored in the server. Type the command shown below to print all the general statistics of the server.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">stats</pre>
<p class="ai-optimize-30"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-XLchBNrELPY/XHAJDtUazXI/AAAAAAAAc7A/kmdRIR0KyfUe_n66DvomK91ymfm9C4TjQCLcBGAs/s1600/5.png"/></span></p>
<p class="ai-optimize-31"><span style="color: #000000;">The above information shows the current traffic statistics. It serves the number of connections, data is stored into the cache, cache hit ratios and detailed information on the memory usage and distribution of information through the slab allocation used to store individual items.</span></p>
<h4 class="ai-optimize-85"><span style="color: #800000;">Data Extraction and Key Dumping</span></h4>
<p class="ai-optimize-32"><span style="color: #000000;">Then, we will run another command to fetch the slab statistics. Slabs are created and allocated for storing information within the cache. Run the command shown below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">stats slabs</pre>
<p class="ai-optimize-33"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-e6bwLRdrv6Q/XHAJD_zXBSI/AAAAAAAAc7E/7nrrw7LPV_QWm2Ab0pT7FCxrRCguMrjkACLcBGAs/s1600/6.png"/></span></p>
<p class="ai-optimize-34"><span style="color: #000000;">As you can observe in the above image, currently there is only one slab present in the server whose slab number is 1.</span></p>
<p class="ai-optimize-35"><span style="color: #000000;">Then, let’s run a command mentioned below to fetch count, age, eviction, expired etc. organized by slab ID.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">stats items</pre>
<p class="ai-optimize-36"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-I2kGr0BsE_s/XHAJEJZ_TcI/AAAAAAAAc7I/Giq5xrvukTEE_aQ6LI1uCIKkLmXEEuKdgCLcBGAs/s1600/7.png"/></span></p>
<p class="ai-optimize-37"><span style="color: #000000;">The above image gives us an insight into how the data is organized in <strong>slab ID 1.</strong></span></p>
<p class="ai-optimize-38"><span style="color: #000000;">Then, let’s run the command below to dump all the keys present in a particular slab.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">stats cachedump 1 0</pre>
<p class="ai-optimize-39"><span style="color: #000000;"><strong>Here 1 and 0 are the parameters,</strong></span></p>
<p class="ai-optimize-40"><span style="color: #000000;"><strong>1 = </strong>slab ID.</span></p>
<p class="ai-optimize-41"><span style="color: #000000;"><strong>0 = </strong>It represents the number of keys you want to dump, 0 will dump all the keys present in the slab ID respectively.</span></p>
<p class="ai-optimize-42"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yH0QRpPzgts/XHAJETDJXAI/AAAAAAAAc7M/9H-T3fGEjdkvMyNVk4L8xOZibyAISXFhgCLcBGAs/s1600/8.png"/></span></p>
<p class="ai-optimize-43"><span style="color: #000000;">The above image represents <strong>ITEM &lt;item_key&gt; [&lt;item_size&gt; b; &lt;expiration_timestamp&gt; s]</strong></span></p>
<p class="ai-optimize-44"><span style="color: #000000;">Then, we can simply use the get command to fetch the values stored in the keys as shown below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">get first
get second
get third</pre>
<p class="ai-optimize-45"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-CKQ4qJZqsiw/XHAJElN15jI/AAAAAAAAc7Q/7i3j4tEQXGsdhppgR-DTWfffSYmO6WlsACLcBGAs/s1600/9.png"/></span></p>
<p class="ai-optimize-46"><span style="color: #000000;">As you can see in the above image, we have successfully dumped the data stored in the key values.</span></p>
<h3 class="ai-optimize-47"><span style="color: #800000;"><strong>Dumping data using libmemcached-tools</strong></span></h3>
<p class="ai-optimize-48"><span style="color: #000000;">Dumping of data using this toolkit makes the work a lot easier. So, let’s start by installing libmemcached-tools in our system by typing in the following command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">apt install libmemcached-tools</pre>
<p class="ai-optimize-49"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-L2FfNaCN4kM/XHAI_vIuhVI/AAAAAAAAc6Q/BRfOE864Dx4wARykQO15t9_A0eXLpEekQCLcBGAs/s1600/10.png"/></span></p>
<p class="ai-optimize-50"><span style="color: #000000;">Now that we have installed libmemcached-tools let’s start using it by typing in the following command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">memcstat --servers=192.168.1.33</pre>
<p class="ai-optimize-51"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-KFjdR6uRxQQ/XHAI_uaxO0I/AAAAAAAAc6M/HcTP44H8bys2NvEIzSstna1tPMYpt9NcQCLcBGAs/s1600/11.png"/></span></p>
<p class="ai-optimize-52"><span style="color: #000000;">The above command will give pretty much the same result as the <strong>stats</strong> command which we had used earlier while fetching the server statistics manually.</span></p>
<p class="ai-optimize-53"><span style="color: #000000;">Then, let’s get straight to dumping the key values stored in the server. Run the command given below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">memcdump --servers=192.168.1.33</pre>
<p class="ai-optimize-54"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DD6tJPTM3x4/XHAJATom9qI/AAAAAAAAc6U/iZ26D1ZMR44A21AELJA0OOPxj74hNlFDwCLcBGAs/s1600/12%2B%25281%2529.png"/></span></p>
<p class="ai-optimize-55"><span style="color: #000000;">As you can see in the above image, we have dumped all the keys present in the server currently.</span></p>
<p class="ai-optimize-56"><span style="color: #000000;">Then, let’s dump all the values stored in the keys respectively. Run the command shown below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">memccat --servers=192.168.1.33 fifth fourth third second first</pre>
<p class="ai-optimize-57"><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-JU1-M24Ceeg/XHAJAhSNcjI/AAAAAAAAc6Y/PqidCRkZpd0FjAFrHqaxnTdVj8KbyjnqgCLcBGAs/s1600/12%2B%25282%2529.png"/></span></p>
<p class="ai-optimize-58"><span style="color: #000000;">The above command fetched us all the data stored in the respective key values. An attacker can use libmemcached-tools to easily upload any malicious file to the server too. Here, we will be showing an example of how to upload a file in the server.</span></p>
<p class="ai-optimize-59"><span style="color: #000000;">Type the command shown below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">memccp --servers=192.168.1.33 file</pre>
<p class="ai-optimize-60"><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-XkVwzzsG0as/XHAJA9i2ouI/AAAAAAAAc6c/QWRtZy4AbfYNkpl83S4WHs3GHXplMOlvACLcBGAs/s1600/13.png"/></span></p>
<p class="ai-optimize-61"><span style="color: #000000;">Here, the <strong>memccp</strong> command is uploading a file named “file.txt” present in the root directory of our system. Now, let’s use <strong>memcat </strong>to view the content of the file which we have uploaded in the server.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">memcat --servers=192.168.1.33 file</pre>
<p class="ai-optimize-62"><span style="color: #000000;"><strong> <img decoding="async" src="https://4.bp.blogspot.com/-hjmqczbISM0/XHAJBL7pTjI/AAAAAAAAc6g/zj58PzLyuxgh9H2iPpd2wEyjnWJMXM_XwCLcBGAs/s1600/14.png"/></strong></span></p>
<p class="ai-optimize-63"><span style="color: #000000;">As you can see, the above command fetched us the content of the file.</span></p>
<h3 class="ai-optimize-64"><span style="color: #800000;"><strong>Dumping Data using Metasploit</strong></span></h3>
<p class="ai-optimize-65"><span style="color: #000000;">As we all know, no exploitation is complete without using the Metasploit Framework once. So let’s dig in and see how we can exploit Memcached using Metasploit.</span></p>
<p class="ai-optimize-66"><span style="color: #000000;">Fire up the Metasploit Framework and search Memcache.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">search memcache</pre>
<p class="ai-optimize-67"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-RUaI87rcQiA/XHAJBLBPvqI/AAAAAAAAc6k/Gf1Y6Nhizfsbqk7ZelTkq-klSAkL3cOSgCLcBGAs/s1600/15.png"/></span></p>
<p class="ai-optimize-68"><span style="color: #000000;">The above image shows that there are currently 4 auxiliaries present in Metasploit.</span></p>
<p class="ai-optimize-69"><span style="color: #000000;">We will be using <strong>auxiliary/gather/memcached_extractor </strong>to fetch the keys and the values stored in it. Run the command given below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use auxiliary/gather/memcached_extractor</pre>
<p class="ai-optimize-70"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-UQxyHWjrP6A/XHAJBhBImEI/AAAAAAAAc6o/XSc1fu-NptwWQwipi6zGYlxXEGFPdRKHgCLcBGAs/s1600/16.png"/></span></p>
<p class="ai-optimize-71"><span style="color: #000000;">Once you have successfully imported the auxiliary in the Metasploit Framework, just set the rhost and then run the auxiliary. We know that Memcached stores data temporarily. So the above image shows that the auxiliary had fetched us both the Key and the Value currently present in the Memcached Server and stored it in its default location <strong>/root/.msf4/loot/20190218044841_default_192.168.1.35_memcached.dump_286171.txt</strong></span></p>
<h3 class="ai-optimize-72"><span style="color: #800000;"><strong>Monitoring using Watchers</strong></span></h3>
<p class="ai-optimize-73"><span style="color: #000000;">Watchers are a way to connect to Memcached and monitor all the actions being performed internally.</span></p>
<p class="ai-optimize-74"><span style="color: #000000;">Then, connect to the Memcached using telnet and type the command shown below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">watch fetchers</pre>
<p class="ai-optimize-75"><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-8IHiyzMHqj0/XHAJB4WF-DI/AAAAAAAAc6s/OvxBso8QFJwhTUTYruyjIwQk1Ce_oetMACLcBGAs/s1600/17.png"/></span></p>
<p class="ai-optimize-76"><span style="color: #000000;">The command line OK indicates that watcher is ready to send logs.</span></p>
<p class="ai-optimize-77"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-D_YMISWT9sk/XHAJCBOjR8I/AAAAAAAAc6w/aK_pyHdmX4oU37kwyaqwj7OnXGSvvLZeACLcBGAs/s1600/18.png"/></span></p>
<p class="ai-optimize-78"><span style="color: #000000;">As you can see in the above image, all the actions which are being performed in the server are shown here live.</span></p>
<h3 class="ai-optimize-79"><span style="color: #800000;">Conclusion</span></h3>
<p class="ai-optimize-80"><span style="color: #000000;">In this article, we have learned beginner level methods to exploit Memcached. In our future articles, we will be showing advanced methods to exploit Memcached Servers.</span></p>
<p class="ai-optimize-81"><span style="color: #000000;">Stay tuned!!</span></p>
<p class="ai-optimize-82"><span style="color: #000000;"><b>Author</b>: Benoy Naskar is a Certified Ethical Hacker, Researcher and Technical Writer at Hacking Articles on Information Security<b>. </b>Contact <a style="color: #000000;" href="https://in.linkedin.com/in/benoy-naskar-590116152"><b><span style="color: #000000;">here</span></b></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
