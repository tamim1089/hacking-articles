<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">EnuBox: Mattermost: Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/enubox-mattermost-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2020-02-01T16:43:24+00:00">February 1, 2020</time><time class="updated" datetime="2025-06-10T20:10:44+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">In this article, we are going to crack the EnuBox: Mattermost Boot to Root Challenge and present a detailed walkthrough. The machine depicted in this Walkthrough is hosted on Vulnhub. Credit for making this machine goes to Avraham Cohen. Download this lab by clicking <a style="color: #000000;" href="https://www.vulnhub.com/entry/enubox-mattermost,414/">here</a>.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Netdiscover Scan</span></li>
<li><span style="color: #000000;">Nmap Scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Browsing HTTP Service</span></li>
<li>Enumerating TFTP Service</li>
<li>Enumerating Zoom Plugin in CMS</li>
<li>Enumerating FTP Service</li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Connection via SSH</span></li>
<li>Enumerating secret binary</li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Post Exploitation</strong></span>
<ul>
<li>Downloading the secret binary</li>
</ul>
</li>
<li><strong>Privilege Escalation</strong>
<ul>
<li>Decompiling using Ghidra</li>
<li>Extracting the secret key</li>
<li>Getting the root session</li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Reading Root Flag</strong></span></li>
</ul>
<h3><span style="color: #000000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">We downloaded, imported and ran the virtual machine (.ova file) on the VMWare Workstation, the machine will automatically be assigned an IP address from the network DHCP. To begin we will find the IP address of our target machine, for that use the following command as it helps to see all the IP’s in an internal network:</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-W7LF_yPCuew/XjWjwSvP6FI/AAAAAAAAik4/Z2ZqsK3uuZUOuwFXnmGVaBxMiUXiwdN2wCLcBGAsYHQ/s1600/1.png"/></p>
<p><span style="color: #000000;">We found the target’s IP Address 192.168.1.8. The next step is to scan the target machine by using the Nmap tool. This is to find the open ports and services on the target machine and will help us to proceed further</span></p>
<pre class="lang:default decode:true">nmap -sT -sU -A 192.168.0.110</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-FCrIUWk54e0/XjWjzqNxy1I/AAAAAAAAilg/h0eE8bW4_UQ5fk6q3PO8cnWwuIXysGdggCLcBGAsYHQ/s1600/2.png"/></p>
<p><span style="color: #000000;">Here, we performed a nmap scan with TCP and UDP parameters. After the scan, we saw that port 22,80, 3389, 68, 69, 631, 5353. From the scan we have the FTP (21) service, SSH (22) Service, HTTP (80), DHCPC (68) service, TFTP (69) service, and some other services. This was the lay of the land. Now let’s get to enumeration.</span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">We started from port 80 and tried to browse the webpage on our browser. We have the classic Access Forbidden Banner. Although this is a custom error page but some sensitive information disclosure is active here. We see that through the error, there is the Server OS Version Disclosure. We also have the name of a probably sensitive file named README.md. Let’s take a note these might be useful down the lane.</span></p>
<pre class="lang:default decode:true">http://192.168.0.110</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-vAn88LOTcHY/XjWjz3_wm3I/AAAAAAAAilk/vJc3N-vNfx0VkA7408MnQ3jWMYEi4ROXgCLcBGAsYHQ/s1600/3.png"/></p>
<p><span style="color: #000000;">Now moving on, we also got another page hosted on the port 8065. Let’s take a look at that. We see that we have a login panel. So, this is probably our way in to the CMS.</span></p>
<pre class="lang:default decode:true">http://192.168.0.110:8065/login</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-vU4SvHP-AE0/XjWjz4A-e6I/AAAAAAAAilo/x6KqpP1YpiAmK2XjvX9N7VjYccRiVhh8QCLcBGAsYHQ/s1600/4.png"/></p>
<p><span style="color: #000000;">From the Nmap scan we see that we have the TFTP service running on the Target Machine. Let’s take a look onto that. As Anonymous Login was enabled, no credentials were asked. In the earlier stage we know that there is a sensitive file named “README.md”. We tried to download this file from this TFTP Server. Our download was successful. After downloading the file, we read the file contents to find the Username and Password.</span></p>
<pre class="lang:default decode:true">tftp 192.168.0.110
get README.md
quit
cat README.md</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-MK9fH5OUfpU/XjWj0T9N9uI/AAAAAAAAils/-p56cDIdXGU_2Y2tX4NhBRdSIyji1mMPwCLcBGAsYHQ/s1600/5.png"/></p>
<p><span style="color: #000000;">We went back to the Login Panel that we found earlier and entered the following credentials.</span></p>
<p><span style="color: #000000;"><strong>Username: admin</strong></span></p>
<p><span style="color: #000000;"><strong>Password: ComplexPassword0!</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-236IwDtczmk/XjWj1ChNDgI/AAAAAAAAil0/YxCkxAoGpHQTvsNyboTNLZYjfagE4LVeACLcBGAsYHQ/s1600/6.png"/></p>
<p><span style="color: #000000;">After logging in the application, we see that there are bunch of posts on the main page. On reading those posts we see that there was different version of the word “zoom” word used. It was quite peculiar the way it was used. Like “Let’s zoom”, “Zoom me”. It was very similar to the terminology that we commonly use with the word “text/chat”. Like “Let’s Text”, “Text me”. This gave us some idea that this was some kind of messaging module. Now from the look of the CMS, it was clear that the CMS uses the plugin methods to add or remove functionalities. So we set on the mission to find the plugin by the name “zoom”.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-UmmffM61XS4/XjWj1FjqTeI/AAAAAAAAilw/xY-JdwIK9hULWvN7RfhNrBBaxhAwSTkBQCLcBGAsYHQ/s1600/7.png"/></p>
<p><span style="color: #000000;">To edit some plugins, we move to the panel with the Username on the left side. We click on the Menu button; it gave us the dropdown menu. Among a bunch of other options, we have the “System Console” Option. It’s worth checking out.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-XK1qk8PcSDU/XjWj1Tf3LfI/AAAAAAAAil4/hNU4O3hXdJojLfAP4pxYHZpK5GxcRhyBwCLcBGAsYHQ/s1600/8.png"/></p>
<p><span style="color: #000000;">Now we have the System Console, we found of bunch of option, but my search was focused on finding the Plugins panel. Here under the System Console Panel we have the Plugin Option in the System Console Panel. In the plugin panel we have the Zoom Plugin.  </span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-2hg3wlaA4nc/XjWj14aSv7I/AAAAAAAAil8/n7_fkO7AEZwj05yidYR81gm2OIjSeBcegCLcBGAsYHQ/s1600/9.png"/></p>
<p><span style="color: #000000;">Clicking on the Zoom Plugin button which will open a plugin config page. The plugin was disabled by default. As we are the admin, so we have the authority for to enable to the plugin. After enabling, we see that we have ourselves an URL for the plugin. As it says localhost because the application is configured server-side. We change the localhost to the IP Address of the Machine.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/--WupXK8PQ2M/XjWjwhz7h_I/AAAAAAAAilA/XI2pwGzAYaUG3_f6EVJ5zXjQVitUFuzsgCLcBGAsYHQ/s1600/10.png"/></p>
<p><span style="color: #000000;">After making appropriate changes in the URL, we browse that link to see that we have a message. It says that FTP credentials help the admin, edit and manage the files. This gives us the FTP Credentials:</span></p>
<p><span style="color: #000000;"><strong>Username: ftpuser</strong></span></p>
<p><span style="color: #000000;"><strong>Password: ftppassword</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-A26lAh3-PLo/XjWjwq3peXI/AAAAAAAAik8/ZKg4e3GcuoYmJtDkQpyKA5BTd3np67CrwCLcBGAsYHQ/s1600/11.png"/></p>
<p><span style="color: #000000;">Let’s login in the machine using these FTP Credentials. We use the dir command to list all the files inside the machine. We do some enumeration to find a file named message.</span></p>
<pre class="lang:default decode:true">ftp 192.168.0.110
ftpuser
ftppassword
dir
cd users
dir
cd mattermost
dir
get message
bye</pre>
<h3><img decoding="async" src="https://1.bp.blogspot.com/-vc1l0M5CKvE/XjWjxiISXbI/AAAAAAAAilE/XtgwEIz6V3s2UCm6ewDgDehWRTpQXkapQCLcBGAsYHQ/s1600/12.png"/></h3>
<h3><span style="color: #800000;"><strong>Exploitation</strong></span></h3>
<p><span style="color: #000000;">Let’s take a look at the message file from the FTP server. It says <strong>“Welcome!!”.</strong></span></p>
<p><span style="color: #000000;">After thinking and tinkering with the application we figured out that the password for the SSH user is the text that was inside the message file. We SSHed  in to the machine using the following credentials. After successful login, we start enumeration process by listing the directories. We see that we have a README.md file and a binary named secret. We view the README file to find that the there is a secret key which is used to traverse further. We ran the secret binary, it asked for the secret key. We entered the key which we found inside the README file. But we are shown an error that the key is expired.</span></p>
<p><span style="color: #000000;"><strong>Username: mattermost</strong></span></p>
<p><span style="color: #000000;"><strong>Password: Welcome!!</strong></span></p>
<pre class="lang:default decode:true">cat message
ssh mattermost@192.168.0.110
ls
cd Desktop/
ls
cat README.md
./secret</pre>
<h3><img decoding="async" src="https://1.bp.blogspot.com/-cOAg9NU6PIk/XjWjx5HijWI/AAAAAAAAilM/BMf6KB8g6e0CF7y2HG0W_PR_feuq1ggbgCLcBGAsYHQ/s1600/13.png"/></h3>
<h3><span style="color: #800000;"><strong>Post Exploitation</strong></span></h3>
<p><span style="color: #000000;"> We thought we have to reverse engineer the secret script to get ourselves a key. To do that we download the file to our system using the PHP server script.</span></p>
<pre class="lang:default decode:true">pwd
php -S 0.0.0.0:8080</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-AJSJNUEseoU/XjWjxxIfJeI/AAAAAAAAilI/Rq2jWPfZj64tVmVjE0iAj5uJNBn7C-M5QCLcBGAsYHQ/s1600/14.png"/></p>
<p><span style="color: #000000;">After hosting the file on the server, we download it onto out attacker machine using the wget command.</span></p>
<pre class="lang:default decode:true">wget http://192.168.0.110:8080/secret
ls</pre>
<h3><img decoding="async" src="https://1.bp.blogspot.com/-3aqmE9y61Lo/XjWjycuA4WI/AAAAAAAAilQ/osteK_-62ywUmLRtlZ68x64WSxDFUJgdACLcBGAsYHQ/s1600/15.png"/></h3>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">Now we used the Ghidra to Decompile the code and see the value of the variable that is compared the value of the secret key. We see that whatever the value we enter for the secret key is compared to 0xf447. Now all we need is to find the decimal equivalent of the number.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-jAl2bRklvJI/XjWjyl9BXaI/AAAAAAAAilU/ueynqhi8gt0O7P-PhiSZsw2QpSly9XiogCLcBGAsYHQ/s1600/16.png"/></p>
<p><span style="color: #000000;">We used the echo command to convert the value we found inside the secret binary into a decimal value. We have the value of the secret key: “<strong>62535</strong>”</span></p>
<pre class="lang:default decode:true">echo $((0xf447))</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-yWGbf80vHT0/XjWjyk5jzPI/AAAAAAAAilY/3vv22l6adEY9Wt3AFvYL4kSYDgvyZ_GXACLcBGAsYHQ/s1600/17.png"/></p>
<p><span style="color: #000000;">Now that we have the value of the secret key, we went back to our SSH Session and ran the secret binary. We entered the value and the shell gets elevated to root privileges.</span></p>
<h3><span style="color: #800000;"><strong>Reading the Flag</strong></span></h3>
<p><span style="color: #000000;">We enumerated the Desktop of the root user and found a text file named local.txt. Upon opening we see that it is the final flag of this machine.</span></p>
<pre class="lang:default decode:true">./secret
62535
whoami
cd /root/Desktop
cat local.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Q983mzy_3Hs/XjWjy3kfuXI/AAAAAAAAilc/p2v0EUQYcKkkC5aYxmUzhkiwF-v14i9iQCLcBGAsYHQ/s1600/18.png"/></p>
<p><span style="color: #000000;">This concludes the lab. A huge shout out to the lab author for creating this lab. From the look of it, the lab must have taken some effort and time. I would like to thank the author for investing his/her resources for my learning.</span></p>
<p><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher and Penetration Tester. Can be Contacted on Twitter and <a href="https://www.linkedin.com/in/pavandeep-singh-6b1074132">LinkedIn</a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
