<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/container-security/" rel="category tag">Container Security</a>, <a href="https://www.hackingarticles.in/category/container-security/docker-pentest/" rel="category tag">Docker Pentest</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Docker for Pentester: Abusing Docker API</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/docker-for-pentester-abusing-docker-api/" rel="bookmark"><time class="entry-date published" datetime="2020-09-14T11:57:11+00:00">September 14, 2020</time><time class="updated" datetime="2025-05-13T08:14:32+00:00">May 13, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">As you know, docking services are booming, docking container attacks are also on the rise. But this post will illustrate how the intruder is trying to compromise the docker API due to a weak setup.</span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Table of Content</span> </span></h3>
<ul>
<li><span style="color: #000000;">Docker architecture</span></li>
<li><span style="color: #000000;">Enable Docker API for Remote connection</span></li>
<li><span style="color: #000000;">Abusing Docker API</span></li>
</ul>
<h3><span style="color: #800000;">Docker Architecture</span></h3>
<p><span style="color: #000000;">Docker uses a client-server architecture, the main components of the <strong><a href="https://www.hackingarticles.in/tag/docker/">docker</a> </strong>are docker-daemon, docker-CLI and API.</span></p>
<ul>
<li><span style="color: #000000;"><strong>Docker Daemon:</strong> Use manage docker object such as network, volume, docker image &amp; container.</span></li>
<li><span style="color: #000000;"><strong>Docker CLI:</strong> A command-line interface used to execute the command to pull, run and build the docker image.</span></li>
<li><span style="color: #000000;"><strong>Docker API:</strong> It is a kind of interface used between Daemon and CLI to communicate with each other through Unix or tcp socket.</span></li>
</ul>
<p><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-kVrSQnOYU7E/X19XuBpuahI/AAAAAAAAoaQ/sl9CJw3B754ZXiYx1Y5gHoQjfT7dZcVLQCLcBGAsYHQ/s1600/0.0.png" alt="Abusing Docker API" width="1203" height="433"/></span></p>
<p><span style="color: #000000;">As we know, the usage of Docker service in any organisation is booming. This is because it has reduced the developer’s effort to host applications within their infrastructure. Moreover, when you install Docker on a host machine, the daemon and CLI communicate with each other through a Unix socket. This socket represents a loopback address. If you want to access the Docker application externally, then you must bind the API over a TCP port.</span></p>
<p><span style="color: #000000;">Furthermore, when you allow the Docker API to be accessed over a TCP connection through ports such as 2375, 2376, or 2377, it creates a potential risk. In this case, a Docker CLI running outside the host machine will be able to access the Docker daemon remotely.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-929Ke703JTc/X19XyOyKVnI/AAAAAAAAoaU/_n1LQzuIJRAe0aPZEVFR6MZ5qVbpaZ8dwCLcBGAsYHQ/s1600/0.1.png"/></span></p>
<p><span style="color: #000000;">The attacker always checks for such type of port using Shodan, they try to connect with docker remotely in order to exploit the docker daemon. Their several dockers application listening over port 2375 for remote connection.</span></p>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-Uy23nWqUMd8/X19X1YWiqrI/AAAAAAAAoaY/Kz3e2CgSrD8eb0T3VcDOdK3Rnf9Zh6PFgCLcBGAsYHQ/s1600/0.2.png" alt="Abusing Docker API" width="322" height="404"/></span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Enable Docker API for Remote connection</span> </span></h3>
<p><span style="color: #000000;">Initially, you can observe that the target host does not have any port open for docker service.  When we used nmap port scan for 192.168.0.156 which is the IP of the host machine where docker application is running.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-QparVgXGf6I/X19X4ymknOI/AAAAAAAAoac/p45d9T3GwaQbq1nJLd7bUK2PCwFWvjeFwCLcBGAsYHQ/s1600/0.png"/></span></p>
<p><span style="color: #000000;">At host machine, we try to identify a process for docker, as we have mentioned above by default it runs over Unix sockets.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ps -ef | grep docker</pre>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-xrW9AwB4gXE/X19X8gOMsoI/AAAAAAAAoag/EBwbyqnw36A-Ue52R8TiuFZV2O4nyGtOACLcBGAsYHQ/s1600/1.png" alt="Abusing Docker API" width="1029" height="145"/></span></p>
<p><span style="color: #000000;">Now modify the configuration for REST API in order to access the docker daemon externally.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OokAyJzIKVk/X19YAmIGixI/AAAAAAAAoak/ZlsGgTMFTasvLXqeVL8oOzOMrm495CUbwCLcBGAsYHQ/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Make the changes as a highlight in the image with the help of following commands.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nano /lib/systemd/system/docker.service
-H=tcp://0.0.0.0:2375
systemctl daemon-reload
service docker restart</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-vGPdKQpQPLY/X19YEhQY7uI/AAAAAAAAoao/cVwRfvnC_xQDMDzRu8TM_6peq8KhWk0FgCLcBGAsYHQ/s1600/3.png" alt="Abusing Docker API" width="758" height="333"/></span></p>
<p><span style="color: #000000;">Now, if you will explore the docker process, you will notice the change.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zM530_SvGjo/X19YH3Ez00I/AAAAAAAAoaw/7vnXFJgjtSYAU-lVf2zfSoTvnKw3e3VwgCLcBGAsYHQ/s1600/4.png"/></span></p>
<h3><span style="color: #800000;">Abusing Docker API</span></h3>
<p><span style="color: #000000;">Now attacker always looks for such network IP where docker is accessible through API over 2375/tcp port. In order to establish a remote connection with the docker application. As you can see, we try to scan the host machine to identify open port for docker API using nmap port scan.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p- 192.168.0.156</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-vBADEj4qkDo/X19YMfcq4dI/AAAAAAAAoa0/R8ZrS5bNctYzBZTFe6ucvyXYjNsUDFXNgCLcBGAsYHQ/s1600/5.png"/></span></p>
<p><span style="color: #000000;">Once the port is open and accessible, you can try to connect with docker daemon on the target machine. But for this, you need to install a docker on your local machine too.  So, we have installed docker on Kali Linux as well as we docker running on our target machine too.  Now to ensure that we can access docker daemon remotely, we execute the following command to identify the installed docker version.</span></p>
<h5><span style="color: #000000;">Syntax: docker -H &lt;remote host ip&gt; :&lt;port&gt; &lt;docker-command&gt; </span></h5>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">docker -H 192.168.0.156:2375 version</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-uC07y3DSX7A/X19YPojmXLI/AAAAAAAAoa4/rz2Z4p4uGvg1tk6P-zeGWfMQnuBMEWc4ACLcBGAsYHQ/s1600/6.1.png" alt="Abusing Docker API" width="469" height="444"/></span></p>
<p><span style="color: #000000;">Further, we try to enumerate the docker images running on the remote machine</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">docker -H 192.168.0.156:2375 images</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-X_Meweznhng/X19YS1puh2I/AAAAAAAAobA/eZL-iuAdOe897_NNY_SdR84vx3LF35PJwCLcBGAsYHQ/s1600/6.png"/></span></p>
<p><span style="color: #000000;">Similarly, we try to identify the process for running a container with the help of the following command to access the container remotely.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">docker -H 192.168.0.156:2375 ps -a
docker -H 192.168.0.156:2375 exec -it &lt;Container ID&gt; /bin/bash</pre>
<p><span style="color: #000000;">Thus, in this way, the weak configured API which is exposed for external connection can be abused an attack. This could result in container hijacking or an attacker can hide the persistence threat for reverse connection. Also, if the installed version of docker is exploitable against container escape attack. Then, the attack can easily compromise the whole host machine and try to obtain the root access of the main machine (host).</span></p>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="https://1.bp.blogspot.com/-HuSl4ggbZro/X19YWOGJdDI/AAAAAAAAobI/MOdIACzJggUwBU54JG8sQ3nM38djoPrTQCLcBGAsYHQ/s1600/7.png" alt="Abusing Docker API" width="923" height="407"/></span></p>
<p><b>Author</b>: Geet Madan is a Certified Ethical Hacker, Researcher and Technical Writer at Hacking Articles on Information Security<b>. </b>Contact <a href="https://www.linkedin.com/in/geet-madan/"><b>here</b></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
