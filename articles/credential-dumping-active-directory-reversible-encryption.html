<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/credential-dumping/" rel="category tag">Credential Dumping</a></span>            </div>
            <h1 class="post-title entry-title">Credential Dumping – Active Directory Reversible Encryption</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/credential-dumping-active-directory-reversible-encryption/" rel="bookmark"><time class="entry-date published" datetime="2023-06-13T21:28:01+00:00">June 13, 2023</time><time class="updated" datetime="2025-06-19T19:51:19+00:00">June 19, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;"><strong data-start="228" data-end="291">Credential Dumping – Active Directory Reversible Encryption</strong> is a technique that attackers commonly use to extract user credentials from <strong data-start="368" data-end="387">Windows systems</strong>. According to MITRE, adversaries often exploit <strong data-start="435" data-end="481">Active Directory authentication encryption</strong> properties to retrieve stored passwords. The AllowReversiblePasswordEncryption property controls whether the system stores passwords using <strong data-start="623" data-end="648" data-is-only-node="">reversible encryption</strong>. By default, Windows disables this setting to prevent storing credentials in a retrievable format, unlike secure one-way hashing functions. However, when legacy software or specific applications require it, administrators may enable the setting—thereby exposing the system to significant risk.</span></p>
<ul>
<li><span style="color: #000000;">MITRE TACTIC: Credential Dumping (ID: TA0006)</span></li>
<li><span style="color: #000000;">MITRE Technique Modify Authentication Process (T1556)</span></li>
<li><span style="color: #000000;">MITRE SUB ID: Reversible Encryption (<span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://attack.mitre.org/techniques/T1556/005/">T1556.005</a></strong></span>)</span></li>
</ul>
<p><span style="color: #000000;">Moreover, in the <strong data-start="781" data-end="802">Domain Controller</strong>, the system enables <strong data-start="823" data-end="848">reversible encryption</strong> for user accounts, which means attackers can reverse the encrypted data to retrieve the user’s <strong data-start="944" data-end="956">password</strong>. Since this method does not store the password as a <strong data-start="1009" data-end="1017">hash</strong>, a function can be executed to retrieve the original <strong data-start="1071" data-end="1094">clear-text password</strong>.</span></p>
<p><span style="color: #000000;"><strong>Do you know?</strong></span></p>
<p><span style="color: #000000;">As per <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/store-passwords-using-reversible-encryption">Microsoft</a></strong></span>: If you use the <strong>Challenge Handshake Authentication Protocol (CHAP)</strong> through remote access or <strong>Internet</strong> <strong>Authentication Services (IAS),</strong> you must enable this policy setting. CHAP is an authentication protocol that is used by remote access and network connections. <strong data-start="1410" data-end="1423">Similarly</strong>, <strong data-start="1425" data-end="1450">Digest Authentication</strong> in <strong data-start="1454" data-end="1493">Internet Information Services (IIS)</strong> also requires this policy setting to be enabled.<br/>
</span></p>
<h3><span style="color: #800000;"><strong>Table of Content</strong></span></h3>
<ul>
<li><span style="color: #000000;">Lab Setup</span></li>
<li><span style="color: #000000;">DC-Sync Attack-Dump Plain text Password</span></li>
<li><span style="color: #000000;">Mitigation</span></li>
<li><span style="color: #000000;">Conclusion</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Lab Setup</strong></span></h3>
<p><span style="color: #000000;"><strong>Enabling Reversible encryption in Active Directory Users</strong></span></p>
<p><span style="color: #000000;">There are multiple methods to enable Reversible encryption property:</span></p>
<ul>
<li><span style="color: #000000;">User Account Property</span></li>
</ul>
<p><span style="color: #000000;">Enable the Reversible encryption by modifying the account property for the Domain User account.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEig7FIYquN_08SMiSq6EicJGBxK03GtBX1RjHTb70cO8nYnZa0W6__iFQ5zZ3WbSm7AH-JhdKrwHmsXqE6rXcUnI-pajuzmUD6VZa3cDzAmUsIX8yQTlsuLfxQbrG7vzmMhX9I3-bKw_DCEr_Qw6ph3HGDVvLZPw5zy_qkGgrnvvmeB26VRmBSXoo0HcQ/s16000/11.png"/></span></p>
<p><strong><span style="color: #000000;">Powershell Command</span></strong></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">set-ADUser – AllowReversiblePasswordEncryption $true</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiCqdHeyJ7EoYlpbmhrRHcShF1CNwtoWMrMyCQESAQUyE8qZMh2QPzSTFD2VUme_YNl8Qqx90YwnGmjUJeutxhT5uBCdZOBJk-TBCUgHVVoOi6bJ0sgTubFxLl4w87ZQ8RCUm7xERA_OTeV3-X8eNgcvhSiAOyM001rQtm8VmU6nbYoqyNhKZXF90FvWA/s16000/12.png"/></span></p>
<p><strong><span style="color: #000000;">Group Policy Management</span></strong></p>
<p><span style="color: #000000;">Enable the store password using reversible encryption with <strong>Computer Configuration\Windows Settings\Security Settings\Account Policies\Password Policy\</strong></span></p>
<h3><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEipcKewgKM4igOAnzXXoFnMwhSYUJbh3C8lB-DJIHTaa4rmtht0ei2dNR2ftFFAsA87KMIu8R0aLtmdAr_1RpRI2O4FMF2W0QbsBe8xIs_0Ztom0j0es5cWMrWKN-KW88nLeySHWLrK3YvHW7NpJ_TghkME1n0KjUBzNVoJ94GwWFVXCU-9yoyiWZCfPw/s16000/13.png"/></span></h3>
<p><span style="color: #000000;">Validate the property through User’s property-Attribute Editor for UserAccountControl.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhGqkg9DNMWn3002_7iYH7vDhdOErHCgxl8G21cAh-zlmNmM-JLn9Do3m7d2qYfktWVtbKqqzxbDRN3SK-5tVMwRcMn49Z5aUFYvEyoatm1ZWSkdtTZ7U9fugq8QXHm7WMYPcxNm3A9CH2q1N8Qn82bADgIq5YyZvzJODarDbR8bL8GTXJTo2r1mYr60g/s16000/14.png"/></span></p>
<p><span style="color: #000000;">NOTE: Now, if a system administrator resets the password for a user account, an adversary can potentially obtain the plaintext of passwords that they create or change after enabling this property.</span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">PowerShell Command to find user enabled with allow reversible password encryption.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Get-ADUser -Filter {AllowReversiblePasswordEncryption -eq "true"} | Select Name, sAMAccountName</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiAi8tOWSWU5oBj-nB1PBGpPWUlTBroMVxIES0JfyKq0qxfQIgYq9nA6zRwFOhywB8YKgHPRn-N3RYmn_IGEl4cE6TJSpRLAkrQUcnbbCoBrxVyfsx1K2VImZp2qZCaSCSH6Ob3TnXc_29tXDyGv39Gs1iEGT2QfRoTpxu7wVlfRHjTx68Wov5EFWgplg/s16000/15.png"/></span></p>
<h3><span style="color: #800000;"><strong>Attack: DC-Sync</strong></span></h3>
<p><span style="color: #000000;">In our Previous article, we described the DCsync attack, read more from <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/credential-dumping-dcsync-attack/">here</a></strong></span>. You can download the DC Sync Script tool <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://raw.githubusercontent.com/BC-SECURITY/Empire/master/empire/server/data/module_source/credentials/Invoke-DCSync.ps1">here</a></strong></span>.</span></p>
<p><span style="color: #000000;">Commands to execute in the domain controller to check the user’s clear text password.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">powershell.exe -ep bypass
Import-Module .\Invoke-DCSync.ps1
Invoke-DCSync -AllData</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiwh6Wpfa_pGVywb1ithbmkozN1XeHqq-6fos7J-MJmMlbmCVwk1ITxNGS66T9kXmIRSWIrV7HuSpj6crtLi09sqdJXJBtQ7Rod_sEfAFleBhbfFiUNWfgqsgXqHFFrpTnLBRJ01OvwAVuk40qOy6r7GDQQO_7ys9WTjekrtv3hHllBjfO2NphErXzJqA/s16000/16.png"/></span></p>
<p><span style="color: #000000;">DCSync shows the clear-text password of the target user.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjoQdvNcxWPW0E2iZ-N1j2dJE0--pr-ewoL3wPJzC-tEWU7kN4bZM19i4rEhhhl3D1TBLxbaLnUaLcO9rgX8rpSi-syTPSmvsRqvGoePDtRUAZ73e8s6S3dZYYWAr8Y43t6k1Wo26xq6DFJFMAviYAWTnryKxI0i6qI1y59ihWhwz32mML7yzpZoOEQNg/s16000/17.png"/></span></p>
<h3><span style="color: #800000;"><strong>Mitigation</strong></span></h3>
<ul>
<li><span style="color: #000000;">Additionally, ensure that the <strong data-start="304" data-end="344">Allow Reversible Password Encryption</strong> property remains disabled for better security.</span></li>
<li><span style="color: #000000;">Moreover, set the group policy to store passwords without using reversible encryption to reduce the risk of unauthorized access.</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Conclusion</strong></span></h3>
<p><span style="color: #000000;">In this article, we were able to decrypt the password of active directory user accounts. This article can serve as a reference for Red Team activists for Credential Dumping – Active Directory Plain Text Password.</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Faisal Khan security analyst and expert in infrastructure Security Contact him on <a href="https://www.linkedin.com/in/faisal-khan-27017666"><strong>LinkedIn</strong></a></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
