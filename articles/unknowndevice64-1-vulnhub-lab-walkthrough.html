<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">unknowndevice64: 1: Vulnhub Lab Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/unknowndevice64-1-vulnhub-lab-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-03-11T18:05:45+00:00">March 11, 2019</time><time class="updated" datetime="2025-06-10T20:11:48+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello friends! Today we are going to take another boot2root challenge known as “unknowndevice64: 1”. The credit for making this VM machine goes to “Ajay Verma” and it is another boot2root challenge in which our goal is to get root access to complete the challenge. You can download this VM <a style="color: #000000;" href="https://www.vulnhub.com/entry/unknowndevice64-1,293/#download">here</a>.</span></p>
<p><span style="color: #000000;"><strong>Security Level</strong>: Beginner</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodology:</strong></span></h3>
<ul>
<li><span style="color: #000000;">IP Discovery using netdiscover</span></li>
<li><span style="color: #000000;">Network scanning (Nmap)</span></li>
<li><span style="color: #000000;">Surfing HTTP service port</span></li>
<li><span style="color: #000000;">Finding image File</span></li>
<li><span style="color: #000000;">Extracting </span>the hidden<span style="color: #000000;"> file from </span>the image</li>
<li><span style="color: #000000;">Logging in through SSH</span></li>
<li><span style="color: #000000;">Escaping restricted shell</span></li>
<li><span style="color: #000000;">Finding binary in sudoers list</span></li>
<li><span style="color: #000000;">Getting </span>the root<span style="color: #000000;"> shell and finding </span>the flag</li>
</ul>
<p><span style="color: #000000;"><strong>Walkthrough</strong></span></p>
<p><span style="color: #000000;">Let’s start off with scanning the network to find our target.</span></p>
<pre class="lang:default decode:true">netdiscover</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-nIVQ7iS3QZs/XIahe14VQCI/AAAAAAAAdaY/DwjRYOPW2U8x1bc1M021LaZKnyVygNYDwCLcBGAs/s1600/1.png"/></span></p>
<p><span style="color: #000000;">We found our target –&gt; 192.168.1.104</span></p>
<p><span style="color: #000000;">Our next step is to scan our target with nmap.</span></p>
<pre class="lang:default decode:true">nmap -p- -sV 192.168.1.104</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-HQwNuBQOf9k/XIahgfwN8NI/AAAAAAAAdas/X76EW6wWVAQZJG1dYUaE_3___nBlm3C5wCLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">The NMAP output shows us that there are 2 ports open: 1337(SSH), 31337(HTTP)</span></p>
<p><span style="color: #000000;">We find that port 31337 is running HTTP, so we open the IP in our browser. Here we find a string “h1dd3n” that might be </span>a hint<span style="color: #000000;"> or a password for something.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-NmxIlqz2xyg/XIahhGyacoI/AAAAAAAAdaw/lncDMfFu7d07jdxL_VARuzgS-UhBk_tVgCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">We take a look at the source code of the web page and inside a </span>comment<span style="color: #000000;">, we find a string called “key_is_h1dd3n.jpg”.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-hDL0BXDXJXI/XIahheRvW7I/AAAAAAAAda0/KJF-5AvNrhUPVT6M6M6yDFaxzqWssVjaACLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We open the image in our browser and download it in our system.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-lGs33-pS2qM/XIahhvMnquI/AAAAAAAAda4/0ld5nHOmRYQFocxtSAVgNlOA1sUyrdIiQCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">After downloading the image, we use steghide to extract any hidden file from the image. When we try to extract files using steghide, it prompts for a password. We use the password “h1dd3n” we found earlier on the webpage and were successfully able to extract a text file. We take a look at the content of the text file and find a brain fuck encoded string.</span></p>
<pre class="lang:default decode:true ">steghide extract -sf key_is_h1dd3n.jpg</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-fwQgjWR2OKQ/XIahh2Z2bII/AAAAAAAAda8/pukyTabVD3oCw5RmJi4pxi2IZMMiEYxvACLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We decode the brainfuck encoded string using this <a style="color: #000000;" href="https://www.colasoft.com/packet_builder/">site</a> and find a username and password.</span></p>
<pre class="lang:default decode:true">Username: ud64
Password: 1M!#64@ud</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-DDgGH7Hw6PE/XIahibIv1dI/AAAAAAAAdbA/umLz47ZeMPs_kK9JwKgGOllWuFHBjENSQCLcBGAs/s1600/7.png"/></span></p>
<p><span style="color: #000000;">As port 1337 is running SSH, we use the credentials we found above to </span>log in<span style="color: #000000;">. After logging in through SSH we find that we have a restricted shell, and PATH and SHELL environment variable are </span>read-only<span style="color: #000000;">.</span></p>
<pre class="lang:default decode:true">ssh ud64@192.168.1.104 -p 1337</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-N2urY-F0c-k/XIahikdmiLI/AAAAAAAAdbE/p68DaFHGR5YGOit6vM_r1zkTxE8HqdrPwCLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">After pressing the “tab” button twice, we find the commands we can run using the restricted shell. Among </span>that command<span style="color: #000000;">, we find that we can use the Vi editor. We use Vi editor to escape the restricted shell.</span></p>
<pre class="lang:default decode:true">:!/bin/bash</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-IvwFwFiKb44/XIahfBAO5vI/AAAAAAAAdac/JB_fhfMYy5oILGff3H3Hk3oJruUCTTZPwCLcBGAs/s1600/10.png"/></span></p>
<p><span style="color: #000000;">After escaping the restricted shell, we export “/bin/bash” as our SHELL environment variable and “/usr/bin” as our PATH environment variable so that we can run Linux commands properly. Now we check sudoers list and find we can run “/usr/bin/sysud64” as root without </span>a password<span style="color: #000000;">.</span></p>
<pre class="lang:default decode:true">export PATH=/usr/bin:$PATH
export SHELL=/bin/bash:$SHELL
sudo -l</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-Swvvnh9p0ss/XIahfFHtuGI/AAAAAAAAdag/4qXkfaAnUacSHoR7_pW7A1VbIeSz5VuJACLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">On checking </span>the help<span style="color: #000000;"> for “sysud64”, we find that it is actually executing </span>strace<span style="color: #000000;">.</span></p>
<pre class="lang:default decode:true">sudo sysud64 -h | less</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-W72Mh6wQJxw/XIahfx5m1GI/AAAAAAAAdak/SGpkaJEFSPkICA-byR5blqm2xh5HgI3IgCLcBGAs/s1600/12.png"/></span></p>
<p><span style="color: #000000;">As we can run sysud64 as root and sysud64 </span>are<span style="color: #000000;"> actually running </span>the strace<span style="color: #000000;"> command. We can spawn a shell as root user using “sysud64”. After spawning </span>a shell<span style="color: #000000;"> as </span>the root<span style="color: #000000;"> user, we switch to the root directory and read our final flag.</span></p>
<pre class="lang:default decode:true">sudo sysud64 -o /dev/null /bin/sh</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-W7W_Cd1CqHk/XIahgRBwU7I/AAAAAAAAdao/8Kbgdye5oNwP1Z-f0m-HIGEDkQg7lsCxACLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;"><strong>Author: </strong>Sayantan Bera is a technical writer at hacking articles and cybersecurity enthusiast<strong>. Contact <a style="color: #000000;" href="https://www.linkedin.com/in/sayantan-bera-2098a613b/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
